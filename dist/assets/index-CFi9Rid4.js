var ej=Object.defineProperty;var tj=(e,t,r)=>t in e?ej(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var T0=(e,t,r)=>tj(e,typeof t!="symbol"?t+"":t,r);function rj(e,t){for(var r=0;r<t.length;r++){const s=t[r];if(typeof s!="string"&&!Array.isArray(s)){for(const n in s)if(n!=="default"&&!(n in e)){const a=Object.getOwnPropertyDescriptor(s,n);a&&Object.defineProperty(e,n,a.get?a:{enumerable:!0,get:()=>s[n]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function r(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(n){if(n.ep)return;n.ep=!0;const a=r(n);fetch(n.href,a)}})();function sj(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function nj(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function s(){return this instanceof s?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(s){var n=Object.getOwnPropertyDescriptor(e,s);Object.defineProperty(r,s,n.get?n:{enumerable:!0,get:function(){return e[s]}})}),r}var Iw={exports:{}},Ud={},Ow={exports:{}},Ze={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yc=Symbol.for("react.element"),aj=Symbol.for("react.portal"),ij=Symbol.for("react.fragment"),oj=Symbol.for("react.strict_mode"),lj=Symbol.for("react.profiler"),cj=Symbol.for("react.provider"),uj=Symbol.for("react.context"),dj=Symbol.for("react.forward_ref"),fj=Symbol.for("react.suspense"),hj=Symbol.for("react.memo"),mj=Symbol.for("react.lazy"),xg=Symbol.iterator;function pj(e){return e===null||typeof e!="object"?null:(e=xg&&e[xg]||e["@@iterator"],typeof e=="function"?e:null)}var Dw={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Lw=Object.assign,Mw={};function So(e,t,r){this.props=e,this.context=t,this.refs=Mw,this.updater=r||Dw}So.prototype.isReactComponent={};So.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};So.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Bw(){}Bw.prototype=So.prototype;function Dm(e,t,r){this.props=e,this.context=t,this.refs=Mw,this.updater=r||Dw}var Lm=Dm.prototype=new Bw;Lm.constructor=Dm;Lw(Lm,So.prototype);Lm.isPureReactComponent=!0;var gg=Array.isArray,Uw=Object.prototype.hasOwnProperty,Mm={current:null},zw={key:!0,ref:!0,__self:!0,__source:!0};function $w(e,t,r){var s,n={},a=null,i=null;if(t!=null)for(s in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(a=""+t.key),t)Uw.call(t,s)&&!zw.hasOwnProperty(s)&&(n[s]=t[s]);var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];n.children=c}if(e&&e.defaultProps)for(s in l=e.defaultProps,l)n[s]===void 0&&(n[s]=l[s]);return{$$typeof:yc,type:e,key:a,ref:i,props:n,_owner:Mm.current}}function xj(e,t){return{$$typeof:yc,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Bm(e){return typeof e=="object"&&e!==null&&e.$$typeof===yc}function gj(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var vg=/\/+/g;function C0(e,t){return typeof e=="object"&&e!==null&&e.key!=null?gj(""+e.key):t.toString(36)}function Tu(e,t,r,s,n){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(a){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case yc:case aj:i=!0}}if(i)return i=e,n=n(i),e=s===""?"."+C0(i,0):s,gg(n)?(r="",e!=null&&(r=e.replace(vg,"$&/")+"/"),Tu(n,t,r,"",function(u){return u})):n!=null&&(Bm(n)&&(n=xj(n,r+(!n.key||i&&i.key===n.key?"":(""+n.key).replace(vg,"$&/")+"/")+e)),t.push(n)),1;if(i=0,s=s===""?".":s+":",gg(e))for(var l=0;l<e.length;l++){a=e[l];var c=s+C0(a,l);i+=Tu(a,t,r,c,n)}else if(c=pj(e),typeof c=="function")for(e=c.call(e),l=0;!(a=e.next()).done;)a=a.value,c=s+C0(a,l++),i+=Tu(a,t,r,c,n);else if(a==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function zc(e,t,r){if(e==null)return e;var s=[],n=0;return Tu(e,s,"","",function(a){return t.call(r,a,n++)}),s}function vj(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var zr={current:null},Cu={transition:null},yj={ReactCurrentDispatcher:zr,ReactCurrentBatchConfig:Cu,ReactCurrentOwner:Mm};function Vw(){throw Error("act(...) is not supported in production builds of React.")}Ze.Children={map:zc,forEach:function(e,t,r){zc(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return zc(e,function(){t++}),t},toArray:function(e){return zc(e,function(t){return t})||[]},only:function(e){if(!Bm(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ze.Component=So;Ze.Fragment=ij;Ze.Profiler=lj;Ze.PureComponent=Dm;Ze.StrictMode=oj;Ze.Suspense=fj;Ze.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=yj;Ze.act=Vw;Ze.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var s=Lw({},e.props),n=e.key,a=e.ref,i=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,i=Mm.current),t.key!==void 0&&(n=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)Uw.call(t,c)&&!zw.hasOwnProperty(c)&&(s[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)s.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];s.children=l}return{$$typeof:yc,type:e.type,key:n,ref:a,props:s,_owner:i}};Ze.createContext=function(e){return e={$$typeof:uj,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:cj,_context:e},e.Consumer=e};Ze.createElement=$w;Ze.createFactory=function(e){var t=$w.bind(null,e);return t.type=e,t};Ze.createRef=function(){return{current:null}};Ze.forwardRef=function(e){return{$$typeof:dj,render:e}};Ze.isValidElement=Bm;Ze.lazy=function(e){return{$$typeof:mj,_payload:{_status:-1,_result:e},_init:vj}};Ze.memo=function(e,t){return{$$typeof:hj,type:e,compare:t===void 0?null:t}};Ze.startTransition=function(e){var t=Cu.transition;Cu.transition={};try{e()}finally{Cu.transition=t}};Ze.unstable_act=Vw;Ze.useCallback=function(e,t){return zr.current.useCallback(e,t)};Ze.useContext=function(e){return zr.current.useContext(e)};Ze.useDebugValue=function(){};Ze.useDeferredValue=function(e){return zr.current.useDeferredValue(e)};Ze.useEffect=function(e,t){return zr.current.useEffect(e,t)};Ze.useId=function(){return zr.current.useId()};Ze.useImperativeHandle=function(e,t,r){return zr.current.useImperativeHandle(e,t,r)};Ze.useInsertionEffect=function(e,t){return zr.current.useInsertionEffect(e,t)};Ze.useLayoutEffect=function(e,t){return zr.current.useLayoutEffect(e,t)};Ze.useMemo=function(e,t){return zr.current.useMemo(e,t)};Ze.useReducer=function(e,t,r){return zr.current.useReducer(e,t,r)};Ze.useRef=function(e){return zr.current.useRef(e)};Ze.useState=function(e){return zr.current.useState(e)};Ze.useSyncExternalStore=function(e,t,r){return zr.current.useSyncExternalStore(e,t,r)};Ze.useTransition=function(){return zr.current.useTransition()};Ze.version="18.3.1";Ow.exports=Ze;var j=Ow.exports;const wj=sj(j);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bj=j,_j=Symbol.for("react.element"),Sj=Symbol.for("react.fragment"),kj=Object.prototype.hasOwnProperty,Nj=bj.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ej={key:!0,ref:!0,__self:!0,__source:!0};function Ww(e,t,r){var s,n={},a=null,i=null;r!==void 0&&(a=""+r),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(i=t.ref);for(s in t)kj.call(t,s)&&!Ej.hasOwnProperty(s)&&(n[s]=t[s]);if(e&&e.defaultProps)for(s in t=e.defaultProps,t)n[s]===void 0&&(n[s]=t[s]);return{$$typeof:_j,type:e,key:a,ref:i,props:n,_owner:Nj.current}}Ud.Fragment=Sj;Ud.jsx=Ww;Ud.jsxs=Ww;Iw.exports=Ud;var o=Iw.exports,Wf={},qw={exports:{}},hs={},Hw={exports:{}},Gw={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(Q,B){var me=Q.length;Q.push(B);e:for(;0<me;){var fe=me-1>>>1,A=Q[fe];if(0<n(A,B))Q[fe]=B,Q[me]=A,me=fe;else break e}}function r(Q){return Q.length===0?null:Q[0]}function s(Q){if(Q.length===0)return null;var B=Q[0],me=Q.pop();if(me!==B){Q[0]=me;e:for(var fe=0,A=Q.length,V=A>>>1;fe<V;){var L=2*(fe+1)-1,U=Q[L],ne=L+1,xe=Q[ne];if(0>n(U,me))ne<A&&0>n(xe,U)?(Q[fe]=xe,Q[ne]=me,fe=ne):(Q[fe]=U,Q[L]=me,fe=L);else if(ne<A&&0>n(xe,me))Q[fe]=xe,Q[ne]=me,fe=ne;else break e}}return B}function n(Q,B){var me=Q.sortIndex-B.sortIndex;return me!==0?me:Q.id-B.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var i=Date,l=i.now();e.unstable_now=function(){return i.now()-l}}var c=[],u=[],d=1,f=null,h=3,m=!1,x=!1,p=!1,g=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(Q){for(var B=r(u);B!==null;){if(B.callback===null)s(u);else if(B.startTime<=Q)s(u),B.sortIndex=B.expirationTime,t(c,B);else break;B=r(u)}}function b(Q){if(p=!1,y(Q),!x)if(r(c)!==null)x=!0,G(S);else{var B=r(u);B!==null&&ce(b,B.startTime-Q)}}function S(Q,B){x=!1,p&&(p=!1,w(E),E=-1),m=!0;var me=h;try{for(y(B),f=r(c);f!==null&&(!(f.expirationTime>B)||Q&&!q());){var fe=f.callback;if(typeof fe=="function"){f.callback=null,h=f.priorityLevel;var A=fe(f.expirationTime<=B);B=e.unstable_now(),typeof A=="function"?f.callback=A:f===r(c)&&s(c),y(B)}else s(c);f=r(c)}if(f!==null)var V=!0;else{var L=r(u);L!==null&&ce(b,L.startTime-B),V=!1}return V}finally{f=null,h=me,m=!1}}var _=!1,k=null,E=-1,T=5,M=-1;function q(){return!(e.unstable_now()-M<T)}function D(){if(k!==null){var Q=e.unstable_now();M=Q;var B=!0;try{B=k(!0,Q)}finally{B?W():(_=!1,k=null)}}else _=!1}var W;if(typeof v=="function")W=function(){v(D)};else if(typeof MessageChannel<"u"){var ee=new MessageChannel,Y=ee.port2;ee.port1.onmessage=D,W=function(){Y.postMessage(null)}}else W=function(){g(D,0)};function G(Q){k=Q,_||(_=!0,W())}function ce(Q,B){E=g(function(){Q(e.unstable_now())},B)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Q){Q.callback=null},e.unstable_continueExecution=function(){x||m||(x=!0,G(S))},e.unstable_forceFrameRate=function(Q){0>Q||125<Q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<Q?Math.floor(1e3/Q):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(Q){switch(h){case 1:case 2:case 3:var B=3;break;default:B=h}var me=h;h=B;try{return Q()}finally{h=me}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Q,B){switch(Q){case 1:case 2:case 3:case 4:case 5:break;default:Q=3}var me=h;h=Q;try{return B()}finally{h=me}},e.unstable_scheduleCallback=function(Q,B,me){var fe=e.unstable_now();switch(typeof me=="object"&&me!==null?(me=me.delay,me=typeof me=="number"&&0<me?fe+me:fe):me=fe,Q){case 1:var A=-1;break;case 2:A=250;break;case 5:A=1073741823;break;case 4:A=1e4;break;default:A=5e3}return A=me+A,Q={id:d++,callback:B,priorityLevel:Q,startTime:me,expirationTime:A,sortIndex:-1},me>fe?(Q.sortIndex=me,t(u,Q),r(c)===null&&Q===r(u)&&(p?(w(E),E=-1):p=!0,ce(b,me-fe))):(Q.sortIndex=A,t(c,Q),x||m||(x=!0,G(S))),Q},e.unstable_shouldYield=q,e.unstable_wrapCallback=function(Q){var B=h;return function(){var me=h;h=B;try{return Q.apply(this,arguments)}finally{h=me}}}})(Gw);Hw.exports=Gw;var jj=Hw.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Tj=j,ds=jj;function _e(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Kw=new Set,Fl={};function ci(e,t){oo(e,t),oo(e+"Capture",t)}function oo(e,t){for(Fl[e]=t,e=0;e<t.length;e++)Kw.add(t[e])}var Tn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),qf=Object.prototype.hasOwnProperty,Cj=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,yg={},wg={};function Aj(e){return qf.call(wg,e)?!0:qf.call(yg,e)?!1:Cj.test(e)?wg[e]=!0:(yg[e]=!0,!1)}function Fj(e,t,r,s){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return s?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Pj(e,t,r,s){if(t===null||typeof t>"u"||Fj(e,t,r,s))return!0;if(s)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function $r(e,t,r,s,n,a,i){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=s,this.attributeNamespace=n,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=i}var gr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){gr[e]=new $r(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];gr[t]=new $r(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){gr[e]=new $r(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){gr[e]=new $r(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){gr[e]=new $r(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){gr[e]=new $r(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){gr[e]=new $r(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){gr[e]=new $r(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){gr[e]=new $r(e,5,!1,e.toLowerCase(),null,!1,!1)});var Um=/[\-:]([a-z])/g;function zm(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Um,zm);gr[t]=new $r(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Um,zm);gr[t]=new $r(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Um,zm);gr[t]=new $r(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){gr[e]=new $r(e,1,!1,e.toLowerCase(),null,!1,!1)});gr.xlinkHref=new $r("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){gr[e]=new $r(e,1,!1,e.toLowerCase(),null,!0,!0)});function $m(e,t,r,s){var n=gr.hasOwnProperty(t)?gr[t]:null;(n!==null?n.type!==0:s||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Pj(t,r,n,s)&&(r=null),s||n===null?Aj(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):n.mustUseProperty?e[n.propertyName]=r===null?n.type===3?!1:"":r:(t=n.attributeName,s=n.attributeNamespace,r===null?e.removeAttribute(t):(n=n.type,r=n===3||n===4&&r===!0?"":""+r,s?e.setAttributeNS(s,t,r):e.setAttribute(t,r))))}var On=Tj.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,$c=Symbol.for("react.element"),Ai=Symbol.for("react.portal"),Fi=Symbol.for("react.fragment"),Vm=Symbol.for("react.strict_mode"),Hf=Symbol.for("react.profiler"),Xw=Symbol.for("react.provider"),Qw=Symbol.for("react.context"),Wm=Symbol.for("react.forward_ref"),Gf=Symbol.for("react.suspense"),Kf=Symbol.for("react.suspense_list"),qm=Symbol.for("react.memo"),Vn=Symbol.for("react.lazy"),Yw=Symbol.for("react.offscreen"),bg=Symbol.iterator;function $o(e){return e===null||typeof e!="object"?null:(e=bg&&e[bg]||e["@@iterator"],typeof e=="function"?e:null)}var Rt=Object.assign,A0;function Jo(e){if(A0===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);A0=t&&t[1]||""}return`
`+A0+e}var F0=!1;function P0(e,t){if(!e||F0)return"";F0=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var s=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){s=u}e.call(t.prototype)}else{try{throw Error()}catch(u){s=u}e()}}catch(u){if(u&&s&&typeof u.stack=="string"){for(var n=u.stack.split(`
`),a=s.stack.split(`
`),i=n.length-1,l=a.length-1;1<=i&&0<=l&&n[i]!==a[l];)l--;for(;1<=i&&0<=l;i--,l--)if(n[i]!==a[l]){if(i!==1||l!==1)do if(i--,l--,0>l||n[i]!==a[l]){var c=`
`+n[i].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=i&&0<=l);break}}}finally{F0=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Jo(e):""}function Rj(e){switch(e.tag){case 5:return Jo(e.type);case 16:return Jo("Lazy");case 13:return Jo("Suspense");case 19:return Jo("SuspenseList");case 0:case 2:case 15:return e=P0(e.type,!1),e;case 11:return e=P0(e.type.render,!1),e;case 1:return e=P0(e.type,!0),e;default:return""}}function Xf(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Fi:return"Fragment";case Ai:return"Portal";case Hf:return"Profiler";case Vm:return"StrictMode";case Gf:return"Suspense";case Kf:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Qw:return(e.displayName||"Context")+".Consumer";case Xw:return(e._context.displayName||"Context")+".Provider";case Wm:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case qm:return t=e.displayName||null,t!==null?t:Xf(e.type)||"Memo";case Vn:t=e._payload,e=e._init;try{return Xf(e(t))}catch{}}return null}function Ij(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Xf(t);case 8:return t===Vm?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function ia(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Jw(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Oj(e){var t=Jw(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),s=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var n=r.get,a=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return n.call(this)},set:function(i){s=""+i,a.call(this,i)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return s},setValue:function(i){s=""+i},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Vc(e){e._valueTracker||(e._valueTracker=Oj(e))}function Zw(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),s="";return e&&(s=Jw(e)?e.checked?"true":"false":e.value),e=s,e!==r?(t.setValue(e),!0):!1}function Hu(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Qf(e,t){var r=t.checked;return Rt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function _g(e,t){var r=t.defaultValue==null?"":t.defaultValue,s=t.checked!=null?t.checked:t.defaultChecked;r=ia(t.value!=null?t.value:r),e._wrapperState={initialChecked:s,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function e2(e,t){t=t.checked,t!=null&&$m(e,"checked",t,!1)}function Yf(e,t){e2(e,t);var r=ia(t.value),s=t.type;if(r!=null)s==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(s==="submit"||s==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Jf(e,t.type,r):t.hasOwnProperty("defaultValue")&&Jf(e,t.type,ia(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Sg(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var s=t.type;if(!(s!=="submit"&&s!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Jf(e,t,r){(t!=="number"||Hu(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Zo=Array.isArray;function Ki(e,t,r,s){if(e=e.options,t){t={};for(var n=0;n<r.length;n++)t["$"+r[n]]=!0;for(r=0;r<e.length;r++)n=t.hasOwnProperty("$"+e[r].value),e[r].selected!==n&&(e[r].selected=n),n&&s&&(e[r].defaultSelected=!0)}else{for(r=""+ia(r),t=null,n=0;n<e.length;n++){if(e[n].value===r){e[n].selected=!0,s&&(e[n].defaultSelected=!0);return}t!==null||e[n].disabled||(t=e[n])}t!==null&&(t.selected=!0)}}function Zf(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(_e(91));return Rt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function kg(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(_e(92));if(Zo(r)){if(1<r.length)throw Error(_e(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:ia(r)}}function t2(e,t){var r=ia(t.value),s=ia(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),s!=null&&(e.defaultValue=""+s)}function Ng(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function r2(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function eh(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?r2(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Wc,s2=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,s,n){MSApp.execUnsafeLocalFunction(function(){return e(t,r,s,n)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Wc=Wc||document.createElement("div"),Wc.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Wc.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Pl(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var ol={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Dj=["Webkit","ms","Moz","O"];Object.keys(ol).forEach(function(e){Dj.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),ol[t]=ol[e]})});function n2(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||ol.hasOwnProperty(e)&&ol[e]?(""+t).trim():t+"px"}function a2(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var s=r.indexOf("--")===0,n=n2(r,t[r],s);r==="float"&&(r="cssFloat"),s?e.setProperty(r,n):e[r]=n}}var Lj=Rt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function th(e,t){if(t){if(Lj[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(_e(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(_e(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(_e(61))}if(t.style!=null&&typeof t.style!="object")throw Error(_e(62))}}function rh(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var sh=null;function Hm(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var nh=null,Xi=null,Qi=null;function Eg(e){if(e=_c(e)){if(typeof nh!="function")throw Error(_e(280));var t=e.stateNode;t&&(t=qd(t),nh(e.stateNode,e.type,t))}}function i2(e){Xi?Qi?Qi.push(e):Qi=[e]:Xi=e}function o2(){if(Xi){var e=Xi,t=Qi;if(Qi=Xi=null,Eg(e),t)for(e=0;e<t.length;e++)Eg(t[e])}}function l2(e,t){return e(t)}function c2(){}var R0=!1;function u2(e,t,r){if(R0)return e(t,r);R0=!0;try{return l2(e,t,r)}finally{R0=!1,(Xi!==null||Qi!==null)&&(c2(),o2())}}function Rl(e,t){var r=e.stateNode;if(r===null)return null;var s=qd(r);if(s===null)return null;r=s[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(e=e.type,s=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!s;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(_e(231,t,typeof r));return r}var ah=!1;if(Tn)try{var Vo={};Object.defineProperty(Vo,"passive",{get:function(){ah=!0}}),window.addEventListener("test",Vo,Vo),window.removeEventListener("test",Vo,Vo)}catch{ah=!1}function Mj(e,t,r,s,n,a,i,l,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(d){this.onError(d)}}var ll=!1,Gu=null,Ku=!1,ih=null,Bj={onError:function(e){ll=!0,Gu=e}};function Uj(e,t,r,s,n,a,i,l,c){ll=!1,Gu=null,Mj.apply(Bj,arguments)}function zj(e,t,r,s,n,a,i,l,c){if(Uj.apply(this,arguments),ll){if(ll){var u=Gu;ll=!1,Gu=null}else throw Error(_e(198));Ku||(Ku=!0,ih=u)}}function ui(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function d2(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function jg(e){if(ui(e)!==e)throw Error(_e(188))}function $j(e){var t=e.alternate;if(!t){if(t=ui(e),t===null)throw Error(_e(188));return t!==e?null:e}for(var r=e,s=t;;){var n=r.return;if(n===null)break;var a=n.alternate;if(a===null){if(s=n.return,s!==null){r=s;continue}break}if(n.child===a.child){for(a=n.child;a;){if(a===r)return jg(n),e;if(a===s)return jg(n),t;a=a.sibling}throw Error(_e(188))}if(r.return!==s.return)r=n,s=a;else{for(var i=!1,l=n.child;l;){if(l===r){i=!0,r=n,s=a;break}if(l===s){i=!0,s=n,r=a;break}l=l.sibling}if(!i){for(l=a.child;l;){if(l===r){i=!0,r=a,s=n;break}if(l===s){i=!0,s=a,r=n;break}l=l.sibling}if(!i)throw Error(_e(189))}}if(r.alternate!==s)throw Error(_e(190))}if(r.tag!==3)throw Error(_e(188));return r.stateNode.current===r?e:t}function f2(e){return e=$j(e),e!==null?h2(e):null}function h2(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=h2(e);if(t!==null)return t;e=e.sibling}return null}var m2=ds.unstable_scheduleCallback,Tg=ds.unstable_cancelCallback,Vj=ds.unstable_shouldYield,Wj=ds.unstable_requestPaint,zt=ds.unstable_now,qj=ds.unstable_getCurrentPriorityLevel,Gm=ds.unstable_ImmediatePriority,p2=ds.unstable_UserBlockingPriority,Xu=ds.unstable_NormalPriority,Hj=ds.unstable_LowPriority,x2=ds.unstable_IdlePriority,zd=null,cn=null;function Gj(e){if(cn&&typeof cn.onCommitFiberRoot=="function")try{cn.onCommitFiberRoot(zd,e,void 0,(e.current.flags&128)===128)}catch{}}var Xs=Math.clz32?Math.clz32:Qj,Kj=Math.log,Xj=Math.LN2;function Qj(e){return e>>>=0,e===0?32:31-(Kj(e)/Xj|0)|0}var qc=64,Hc=4194304;function el(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Qu(e,t){var r=e.pendingLanes;if(r===0)return 0;var s=0,n=e.suspendedLanes,a=e.pingedLanes,i=r&268435455;if(i!==0){var l=i&~n;l!==0?s=el(l):(a&=i,a!==0&&(s=el(a)))}else i=r&~n,i!==0?s=el(i):a!==0&&(s=el(a));if(s===0)return 0;if(t!==0&&t!==s&&!(t&n)&&(n=s&-s,a=t&-t,n>=a||n===16&&(a&4194240)!==0))return t;if(s&4&&(s|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=s;0<t;)r=31-Xs(t),n=1<<r,s|=e[r],t&=~n;return s}function Yj(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Jj(e,t){for(var r=e.suspendedLanes,s=e.pingedLanes,n=e.expirationTimes,a=e.pendingLanes;0<a;){var i=31-Xs(a),l=1<<i,c=n[i];c===-1?(!(l&r)||l&s)&&(n[i]=Yj(l,t)):c<=t&&(e.expiredLanes|=l),a&=~l}}function oh(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function g2(){var e=qc;return qc<<=1,!(qc&4194240)&&(qc=64),e}function I0(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function wc(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Xs(t),e[t]=r}function Zj(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var s=e.eventTimes;for(e=e.expirationTimes;0<r;){var n=31-Xs(r),a=1<<n;t[n]=0,s[n]=-1,e[n]=-1,r&=~a}}function Km(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var s=31-Xs(r),n=1<<s;n&t|e[s]&t&&(e[s]|=t),r&=~n}}var dt=0;function v2(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var y2,Xm,w2,b2,_2,lh=!1,Gc=[],Jn=null,Zn=null,ea=null,Il=new Map,Ol=new Map,qn=[],eT="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Cg(e,t){switch(e){case"focusin":case"focusout":Jn=null;break;case"dragenter":case"dragleave":Zn=null;break;case"mouseover":case"mouseout":ea=null;break;case"pointerover":case"pointerout":Il.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ol.delete(t.pointerId)}}function Wo(e,t,r,s,n,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:r,eventSystemFlags:s,nativeEvent:a,targetContainers:[n]},t!==null&&(t=_c(t),t!==null&&Xm(t)),e):(e.eventSystemFlags|=s,t=e.targetContainers,n!==null&&t.indexOf(n)===-1&&t.push(n),e)}function tT(e,t,r,s,n){switch(t){case"focusin":return Jn=Wo(Jn,e,t,r,s,n),!0;case"dragenter":return Zn=Wo(Zn,e,t,r,s,n),!0;case"mouseover":return ea=Wo(ea,e,t,r,s,n),!0;case"pointerover":var a=n.pointerId;return Il.set(a,Wo(Il.get(a)||null,e,t,r,s,n)),!0;case"gotpointercapture":return a=n.pointerId,Ol.set(a,Wo(Ol.get(a)||null,e,t,r,s,n)),!0}return!1}function S2(e){var t=Da(e.target);if(t!==null){var r=ui(t);if(r!==null){if(t=r.tag,t===13){if(t=d2(r),t!==null){e.blockedOn=t,_2(e.priority,function(){w2(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Au(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=ch(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var s=new r.constructor(r.type,r);sh=s,r.target.dispatchEvent(s),sh=null}else return t=_c(r),t!==null&&Xm(t),e.blockedOn=r,!1;t.shift()}return!0}function Ag(e,t,r){Au(e)&&r.delete(t)}function rT(){lh=!1,Jn!==null&&Au(Jn)&&(Jn=null),Zn!==null&&Au(Zn)&&(Zn=null),ea!==null&&Au(ea)&&(ea=null),Il.forEach(Ag),Ol.forEach(Ag)}function qo(e,t){e.blockedOn===t&&(e.blockedOn=null,lh||(lh=!0,ds.unstable_scheduleCallback(ds.unstable_NormalPriority,rT)))}function Dl(e){function t(n){return qo(n,e)}if(0<Gc.length){qo(Gc[0],e);for(var r=1;r<Gc.length;r++){var s=Gc[r];s.blockedOn===e&&(s.blockedOn=null)}}for(Jn!==null&&qo(Jn,e),Zn!==null&&qo(Zn,e),ea!==null&&qo(ea,e),Il.forEach(t),Ol.forEach(t),r=0;r<qn.length;r++)s=qn[r],s.blockedOn===e&&(s.blockedOn=null);for(;0<qn.length&&(r=qn[0],r.blockedOn===null);)S2(r),r.blockedOn===null&&qn.shift()}var Yi=On.ReactCurrentBatchConfig,Yu=!0;function sT(e,t,r,s){var n=dt,a=Yi.transition;Yi.transition=null;try{dt=1,Qm(e,t,r,s)}finally{dt=n,Yi.transition=a}}function nT(e,t,r,s){var n=dt,a=Yi.transition;Yi.transition=null;try{dt=4,Qm(e,t,r,s)}finally{dt=n,Yi.transition=a}}function Qm(e,t,r,s){if(Yu){var n=ch(e,t,r,s);if(n===null)W0(e,t,s,Ju,r),Cg(e,s);else if(tT(n,e,t,r,s))s.stopPropagation();else if(Cg(e,s),t&4&&-1<eT.indexOf(e)){for(;n!==null;){var a=_c(n);if(a!==null&&y2(a),a=ch(e,t,r,s),a===null&&W0(e,t,s,Ju,r),a===n)break;n=a}n!==null&&s.stopPropagation()}else W0(e,t,s,null,r)}}var Ju=null;function ch(e,t,r,s){if(Ju=null,e=Hm(s),e=Da(e),e!==null)if(t=ui(e),t===null)e=null;else if(r=t.tag,r===13){if(e=d2(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Ju=e,null}function k2(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(qj()){case Gm:return 1;case p2:return 4;case Xu:case Hj:return 16;case x2:return 536870912;default:return 16}default:return 16}}var Kn=null,Ym=null,Fu=null;function N2(){if(Fu)return Fu;var e,t=Ym,r=t.length,s,n="value"in Kn?Kn.value:Kn.textContent,a=n.length;for(e=0;e<r&&t[e]===n[e];e++);var i=r-e;for(s=1;s<=i&&t[r-s]===n[a-s];s++);return Fu=n.slice(e,1<s?1-s:void 0)}function Pu(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Kc(){return!0}function Fg(){return!1}function ms(e){function t(r,s,n,a,i){this._reactName=r,this._targetInst=n,this.type=s,this.nativeEvent=a,this.target=i,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(r=e[l],this[l]=r?r(a):a[l]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?Kc:Fg,this.isPropagationStopped=Fg,this}return Rt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Kc)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Kc)},persist:function(){},isPersistent:Kc}),t}var ko={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Jm=ms(ko),bc=Rt({},ko,{view:0,detail:0}),aT=ms(bc),O0,D0,Ho,$d=Rt({},bc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Zm,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ho&&(Ho&&e.type==="mousemove"?(O0=e.screenX-Ho.screenX,D0=e.screenY-Ho.screenY):D0=O0=0,Ho=e),O0)},movementY:function(e){return"movementY"in e?e.movementY:D0}}),Pg=ms($d),iT=Rt({},$d,{dataTransfer:0}),oT=ms(iT),lT=Rt({},bc,{relatedTarget:0}),L0=ms(lT),cT=Rt({},ko,{animationName:0,elapsedTime:0,pseudoElement:0}),uT=ms(cT),dT=Rt({},ko,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),fT=ms(dT),hT=Rt({},ko,{data:0}),Rg=ms(hT),mT={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},pT={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},xT={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function gT(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=xT[e])?!!t[e]:!1}function Zm(){return gT}var vT=Rt({},bc,{key:function(e){if(e.key){var t=mT[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Pu(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?pT[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Zm,charCode:function(e){return e.type==="keypress"?Pu(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Pu(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),yT=ms(vT),wT=Rt({},$d,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ig=ms(wT),bT=Rt({},bc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Zm}),_T=ms(bT),ST=Rt({},ko,{propertyName:0,elapsedTime:0,pseudoElement:0}),kT=ms(ST),NT=Rt({},$d,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),ET=ms(NT),jT=[9,13,27,32],ep=Tn&&"CompositionEvent"in window,cl=null;Tn&&"documentMode"in document&&(cl=document.documentMode);var TT=Tn&&"TextEvent"in window&&!cl,E2=Tn&&(!ep||cl&&8<cl&&11>=cl),Og=" ",Dg=!1;function j2(e,t){switch(e){case"keyup":return jT.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function T2(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Pi=!1;function CT(e,t){switch(e){case"compositionend":return T2(t);case"keypress":return t.which!==32?null:(Dg=!0,Og);case"textInput":return e=t.data,e===Og&&Dg?null:e;default:return null}}function AT(e,t){if(Pi)return e==="compositionend"||!ep&&j2(e,t)?(e=N2(),Fu=Ym=Kn=null,Pi=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return E2&&t.locale!=="ko"?null:t.data;default:return null}}var FT={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Lg(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!FT[e.type]:t==="textarea"}function C2(e,t,r,s){i2(s),t=Zu(t,"onChange"),0<t.length&&(r=new Jm("onChange","change",null,r,s),e.push({event:r,listeners:t}))}var ul=null,Ll=null;function PT(e){U2(e,0)}function Vd(e){var t=Oi(e);if(Zw(t))return e}function RT(e,t){if(e==="change")return t}var A2=!1;if(Tn){var M0;if(Tn){var B0="oninput"in document;if(!B0){var Mg=document.createElement("div");Mg.setAttribute("oninput","return;"),B0=typeof Mg.oninput=="function"}M0=B0}else M0=!1;A2=M0&&(!document.documentMode||9<document.documentMode)}function Bg(){ul&&(ul.detachEvent("onpropertychange",F2),Ll=ul=null)}function F2(e){if(e.propertyName==="value"&&Vd(Ll)){var t=[];C2(t,Ll,e,Hm(e)),u2(PT,t)}}function IT(e,t,r){e==="focusin"?(Bg(),ul=t,Ll=r,ul.attachEvent("onpropertychange",F2)):e==="focusout"&&Bg()}function OT(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Vd(Ll)}function DT(e,t){if(e==="click")return Vd(t)}function LT(e,t){if(e==="input"||e==="change")return Vd(t)}function MT(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Zs=typeof Object.is=="function"?Object.is:MT;function Ml(e,t){if(Zs(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),s=Object.keys(t);if(r.length!==s.length)return!1;for(s=0;s<r.length;s++){var n=r[s];if(!qf.call(t,n)||!Zs(e[n],t[n]))return!1}return!0}function Ug(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function zg(e,t){var r=Ug(e);e=0;for(var s;r;){if(r.nodeType===3){if(s=e+r.textContent.length,e<=t&&s>=t)return{node:r,offset:t-e};e=s}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Ug(r)}}function P2(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?P2(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function R2(){for(var e=window,t=Hu();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Hu(e.document)}return t}function tp(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function BT(e){var t=R2(),r=e.focusedElem,s=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&P2(r.ownerDocument.documentElement,r)){if(s!==null&&tp(r)){if(t=s.start,e=s.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var n=r.textContent.length,a=Math.min(s.start,n);s=s.end===void 0?a:Math.min(s.end,n),!e.extend&&a>s&&(n=s,s=a,a=n),n=zg(r,a);var i=zg(r,s);n&&i&&(e.rangeCount!==1||e.anchorNode!==n.node||e.anchorOffset!==n.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(t=t.createRange(),t.setStart(n.node,n.offset),e.removeAllRanges(),a>s?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var UT=Tn&&"documentMode"in document&&11>=document.documentMode,Ri=null,uh=null,dl=null,dh=!1;function $g(e,t,r){var s=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;dh||Ri==null||Ri!==Hu(s)||(s=Ri,"selectionStart"in s&&tp(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),dl&&Ml(dl,s)||(dl=s,s=Zu(uh,"onSelect"),0<s.length&&(t=new Jm("onSelect","select",null,t,r),e.push({event:t,listeners:s}),t.target=Ri)))}function Xc(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Ii={animationend:Xc("Animation","AnimationEnd"),animationiteration:Xc("Animation","AnimationIteration"),animationstart:Xc("Animation","AnimationStart"),transitionend:Xc("Transition","TransitionEnd")},U0={},I2={};Tn&&(I2=document.createElement("div").style,"AnimationEvent"in window||(delete Ii.animationend.animation,delete Ii.animationiteration.animation,delete Ii.animationstart.animation),"TransitionEvent"in window||delete Ii.transitionend.transition);function Wd(e){if(U0[e])return U0[e];if(!Ii[e])return e;var t=Ii[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in I2)return U0[e]=t[r];return e}var O2=Wd("animationend"),D2=Wd("animationiteration"),L2=Wd("animationstart"),M2=Wd("transitionend"),B2=new Map,Vg="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function pa(e,t){B2.set(e,t),ci(t,[e])}for(var z0=0;z0<Vg.length;z0++){var $0=Vg[z0],zT=$0.toLowerCase(),$T=$0[0].toUpperCase()+$0.slice(1);pa(zT,"on"+$T)}pa(O2,"onAnimationEnd");pa(D2,"onAnimationIteration");pa(L2,"onAnimationStart");pa("dblclick","onDoubleClick");pa("focusin","onFocus");pa("focusout","onBlur");pa(M2,"onTransitionEnd");oo("onMouseEnter",["mouseout","mouseover"]);oo("onMouseLeave",["mouseout","mouseover"]);oo("onPointerEnter",["pointerout","pointerover"]);oo("onPointerLeave",["pointerout","pointerover"]);ci("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ci("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ci("onBeforeInput",["compositionend","keypress","textInput","paste"]);ci("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ci("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ci("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var tl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),VT=new Set("cancel close invalid load scroll toggle".split(" ").concat(tl));function Wg(e,t,r){var s=e.type||"unknown-event";e.currentTarget=r,zj(s,t,void 0,e),e.currentTarget=null}function U2(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var s=e[r],n=s.event;s=s.listeners;e:{var a=void 0;if(t)for(var i=s.length-1;0<=i;i--){var l=s[i],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==a&&n.isPropagationStopped())break e;Wg(n,l,u),a=c}else for(i=0;i<s.length;i++){if(l=s[i],c=l.instance,u=l.currentTarget,l=l.listener,c!==a&&n.isPropagationStopped())break e;Wg(n,l,u),a=c}}}if(Ku)throw e=ih,Ku=!1,ih=null,e}function gt(e,t){var r=t[xh];r===void 0&&(r=t[xh]=new Set);var s=e+"__bubble";r.has(s)||(z2(t,e,2,!1),r.add(s))}function V0(e,t,r){var s=0;t&&(s|=4),z2(r,e,s,t)}var Qc="_reactListening"+Math.random().toString(36).slice(2);function Bl(e){if(!e[Qc]){e[Qc]=!0,Kw.forEach(function(r){r!=="selectionchange"&&(VT.has(r)||V0(r,!1,e),V0(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Qc]||(t[Qc]=!0,V0("selectionchange",!1,t))}}function z2(e,t,r,s){switch(k2(t)){case 1:var n=sT;break;case 4:n=nT;break;default:n=Qm}r=n.bind(null,t,r,e),n=void 0,!ah||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(n=!0),s?n!==void 0?e.addEventListener(t,r,{capture:!0,passive:n}):e.addEventListener(t,r,!0):n!==void 0?e.addEventListener(t,r,{passive:n}):e.addEventListener(t,r,!1)}function W0(e,t,r,s,n){var a=s;if(!(t&1)&&!(t&2)&&s!==null)e:for(;;){if(s===null)return;var i=s.tag;if(i===3||i===4){var l=s.stateNode.containerInfo;if(l===n||l.nodeType===8&&l.parentNode===n)break;if(i===4)for(i=s.return;i!==null;){var c=i.tag;if((c===3||c===4)&&(c=i.stateNode.containerInfo,c===n||c.nodeType===8&&c.parentNode===n))return;i=i.return}for(;l!==null;){if(i=Da(l),i===null)return;if(c=i.tag,c===5||c===6){s=a=i;continue e}l=l.parentNode}}s=s.return}u2(function(){var u=a,d=Hm(r),f=[];e:{var h=B2.get(e);if(h!==void 0){var m=Jm,x=e;switch(e){case"keypress":if(Pu(r)===0)break e;case"keydown":case"keyup":m=yT;break;case"focusin":x="focus",m=L0;break;case"focusout":x="blur",m=L0;break;case"beforeblur":case"afterblur":m=L0;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=Pg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=oT;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=_T;break;case O2:case D2:case L2:m=uT;break;case M2:m=kT;break;case"scroll":m=aT;break;case"wheel":m=ET;break;case"copy":case"cut":case"paste":m=fT;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=Ig}var p=(t&4)!==0,g=!p&&e==="scroll",w=p?h!==null?h+"Capture":null:h;p=[];for(var v=u,y;v!==null;){y=v;var b=y.stateNode;if(y.tag===5&&b!==null&&(y=b,w!==null&&(b=Rl(v,w),b!=null&&p.push(Ul(v,b,y)))),g)break;v=v.return}0<p.length&&(h=new m(h,x,null,r,d),f.push({event:h,listeners:p}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",m=e==="mouseout"||e==="pointerout",h&&r!==sh&&(x=r.relatedTarget||r.fromElement)&&(Da(x)||x[Cn]))break e;if((m||h)&&(h=d.window===d?d:(h=d.ownerDocument)?h.defaultView||h.parentWindow:window,m?(x=r.relatedTarget||r.toElement,m=u,x=x?Da(x):null,x!==null&&(g=ui(x),x!==g||x.tag!==5&&x.tag!==6)&&(x=null)):(m=null,x=u),m!==x)){if(p=Pg,b="onMouseLeave",w="onMouseEnter",v="mouse",(e==="pointerout"||e==="pointerover")&&(p=Ig,b="onPointerLeave",w="onPointerEnter",v="pointer"),g=m==null?h:Oi(m),y=x==null?h:Oi(x),h=new p(b,v+"leave",m,r,d),h.target=g,h.relatedTarget=y,b=null,Da(d)===u&&(p=new p(w,v+"enter",x,r,d),p.target=y,p.relatedTarget=g,b=p),g=b,m&&x)t:{for(p=m,w=x,v=0,y=p;y;y=vi(y))v++;for(y=0,b=w;b;b=vi(b))y++;for(;0<v-y;)p=vi(p),v--;for(;0<y-v;)w=vi(w),y--;for(;v--;){if(p===w||w!==null&&p===w.alternate)break t;p=vi(p),w=vi(w)}p=null}else p=null;m!==null&&qg(f,h,m,p,!1),x!==null&&g!==null&&qg(f,g,x,p,!0)}}e:{if(h=u?Oi(u):window,m=h.nodeName&&h.nodeName.toLowerCase(),m==="select"||m==="input"&&h.type==="file")var S=RT;else if(Lg(h))if(A2)S=LT;else{S=OT;var _=IT}else(m=h.nodeName)&&m.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(S=DT);if(S&&(S=S(e,u))){C2(f,S,r,d);break e}_&&_(e,h,u),e==="focusout"&&(_=h._wrapperState)&&_.controlled&&h.type==="number"&&Jf(h,"number",h.value)}switch(_=u?Oi(u):window,e){case"focusin":(Lg(_)||_.contentEditable==="true")&&(Ri=_,uh=u,dl=null);break;case"focusout":dl=uh=Ri=null;break;case"mousedown":dh=!0;break;case"contextmenu":case"mouseup":case"dragend":dh=!1,$g(f,r,d);break;case"selectionchange":if(UT)break;case"keydown":case"keyup":$g(f,r,d)}var k;if(ep)e:{switch(e){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else Pi?j2(e,r)&&(E="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(E="onCompositionStart");E&&(E2&&r.locale!=="ko"&&(Pi||E!=="onCompositionStart"?E==="onCompositionEnd"&&Pi&&(k=N2()):(Kn=d,Ym="value"in Kn?Kn.value:Kn.textContent,Pi=!0)),_=Zu(u,E),0<_.length&&(E=new Rg(E,e,null,r,d),f.push({event:E,listeners:_}),k?E.data=k:(k=T2(r),k!==null&&(E.data=k)))),(k=TT?CT(e,r):AT(e,r))&&(u=Zu(u,"onBeforeInput"),0<u.length&&(d=new Rg("onBeforeInput","beforeinput",null,r,d),f.push({event:d,listeners:u}),d.data=k))}U2(f,t)})}function Ul(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Zu(e,t){for(var r=t+"Capture",s=[];e!==null;){var n=e,a=n.stateNode;n.tag===5&&a!==null&&(n=a,a=Rl(e,r),a!=null&&s.unshift(Ul(e,a,n)),a=Rl(e,t),a!=null&&s.push(Ul(e,a,n))),e=e.return}return s}function vi(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function qg(e,t,r,s,n){for(var a=t._reactName,i=[];r!==null&&r!==s;){var l=r,c=l.alternate,u=l.stateNode;if(c!==null&&c===s)break;l.tag===5&&u!==null&&(l=u,n?(c=Rl(r,a),c!=null&&i.unshift(Ul(r,c,l))):n||(c=Rl(r,a),c!=null&&i.push(Ul(r,c,l)))),r=r.return}i.length!==0&&e.push({event:t,listeners:i})}var WT=/\r\n?/g,qT=/\u0000|\uFFFD/g;function Hg(e){return(typeof e=="string"?e:""+e).replace(WT,`
`).replace(qT,"")}function Yc(e,t,r){if(t=Hg(t),Hg(e)!==t&&r)throw Error(_e(425))}function ed(){}var fh=null,hh=null;function mh(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var ph=typeof setTimeout=="function"?setTimeout:void 0,HT=typeof clearTimeout=="function"?clearTimeout:void 0,Gg=typeof Promise=="function"?Promise:void 0,GT=typeof queueMicrotask=="function"?queueMicrotask:typeof Gg<"u"?function(e){return Gg.resolve(null).then(e).catch(KT)}:ph;function KT(e){setTimeout(function(){throw e})}function q0(e,t){var r=t,s=0;do{var n=r.nextSibling;if(e.removeChild(r),n&&n.nodeType===8)if(r=n.data,r==="/$"){if(s===0){e.removeChild(n),Dl(t);return}s--}else r!=="$"&&r!=="$?"&&r!=="$!"||s++;r=n}while(r);Dl(t)}function ta(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Kg(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var No=Math.random().toString(36).slice(2),on="__reactFiber$"+No,zl="__reactProps$"+No,Cn="__reactContainer$"+No,xh="__reactEvents$"+No,XT="__reactListeners$"+No,QT="__reactHandles$"+No;function Da(e){var t=e[on];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Cn]||r[on]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=Kg(e);e!==null;){if(r=e[on])return r;e=Kg(e)}return t}e=r,r=e.parentNode}return null}function _c(e){return e=e[on]||e[Cn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Oi(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(_e(33))}function qd(e){return e[zl]||null}var gh=[],Di=-1;function xa(e){return{current:e}}function yt(e){0>Di||(e.current=gh[Di],gh[Di]=null,Di--)}function mt(e,t){Di++,gh[Di]=e.current,e.current=t}var oa={},Ar=xa(oa),Xr=xa(!1),Ya=oa;function lo(e,t){var r=e.type.contextTypes;if(!r)return oa;var s=e.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===t)return s.__reactInternalMemoizedMaskedChildContext;var n={},a;for(a in r)n[a]=t[a];return s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=n),n}function Qr(e){return e=e.childContextTypes,e!=null}function td(){yt(Xr),yt(Ar)}function Xg(e,t,r){if(Ar.current!==oa)throw Error(_e(168));mt(Ar,t),mt(Xr,r)}function $2(e,t,r){var s=e.stateNode;if(t=t.childContextTypes,typeof s.getChildContext!="function")return r;s=s.getChildContext();for(var n in s)if(!(n in t))throw Error(_e(108,Ij(e)||"Unknown",n));return Rt({},r,s)}function rd(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||oa,Ya=Ar.current,mt(Ar,e),mt(Xr,Xr.current),!0}function Qg(e,t,r){var s=e.stateNode;if(!s)throw Error(_e(169));r?(e=$2(e,t,Ya),s.__reactInternalMemoizedMergedChildContext=e,yt(Xr),yt(Ar),mt(Ar,e)):yt(Xr),mt(Xr,r)}var yn=null,Hd=!1,H0=!1;function V2(e){yn===null?yn=[e]:yn.push(e)}function YT(e){Hd=!0,V2(e)}function ga(){if(!H0&&yn!==null){H0=!0;var e=0,t=dt;try{var r=yn;for(dt=1;e<r.length;e++){var s=r[e];do s=s(!0);while(s!==null)}yn=null,Hd=!1}catch(n){throw yn!==null&&(yn=yn.slice(e+1)),m2(Gm,ga),n}finally{dt=t,H0=!1}}return null}var Li=[],Mi=0,sd=null,nd=0,Ns=[],Es=0,Ja=null,wn=1,bn="";function Ta(e,t){Li[Mi++]=nd,Li[Mi++]=sd,sd=e,nd=t}function W2(e,t,r){Ns[Es++]=wn,Ns[Es++]=bn,Ns[Es++]=Ja,Ja=e;var s=wn;e=bn;var n=32-Xs(s)-1;s&=~(1<<n),r+=1;var a=32-Xs(t)+n;if(30<a){var i=n-n%5;a=(s&(1<<i)-1).toString(32),s>>=i,n-=i,wn=1<<32-Xs(t)+n|r<<n|s,bn=a+e}else wn=1<<a|r<<n|s,bn=e}function rp(e){e.return!==null&&(Ta(e,1),W2(e,1,0))}function sp(e){for(;e===sd;)sd=Li[--Mi],Li[Mi]=null,nd=Li[--Mi],Li[Mi]=null;for(;e===Ja;)Ja=Ns[--Es],Ns[Es]=null,bn=Ns[--Es],Ns[Es]=null,wn=Ns[--Es],Ns[Es]=null}var us=null,cs=null,_t=!1,qs=null;function q2(e,t){var r=Ts(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function Yg(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,us=e,cs=ta(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,us=e,cs=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Ja!==null?{id:wn,overflow:bn}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Ts(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,us=e,cs=null,!0):!1;default:return!1}}function vh(e){return(e.mode&1)!==0&&(e.flags&128)===0}function yh(e){if(_t){var t=cs;if(t){var r=t;if(!Yg(e,t)){if(vh(e))throw Error(_e(418));t=ta(r.nextSibling);var s=us;t&&Yg(e,t)?q2(s,r):(e.flags=e.flags&-4097|2,_t=!1,us=e)}}else{if(vh(e))throw Error(_e(418));e.flags=e.flags&-4097|2,_t=!1,us=e}}}function Jg(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;us=e}function Jc(e){if(e!==us)return!1;if(!_t)return Jg(e),_t=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!mh(e.type,e.memoizedProps)),t&&(t=cs)){if(vh(e))throw H2(),Error(_e(418));for(;t;)q2(e,t),t=ta(t.nextSibling)}if(Jg(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(_e(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){cs=ta(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}cs=null}}else cs=us?ta(e.stateNode.nextSibling):null;return!0}function H2(){for(var e=cs;e;)e=ta(e.nextSibling)}function co(){cs=us=null,_t=!1}function np(e){qs===null?qs=[e]:qs.push(e)}var JT=On.ReactCurrentBatchConfig;function Go(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(_e(309));var s=r.stateNode}if(!s)throw Error(_e(147,e));var n=s,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(i){var l=n.refs;i===null?delete l[a]:l[a]=i},t._stringRef=a,t)}if(typeof e!="string")throw Error(_e(284));if(!r._owner)throw Error(_e(290,e))}return e}function Zc(e,t){throw e=Object.prototype.toString.call(t),Error(_e(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Zg(e){var t=e._init;return t(e._payload)}function G2(e){function t(w,v){if(e){var y=w.deletions;y===null?(w.deletions=[v],w.flags|=16):y.push(v)}}function r(w,v){if(!e)return null;for(;v!==null;)t(w,v),v=v.sibling;return null}function s(w,v){for(w=new Map;v!==null;)v.key!==null?w.set(v.key,v):w.set(v.index,v),v=v.sibling;return w}function n(w,v){return w=aa(w,v),w.index=0,w.sibling=null,w}function a(w,v,y){return w.index=y,e?(y=w.alternate,y!==null?(y=y.index,y<v?(w.flags|=2,v):y):(w.flags|=2,v)):(w.flags|=1048576,v)}function i(w){return e&&w.alternate===null&&(w.flags|=2),w}function l(w,v,y,b){return v===null||v.tag!==6?(v=Z0(y,w.mode,b),v.return=w,v):(v=n(v,y),v.return=w,v)}function c(w,v,y,b){var S=y.type;return S===Fi?d(w,v,y.props.children,b,y.key):v!==null&&(v.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Vn&&Zg(S)===v.type)?(b=n(v,y.props),b.ref=Go(w,v,y),b.return=w,b):(b=Bu(y.type,y.key,y.props,null,w.mode,b),b.ref=Go(w,v,y),b.return=w,b)}function u(w,v,y,b){return v===null||v.tag!==4||v.stateNode.containerInfo!==y.containerInfo||v.stateNode.implementation!==y.implementation?(v=ef(y,w.mode,b),v.return=w,v):(v=n(v,y.children||[]),v.return=w,v)}function d(w,v,y,b,S){return v===null||v.tag!==7?(v=Wa(y,w.mode,b,S),v.return=w,v):(v=n(v,y),v.return=w,v)}function f(w,v,y){if(typeof v=="string"&&v!==""||typeof v=="number")return v=Z0(""+v,w.mode,y),v.return=w,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case $c:return y=Bu(v.type,v.key,v.props,null,w.mode,y),y.ref=Go(w,null,v),y.return=w,y;case Ai:return v=ef(v,w.mode,y),v.return=w,v;case Vn:var b=v._init;return f(w,b(v._payload),y)}if(Zo(v)||$o(v))return v=Wa(v,w.mode,y,null),v.return=w,v;Zc(w,v)}return null}function h(w,v,y,b){var S=v!==null?v.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return S!==null?null:l(w,v,""+y,b);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case $c:return y.key===S?c(w,v,y,b):null;case Ai:return y.key===S?u(w,v,y,b):null;case Vn:return S=y._init,h(w,v,S(y._payload),b)}if(Zo(y)||$o(y))return S!==null?null:d(w,v,y,b,null);Zc(w,y)}return null}function m(w,v,y,b,S){if(typeof b=="string"&&b!==""||typeof b=="number")return w=w.get(y)||null,l(v,w,""+b,S);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case $c:return w=w.get(b.key===null?y:b.key)||null,c(v,w,b,S);case Ai:return w=w.get(b.key===null?y:b.key)||null,u(v,w,b,S);case Vn:var _=b._init;return m(w,v,y,_(b._payload),S)}if(Zo(b)||$o(b))return w=w.get(y)||null,d(v,w,b,S,null);Zc(v,b)}return null}function x(w,v,y,b){for(var S=null,_=null,k=v,E=v=0,T=null;k!==null&&E<y.length;E++){k.index>E?(T=k,k=null):T=k.sibling;var M=h(w,k,y[E],b);if(M===null){k===null&&(k=T);break}e&&k&&M.alternate===null&&t(w,k),v=a(M,v,E),_===null?S=M:_.sibling=M,_=M,k=T}if(E===y.length)return r(w,k),_t&&Ta(w,E),S;if(k===null){for(;E<y.length;E++)k=f(w,y[E],b),k!==null&&(v=a(k,v,E),_===null?S=k:_.sibling=k,_=k);return _t&&Ta(w,E),S}for(k=s(w,k);E<y.length;E++)T=m(k,w,E,y[E],b),T!==null&&(e&&T.alternate!==null&&k.delete(T.key===null?E:T.key),v=a(T,v,E),_===null?S=T:_.sibling=T,_=T);return e&&k.forEach(function(q){return t(w,q)}),_t&&Ta(w,E),S}function p(w,v,y,b){var S=$o(y);if(typeof S!="function")throw Error(_e(150));if(y=S.call(y),y==null)throw Error(_e(151));for(var _=S=null,k=v,E=v=0,T=null,M=y.next();k!==null&&!M.done;E++,M=y.next()){k.index>E?(T=k,k=null):T=k.sibling;var q=h(w,k,M.value,b);if(q===null){k===null&&(k=T);break}e&&k&&q.alternate===null&&t(w,k),v=a(q,v,E),_===null?S=q:_.sibling=q,_=q,k=T}if(M.done)return r(w,k),_t&&Ta(w,E),S;if(k===null){for(;!M.done;E++,M=y.next())M=f(w,M.value,b),M!==null&&(v=a(M,v,E),_===null?S=M:_.sibling=M,_=M);return _t&&Ta(w,E),S}for(k=s(w,k);!M.done;E++,M=y.next())M=m(k,w,E,M.value,b),M!==null&&(e&&M.alternate!==null&&k.delete(M.key===null?E:M.key),v=a(M,v,E),_===null?S=M:_.sibling=M,_=M);return e&&k.forEach(function(D){return t(w,D)}),_t&&Ta(w,E),S}function g(w,v,y,b){if(typeof y=="object"&&y!==null&&y.type===Fi&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case $c:e:{for(var S=y.key,_=v;_!==null;){if(_.key===S){if(S=y.type,S===Fi){if(_.tag===7){r(w,_.sibling),v=n(_,y.props.children),v.return=w,w=v;break e}}else if(_.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Vn&&Zg(S)===_.type){r(w,_.sibling),v=n(_,y.props),v.ref=Go(w,_,y),v.return=w,w=v;break e}r(w,_);break}else t(w,_);_=_.sibling}y.type===Fi?(v=Wa(y.props.children,w.mode,b,y.key),v.return=w,w=v):(b=Bu(y.type,y.key,y.props,null,w.mode,b),b.ref=Go(w,v,y),b.return=w,w=b)}return i(w);case Ai:e:{for(_=y.key;v!==null;){if(v.key===_)if(v.tag===4&&v.stateNode.containerInfo===y.containerInfo&&v.stateNode.implementation===y.implementation){r(w,v.sibling),v=n(v,y.children||[]),v.return=w,w=v;break e}else{r(w,v);break}else t(w,v);v=v.sibling}v=ef(y,w.mode,b),v.return=w,w=v}return i(w);case Vn:return _=y._init,g(w,v,_(y._payload),b)}if(Zo(y))return x(w,v,y,b);if($o(y))return p(w,v,y,b);Zc(w,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,v!==null&&v.tag===6?(r(w,v.sibling),v=n(v,y),v.return=w,w=v):(r(w,v),v=Z0(y,w.mode,b),v.return=w,w=v),i(w)):r(w,v)}return g}var uo=G2(!0),K2=G2(!1),ad=xa(null),id=null,Bi=null,ap=null;function ip(){ap=Bi=id=null}function op(e){var t=ad.current;yt(ad),e._currentValue=t}function wh(e,t,r){for(;e!==null;){var s=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,s!==null&&(s.childLanes|=t)):s!==null&&(s.childLanes&t)!==t&&(s.childLanes|=t),e===r)break;e=e.return}}function Ji(e,t){id=e,ap=Bi=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Hr=!0),e.firstContext=null)}function Rs(e){var t=e._currentValue;if(ap!==e)if(e={context:e,memoizedValue:t,next:null},Bi===null){if(id===null)throw Error(_e(308));Bi=e,id.dependencies={lanes:0,firstContext:e}}else Bi=Bi.next=e;return t}var La=null;function lp(e){La===null?La=[e]:La.push(e)}function X2(e,t,r,s){var n=t.interleaved;return n===null?(r.next=r,lp(t)):(r.next=n.next,n.next=r),t.interleaved=r,An(e,s)}function An(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Wn=!1;function cp(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Q2(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function kn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ra(e,t,r){var s=e.updateQueue;if(s===null)return null;if(s=s.shared,st&2){var n=s.pending;return n===null?t.next=t:(t.next=n.next,n.next=t),s.pending=t,An(e,r)}return n=s.interleaved,n===null?(t.next=t,lp(s)):(t.next=n.next,n.next=t),s.interleaved=t,An(e,r)}function Ru(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var s=t.lanes;s&=e.pendingLanes,r|=s,t.lanes=r,Km(e,r)}}function ev(e,t){var r=e.updateQueue,s=e.alternate;if(s!==null&&(s=s.updateQueue,r===s)){var n=null,a=null;if(r=r.firstBaseUpdate,r!==null){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};a===null?n=a=i:a=a.next=i,r=r.next}while(r!==null);a===null?n=a=t:a=a.next=t}else n=a=t;r={baseState:s.baseState,firstBaseUpdate:n,lastBaseUpdate:a,shared:s.shared,effects:s.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function od(e,t,r,s){var n=e.updateQueue;Wn=!1;var a=n.firstBaseUpdate,i=n.lastBaseUpdate,l=n.shared.pending;if(l!==null){n.shared.pending=null;var c=l,u=c.next;c.next=null,i===null?a=u:i.next=u,i=c;var d=e.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==i&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(a!==null){var f=n.baseState;i=0,d=u=c=null,l=a;do{var h=l.lane,m=l.eventTime;if((s&h)===h){d!==null&&(d=d.next={eventTime:m,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var x=e,p=l;switch(h=t,m=r,p.tag){case 1:if(x=p.payload,typeof x=="function"){f=x.call(m,f,h);break e}f=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=p.payload,h=typeof x=="function"?x.call(m,f,h):x,h==null)break e;f=Rt({},f,h);break e;case 2:Wn=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,h=n.effects,h===null?n.effects=[l]:h.push(l))}else m={eventTime:m,lane:h,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=m,c=f):d=d.next=m,i|=h;if(l=l.next,l===null){if(l=n.shared.pending,l===null)break;h=l,l=h.next,h.next=null,n.lastBaseUpdate=h,n.shared.pending=null}}while(!0);if(d===null&&(c=f),n.baseState=c,n.firstBaseUpdate=u,n.lastBaseUpdate=d,t=n.shared.interleaved,t!==null){n=t;do i|=n.lane,n=n.next;while(n!==t)}else a===null&&(n.shared.lanes=0);ei|=i,e.lanes=i,e.memoizedState=f}}function tv(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var s=e[t],n=s.callback;if(n!==null){if(s.callback=null,s=r,typeof n!="function")throw Error(_e(191,n));n.call(s)}}}var Sc={},un=xa(Sc),$l=xa(Sc),Vl=xa(Sc);function Ma(e){if(e===Sc)throw Error(_e(174));return e}function up(e,t){switch(mt(Vl,t),mt($l,e),mt(un,Sc),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:eh(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=eh(t,e)}yt(un),mt(un,t)}function fo(){yt(un),yt($l),yt(Vl)}function Y2(e){Ma(Vl.current);var t=Ma(un.current),r=eh(t,e.type);t!==r&&(mt($l,e),mt(un,r))}function dp(e){$l.current===e&&(yt(un),yt($l))}var Tt=xa(0);function ld(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var G0=[];function fp(){for(var e=0;e<G0.length;e++)G0[e]._workInProgressVersionPrimary=null;G0.length=0}var Iu=On.ReactCurrentDispatcher,K0=On.ReactCurrentBatchConfig,Za=0,Pt=null,Zt=null,ar=null,cd=!1,fl=!1,Wl=0,ZT=0;function yr(){throw Error(_e(321))}function hp(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Zs(e[r],t[r]))return!1;return!0}function mp(e,t,r,s,n,a){if(Za=a,Pt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Iu.current=e===null||e.memoizedState===null?s4:n4,e=r(s,n),fl){a=0;do{if(fl=!1,Wl=0,25<=a)throw Error(_e(301));a+=1,ar=Zt=null,t.updateQueue=null,Iu.current=a4,e=r(s,n)}while(fl)}if(Iu.current=ud,t=Zt!==null&&Zt.next!==null,Za=0,ar=Zt=Pt=null,cd=!1,t)throw Error(_e(300));return e}function pp(){var e=Wl!==0;return Wl=0,e}function an(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ar===null?Pt.memoizedState=ar=e:ar=ar.next=e,ar}function Is(){if(Zt===null){var e=Pt.alternate;e=e!==null?e.memoizedState:null}else e=Zt.next;var t=ar===null?Pt.memoizedState:ar.next;if(t!==null)ar=t,Zt=e;else{if(e===null)throw Error(_e(310));Zt=e,e={memoizedState:Zt.memoizedState,baseState:Zt.baseState,baseQueue:Zt.baseQueue,queue:Zt.queue,next:null},ar===null?Pt.memoizedState=ar=e:ar=ar.next=e}return ar}function ql(e,t){return typeof t=="function"?t(e):t}function X0(e){var t=Is(),r=t.queue;if(r===null)throw Error(_e(311));r.lastRenderedReducer=e;var s=Zt,n=s.baseQueue,a=r.pending;if(a!==null){if(n!==null){var i=n.next;n.next=a.next,a.next=i}s.baseQueue=n=a,r.pending=null}if(n!==null){a=n.next,s=s.baseState;var l=i=null,c=null,u=a;do{var d=u.lane;if((Za&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),s=u.hasEagerState?u.eagerState:e(s,u.action);else{var f={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=f,i=s):c=c.next=f,Pt.lanes|=d,ei|=d}u=u.next}while(u!==null&&u!==a);c===null?i=s:c.next=l,Zs(s,t.memoizedState)||(Hr=!0),t.memoizedState=s,t.baseState=i,t.baseQueue=c,r.lastRenderedState=s}if(e=r.interleaved,e!==null){n=e;do a=n.lane,Pt.lanes|=a,ei|=a,n=n.next;while(n!==e)}else n===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Q0(e){var t=Is(),r=t.queue;if(r===null)throw Error(_e(311));r.lastRenderedReducer=e;var s=r.dispatch,n=r.pending,a=t.memoizedState;if(n!==null){r.pending=null;var i=n=n.next;do a=e(a,i.action),i=i.next;while(i!==n);Zs(a,t.memoizedState)||(Hr=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),r.lastRenderedState=a}return[a,s]}function J2(){}function Z2(e,t){var r=Pt,s=Is(),n=t(),a=!Zs(s.memoizedState,n);if(a&&(s.memoizedState=n,Hr=!0),s=s.queue,xp(rb.bind(null,r,s,e),[e]),s.getSnapshot!==t||a||ar!==null&&ar.memoizedState.tag&1){if(r.flags|=2048,Hl(9,tb.bind(null,r,s,n,t),void 0,null),lr===null)throw Error(_e(349));Za&30||eb(r,t,n)}return n}function eb(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Pt.updateQueue,t===null?(t={lastEffect:null,stores:null},Pt.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function tb(e,t,r,s){t.value=r,t.getSnapshot=s,sb(t)&&nb(e)}function rb(e,t,r){return r(function(){sb(t)&&nb(e)})}function sb(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Zs(e,r)}catch{return!0}}function nb(e){var t=An(e,1);t!==null&&Qs(t,e,1,-1)}function rv(e){var t=an();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ql,lastRenderedState:e},t.queue=e,e=e.dispatch=r4.bind(null,Pt,e),[t.memoizedState,e]}function Hl(e,t,r,s){return e={tag:e,create:t,destroy:r,deps:s,next:null},t=Pt.updateQueue,t===null?(t={lastEffect:null,stores:null},Pt.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(s=r.next,r.next=e,e.next=s,t.lastEffect=e)),e}function ab(){return Is().memoizedState}function Ou(e,t,r,s){var n=an();Pt.flags|=e,n.memoizedState=Hl(1|t,r,void 0,s===void 0?null:s)}function Gd(e,t,r,s){var n=Is();s=s===void 0?null:s;var a=void 0;if(Zt!==null){var i=Zt.memoizedState;if(a=i.destroy,s!==null&&hp(s,i.deps)){n.memoizedState=Hl(t,r,a,s);return}}Pt.flags|=e,n.memoizedState=Hl(1|t,r,a,s)}function sv(e,t){return Ou(8390656,8,e,t)}function xp(e,t){return Gd(2048,8,e,t)}function ib(e,t){return Gd(4,2,e,t)}function ob(e,t){return Gd(4,4,e,t)}function lb(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function cb(e,t,r){return r=r!=null?r.concat([e]):null,Gd(4,4,lb.bind(null,t,e),r)}function gp(){}function ub(e,t){var r=Is();t=t===void 0?null:t;var s=r.memoizedState;return s!==null&&t!==null&&hp(t,s[1])?s[0]:(r.memoizedState=[e,t],e)}function db(e,t){var r=Is();t=t===void 0?null:t;var s=r.memoizedState;return s!==null&&t!==null&&hp(t,s[1])?s[0]:(e=e(),r.memoizedState=[e,t],e)}function fb(e,t,r){return Za&21?(Zs(r,t)||(r=g2(),Pt.lanes|=r,ei|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Hr=!0),e.memoizedState=r)}function e4(e,t){var r=dt;dt=r!==0&&4>r?r:4,e(!0);var s=K0.transition;K0.transition={};try{e(!1),t()}finally{dt=r,K0.transition=s}}function hb(){return Is().memoizedState}function t4(e,t,r){var s=na(e);if(r={lane:s,action:r,hasEagerState:!1,eagerState:null,next:null},mb(e))pb(t,r);else if(r=X2(e,t,r,s),r!==null){var n=Br();Qs(r,e,s,n),xb(r,t,s)}}function r4(e,t,r){var s=na(e),n={lane:s,action:r,hasEagerState:!1,eagerState:null,next:null};if(mb(e))pb(t,n);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var i=t.lastRenderedState,l=a(i,r);if(n.hasEagerState=!0,n.eagerState=l,Zs(l,i)){var c=t.interleaved;c===null?(n.next=n,lp(t)):(n.next=c.next,c.next=n),t.interleaved=n;return}}catch{}finally{}r=X2(e,t,n,s),r!==null&&(n=Br(),Qs(r,e,s,n),xb(r,t,s))}}function mb(e){var t=e.alternate;return e===Pt||t!==null&&t===Pt}function pb(e,t){fl=cd=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function xb(e,t,r){if(r&4194240){var s=t.lanes;s&=e.pendingLanes,r|=s,t.lanes=r,Km(e,r)}}var ud={readContext:Rs,useCallback:yr,useContext:yr,useEffect:yr,useImperativeHandle:yr,useInsertionEffect:yr,useLayoutEffect:yr,useMemo:yr,useReducer:yr,useRef:yr,useState:yr,useDebugValue:yr,useDeferredValue:yr,useTransition:yr,useMutableSource:yr,useSyncExternalStore:yr,useId:yr,unstable_isNewReconciler:!1},s4={readContext:Rs,useCallback:function(e,t){return an().memoizedState=[e,t===void 0?null:t],e},useContext:Rs,useEffect:sv,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Ou(4194308,4,lb.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Ou(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ou(4,2,e,t)},useMemo:function(e,t){var r=an();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var s=an();return t=r!==void 0?r(t):t,s.memoizedState=s.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},s.queue=e,e=e.dispatch=t4.bind(null,Pt,e),[s.memoizedState,e]},useRef:function(e){var t=an();return e={current:e},t.memoizedState=e},useState:rv,useDebugValue:gp,useDeferredValue:function(e){return an().memoizedState=e},useTransition:function(){var e=rv(!1),t=e[0];return e=e4.bind(null,e[1]),an().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var s=Pt,n=an();if(_t){if(r===void 0)throw Error(_e(407));r=r()}else{if(r=t(),lr===null)throw Error(_e(349));Za&30||eb(s,t,r)}n.memoizedState=r;var a={value:r,getSnapshot:t};return n.queue=a,sv(rb.bind(null,s,a,e),[e]),s.flags|=2048,Hl(9,tb.bind(null,s,a,r,t),void 0,null),r},useId:function(){var e=an(),t=lr.identifierPrefix;if(_t){var r=bn,s=wn;r=(s&~(1<<32-Xs(s)-1)).toString(32)+r,t=":"+t+"R"+r,r=Wl++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=ZT++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},n4={readContext:Rs,useCallback:ub,useContext:Rs,useEffect:xp,useImperativeHandle:cb,useInsertionEffect:ib,useLayoutEffect:ob,useMemo:db,useReducer:X0,useRef:ab,useState:function(){return X0(ql)},useDebugValue:gp,useDeferredValue:function(e){var t=Is();return fb(t,Zt.memoizedState,e)},useTransition:function(){var e=X0(ql)[0],t=Is().memoizedState;return[e,t]},useMutableSource:J2,useSyncExternalStore:Z2,useId:hb,unstable_isNewReconciler:!1},a4={readContext:Rs,useCallback:ub,useContext:Rs,useEffect:xp,useImperativeHandle:cb,useInsertionEffect:ib,useLayoutEffect:ob,useMemo:db,useReducer:Q0,useRef:ab,useState:function(){return Q0(ql)},useDebugValue:gp,useDeferredValue:function(e){var t=Is();return Zt===null?t.memoizedState=e:fb(t,Zt.memoizedState,e)},useTransition:function(){var e=Q0(ql)[0],t=Is().memoizedState;return[e,t]},useMutableSource:J2,useSyncExternalStore:Z2,useId:hb,unstable_isNewReconciler:!1};function zs(e,t){if(e&&e.defaultProps){t=Rt({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function bh(e,t,r,s){t=e.memoizedState,r=r(s,t),r=r==null?t:Rt({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Kd={isMounted:function(e){return(e=e._reactInternals)?ui(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var s=Br(),n=na(e),a=kn(s,n);a.payload=t,r!=null&&(a.callback=r),t=ra(e,a,n),t!==null&&(Qs(t,e,n,s),Ru(t,e,n))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var s=Br(),n=na(e),a=kn(s,n);a.tag=1,a.payload=t,r!=null&&(a.callback=r),t=ra(e,a,n),t!==null&&(Qs(t,e,n,s),Ru(t,e,n))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Br(),s=na(e),n=kn(r,s);n.tag=2,t!=null&&(n.callback=t),t=ra(e,n,s),t!==null&&(Qs(t,e,s,r),Ru(t,e,s))}};function nv(e,t,r,s,n,a,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(s,a,i):t.prototype&&t.prototype.isPureReactComponent?!Ml(r,s)||!Ml(n,a):!0}function gb(e,t,r){var s=!1,n=oa,a=t.contextType;return typeof a=="object"&&a!==null?a=Rs(a):(n=Qr(t)?Ya:Ar.current,s=t.contextTypes,a=(s=s!=null)?lo(e,n):oa),t=new t(r,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Kd,e.stateNode=t,t._reactInternals=e,s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=n,e.__reactInternalMemoizedMaskedChildContext=a),t}function av(e,t,r,s){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,s),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,s),t.state!==e&&Kd.enqueueReplaceState(t,t.state,null)}function _h(e,t,r,s){var n=e.stateNode;n.props=r,n.state=e.memoizedState,n.refs={},cp(e);var a=t.contextType;typeof a=="object"&&a!==null?n.context=Rs(a):(a=Qr(t)?Ya:Ar.current,n.context=lo(e,a)),n.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(bh(e,t,a,r),n.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof n.getSnapshotBeforeUpdate=="function"||typeof n.UNSAFE_componentWillMount!="function"&&typeof n.componentWillMount!="function"||(t=n.state,typeof n.componentWillMount=="function"&&n.componentWillMount(),typeof n.UNSAFE_componentWillMount=="function"&&n.UNSAFE_componentWillMount(),t!==n.state&&Kd.enqueueReplaceState(n,n.state,null),od(e,r,n,s),n.state=e.memoizedState),typeof n.componentDidMount=="function"&&(e.flags|=4194308)}function ho(e,t){try{var r="",s=t;do r+=Rj(s),s=s.return;while(s);var n=r}catch(a){n=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:n,digest:null}}function Y0(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Sh(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var i4=typeof WeakMap=="function"?WeakMap:Map;function vb(e,t,r){r=kn(-1,r),r.tag=3,r.payload={element:null};var s=t.value;return r.callback=function(){fd||(fd=!0,Rh=s),Sh(e,t)},r}function yb(e,t,r){r=kn(-1,r),r.tag=3;var s=e.type.getDerivedStateFromError;if(typeof s=="function"){var n=t.value;r.payload=function(){return s(n)},r.callback=function(){Sh(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(r.callback=function(){Sh(e,t),typeof s!="function"&&(sa===null?sa=new Set([this]):sa.add(this));var i=t.stack;this.componentDidCatch(t.value,{componentStack:i!==null?i:""})}),r}function iv(e,t,r){var s=e.pingCache;if(s===null){s=e.pingCache=new i4;var n=new Set;s.set(t,n)}else n=s.get(t),n===void 0&&(n=new Set,s.set(t,n));n.has(r)||(n.add(r),e=w4.bind(null,e,t,r),t.then(e,e))}function ov(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function lv(e,t,r,s,n){return e.mode&1?(e.flags|=65536,e.lanes=n,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=kn(-1,1),t.tag=2,ra(r,t,1))),r.lanes|=1),e)}var o4=On.ReactCurrentOwner,Hr=!1;function Ir(e,t,r,s){t.child=e===null?K2(t,null,r,s):uo(t,e.child,r,s)}function cv(e,t,r,s,n){r=r.render;var a=t.ref;return Ji(t,n),s=mp(e,t,r,s,a,n),r=pp(),e!==null&&!Hr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n,Fn(e,t,n)):(_t&&r&&rp(t),t.flags|=1,Ir(e,t,s,n),t.child)}function uv(e,t,r,s,n){if(e===null){var a=r.type;return typeof a=="function"&&!Np(a)&&a.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=a,wb(e,t,a,s,n)):(e=Bu(r.type,null,s,t,t.mode,n),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!(e.lanes&n)){var i=a.memoizedProps;if(r=r.compare,r=r!==null?r:Ml,r(i,s)&&e.ref===t.ref)return Fn(e,t,n)}return t.flags|=1,e=aa(a,s),e.ref=t.ref,e.return=t,t.child=e}function wb(e,t,r,s,n){if(e!==null){var a=e.memoizedProps;if(Ml(a,s)&&e.ref===t.ref)if(Hr=!1,t.pendingProps=s=a,(e.lanes&n)!==0)e.flags&131072&&(Hr=!0);else return t.lanes=e.lanes,Fn(e,t,n)}return kh(e,t,r,s,n)}function bb(e,t,r){var s=t.pendingProps,n=s.children,a=e!==null?e.memoizedState:null;if(s.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},mt(zi,rs),rs|=r;else{if(!(r&1073741824))return e=a!==null?a.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,mt(zi,rs),rs|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=a!==null?a.baseLanes:r,mt(zi,rs),rs|=s}else a!==null?(s=a.baseLanes|r,t.memoizedState=null):s=r,mt(zi,rs),rs|=s;return Ir(e,t,n,r),t.child}function _b(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function kh(e,t,r,s,n){var a=Qr(r)?Ya:Ar.current;return a=lo(t,a),Ji(t,n),r=mp(e,t,r,s,a,n),s=pp(),e!==null&&!Hr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n,Fn(e,t,n)):(_t&&s&&rp(t),t.flags|=1,Ir(e,t,r,n),t.child)}function dv(e,t,r,s,n){if(Qr(r)){var a=!0;rd(t)}else a=!1;if(Ji(t,n),t.stateNode===null)Du(e,t),gb(t,r,s),_h(t,r,s,n),s=!0;else if(e===null){var i=t.stateNode,l=t.memoizedProps;i.props=l;var c=i.context,u=r.contextType;typeof u=="object"&&u!==null?u=Rs(u):(u=Qr(r)?Ya:Ar.current,u=lo(t,u));var d=r.getDerivedStateFromProps,f=typeof d=="function"||typeof i.getSnapshotBeforeUpdate=="function";f||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(l!==s||c!==u)&&av(t,i,s,u),Wn=!1;var h=t.memoizedState;i.state=h,od(t,s,i,n),c=t.memoizedState,l!==s||h!==c||Xr.current||Wn?(typeof d=="function"&&(bh(t,r,d,s),c=t.memoizedState),(l=Wn||nv(t,r,l,s,h,c,u))?(f||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=s,t.memoizedState=c),i.props=s,i.state=c,i.context=u,s=l):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),s=!1)}else{i=t.stateNode,Q2(e,t),l=t.memoizedProps,u=t.type===t.elementType?l:zs(t.type,l),i.props=u,f=t.pendingProps,h=i.context,c=r.contextType,typeof c=="object"&&c!==null?c=Rs(c):(c=Qr(r)?Ya:Ar.current,c=lo(t,c));var m=r.getDerivedStateFromProps;(d=typeof m=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(l!==f||h!==c)&&av(t,i,s,c),Wn=!1,h=t.memoizedState,i.state=h,od(t,s,i,n);var x=t.memoizedState;l!==f||h!==x||Xr.current||Wn?(typeof m=="function"&&(bh(t,r,m,s),x=t.memoizedState),(u=Wn||nv(t,r,u,s,h,x,c)||!1)?(d||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(s,x,c),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(s,x,c)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=s,t.memoizedState=x),i.props=s,i.state=x,i.context=c,s=u):(typeof i.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),s=!1)}return Nh(e,t,r,s,a,n)}function Nh(e,t,r,s,n,a){_b(e,t);var i=(t.flags&128)!==0;if(!s&&!i)return n&&Qg(t,r,!1),Fn(e,t,a);s=t.stateNode,o4.current=t;var l=i&&typeof r.getDerivedStateFromError!="function"?null:s.render();return t.flags|=1,e!==null&&i?(t.child=uo(t,e.child,null,a),t.child=uo(t,null,l,a)):Ir(e,t,l,a),t.memoizedState=s.state,n&&Qg(t,r,!0),t.child}function Sb(e){var t=e.stateNode;t.pendingContext?Xg(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Xg(e,t.context,!1),up(e,t.containerInfo)}function fv(e,t,r,s,n){return co(),np(n),t.flags|=256,Ir(e,t,r,s),t.child}var Eh={dehydrated:null,treeContext:null,retryLane:0};function jh(e){return{baseLanes:e,cachePool:null,transitions:null}}function kb(e,t,r){var s=t.pendingProps,n=Tt.current,a=!1,i=(t.flags&128)!==0,l;if((l=i)||(l=e!==null&&e.memoizedState===null?!1:(n&2)!==0),l?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(n|=1),mt(Tt,n&1),e===null)return yh(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(i=s.children,e=s.fallback,a?(s=t.mode,a=t.child,i={mode:"hidden",children:i},!(s&1)&&a!==null?(a.childLanes=0,a.pendingProps=i):a=Yd(i,s,0,null),e=Wa(e,s,r,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=jh(r),t.memoizedState=Eh,e):vp(t,i));if(n=e.memoizedState,n!==null&&(l=n.dehydrated,l!==null))return l4(e,t,i,s,l,n,r);if(a){a=s.fallback,i=t.mode,n=e.child,l=n.sibling;var c={mode:"hidden",children:s.children};return!(i&1)&&t.child!==n?(s=t.child,s.childLanes=0,s.pendingProps=c,t.deletions=null):(s=aa(n,c),s.subtreeFlags=n.subtreeFlags&14680064),l!==null?a=aa(l,a):(a=Wa(a,i,r,null),a.flags|=2),a.return=t,s.return=t,s.sibling=a,t.child=s,s=a,a=t.child,i=e.child.memoizedState,i=i===null?jh(r):{baseLanes:i.baseLanes|r,cachePool:null,transitions:i.transitions},a.memoizedState=i,a.childLanes=e.childLanes&~r,t.memoizedState=Eh,s}return a=e.child,e=a.sibling,s=aa(a,{mode:"visible",children:s.children}),!(t.mode&1)&&(s.lanes=r),s.return=t,s.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=s,t.memoizedState=null,s}function vp(e,t){return t=Yd({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function eu(e,t,r,s){return s!==null&&np(s),uo(t,e.child,null,r),e=vp(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function l4(e,t,r,s,n,a,i){if(r)return t.flags&256?(t.flags&=-257,s=Y0(Error(_e(422))),eu(e,t,i,s)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=s.fallback,n=t.mode,s=Yd({mode:"visible",children:s.children},n,0,null),a=Wa(a,n,i,null),a.flags|=2,s.return=t,a.return=t,s.sibling=a,t.child=s,t.mode&1&&uo(t,e.child,null,i),t.child.memoizedState=jh(i),t.memoizedState=Eh,a);if(!(t.mode&1))return eu(e,t,i,null);if(n.data==="$!"){if(s=n.nextSibling&&n.nextSibling.dataset,s)var l=s.dgst;return s=l,a=Error(_e(419)),s=Y0(a,s,void 0),eu(e,t,i,s)}if(l=(i&e.childLanes)!==0,Hr||l){if(s=lr,s!==null){switch(i&-i){case 4:n=2;break;case 16:n=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:n=32;break;case 536870912:n=268435456;break;default:n=0}n=n&(s.suspendedLanes|i)?0:n,n!==0&&n!==a.retryLane&&(a.retryLane=n,An(e,n),Qs(s,e,n,-1))}return kp(),s=Y0(Error(_e(421))),eu(e,t,i,s)}return n.data==="$?"?(t.flags|=128,t.child=e.child,t=b4.bind(null,e),n._reactRetry=t,null):(e=a.treeContext,cs=ta(n.nextSibling),us=t,_t=!0,qs=null,e!==null&&(Ns[Es++]=wn,Ns[Es++]=bn,Ns[Es++]=Ja,wn=e.id,bn=e.overflow,Ja=t),t=vp(t,s.children),t.flags|=4096,t)}function hv(e,t,r){e.lanes|=t;var s=e.alternate;s!==null&&(s.lanes|=t),wh(e.return,t,r)}function J0(e,t,r,s,n){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:s,tail:r,tailMode:n}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=s,a.tail=r,a.tailMode=n)}function Nb(e,t,r){var s=t.pendingProps,n=s.revealOrder,a=s.tail;if(Ir(e,t,s.children,r),s=Tt.current,s&2)s=s&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&hv(e,r,t);else if(e.tag===19)hv(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}s&=1}if(mt(Tt,s),!(t.mode&1))t.memoizedState=null;else switch(n){case"forwards":for(r=t.child,n=null;r!==null;)e=r.alternate,e!==null&&ld(e)===null&&(n=r),r=r.sibling;r=n,r===null?(n=t.child,t.child=null):(n=r.sibling,r.sibling=null),J0(t,!1,n,r,a);break;case"backwards":for(r=null,n=t.child,t.child=null;n!==null;){if(e=n.alternate,e!==null&&ld(e)===null){t.child=n;break}e=n.sibling,n.sibling=r,r=n,n=e}J0(t,!0,r,null,a);break;case"together":J0(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Du(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Fn(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),ei|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(_e(153));if(t.child!==null){for(e=t.child,r=aa(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=aa(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function c4(e,t,r){switch(t.tag){case 3:Sb(t),co();break;case 5:Y2(t);break;case 1:Qr(t.type)&&rd(t);break;case 4:up(t,t.stateNode.containerInfo);break;case 10:var s=t.type._context,n=t.memoizedProps.value;mt(ad,s._currentValue),s._currentValue=n;break;case 13:if(s=t.memoizedState,s!==null)return s.dehydrated!==null?(mt(Tt,Tt.current&1),t.flags|=128,null):r&t.child.childLanes?kb(e,t,r):(mt(Tt,Tt.current&1),e=Fn(e,t,r),e!==null?e.sibling:null);mt(Tt,Tt.current&1);break;case 19:if(s=(r&t.childLanes)!==0,e.flags&128){if(s)return Nb(e,t,r);t.flags|=128}if(n=t.memoizedState,n!==null&&(n.rendering=null,n.tail=null,n.lastEffect=null),mt(Tt,Tt.current),s)break;return null;case 22:case 23:return t.lanes=0,bb(e,t,r)}return Fn(e,t,r)}var Eb,Th,jb,Tb;Eb=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Th=function(){};jb=function(e,t,r,s){var n=e.memoizedProps;if(n!==s){e=t.stateNode,Ma(un.current);var a=null;switch(r){case"input":n=Qf(e,n),s=Qf(e,s),a=[];break;case"select":n=Rt({},n,{value:void 0}),s=Rt({},s,{value:void 0}),a=[];break;case"textarea":n=Zf(e,n),s=Zf(e,s),a=[];break;default:typeof n.onClick!="function"&&typeof s.onClick=="function"&&(e.onclick=ed)}th(r,s);var i;r=null;for(u in n)if(!s.hasOwnProperty(u)&&n.hasOwnProperty(u)&&n[u]!=null)if(u==="style"){var l=n[u];for(i in l)l.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Fl.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in s){var c=s[u];if(l=n!=null?n[u]:void 0,s.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(i in l)!l.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in c)c.hasOwnProperty(i)&&l[i]!==c[i]&&(r||(r={}),r[i]=c[i])}else r||(a||(a=[]),a.push(u,r)),r=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(a=a||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(a=a||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Fl.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&gt("scroll",e),a||l===c||(a=[])):(a=a||[]).push(u,c))}r&&(a=a||[]).push("style",r);var u=a;(t.updateQueue=u)&&(t.flags|=4)}};Tb=function(e,t,r,s){r!==s&&(t.flags|=4)};function Ko(e,t){if(!_t)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var s=null;r!==null;)r.alternate!==null&&(s=r),r=r.sibling;s===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:s.sibling=null}}function wr(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,s=0;if(t)for(var n=e.child;n!==null;)r|=n.lanes|n.childLanes,s|=n.subtreeFlags&14680064,s|=n.flags&14680064,n.return=e,n=n.sibling;else for(n=e.child;n!==null;)r|=n.lanes|n.childLanes,s|=n.subtreeFlags,s|=n.flags,n.return=e,n=n.sibling;return e.subtreeFlags|=s,e.childLanes=r,t}function u4(e,t,r){var s=t.pendingProps;switch(sp(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return wr(t),null;case 1:return Qr(t.type)&&td(),wr(t),null;case 3:return s=t.stateNode,fo(),yt(Xr),yt(Ar),fp(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(e===null||e.child===null)&&(Jc(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,qs!==null&&(Dh(qs),qs=null))),Th(e,t),wr(t),null;case 5:dp(t);var n=Ma(Vl.current);if(r=t.type,e!==null&&t.stateNode!=null)jb(e,t,r,s,n),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!s){if(t.stateNode===null)throw Error(_e(166));return wr(t),null}if(e=Ma(un.current),Jc(t)){s=t.stateNode,r=t.type;var a=t.memoizedProps;switch(s[on]=t,s[zl]=a,e=(t.mode&1)!==0,r){case"dialog":gt("cancel",s),gt("close",s);break;case"iframe":case"object":case"embed":gt("load",s);break;case"video":case"audio":for(n=0;n<tl.length;n++)gt(tl[n],s);break;case"source":gt("error",s);break;case"img":case"image":case"link":gt("error",s),gt("load",s);break;case"details":gt("toggle",s);break;case"input":_g(s,a),gt("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!a.multiple},gt("invalid",s);break;case"textarea":kg(s,a),gt("invalid",s)}th(r,a),n=null;for(var i in a)if(a.hasOwnProperty(i)){var l=a[i];i==="children"?typeof l=="string"?s.textContent!==l&&(a.suppressHydrationWarning!==!0&&Yc(s.textContent,l,e),n=["children",l]):typeof l=="number"&&s.textContent!==""+l&&(a.suppressHydrationWarning!==!0&&Yc(s.textContent,l,e),n=["children",""+l]):Fl.hasOwnProperty(i)&&l!=null&&i==="onScroll"&&gt("scroll",s)}switch(r){case"input":Vc(s),Sg(s,a,!0);break;case"textarea":Vc(s),Ng(s);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(s.onclick=ed)}s=n,t.updateQueue=s,s!==null&&(t.flags|=4)}else{i=n.nodeType===9?n:n.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=r2(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof s.is=="string"?e=i.createElement(r,{is:s.is}):(e=i.createElement(r),r==="select"&&(i=e,s.multiple?i.multiple=!0:s.size&&(i.size=s.size))):e=i.createElementNS(e,r),e[on]=t,e[zl]=s,Eb(e,t,!1,!1),t.stateNode=e;e:{switch(i=rh(r,s),r){case"dialog":gt("cancel",e),gt("close",e),n=s;break;case"iframe":case"object":case"embed":gt("load",e),n=s;break;case"video":case"audio":for(n=0;n<tl.length;n++)gt(tl[n],e);n=s;break;case"source":gt("error",e),n=s;break;case"img":case"image":case"link":gt("error",e),gt("load",e),n=s;break;case"details":gt("toggle",e),n=s;break;case"input":_g(e,s),n=Qf(e,s),gt("invalid",e);break;case"option":n=s;break;case"select":e._wrapperState={wasMultiple:!!s.multiple},n=Rt({},s,{value:void 0}),gt("invalid",e);break;case"textarea":kg(e,s),n=Zf(e,s),gt("invalid",e);break;default:n=s}th(r,n),l=n;for(a in l)if(l.hasOwnProperty(a)){var c=l[a];a==="style"?a2(e,c):a==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&s2(e,c)):a==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&Pl(e,c):typeof c=="number"&&Pl(e,""+c):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(Fl.hasOwnProperty(a)?c!=null&&a==="onScroll"&&gt("scroll",e):c!=null&&$m(e,a,c,i))}switch(r){case"input":Vc(e),Sg(e,s,!1);break;case"textarea":Vc(e),Ng(e);break;case"option":s.value!=null&&e.setAttribute("value",""+ia(s.value));break;case"select":e.multiple=!!s.multiple,a=s.value,a!=null?Ki(e,!!s.multiple,a,!1):s.defaultValue!=null&&Ki(e,!!s.multiple,s.defaultValue,!0);break;default:typeof n.onClick=="function"&&(e.onclick=ed)}switch(r){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return wr(t),null;case 6:if(e&&t.stateNode!=null)Tb(e,t,e.memoizedProps,s);else{if(typeof s!="string"&&t.stateNode===null)throw Error(_e(166));if(r=Ma(Vl.current),Ma(un.current),Jc(t)){if(s=t.stateNode,r=t.memoizedProps,s[on]=t,(a=s.nodeValue!==r)&&(e=us,e!==null))switch(e.tag){case 3:Yc(s.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Yc(s.nodeValue,r,(e.mode&1)!==0)}a&&(t.flags|=4)}else s=(r.nodeType===9?r:r.ownerDocument).createTextNode(s),s[on]=t,t.stateNode=s}return wr(t),null;case 13:if(yt(Tt),s=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(_t&&cs!==null&&t.mode&1&&!(t.flags&128))H2(),co(),t.flags|=98560,a=!1;else if(a=Jc(t),s!==null&&s.dehydrated!==null){if(e===null){if(!a)throw Error(_e(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(_e(317));a[on]=t}else co(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;wr(t),a=!1}else qs!==null&&(Dh(qs),qs=null),a=!0;if(!a)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(s=s!==null,s!==(e!==null&&e.memoizedState!==null)&&s&&(t.child.flags|=8192,t.mode&1&&(e===null||Tt.current&1?tr===0&&(tr=3):kp())),t.updateQueue!==null&&(t.flags|=4),wr(t),null);case 4:return fo(),Th(e,t),e===null&&Bl(t.stateNode.containerInfo),wr(t),null;case 10:return op(t.type._context),wr(t),null;case 17:return Qr(t.type)&&td(),wr(t),null;case 19:if(yt(Tt),a=t.memoizedState,a===null)return wr(t),null;if(s=(t.flags&128)!==0,i=a.rendering,i===null)if(s)Ko(a,!1);else{if(tr!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(i=ld(e),i!==null){for(t.flags|=128,Ko(a,!1),s=i.updateQueue,s!==null&&(t.updateQueue=s,t.flags|=4),t.subtreeFlags=0,s=r,r=t.child;r!==null;)a=r,e=s,a.flags&=14680066,i=a.alternate,i===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=i.childLanes,a.lanes=i.lanes,a.child=i.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=i.memoizedProps,a.memoizedState=i.memoizedState,a.updateQueue=i.updateQueue,a.type=i.type,e=i.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return mt(Tt,Tt.current&1|2),t.child}e=e.sibling}a.tail!==null&&zt()>mo&&(t.flags|=128,s=!0,Ko(a,!1),t.lanes=4194304)}else{if(!s)if(e=ld(i),e!==null){if(t.flags|=128,s=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Ko(a,!0),a.tail===null&&a.tailMode==="hidden"&&!i.alternate&&!_t)return wr(t),null}else 2*zt()-a.renderingStartTime>mo&&r!==1073741824&&(t.flags|=128,s=!0,Ko(a,!1),t.lanes=4194304);a.isBackwards?(i.sibling=t.child,t.child=i):(r=a.last,r!==null?r.sibling=i:t.child=i,a.last=i)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=zt(),t.sibling=null,r=Tt.current,mt(Tt,s?r&1|2:r&1),t):(wr(t),null);case 22:case 23:return Sp(),s=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==s&&(t.flags|=8192),s&&t.mode&1?rs&1073741824&&(wr(t),t.subtreeFlags&6&&(t.flags|=8192)):wr(t),null;case 24:return null;case 25:return null}throw Error(_e(156,t.tag))}function d4(e,t){switch(sp(t),t.tag){case 1:return Qr(t.type)&&td(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return fo(),yt(Xr),yt(Ar),fp(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return dp(t),null;case 13:if(yt(Tt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(_e(340));co()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return yt(Tt),null;case 4:return fo(),null;case 10:return op(t.type._context),null;case 22:case 23:return Sp(),null;case 24:return null;default:return null}}var tu=!1,kr=!1,f4=typeof WeakSet=="function"?WeakSet:Set,Oe=null;function Ui(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(s){Ot(e,t,s)}else r.current=null}function Ch(e,t,r){try{r()}catch(s){Ot(e,t,s)}}var mv=!1;function h4(e,t){if(fh=Yu,e=R2(),tp(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var s=r.getSelection&&r.getSelection();if(s&&s.rangeCount!==0){r=s.anchorNode;var n=s.anchorOffset,a=s.focusNode;s=s.focusOffset;try{r.nodeType,a.nodeType}catch{r=null;break e}var i=0,l=-1,c=-1,u=0,d=0,f=e,h=null;t:for(;;){for(var m;f!==r||n!==0&&f.nodeType!==3||(l=i+n),f!==a||s!==0&&f.nodeType!==3||(c=i+s),f.nodeType===3&&(i+=f.nodeValue.length),(m=f.firstChild)!==null;)h=f,f=m;for(;;){if(f===e)break t;if(h===r&&++u===n&&(l=i),h===a&&++d===s&&(c=i),(m=f.nextSibling)!==null)break;f=h,h=f.parentNode}f=m}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(hh={focusedElem:e,selectionRange:r},Yu=!1,Oe=t;Oe!==null;)if(t=Oe,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Oe=e;else for(;Oe!==null;){t=Oe;try{var x=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var p=x.memoizedProps,g=x.memoizedState,w=t.stateNode,v=w.getSnapshotBeforeUpdate(t.elementType===t.type?p:zs(t.type,p),g);w.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var y=t.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(_e(163))}}catch(b){Ot(t,t.return,b)}if(e=t.sibling,e!==null){e.return=t.return,Oe=e;break}Oe=t.return}return x=mv,mv=!1,x}function hl(e,t,r){var s=t.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var n=s=s.next;do{if((n.tag&e)===e){var a=n.destroy;n.destroy=void 0,a!==void 0&&Ch(t,r,a)}n=n.next}while(n!==s)}}function Xd(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var s=r.create;r.destroy=s()}r=r.next}while(r!==t)}}function Ah(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function Cb(e){var t=e.alternate;t!==null&&(e.alternate=null,Cb(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[on],delete t[zl],delete t[xh],delete t[XT],delete t[QT])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Ab(e){return e.tag===5||e.tag===3||e.tag===4}function pv(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Ab(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Fh(e,t,r){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=ed));else if(s!==4&&(e=e.child,e!==null))for(Fh(e,t,r),e=e.sibling;e!==null;)Fh(e,t,r),e=e.sibling}function Ph(e,t,r){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(s!==4&&(e=e.child,e!==null))for(Ph(e,t,r),e=e.sibling;e!==null;)Ph(e,t,r),e=e.sibling}var dr=null,Vs=!1;function Bn(e,t,r){for(r=r.child;r!==null;)Fb(e,t,r),r=r.sibling}function Fb(e,t,r){if(cn&&typeof cn.onCommitFiberUnmount=="function")try{cn.onCommitFiberUnmount(zd,r)}catch{}switch(r.tag){case 5:kr||Ui(r,t);case 6:var s=dr,n=Vs;dr=null,Bn(e,t,r),dr=s,Vs=n,dr!==null&&(Vs?(e=dr,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):dr.removeChild(r.stateNode));break;case 18:dr!==null&&(Vs?(e=dr,r=r.stateNode,e.nodeType===8?q0(e.parentNode,r):e.nodeType===1&&q0(e,r),Dl(e)):q0(dr,r.stateNode));break;case 4:s=dr,n=Vs,dr=r.stateNode.containerInfo,Vs=!0,Bn(e,t,r),dr=s,Vs=n;break;case 0:case 11:case 14:case 15:if(!kr&&(s=r.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){n=s=s.next;do{var a=n,i=a.destroy;a=a.tag,i!==void 0&&(a&2||a&4)&&Ch(r,t,i),n=n.next}while(n!==s)}Bn(e,t,r);break;case 1:if(!kr&&(Ui(r,t),s=r.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=r.memoizedProps,s.state=r.memoizedState,s.componentWillUnmount()}catch(l){Ot(r,t,l)}Bn(e,t,r);break;case 21:Bn(e,t,r);break;case 22:r.mode&1?(kr=(s=kr)||r.memoizedState!==null,Bn(e,t,r),kr=s):Bn(e,t,r);break;default:Bn(e,t,r)}}function xv(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new f4),t.forEach(function(s){var n=_4.bind(null,e,s);r.has(s)||(r.add(s),s.then(n,n))})}}function Ls(e,t){var r=t.deletions;if(r!==null)for(var s=0;s<r.length;s++){var n=r[s];try{var a=e,i=t,l=i;e:for(;l!==null;){switch(l.tag){case 5:dr=l.stateNode,Vs=!1;break e;case 3:dr=l.stateNode.containerInfo,Vs=!0;break e;case 4:dr=l.stateNode.containerInfo,Vs=!0;break e}l=l.return}if(dr===null)throw Error(_e(160));Fb(a,i,n),dr=null,Vs=!1;var c=n.alternate;c!==null&&(c.return=null),n.return=null}catch(u){Ot(n,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Pb(t,e),t=t.sibling}function Pb(e,t){var r=e.alternate,s=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Ls(t,e),en(e),s&4){try{hl(3,e,e.return),Xd(3,e)}catch(p){Ot(e,e.return,p)}try{hl(5,e,e.return)}catch(p){Ot(e,e.return,p)}}break;case 1:Ls(t,e),en(e),s&512&&r!==null&&Ui(r,r.return);break;case 5:if(Ls(t,e),en(e),s&512&&r!==null&&Ui(r,r.return),e.flags&32){var n=e.stateNode;try{Pl(n,"")}catch(p){Ot(e,e.return,p)}}if(s&4&&(n=e.stateNode,n!=null)){var a=e.memoizedProps,i=r!==null?r.memoizedProps:a,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&a.type==="radio"&&a.name!=null&&e2(n,a),rh(l,i);var u=rh(l,a);for(i=0;i<c.length;i+=2){var d=c[i],f=c[i+1];d==="style"?a2(n,f):d==="dangerouslySetInnerHTML"?s2(n,f):d==="children"?Pl(n,f):$m(n,d,f,u)}switch(l){case"input":Yf(n,a);break;case"textarea":t2(n,a);break;case"select":var h=n._wrapperState.wasMultiple;n._wrapperState.wasMultiple=!!a.multiple;var m=a.value;m!=null?Ki(n,!!a.multiple,m,!1):h!==!!a.multiple&&(a.defaultValue!=null?Ki(n,!!a.multiple,a.defaultValue,!0):Ki(n,!!a.multiple,a.multiple?[]:"",!1))}n[zl]=a}catch(p){Ot(e,e.return,p)}}break;case 6:if(Ls(t,e),en(e),s&4){if(e.stateNode===null)throw Error(_e(162));n=e.stateNode,a=e.memoizedProps;try{n.nodeValue=a}catch(p){Ot(e,e.return,p)}}break;case 3:if(Ls(t,e),en(e),s&4&&r!==null&&r.memoizedState.isDehydrated)try{Dl(t.containerInfo)}catch(p){Ot(e,e.return,p)}break;case 4:Ls(t,e),en(e);break;case 13:Ls(t,e),en(e),n=e.child,n.flags&8192&&(a=n.memoizedState!==null,n.stateNode.isHidden=a,!a||n.alternate!==null&&n.alternate.memoizedState!==null||(bp=zt())),s&4&&xv(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(kr=(u=kr)||d,Ls(t,e),kr=u):Ls(t,e),en(e),s&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!d&&e.mode&1)for(Oe=e,d=e.child;d!==null;){for(f=Oe=d;Oe!==null;){switch(h=Oe,m=h.child,h.tag){case 0:case 11:case 14:case 15:hl(4,h,h.return);break;case 1:Ui(h,h.return);var x=h.stateNode;if(typeof x.componentWillUnmount=="function"){s=h,r=h.return;try{t=s,x.props=t.memoizedProps,x.state=t.memoizedState,x.componentWillUnmount()}catch(p){Ot(s,r,p)}}break;case 5:Ui(h,h.return);break;case 22:if(h.memoizedState!==null){vv(f);continue}}m!==null?(m.return=h,Oe=m):vv(f)}d=d.sibling}e:for(d=null,f=e;;){if(f.tag===5){if(d===null){d=f;try{n=f.stateNode,u?(a=n.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(l=f.stateNode,c=f.memoizedProps.style,i=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=n2("display",i))}catch(p){Ot(e,e.return,p)}}}else if(f.tag===6){if(d===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(p){Ot(e,e.return,p)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Ls(t,e),en(e),s&4&&xv(e);break;case 21:break;default:Ls(t,e),en(e)}}function en(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(Ab(r)){var s=r;break e}r=r.return}throw Error(_e(160))}switch(s.tag){case 5:var n=s.stateNode;s.flags&32&&(Pl(n,""),s.flags&=-33);var a=pv(e);Ph(e,a,n);break;case 3:case 4:var i=s.stateNode.containerInfo,l=pv(e);Fh(e,l,i);break;default:throw Error(_e(161))}}catch(c){Ot(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function m4(e,t,r){Oe=e,Rb(e)}function Rb(e,t,r){for(var s=(e.mode&1)!==0;Oe!==null;){var n=Oe,a=n.child;if(n.tag===22&&s){var i=n.memoizedState!==null||tu;if(!i){var l=n.alternate,c=l!==null&&l.memoizedState!==null||kr;l=tu;var u=kr;if(tu=i,(kr=c)&&!u)for(Oe=n;Oe!==null;)i=Oe,c=i.child,i.tag===22&&i.memoizedState!==null?yv(n):c!==null?(c.return=i,Oe=c):yv(n);for(;a!==null;)Oe=a,Rb(a),a=a.sibling;Oe=n,tu=l,kr=u}gv(e)}else n.subtreeFlags&8772&&a!==null?(a.return=n,Oe=a):gv(e)}}function gv(e){for(;Oe!==null;){var t=Oe;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:kr||Xd(5,t);break;case 1:var s=t.stateNode;if(t.flags&4&&!kr)if(r===null)s.componentDidMount();else{var n=t.elementType===t.type?r.memoizedProps:zs(t.type,r.memoizedProps);s.componentDidUpdate(n,r.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&tv(t,a,s);break;case 3:var i=t.updateQueue;if(i!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}tv(t,i,r)}break;case 5:var l=t.stateNode;if(r===null&&t.flags&4){r=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var f=d.dehydrated;f!==null&&Dl(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(_e(163))}kr||t.flags&512&&Ah(t)}catch(h){Ot(t,t.return,h)}}if(t===e){Oe=null;break}if(r=t.sibling,r!==null){r.return=t.return,Oe=r;break}Oe=t.return}}function vv(e){for(;Oe!==null;){var t=Oe;if(t===e){Oe=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Oe=r;break}Oe=t.return}}function yv(e){for(;Oe!==null;){var t=Oe;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Xd(4,t)}catch(c){Ot(t,r,c)}break;case 1:var s=t.stateNode;if(typeof s.componentDidMount=="function"){var n=t.return;try{s.componentDidMount()}catch(c){Ot(t,n,c)}}var a=t.return;try{Ah(t)}catch(c){Ot(t,a,c)}break;case 5:var i=t.return;try{Ah(t)}catch(c){Ot(t,i,c)}}}catch(c){Ot(t,t.return,c)}if(t===e){Oe=null;break}var l=t.sibling;if(l!==null){l.return=t.return,Oe=l;break}Oe=t.return}}var p4=Math.ceil,dd=On.ReactCurrentDispatcher,yp=On.ReactCurrentOwner,As=On.ReactCurrentBatchConfig,st=0,lr=null,Qt=null,xr=0,rs=0,zi=xa(0),tr=0,Gl=null,ei=0,Qd=0,wp=0,ml=null,qr=null,bp=0,mo=1/0,gn=null,fd=!1,Rh=null,sa=null,ru=!1,Xn=null,hd=0,pl=0,Ih=null,Lu=-1,Mu=0;function Br(){return st&6?zt():Lu!==-1?Lu:Lu=zt()}function na(e){return e.mode&1?st&2&&xr!==0?xr&-xr:JT.transition!==null?(Mu===0&&(Mu=g2()),Mu):(e=dt,e!==0||(e=window.event,e=e===void 0?16:k2(e.type)),e):1}function Qs(e,t,r,s){if(50<pl)throw pl=0,Ih=null,Error(_e(185));wc(e,r,s),(!(st&2)||e!==lr)&&(e===lr&&(!(st&2)&&(Qd|=r),tr===4&&Hn(e,xr)),Yr(e,s),r===1&&st===0&&!(t.mode&1)&&(mo=zt()+500,Hd&&ga()))}function Yr(e,t){var r=e.callbackNode;Jj(e,t);var s=Qu(e,e===lr?xr:0);if(s===0)r!==null&&Tg(r),e.callbackNode=null,e.callbackPriority=0;else if(t=s&-s,e.callbackPriority!==t){if(r!=null&&Tg(r),t===1)e.tag===0?YT(wv.bind(null,e)):V2(wv.bind(null,e)),GT(function(){!(st&6)&&ga()}),r=null;else{switch(v2(s)){case 1:r=Gm;break;case 4:r=p2;break;case 16:r=Xu;break;case 536870912:r=x2;break;default:r=Xu}r=zb(r,Ib.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function Ib(e,t){if(Lu=-1,Mu=0,st&6)throw Error(_e(327));var r=e.callbackNode;if(Zi()&&e.callbackNode!==r)return null;var s=Qu(e,e===lr?xr:0);if(s===0)return null;if(s&30||s&e.expiredLanes||t)t=md(e,s);else{t=s;var n=st;st|=2;var a=Db();(lr!==e||xr!==t)&&(gn=null,mo=zt()+500,Va(e,t));do try{v4();break}catch(l){Ob(e,l)}while(!0);ip(),dd.current=a,st=n,Qt!==null?t=0:(lr=null,xr=0,t=tr)}if(t!==0){if(t===2&&(n=oh(e),n!==0&&(s=n,t=Oh(e,n))),t===1)throw r=Gl,Va(e,0),Hn(e,s),Yr(e,zt()),r;if(t===6)Hn(e,s);else{if(n=e.current.alternate,!(s&30)&&!x4(n)&&(t=md(e,s),t===2&&(a=oh(e),a!==0&&(s=a,t=Oh(e,a))),t===1))throw r=Gl,Va(e,0),Hn(e,s),Yr(e,zt()),r;switch(e.finishedWork=n,e.finishedLanes=s,t){case 0:case 1:throw Error(_e(345));case 2:Ca(e,qr,gn);break;case 3:if(Hn(e,s),(s&130023424)===s&&(t=bp+500-zt(),10<t)){if(Qu(e,0)!==0)break;if(n=e.suspendedLanes,(n&s)!==s){Br(),e.pingedLanes|=e.suspendedLanes&n;break}e.timeoutHandle=ph(Ca.bind(null,e,qr,gn),t);break}Ca(e,qr,gn);break;case 4:if(Hn(e,s),(s&4194240)===s)break;for(t=e.eventTimes,n=-1;0<s;){var i=31-Xs(s);a=1<<i,i=t[i],i>n&&(n=i),s&=~a}if(s=n,s=zt()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*p4(s/1960))-s,10<s){e.timeoutHandle=ph(Ca.bind(null,e,qr,gn),s);break}Ca(e,qr,gn);break;case 5:Ca(e,qr,gn);break;default:throw Error(_e(329))}}}return Yr(e,zt()),e.callbackNode===r?Ib.bind(null,e):null}function Oh(e,t){var r=ml;return e.current.memoizedState.isDehydrated&&(Va(e,t).flags|=256),e=md(e,t),e!==2&&(t=qr,qr=r,t!==null&&Dh(t)),e}function Dh(e){qr===null?qr=e:qr.push.apply(qr,e)}function x4(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var s=0;s<r.length;s++){var n=r[s],a=n.getSnapshot;n=n.value;try{if(!Zs(a(),n))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Hn(e,t){for(t&=~wp,t&=~Qd,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Xs(t),s=1<<r;e[r]=-1,t&=~s}}function wv(e){if(st&6)throw Error(_e(327));Zi();var t=Qu(e,0);if(!(t&1))return Yr(e,zt()),null;var r=md(e,t);if(e.tag!==0&&r===2){var s=oh(e);s!==0&&(t=s,r=Oh(e,s))}if(r===1)throw r=Gl,Va(e,0),Hn(e,t),Yr(e,zt()),r;if(r===6)throw Error(_e(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ca(e,qr,gn),Yr(e,zt()),null}function _p(e,t){var r=st;st|=1;try{return e(t)}finally{st=r,st===0&&(mo=zt()+500,Hd&&ga())}}function ti(e){Xn!==null&&Xn.tag===0&&!(st&6)&&Zi();var t=st;st|=1;var r=As.transition,s=dt;try{if(As.transition=null,dt=1,e)return e()}finally{dt=s,As.transition=r,st=t,!(st&6)&&ga()}}function Sp(){rs=zi.current,yt(zi)}function Va(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,HT(r)),Qt!==null)for(r=Qt.return;r!==null;){var s=r;switch(sp(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&td();break;case 3:fo(),yt(Xr),yt(Ar),fp();break;case 5:dp(s);break;case 4:fo();break;case 13:yt(Tt);break;case 19:yt(Tt);break;case 10:op(s.type._context);break;case 22:case 23:Sp()}r=r.return}if(lr=e,Qt=e=aa(e.current,null),xr=rs=t,tr=0,Gl=null,wp=Qd=ei=0,qr=ml=null,La!==null){for(t=0;t<La.length;t++)if(r=La[t],s=r.interleaved,s!==null){r.interleaved=null;var n=s.next,a=r.pending;if(a!==null){var i=a.next;a.next=n,s.next=i}r.pending=s}La=null}return e}function Ob(e,t){do{var r=Qt;try{if(ip(),Iu.current=ud,cd){for(var s=Pt.memoizedState;s!==null;){var n=s.queue;n!==null&&(n.pending=null),s=s.next}cd=!1}if(Za=0,ar=Zt=Pt=null,fl=!1,Wl=0,yp.current=null,r===null||r.return===null){tr=1,Gl=t,Qt=null;break}e:{var a=e,i=r.return,l=r,c=t;if(t=xr,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=l,f=d.tag;if(!(d.mode&1)&&(f===0||f===11||f===15)){var h=d.alternate;h?(d.updateQueue=h.updateQueue,d.memoizedState=h.memoizedState,d.lanes=h.lanes):(d.updateQueue=null,d.memoizedState=null)}var m=ov(i);if(m!==null){m.flags&=-257,lv(m,i,l,a,t),m.mode&1&&iv(a,u,t),t=m,c=u;var x=t.updateQueue;if(x===null){var p=new Set;p.add(c),t.updateQueue=p}else x.add(c);break e}else{if(!(t&1)){iv(a,u,t),kp();break e}c=Error(_e(426))}}else if(_t&&l.mode&1){var g=ov(i);if(g!==null){!(g.flags&65536)&&(g.flags|=256),lv(g,i,l,a,t),np(ho(c,l));break e}}a=c=ho(c,l),tr!==4&&(tr=2),ml===null?ml=[a]:ml.push(a),a=i;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var w=vb(a,c,t);ev(a,w);break e;case 1:l=c;var v=a.type,y=a.stateNode;if(!(a.flags&128)&&(typeof v.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(sa===null||!sa.has(y)))){a.flags|=65536,t&=-t,a.lanes|=t;var b=yb(a,l,t);ev(a,b);break e}}a=a.return}while(a!==null)}Mb(r)}catch(S){t=S,Qt===r&&r!==null&&(Qt=r=r.return);continue}break}while(!0)}function Db(){var e=dd.current;return dd.current=ud,e===null?ud:e}function kp(){(tr===0||tr===3||tr===2)&&(tr=4),lr===null||!(ei&268435455)&&!(Qd&268435455)||Hn(lr,xr)}function md(e,t){var r=st;st|=2;var s=Db();(lr!==e||xr!==t)&&(gn=null,Va(e,t));do try{g4();break}catch(n){Ob(e,n)}while(!0);if(ip(),st=r,dd.current=s,Qt!==null)throw Error(_e(261));return lr=null,xr=0,tr}function g4(){for(;Qt!==null;)Lb(Qt)}function v4(){for(;Qt!==null&&!Vj();)Lb(Qt)}function Lb(e){var t=Ub(e.alternate,e,rs);e.memoizedProps=e.pendingProps,t===null?Mb(e):Qt=t,yp.current=null}function Mb(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=d4(r,t),r!==null){r.flags&=32767,Qt=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{tr=6,Qt=null;return}}else if(r=u4(r,t,rs),r!==null){Qt=r;return}if(t=t.sibling,t!==null){Qt=t;return}Qt=t=e}while(t!==null);tr===0&&(tr=5)}function Ca(e,t,r){var s=dt,n=As.transition;try{As.transition=null,dt=1,y4(e,t,r,s)}finally{As.transition=n,dt=s}return null}function y4(e,t,r,s){do Zi();while(Xn!==null);if(st&6)throw Error(_e(327));r=e.finishedWork;var n=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(_e(177));e.callbackNode=null,e.callbackPriority=0;var a=r.lanes|r.childLanes;if(Zj(e,a),e===lr&&(Qt=lr=null,xr=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||ru||(ru=!0,zb(Xu,function(){return Zi(),null})),a=(r.flags&15990)!==0,r.subtreeFlags&15990||a){a=As.transition,As.transition=null;var i=dt;dt=1;var l=st;st|=4,yp.current=null,h4(e,r),Pb(r,e),BT(hh),Yu=!!fh,hh=fh=null,e.current=r,m4(r),Wj(),st=l,dt=i,As.transition=a}else e.current=r;if(ru&&(ru=!1,Xn=e,hd=n),a=e.pendingLanes,a===0&&(sa=null),Gj(r.stateNode),Yr(e,zt()),t!==null)for(s=e.onRecoverableError,r=0;r<t.length;r++)n=t[r],s(n.value,{componentStack:n.stack,digest:n.digest});if(fd)throw fd=!1,e=Rh,Rh=null,e;return hd&1&&e.tag!==0&&Zi(),a=e.pendingLanes,a&1?e===Ih?pl++:(pl=0,Ih=e):pl=0,ga(),null}function Zi(){if(Xn!==null){var e=v2(hd),t=As.transition,r=dt;try{if(As.transition=null,dt=16>e?16:e,Xn===null)var s=!1;else{if(e=Xn,Xn=null,hd=0,st&6)throw Error(_e(331));var n=st;for(st|=4,Oe=e.current;Oe!==null;){var a=Oe,i=a.child;if(Oe.flags&16){var l=a.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(Oe=u;Oe!==null;){var d=Oe;switch(d.tag){case 0:case 11:case 15:hl(8,d,a)}var f=d.child;if(f!==null)f.return=d,Oe=f;else for(;Oe!==null;){d=Oe;var h=d.sibling,m=d.return;if(Cb(d),d===u){Oe=null;break}if(h!==null){h.return=m,Oe=h;break}Oe=m}}}var x=a.alternate;if(x!==null){var p=x.child;if(p!==null){x.child=null;do{var g=p.sibling;p.sibling=null,p=g}while(p!==null)}}Oe=a}}if(a.subtreeFlags&2064&&i!==null)i.return=a,Oe=i;else e:for(;Oe!==null;){if(a=Oe,a.flags&2048)switch(a.tag){case 0:case 11:case 15:hl(9,a,a.return)}var w=a.sibling;if(w!==null){w.return=a.return,Oe=w;break e}Oe=a.return}}var v=e.current;for(Oe=v;Oe!==null;){i=Oe;var y=i.child;if(i.subtreeFlags&2064&&y!==null)y.return=i,Oe=y;else e:for(i=v;Oe!==null;){if(l=Oe,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Xd(9,l)}}catch(S){Ot(l,l.return,S)}if(l===i){Oe=null;break e}var b=l.sibling;if(b!==null){b.return=l.return,Oe=b;break e}Oe=l.return}}if(st=n,ga(),cn&&typeof cn.onPostCommitFiberRoot=="function")try{cn.onPostCommitFiberRoot(zd,e)}catch{}s=!0}return s}finally{dt=r,As.transition=t}}return!1}function bv(e,t,r){t=ho(r,t),t=vb(e,t,1),e=ra(e,t,1),t=Br(),e!==null&&(wc(e,1,t),Yr(e,t))}function Ot(e,t,r){if(e.tag===3)bv(e,e,r);else for(;t!==null;){if(t.tag===3){bv(t,e,r);break}else if(t.tag===1){var s=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(sa===null||!sa.has(s))){e=ho(r,e),e=yb(t,e,1),t=ra(t,e,1),e=Br(),t!==null&&(wc(t,1,e),Yr(t,e));break}}t=t.return}}function w4(e,t,r){var s=e.pingCache;s!==null&&s.delete(t),t=Br(),e.pingedLanes|=e.suspendedLanes&r,lr===e&&(xr&r)===r&&(tr===4||tr===3&&(xr&130023424)===xr&&500>zt()-bp?Va(e,0):wp|=r),Yr(e,t)}function Bb(e,t){t===0&&(e.mode&1?(t=Hc,Hc<<=1,!(Hc&130023424)&&(Hc=4194304)):t=1);var r=Br();e=An(e,t),e!==null&&(wc(e,t,r),Yr(e,r))}function b4(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),Bb(e,r)}function _4(e,t){var r=0;switch(e.tag){case 13:var s=e.stateNode,n=e.memoizedState;n!==null&&(r=n.retryLane);break;case 19:s=e.stateNode;break;default:throw Error(_e(314))}s!==null&&s.delete(t),Bb(e,r)}var Ub;Ub=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Xr.current)Hr=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Hr=!1,c4(e,t,r);Hr=!!(e.flags&131072)}else Hr=!1,_t&&t.flags&1048576&&W2(t,nd,t.index);switch(t.lanes=0,t.tag){case 2:var s=t.type;Du(e,t),e=t.pendingProps;var n=lo(t,Ar.current);Ji(t,r),n=mp(null,t,s,e,n,r);var a=pp();return t.flags|=1,typeof n=="object"&&n!==null&&typeof n.render=="function"&&n.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Qr(s)?(a=!0,rd(t)):a=!1,t.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,cp(t),n.updater=Kd,t.stateNode=n,n._reactInternals=t,_h(t,s,e,r),t=Nh(null,t,s,!0,a,r)):(t.tag=0,_t&&a&&rp(t),Ir(null,t,n,r),t=t.child),t;case 16:s=t.elementType;e:{switch(Du(e,t),e=t.pendingProps,n=s._init,s=n(s._payload),t.type=s,n=t.tag=k4(s),e=zs(s,e),n){case 0:t=kh(null,t,s,e,r);break e;case 1:t=dv(null,t,s,e,r);break e;case 11:t=cv(null,t,s,e,r);break e;case 14:t=uv(null,t,s,zs(s.type,e),r);break e}throw Error(_e(306,s,""))}return t;case 0:return s=t.type,n=t.pendingProps,n=t.elementType===s?n:zs(s,n),kh(e,t,s,n,r);case 1:return s=t.type,n=t.pendingProps,n=t.elementType===s?n:zs(s,n),dv(e,t,s,n,r);case 3:e:{if(Sb(t),e===null)throw Error(_e(387));s=t.pendingProps,a=t.memoizedState,n=a.element,Q2(e,t),od(t,s,null,r);var i=t.memoizedState;if(s=i.element,a.isDehydrated)if(a={element:s,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){n=ho(Error(_e(423)),t),t=fv(e,t,s,r,n);break e}else if(s!==n){n=ho(Error(_e(424)),t),t=fv(e,t,s,r,n);break e}else for(cs=ta(t.stateNode.containerInfo.firstChild),us=t,_t=!0,qs=null,r=K2(t,null,s,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(co(),s===n){t=Fn(e,t,r);break e}Ir(e,t,s,r)}t=t.child}return t;case 5:return Y2(t),e===null&&yh(t),s=t.type,n=t.pendingProps,a=e!==null?e.memoizedProps:null,i=n.children,mh(s,n)?i=null:a!==null&&mh(s,a)&&(t.flags|=32),_b(e,t),Ir(e,t,i,r),t.child;case 6:return e===null&&yh(t),null;case 13:return kb(e,t,r);case 4:return up(t,t.stateNode.containerInfo),s=t.pendingProps,e===null?t.child=uo(t,null,s,r):Ir(e,t,s,r),t.child;case 11:return s=t.type,n=t.pendingProps,n=t.elementType===s?n:zs(s,n),cv(e,t,s,n,r);case 7:return Ir(e,t,t.pendingProps,r),t.child;case 8:return Ir(e,t,t.pendingProps.children,r),t.child;case 12:return Ir(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(s=t.type._context,n=t.pendingProps,a=t.memoizedProps,i=n.value,mt(ad,s._currentValue),s._currentValue=i,a!==null)if(Zs(a.value,i)){if(a.children===n.children&&!Xr.current){t=Fn(e,t,r);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var l=a.dependencies;if(l!==null){i=a.child;for(var c=l.firstContext;c!==null;){if(c.context===s){if(a.tag===1){c=kn(-1,r&-r),c.tag=2;var u=a.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}a.lanes|=r,c=a.alternate,c!==null&&(c.lanes|=r),wh(a.return,r,t),l.lanes|=r;break}c=c.next}}else if(a.tag===10)i=a.type===t.type?null:a.child;else if(a.tag===18){if(i=a.return,i===null)throw Error(_e(341));i.lanes|=r,l=i.alternate,l!==null&&(l.lanes|=r),wh(i,r,t),i=a.sibling}else i=a.child;if(i!==null)i.return=a;else for(i=a;i!==null;){if(i===t){i=null;break}if(a=i.sibling,a!==null){a.return=i.return,i=a;break}i=i.return}a=i}Ir(e,t,n.children,r),t=t.child}return t;case 9:return n=t.type,s=t.pendingProps.children,Ji(t,r),n=Rs(n),s=s(n),t.flags|=1,Ir(e,t,s,r),t.child;case 14:return s=t.type,n=zs(s,t.pendingProps),n=zs(s.type,n),uv(e,t,s,n,r);case 15:return wb(e,t,t.type,t.pendingProps,r);case 17:return s=t.type,n=t.pendingProps,n=t.elementType===s?n:zs(s,n),Du(e,t),t.tag=1,Qr(s)?(e=!0,rd(t)):e=!1,Ji(t,r),gb(t,s,n),_h(t,s,n,r),Nh(null,t,s,!0,e,r);case 19:return Nb(e,t,r);case 22:return bb(e,t,r)}throw Error(_e(156,t.tag))};function zb(e,t){return m2(e,t)}function S4(e,t,r,s){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ts(e,t,r,s){return new S4(e,t,r,s)}function Np(e){return e=e.prototype,!(!e||!e.isReactComponent)}function k4(e){if(typeof e=="function")return Np(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Wm)return 11;if(e===qm)return 14}return 2}function aa(e,t){var r=e.alternate;return r===null?(r=Ts(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Bu(e,t,r,s,n,a){var i=2;if(s=e,typeof e=="function")Np(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case Fi:return Wa(r.children,n,a,t);case Vm:i=8,n|=8;break;case Hf:return e=Ts(12,r,t,n|2),e.elementType=Hf,e.lanes=a,e;case Gf:return e=Ts(13,r,t,n),e.elementType=Gf,e.lanes=a,e;case Kf:return e=Ts(19,r,t,n),e.elementType=Kf,e.lanes=a,e;case Yw:return Yd(r,n,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Xw:i=10;break e;case Qw:i=9;break e;case Wm:i=11;break e;case qm:i=14;break e;case Vn:i=16,s=null;break e}throw Error(_e(130,e==null?e:typeof e,""))}return t=Ts(i,r,t,n),t.elementType=e,t.type=s,t.lanes=a,t}function Wa(e,t,r,s){return e=Ts(7,e,s,t),e.lanes=r,e}function Yd(e,t,r,s){return e=Ts(22,e,s,t),e.elementType=Yw,e.lanes=r,e.stateNode={isHidden:!1},e}function Z0(e,t,r){return e=Ts(6,e,null,t),e.lanes=r,e}function ef(e,t,r){return t=Ts(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function N4(e,t,r,s,n){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=I0(0),this.expirationTimes=I0(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=I0(0),this.identifierPrefix=s,this.onRecoverableError=n,this.mutableSourceEagerHydrationData=null}function Ep(e,t,r,s,n,a,i,l,c){return e=new N4(e,t,r,l,c),t===1?(t=1,a===!0&&(t|=8)):t=0,a=Ts(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:s,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},cp(a),e}function E4(e,t,r){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ai,key:s==null?null:""+s,children:e,containerInfo:t,implementation:r}}function $b(e){if(!e)return oa;e=e._reactInternals;e:{if(ui(e)!==e||e.tag!==1)throw Error(_e(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Qr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(_e(171))}if(e.tag===1){var r=e.type;if(Qr(r))return $2(e,r,t)}return t}function Vb(e,t,r,s,n,a,i,l,c){return e=Ep(r,s,!0,e,n,a,i,l,c),e.context=$b(null),r=e.current,s=Br(),n=na(r),a=kn(s,n),a.callback=t??null,ra(r,a,n),e.current.lanes=n,wc(e,n,s),Yr(e,s),e}function Jd(e,t,r,s){var n=t.current,a=Br(),i=na(n);return r=$b(r),t.context===null?t.context=r:t.pendingContext=r,t=kn(a,i),t.payload={element:e},s=s===void 0?null:s,s!==null&&(t.callback=s),e=ra(n,t,i),e!==null&&(Qs(e,n,i,a),Ru(e,n,i)),i}function pd(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function _v(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function jp(e,t){_v(e,t),(e=e.alternate)&&_v(e,t)}function j4(){return null}var Wb=typeof reportError=="function"?reportError:function(e){console.error(e)};function Tp(e){this._internalRoot=e}Zd.prototype.render=Tp.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(_e(409));Jd(e,t,null,null)};Zd.prototype.unmount=Tp.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;ti(function(){Jd(null,e,null,null)}),t[Cn]=null}};function Zd(e){this._internalRoot=e}Zd.prototype.unstable_scheduleHydration=function(e){if(e){var t=b2();e={blockedOn:null,target:e,priority:t};for(var r=0;r<qn.length&&t!==0&&t<qn[r].priority;r++);qn.splice(r,0,e),r===0&&S2(e)}};function Cp(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function e0(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Sv(){}function T4(e,t,r,s,n){if(n){if(typeof s=="function"){var a=s;s=function(){var u=pd(i);a.call(u)}}var i=Vb(t,s,e,0,null,!1,!1,"",Sv);return e._reactRootContainer=i,e[Cn]=i.current,Bl(e.nodeType===8?e.parentNode:e),ti(),i}for(;n=e.lastChild;)e.removeChild(n);if(typeof s=="function"){var l=s;s=function(){var u=pd(c);l.call(u)}}var c=Ep(e,0,!1,null,null,!1,!1,"",Sv);return e._reactRootContainer=c,e[Cn]=c.current,Bl(e.nodeType===8?e.parentNode:e),ti(function(){Jd(t,c,r,s)}),c}function t0(e,t,r,s,n){var a=r._reactRootContainer;if(a){var i=a;if(typeof n=="function"){var l=n;n=function(){var c=pd(i);l.call(c)}}Jd(t,i,e,n)}else i=T4(r,t,e,n,s);return pd(i)}y2=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=el(t.pendingLanes);r!==0&&(Km(t,r|1),Yr(t,zt()),!(st&6)&&(mo=zt()+500,ga()))}break;case 13:ti(function(){var s=An(e,1);if(s!==null){var n=Br();Qs(s,e,1,n)}}),jp(e,1)}};Xm=function(e){if(e.tag===13){var t=An(e,134217728);if(t!==null){var r=Br();Qs(t,e,134217728,r)}jp(e,134217728)}};w2=function(e){if(e.tag===13){var t=na(e),r=An(e,t);if(r!==null){var s=Br();Qs(r,e,t,s)}jp(e,t)}};b2=function(){return dt};_2=function(e,t){var r=dt;try{return dt=e,t()}finally{dt=r}};nh=function(e,t,r){switch(t){case"input":if(Yf(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var s=r[t];if(s!==e&&s.form===e.form){var n=qd(s);if(!n)throw Error(_e(90));Zw(s),Yf(s,n)}}}break;case"textarea":t2(e,r);break;case"select":t=r.value,t!=null&&Ki(e,!!r.multiple,t,!1)}};l2=_p;c2=ti;var C4={usingClientEntryPoint:!1,Events:[_c,Oi,qd,i2,o2,_p]},Xo={findFiberByHostInstance:Da,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},A4={bundleType:Xo.bundleType,version:Xo.version,rendererPackageName:Xo.rendererPackageName,rendererConfig:Xo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:On.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=f2(e),e===null?null:e.stateNode},findFiberByHostInstance:Xo.findFiberByHostInstance||j4,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var su=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!su.isDisabled&&su.supportsFiber)try{zd=su.inject(A4),cn=su}catch{}}hs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=C4;hs.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Cp(t))throw Error(_e(200));return E4(e,t,null,r)};hs.createRoot=function(e,t){if(!Cp(e))throw Error(_e(299));var r=!1,s="",n=Wb;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(n=t.onRecoverableError)),t=Ep(e,1,!1,null,null,r,!1,s,n),e[Cn]=t.current,Bl(e.nodeType===8?e.parentNode:e),new Tp(t)};hs.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(_e(188)):(e=Object.keys(e).join(","),Error(_e(268,e)));return e=f2(t),e=e===null?null:e.stateNode,e};hs.flushSync=function(e){return ti(e)};hs.hydrate=function(e,t,r){if(!e0(t))throw Error(_e(200));return t0(null,e,t,!0,r)};hs.hydrateRoot=function(e,t,r){if(!Cp(e))throw Error(_e(405));var s=r!=null&&r.hydratedSources||null,n=!1,a="",i=Wb;if(r!=null&&(r.unstable_strictMode===!0&&(n=!0),r.identifierPrefix!==void 0&&(a=r.identifierPrefix),r.onRecoverableError!==void 0&&(i=r.onRecoverableError)),t=Vb(t,null,e,1,r??null,n,!1,a,i),e[Cn]=t.current,Bl(e),s)for(e=0;e<s.length;e++)r=s[e],n=r._getVersion,n=n(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,n]:t.mutableSourceEagerHydrationData.push(r,n);return new Zd(t)};hs.render=function(e,t,r){if(!e0(t))throw Error(_e(200));return t0(null,e,t,!1,r)};hs.unmountComponentAtNode=function(e){if(!e0(e))throw Error(_e(40));return e._reactRootContainer?(ti(function(){t0(null,null,e,!1,function(){e._reactRootContainer=null,e[Cn]=null})}),!0):!1};hs.unstable_batchedUpdates=_p;hs.unstable_renderSubtreeIntoContainer=function(e,t,r,s){if(!e0(r))throw Error(_e(200));if(e==null||e._reactInternals===void 0)throw Error(_e(38));return t0(e,t,r,!1,s)};hs.version="18.3.1-next-f1338f8080-20240426";function qb(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(qb)}catch(e){console.error(e)}}qb(),qw.exports=hs;var F4=qw.exports,kv=F4;Wf.createRoot=kv.createRoot,Wf.hydrateRoot=kv.hydrateRoot;const Ap=j.createContext({});function Fp(e){const t=j.useRef(null);return t.current===null&&(t.current=e()),t.current}const Pp=typeof window<"u",Hb=Pp?j.useLayoutEffect:j.useEffect,r0=j.createContext(null);function Rp(e,t){e.indexOf(t)===-1&&e.push(t)}function Ip(e,t){const r=e.indexOf(t);r>-1&&e.splice(r,1)}const Pn=(e,t,r)=>r>t?t:r<e?e:r;let Op=()=>{};const Rn={},Gb=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e);function Kb(e){return typeof e=="object"&&e!==null}const Xb=e=>/^0[^.\s]+$/u.test(e);function Dp(e){let t;return()=>(t===void 0&&(t=e()),t)}const Fs=e=>e,P4=(e,t)=>r=>t(e(r)),kc=(...e)=>e.reduce(P4),Kl=(e,t,r)=>{const s=t-e;return s===0?1:(r-e)/s};class Lp{constructor(){this.subscriptions=[]}add(t){return Rp(this.subscriptions,t),()=>Ip(this.subscriptions,t)}notify(t,r,s){const n=this.subscriptions.length;if(n)if(n===1)this.subscriptions[0](t,r,s);else for(let a=0;a<n;a++){const i=this.subscriptions[a];i&&i(t,r,s)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const dn=e=>e*1e3,Cs=e=>e/1e3;function Qb(e,t){return t?e*(1e3/t):0}const Yb=(e,t,r)=>(((1-3*r+3*t)*e+(3*r-6*t))*e+3*t)*e,R4=1e-7,I4=12;function O4(e,t,r,s,n){let a,i,l=0;do i=t+(r-t)/2,a=Yb(i,s,n)-e,a>0?r=i:t=i;while(Math.abs(a)>R4&&++l<I4);return i}function Nc(e,t,r,s){if(e===t&&r===s)return Fs;const n=a=>O4(a,0,1,e,r);return a=>a===0||a===1?a:Yb(n(a),t,s)}const Jb=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,Zb=e=>t=>1-e(1-t),e_=Nc(.33,1.53,.69,.99),Mp=Zb(e_),t_=Jb(Mp),r_=e=>(e*=2)<1?.5*Mp(e):.5*(2-Math.pow(2,-10*(e-1))),Bp=e=>1-Math.sin(Math.acos(e)),s_=Zb(Bp),n_=Jb(Bp),D4=Nc(.42,0,1,1),L4=Nc(0,0,.58,1),a_=Nc(.42,0,.58,1),M4=e=>Array.isArray(e)&&typeof e[0]!="number",i_=e=>Array.isArray(e)&&typeof e[0]=="number",B4={linear:Fs,easeIn:D4,easeInOut:a_,easeOut:L4,circIn:Bp,circInOut:n_,circOut:s_,backIn:Mp,backInOut:t_,backOut:e_,anticipate:r_},U4=e=>typeof e=="string",Nv=e=>{if(i_(e)){Op(e.length===4);const[t,r,s,n]=e;return Nc(t,r,s,n)}else if(U4(e))return B4[e];return e},nu=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function z4(e,t){let r=new Set,s=new Set,n=!1,a=!1;const i=new WeakSet;let l={delta:0,timestamp:0,isProcessing:!1};function c(d){i.has(d)&&(u.schedule(d),e()),d(l)}const u={schedule:(d,f=!1,h=!1)=>{const x=h&&n?r:s;return f&&i.add(d),x.has(d)||x.add(d),d},cancel:d=>{s.delete(d),i.delete(d)},process:d=>{if(l=d,n){a=!0;return}n=!0,[r,s]=[s,r],r.forEach(c),r.clear(),n=!1,a&&(a=!1,u.process(d))}};return u}const $4=40;function o_(e,t){let r=!1,s=!0;const n={delta:0,timestamp:0,isProcessing:!1},a=()=>r=!0,i=nu.reduce((y,b)=>(y[b]=z4(a),y),{}),{setup:l,read:c,resolveKeyframes:u,preUpdate:d,update:f,preRender:h,render:m,postRender:x}=i,p=()=>{const y=Rn.useManualTiming?n.timestamp:performance.now();r=!1,Rn.useManualTiming||(n.delta=s?1e3/60:Math.max(Math.min(y-n.timestamp,$4),1)),n.timestamp=y,n.isProcessing=!0,l.process(n),c.process(n),u.process(n),d.process(n),f.process(n),h.process(n),m.process(n),x.process(n),n.isProcessing=!1,r&&t&&(s=!1,e(p))},g=()=>{r=!0,s=!0,n.isProcessing||e(p)};return{schedule:nu.reduce((y,b)=>{const S=i[b];return y[b]=(_,k=!1,E=!1)=>(r||g(),S.schedule(_,k,E)),y},{}),cancel:y=>{for(let b=0;b<nu.length;b++)i[nu[b]].cancel(y)},state:n,steps:i}}const{schedule:St,cancel:la,state:fr,steps:tf}=o_(typeof requestAnimationFrame<"u"?requestAnimationFrame:Fs,!0);let Uu;function V4(){Uu=void 0}const Gr={now:()=>(Uu===void 0&&Gr.set(fr.isProcessing||Rn.useManualTiming?fr.timestamp:performance.now()),Uu),set:e=>{Uu=e,queueMicrotask(V4)}},l_=e=>t=>typeof t=="string"&&t.startsWith(e),Up=l_("--"),W4=l_("var(--"),zp=e=>W4(e)?q4.test(e.split("/*")[0].trim()):!1,q4=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,Eo={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},Xl={...Eo,transform:e=>Pn(0,1,e)},au={...Eo,default:1},xl=e=>Math.round(e*1e5)/1e5,$p=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function H4(e){return e==null}const G4=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,Vp=(e,t)=>r=>!!(typeof r=="string"&&G4.test(r)&&r.startsWith(e)||t&&!H4(r)&&Object.prototype.hasOwnProperty.call(r,t)),c_=(e,t,r)=>s=>{if(typeof s!="string")return s;const[n,a,i,l]=s.match($p);return{[e]:parseFloat(n),[t]:parseFloat(a),[r]:parseFloat(i),alpha:l!==void 0?parseFloat(l):1}},K4=e=>Pn(0,255,e),rf={...Eo,transform:e=>Math.round(K4(e))},Ba={test:Vp("rgb","red"),parse:c_("red","green","blue"),transform:({red:e,green:t,blue:r,alpha:s=1})=>"rgba("+rf.transform(e)+", "+rf.transform(t)+", "+rf.transform(r)+", "+xl(Xl.transform(s))+")"};function X4(e){let t="",r="",s="",n="";return e.length>5?(t=e.substring(1,3),r=e.substring(3,5),s=e.substring(5,7),n=e.substring(7,9)):(t=e.substring(1,2),r=e.substring(2,3),s=e.substring(3,4),n=e.substring(4,5),t+=t,r+=r,s+=s,n+=n),{red:parseInt(t,16),green:parseInt(r,16),blue:parseInt(s,16),alpha:n?parseInt(n,16)/255:1}}const Lh={test:Vp("#"),parse:X4,transform:Ba.transform},Ec=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),$n=Ec("deg"),fn=Ec("%"),We=Ec("px"),Q4=Ec("vh"),Y4=Ec("vw"),Ev={...fn,parse:e=>fn.parse(e)/100,transform:e=>fn.transform(e*100)},$i={test:Vp("hsl","hue"),parse:c_("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:r,alpha:s=1})=>"hsla("+Math.round(e)+", "+fn.transform(xl(t))+", "+fn.transform(xl(r))+", "+xl(Xl.transform(s))+")"},Xt={test:e=>Ba.test(e)||Lh.test(e)||$i.test(e),parse:e=>Ba.test(e)?Ba.parse(e):$i.test(e)?$i.parse(e):Lh.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?Ba.transform(e):$i.transform(e),getAnimatableNone:e=>{const t=Xt.parse(e);return t.alpha=0,Xt.transform(t)}},J4=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function Z4(e){var t,r;return isNaN(e)&&typeof e=="string"&&(((t=e.match($p))==null?void 0:t.length)||0)+(((r=e.match(J4))==null?void 0:r.length)||0)>0}const u_="number",d_="color",eC="var",tC="var(",jv="${}",rC=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Ql(e){const t=e.toString(),r=[],s={color:[],number:[],var:[]},n=[];let a=0;const l=t.replace(rC,c=>(Xt.test(c)?(s.color.push(a),n.push(d_),r.push(Xt.parse(c))):c.startsWith(tC)?(s.var.push(a),n.push(eC),r.push(c)):(s.number.push(a),n.push(u_),r.push(parseFloat(c))),++a,jv)).split(jv);return{values:r,split:l,indexes:s,types:n}}function f_(e){return Ql(e).values}function h_(e){const{split:t,types:r}=Ql(e),s=t.length;return n=>{let a="";for(let i=0;i<s;i++)if(a+=t[i],n[i]!==void 0){const l=r[i];l===u_?a+=xl(n[i]):l===d_?a+=Xt.transform(n[i]):a+=n[i]}return a}}const sC=e=>typeof e=="number"?0:Xt.test(e)?Xt.getAnimatableNone(e):e;function nC(e){const t=f_(e);return h_(e)(t.map(sC))}const ca={test:Z4,parse:f_,createTransformer:h_,getAnimatableNone:nC};function sf(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+(t-e)*6*r:r<1/2?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function aC({hue:e,saturation:t,lightness:r,alpha:s}){e/=360,t/=100,r/=100;let n=0,a=0,i=0;if(!t)n=a=i=r;else{const l=r<.5?r*(1+t):r+t-r*t,c=2*r-l;n=sf(c,l,e+1/3),a=sf(c,l,e),i=sf(c,l,e-1/3)}return{red:Math.round(n*255),green:Math.round(a*255),blue:Math.round(i*255),alpha:s}}function xd(e,t){return r=>r>0?t:e}const Ct=(e,t,r)=>e+(t-e)*r,nf=(e,t,r)=>{const s=e*e,n=r*(t*t-s)+s;return n<0?0:Math.sqrt(n)},iC=[Lh,Ba,$i],oC=e=>iC.find(t=>t.test(e));function Tv(e){const t=oC(e);if(!t)return!1;let r=t.parse(e);return t===$i&&(r=aC(r)),r}const Cv=(e,t)=>{const r=Tv(e),s=Tv(t);if(!r||!s)return xd(e,t);const n={...r};return a=>(n.red=nf(r.red,s.red,a),n.green=nf(r.green,s.green,a),n.blue=nf(r.blue,s.blue,a),n.alpha=Ct(r.alpha,s.alpha,a),Ba.transform(n))},Mh=new Set(["none","hidden"]);function lC(e,t){return Mh.has(e)?r=>r<=0?e:t:r=>r>=1?t:e}function cC(e,t){return r=>Ct(e,t,r)}function Wp(e){return typeof e=="number"?cC:typeof e=="string"?zp(e)?xd:Xt.test(e)?Cv:fC:Array.isArray(e)?m_:typeof e=="object"?Xt.test(e)?Cv:uC:xd}function m_(e,t){const r=[...e],s=r.length,n=e.map((a,i)=>Wp(a)(a,t[i]));return a=>{for(let i=0;i<s;i++)r[i]=n[i](a);return r}}function uC(e,t){const r={...e,...t},s={};for(const n in r)e[n]!==void 0&&t[n]!==void 0&&(s[n]=Wp(e[n])(e[n],t[n]));return n=>{for(const a in s)r[a]=s[a](n);return r}}function dC(e,t){const r=[],s={color:0,var:0,number:0};for(let n=0;n<t.values.length;n++){const a=t.types[n],i=e.indexes[a][s[a]],l=e.values[i]??0;r[n]=l,s[a]++}return r}const fC=(e,t)=>{const r=ca.createTransformer(t),s=Ql(e),n=Ql(t);return s.indexes.var.length===n.indexes.var.length&&s.indexes.color.length===n.indexes.color.length&&s.indexes.number.length>=n.indexes.number.length?Mh.has(e)&&!n.values.length||Mh.has(t)&&!s.values.length?lC(e,t):kc(m_(dC(s,n),n.values),r):xd(e,t)};function p_(e,t,r){return typeof e=="number"&&typeof t=="number"&&typeof r=="number"?Ct(e,t,r):Wp(e)(e,t)}const hC=e=>{const t=({timestamp:r})=>e(r);return{start:(r=!0)=>St.update(t,r),stop:()=>la(t),now:()=>fr.isProcessing?fr.timestamp:Gr.now()}},x_=(e,t,r=10)=>{let s="";const n=Math.max(Math.round(t/r),2);for(let a=0;a<n;a++)s+=Math.round(e(a/(n-1))*1e4)/1e4+", ";return`linear(${s.substring(0,s.length-2)})`},gd=2e4;function qp(e){let t=0;const r=50;let s=e.next(t);for(;!s.done&&t<gd;)t+=r,s=e.next(t);return t>=gd?1/0:t}function mC(e,t=100,r){const s=r({...e,keyframes:[0,t]}),n=Math.min(qp(s),gd);return{type:"keyframes",ease:a=>s.next(n*a).value/t,duration:Cs(n)}}const pC=5;function g_(e,t,r){const s=Math.max(t-pC,0);return Qb(r-e(s),t-s)}const It={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},af=.001;function xC({duration:e=It.duration,bounce:t=It.bounce,velocity:r=It.velocity,mass:s=It.mass}){let n,a,i=1-t;i=Pn(It.minDamping,It.maxDamping,i),e=Pn(It.minDuration,It.maxDuration,Cs(e)),i<1?(n=u=>{const d=u*i,f=d*e,h=d-r,m=Bh(u,i),x=Math.exp(-f);return af-h/m*x},a=u=>{const f=u*i*e,h=f*r+r,m=Math.pow(i,2)*Math.pow(u,2)*e,x=Math.exp(-f),p=Bh(Math.pow(u,2),i);return(-n(u)+af>0?-1:1)*((h-m)*x)/p}):(n=u=>{const d=Math.exp(-u*e),f=(u-r)*e+1;return-af+d*f},a=u=>{const d=Math.exp(-u*e),f=(r-u)*(e*e);return d*f});const l=5/e,c=vC(n,a,l);if(e=dn(e),isNaN(c))return{stiffness:It.stiffness,damping:It.damping,duration:e};{const u=Math.pow(c,2)*s;return{stiffness:u,damping:i*2*Math.sqrt(s*u),duration:e}}}const gC=12;function vC(e,t,r){let s=r;for(let n=1;n<gC;n++)s=s-e(s)/t(s);return s}function Bh(e,t){return e*Math.sqrt(1-t*t)}const yC=["duration","bounce"],wC=["stiffness","damping","mass"];function Av(e,t){return t.some(r=>e[r]!==void 0)}function bC(e){let t={velocity:It.velocity,stiffness:It.stiffness,damping:It.damping,mass:It.mass,isResolvedFromDuration:!1,...e};if(!Av(e,wC)&&Av(e,yC))if(e.visualDuration){const r=e.visualDuration,s=2*Math.PI/(r*1.2),n=s*s,a=2*Pn(.05,1,1-(e.bounce||0))*Math.sqrt(n);t={...t,mass:It.mass,stiffness:n,damping:a}}else{const r=xC(e);t={...t,...r,mass:It.mass},t.isResolvedFromDuration=!0}return t}function vd(e=It.visualDuration,t=It.bounce){const r=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:s,restDelta:n}=r;const a=r.keyframes[0],i=r.keyframes[r.keyframes.length-1],l={done:!1,value:a},{stiffness:c,damping:u,mass:d,duration:f,velocity:h,isResolvedFromDuration:m}=bC({...r,velocity:-Cs(r.velocity||0)}),x=h||0,p=u/(2*Math.sqrt(c*d)),g=i-a,w=Cs(Math.sqrt(c/d)),v=Math.abs(g)<5;s||(s=v?It.restSpeed.granular:It.restSpeed.default),n||(n=v?It.restDelta.granular:It.restDelta.default);let y;if(p<1){const S=Bh(w,p);y=_=>{const k=Math.exp(-p*w*_);return i-k*((x+p*w*g)/S*Math.sin(S*_)+g*Math.cos(S*_))}}else if(p===1)y=S=>i-Math.exp(-w*S)*(g+(x+w*g)*S);else{const S=w*Math.sqrt(p*p-1);y=_=>{const k=Math.exp(-p*w*_),E=Math.min(S*_,300);return i-k*((x+p*w*g)*Math.sinh(E)+S*g*Math.cosh(E))/S}}const b={calculatedDuration:m&&f||null,next:S=>{const _=y(S);if(m)l.done=S>=f;else{let k=S===0?x:0;p<1&&(k=S===0?dn(x):g_(y,S,_));const E=Math.abs(k)<=s,T=Math.abs(i-_)<=n;l.done=E&&T}return l.value=l.done?i:_,l},toString:()=>{const S=Math.min(qp(b),gd),_=x_(k=>b.next(S*k).value,S,30);return S+"ms "+_},toTransition:()=>{}};return b}vd.applyToOptions=e=>{const t=mC(e,100,vd);return e.ease=t.ease,e.duration=dn(t.duration),e.type="keyframes",e};function Uh({keyframes:e,velocity:t=0,power:r=.8,timeConstant:s=325,bounceDamping:n=10,bounceStiffness:a=500,modifyTarget:i,min:l,max:c,restDelta:u=.5,restSpeed:d}){const f=e[0],h={done:!1,value:f},m=E=>l!==void 0&&E<l||c!==void 0&&E>c,x=E=>l===void 0?c:c===void 0||Math.abs(l-E)<Math.abs(c-E)?l:c;let p=r*t;const g=f+p,w=i===void 0?g:i(g);w!==g&&(p=w-f);const v=E=>-p*Math.exp(-E/s),y=E=>w+v(E),b=E=>{const T=v(E),M=y(E);h.done=Math.abs(T)<=u,h.value=h.done?w:M};let S,_;const k=E=>{m(h.value)&&(S=E,_=vd({keyframes:[h.value,x(h.value)],velocity:g_(y,E,h.value),damping:n,stiffness:a,restDelta:u,restSpeed:d}))};return k(0),{calculatedDuration:null,next:E=>{let T=!1;return!_&&S===void 0&&(T=!0,b(E),k(E)),S!==void 0&&E>=S?_.next(E-S):(!T&&b(E),h)}}}function _C(e,t,r){const s=[],n=r||Rn.mix||p_,a=e.length-1;for(let i=0;i<a;i++){let l=n(e[i],e[i+1]);if(t){const c=Array.isArray(t)?t[i]||Fs:t;l=kc(c,l)}s.push(l)}return s}function SC(e,t,{clamp:r=!0,ease:s,mixer:n}={}){const a=e.length;if(Op(a===t.length),a===1)return()=>t[0];if(a===2&&t[0]===t[1])return()=>t[1];const i=e[0]===e[1];e[0]>e[a-1]&&(e=[...e].reverse(),t=[...t].reverse());const l=_C(t,s,n),c=l.length,u=d=>{if(i&&d<e[0])return t[0];let f=0;if(c>1)for(;f<e.length-2&&!(d<e[f+1]);f++);const h=Kl(e[f],e[f+1],d);return l[f](h)};return r?d=>u(Pn(e[0],e[a-1],d)):u}function kC(e,t){const r=e[e.length-1];for(let s=1;s<=t;s++){const n=Kl(0,t,s);e.push(Ct(r,1,n))}}function NC(e){const t=[0];return kC(t,e.length-1),t}function EC(e,t){return e.map(r=>r*t)}function jC(e,t){return e.map(()=>t||a_).splice(0,e.length-1)}function gl({duration:e=300,keyframes:t,times:r,ease:s="easeInOut"}){const n=M4(s)?s.map(Nv):Nv(s),a={done:!1,value:t[0]},i=EC(r&&r.length===t.length?r:NC(t),e),l=SC(i,t,{ease:Array.isArray(n)?n:jC(t,n)});return{calculatedDuration:e,next:c=>(a.value=l(c),a.done=c>=e,a)}}const TC=e=>e!==null;function Hp(e,{repeat:t,repeatType:r="loop"},s,n=1){const a=e.filter(TC),l=n<0||t&&r!=="loop"&&t%2===1?0:a.length-1;return!l||s===void 0?a[l]:s}const CC={decay:Uh,inertia:Uh,tween:gl,keyframes:gl,spring:vd};function v_(e){typeof e.type=="string"&&(e.type=CC[e.type])}class Gp{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(t=>{this.resolve=t})}notifyFinished(){this.resolve()}then(t,r){return this.finished.then(t,r)}}const AC=e=>e/100;class Kp extends Gp{constructor(t){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var s,n;const{motionValue:r}=this.options;r&&r.updatedAt!==Gr.now()&&this.tick(Gr.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),(n=(s=this.options).onStop)==null||n.call(s))},this.options=t,this.initAnimation(),this.play(),t.autoplay===!1&&this.pause()}initAnimation(){const{options:t}=this;v_(t);const{type:r=gl,repeat:s=0,repeatDelay:n=0,repeatType:a,velocity:i=0}=t;let{keyframes:l}=t;const c=r||gl;c!==gl&&typeof l[0]!="number"&&(this.mixKeyframes=kc(AC,p_(l[0],l[1])),l=[0,100]);const u=c({...t,keyframes:l});a==="mirror"&&(this.mirroredGenerator=c({...t,keyframes:[...l].reverse(),velocity:-i})),u.calculatedDuration===null&&(u.calculatedDuration=qp(u));const{calculatedDuration:d}=u;this.calculatedDuration=d,this.resolvedDuration=d+n,this.totalDuration=this.resolvedDuration*(s+1)-n,this.generator=u}updateTime(t){const r=Math.round(t-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=r}tick(t,r=!1){const{generator:s,totalDuration:n,mixKeyframes:a,mirroredGenerator:i,resolvedDuration:l,calculatedDuration:c}=this;if(this.startTime===null)return s.next(0);const{delay:u=0,keyframes:d,repeat:f,repeatType:h,repeatDelay:m,type:x,onUpdate:p,finalKeyframe:g}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-n/this.speed,this.startTime)),r?this.currentTime=t:this.updateTime(t);const w=this.currentTime-u*(this.playbackSpeed>=0?1:-1),v=this.playbackSpeed>=0?w<0:w>n;this.currentTime=Math.max(w,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=n);let y=this.currentTime,b=s;if(f){const E=Math.min(this.currentTime,n)/l;let T=Math.floor(E),M=E%1;!M&&E>=1&&(M=1),M===1&&T--,T=Math.min(T,f+1),!!(T%2)&&(h==="reverse"?(M=1-M,m&&(M-=m/l)):h==="mirror"&&(b=i)),y=Pn(0,1,M)*l}const S=v?{done:!1,value:d[0]}:b.next(y);a&&(S.value=a(S.value));let{done:_}=S;!v&&c!==null&&(_=this.playbackSpeed>=0?this.currentTime>=n:this.currentTime<=0);const k=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&_);return k&&x!==Uh&&(S.value=Hp(d,this.options,g,this.speed)),p&&p(S.value),k&&this.finish(),S}then(t,r){return this.finished.then(t,r)}get duration(){return Cs(this.calculatedDuration)}get iterationDuration(){const{delay:t=0}=this.options||{};return this.duration+Cs(t)}get time(){return Cs(this.currentTime)}set time(t){var r;t=dn(t),this.currentTime=t,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.playbackSpeed),(r=this.driver)==null||r.start(!1)}get speed(){return this.playbackSpeed}set speed(t){this.updateTime(Gr.now());const r=this.playbackSpeed!==t;this.playbackSpeed=t,r&&(this.time=Cs(this.currentTime))}play(){var n,a;if(this.isStopped)return;const{driver:t=hC,startTime:r}=this.options;this.driver||(this.driver=t(i=>this.tick(i))),(a=(n=this.options).onPlay)==null||a.call(n);const s=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=s):this.holdTime!==null?this.startTime=s-this.holdTime:this.startTime||(this.startTime=r??s),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(Gr.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){var t,r;this.notifyFinished(),this.teardown(),this.state="finished",(r=(t=this.options).onComplete)==null||r.call(t)}cancel(){var t,r;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),(r=(t=this.options).onCancel)==null||r.call(t)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}attachTimeline(t){var r;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),(r=this.driver)==null||r.stop(),t.observe(this)}}function FC(e){for(let t=1;t<e.length;t++)e[t]??(e[t]=e[t-1])}const Ua=e=>e*180/Math.PI,zh=e=>{const t=Ua(Math.atan2(e[1],e[0]));return $h(t)},PC={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:zh,rotateZ:zh,skewX:e=>Ua(Math.atan(e[1])),skewY:e=>Ua(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},$h=e=>(e=e%360,e<0&&(e+=360),e),Fv=zh,Pv=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),Rv=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),RC={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:Pv,scaleY:Rv,scale:e=>(Pv(e)+Rv(e))/2,rotateX:e=>$h(Ua(Math.atan2(e[6],e[5]))),rotateY:e=>$h(Ua(Math.atan2(-e[2],e[0]))),rotateZ:Fv,rotate:Fv,skewX:e=>Ua(Math.atan(e[4])),skewY:e=>Ua(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function Vh(e){return e.includes("scale")?1:0}function Wh(e,t){if(!e||e==="none")return Vh(t);const r=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let s,n;if(r)s=RC,n=r;else{const l=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);s=PC,n=l}if(!n)return Vh(t);const a=s[t],i=n[1].split(",").map(OC);return typeof a=="function"?a(i):i[a]}const IC=(e,t)=>{const{transform:r="none"}=getComputedStyle(e);return Wh(r,t)};function OC(e){return parseFloat(e.trim())}const jo=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],To=new Set(jo),Iv=e=>e===Eo||e===We,DC=new Set(["x","y","z"]),LC=jo.filter(e=>!DC.has(e));function MC(e){const t=[];return LC.forEach(r=>{const s=e.getValue(r);s!==void 0&&(t.push([r,s.get()]),s.set(r.startsWith("scale")?1:0))}),t}const qa={width:({x:e},{paddingLeft:t="0",paddingRight:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),height:({y:e},{paddingTop:t="0",paddingBottom:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:(e,{transform:t})=>Wh(t,"x"),y:(e,{transform:t})=>Wh(t,"y")};qa.translateX=qa.x;qa.translateY=qa.y;const Ha=new Set;let qh=!1,Hh=!1,Gh=!1;function y_(){if(Hh){const e=Array.from(Ha).filter(s=>s.needsMeasurement),t=new Set(e.map(s=>s.element)),r=new Map;t.forEach(s=>{const n=MC(s);n.length&&(r.set(s,n),s.render())}),e.forEach(s=>s.measureInitialState()),t.forEach(s=>{s.render();const n=r.get(s);n&&n.forEach(([a,i])=>{var l;(l=s.getValue(a))==null||l.set(i)})}),e.forEach(s=>s.measureEndState()),e.forEach(s=>{s.suspendedScrollY!==void 0&&window.scrollTo(0,s.suspendedScrollY)})}Hh=!1,qh=!1,Ha.forEach(e=>e.complete(Gh)),Ha.clear()}function w_(){Ha.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(Hh=!0)})}function BC(){Gh=!0,w_(),y_(),Gh=!1}class Xp{constructor(t,r,s,n,a,i=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...t],this.onComplete=r,this.name=s,this.motionValue=n,this.element=a,this.isAsync=i}scheduleResolve(){this.state="scheduled",this.isAsync?(Ha.add(this),qh||(qh=!0,St.read(w_),St.resolveKeyframes(y_))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:r,element:s,motionValue:n}=this;if(t[0]===null){const a=n==null?void 0:n.get(),i=t[t.length-1];if(a!==void 0)t[0]=a;else if(s&&r){const l=s.readValue(r,i);l!=null&&(t[0]=l)}t[0]===void 0&&(t[0]=i),n&&a===void 0&&n.set(t[0])}FC(t)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(t=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,t),Ha.delete(this)}cancel(){this.state==="scheduled"&&(Ha.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const UC=e=>e.startsWith("--");function zC(e,t,r){UC(t)?e.style.setProperty(t,r):e.style[t]=r}const $C=Dp(()=>window.ScrollTimeline!==void 0),VC={};function WC(e,t){const r=Dp(e);return()=>VC[t]??r()}const b_=WC(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),rl=([e,t,r,s])=>`cubic-bezier(${e}, ${t}, ${r}, ${s})`,Ov={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:rl([0,.65,.55,1]),circOut:rl([.55,0,1,.45]),backIn:rl([.31,.01,.66,-.59]),backOut:rl([.33,1.53,.69,.99])};function __(e,t){if(e)return typeof e=="function"?b_()?x_(e,t):"ease-out":i_(e)?rl(e):Array.isArray(e)?e.map(r=>__(r,t)||Ov.easeOut):Ov[e]}function qC(e,t,r,{delay:s=0,duration:n=300,repeat:a=0,repeatType:i="loop",ease:l="easeOut",times:c}={},u=void 0){const d={[t]:r};c&&(d.offset=c);const f=__(l,n);Array.isArray(f)&&(d.easing=f);const h={delay:s,duration:n,easing:Array.isArray(f)?"linear":f,fill:"both",iterations:a+1,direction:i==="reverse"?"alternate":"normal"};return u&&(h.pseudoElement=u),e.animate(d,h)}function S_(e){return typeof e=="function"&&"applyToOptions"in e}function HC({type:e,...t}){return S_(e)&&b_()?e.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}class GC extends Gp{constructor(t){if(super(),this.finishedTime=null,this.isStopped=!1,!t)return;const{element:r,name:s,keyframes:n,pseudoElement:a,allowFlatten:i=!1,finalKeyframe:l,onComplete:c}=t;this.isPseudoElement=!!a,this.allowFlatten=i,this.options=t,Op(typeof t.type!="string");const u=HC(t);this.animation=qC(r,s,n,u,a),u.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!a){const d=Hp(n,this.options,l,this.speed);this.updateMotionValue?this.updateMotionValue(d):zC(r,s,d),this.animation.cancel()}c==null||c(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var t,r;(r=(t=this.animation).finish)==null||r.call(t)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:t}=this;t==="idle"||t==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var t,r;this.isPseudoElement||(r=(t=this.animation).commitStyles)==null||r.call(t)}get duration(){var r,s;const t=((s=(r=this.animation.effect)==null?void 0:r.getComputedTiming)==null?void 0:s.call(r).duration)||0;return Cs(Number(t))}get iterationDuration(){const{delay:t=0}=this.options||{};return this.duration+Cs(t)}get time(){return Cs(Number(this.animation.currentTime)||0)}set time(t){this.finishedTime=null,this.animation.currentTime=dn(t)}get speed(){return this.animation.playbackRate}set speed(t){t<0&&(this.finishedTime=null),this.animation.playbackRate=t}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(t){this.animation.startTime=t}attachTimeline({timeline:t,observe:r}){var s;return this.allowFlatten&&((s=this.animation.effect)==null||s.updateTiming({easing:"linear"})),this.animation.onfinish=null,t&&$C()?(this.animation.timeline=t,Fs):r(this)}}const k_={anticipate:r_,backInOut:t_,circInOut:n_};function KC(e){return e in k_}function XC(e){typeof e.ease=="string"&&KC(e.ease)&&(e.ease=k_[e.ease])}const Dv=10;class QC extends GC{constructor(t){XC(t),v_(t),super(t),t.startTime&&(this.startTime=t.startTime),this.options=t}updateMotionValue(t){const{motionValue:r,onUpdate:s,onComplete:n,element:a,...i}=this.options;if(!r)return;if(t!==void 0){r.set(t);return}const l=new Kp({...i,autoplay:!1}),c=dn(this.finishedTime??this.time);r.setWithVelocity(l.sample(c-Dv).value,l.sample(c).value,Dv),l.stop()}}const Lv=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(ca.test(e)||e==="0")&&!e.startsWith("url("));function YC(e){const t=e[0];if(e.length===1)return!0;for(let r=0;r<e.length;r++)if(e[r]!==t)return!0}function JC(e,t,r,s){const n=e[0];if(n===null)return!1;if(t==="display"||t==="visibility")return!0;const a=e[e.length-1],i=Lv(n,t),l=Lv(a,t);return!i||!l?!1:YC(e)||(r==="spring"||S_(r))&&s}function Kh(e){e.duration=0,e.type="keyframes"}const ZC=new Set(["opacity","clipPath","filter","transform"]),e3=Dp(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function t3(e){var d;const{motionValue:t,name:r,repeatDelay:s,repeatType:n,damping:a,type:i}=e;if(!(((d=t==null?void 0:t.owner)==null?void 0:d.current)instanceof HTMLElement))return!1;const{onUpdate:c,transformTemplate:u}=t.owner.getProps();return e3()&&r&&ZC.has(r)&&(r!=="transform"||!u)&&!c&&!s&&n!=="mirror"&&a!==0&&i!=="inertia"}const r3=40;class s3 extends Gp{constructor({autoplay:t=!0,delay:r=0,type:s="keyframes",repeat:n=0,repeatDelay:a=0,repeatType:i="loop",keyframes:l,name:c,motionValue:u,element:d,...f}){var x;super(),this.stop=()=>{var p,g;this._animation&&(this._animation.stop(),(p=this.stopTimeline)==null||p.call(this)),(g=this.keyframeResolver)==null||g.cancel()},this.createdAt=Gr.now();const h={autoplay:t,delay:r,type:s,repeat:n,repeatDelay:a,repeatType:i,name:c,motionValue:u,element:d,...f},m=(d==null?void 0:d.KeyframeResolver)||Xp;this.keyframeResolver=new m(l,(p,g,w)=>this.onKeyframesResolved(p,g,h,!w),c,u,d),(x=this.keyframeResolver)==null||x.scheduleResolve()}onKeyframesResolved(t,r,s,n){this.keyframeResolver=void 0;const{name:a,type:i,velocity:l,delay:c,isHandoff:u,onUpdate:d}=s;this.resolvedAt=Gr.now(),JC(t,a,i,l)||((Rn.instantAnimations||!c)&&(d==null||d(Hp(t,s,r))),t[0]=t[t.length-1],Kh(s),s.repeat=0);const h={startTime:n?this.resolvedAt?this.resolvedAt-this.createdAt>r3?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:r,...s,keyframes:t},m=!u&&t3(h)?new QC({...h,element:h.motionValue.owner.current}):new Kp(h);m.finished.then(()=>this.notifyFinished()).catch(Fs),this.pendingTimeline&&(this.stopTimeline=m.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=m}get finished(){return this._animation?this.animation.finished:this._finished}then(t,r){return this.finished.finally(t).then(()=>{})}get animation(){var t;return this._animation||((t=this.keyframeResolver)==null||t.resume(),BC()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(t){this.animation.time=t}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(t){this.animation.speed=t}get startTime(){return this.animation.startTime}attachTimeline(t){return this._animation?this.stopTimeline=this.animation.attachTimeline(t):this.pendingTimeline=t,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var t;this._animation&&this.animation.cancel(),(t=this.keyframeResolver)==null||t.cancel()}}const n3=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function a3(e){const t=n3.exec(e);if(!t)return[,];const[,r,s,n]=t;return[`--${r??s}`,n]}function N_(e,t,r=1){const[s,n]=a3(e);if(!s)return;const a=window.getComputedStyle(t).getPropertyValue(s);if(a){const i=a.trim();return Gb(i)?parseFloat(i):i}return zp(n)?N_(n,t,r+1):n}function Qp(e,t){return(e==null?void 0:e[t])??(e==null?void 0:e.default)??e}const E_=new Set(["width","height","top","left","right","bottom",...jo]),i3={test:e=>e==="auto",parse:e=>e},j_=e=>t=>t.test(e),T_=[Eo,We,fn,$n,Y4,Q4,i3],Mv=e=>T_.find(j_(e));function o3(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||Xb(e):!0}const l3=new Set(["brightness","contrast","saturate","opacity"]);function c3(e){const[t,r]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[s]=r.match($p)||[];if(!s)return e;const n=r.replace(s,"");let a=l3.has(t)?1:0;return s!==r&&(a*=100),t+"("+a+n+")"}const u3=/\b([a-z-]*)\(.*?\)/gu,Xh={...ca,getAnimatableNone:e=>{const t=e.match(u3);return t?t.map(c3).join(" "):e}},Bv={...Eo,transform:Math.round},d3={rotate:$n,rotateX:$n,rotateY:$n,rotateZ:$n,scale:au,scaleX:au,scaleY:au,scaleZ:au,skew:$n,skewX:$n,skewY:$n,distance:We,translateX:We,translateY:We,translateZ:We,x:We,y:We,z:We,perspective:We,transformPerspective:We,opacity:Xl,originX:Ev,originY:Ev,originZ:We},Yp={borderWidth:We,borderTopWidth:We,borderRightWidth:We,borderBottomWidth:We,borderLeftWidth:We,borderRadius:We,radius:We,borderTopLeftRadius:We,borderTopRightRadius:We,borderBottomRightRadius:We,borderBottomLeftRadius:We,width:We,maxWidth:We,height:We,maxHeight:We,top:We,right:We,bottom:We,left:We,padding:We,paddingTop:We,paddingRight:We,paddingBottom:We,paddingLeft:We,margin:We,marginTop:We,marginRight:We,marginBottom:We,marginLeft:We,backgroundPositionX:We,backgroundPositionY:We,...d3,zIndex:Bv,fillOpacity:Xl,strokeOpacity:Xl,numOctaves:Bv},f3={...Yp,color:Xt,backgroundColor:Xt,outlineColor:Xt,fill:Xt,stroke:Xt,borderColor:Xt,borderTopColor:Xt,borderRightColor:Xt,borderBottomColor:Xt,borderLeftColor:Xt,filter:Xh,WebkitFilter:Xh},C_=e=>f3[e];function A_(e,t){let r=C_(e);return r!==Xh&&(r=ca),r.getAnimatableNone?r.getAnimatableNone(t):void 0}const h3=new Set(["auto","none","0"]);function m3(e,t,r){let s=0,n;for(;s<e.length&&!n;){const a=e[s];typeof a=="string"&&!h3.has(a)&&Ql(a).values.length&&(n=e[s]),s++}if(n&&r)for(const a of t)e[a]=A_(r,n)}class p3 extends Xp{constructor(t,r,s,n,a){super(t,r,s,n,a,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:r,name:s}=this;if(!r||!r.current)return;super.readKeyframes();for(let c=0;c<t.length;c++){let u=t[c];if(typeof u=="string"&&(u=u.trim(),zp(u))){const d=N_(u,r.current);d!==void 0&&(t[c]=d),c===t.length-1&&(this.finalKeyframe=u)}}if(this.resolveNoneKeyframes(),!E_.has(s)||t.length!==2)return;const[n,a]=t,i=Mv(n),l=Mv(a);if(i!==l)if(Iv(i)&&Iv(l))for(let c=0;c<t.length;c++){const u=t[c];typeof u=="string"&&(t[c]=parseFloat(u))}else qa[s]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:r}=this,s=[];for(let n=0;n<t.length;n++)(t[n]===null||o3(t[n]))&&s.push(n);s.length&&m3(t,s,r)}measureInitialState(){const{element:t,unresolvedKeyframes:r,name:s}=this;if(!t||!t.current)return;s==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=qa[s](t.measureViewportBox(),window.getComputedStyle(t.current)),r[0]=this.measuredOrigin;const n=r[r.length-1];n!==void 0&&t.getValue(s,n).jump(n,!1)}measureEndState(){var l;const{element:t,name:r,unresolvedKeyframes:s}=this;if(!t||!t.current)return;const n=t.getValue(r);n&&n.jump(this.measuredOrigin,!1);const a=s.length-1,i=s[a];s[a]=qa[r](t.measureViewportBox(),window.getComputedStyle(t.current)),i!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=i),(l=this.removedTransforms)!=null&&l.length&&this.removedTransforms.forEach(([c,u])=>{t.getValue(c).set(u)}),this.resolveNoneKeyframes()}}function x3(e,t,r){if(e instanceof EventTarget)return[e];if(typeof e=="string"){let s=document;const n=(r==null?void 0:r[e])??s.querySelectorAll(e);return n?Array.from(n):[]}return Array.from(e)}const F_=(e,t)=>t&&typeof e=="number"?t.transform(e):e;function P_(e){return Kb(e)&&"offsetHeight"in e}const Uv=30,g3=e=>!isNaN(parseFloat(e));class v3{constructor(t,r={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=s=>{var a;const n=Gr.now();if(this.updatedAt!==n&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(s),this.current!==this.prev&&((a=this.events.change)==null||a.notify(this.current),this.dependents))for(const i of this.dependents)i.dirty()},this.hasAnimated=!1,this.setCurrent(t),this.owner=r.owner}setCurrent(t){this.current=t,this.updatedAt=Gr.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=g3(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,r){this.events[t]||(this.events[t]=new Lp);const s=this.events[t].add(r);return t==="change"?()=>{s(),St.read(()=>{this.events.change.getSize()||this.stop()})}:s}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,r){this.passiveEffect=t,this.stopPassiveEffect=r}set(t){this.passiveEffect?this.passiveEffect(t,this.updateAndNotify):this.updateAndNotify(t)}setWithVelocity(t,r,s){this.set(r),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-s}jump(t,r=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,r&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var t;(t=this.events.change)==null||t.notify(this.current)}addDependent(t){this.dependents||(this.dependents=new Set),this.dependents.add(t)}removeDependent(t){this.dependents&&this.dependents.delete(t)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=Gr.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>Uv)return 0;const r=Math.min(this.updatedAt-this.prevUpdatedAt,Uv);return Qb(parseFloat(this.current)-parseFloat(this.prevFrameValue),r)}start(t){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=t(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var t,r;(t=this.dependents)==null||t.clear(),(r=this.events.destroy)==null||r.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function po(e,t){return new v3(e,t)}const{schedule:Jp}=o_(queueMicrotask,!1),Us={x:!1,y:!1};function R_(){return Us.x||Us.y}function y3(e){return e==="x"||e==="y"?Us[e]?null:(Us[e]=!0,()=>{Us[e]=!1}):Us.x||Us.y?null:(Us.x=Us.y=!0,()=>{Us.x=Us.y=!1})}function I_(e,t){const r=x3(e),s=new AbortController,n={passive:!0,...t,signal:s.signal};return[r,n,()=>s.abort()]}function zv(e){return!(e.pointerType==="touch"||R_())}function w3(e,t,r={}){const[s,n,a]=I_(e,r),i=l=>{if(!zv(l))return;const{target:c}=l,u=t(c,l);if(typeof u!="function"||!c)return;const d=f=>{zv(f)&&(u(f),c.removeEventListener("pointerleave",d))};c.addEventListener("pointerleave",d,n)};return s.forEach(l=>{l.addEventListener("pointerenter",i,n)}),a}const O_=(e,t)=>t?e===t?!0:O_(e,t.parentElement):!1,Zp=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1,b3=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function _3(e){return b3.has(e.tagName)||e.tabIndex!==-1}const zu=new WeakSet;function $v(e){return t=>{t.key==="Enter"&&e(t)}}function of(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const S3=(e,t)=>{const r=e.currentTarget;if(!r)return;const s=$v(()=>{if(zu.has(r))return;of(r,"down");const n=$v(()=>{of(r,"up")}),a=()=>of(r,"cancel");r.addEventListener("keyup",n,t),r.addEventListener("blur",a,t)});r.addEventListener("keydown",s,t),r.addEventListener("blur",()=>r.removeEventListener("keydown",s),t)};function Vv(e){return Zp(e)&&!R_()}function k3(e,t,r={}){const[s,n,a]=I_(e,r),i=l=>{const c=l.currentTarget;if(!Vv(l))return;zu.add(c);const u=t(c,l),d=(m,x)=>{window.removeEventListener("pointerup",f),window.removeEventListener("pointercancel",h),zu.has(c)&&zu.delete(c),Vv(m)&&typeof u=="function"&&u(m,{success:x})},f=m=>{d(m,c===window||c===document||r.useGlobalTarget||O_(c,m.target))},h=m=>{d(m,!1)};window.addEventListener("pointerup",f,n),window.addEventListener("pointercancel",h,n)};return s.forEach(l=>{(r.useGlobalTarget?window:l).addEventListener("pointerdown",i,n),P_(l)&&(l.addEventListener("focus",u=>S3(u,n)),!_3(l)&&!l.hasAttribute("tabindex")&&(l.tabIndex=0))}),a}function D_(e){return Kb(e)&&"ownerSVGElement"in e}function N3(e){return D_(e)&&e.tagName==="svg"}const jr=e=>!!(e&&e.getVelocity),E3=[...T_,Xt,ca],j3=e=>E3.find(j_(e)),ex=j.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});function Wv(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function T3(...e){return t=>{let r=!1;const s=e.map(n=>{const a=Wv(n,t);return!r&&typeof a=="function"&&(r=!0),a});if(r)return()=>{for(let n=0;n<s.length;n++){const a=s[n];typeof a=="function"?a():Wv(e[n],null)}}}}function C3(...e){return j.useCallback(T3(...e),e)}class A3 extends j.Component{getSnapshotBeforeUpdate(t){const r=this.props.childRef.current;if(r&&t.isPresent&&!this.props.isPresent){const s=r.offsetParent,n=P_(s)&&s.offsetWidth||0,a=this.props.sizeRef.current;a.height=r.offsetHeight||0,a.width=r.offsetWidth||0,a.top=r.offsetTop,a.left=r.offsetLeft,a.right=n-a.width-a.left}return null}componentDidUpdate(){}render(){return this.props.children}}function F3({children:e,isPresent:t,anchorX:r,root:s}){const n=j.useId(),a=j.useRef(null),i=j.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:l}=j.useContext(ex),c=C3(a,e==null?void 0:e.ref);return j.useInsertionEffect(()=>{const{width:u,height:d,top:f,left:h,right:m}=i.current;if(t||!a.current||!u||!d)return;const x=r==="left"?`left: ${h}`:`right: ${m}`;a.current.dataset.motionPopId=n;const p=document.createElement("style");l&&(p.nonce=l);const g=s??document.head;return g.appendChild(p),p.sheet&&p.sheet.insertRule(`
          [data-motion-pop-id="${n}"] {
            position: absolute !important;
            width: ${u}px !important;
            height: ${d}px !important;
            ${x}px !important;
            top: ${f}px !important;
          }
        `),()=>{g.contains(p)&&g.removeChild(p)}},[t]),o.jsx(A3,{isPresent:t,childRef:a,sizeRef:i,children:j.cloneElement(e,{ref:c})})}const P3=({children:e,initial:t,isPresent:r,onExitComplete:s,custom:n,presenceAffectsLayout:a,mode:i,anchorX:l,root:c})=>{const u=Fp(R3),d=j.useId();let f=!0,h=j.useMemo(()=>(f=!1,{id:d,initial:t,isPresent:r,custom:n,onExitComplete:m=>{u.set(m,!0);for(const x of u.values())if(!x)return;s&&s()},register:m=>(u.set(m,!1),()=>u.delete(m))}),[r,u,s]);return a&&f&&(h={...h}),j.useMemo(()=>{u.forEach((m,x)=>u.set(x,!1))},[r]),j.useEffect(()=>{!r&&!u.size&&s&&s()},[r]),i==="popLayout"&&(e=o.jsx(F3,{isPresent:r,anchorX:l,root:c,children:e})),o.jsx(r0.Provider,{value:h,children:e})};function R3(){return new Map}function L_(e=!0){const t=j.useContext(r0);if(t===null)return[!0,null];const{isPresent:r,onExitComplete:s,register:n}=t,a=j.useId();j.useEffect(()=>{if(e)return n(a)},[e]);const i=j.useCallback(()=>e&&s&&s(a),[a,s,e]);return!r&&s?[!1,i]:[!0]}const iu=e=>e.key||"";function qv(e){const t=[];return j.Children.forEach(e,r=>{j.isValidElement(r)&&t.push(r)}),t}const tx=({children:e,custom:t,initial:r=!0,onExitComplete:s,presenceAffectsLayout:n=!0,mode:a="sync",propagate:i=!1,anchorX:l="left",root:c})=>{const[u,d]=L_(i),f=j.useMemo(()=>qv(e),[e]),h=i&&!u?[]:f.map(iu),m=j.useRef(!0),x=j.useRef(f),p=Fp(()=>new Map),[g,w]=j.useState(f),[v,y]=j.useState(f);Hb(()=>{m.current=!1,x.current=f;for(let _=0;_<v.length;_++){const k=iu(v[_]);h.includes(k)?p.delete(k):p.get(k)!==!0&&p.set(k,!1)}},[v,h.length,h.join("-")]);const b=[];if(f!==g){let _=[...f];for(let k=0;k<v.length;k++){const E=v[k],T=iu(E);h.includes(T)||(_.splice(k,0,E),b.push(E))}return a==="wait"&&b.length&&(_=b),y(qv(_)),w(f),null}const{forceRender:S}=j.useContext(Ap);return o.jsx(o.Fragment,{children:v.map(_=>{const k=iu(_),E=i&&!u?!1:f===v||h.includes(k),T=()=>{if(p.has(k))p.set(k,!0);else return;let M=!0;p.forEach(q=>{q||(M=!1)}),M&&(S==null||S(),y(x.current),i&&(d==null||d()),s&&s())};return o.jsx(P3,{isPresent:E,initial:!m.current||r?void 0:!1,custom:t,presenceAffectsLayout:n,mode:a,root:c,onExitComplete:E?void 0:T,anchorX:l,children:_},k)})})},M_=j.createContext({strict:!1}),Hv={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},xo={};for(const e in Hv)xo[e]={isEnabled:t=>Hv[e].some(r=>!!t[r])};function I3(e){for(const t in e)xo[t]={...xo[t],...e[t]}}const O3=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function yd(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||O3.has(e)}let B_=e=>!yd(e);function D3(e){typeof e=="function"&&(B_=t=>t.startsWith("on")?!yd(t):e(t))}try{D3(require("@emotion/is-prop-valid").default)}catch{}function L3(e,t,r){const s={};for(const n in e)n==="values"&&typeof e.values=="object"||(B_(n)||r===!0&&yd(n)||!t&&!yd(n)||e.draggable&&n.startsWith("onDrag"))&&(s[n]=e[n]);return s}const s0=j.createContext({});function n0(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}function Yl(e){return typeof e=="string"||Array.isArray(e)}const rx=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],sx=["initial",...rx];function a0(e){return n0(e.animate)||sx.some(t=>Yl(e[t]))}function U_(e){return!!(a0(e)||e.variants)}function M3(e,t){if(a0(e)){const{initial:r,animate:s}=e;return{initial:r===!1||Yl(r)?r:void 0,animate:Yl(s)?s:void 0}}return e.inherit!==!1?t:{}}function B3(e){const{initial:t,animate:r}=M3(e,j.useContext(s0));return j.useMemo(()=>({initial:t,animate:r}),[Gv(t),Gv(r)])}function Gv(e){return Array.isArray(e)?e.join(" "):e}const Jl={};function U3(e){for(const t in e)Jl[t]=e[t],Up(t)&&(Jl[t].isCSSVariable=!0)}function z_(e,{layout:t,layoutId:r}){return To.has(e)||e.startsWith("origin")||(t||r!==void 0)&&(!!Jl[e]||e==="opacity")}const z3={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},$3=jo.length;function V3(e,t,r){let s="",n=!0;for(let a=0;a<$3;a++){const i=jo[a],l=e[i];if(l===void 0)continue;let c=!0;if(typeof l=="number"?c=l===(i.startsWith("scale")?1:0):c=parseFloat(l)===0,!c||r){const u=F_(l,Yp[i]);if(!c){n=!1;const d=z3[i]||i;s+=`${d}(${u}) `}r&&(t[i]=u)}}return s=s.trim(),r?s=r(t,n?"":s):n&&(s="none"),s}function nx(e,t,r){const{style:s,vars:n,transformOrigin:a}=e;let i=!1,l=!1;for(const c in t){const u=t[c];if(To.has(c)){i=!0;continue}else if(Up(c)){n[c]=u;continue}else{const d=F_(u,Yp[c]);c.startsWith("origin")?(l=!0,a[c]=d):s[c]=d}}if(t.transform||(i||r?s.transform=V3(t,e.transform,r):s.transform&&(s.transform="none")),l){const{originX:c="50%",originY:u="50%",originZ:d=0}=a;s.transformOrigin=`${c} ${u} ${d}`}}const ax=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function $_(e,t,r){for(const s in t)!jr(t[s])&&!z_(s,r)&&(e[s]=t[s])}function W3({transformTemplate:e},t){return j.useMemo(()=>{const r=ax();return nx(r,t,e),Object.assign({},r.vars,r.style)},[t])}function q3(e,t){const r=e.style||{},s={};return $_(s,r,e),Object.assign(s,W3(e,t)),s}function H3(e,t){const r={},s=q3(e,t);return e.drag&&e.dragListener!==!1&&(r.draggable=!1,s.userSelect=s.WebkitUserSelect=s.WebkitTouchCallout="none",s.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(r.tabIndex=0),r.style=s,r}const G3={offset:"stroke-dashoffset",array:"stroke-dasharray"},K3={offset:"strokeDashoffset",array:"strokeDasharray"};function X3(e,t,r=1,s=0,n=!0){e.pathLength=1;const a=n?G3:K3;e[a.offset]=We.transform(-s);const i=We.transform(t),l=We.transform(r);e[a.array]=`${i} ${l}`}function V_(e,{attrX:t,attrY:r,attrScale:s,pathLength:n,pathSpacing:a=1,pathOffset:i=0,...l},c,u,d){if(nx(e,l,u),c){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:f,style:h}=e;f.transform&&(h.transform=f.transform,delete f.transform),(h.transform||f.transformOrigin)&&(h.transformOrigin=f.transformOrigin??"50% 50%",delete f.transformOrigin),h.transform&&(h.transformBox=(d==null?void 0:d.transformBox)??"fill-box",delete f.transformBox),t!==void 0&&(f.x=t),r!==void 0&&(f.y=r),s!==void 0&&(f.scale=s),n!==void 0&&X3(f,n,a,i,!1)}const W_=()=>({...ax(),attrs:{}}),q_=e=>typeof e=="string"&&e.toLowerCase()==="svg";function Q3(e,t,r,s){const n=j.useMemo(()=>{const a=W_();return V_(a,t,q_(s),e.transformTemplate,e.style),{...a.attrs,style:{...a.style}}},[t]);if(e.style){const a={};$_(a,e.style,e),n.style={...a,...n.style}}return n}const Y3=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function ix(e){return typeof e!="string"||e.includes("-")?!1:!!(Y3.indexOf(e)>-1||/[A-Z]/u.test(e))}function J3(e,t,r,{latestValues:s},n,a=!1){const l=(ix(e)?Q3:H3)(t,s,n,e),c=L3(t,typeof e=="string",a),u=e!==j.Fragment?{...c,...l,ref:r}:{},{children:d}=t,f=j.useMemo(()=>jr(d)?d.get():d,[d]);return j.createElement(e,{...u,children:f})}function Kv(e){const t=[{},{}];return e==null||e.values.forEach((r,s)=>{t[0][s]=r.get(),t[1][s]=r.getVelocity()}),t}function ox(e,t,r,s){if(typeof t=="function"){const[n,a]=Kv(s);t=t(r!==void 0?r:e.custom,n,a)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[n,a]=Kv(s);t=t(r!==void 0?r:e.custom,n,a)}return t}function $u(e){return jr(e)?e.get():e}function Z3({scrapeMotionValuesFromProps:e,createRenderState:t},r,s,n){return{latestValues:eA(r,s,n,e),renderState:t()}}function eA(e,t,r,s){const n={},a=s(e,{});for(const h in a)n[h]=$u(a[h]);let{initial:i,animate:l}=e;const c=a0(e),u=U_(e);t&&u&&!c&&e.inherit!==!1&&(i===void 0&&(i=t.initial),l===void 0&&(l=t.animate));let d=r?r.initial===!1:!1;d=d||i===!1;const f=d?l:i;if(f&&typeof f!="boolean"&&!n0(f)){const h=Array.isArray(f)?f:[f];for(let m=0;m<h.length;m++){const x=ox(e,h[m]);if(x){const{transitionEnd:p,transition:g,...w}=x;for(const v in w){let y=w[v];if(Array.isArray(y)){const b=d?y.length-1:0;y=y[b]}y!==null&&(n[v]=y)}for(const v in p)n[v]=p[v]}}}return n}const H_=e=>(t,r)=>{const s=j.useContext(s0),n=j.useContext(r0),a=()=>Z3(e,t,s,n);return r?a():Fp(a)};function lx(e,t,r){var a;const{style:s}=e,n={};for(const i in s)(jr(s[i])||t.style&&jr(t.style[i])||z_(i,e)||((a=r==null?void 0:r.getValue(i))==null?void 0:a.liveStyle)!==void 0)&&(n[i]=s[i]);return n}const tA=H_({scrapeMotionValuesFromProps:lx,createRenderState:ax});function G_(e,t,r){const s=lx(e,t,r);for(const n in e)if(jr(e[n])||jr(t[n])){const a=jo.indexOf(n)!==-1?"attr"+n.charAt(0).toUpperCase()+n.substring(1):n;s[a]=e[n]}return s}const rA=H_({scrapeMotionValuesFromProps:G_,createRenderState:W_}),sA=Symbol.for("motionComponentSymbol");function Vi(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function nA(e,t,r){return j.useCallback(s=>{s&&e.onMount&&e.onMount(s),t&&(s?t.mount(s):t.unmount()),r&&(typeof r=="function"?r(s):Vi(r)&&(r.current=s))},[t])}const cx=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),aA="framerAppearId",K_="data-"+cx(aA),X_=j.createContext({});function iA(e,t,r,s,n){var p,g;const{visualElement:a}=j.useContext(s0),i=j.useContext(M_),l=j.useContext(r0),c=j.useContext(ex).reducedMotion,u=j.useRef(null);s=s||i.renderer,!u.current&&s&&(u.current=s(e,{visualState:t,parent:a,props:r,presenceContext:l,blockInitialAnimation:l?l.initial===!1:!1,reducedMotionConfig:c}));const d=u.current,f=j.useContext(X_);d&&!d.projection&&n&&(d.type==="html"||d.type==="svg")&&oA(u.current,r,n,f);const h=j.useRef(!1);j.useInsertionEffect(()=>{d&&h.current&&d.update(r,l)});const m=r[K_],x=j.useRef(!!m&&!((p=window.MotionHandoffIsComplete)!=null&&p.call(window,m))&&((g=window.MotionHasOptimisedAnimation)==null?void 0:g.call(window,m)));return Hb(()=>{d&&(h.current=!0,window.MotionIsMounted=!0,d.updateFeatures(),d.scheduleRenderMicrotask(),x.current&&d.animationState&&d.animationState.animateChanges())}),j.useEffect(()=>{d&&(!x.current&&d.animationState&&d.animationState.animateChanges(),x.current&&(queueMicrotask(()=>{var w;(w=window.MotionHandoffMarkAsComplete)==null||w.call(window,m)}),x.current=!1),d.enteringChildren=void 0)}),d}function oA(e,t,r,s){const{layoutId:n,layout:a,drag:i,dragConstraints:l,layoutScroll:c,layoutRoot:u,layoutCrossfade:d}=t;e.projection=new r(e.latestValues,t["data-framer-portal-id"]?void 0:Q_(e.parent)),e.projection.setOptions({layoutId:n,layout:a,alwaysMeasureLayout:!!i||l&&Vi(l),visualElement:e,animationType:typeof a=="string"?a:"both",initialPromotionConfig:s,crossfade:d,layoutScroll:c,layoutRoot:u})}function Q_(e){if(e)return e.options.allowProjection!==!1?e.projection:Q_(e.parent)}function lf(e,{forwardMotionProps:t=!1}={},r,s){r&&I3(r);const n=ix(e)?rA:tA;function a(l,c){let u;const d={...j.useContext(ex),...l,layoutId:lA(l)},{isStatic:f}=d,h=B3(l),m=n(l,f);if(!f&&Pp){cA();const x=uA(d);u=x.MeasureLayout,h.visualElement=iA(e,m,d,s,x.ProjectionNode)}return o.jsxs(s0.Provider,{value:h,children:[u&&h.visualElement?o.jsx(u,{visualElement:h.visualElement,...d}):null,J3(e,l,nA(m,h.visualElement,c),m,f,t)]})}a.displayName=`motion.${typeof e=="string"?e:`create(${e.displayName??e.name??""})`}`;const i=j.forwardRef(a);return i[sA]=e,i}function lA({layoutId:e}){const t=j.useContext(Ap).id;return t&&e!==void 0?t+"-"+e:e}function cA(e,t){j.useContext(M_).strict}function uA(e){const{drag:t,layout:r}=xo;if(!t&&!r)return{};const s={...t,...r};return{MeasureLayout:t!=null&&t.isEnabled(e)||r!=null&&r.isEnabled(e)?s.MeasureLayout:void 0,ProjectionNode:s.ProjectionNode}}function dA(e,t){if(typeof Proxy>"u")return lf;const r=new Map,s=(a,i)=>lf(a,i,e,t),n=(a,i)=>s(a,i);return new Proxy(n,{get:(a,i)=>i==="create"?s:(r.has(i)||r.set(i,lf(i,void 0,e,t)),r.get(i))})}function Y_({top:e,left:t,right:r,bottom:s}){return{x:{min:t,max:r},y:{min:e,max:s}}}function fA({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function hA(e,t){if(!t)return e;const r=t({x:e.left,y:e.top}),s=t({x:e.right,y:e.bottom});return{top:r.y,left:r.x,bottom:s.y,right:s.x}}function cf(e){return e===void 0||e===1}function Qh({scale:e,scaleX:t,scaleY:r}){return!cf(e)||!cf(t)||!cf(r)}function Aa(e){return Qh(e)||J_(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function J_(e){return Xv(e.x)||Xv(e.y)}function Xv(e){return e&&e!=="0%"}function wd(e,t,r){const s=e-r,n=t*s;return r+n}function Qv(e,t,r,s,n){return n!==void 0&&(e=wd(e,n,s)),wd(e,r,s)+t}function Yh(e,t=0,r=1,s,n){e.min=Qv(e.min,t,r,s,n),e.max=Qv(e.max,t,r,s,n)}function Z_(e,{x:t,y:r}){Yh(e.x,t.translate,t.scale,t.originPoint),Yh(e.y,r.translate,r.scale,r.originPoint)}const Yv=.999999999999,Jv=1.0000000000001;function mA(e,t,r,s=!1){const n=r.length;if(!n)return;t.x=t.y=1;let a,i;for(let l=0;l<n;l++){a=r[l],i=a.projectionDelta;const{visualElement:c}=a.options;c&&c.props.style&&c.props.style.display==="contents"||(s&&a.options.layoutScroll&&a.scroll&&a!==a.root&&qi(e,{x:-a.scroll.offset.x,y:-a.scroll.offset.y}),i&&(t.x*=i.x.scale,t.y*=i.y.scale,Z_(e,i)),s&&Aa(a.latestValues)&&qi(e,a.latestValues))}t.x<Jv&&t.x>Yv&&(t.x=1),t.y<Jv&&t.y>Yv&&(t.y=1)}function Wi(e,t){e.min=e.min+t,e.max=e.max+t}function Zv(e,t,r,s,n=.5){const a=Ct(e.min,e.max,n);Yh(e,t,r,a,s)}function qi(e,t){Zv(e.x,t.x,t.scaleX,t.scale,t.originX),Zv(e.y,t.y,t.scaleY,t.scale,t.originY)}function eS(e,t){return Y_(hA(e.getBoundingClientRect(),t))}function pA(e,t,r){const s=eS(e,r),{scroll:n}=t;return n&&(Wi(s.x,n.offset.x),Wi(s.y,n.offset.y)),s}const ey=()=>({translate:0,scale:1,origin:0,originPoint:0}),Hi=()=>({x:ey(),y:ey()}),ty=()=>({min:0,max:0}),Ut=()=>({x:ty(),y:ty()}),Jh={current:null},tS={current:!1};function xA(){if(tS.current=!0,!!Pp)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>Jh.current=e.matches;e.addEventListener("change",t),t()}else Jh.current=!1}const gA=new WeakMap;function vA(e,t,r){for(const s in t){const n=t[s],a=r[s];if(jr(n))e.addValue(s,n);else if(jr(a))e.addValue(s,po(n,{owner:e}));else if(a!==n)if(e.hasValue(s)){const i=e.getValue(s);i.liveStyle===!0?i.jump(n):i.hasAnimated||i.set(n)}else{const i=e.getStaticValue(s);e.addValue(s,po(i!==void 0?i:n,{owner:e}))}}for(const s in r)t[s]===void 0&&e.removeValue(s);return t}const ry=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class yA{scrapeMotionValuesFromProps(t,r,s){return{}}constructor({parent:t,props:r,presenceContext:s,reducedMotionConfig:n,blockInitialAnimation:a,visualState:i},l={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=Xp,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const h=Gr.now();this.renderScheduledAt<h&&(this.renderScheduledAt=h,St.render(this.render,!1,!0))};const{latestValues:c,renderState:u}=i;this.latestValues=c,this.baseTarget={...c},this.initialValues=r.initial?{...c}:{},this.renderState=u,this.parent=t,this.props=r,this.presenceContext=s,this.depth=t?t.depth+1:0,this.reducedMotionConfig=n,this.options=l,this.blockInitialAnimation=!!a,this.isControllingVariants=a0(r),this.isVariantNode=U_(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:d,...f}=this.scrapeMotionValuesFromProps(r,{},this);for(const h in f){const m=f[h];c[h]!==void 0&&jr(m)&&m.set(c[h])}}mount(t){var r;this.current=t,gA.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((s,n)=>this.bindToMotionValue(n,s)),tS.current||xA(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:Jh.current,(r=this.parent)==null||r.addChild(this),this.update(this.props,this.presenceContext)}unmount(){var t;this.projection&&this.projection.unmount(),la(this.notifyUpdate),la(this.render),this.valueSubscriptions.forEach(r=>r()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),(t=this.parent)==null||t.removeChild(this);for(const r in this.events)this.events[r].clear();for(const r in this.features){const s=this.features[r];s&&(s.unmount(),s.isMounted=!1)}this.current=null}addChild(t){this.children.add(t),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(t)}removeChild(t){this.children.delete(t),this.enteringChildren&&this.enteringChildren.delete(t)}bindToMotionValue(t,r){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const s=To.has(t);s&&this.onBindTransform&&this.onBindTransform();const n=r.on("change",i=>{this.latestValues[t]=i,this.props.onUpdate&&St.preRender(this.notifyUpdate),s&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,t,r)),this.valueSubscriptions.set(t,()=>{n(),a&&a(),r.owner&&r.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in xo){const r=xo[t];if(!r)continue;const{isEnabled:s,Feature:n}=r;if(!this.features[t]&&n&&s(this.props)&&(this.features[t]=new n(this)),this.features[t]){const a=this.features[t];a.isMounted?a.update():(a.mount(),a.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Ut()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,r){this.latestValues[t]=r}update(t,r){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let s=0;s<ry.length;s++){const n=ry[s];this.propEventSubscriptions[n]&&(this.propEventSubscriptions[n](),delete this.propEventSubscriptions[n]);const a="on"+n,i=t[a];i&&(this.propEventSubscriptions[n]=this.on(n,i))}this.prevMotionValues=vA(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(t),()=>r.variantChildren.delete(t)}addValue(t,r){const s=this.values.get(t);r!==s&&(s&&this.removeValue(t),this.bindToMotionValue(t,r),this.values.set(t,r),this.latestValues[t]=r.get())}removeValue(t){this.values.delete(t);const r=this.valueSubscriptions.get(t);r&&(r(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,r){if(this.props.values&&this.props.values[t])return this.props.values[t];let s=this.values.get(t);return s===void 0&&r!==void 0&&(s=po(r===null?void 0:r,{owner:this}),this.addValue(t,s)),s}readValue(t,r){let s=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:this.getBaseTargetFromProps(this.props,t)??this.readValueFromInstance(this.current,t,this.options);return s!=null&&(typeof s=="string"&&(Gb(s)||Xb(s))?s=parseFloat(s):!j3(s)&&ca.test(r)&&(s=A_(t,r)),this.setBaseTarget(t,jr(s)?s.get():s)),jr(s)?s.get():s}setBaseTarget(t,r){this.baseTarget[t]=r}getBaseTarget(t){var a;const{initial:r}=this.props;let s;if(typeof r=="string"||typeof r=="object"){const i=ox(this.props,r,(a=this.presenceContext)==null?void 0:a.custom);i&&(s=i[t])}if(r&&s!==void 0)return s;const n=this.getBaseTargetFromProps(this.props,t);return n!==void 0&&!jr(n)?n:this.initialValues[t]!==void 0&&s===void 0?void 0:this.baseTarget[t]}on(t,r){return this.events[t]||(this.events[t]=new Lp),this.events[t].add(r)}notify(t,...r){this.events[t]&&this.events[t].notify(...r)}scheduleRenderMicrotask(){Jp.render(this.render)}}class rS extends yA{constructor(){super(...arguments),this.KeyframeResolver=p3}sortInstanceNodePosition(t,r){return t.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(t,r){return t.style?t.style[r]:void 0}removeValueFromRenderState(t,{vars:r,style:s}){delete r[t],delete s[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;jr(t)&&(this.childSubscription=t.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}}function sS(e,{style:t,vars:r},s,n){const a=e.style;let i;for(i in t)a[i]=t[i];n==null||n.applyProjectionStyles(a,s);for(i in r)a.setProperty(i,r[i])}function wA(e){return window.getComputedStyle(e)}class bA extends rS{constructor(){super(...arguments),this.type="html",this.renderInstance=sS}readValueFromInstance(t,r){var s;if(To.has(r))return(s=this.projection)!=null&&s.isProjecting?Vh(r):IC(t,r);{const n=wA(t),a=(Up(r)?n.getPropertyValue(r):n[r])||0;return typeof a=="string"?a.trim():a}}measureInstanceViewportBox(t,{transformPagePoint:r}){return eS(t,r)}build(t,r,s){nx(t,r,s.transformTemplate)}scrapeMotionValuesFromProps(t,r,s){return lx(t,r,s)}}const nS=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function _A(e,t,r,s){sS(e,t,void 0,s);for(const n in t.attrs)e.setAttribute(nS.has(n)?n:cx(n),t.attrs[n])}class SA extends rS{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Ut}getBaseTargetFromProps(t,r){return t[r]}readValueFromInstance(t,r){if(To.has(r)){const s=C_(r);return s&&s.default||0}return r=nS.has(r)?r:cx(r),t.getAttribute(r)}scrapeMotionValuesFromProps(t,r,s){return G_(t,r,s)}build(t,r,s){V_(t,r,this.isSVGTag,s.transformTemplate,s.style)}renderInstance(t,r,s,n){_A(t,r,s,n)}mount(t){this.isSVGTag=q_(t.tagName),super.mount(t)}}const kA=(e,t)=>ix(e)?new SA(t):new bA(t,{allowProjection:e!==j.Fragment});function eo(e,t,r){const s=e.getProps();return ox(s,t,r!==void 0?r:s.custom,e)}const Zh=e=>Array.isArray(e);function NA(e,t,r){e.hasValue(t)?e.getValue(t).set(r):e.addValue(t,po(r))}function EA(e){return Zh(e)?e[e.length-1]||0:e}function jA(e,t){const r=eo(e,t);let{transitionEnd:s={},transition:n={},...a}=r||{};a={...a,...s};for(const i in a){const l=EA(a[i]);NA(e,i,l)}}function TA(e){return!!(jr(e)&&e.add)}function em(e,t){const r=e.getValue("willChange");if(TA(r))return r.add(t);if(!r&&Rn.WillChange){const s=new Rn.WillChange("auto");e.addValue("willChange",s),s.add(t)}}function aS(e){return e.props[K_]}const CA=e=>e!==null;function AA(e,{repeat:t,repeatType:r="loop"},s){const n=e.filter(CA),a=t&&r!=="loop"&&t%2===1?0:n.length-1;return n[a]}const FA={type:"spring",stiffness:500,damping:25,restSpeed:10},PA=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),RA={type:"keyframes",duration:.8},IA={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},OA=(e,{keyframes:t})=>t.length>2?RA:To.has(e)?e.startsWith("scale")?PA(t[1]):FA:IA;function DA({when:e,delay:t,delayChildren:r,staggerChildren:s,staggerDirection:n,repeat:a,repeatType:i,repeatDelay:l,from:c,elapsed:u,...d}){return!!Object.keys(d).length}const ux=(e,t,r,s={},n,a)=>i=>{const l=Qp(s,e)||{},c=l.delay||s.delay||0;let{elapsed:u=0}=s;u=u-dn(c);const d={keyframes:Array.isArray(r)?r:[null,r],ease:"easeOut",velocity:t.getVelocity(),...l,delay:-u,onUpdate:h=>{t.set(h),l.onUpdate&&l.onUpdate(h)},onComplete:()=>{i(),l.onComplete&&l.onComplete()},name:e,motionValue:t,element:a?void 0:n};DA(l)||Object.assign(d,OA(e,d)),d.duration&&(d.duration=dn(d.duration)),d.repeatDelay&&(d.repeatDelay=dn(d.repeatDelay)),d.from!==void 0&&(d.keyframes[0]=d.from);let f=!1;if((d.type===!1||d.duration===0&&!d.repeatDelay)&&(Kh(d),d.delay===0&&(f=!0)),(Rn.instantAnimations||Rn.skipAnimations)&&(f=!0,Kh(d),d.delay=0),d.allowFlatten=!l.type&&!l.ease,f&&!a&&t.get()!==void 0){const h=AA(d.keyframes,l);if(h!==void 0){St.update(()=>{d.onUpdate(h),d.onComplete()});return}}return l.isSync?new Kp(d):new s3(d)};function LA({protectedKeys:e,needsAnimating:t},r){const s=e.hasOwnProperty(r)&&t[r]!==!0;return t[r]=!1,s}function iS(e,t,{delay:r=0,transitionOverride:s,type:n}={}){let{transition:a=e.getDefaultTransition(),transitionEnd:i,...l}=t;s&&(a=s);const c=[],u=n&&e.animationState&&e.animationState.getState()[n];for(const d in l){const f=e.getValue(d,e.latestValues[d]??null),h=l[d];if(h===void 0||u&&LA(u,d))continue;const m={delay:r,...Qp(a||{},d)},x=f.get();if(x!==void 0&&!f.isAnimating&&!Array.isArray(h)&&h===x&&!m.velocity)continue;let p=!1;if(window.MotionHandoffAnimation){const w=aS(e);if(w){const v=window.MotionHandoffAnimation(w,d,St);v!==null&&(m.startTime=v,p=!0)}}em(e,d),f.start(ux(d,f,h,e.shouldReduceMotion&&E_.has(d)?{type:!1}:m,e,p));const g=f.animation;g&&c.push(g)}return i&&Promise.all(c).then(()=>{St.update(()=>{i&&jA(e,i)})}),c}function oS(e,t,r,s=0,n=1){const a=Array.from(e).sort((u,d)=>u.sortNodePosition(d)).indexOf(t),i=e.size,l=(i-1)*s;return typeof r=="function"?r(a,i):n===1?a*s:l-a*s}function tm(e,t,r={}){var c;const s=eo(e,t,r.type==="exit"?(c=e.presenceContext)==null?void 0:c.custom:void 0);let{transition:n=e.getDefaultTransition()||{}}=s||{};r.transitionOverride&&(n=r.transitionOverride);const a=s?()=>Promise.all(iS(e,s,r)):()=>Promise.resolve(),i=e.variantChildren&&e.variantChildren.size?(u=0)=>{const{delayChildren:d=0,staggerChildren:f,staggerDirection:h}=n;return MA(e,t,u,d,f,h,r)}:()=>Promise.resolve(),{when:l}=n;if(l){const[u,d]=l==="beforeChildren"?[a,i]:[i,a];return u().then(()=>d())}else return Promise.all([a(),i(r.delay)])}function MA(e,t,r=0,s=0,n=0,a=1,i){const l=[];for(const c of e.variantChildren)c.notify("AnimationStart",t),l.push(tm(c,t,{...i,delay:r+(typeof s=="function"?0:s)+oS(e.variantChildren,c,s,n,a)}).then(()=>c.notify("AnimationComplete",t)));return Promise.all(l)}function BA(e,t,r={}){e.notify("AnimationStart",t);let s;if(Array.isArray(t)){const n=t.map(a=>tm(e,a,r));s=Promise.all(n)}else if(typeof t=="string")s=tm(e,t,r);else{const n=typeof t=="function"?eo(e,t,r.custom):t;s=Promise.all(iS(e,n,r))}return s.then(()=>{e.notify("AnimationComplete",t)})}function lS(e,t){if(!Array.isArray(t))return!1;const r=t.length;if(r!==e.length)return!1;for(let s=0;s<r;s++)if(t[s]!==e[s])return!1;return!0}const UA=sx.length;function cS(e){if(!e)return;if(!e.isControllingVariants){const r=e.parent?cS(e.parent)||{}:{};return e.props.initial!==void 0&&(r.initial=e.props.initial),r}const t={};for(let r=0;r<UA;r++){const s=sx[r],n=e.props[s];(Yl(n)||n===!1)&&(t[s]=n)}return t}const zA=[...rx].reverse(),$A=rx.length;function VA(e){return t=>Promise.all(t.map(({animation:r,options:s})=>BA(e,r,s)))}function WA(e){let t=VA(e),r=sy(),s=!0;const n=c=>(u,d)=>{var h;const f=eo(e,d,c==="exit"?(h=e.presenceContext)==null?void 0:h.custom:void 0);if(f){const{transition:m,transitionEnd:x,...p}=f;u={...u,...p,...x}}return u};function a(c){t=c(e)}function i(c){const{props:u}=e,d=cS(e.parent)||{},f=[],h=new Set;let m={},x=1/0;for(let g=0;g<$A;g++){const w=zA[g],v=r[w],y=u[w]!==void 0?u[w]:d[w],b=Yl(y),S=w===c?v.isActive:null;S===!1&&(x=g);let _=y===d[w]&&y!==u[w]&&b;if(_&&s&&e.manuallyAnimateOnMount&&(_=!1),v.protectedKeys={...m},!v.isActive&&S===null||!y&&!v.prevProp||n0(y)||typeof y=="boolean")continue;const k=qA(v.prevProp,y);let E=k||w===c&&v.isActive&&!_&&b||g>x&&b,T=!1;const M=Array.isArray(y)?y:[y];let q=M.reduce(n(w),{});S===!1&&(q={});const{prevResolvedValues:D={}}=v,W={...D,...q},ee=ce=>{E=!0,h.has(ce)&&(T=!0,h.delete(ce)),v.needsAnimating[ce]=!0;const Q=e.getValue(ce);Q&&(Q.liveStyle=!1)};for(const ce in W){const Q=q[ce],B=D[ce];if(m.hasOwnProperty(ce))continue;let me=!1;Zh(Q)&&Zh(B)?me=!lS(Q,B):me=Q!==B,me?Q!=null?ee(ce):h.add(ce):Q!==void 0&&h.has(ce)?ee(ce):v.protectedKeys[ce]=!0}v.prevProp=y,v.prevResolvedValues=q,v.isActive&&(m={...m,...q}),s&&e.blockInitialAnimation&&(E=!1);const Y=_&&k;E&&(!Y||T)&&f.push(...M.map(ce=>{const Q={type:w};if(typeof ce=="string"&&s&&!Y&&e.manuallyAnimateOnMount&&e.parent){const{parent:B}=e,me=eo(B,ce);if(B.enteringChildren&&me){const{delayChildren:fe}=me.transition||{};Q.delay=oS(B.enteringChildren,e,fe)}}return{animation:ce,options:Q}}))}if(h.size){const g={};if(typeof u.initial!="boolean"){const w=eo(e,Array.isArray(u.initial)?u.initial[0]:u.initial);w&&w.transition&&(g.transition=w.transition)}h.forEach(w=>{const v=e.getBaseTarget(w),y=e.getValue(w);y&&(y.liveStyle=!0),g[w]=v??null}),f.push({animation:g})}let p=!!f.length;return s&&(u.initial===!1||u.initial===u.animate)&&!e.manuallyAnimateOnMount&&(p=!1),s=!1,p?t(f):Promise.resolve()}function l(c,u){var f;if(r[c].isActive===u)return Promise.resolve();(f=e.variantChildren)==null||f.forEach(h=>{var m;return(m=h.animationState)==null?void 0:m.setActive(c,u)}),r[c].isActive=u;const d=i(c);for(const h in r)r[h].protectedKeys={};return d}return{animateChanges:i,setActive:l,setAnimateFunction:a,getState:()=>r,reset:()=>{r=sy()}}}function qA(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!lS(t,e):!1}function Na(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function sy(){return{animate:Na(!0),whileInView:Na(),whileHover:Na(),whileTap:Na(),whileDrag:Na(),whileFocus:Na(),exit:Na()}}class va{constructor(t){this.isMounted=!1,this.node=t}update(){}}class HA extends va{constructor(t){super(t),t.animationState||(t.animationState=WA(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();n0(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:r}=this.node.prevProps||{};t!==r&&this.updateAnimationControlsSubscription()}unmount(){var t;this.node.animationState.reset(),(t=this.unmountControls)==null||t.call(this)}}let GA=0;class KA extends va{constructor(){super(...arguments),this.id=GA++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:r}=this.node.presenceContext,{isPresent:s}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===s)return;const n=this.node.animationState.setActive("exit",!t);r&&!t&&n.then(()=>{r(this.id)})}mount(){const{register:t,onExitComplete:r}=this.node.presenceContext||{};r&&r(this.id),t&&(this.unmount=t(this.id))}unmount(){}}const XA={animation:{Feature:HA},exit:{Feature:KA}};function Zl(e,t,r,s={passive:!0}){return e.addEventListener(t,r,s),()=>e.removeEventListener(t,r)}function jc(e){return{point:{x:e.pageX,y:e.pageY}}}const QA=e=>t=>Zp(t)&&e(t,jc(t));function vl(e,t,r,s){return Zl(e,t,QA(r),s)}const uS=1e-4,YA=1-uS,JA=1+uS,dS=.01,ZA=0-dS,e6=0+dS;function Mr(e){return e.max-e.min}function t6(e,t,r){return Math.abs(e-t)<=r}function ny(e,t,r,s=.5){e.origin=s,e.originPoint=Ct(t.min,t.max,e.origin),e.scale=Mr(r)/Mr(t),e.translate=Ct(r.min,r.max,e.origin)-e.originPoint,(e.scale>=YA&&e.scale<=JA||isNaN(e.scale))&&(e.scale=1),(e.translate>=ZA&&e.translate<=e6||isNaN(e.translate))&&(e.translate=0)}function yl(e,t,r,s){ny(e.x,t.x,r.x,s?s.originX:void 0),ny(e.y,t.y,r.y,s?s.originY:void 0)}function ay(e,t,r){e.min=r.min+t.min,e.max=e.min+Mr(t)}function r6(e,t,r){ay(e.x,t.x,r.x),ay(e.y,t.y,r.y)}function iy(e,t,r){e.min=t.min-r.min,e.max=e.min+Mr(t)}function wl(e,t,r){iy(e.x,t.x,r.x),iy(e.y,t.y,r.y)}function _s(e){return[e("x"),e("y")]}const fS=({current:e})=>e?e.ownerDocument.defaultView:null,oy=(e,t)=>Math.abs(e-t);function s6(e,t){const r=oy(e.x,t.x),s=oy(e.y,t.y);return Math.sqrt(r**2+s**2)}class hS{constructor(t,r,{transformPagePoint:s,contextWindow:n=window,dragSnapToOrigin:a=!1,distanceThreshold:i=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const h=df(this.lastMoveEventInfo,this.history),m=this.startEvent!==null,x=s6(h.offset,{x:0,y:0})>=this.distanceThreshold;if(!m&&!x)return;const{point:p}=h,{timestamp:g}=fr;this.history.push({...p,timestamp:g});const{onStart:w,onMove:v}=this.handlers;m||(w&&w(this.lastMoveEvent,h),this.startEvent=this.lastMoveEvent),v&&v(this.lastMoveEvent,h)},this.handlePointerMove=(h,m)=>{this.lastMoveEvent=h,this.lastMoveEventInfo=uf(m,this.transformPagePoint),St.update(this.updatePoint,!0)},this.handlePointerUp=(h,m)=>{this.end();const{onEnd:x,onSessionEnd:p,resumeAnimation:g}=this.handlers;if(this.dragSnapToOrigin&&g&&g(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const w=df(h.type==="pointercancel"?this.lastMoveEventInfo:uf(m,this.transformPagePoint),this.history);this.startEvent&&x&&x(h,w),p&&p(h,w)},!Zp(t))return;this.dragSnapToOrigin=a,this.handlers=r,this.transformPagePoint=s,this.distanceThreshold=i,this.contextWindow=n||window;const l=jc(t),c=uf(l,this.transformPagePoint),{point:u}=c,{timestamp:d}=fr;this.history=[{...u,timestamp:d}];const{onSessionStart:f}=r;f&&f(t,df(c,this.history)),this.removeListeners=kc(vl(this.contextWindow,"pointermove",this.handlePointerMove),vl(this.contextWindow,"pointerup",this.handlePointerUp),vl(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),la(this.updatePoint)}}function uf(e,t){return t?{point:t(e.point)}:e}function ly(e,t){return{x:e.x-t.x,y:e.y-t.y}}function df({point:e},t){return{point:e,delta:ly(e,mS(t)),offset:ly(e,n6(t)),velocity:a6(t,.1)}}function n6(e){return e[0]}function mS(e){return e[e.length-1]}function a6(e,t){if(e.length<2)return{x:0,y:0};let r=e.length-1,s=null;const n=mS(e);for(;r>=0&&(s=e[r],!(n.timestamp-s.timestamp>dn(t)));)r--;if(!s)return{x:0,y:0};const a=Cs(n.timestamp-s.timestamp);if(a===0)return{x:0,y:0};const i={x:(n.x-s.x)/a,y:(n.y-s.y)/a};return i.x===1/0&&(i.x=0),i.y===1/0&&(i.y=0),i}function i6(e,{min:t,max:r},s){return t!==void 0&&e<t?e=s?Ct(t,e,s.min):Math.max(e,t):r!==void 0&&e>r&&(e=s?Ct(r,e,s.max):Math.min(e,r)),e}function cy(e,t,r){return{min:t!==void 0?e.min+t:void 0,max:r!==void 0?e.max+r-(e.max-e.min):void 0}}function o6(e,{top:t,left:r,bottom:s,right:n}){return{x:cy(e.x,r,n),y:cy(e.y,t,s)}}function uy(e,t){let r=t.min-e.min,s=t.max-e.max;return t.max-t.min<e.max-e.min&&([r,s]=[s,r]),{min:r,max:s}}function l6(e,t){return{x:uy(e.x,t.x),y:uy(e.y,t.y)}}function c6(e,t){let r=.5;const s=Mr(e),n=Mr(t);return n>s?r=Kl(t.min,t.max-s,e.min):s>n&&(r=Kl(e.min,e.max-n,t.min)),Pn(0,1,r)}function u6(e,t){const r={};return t.min!==void 0&&(r.min=t.min-e.min),t.max!==void 0&&(r.max=t.max-e.min),r}const rm=.35;function d6(e=rm){return e===!1?e=0:e===!0&&(e=rm),{x:dy(e,"left","right"),y:dy(e,"top","bottom")}}function dy(e,t,r){return{min:fy(e,t),max:fy(e,r)}}function fy(e,t){return typeof e=="number"?e:e[t]||0}const f6=new WeakMap;class h6{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Ut(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=t}start(t,{snapToCursor:r=!1,distanceThreshold:s}={}){const{presenceContext:n}=this.visualElement;if(n&&n.isPresent===!1)return;const a=f=>{const{dragSnapToOrigin:h}=this.getProps();h?this.pauseAnimation():this.stopAnimation(),r&&this.snapToCursor(jc(f).point)},i=(f,h)=>{const{drag:m,dragPropagation:x,onDragStart:p}=this.getProps();if(m&&!x&&(this.openDragLock&&this.openDragLock(),this.openDragLock=y3(m),!this.openDragLock))return;this.latestPointerEvent=f,this.latestPanInfo=h,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),_s(w=>{let v=this.getAxisMotionValue(w).get()||0;if(fn.test(v)){const{projection:y}=this.visualElement;if(y&&y.layout){const b=y.layout.layoutBox[w];b&&(v=Mr(b)*(parseFloat(v)/100))}}this.originPoint[w]=v}),p&&St.postRender(()=>p(f,h)),em(this.visualElement,"transform");const{animationState:g}=this.visualElement;g&&g.setActive("whileDrag",!0)},l=(f,h)=>{this.latestPointerEvent=f,this.latestPanInfo=h;const{dragPropagation:m,dragDirectionLock:x,onDirectionLock:p,onDrag:g}=this.getProps();if(!m&&!this.openDragLock)return;const{offset:w}=h;if(x&&this.currentDirection===null){this.currentDirection=m6(w),this.currentDirection!==null&&p&&p(this.currentDirection);return}this.updateAxis("x",h.point,w),this.updateAxis("y",h.point,w),this.visualElement.render(),g&&g(f,h)},c=(f,h)=>{this.latestPointerEvent=f,this.latestPanInfo=h,this.stop(f,h),this.latestPointerEvent=null,this.latestPanInfo=null},u=()=>_s(f=>{var h;return this.getAnimationState(f)==="paused"&&((h=this.getAxisMotionValue(f).animation)==null?void 0:h.play())}),{dragSnapToOrigin:d}=this.getProps();this.panSession=new hS(t,{onSessionStart:a,onStart:i,onMove:l,onSessionEnd:c,resumeAnimation:u},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:d,distanceThreshold:s,contextWindow:fS(this.visualElement)})}stop(t,r){const s=t||this.latestPointerEvent,n=r||this.latestPanInfo,a=this.isDragging;if(this.cancel(),!a||!n||!s)return;const{velocity:i}=n;this.startAnimation(i);const{onDragEnd:l}=this.getProps();l&&St.postRender(()=>l(s,n))}cancel(){this.isDragging=!1;const{projection:t,animationState:r}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:s}=this.getProps();!s&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(t,r,s){const{drag:n}=this.getProps();if(!s||!ou(t,n,this.currentDirection))return;const a=this.getAxisMotionValue(t);let i=this.originPoint[t]+s[t];this.constraints&&this.constraints[t]&&(i=i6(i,this.constraints[t],this.elastic[t])),a.set(i)}resolveConstraints(){var a;const{dragConstraints:t,dragElastic:r}=this.getProps(),s=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(a=this.visualElement.projection)==null?void 0:a.layout,n=this.constraints;t&&Vi(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&s?this.constraints=o6(s.layoutBox,t):this.constraints=!1,this.elastic=d6(r),n!==this.constraints&&s&&this.constraints&&!this.hasMutatedConstraints&&_s(i=>{this.constraints!==!1&&this.getAxisMotionValue(i)&&(this.constraints[i]=u6(s.layoutBox[i],this.constraints[i]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:r}=this.getProps();if(!t||!Vi(t))return!1;const s=t.current,{projection:n}=this.visualElement;if(!n||!n.layout)return!1;const a=pA(s,n.root,this.visualElement.getTransformPagePoint());let i=l6(n.layout.layoutBox,a);if(r){const l=r(fA(i));this.hasMutatedConstraints=!!l,l&&(i=Y_(l))}return i}startAnimation(t){const{drag:r,dragMomentum:s,dragElastic:n,dragTransition:a,dragSnapToOrigin:i,onDragTransitionEnd:l}=this.getProps(),c=this.constraints||{},u=_s(d=>{if(!ou(d,r,this.currentDirection))return;let f=c&&c[d]||{};i&&(f={min:0,max:0});const h=n?200:1e6,m=n?40:1e7,x={type:"inertia",velocity:s?t[d]:0,bounceStiffness:h,bounceDamping:m,timeConstant:750,restDelta:1,restSpeed:10,...a,...f};return this.startAxisValueAnimation(d,x)});return Promise.all(u).then(l)}startAxisValueAnimation(t,r){const s=this.getAxisMotionValue(t);return em(this.visualElement,t),s.start(ux(t,s,0,r,this.visualElement,!1))}stopAnimation(){_s(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){_s(t=>{var r;return(r=this.getAxisMotionValue(t).animation)==null?void 0:r.pause()})}getAnimationState(t){var r;return(r=this.getAxisMotionValue(t).animation)==null?void 0:r.state}getAxisMotionValue(t){const r=`_drag${t.toUpperCase()}`,s=this.visualElement.getProps(),n=s[r];return n||this.visualElement.getValue(t,(s.initial?s.initial[t]:void 0)||0)}snapToCursor(t){_s(r=>{const{drag:s}=this.getProps();if(!ou(r,s,this.currentDirection))return;const{projection:n}=this.visualElement,a=this.getAxisMotionValue(r);if(n&&n.layout){const{min:i,max:l}=n.layout.layoutBox[r];a.set(t[r]-Ct(i,l,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:r}=this.getProps(),{projection:s}=this.visualElement;if(!Vi(r)||!s||!this.constraints)return;this.stopAnimation();const n={x:0,y:0};_s(i=>{const l=this.getAxisMotionValue(i);if(l&&this.constraints!==!1){const c=l.get();n[i]=c6({min:c,max:c},this.constraints[i])}});const{transformTemplate:a}=this.visualElement.getProps();this.visualElement.current.style.transform=a?a({},""):"none",s.root&&s.root.updateScroll(),s.updateLayout(),this.resolveConstraints(),_s(i=>{if(!ou(i,t,null))return;const l=this.getAxisMotionValue(i),{min:c,max:u}=this.constraints[i];l.set(Ct(c,u,n[i]))})}addListeners(){if(!this.visualElement.current)return;f6.set(this.visualElement,this);const t=this.visualElement.current,r=vl(t,"pointerdown",c=>{const{drag:u,dragListener:d=!0}=this.getProps();u&&d&&this.start(c)}),s=()=>{const{dragConstraints:c}=this.getProps();Vi(c)&&c.current&&(this.constraints=this.resolveRefConstraints())},{projection:n}=this.visualElement,a=n.addEventListener("measure",s);n&&!n.layout&&(n.root&&n.root.updateScroll(),n.updateLayout()),St.read(s);const i=Zl(window,"resize",()=>this.scalePositionWithinConstraints()),l=n.addEventListener("didUpdate",({delta:c,hasLayoutChanged:u})=>{this.isDragging&&u&&(_s(d=>{const f=this.getAxisMotionValue(d);f&&(this.originPoint[d]+=c[d].translate,f.set(f.get()+c[d].translate))}),this.visualElement.render())});return()=>{i(),r(),a(),l&&l()}}getProps(){const t=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:s=!1,dragPropagation:n=!1,dragConstraints:a=!1,dragElastic:i=rm,dragMomentum:l=!0}=t;return{...t,drag:r,dragDirectionLock:s,dragPropagation:n,dragConstraints:a,dragElastic:i,dragMomentum:l}}}function ou(e,t,r){return(t===!0||t===e)&&(r===null||r===e)}function m6(e,t=10){let r=null;return Math.abs(e.y)>t?r="y":Math.abs(e.x)>t&&(r="x"),r}class p6 extends va{constructor(t){super(t),this.removeGroupControls=Fs,this.removeListeners=Fs,this.controls=new h6(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Fs}unmount(){this.removeGroupControls(),this.removeListeners()}}const hy=e=>(t,r)=>{e&&St.postRender(()=>e(t,r))};class x6 extends va{constructor(){super(...arguments),this.removePointerDownListener=Fs}onPointerDown(t){this.session=new hS(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:fS(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:r,onPan:s,onPanEnd:n}=this.node.getProps();return{onSessionStart:hy(t),onStart:hy(r),onMove:s,onEnd:(a,i)=>{delete this.session,n&&St.postRender(()=>n(a,i))}}}mount(){this.removePointerDownListener=vl(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const Vu={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function my(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const Qo={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(We.test(e))e=parseFloat(e);else return e;const r=my(e,t.target.x),s=my(e,t.target.y);return`${r}% ${s}%`}},g6={correct:(e,{treeScale:t,projectionDelta:r})=>{const s=e,n=ca.parse(e);if(n.length>5)return s;const a=ca.createTransformer(e),i=typeof n[0]!="number"?1:0,l=r.x.scale*t.x,c=r.y.scale*t.y;n[0+i]/=l,n[1+i]/=c;const u=Ct(l,c,.5);return typeof n[2+i]=="number"&&(n[2+i]/=u),typeof n[3+i]=="number"&&(n[3+i]/=u),a(n)}};let ff=!1;class v6 extends j.Component{componentDidMount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:s,layoutId:n}=this.props,{projection:a}=t;U3(y6),a&&(r.group&&r.group.add(a),s&&s.register&&n&&s.register(a),ff&&a.root.didUpdate(),a.addEventListener("animationComplete",()=>{this.safeToRemove()}),a.setOptions({...a.options,onExitComplete:()=>this.safeToRemove()})),Vu.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:r,visualElement:s,drag:n,isPresent:a}=this.props,{projection:i}=s;return i&&(i.isPresent=a,ff=!0,n||t.layoutDependency!==r||r===void 0||t.isPresent!==a?i.willUpdate():this.safeToRemove(),t.isPresent!==a&&(a?i.promote():i.relegate()||St.postRender(()=>{const l=i.getStack();(!l||!l.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),Jp.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:s}=this.props,{projection:n}=t;ff=!0,n&&(n.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(n),s&&s.deregister&&s.deregister(n))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function pS(e){const[t,r]=L_(),s=j.useContext(Ap);return o.jsx(v6,{...e,layoutGroup:s,switchLayoutGroup:j.useContext(X_),isPresent:t,safeToRemove:r})}const y6={borderRadius:{...Qo,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Qo,borderTopRightRadius:Qo,borderBottomLeftRadius:Qo,borderBottomRightRadius:Qo,boxShadow:g6};function w6(e,t,r){const s=jr(e)?e:po(e);return s.start(ux("",s,t,r)),s.animation}const b6=(e,t)=>e.depth-t.depth;class _6{constructor(){this.children=[],this.isDirty=!1}add(t){Rp(this.children,t),this.isDirty=!0}remove(t){Ip(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(b6),this.isDirty=!1,this.children.forEach(t)}}function S6(e,t){const r=Gr.now(),s=({timestamp:n})=>{const a=n-r;a>=t&&(la(s),e(a-t))};return St.setup(s,!0),()=>la(s)}const xS=["TopLeft","TopRight","BottomLeft","BottomRight"],k6=xS.length,py=e=>typeof e=="string"?parseFloat(e):e,xy=e=>typeof e=="number"||We.test(e);function N6(e,t,r,s,n,a){n?(e.opacity=Ct(0,r.opacity??1,E6(s)),e.opacityExit=Ct(t.opacity??1,0,j6(s))):a&&(e.opacity=Ct(t.opacity??1,r.opacity??1,s));for(let i=0;i<k6;i++){const l=`border${xS[i]}Radius`;let c=gy(t,l),u=gy(r,l);if(c===void 0&&u===void 0)continue;c||(c=0),u||(u=0),c===0||u===0||xy(c)===xy(u)?(e[l]=Math.max(Ct(py(c),py(u),s),0),(fn.test(u)||fn.test(c))&&(e[l]+="%")):e[l]=u}(t.rotate||r.rotate)&&(e.rotate=Ct(t.rotate||0,r.rotate||0,s))}function gy(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const E6=gS(0,.5,s_),j6=gS(.5,.95,Fs);function gS(e,t,r){return s=>s<e?0:s>t?1:r(Kl(e,t,s))}function vy(e,t){e.min=t.min,e.max=t.max}function gs(e,t){vy(e.x,t.x),vy(e.y,t.y)}function yy(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function wy(e,t,r,s,n){return e-=t,e=wd(e,1/r,s),n!==void 0&&(e=wd(e,1/n,s)),e}function T6(e,t=0,r=1,s=.5,n,a=e,i=e){if(fn.test(t)&&(t=parseFloat(t),t=Ct(i.min,i.max,t/100)-i.min),typeof t!="number")return;let l=Ct(a.min,a.max,s);e===a&&(l-=t),e.min=wy(e.min,t,r,l,n),e.max=wy(e.max,t,r,l,n)}function by(e,t,[r,s,n],a,i){T6(e,t[r],t[s],t[n],t.scale,a,i)}const C6=["x","scaleX","originX"],A6=["y","scaleY","originY"];function _y(e,t,r,s){by(e.x,t,C6,r?r.x:void 0,s?s.x:void 0),by(e.y,t,A6,r?r.y:void 0,s?s.y:void 0)}function Sy(e){return e.translate===0&&e.scale===1}function vS(e){return Sy(e.x)&&Sy(e.y)}function ky(e,t){return e.min===t.min&&e.max===t.max}function F6(e,t){return ky(e.x,t.x)&&ky(e.y,t.y)}function Ny(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function yS(e,t){return Ny(e.x,t.x)&&Ny(e.y,t.y)}function Ey(e){return Mr(e.x)/Mr(e.y)}function jy(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class P6{constructor(){this.members=[]}add(t){Rp(this.members,t),t.scheduleRender()}remove(t){if(Ip(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(t){const r=this.members.findIndex(n=>t===n);if(r===0)return!1;let s;for(let n=r;n>=0;n--){const a=this.members[n];if(a.isPresent!==!1){s=a;break}}return s?(this.promote(s),!0):!1}promote(t,r){const s=this.lead;if(t!==s&&(this.prevLead=s,this.lead=t,t.show(),s)){s.instance&&s.scheduleRender(),t.scheduleRender(),t.resumeFrom=s,r&&(t.resumeFrom.preserveOpacity=!0),s.snapshot&&(t.snapshot=s.snapshot,t.snapshot.latestValues=s.animationValues||s.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:n}=t.options;n===!1&&s.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:r,resumingFrom:s}=t;r.onExitComplete&&r.onExitComplete(),s&&s.options.onExitComplete&&s.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function R6(e,t,r){let s="";const n=e.x.translate/t.x,a=e.y.translate/t.y,i=(r==null?void 0:r.z)||0;if((n||a||i)&&(s=`translate3d(${n}px, ${a}px, ${i}px) `),(t.x!==1||t.y!==1)&&(s+=`scale(${1/t.x}, ${1/t.y}) `),r){const{transformPerspective:u,rotate:d,rotateX:f,rotateY:h,skewX:m,skewY:x}=r;u&&(s=`perspective(${u}px) ${s}`),d&&(s+=`rotate(${d}deg) `),f&&(s+=`rotateX(${f}deg) `),h&&(s+=`rotateY(${h}deg) `),m&&(s+=`skewX(${m}deg) `),x&&(s+=`skewY(${x}deg) `)}const l=e.x.scale*t.x,c=e.y.scale*t.y;return(l!==1||c!==1)&&(s+=`scale(${l}, ${c})`),s||"none"}const hf=["","X","Y","Z"],I6=1e3;let O6=0;function mf(e,t,r,s){const{latestValues:n}=t;n[e]&&(r[e]=n[e],t.setStaticValue(e,0),s&&(s[e]=0))}function wS(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const r=aS(t);if(window.MotionHasOptimisedAnimation(r,"transform")){const{layout:n,layoutId:a}=e.options;window.MotionCancelOptimisedAnimation(r,"transform",St,!(n||a))}const{parent:s}=e;s&&!s.hasCheckedOptimisedAppear&&wS(s)}function bS({attachResizeListener:e,defaultParent:t,measureScroll:r,checkIsScrollRoot:s,resetTransform:n}){return class{constructor(i={},l=t==null?void 0:t()){this.id=O6++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(M6),this.nodes.forEach($6),this.nodes.forEach(V6),this.nodes.forEach(B6)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=i,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new _6)}addEventListener(i,l){return this.eventHandlers.has(i)||this.eventHandlers.set(i,new Lp),this.eventHandlers.get(i).add(l)}notifyListeners(i,...l){const c=this.eventHandlers.get(i);c&&c.notify(...l)}hasListeners(i){return this.eventHandlers.has(i)}mount(i){if(this.instance)return;this.isSVG=D_(i)&&!N3(i),this.instance=i;const{layoutId:l,layout:c,visualElement:u}=this.options;if(u&&!u.current&&u.mount(i),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(c||l)&&(this.isLayoutDirty=!0),e){let d,f=0;const h=()=>this.root.updateBlockedByResize=!1;St.read(()=>{f=window.innerWidth}),e(i,()=>{const m=window.innerWidth;m!==f&&(f=m,this.root.updateBlockedByResize=!0,d&&d(),d=S6(h,250),Vu.hasAnimatedSinceResize&&(Vu.hasAnimatedSinceResize=!1,this.nodes.forEach(Ay)))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&u&&(l||c)&&this.addEventListener("didUpdate",({delta:d,hasLayoutChanged:f,hasRelativeLayoutChanged:h,layout:m})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const x=this.options.transition||u.getDefaultTransition()||K6,{onLayoutAnimationStart:p,onLayoutAnimationComplete:g}=u.getProps(),w=!this.targetLayout||!yS(this.targetLayout,m),v=!f&&h;if(this.options.layoutRoot||this.resumeFrom||v||f&&(w||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const y={...Qp(x,"layout"),onPlay:p,onComplete:g};(u.shouldReduceMotion||this.options.layoutRoot)&&(y.delay=0,y.type=!1),this.startAnimation(y),this.setAnimationOrigin(d,v)}else f||Ay(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=m})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const i=this.getStack();i&&i.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),la(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(W6),this.animationId++)}getTransformTemplate(){const{visualElement:i}=this.options;return i&&i.getProps().transformTemplate}willUpdate(i=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&wS(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let d=0;d<this.path.length;d++){const f=this.path[d];f.shouldResetTransform=!0,f.updateScroll("snapshot"),f.options.layoutRoot&&f.willUpdate(!1)}const{layoutId:l,layout:c}=this.options;if(l===void 0&&!c)return;const u=this.getTransformTemplate();this.prevTransformTemplateValue=u?u(this.latestValues,""):void 0,this.updateSnapshot(),i&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(Ty);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(Cy);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(z6),this.nodes.forEach(D6),this.nodes.forEach(L6)):this.nodes.forEach(Cy),this.clearAllSnapshots();const l=Gr.now();fr.delta=Pn(0,1e3/60,l-fr.timestamp),fr.timestamp=l,fr.isProcessing=!0,tf.update.process(fr),tf.preRender.process(fr),tf.render.process(fr),fr.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,Jp.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(U6),this.sharedNodes.forEach(q6)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,St.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){St.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!Mr(this.snapshot.measuredBox.x)&&!Mr(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const i=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Ut(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:l}=this.options;l&&l.notify("LayoutMeasure",this.layout.layoutBox,i?i.layoutBox:void 0)}updateScroll(i="measure"){let l=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===i&&(l=!1),l&&this.instance){const c=s(this.instance);this.scroll={animationId:this.root.animationId,phase:i,isRoot:c,offset:r(this.instance),wasRoot:this.scroll?this.scroll.isRoot:c}}}resetTransform(){if(!n)return;const i=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,l=this.projectionDelta&&!vS(this.projectionDelta),c=this.getTransformTemplate(),u=c?c(this.latestValues,""):void 0,d=u!==this.prevTransformTemplateValue;i&&this.instance&&(l||Aa(this.latestValues)||d)&&(n(this.instance,u),this.shouldResetTransform=!1,this.scheduleRender())}measure(i=!0){const l=this.measurePageBox();let c=this.removeElementScroll(l);return i&&(c=this.removeTransform(c)),X6(c),{animationId:this.root.animationId,measuredBox:l,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){var u;const{visualElement:i}=this.options;if(!i)return Ut();const l=i.measureViewportBox();if(!(((u=this.scroll)==null?void 0:u.wasRoot)||this.path.some(Q6))){const{scroll:d}=this.root;d&&(Wi(l.x,d.offset.x),Wi(l.y,d.offset.y))}return l}removeElementScroll(i){var c;const l=Ut();if(gs(l,i),(c=this.scroll)!=null&&c.wasRoot)return l;for(let u=0;u<this.path.length;u++){const d=this.path[u],{scroll:f,options:h}=d;d!==this.root&&f&&h.layoutScroll&&(f.wasRoot&&gs(l,i),Wi(l.x,f.offset.x),Wi(l.y,f.offset.y))}return l}applyTransform(i,l=!1){const c=Ut();gs(c,i);for(let u=0;u<this.path.length;u++){const d=this.path[u];!l&&d.options.layoutScroll&&d.scroll&&d!==d.root&&qi(c,{x:-d.scroll.offset.x,y:-d.scroll.offset.y}),Aa(d.latestValues)&&qi(c,d.latestValues)}return Aa(this.latestValues)&&qi(c,this.latestValues),c}removeTransform(i){const l=Ut();gs(l,i);for(let c=0;c<this.path.length;c++){const u=this.path[c];if(!u.instance||!Aa(u.latestValues))continue;Qh(u.latestValues)&&u.updateSnapshot();const d=Ut(),f=u.measurePageBox();gs(d,f),_y(l,u.latestValues,u.snapshot?u.snapshot.layoutBox:void 0,d)}return Aa(this.latestValues)&&_y(l,this.latestValues),l}setTargetDelta(i){this.targetDelta=i,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(i){this.options={...this.options,...i,crossfade:i.crossfade!==void 0?i.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==fr.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(i=!1){var h;const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const c=!!this.resumingFrom||this!==l;if(!(i||c&&this.isSharedProjectionDirty||this.isProjectionDirty||(h=this.parent)!=null&&h.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:d,layoutId:f}=this.options;if(!(!this.layout||!(d||f))){if(this.resolvedRelativeTargetAt=fr.timestamp,!this.targetDelta&&!this.relativeTarget){const m=this.getClosestProjectingParent();m&&m.layout&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ut(),this.relativeTargetOrigin=Ut(),wl(this.relativeTargetOrigin,this.layout.layoutBox,m.layout.layoutBox),gs(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=Ut(),this.targetWithTransforms=Ut()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),r6(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):gs(this.target,this.layout.layoutBox),Z_(this.target,this.targetDelta)):gs(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const m=this.getClosestProjectingParent();m&&!!m.resumingFrom==!!this.resumingFrom&&!m.options.layoutScroll&&m.target&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ut(),this.relativeTargetOrigin=Ut(),wl(this.relativeTargetOrigin,this.target,m.target),gs(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||Qh(this.parent.latestValues)||J_(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var x;const i=this.getLead(),l=!!this.resumingFrom||this!==i;let c=!0;if((this.isProjectionDirty||(x=this.parent)!=null&&x.isProjectionDirty)&&(c=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),this.resolvedRelativeTargetAt===fr.timestamp&&(c=!1),c)return;const{layout:u,layoutId:d}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(u||d))return;gs(this.layoutCorrected,this.layout.layoutBox);const f=this.treeScale.x,h=this.treeScale.y;mA(this.layoutCorrected,this.treeScale,this.path,l),i.layout&&!i.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(i.target=i.layout.layoutBox,i.targetWithTransforms=Ut());const{target:m}=i;if(!m){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(yy(this.prevProjectionDelta.x,this.projectionDelta.x),yy(this.prevProjectionDelta.y,this.projectionDelta.y)),yl(this.projectionDelta,this.layoutCorrected,m,this.latestValues),(this.treeScale.x!==f||this.treeScale.y!==h||!jy(this.projectionDelta.x,this.prevProjectionDelta.x)||!jy(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",m))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(i=!0){var l;if((l=this.options.visualElement)==null||l.scheduleRender(),i){const c=this.getStack();c&&c.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Hi(),this.projectionDelta=Hi(),this.projectionDeltaWithTransform=Hi()}setAnimationOrigin(i,l=!1){const c=this.snapshot,u=c?c.latestValues:{},d={...this.latestValues},f=Hi();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!l;const h=Ut(),m=c?c.source:void 0,x=this.layout?this.layout.source:void 0,p=m!==x,g=this.getStack(),w=!g||g.members.length<=1,v=!!(p&&!w&&this.options.crossfade===!0&&!this.path.some(G6));this.animationProgress=0;let y;this.mixTargetDelta=b=>{const S=b/1e3;Fy(f.x,i.x,S),Fy(f.y,i.y,S),this.setTargetDelta(f),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(wl(h,this.layout.layoutBox,this.relativeParent.layout.layoutBox),H6(this.relativeTarget,this.relativeTargetOrigin,h,S),y&&F6(this.relativeTarget,y)&&(this.isProjectionDirty=!1),y||(y=Ut()),gs(y,this.relativeTarget)),p&&(this.animationValues=d,N6(d,u,this.latestValues,S,v,w)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=S},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(i){var l,c,u;this.notifyListeners("animationStart"),(l=this.currentAnimation)==null||l.stop(),(u=(c=this.resumingFrom)==null?void 0:c.currentAnimation)==null||u.stop(),this.pendingAnimation&&(la(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=St.update(()=>{Vu.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=po(0)),this.currentAnimation=w6(this.motionValue,[0,1e3],{...i,velocity:0,isSync:!0,onUpdate:d=>{this.mixTargetDelta(d),i.onUpdate&&i.onUpdate(d)},onStop:()=>{},onComplete:()=>{i.onComplete&&i.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const i=this.getStack();i&&i.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(I6),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const i=this.getLead();let{targetWithTransforms:l,target:c,layout:u,latestValues:d}=i;if(!(!l||!c||!u)){if(this!==i&&this.layout&&u&&_S(this.options.animationType,this.layout.layoutBox,u.layoutBox)){c=this.target||Ut();const f=Mr(this.layout.layoutBox.x);c.x.min=i.target.x.min,c.x.max=c.x.min+f;const h=Mr(this.layout.layoutBox.y);c.y.min=i.target.y.min,c.y.max=c.y.min+h}gs(l,c),qi(l,d),yl(this.projectionDeltaWithTransform,this.layoutCorrected,l,d)}}registerSharedNode(i,l){this.sharedNodes.has(i)||this.sharedNodes.set(i,new P6),this.sharedNodes.get(i).add(l);const u=l.options.initialPromotionConfig;l.promote({transition:u?u.transition:void 0,preserveFollowOpacity:u&&u.shouldPreserveFollowOpacity?u.shouldPreserveFollowOpacity(l):void 0})}isLead(){const i=this.getStack();return i?i.lead===this:!0}getLead(){var l;const{layoutId:i}=this.options;return i?((l=this.getStack())==null?void 0:l.lead)||this:this}getPrevLead(){var l;const{layoutId:i}=this.options;return i?(l=this.getStack())==null?void 0:l.prevLead:void 0}getStack(){const{layoutId:i}=this.options;if(i)return this.root.sharedNodes.get(i)}promote({needsReset:i,transition:l,preserveFollowOpacity:c}={}){const u=this.getStack();u&&u.promote(this,c),i&&(this.projectionDelta=void 0,this.needsReset=!0),l&&this.setOptions({transition:l})}relegate(){const i=this.getStack();return i?i.relegate(this):!1}resetSkewAndRotation(){const{visualElement:i}=this.options;if(!i)return;let l=!1;const{latestValues:c}=i;if((c.z||c.rotate||c.rotateX||c.rotateY||c.rotateZ||c.skewX||c.skewY)&&(l=!0),!l)return;const u={};c.z&&mf("z",i,u,this.animationValues);for(let d=0;d<hf.length;d++)mf(`rotate${hf[d]}`,i,u,this.animationValues),mf(`skew${hf[d]}`,i,u,this.animationValues);i.render();for(const d in u)i.setStaticValue(d,u[d]),this.animationValues&&(this.animationValues[d]=u[d]);i.scheduleRender()}applyProjectionStyles(i,l){if(!this.instance||this.isSVG)return;if(!this.isVisible){i.visibility="hidden";return}const c=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,i.visibility="",i.opacity="",i.pointerEvents=$u(l==null?void 0:l.pointerEvents)||"",i.transform=c?c(this.latestValues,""):"none";return}const u=this.getLead();if(!this.projectionDelta||!this.layout||!u.target){this.options.layoutId&&(i.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,i.pointerEvents=$u(l==null?void 0:l.pointerEvents)||""),this.hasProjected&&!Aa(this.latestValues)&&(i.transform=c?c({},""):"none",this.hasProjected=!1);return}i.visibility="";const d=u.animationValues||u.latestValues;this.applyTransformsToTarget();let f=R6(this.projectionDeltaWithTransform,this.treeScale,d);c&&(f=c(d,f)),i.transform=f;const{x:h,y:m}=this.projectionDelta;i.transformOrigin=`${h.origin*100}% ${m.origin*100}% 0`,u.animationValues?i.opacity=u===this?d.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:d.opacityExit:i.opacity=u===this?d.opacity!==void 0?d.opacity:"":d.opacityExit!==void 0?d.opacityExit:0;for(const x in Jl){if(d[x]===void 0)continue;const{correct:p,applyTo:g,isCSSVariable:w}=Jl[x],v=f==="none"?d[x]:p(d[x],u);if(g){const y=g.length;for(let b=0;b<y;b++)i[g[b]]=v}else w?this.options.visualElement.renderState.vars[x]=v:i[x]=v}this.options.layoutId&&(i.pointerEvents=u===this?$u(l==null?void 0:l.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(i=>{var l;return(l=i.currentAnimation)==null?void 0:l.stop()}),this.root.nodes.forEach(Ty),this.root.sharedNodes.clear()}}}function D6(e){e.updateLayout()}function L6(e){var r;const t=((r=e.resumeFrom)==null?void 0:r.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&t&&e.hasListeners("didUpdate")){const{layoutBox:s,measuredBox:n}=e.layout,{animationType:a}=e.options,i=t.source!==e.layout.source;a==="size"?_s(f=>{const h=i?t.measuredBox[f]:t.layoutBox[f],m=Mr(h);h.min=s[f].min,h.max=h.min+m}):_S(a,t.layoutBox,s)&&_s(f=>{const h=i?t.measuredBox[f]:t.layoutBox[f],m=Mr(s[f]);h.max=h.min+m,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[f].max=e.relativeTarget[f].min+m)});const l=Hi();yl(l,s,t.layoutBox);const c=Hi();i?yl(c,e.applyTransform(n,!0),t.measuredBox):yl(c,s,t.layoutBox);const u=!vS(l);let d=!1;if(!e.resumeFrom){const f=e.getClosestProjectingParent();if(f&&!f.resumeFrom){const{snapshot:h,layout:m}=f;if(h&&m){const x=Ut();wl(x,t.layoutBox,h.layoutBox);const p=Ut();wl(p,s,m.layoutBox),yS(x,p)||(d=!0),f.options.layoutRoot&&(e.relativeTarget=p,e.relativeTargetOrigin=x,e.relativeParent=f)}}}e.notifyListeners("didUpdate",{layout:s,snapshot:t,delta:c,layoutDelta:l,hasLayoutChanged:u,hasRelativeLayoutChanged:d})}else if(e.isLead()){const{onExitComplete:s}=e.options;s&&s()}e.options.transition=void 0}function M6(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function B6(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function U6(e){e.clearSnapshot()}function Ty(e){e.clearMeasurements()}function Cy(e){e.isLayoutDirty=!1}function z6(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function Ay(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function $6(e){e.resolveTargetDelta()}function V6(e){e.calcProjection()}function W6(e){e.resetSkewAndRotation()}function q6(e){e.removeLeadSnapshot()}function Fy(e,t,r){e.translate=Ct(t.translate,0,r),e.scale=Ct(t.scale,1,r),e.origin=t.origin,e.originPoint=t.originPoint}function Py(e,t,r,s){e.min=Ct(t.min,r.min,s),e.max=Ct(t.max,r.max,s)}function H6(e,t,r,s){Py(e.x,t.x,r.x,s),Py(e.y,t.y,r.y,s)}function G6(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const K6={duration:.45,ease:[.4,0,.1,1]},Ry=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),Iy=Ry("applewebkit/")&&!Ry("chrome/")?Math.round:Fs;function Oy(e){e.min=Iy(e.min),e.max=Iy(e.max)}function X6(e){Oy(e.x),Oy(e.y)}function _S(e,t,r){return e==="position"||e==="preserve-aspect"&&!t6(Ey(t),Ey(r),.2)}function Q6(e){var t;return e!==e.root&&((t=e.scroll)==null?void 0:t.wasRoot)}const Y6=bS({attachResizeListener:(e,t)=>Zl(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),pf={current:void 0},SS=bS({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!pf.current){const e=new Y6({});e.mount(window),e.setOptions({layoutScroll:!0}),pf.current=e}return pf.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),J6={pan:{Feature:x6},drag:{Feature:p6,ProjectionNode:SS,MeasureLayout:pS}};function Dy(e,t,r){const{props:s}=e;e.animationState&&s.whileHover&&e.animationState.setActive("whileHover",r==="Start");const n="onHover"+r,a=s[n];a&&St.postRender(()=>a(t,jc(t)))}class Z6 extends va{mount(){const{current:t}=this.node;t&&(this.unmount=w3(t,(r,s)=>(Dy(this.node,s,"Start"),n=>Dy(this.node,n,"End"))))}unmount(){}}class eF extends va{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=kc(Zl(this.node.current,"focus",()=>this.onFocus()),Zl(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function Ly(e,t,r){const{props:s}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&s.whileTap&&e.animationState.setActive("whileTap",r==="Start");const n="onTap"+(r==="End"?"":r),a=s[n];a&&St.postRender(()=>a(t,jc(t)))}class tF extends va{mount(){const{current:t}=this.node;t&&(this.unmount=k3(t,(r,s)=>(Ly(this.node,s,"Start"),(n,{success:a})=>Ly(this.node,n,a?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const sm=new WeakMap,xf=new WeakMap,rF=e=>{const t=sm.get(e.target);t&&t(e)},sF=e=>{e.forEach(rF)};function nF({root:e,...t}){const r=e||document;xf.has(r)||xf.set(r,{});const s=xf.get(r),n=JSON.stringify(t);return s[n]||(s[n]=new IntersectionObserver(sF,{root:e,...t})),s[n]}function aF(e,t,r){const s=nF(t);return sm.set(e,r),s.observe(e),()=>{sm.delete(e),s.unobserve(e)}}const iF={some:0,all:1};class oF extends va{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:r,margin:s,amount:n="some",once:a}=t,i={root:r?r.current:void 0,rootMargin:s,threshold:typeof n=="number"?n:iF[n]},l=c=>{const{isIntersecting:u}=c;if(this.isInView===u||(this.isInView=u,a&&!u&&this.hasEnteredView))return;u&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",u);const{onViewportEnter:d,onViewportLeave:f}=this.node.getProps(),h=u?d:f;h&&h(c)};return aF(this.node.current,i,l)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:r}=this.node;["amount","margin","root"].some(lF(t,r))&&this.startObserver()}unmount(){}}function lF({viewport:e={}},{viewport:t={}}={}){return r=>e[r]!==t[r]}const cF={inView:{Feature:oF},tap:{Feature:tF},focus:{Feature:eF},hover:{Feature:Z6}},uF={layout:{ProjectionNode:SS,MeasureLayout:pS}},dF={...XA,...cF,...J6,...uF},ec=dA(dF,kA);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var fF={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hF=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Ae=(e,t)=>{const r=j.forwardRef(({color:s="currentColor",size:n=24,strokeWidth:a=2,absoluteStrokeWidth:i,className:l="",children:c,...u},d)=>j.createElement("svg",{ref:d,...fF,width:n,height:n,stroke:s,strokeWidth:i?Number(a)*24/Number(n):a,className:["lucide",`lucide-${hF(e)}`,l].join(" "),...u},[...t.map(([f,h])=>j.createElement(f,h)),...Array.isArray(c)?c:[c]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const My=Ae("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Je=Ae("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _n=Ae("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tc=Ae("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wu=Ae("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const By=Ae("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mF=Ae("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pF=Ae("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xF=Ae("BookDashed",[["path",{d:"M20 22h-2",key:"1rpnb6"}],["path",{d:"M20 15v2h-2",key:"fph276"}],["path",{d:"M4 19.5V15",key:"6gr39e"}],["path",{d:"M20 8v3",key:"deu0bs"}],["path",{d:"M18 2h2v2",key:"180o53"}],["path",{d:"M4 11V9",key:"v3xsx8"}],["path",{d:"M12 2h2",key:"cvn524"}],["path",{d:"M12 22h2",key:"kn7ki6"}],["path",{d:"M12 17h2",key:"13u4lk"}],["path",{d:"M8 22H6.5a2.5 2.5 0 0 1 0-5H8",key:"fiseg2"}],["path",{d:"M4 5v-.5A2.5 2.5 0 0 1 6.5 2H8",key:"wywhs9"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gF=Ae("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const go=Ae("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kS=Ae("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nm=Ae("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yt=Ae("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uy=Ae("CheckSquare",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dx=Ae("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ri=Ae("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NS=Ae("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i0=Ae("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vF=Ae("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zy=Ae("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yF=Ae("ClipboardCheck",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wF=Ae("Clipboard",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o0=Ae("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bF=Ae("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ES=Ae("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Co=Ae("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _F=Ae("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SF=Ae("FileCheck",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kF=Ae("FileDown",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tr=Ae("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $y=Ae("FileUp",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"m15 15-3-3-3 3",key:"15xj92"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jS=Ae("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NF=Ae("Flame",[["path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z",key:"96xj49"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TS=Ae("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EF=Ae("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jF=Ae("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TF=Ae("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vo=Ae("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CF=Ae("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AF=Ae("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const am=Ae("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FF=Ae("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const js=Ae("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PF=Ae("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CS=Ae("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RF=Ae("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AS=Ae("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qu=Ae("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l0=Ae("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fx=Ae("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kr=Ae("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const im=Ae("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bd=Ae("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IF=Ae("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const om=Ae("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OF=Ae("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c0=Ae("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u0=Ae("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vy=Ae("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DF=Ae("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FS=Ae("Table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lm=Ae("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tc=Ae("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ao=Ae("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cm=Ae("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hx=Ae("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PS=Ae("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gf=Ae("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const to=Ae("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ps=Ae("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LF=Ae("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);var um=function(e,t){return um=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,s){r.__proto__=s}||function(r,s){for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(r[n]=s[n])},um(e,t)};function RS(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");um(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var _d=function(){return _d=Object.assign||function(t){for(var r,s=1,n=arguments.length;s<n;s++){r=arguments[s];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a])}return t},_d.apply(this,arguments)};function Fo(e,t){var r={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(r[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(e);n<s.length;n++)t.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(e,s[n])&&(r[s[n]]=e[s[n]]);return r}function IS(e,t,r,s){var n=arguments.length,a=n<3?t:s===null?s=Object.getOwnPropertyDescriptor(t,r):s,i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(e,t,r,s);else for(var l=e.length-1;l>=0;l--)(i=e[l])&&(a=(n<3?i(a):n>3?i(t,r,a):i(t,r))||a);return n>3&&a&&Object.defineProperty(t,r,a),a}function OS(e,t){return function(r,s){t(r,s,e)}}function DS(e,t,r,s,n,a){function i(w){if(w!==void 0&&typeof w!="function")throw new TypeError("Function expected");return w}for(var l=s.kind,c=l==="getter"?"get":l==="setter"?"set":"value",u=!t&&e?s.static?e:e.prototype:null,d=t||(u?Object.getOwnPropertyDescriptor(u,s.name):{}),f,h=!1,m=r.length-1;m>=0;m--){var x={};for(var p in s)x[p]=p==="access"?{}:s[p];for(var p in s.access)x.access[p]=s.access[p];x.addInitializer=function(w){if(h)throw new TypeError("Cannot add initializers after decoration has completed");a.push(i(w||null))};var g=(0,r[m])(l==="accessor"?{get:d.get,set:d.set}:d[c],x);if(l==="accessor"){if(g===void 0)continue;if(g===null||typeof g!="object")throw new TypeError("Object expected");(f=i(g.get))&&(d.get=f),(f=i(g.set))&&(d.set=f),(f=i(g.init))&&n.unshift(f)}else(f=i(g))&&(l==="field"?n.unshift(f):d[c]=f)}u&&Object.defineProperty(u,s.name,d),h=!0}function LS(e,t,r){for(var s=arguments.length>2,n=0;n<t.length;n++)r=s?t[n].call(e,r):t[n].call(e);return s?r:void 0}function MS(e){return typeof e=="symbol"?e:"".concat(e)}function BS(e,t,r){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function US(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function De(e,t,r,s){function n(a){return a instanceof r?a:new r(function(i){i(a)})}return new(r||(r=Promise))(function(a,i){function l(d){try{u(s.next(d))}catch(f){i(f)}}function c(d){try{u(s.throw(d))}catch(f){i(f)}}function u(d){d.done?a(d.value):n(d.value).then(l,c)}u((s=s.apply(e,t||[])).next())})}function zS(e,t){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},s,n,a,i=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function l(u){return function(d){return c([u,d])}}function c(u){if(s)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(r=0)),r;)try{if(s=1,n&&(a=u[0]&2?n.return:u[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,u[1])).done)return a;switch(n=0,a&&(u=[u[0]&2,a.value]),u[0]){case 0:case 1:a=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,n=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!a||u[1]>a[0]&&u[1]<a[3])){r.label=u[1];break}if(u[0]===6&&r.label<a[1]){r.label=a[1],a=u;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(u);break}a[2]&&r.ops.pop(),r.trys.pop();continue}u=t.call(e,r)}catch(d){u=[6,d],n=0}finally{s=a=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}var d0=Object.create?function(e,t,r,s){s===void 0&&(s=r);var n=Object.getOwnPropertyDescriptor(t,r);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,s,n)}:function(e,t,r,s){s===void 0&&(s=r),e[s]=t[r]};function $S(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&d0(t,e,r)}function Sd(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],s=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&s>=e.length&&(e=void 0),{value:e&&e[s++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function mx(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var s=r.call(e),n,a=[],i;try{for(;(t===void 0||t-- >0)&&!(n=s.next()).done;)a.push(n.value)}catch(l){i={error:l}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return a}function VS(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(mx(arguments[t]));return e}function WS(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var s=Array(e),n=0,t=0;t<r;t++)for(var a=arguments[t],i=0,l=a.length;i<l;i++,n++)s[n]=a[i];return s}function qS(e,t,r){if(r||arguments.length===2)for(var s=0,n=t.length,a;s<n;s++)(a||!(s in t))&&(a||(a=Array.prototype.slice.call(t,0,s)),a[s]=t[s]);return e.concat(a||Array.prototype.slice.call(t))}function yo(e){return this instanceof yo?(this.v=e,this):new yo(e)}function HS(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=r.apply(e,t||[]),n,a=[];return n=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),l("next"),l("throw"),l("return",i),n[Symbol.asyncIterator]=function(){return this},n;function i(m){return function(x){return Promise.resolve(x).then(m,f)}}function l(m,x){s[m]&&(n[m]=function(p){return new Promise(function(g,w){a.push([m,p,g,w])>1||c(m,p)})},x&&(n[m]=x(n[m])))}function c(m,x){try{u(s[m](x))}catch(p){h(a[0][3],p)}}function u(m){m.value instanceof yo?Promise.resolve(m.value.v).then(d,f):h(a[0][2],m)}function d(m){c("next",m)}function f(m){c("throw",m)}function h(m,x){m(x),a.shift(),a.length&&c(a[0][0],a[0][1])}}function GS(e){var t,r;return t={},s("next"),s("throw",function(n){throw n}),s("return"),t[Symbol.iterator]=function(){return this},t;function s(n,a){t[n]=e[n]?function(i){return(r=!r)?{value:yo(e[n](i)),done:!1}:a?a(i):i}:a}}function KS(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof Sd=="function"?Sd(e):e[Symbol.iterator](),r={},s("next"),s("throw"),s("return"),r[Symbol.asyncIterator]=function(){return this},r);function s(a){r[a]=e[a]&&function(i){return new Promise(function(l,c){i=e[a](i),n(l,c,i.done,i.value)})}}function n(a,i,l,c){Promise.resolve(c).then(function(u){a({value:u,done:l})},i)}}function XS(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var MF=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t},dm=function(e){return dm=Object.getOwnPropertyNames||function(t){var r=[];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(r[r.length]=s);return r},dm(e)};function QS(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r=dm(e),s=0;s<r.length;s++)r[s]!=="default"&&d0(t,e,r[s]);return MF(t,e),t}function YS(e){return e&&e.__esModule?e:{default:e}}function JS(e,t,r,s){if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?s:r==="a"?s.call(e):s?s.value:t.get(e)}function ZS(e,t,r,s,n){if(s==="m")throw new TypeError("Private method is not writable");if(s==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return s==="a"?n.call(e,r):n?n.value=r:t.set(e,r),r}function ek(e,t){if(t===null||typeof t!="object"&&typeof t!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof e=="function"?t===e:e.has(t)}function tk(e,t,r){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var s,n;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");s=t[Symbol.asyncDispose]}if(s===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");s=t[Symbol.dispose],r&&(n=s)}if(typeof s!="function")throw new TypeError("Object not disposable.");n&&(s=function(){try{n.call(this)}catch(a){return Promise.reject(a)}}),e.stack.push({value:t,dispose:s,async:r})}else r&&e.stack.push({async:!0});return t}var BF=typeof SuppressedError=="function"?SuppressedError:function(e,t,r){var s=new Error(r);return s.name="SuppressedError",s.error=e,s.suppressed=t,s};function rk(e){function t(a){e.error=e.hasError?new BF(a,e.error,"An error was suppressed during disposal."):a,e.hasError=!0}var r,s=0;function n(){for(;r=e.stack.pop();)try{if(!r.async&&s===1)return s=0,e.stack.push(r),Promise.resolve().then(n);if(r.dispose){var a=r.dispose.call(r.value);if(r.async)return s|=2,Promise.resolve(a).then(n,function(i){return t(i),n()})}else s|=1}catch(i){t(i)}if(s===1)return e.hasError?Promise.reject(e.error):Promise.resolve();if(e.hasError)throw e.error}return n()}function sk(e,t){return typeof e=="string"&&/^\.\.?\//.test(e)?e.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(r,s,n,a,i){return s?t?".jsx":".js":n&&(!a||!i)?r:n+a+"."+i.toLowerCase()+"js"}):e}const UF={__extends:RS,__assign:_d,__rest:Fo,__decorate:IS,__param:OS,__esDecorate:DS,__runInitializers:LS,__propKey:MS,__setFunctionName:BS,__metadata:US,__awaiter:De,__generator:zS,__createBinding:d0,__exportStar:$S,__values:Sd,__read:mx,__spread:VS,__spreadArrays:WS,__spreadArray:qS,__await:yo,__asyncGenerator:HS,__asyncDelegator:GS,__asyncValues:KS,__makeTemplateObject:XS,__importStar:QS,__importDefault:YS,__classPrivateFieldGet:JS,__classPrivateFieldSet:ZS,__classPrivateFieldIn:ek,__addDisposableResource:tk,__disposeResources:rk,__rewriteRelativeImportExtension:sk},zF=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:tk,get __assign(){return _d},__asyncDelegator:GS,__asyncGenerator:HS,__asyncValues:KS,__await:yo,__awaiter:De,__classPrivateFieldGet:JS,__classPrivateFieldIn:ek,__classPrivateFieldSet:ZS,__createBinding:d0,__decorate:IS,__disposeResources:rk,__esDecorate:DS,__exportStar:$S,__extends:RS,__generator:zS,__importDefault:YS,__importStar:QS,__makeTemplateObject:XS,__metadata:US,__param:OS,__propKey:MS,__read:mx,__rest:Fo,__rewriteRelativeImportExtension:sk,__runInitializers:LS,__setFunctionName:BS,__spread:VS,__spreadArray:qS,__spreadArrays:WS,__values:Sd,default:UF},Symbol.toStringTag,{value:"Module"})),$F=e=>e?(...t)=>e(...t):(...t)=>fetch(...t);class px extends Error{constructor(t,r="FunctionsError",s){super(t),this.name=r,this.context=s}}class VF extends px{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class Wy extends px{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class qy extends px{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var fm;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(fm||(fm={}));class WF{constructor(t,{headers:r={},customFetch:s,region:n=fm.Any}={}){this.url=t,this.headers=r,this.region=n,this.fetch=$F(s)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return De(this,arguments,void 0,function*(r,s={}){var n;let a,i;try{const{headers:l,method:c,body:u,signal:d,timeout:f}=s;let h={},{region:m}=s;m||(m=this.region);const x=new URL(`${this.url}/${r}`);m&&m!=="any"&&(h["x-region"]=m,x.searchParams.set("forceFunctionRegion",m));let p;u&&(l&&!Object.prototype.hasOwnProperty.call(l,"Content-Type")||!l)?typeof Blob<"u"&&u instanceof Blob||u instanceof ArrayBuffer?(h["Content-Type"]="application/octet-stream",p=u):typeof u=="string"?(h["Content-Type"]="text/plain",p=u):typeof FormData<"u"&&u instanceof FormData?p=u:(h["Content-Type"]="application/json",p=JSON.stringify(u)):p=u;let g=d;f&&(i=new AbortController,a=setTimeout(()=>i.abort(),f),d?(g=i.signal,d.addEventListener("abort",()=>i.abort())):g=i.signal);const w=yield this.fetch(x.toString(),{method:c||"POST",headers:Object.assign(Object.assign(Object.assign({},h),this.headers),l),body:p,signal:g}).catch(S=>{throw new VF(S)}),v=w.headers.get("x-relay-error");if(v&&v==="true")throw new Wy(w);if(!w.ok)throw new qy(w);let y=((n=w.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),b;return y==="application/json"?b=yield w.json():y==="application/octet-stream"||y==="application/pdf"?b=yield w.blob():y==="text/event-stream"?b=w:y==="multipart/form-data"?b=yield w.formData():b=yield w.text(),{data:b,error:null,response:w}}catch(l){return{data:null,error:l,response:l instanceof qy||l instanceof Wy?l.context:void 0}}finally{a&&clearTimeout(a)}})}}var Lr={};const Po=nj(zF);var lu={},cu={},uu={},du={},fu={},hu={},Hy;function nk(){if(Hy)return hu;Hy=1,Object.defineProperty(hu,"__esModule",{value:!0});class e extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}}return hu.default=e,hu}var Gy;function ak(){if(Gy)return fu;Gy=1,Object.defineProperty(fu,"__esModule",{value:!0});const t=Po.__importDefault(nk());class r{constructor(n){var a,i;this.shouldThrowOnError=!1,this.method=n.method,this.url=n.url,this.headers=new Headers(n.headers),this.schema=n.schema,this.body=n.body,this.shouldThrowOnError=(a=n.shouldThrowOnError)!==null&&a!==void 0?a:!1,this.signal=n.signal,this.isMaybeSingle=(i=n.isMaybeSingle)!==null&&i!==void 0?i:!1,n.fetch?this.fetch=n.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(n,a){return this.headers=new Headers(this.headers),this.headers.set(n,a),this}then(n,a){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const i=this.fetch;let l=i(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async c=>{var u,d,f,h;let m=null,x=null,p=null,g=c.status,w=c.statusText;if(c.ok){if(this.method!=="HEAD"){const S=await c.text();S===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((u=this.headers.get("Accept"))===null||u===void 0)&&u.includes("application/vnd.pgrst.plan+text"))?x=S:x=JSON.parse(S))}const y=(d=this.headers.get("Prefer"))===null||d===void 0?void 0:d.match(/count=(exact|planned|estimated)/),b=(f=c.headers.get("content-range"))===null||f===void 0?void 0:f.split("/");y&&b&&b.length>1&&(p=parseInt(b[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(x)&&(x.length>1?(m={code:"PGRST116",details:`Results contain ${x.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},x=null,p=null,g=406,w="Not Acceptable"):x.length===1?x=x[0]:x=null)}else{const y=await c.text();try{m=JSON.parse(y),Array.isArray(m)&&c.status===404&&(x=[],m=null,g=200,w="OK")}catch{c.status===404&&y===""?(g=204,w="No Content"):m={message:y}}if(m&&this.isMaybeSingle&&(!((h=m==null?void 0:m.details)===null||h===void 0)&&h.includes("0 rows"))&&(m=null,g=200,w="OK"),m&&this.shouldThrowOnError)throw new t.default(m)}return{error:m,data:x,count:p,status:g,statusText:w}});return this.shouldThrowOnError||(l=l.catch(c=>{var u,d,f,h,m,x;let p="";const g=c==null?void 0:c.cause;if(g){const w=(u=g==null?void 0:g.message)!==null&&u!==void 0?u:"",v=(d=g==null?void 0:g.code)!==null&&d!==void 0?d:"";p=`${(f=c==null?void 0:c.name)!==null&&f!==void 0?f:"FetchError"}: ${c==null?void 0:c.message}`,p+=`

Caused by: ${(h=g==null?void 0:g.name)!==null&&h!==void 0?h:"Error"}: ${w}`,v&&(p+=` (${v})`),g!=null&&g.stack&&(p+=`
${g.stack}`)}else p=(m=c==null?void 0:c.stack)!==null&&m!==void 0?m:"";return{error:{message:`${(x=c==null?void 0:c.name)!==null&&x!==void 0?x:"FetchError"}: ${c==null?void 0:c.message}`,details:p,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),l.then(n,a)}returns(){return this}overrideTypes(){return this}}return fu.default=r,fu}var Ky;function ik(){if(Ky)return du;Ky=1,Object.defineProperty(du,"__esModule",{value:!0});const t=Po.__importDefault(ak());class r extends t.default{select(n){let a=!1;const i=(n??"*").split("").map(l=>/\s/.test(l)&&!a?"":(l==='"'&&(a=!a),l)).join("");return this.url.searchParams.set("select",i),this.headers.append("Prefer","return=representation"),this}order(n,{ascending:a=!0,nullsFirst:i,foreignTable:l,referencedTable:c=l}={}){const u=c?`${c}.order`:"order",d=this.url.searchParams.get(u);return this.url.searchParams.set(u,`${d?`${d},`:""}${n}.${a?"asc":"desc"}${i===void 0?"":i?".nullsfirst":".nullslast"}`),this}limit(n,{foreignTable:a,referencedTable:i=a}={}){const l=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(l,`${n}`),this}range(n,a,{foreignTable:i,referencedTable:l=i}={}){const c=typeof l>"u"?"offset":`${l}.offset`,u=typeof l>"u"?"limit":`${l}.limit`;return this.url.searchParams.set(c,`${n}`),this.url.searchParams.set(u,`${a-n+1}`),this}abortSignal(n){return this.signal=n,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:n=!1,verbose:a=!1,settings:i=!1,buffers:l=!1,wal:c=!1,format:u="text"}={}){var d;const f=[n?"analyze":null,a?"verbose":null,i?"settings":null,l?"buffers":null,c?"wal":null].filter(Boolean).join("|"),h=(d=this.headers.get("Accept"))!==null&&d!==void 0?d:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${u}; for="${h}"; options=${f};`),u==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(n){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${n}`),this}}return du.default=r,du}var Xy;function xx(){if(Xy)return uu;Xy=1,Object.defineProperty(uu,"__esModule",{value:!0});const t=Po.__importDefault(ik()),r=new RegExp("[,()]");class s extends t.default{eq(a,i){return this.url.searchParams.append(a,`eq.${i}`),this}neq(a,i){return this.url.searchParams.append(a,`neq.${i}`),this}gt(a,i){return this.url.searchParams.append(a,`gt.${i}`),this}gte(a,i){return this.url.searchParams.append(a,`gte.${i}`),this}lt(a,i){return this.url.searchParams.append(a,`lt.${i}`),this}lte(a,i){return this.url.searchParams.append(a,`lte.${i}`),this}like(a,i){return this.url.searchParams.append(a,`like.${i}`),this}likeAllOf(a,i){return this.url.searchParams.append(a,`like(all).{${i.join(",")}}`),this}likeAnyOf(a,i){return this.url.searchParams.append(a,`like(any).{${i.join(",")}}`),this}ilike(a,i){return this.url.searchParams.append(a,`ilike.${i}`),this}ilikeAllOf(a,i){return this.url.searchParams.append(a,`ilike(all).{${i.join(",")}}`),this}ilikeAnyOf(a,i){return this.url.searchParams.append(a,`ilike(any).{${i.join(",")}}`),this}regexMatch(a,i){return this.url.searchParams.append(a,`match.${i}`),this}regexIMatch(a,i){return this.url.searchParams.append(a,`imatch.${i}`),this}is(a,i){return this.url.searchParams.append(a,`is.${i}`),this}isDistinct(a,i){return this.url.searchParams.append(a,`isdistinct.${i}`),this}in(a,i){const l=Array.from(new Set(i)).map(c=>typeof c=="string"&&r.test(c)?`"${c}"`:`${c}`).join(",");return this.url.searchParams.append(a,`in.(${l})`),this}contains(a,i){return typeof i=="string"?this.url.searchParams.append(a,`cs.${i}`):Array.isArray(i)?this.url.searchParams.append(a,`cs.{${i.join(",")}}`):this.url.searchParams.append(a,`cs.${JSON.stringify(i)}`),this}containedBy(a,i){return typeof i=="string"?this.url.searchParams.append(a,`cd.${i}`):Array.isArray(i)?this.url.searchParams.append(a,`cd.{${i.join(",")}}`):this.url.searchParams.append(a,`cd.${JSON.stringify(i)}`),this}rangeGt(a,i){return this.url.searchParams.append(a,`sr.${i}`),this}rangeGte(a,i){return this.url.searchParams.append(a,`nxl.${i}`),this}rangeLt(a,i){return this.url.searchParams.append(a,`sl.${i}`),this}rangeLte(a,i){return this.url.searchParams.append(a,`nxr.${i}`),this}rangeAdjacent(a,i){return this.url.searchParams.append(a,`adj.${i}`),this}overlaps(a,i){return typeof i=="string"?this.url.searchParams.append(a,`ov.${i}`):this.url.searchParams.append(a,`ov.{${i.join(",")}}`),this}textSearch(a,i,{config:l,type:c}={}){let u="";c==="plain"?u="pl":c==="phrase"?u="ph":c==="websearch"&&(u="w");const d=l===void 0?"":`(${l})`;return this.url.searchParams.append(a,`${u}fts${d}.${i}`),this}match(a){return Object.entries(a).forEach(([i,l])=>{this.url.searchParams.append(i,`eq.${l}`)}),this}not(a,i,l){return this.url.searchParams.append(a,`not.${i}.${l}`),this}or(a,{foreignTable:i,referencedTable:l=i}={}){const c=l?`${l}.or`:"or";return this.url.searchParams.append(c,`(${a})`),this}filter(a,i,l){return this.url.searchParams.append(a,`${i}.${l}`),this}}return uu.default=s,uu}var Qy;function ok(){if(Qy)return cu;Qy=1,Object.defineProperty(cu,"__esModule",{value:!0});const t=Po.__importDefault(xx());class r{constructor(n,{headers:a={},schema:i,fetch:l}){this.url=n,this.headers=new Headers(a),this.schema=i,this.fetch=l}select(n,a){const{head:i=!1,count:l}=a??{},c=i?"HEAD":"GET";let u=!1;const d=(n??"*").split("").map(f=>/\s/.test(f)&&!u?"":(f==='"'&&(u=!u),f)).join("");return this.url.searchParams.set("select",d),l&&this.headers.append("Prefer",`count=${l}`),new t.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(n,{count:a,defaultToNull:i=!0}={}){var l;const c="POST";if(a&&this.headers.append("Prefer",`count=${a}`),i||this.headers.append("Prefer","missing=default"),Array.isArray(n)){const u=n.reduce((d,f)=>d.concat(Object.keys(f)),[]);if(u.length>0){const d=[...new Set(u)].map(f=>`"${f}"`);this.url.searchParams.set("columns",d.join(","))}}return new t.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}upsert(n,{onConflict:a,ignoreDuplicates:i=!1,count:l,defaultToNull:c=!0}={}){var u;const d="POST";if(this.headers.append("Prefer",`resolution=${i?"ignore":"merge"}-duplicates`),a!==void 0&&this.url.searchParams.set("on_conflict",a),l&&this.headers.append("Prefer",`count=${l}`),c||this.headers.append("Prefer","missing=default"),Array.isArray(n)){const f=n.reduce((h,m)=>h.concat(Object.keys(m)),[]);if(f.length>0){const h=[...new Set(f)].map(m=>`"${m}"`);this.url.searchParams.set("columns",h.join(","))}}return new t.default({method:d,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:(u=this.fetch)!==null&&u!==void 0?u:fetch})}update(n,{count:a}={}){var i;const l="PATCH";return a&&this.headers.append("Prefer",`count=${a}`),new t.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}delete({count:n}={}){var a;const i="DELETE";return n&&this.headers.append("Prefer",`count=${n}`),new t.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}}return cu.default=r,cu}var Yy;function qF(){if(Yy)return lu;Yy=1,Object.defineProperty(lu,"__esModule",{value:!0});const e=Po,t=e.__importDefault(ok()),r=e.__importDefault(xx());class s{constructor(a,{headers:i={},schema:l,fetch:c}={}){this.url=a,this.headers=new Headers(i),this.schemaName=l,this.fetch=c}from(a){if(!a||typeof a!="string"||a.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");const i=new URL(`${this.url}/${a}`);return new t.default(i,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(a){return new s(this.url,{headers:this.headers,schema:a,fetch:this.fetch})}rpc(a,i={},{head:l=!1,get:c=!1,count:u}={}){var d;let f;const h=new URL(`${this.url}/rpc/${a}`);let m;l||c?(f=l?"HEAD":"GET",Object.entries(i).filter(([p,g])=>g!==void 0).map(([p,g])=>[p,Array.isArray(g)?`{${g.join(",")}}`:`${g}`]).forEach(([p,g])=>{h.searchParams.append(p,g)})):(f="POST",m=i);const x=new Headers(this.headers);return u&&x.set("Prefer",`count=${u}`),new r.default({method:f,url:h,headers:x,schema:this.schemaName,body:m,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}}return lu.default=s,lu}Object.defineProperty(Lr,"__esModule",{value:!0});var lk=Lr.PostgrestError=vk=Lr.PostgrestBuilder=xk=Lr.PostgrestTransformBuilder=mk=Lr.PostgrestFilterBuilder=fk=Lr.PostgrestQueryBuilder=uk=Lr.PostgrestClient=void 0;const Ro=Po,ck=Ro.__importDefault(qF());var uk=Lr.PostgrestClient=ck.default;const dk=Ro.__importDefault(ok());var fk=Lr.PostgrestQueryBuilder=dk.default;const hk=Ro.__importDefault(xx());var mk=Lr.PostgrestFilterBuilder=hk.default;const pk=Ro.__importDefault(ik());var xk=Lr.PostgrestTransformBuilder=pk.default;const gk=Ro.__importDefault(ak());var vk=Lr.PostgrestBuilder=gk.default;const yk=Ro.__importDefault(nk());lk=Lr.PostgrestError=yk.default;var wk=Lr.default={PostgrestClient:ck.default,PostgrestQueryBuilder:dk.default,PostgrestFilterBuilder:hk.default,PostgrestTransformBuilder:pk.default,PostgrestBuilder:gk.default,PostgrestError:yk.default};const HF=rj({__proto__:null,get PostgrestBuilder(){return vk},get PostgrestClient(){return uk},get PostgrestError(){return lk},get PostgrestFilterBuilder(){return mk},get PostgrestQueryBuilder(){return fk},get PostgrestTransformBuilder(){return xk},default:wk},[Lr]),{PostgrestClient:GF,PostgrestQueryBuilder:iW,PostgrestFilterBuilder:oW,PostgrestTransformBuilder:lW,PostgrestBuilder:cW,PostgrestError:uW}=wk||HF;class KF{constructor(){}static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const s=r.node,n=parseInt(s.replace(/^v/,"").split(".")[0]);return n>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${n} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${n} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const s=this.getWebSocketConstructor();return new s(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const XF="2.84.0",QF=`realtime-js/${XF}`,bk="1.0.0",YF="2.0.0",Jy=bk,hm=1e4,JF=1e3,ZF=100;var Pa;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(Pa||(Pa={}));var Jt;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Jt||(Jt={}));var Ws;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Ws||(Ws={}));var mm;(function(e){e.websocket="websocket"})(mm||(mm={}));var Ra;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Ra||(Ra={}));class eP{constructor(){this.HEADER_LENGTH=1,this.META_LENGTH=4,this.USER_BROADCAST_PUSH_META_LENGTH=5,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast"}encode(t,r){if(t.event===this.BROADCAST_EVENT&&!(t.payload instanceof ArrayBuffer)&&typeof t.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(t));let s=[t.join_ref,t.ref,t.topic,t.event,t.payload];return r(JSON.stringify(s))}_binaryEncodeUserBroadcastPush(t){var r;return this._isArrayBuffer((r=t.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(t):this._encodeJsonUserBroadcastPush(t)}_encodeBinaryUserBroadcastPush(t){var r,s,n,a;const i=t.topic,l=(r=t.ref)!==null&&r!==void 0?r:"",c=(s=t.join_ref)!==null&&s!==void 0?s:"",u=t.payload.event,d=(a=(n=t.payload)===null||n===void 0?void 0:n.payload)!==null&&a!==void 0?a:new ArrayBuffer(0),f=this.USER_BROADCAST_PUSH_META_LENGTH+c.length+l.length+i.length+u.length,h=new ArrayBuffer(this.HEADER_LENGTH+f);let m=new DataView(h),x=0;m.setUint8(x++,this.KINDS.userBroadcastPush),m.setUint8(x++,c.length),m.setUint8(x++,l.length),m.setUint8(x++,i.length),m.setUint8(x++,u.length),m.setUint8(x++,this.BINARY_ENCODING),Array.from(c,g=>m.setUint8(x++,g.charCodeAt(0))),Array.from(l,g=>m.setUint8(x++,g.charCodeAt(0))),Array.from(i,g=>m.setUint8(x++,g.charCodeAt(0))),Array.from(u,g=>m.setUint8(x++,g.charCodeAt(0)));var p=new Uint8Array(h.byteLength+d.byteLength);return p.set(new Uint8Array(h),0),p.set(new Uint8Array(d),h.byteLength),p.buffer}_encodeJsonUserBroadcastPush(t){var r,s,n,a;const i=t.topic,l=(r=t.ref)!==null&&r!==void 0?r:"",c=(s=t.join_ref)!==null&&s!==void 0?s:"",u=t.payload.event,d=(a=(n=t.payload)===null||n===void 0?void 0:n.payload)!==null&&a!==void 0?a:{},h=new TextEncoder().encode(JSON.stringify(d)).buffer,m=this.USER_BROADCAST_PUSH_META_LENGTH+c.length+l.length+i.length+u.length,x=new ArrayBuffer(this.HEADER_LENGTH+m);let p=new DataView(x),g=0;p.setUint8(g++,this.KINDS.userBroadcastPush),p.setUint8(g++,c.length),p.setUint8(g++,l.length),p.setUint8(g++,i.length),p.setUint8(g++,u.length),p.setUint8(g++,this.JSON_ENCODING),Array.from(c,v=>p.setUint8(g++,v.charCodeAt(0))),Array.from(l,v=>p.setUint8(g++,v.charCodeAt(0))),Array.from(i,v=>p.setUint8(g++,v.charCodeAt(0))),Array.from(u,v=>p.setUint8(g++,v.charCodeAt(0)));var w=new Uint8Array(x.byteLength+h.byteLength);return w.set(new Uint8Array(x),0),w.set(new Uint8Array(h),x.byteLength),w.buffer}decode(t,r){if(this._isArrayBuffer(t)){let s=this._binaryDecode(t);return r(s)}if(typeof t=="string"){const s=JSON.parse(t),[n,a,i,l,c]=s;return r({join_ref:n,ref:a,topic:i,event:l,payload:c})}return r({})}_binaryDecode(t){const r=new DataView(t),s=r.getUint8(0),n=new TextDecoder;switch(s){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(t,r,n)}}_decodeUserBroadcast(t,r,s){const n=r.getUint8(1),a=r.getUint8(2),i=r.getUint8(3),l=r.getUint8(4);let c=this.HEADER_LENGTH+4;const u=s.decode(t.slice(c,c+n));c=c+n;const d=s.decode(t.slice(c,c+a));c=c+a;const f=s.decode(t.slice(c,c+i));c=c+i;const h=t.slice(c,t.byteLength),m=l===this.JSON_ENCODING?JSON.parse(s.decode(h)):h,x={type:this.BROADCAST_EVENT,event:d,payload:m};return i>0&&(x.meta=JSON.parse(f)),{join_ref:null,ref:null,topic:u,event:this.BROADCAST_EVENT,payload:x}}_isArrayBuffer(t){var r;return t instanceof ArrayBuffer||((r=t==null?void 0:t.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}}class _k{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var ht;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(ht||(ht={}));const Zy=(e,t,r={})=>{var s;const n=(s=r.skipTypes)!==null&&s!==void 0?s:[];return t?Object.keys(t).reduce((a,i)=>(a[i]=tP(i,e,t,n),a),{}):{}},tP=(e,t,r,s)=>{const n=t.find(l=>l.name===e),a=n==null?void 0:n.type,i=r[e];return a&&!s.includes(a)?Sk(a,i):pm(i)},Sk=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return aP(t,r)}switch(e){case ht.bool:return rP(t);case ht.float4:case ht.float8:case ht.int2:case ht.int4:case ht.int8:case ht.numeric:case ht.oid:return sP(t);case ht.json:case ht.jsonb:return nP(t);case ht.timestamp:return iP(t);case ht.abstime:case ht.date:case ht.daterange:case ht.int4range:case ht.int8range:case ht.money:case ht.reltime:case ht.text:case ht.time:case ht.timestamptz:case ht.timetz:case ht.tsrange:case ht.tstzrange:return pm(t);default:return pm(t)}},pm=e=>e,rP=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},sP=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},nP=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},aP=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,s=e[r];if(e[0]==="{"&&s==="}"){let a;const i=e.slice(1,r);try{a=JSON.parse("["+i+"]")}catch{a=i?i.split(","):[]}return a.map(l=>Sk(t,l))}return e},iP=e=>typeof e=="string"?e.replace(" ","T"):e,kk=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class vf{constructor(t,r,s={},n=hm){this.channel=t,this.event=r,this.payload=s,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var s;return this._hasReceived(t)&&r((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(s=>s.status===t).forEach(s=>s.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var e1;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(e1||(e1={}));class bl{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},n=>{const{onJoin:a,onLeave:i,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=bl.syncState(this.state,n,a,i),this.pendingDiffs.forEach(c=>{this.state=bl.syncDiff(this.state,c,a,i)}),this.pendingDiffs=[],l()}),this.channel._on(s.diff,{},n=>{const{onJoin:a,onLeave:i,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=bl.syncDiff(this.state,n,a,i),l())}),this.onJoin((n,a,i)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:a,newPresences:i})}),this.onLeave((n,a,i)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:a,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,s,n){const a=this.cloneDeep(t),i=this.transformState(r),l={},c={};return this.map(a,(u,d)=>{i[u]||(c[u]=d)}),this.map(i,(u,d)=>{const f=a[u];if(f){const h=d.map(g=>g.presence_ref),m=f.map(g=>g.presence_ref),x=d.filter(g=>m.indexOf(g.presence_ref)<0),p=f.filter(g=>h.indexOf(g.presence_ref)<0);x.length>0&&(l[u]=x),p.length>0&&(c[u]=p)}else l[u]=d}),this.syncDiff(a,{joins:l,leaves:c},s,n)}static syncDiff(t,r,s,n){const{joins:a,leaves:i}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return s||(s=()=>{}),n||(n=()=>{}),this.map(a,(l,c)=>{var u;const d=(u=t[l])!==null&&u!==void 0?u:[];if(t[l]=this.cloneDeep(c),d.length>0){const f=t[l].map(m=>m.presence_ref),h=d.filter(m=>f.indexOf(m.presence_ref)<0);t[l].unshift(...h)}s(l,d,c)}),this.map(i,(l,c)=>{let u=t[l];if(!u)return;const d=c.map(f=>f.presence_ref);u=u.filter(f=>d.indexOf(f.presence_ref)<0),t[l]=u,n(l,u,c),u.length===0&&delete t[l]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(s=>r(s,t[s]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,s)=>{const n=t[s];return"metas"in n?r[s]=n.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):r[s]=n,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var t1;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(t1||(t1={}));var _l;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(_l||(_l={}));var vn;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(vn||(vn={}));class gx{constructor(t,r={config:{}},s){var n,a;if(this.topic=t,this.params=r,this.socket=s,this.bindings={},this.state=Jt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new vf(this,Ws.join,this.params,this.timeout),this.rejoinTimer=new _k(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Jt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Jt.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=Jt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Jt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=Jt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Ws.reply,{},(i,l)=>{this._trigger(this._replyEventName(l),i)}),this.presence=new bl(this),this.broadcastEndpointURL=kk(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((a=(n=this.params.config)===null||n===void 0?void 0:n.broadcast)===null||a===void 0)&&a.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var s,n,a;if(this.socket.isConnected()||this.socket.connect(),this.state==Jt.closed){const{config:{broadcast:i,presence:l,private:c}}=this.params,u=(n=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(m=>m.filter))!==null&&n!==void 0?n:[],d=!!this.bindings[_l.PRESENCE]&&this.bindings[_l.PRESENCE].length>0||((a=this.params.config.presence)===null||a===void 0?void 0:a.enabled)===!0,f={},h={broadcast:i,presence:Object.assign(Object.assign({},l),{enabled:d}),postgres_changes:u,private:c};this.socket.accessTokenValue&&(f.access_token=this.socket.accessTokenValue),this._onError(m=>t==null?void 0:t(vn.CHANNEL_ERROR,m)),this._onClose(()=>t==null?void 0:t(vn.CLOSED)),this.updateJoinPayload(Object.assign({config:h},f)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:m})=>{var x;if(this.socket.setAuth(),m===void 0){t==null||t(vn.SUBSCRIBED);return}else{const p=this.bindings.postgres_changes,g=(x=p==null?void 0:p.length)!==null&&x!==void 0?x:0,w=[];for(let v=0;v<g;v++){const y=p[v],{filter:{event:b,schema:S,table:_,filter:k}}=y,E=m&&m[v];if(E&&E.event===b&&E.schema===S&&E.table===_&&E.filter===k)w.push(Object.assign(Object.assign({},y),{id:E.id}));else{this.unsubscribe(),this.state=Jt.errored,t==null||t(vn.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=w,t&&t(vn.SUBSCRIBED);return}}).receive("error",m=>{this.state=Jt.errored,t==null||t(vn.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(m).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(vn.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,s){return this.state===Jt.joined&&t===_l.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,r,s)}async httpSend(t,r,s={}){var n;const a=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(r==null)return Promise.reject("Payload is required for httpSend()");const i={method:"POST",headers:{Authorization:a,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:r,private:this.private}]})},l=await this._fetchWithTimeout(this.broadcastEndpointURL,i,(n=s.timeout)!==null&&n!==void 0?n:this.timeout);if(l.status===202)return{success:!0};let c=l.statusText;try{const u=await l.json();c=u.error||u.message||c}catch{}return Promise.reject(new Error(c))}async send(t,r={}){var s,n;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:a,payload:i}=t,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:i,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(s=r.timeout)!==null&&s!==void 0?s:this.timeout);return await((n=u.body)===null||n===void 0?void 0:n.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(a=>{var i,l,c;const u=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((c=(l=(i=this.params)===null||i===void 0?void 0:i.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&a("ok"),u.receive("ok",()=>a("ok")),u.receive("error",()=>a("error")),u.receive("timeout",()=>a("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Jt.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Ws.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(n=>{s=new vf(this,Ws.leave,{},t),s.receive("ok",()=>{r(),n("ok")}).receive("timeout",()=>{r(),n("timed out")}).receive("error",()=>{n("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s==null||s.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Jt.closed,this.bindings={}}async _fetchWithTimeout(t,r,s){const n=new AbortController,a=setTimeout(()=>n.abort(),s),i=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:n.signal}));return clearTimeout(a),i}_push(t,r,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new vf(this,t,r,s);return this._canPush()?n.send():this._addToPushBuffer(n),n}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>ZF){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,s){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,s){var n,a;const i=t.toLocaleLowerCase(),{close:l,error:c,leave:u,join:d}=Ws;if(s&&[l,c,u,d].indexOf(i)>=0&&s!==this._joinRef())return;let h=this._onMessage(i,r,s);if(r&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(m=>{var x,p,g;return((x=m.filter)===null||x===void 0?void 0:x.event)==="*"||((g=(p=m.filter)===null||p===void 0?void 0:p.event)===null||g===void 0?void 0:g.toLocaleLowerCase())===i}).map(m=>m.callback(h,s)):(a=this.bindings[i])===null||a===void 0||a.filter(m=>{var x,p,g,w,v,y;if(["broadcast","presence","postgres_changes"].includes(i))if("id"in m){const b=m.id,S=(x=m.filter)===null||x===void 0?void 0:x.event;return b&&((p=r.ids)===null||p===void 0?void 0:p.includes(b))&&(S==="*"||(S==null?void 0:S.toLocaleLowerCase())===((g=r.data)===null||g===void 0?void 0:g.type.toLocaleLowerCase()))}else{const b=(v=(w=m==null?void 0:m.filter)===null||w===void 0?void 0:w.event)===null||v===void 0?void 0:v.toLocaleLowerCase();return b==="*"||b===((y=r==null?void 0:r.event)===null||y===void 0?void 0:y.toLocaleLowerCase())}else return m.type.toLocaleLowerCase()===i}).map(m=>{if(typeof h=="object"&&"ids"in h){const x=h.data,{schema:p,table:g,commit_timestamp:w,type:v,errors:y}=x;h=Object.assign(Object.assign({},{schema:p,table:g,commit_timestamp:w,eventType:v,new:{},old:{},errors:y}),this._getPayloadRecords(x))}m.callback(h,s)})}_isClosed(){return this.state===Jt.closed}_isJoined(){return this.state===Jt.joined}_isJoining(){return this.state===Jt.joining}_isLeaving(){return this.state===Jt.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,s){const n=t.toLocaleLowerCase(),a={type:n,filter:r,callback:s};return this.bindings[n]?this.bindings[n].push(a):this.bindings[n]=[a],this}_off(t,r){const s=t.toLocaleLowerCase();return this.bindings[s]&&(this.bindings[s]=this.bindings[s].filter(n=>{var a;return!(((a=n.type)===null||a===void 0?void 0:a.toLocaleLowerCase())===s&&gx.isEqual(n.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const s in t)if(t[s]!==r[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Ws.close,{},t)}_onError(t){this._on(Ws.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Jt.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=Zy(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=Zy(t.columns,t.old_record)),r}}const yf=()=>{},mu={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},oP=[1e3,2e3,5e3,1e4],lP=1e4,cP=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class uP{constructor(t,r){var s;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=hm,this.transport=null,this.heartbeatIntervalMs=mu.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=yf,this.ref=0,this.reconnectTimer=null,this.vsn=Jy,this.logger=yf,this.conn=null,this.sendBuffer=[],this.serializer=new eP,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=n=>n?(...a)=>n(...a):(...a)=>fetch(...a),!(!((s=r==null?void 0:r.params)===null||s===void 0)&&s.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${mm.websocket}`,this.httpEndpoint=kk(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=KF.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const s=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(s),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(t?this.conn.close(t,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,s){this.logger(t,r,s)}connectionState(){switch(this.conn&&this.conn.readyState){case Pa.connecting:return Ra.Connecting;case Pa.open:return Ra.Open;case Pa.closing:return Ra.Closing;default:return Ra.Closed}}isConnected(){return this.connectionState()===Ra.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const s=`realtime:${t}`,n=this.getChannels().find(a=>a.topic===s);if(n)return n;{const a=new gx(`realtime:${t}`,r,this);return this.channels.push(a),a}}push(t){const{topic:r,event:s,payload:n,ref:a}=t,i=()=>{this.encode(t,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${r} ${s} (${a})`,n),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(JF,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},mu.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(s=>s.topic===t&&(s._isJoined()||s._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(u){this.log("error","error in heartbeat callback",u)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:s,event:n,payload:a,ref:i}=r,l=i?`(${i})`:"",c=a.status||"";this.log("receive",`${c} ${s} ${n} ${l}`.trim(),a),this.channels.filter(u=>u._isMember(s)).forEach(u=>u._trigger(n,a,i)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){if(this.conn){if(this.conn.readyState===Pa.open||this.conn.readyState===Pa.connecting)try{this.conn.close()}catch(t){this.log("error","Error closing connection",t)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(Ws.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const s=t.match(/\?/)?"&":"?",n=new URLSearchParams(r);return`${t}${s}${n}`}_workerObjectUrl(t){let r;if(t)r=t;else{const s=new Blob([cP],{type:"application/javascript"});r=URL.createObjectURL(s)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r;t?r=t:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(s=>{const n={access_token:r,version:QF};r&&s.updateJoinPayload(n),s.joinedOnce&&s._isJoined()&&s._push(Ws.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(s=>{try{s(r)}catch(n){this.log("error",`error in ${t} callback`,n)}})}catch(s){this.log("error",`error triggering ${t} callbacks`,s)}}_setupReconnectionTimer(){this.reconnectTimer=new _k(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},mu.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,s,n,a,i,l,c,u,d,f,h,m;switch(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(s=t==null?void 0:t.timeout)!==null&&s!==void 0?s:hm,this.heartbeatIntervalMs=(n=t==null?void 0:t.heartbeatIntervalMs)!==null&&n!==void 0?n:mu.HEARTBEAT_INTERVAL,this.worker=(a=t==null?void 0:t.worker)!==null&&a!==void 0?a:!1,this.accessToken=(i=t==null?void 0:t.accessToken)!==null&&i!==void 0?i:null,this.heartbeatCallback=(l=t==null?void 0:t.heartbeatCallback)!==null&&l!==void 0?l:yf,this.vsn=(c=t==null?void 0:t.vsn)!==null&&c!==void 0?c:Jy,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(u=t==null?void 0:t.reconnectAfterMs)!==null&&u!==void 0?u:x=>oP[x-1]||lP,this.vsn){case bk:this.encode=(d=t==null?void 0:t.encode)!==null&&d!==void 0?d:(x,p)=>p(JSON.stringify(x)),this.decode=(f=t==null?void 0:t.decode)!==null&&f!==void 0?f:(x,p)=>p(JSON.parse(x));break;case YF:this.encode=(h=t==null?void 0:t.encode)!==null&&h!==void 0?h:this.serializer.encode.bind(this.serializer),this.decode=(m=t==null?void 0:t.decode)!==null&&m!==void 0?m:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}class vx extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function jt(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class dP extends vx{constructor(t,r,s){super(t),this.name="StorageApiError",this.status=r,this.statusCode=s}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class xm extends vx{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}const yx=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),fP=()=>Response,gm=e=>{if(Array.isArray(e))return e.map(r=>gm(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,s])=>{const n=r.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""));t[n]=gm(s)}),t},hP=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},wf=e=>{var t;return e.msg||e.message||e.error_description||(typeof e.error=="string"?e.error:(t=e.error)===null||t===void 0?void 0:t.message)||JSON.stringify(e)},mP=(e,t,r)=>De(void 0,void 0,void 0,function*(){const s=yield fP();e instanceof s&&!(r!=null&&r.noResolveJson)?e.json().then(n=>{const a=e.status||500,i=(n==null?void 0:n.statusCode)||a+"";t(new dP(wf(n),a,i))}).catch(n=>{t(new xm(wf(n),n))}):t(new xm(wf(e),e))}),pP=(e,t,r,s)=>{const n={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||!s?n:(hP(s)?(n.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),n.body=JSON.stringify(s)):n.body=s,t!=null&&t.duplex&&(n.duplex=t.duplex),Object.assign(Object.assign({},n),r))};function Cc(e,t,r,s,n,a){return De(this,void 0,void 0,function*(){return new Promise((i,l)=>{e(r,pP(t,s,n,a)).then(c=>{if(!c.ok)throw c;return s!=null&&s.noResolveJson?c:c.json()}).then(c=>i(c)).catch(c=>mP(c,l,s))})})}function rc(e,t,r,s){return De(this,void 0,void 0,function*(){return Cc(e,"GET",t,r,s)})}function $s(e,t,r,s,n){return De(this,void 0,void 0,function*(){return Cc(e,"POST",t,s,n,r)})}function vm(e,t,r,s,n){return De(this,void 0,void 0,function*(){return Cc(e,"PUT",t,s,n,r)})}function xP(e,t,r,s){return De(this,void 0,void 0,function*(){return Cc(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),s)})}function wx(e,t,r,s,n){return De(this,void 0,void 0,function*(){return Cc(e,"DELETE",t,s,n,r)})}class gP{constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r}then(t,r){return this.execute().then(t,r)}execute(){return De(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(jt(t))return{data:null,error:t};throw t}})}}var Nk;class vP{constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r,this[Nk]="BlobDownloadBuilder",this.promise=null}asStream(){return new gP(this.downloadFn,this.shouldThrowOnError)}then(t,r){return this.getPromise().then(t,r)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return De(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(jt(t))return{data:null,error:t};throw t}})}}Nk=Symbol.toStringTag;const yP={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},r1={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class wP{constructor(t,r={},s,n){this.shouldThrowOnError=!1,this.url=t,this.headers=r,this.bucketId=s,this.fetch=yx(n)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(t,r,s,n){return De(this,void 0,void 0,function*(){try{let a;const i=Object.assign(Object.assign({},r1),n);let l=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(i.upsert)});const c=i.metadata;typeof Blob<"u"&&s instanceof Blob?(a=new FormData,a.append("cacheControl",i.cacheControl),c&&a.append("metadata",this.encodeMetadata(c)),a.append("",s)):typeof FormData<"u"&&s instanceof FormData?(a=s,a.has("cacheControl")||a.append("cacheControl",i.cacheControl),c&&!a.has("metadata")&&a.append("metadata",this.encodeMetadata(c))):(a=s,l["cache-control"]=`max-age=${i.cacheControl}`,l["content-type"]=i.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c))),(typeof ReadableStream<"u"&&a instanceof ReadableStream||a&&typeof a=="object"&&"pipe"in a&&typeof a.pipe=="function")&&!i.duplex&&(i.duplex="half")),n!=null&&n.headers&&(l=Object.assign(Object.assign({},l),n.headers));const u=this._removeEmptyFolders(r),d=this._getFinalPath(u),f=yield(t=="PUT"?vm:$s)(this.fetch,`${this.url}/object/${d}`,a,Object.assign({headers:l},i!=null&&i.duplex?{duplex:i.duplex}:{}));return{data:{path:u,id:f.Id,fullPath:f.Key},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(jt(a))return{data:null,error:a};throw a}})}upload(t,r,s){return De(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,s)})}uploadToSignedUrl(t,r,s,n){return De(this,void 0,void 0,function*(){const a=this._removeEmptyFolders(t),i=this._getFinalPath(a),l=new URL(this.url+`/object/upload/sign/${i}`);l.searchParams.set("token",r);try{let c;const u=Object.assign({upsert:r1.upsert},n),d=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&s instanceof Blob?(c=new FormData,c.append("cacheControl",u.cacheControl),c.append("",s)):typeof FormData<"u"&&s instanceof FormData?(c=s,c.append("cacheControl",u.cacheControl)):(c=s,d["cache-control"]=`max-age=${u.cacheControl}`,d["content-type"]=u.contentType);const f=yield vm(this.fetch,l.toString(),c,{headers:d});return{data:{path:a,fullPath:f.Key},error:null}}catch(c){if(this.shouldThrowOnError)throw c;if(jt(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(t,r){return De(this,void 0,void 0,function*(){try{let s=this._getFinalPath(t);const n=Object.assign({},this.headers);r!=null&&r.upsert&&(n["x-upsert"]="true");const a=yield $s(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:n}),i=new URL(this.url+a.url),l=i.searchParams.get("token");if(!l)throw new vx("No token returned by API");return{data:{signedUrl:i.toString(),path:t,token:l},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(jt(s))return{data:null,error:s};throw s}})}update(t,r,s){return De(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,s)})}move(t,r,s){return De(this,void 0,void 0,function*(){try{return{data:yield $s(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(jt(n))return{data:null,error:n};throw n}})}copy(t,r,s){return De(this,void 0,void 0,function*(){try{return{data:{path:(yield $s(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers})).Key},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(jt(n))return{data:null,error:n};throw n}})}createSignedUrl(t,r,s){return De(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t),a=yield $s(this.fetch,`${this.url}/object/sign/${n}`,Object.assign({expiresIn:r},s!=null&&s.transform?{transform:s.transform}:{}),{headers:this.headers});const i=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return a={signedUrl:encodeURI(`${this.url}${a.signedURL}${i}`)},{data:a,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(jt(n))return{data:null,error:n};throw n}})}createSignedUrls(t,r,s){return De(this,void 0,void 0,function*(){try{const n=yield $s(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),a=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return{data:n.map(i=>Object.assign(Object.assign({},i),{signedUrl:i.signedURL?encodeURI(`${this.url}${i.signedURL}${a}`):null})),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(jt(n))return{data:null,error:n};throw n}})}download(t,r){const n=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",a=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),i=a?`?${a}`:"",l=this._getFinalPath(t),c=()=>rc(this.fetch,`${this.url}/${n}/${l}${i}`,{headers:this.headers,noResolveJson:!0});return new vP(c,this.shouldThrowOnError)}info(t){return De(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const s=yield rc(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:gm(s),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(jt(s))return{data:null,error:s};throw s}})}exists(t){return De(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield xP(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(jt(s)&&s instanceof xm){const n=s.originalError;if([400,404].includes(n==null?void 0:n.status))return{data:!1,error:s}}throw s}})}getPublicUrl(t,r){const s=this._getFinalPath(t),n=[],a=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";a!==""&&n.push(a);const l=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});c!==""&&n.push(c);let u=n.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${s}${u}`)}}}remove(t){return De(this,void 0,void 0,function*(){try{return{data:yield wx(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(jt(r))return{data:null,error:r};throw r}})}list(t,r,s){return De(this,void 0,void 0,function*(){try{const n=Object.assign(Object.assign(Object.assign({},yP),r),{prefix:t||""});return{data:yield $s(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},s),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(jt(n))return{data:null,error:n};throw n}})}listV2(t,r){return De(this,void 0,void 0,function*(){try{const s=Object.assign({},t);return{data:yield $s(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,s,{headers:this.headers},r),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(jt(s))return{data:null,error:s};throw s}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const Ek="2.84.0",jk={"X-Client-Info":`storage-js/${Ek}`};class bP{constructor(t,r={},s,n){this.shouldThrowOnError=!1;const a=new URL(t);n!=null&&n.useNewHostname&&/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase.")),this.url=a.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},jk),r),this.fetch=yx(s)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(t){return De(this,void 0,void 0,function*(){try{const r=this.listBucketOptionsToQueryString(t);return{data:yield rc(this.fetch,`${this.url}/bucket${r}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(jt(r))return{data:null,error:r};throw r}})}getBucket(t){return De(this,void 0,void 0,function*(){try{return{data:yield rc(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(jt(r))return{data:null,error:r};throw r}})}createBucket(t){return De(this,arguments,void 0,function*(r,s={public:!1}){try{return{data:yield $s(this.fetch,`${this.url}/bucket`,{id:r,name:r,type:s.type,public:s.public,file_size_limit:s.fileSizeLimit,allowed_mime_types:s.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(jt(n))return{data:null,error:n};throw n}})}updateBucket(t,r){return De(this,void 0,void 0,function*(){try{return{data:yield vm(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(jt(s))return{data:null,error:s};throw s}})}emptyBucket(t){return De(this,void 0,void 0,function*(){try{return{data:yield $s(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(jt(r))return{data:null,error:r};throw r}})}deleteBucket(t){return De(this,void 0,void 0,function*(){try{return{data:yield wx(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(jt(r))return{data:null,error:r};throw r}})}listBucketOptionsToQueryString(t){const r={};return t&&("limit"in t&&(r.limit=String(t.limit)),"offset"in t&&(r.offset=String(t.offset)),t.search&&(r.search=t.search),t.sortColumn&&(r.sortColumn=t.sortColumn),t.sortOrder&&(r.sortOrder=t.sortOrder)),Object.keys(r).length>0?"?"+new URLSearchParams(r).toString():""}}class _P{constructor(t,r={},s){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},jk),r),this.fetch=yx(s)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return De(this,void 0,void 0,function*(){try{return{data:yield $s(this.fetch,`${this.url}/bucket`,{name:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(jt(r))return{data:null,error:r};throw r}})}listBuckets(t){return De(this,void 0,void 0,function*(){try{const r=new URLSearchParams;(t==null?void 0:t.limit)!==void 0&&r.set("limit",t.limit.toString()),(t==null?void 0:t.offset)!==void 0&&r.set("offset",t.offset.toString()),t!=null&&t.sortColumn&&r.set("sortColumn",t.sortColumn),t!=null&&t.sortOrder&&r.set("sortOrder",t.sortOrder),t!=null&&t.search&&r.set("search",t.search);const s=r.toString(),n=s?`${this.url}/bucket?${s}`:`${this.url}/bucket`;return{data:yield rc(this.fetch,n,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(jt(r))return{data:null,error:r};throw r}})}deleteBucket(t){return De(this,void 0,void 0,function*(){try{return{data:yield wx(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(jt(r))return{data:null,error:r};throw r}})}}const bx={"X-Client-Info":`storage-js/${Ek}`,"Content-Type":"application/json"};class Tk extends Error{constructor(t){super(t),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function as(e){return typeof e=="object"&&e!==null&&"__isStorageVectorsError"in e}class bf extends Tk{constructor(t,r,s){super(t),this.name="StorageVectorsApiError",this.status=r,this.statusCode=s}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class SP extends Tk{constructor(t,r){super(t),this.name="StorageVectorsUnknownError",this.originalError=r}}var s1;(function(e){e.InternalError="InternalError",e.S3VectorConflictException="S3VectorConflictException",e.S3VectorNotFoundException="S3VectorNotFoundException",e.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",e.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",e.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(s1||(s1={}));const _x=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),kP=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},n1=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),NP=(e,t,r)=>De(void 0,void 0,void 0,function*(){if(e&&typeof e=="object"&&"status"in e&&"ok"in e&&typeof e.status=="number"&&!(r!=null&&r.noResolveJson)){const n=e.status||500,a=e;if(typeof a.json=="function")a.json().then(i=>{const l=(i==null?void 0:i.statusCode)||(i==null?void 0:i.code)||n+"";t(new bf(n1(i),n,l))}).catch(()=>{const i=n+"",l=a.statusText||`HTTP ${n} error`;t(new bf(l,n,i))});else{const i=n+"",l=a.statusText||`HTTP ${n} error`;t(new bf(l,n,i))}}else t(new SP(n1(e),e))}),EP=(e,t,r,s)=>{const n={method:e,headers:(t==null?void 0:t.headers)||{}};return s?(kP(s)?(n.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),n.body=JSON.stringify(s)):n.body=s,Object.assign(Object.assign({},n),r)):n};function jP(e,t,r,s,n,a){return De(this,void 0,void 0,function*(){return new Promise((i,l)=>{e(r,EP(t,s,n,a)).then(c=>{if(!c.ok)throw c;if(s!=null&&s.noResolveJson)return c;const u=c.headers.get("content-type");return!u||!u.includes("application/json")?{}:c.json()}).then(c=>i(c)).catch(c=>NP(c,l,s))})})}function is(e,t,r,s,n){return De(this,void 0,void 0,function*(){return jP(e,"POST",t,s,n,r)})}class TP{constructor(t,r={},s){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},bx),r),this.fetch=_x(s)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(t){return De(this,void 0,void 0,function*(){try{return{data:(yield is(this.fetch,`${this.url}/CreateIndex`,t,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(as(r))return{data:null,error:r};throw r}})}getIndex(t,r){return De(this,void 0,void 0,function*(){try{return{data:yield is(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:t,indexName:r},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(as(s))return{data:null,error:s};throw s}})}listIndexes(t){return De(this,void 0,void 0,function*(){try{return{data:yield is(this.fetch,`${this.url}/ListIndexes`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(as(r))return{data:null,error:r};throw r}})}deleteIndex(t,r){return De(this,void 0,void 0,function*(){try{return{data:(yield is(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:t,indexName:r},{headers:this.headers}))||{},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(as(s))return{data:null,error:s};throw s}})}}class CP{constructor(t,r={},s){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},bx),r),this.fetch=_x(s)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(t){return De(this,void 0,void 0,function*(){try{if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield is(this.fetch,`${this.url}/PutVectors`,t,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(as(r))return{data:null,error:r};throw r}})}getVectors(t){return De(this,void 0,void 0,function*(){try{return{data:yield is(this.fetch,`${this.url}/GetVectors`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(as(r))return{data:null,error:r};throw r}})}listVectors(t){return De(this,void 0,void 0,function*(){try{if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return{data:yield is(this.fetch,`${this.url}/ListVectors`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(as(r))return{data:null,error:r};throw r}})}queryVectors(t){return De(this,void 0,void 0,function*(){try{return{data:yield is(this.fetch,`${this.url}/QueryVectors`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(as(r))return{data:null,error:r};throw r}})}deleteVectors(t){return De(this,void 0,void 0,function*(){try{if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield is(this.fetch,`${this.url}/DeleteVectors`,t,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(as(r))return{data:null,error:r};throw r}})}}class AP{constructor(t,r={},s){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},bx),r),this.fetch=_x(s)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return De(this,void 0,void 0,function*(){try{return{data:(yield is(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(as(r))return{data:null,error:r};throw r}})}getBucket(t){return De(this,void 0,void 0,function*(){try{return{data:yield is(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(as(r))return{data:null,error:r};throw r}})}listBuckets(){return De(this,arguments,void 0,function*(t={}){try{return{data:yield is(this.fetch,`${this.url}/ListVectorBuckets`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(as(r))return{data:null,error:r};throw r}})}deleteBucket(t){return De(this,void 0,void 0,function*(){try{return{data:(yield is(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(as(r))return{data:null,error:r};throw r}})}}class FP extends AP{constructor(t,r={}){super(t,r.headers||{},r.fetch)}from(t){return new PP(this.url,this.headers,t,this.fetch)}}class PP extends TP{constructor(t,r,s,n){super(t,r,n),this.vectorBucketName=s}createIndex(t){const r=Object.create(null,{createIndex:{get:()=>super.createIndex}});return De(this,void 0,void 0,function*(){return r.createIndex.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const t=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return De(this,arguments,void 0,function*(r={}){return t.listIndexes.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName}))})}getIndex(t){const r=Object.create(null,{getIndex:{get:()=>super.getIndex}});return De(this,void 0,void 0,function*(){return r.getIndex.call(this,this.vectorBucketName,t)})}deleteIndex(t){const r=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return De(this,void 0,void 0,function*(){return r.deleteIndex.call(this,this.vectorBucketName,t)})}index(t){return new RP(this.url,this.headers,this.vectorBucketName,t,this.fetch)}}class RP extends CP{constructor(t,r,s,n,a){super(t,r,a),this.vectorBucketName=s,this.indexName=n}putVectors(t){const r=Object.create(null,{putVectors:{get:()=>super.putVectors}});return De(this,void 0,void 0,function*(){return r.putVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(t){const r=Object.create(null,{getVectors:{get:()=>super.getVectors}});return De(this,void 0,void 0,function*(){return r.getVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const t=Object.create(null,{listVectors:{get:()=>super.listVectors}});return De(this,arguments,void 0,function*(r={}){return t.listVectors.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(t){const r=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return De(this,void 0,void 0,function*(){return r.queryVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(t){const r=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return De(this,void 0,void 0,function*(){return r.deleteVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class IP extends bP{constructor(t,r={},s,n){super(t,r,s,n)}from(t){return new wP(this.url,this.headers,t,this.fetch)}get vectors(){return new FP(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new _P(this.url+"/iceberg",this.headers,this.fetch)}}const OP="2.84.0";let sl="";typeof Deno<"u"?sl="deno":typeof document<"u"?sl="web":typeof navigator<"u"&&navigator.product==="ReactNative"?sl="react-native":sl="node";const DP={"X-Client-Info":`supabase-js-${sl}/${OP}`},LP={headers:DP},MP={schema:"public"},BP={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},UP={},zP=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),$P=()=>Headers,VP=(e,t,r)=>{const s=zP(r),n=$P();return async(a,i)=>{var l;const c=(l=await t())!==null&&l!==void 0?l:e;let u=new n(i==null?void 0:i.headers);return u.has("apikey")||u.set("apikey",e),u.has("Authorization")||u.set("Authorization",`Bearer ${c}`),s(a,Object.assign(Object.assign({},i),{headers:u}))}};function WP(e){return e.endsWith("/")?e:e+"/"}function qP(e,t){var r,s;const{db:n,auth:a,realtime:i,global:l}=e,{db:c,auth:u,realtime:d,global:f}=t,h={db:Object.assign(Object.assign({},c),n),auth:Object.assign(Object.assign({},u),a),realtime:Object.assign(Object.assign({},d),i),storage:{},global:Object.assign(Object.assign(Object.assign({},f),l),{headers:Object.assign(Object.assign({},(r=f==null?void 0:f.headers)!==null&&r!==void 0?r:{}),(s=l==null?void 0:l.headers)!==null&&s!==void 0?s:{})}),accessToken:async()=>""};return e.accessToken?h.accessToken=e.accessToken:delete h.accessToken,h}function HP(e){const t=e==null?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(WP(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const Ck="2.84.0",ji=30*1e3,ym=3,_f=ym*ji,GP="http://localhost:9999",KP="supabase.auth.token",XP={"X-Client-Info":`gotrue-js/${Ck}`},wm="X-Supabase-Api-Version",Ak={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},QP=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,YP=10*60*1e3;class sc extends Error{constructor(t,r,s){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=s}}function Le(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class JP extends sc{constructor(t,r,s){super(t,r,s),this.name="AuthApiError",this.status=r,this.code=s}}function ZP(e){return Le(e)&&e.name==="AuthApiError"}class Ia extends sc{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class ya extends sc{constructor(t,r,s,n){super(t,s,n),this.name=r,this.status=s}}class ts extends ya{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function e5(e){return Le(e)&&e.name==="AuthSessionMissingError"}class yi extends ya{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class pu extends ya{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class xu extends ya{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function t5(e){return Le(e)&&e.name==="AuthImplicitGrantRedirectError"}class a1 extends ya{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class bm extends ya{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function Sf(e){return Le(e)&&e.name==="AuthRetryableFetchError"}class i1 extends ya{constructor(t,r,s){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=s}}class _m extends ya{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const kd="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),o1=` 	
\r=`.split(""),r5=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<o1.length;t+=1)e[o1[t].charCodeAt(0)]=-2;for(let t=0;t<kd.length;t+=1)e[kd[t].charCodeAt(0)]=t;return e})();function l1(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const s=t.queue>>t.queuedBits-6&63;r(kd[s]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const s=t.queue>>t.queuedBits-6&63;r(kd[s]),t.queuedBits-=6}}function Fk(e,t,r){const s=r5[e];if(s>-1)for(t.queue=t.queue<<6|s,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function c1(e){const t=[],r=i=>{t.push(String.fromCodePoint(i))},s={utf8seq:0,codepoint:0},n={queue:0,queuedBits:0},a=i=>{a5(i,s,r)};for(let i=0;i<e.length;i+=1)Fk(e.charCodeAt(i),n,a);return t.join("")}function s5(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function n5(e,t){for(let r=0;r<e.length;r+=1){let s=e.charCodeAt(r);if(s>55295&&s<=56319){const n=(s-55296)*1024&65535;s=(e.charCodeAt(r+1)-56320&65535|n)+65536,r+=1}s5(s,t)}}function a5(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let s=1;s<6;s+=1)if(!(e>>7-s&1)){t.utf8seq=s;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function ro(e){const t=[],r={queue:0,queuedBits:0},s=n=>{t.push(n)};for(let n=0;n<e.length;n+=1)Fk(e.charCodeAt(n),r,s);return new Uint8Array(t)}function i5(e){const t=[];return n5(e,r=>t.push(r)),new Uint8Array(t)}function za(e){const t=[],r={queue:0,queuedBits:0},s=n=>{t.push(n)};return e.forEach(n=>l1(n,r,s)),l1(null,r,s),t.join("")}function o5(e){return Math.round(Date.now()/1e3)+e}function l5(){return Symbol("auth-callback")}const cr=()=>typeof window<"u"&&typeof document<"u",Ea={tested:!1,writable:!1},Pk=()=>{if(!cr())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Ea.tested)return Ea.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Ea.tested=!0,Ea.writable=!0}catch{Ea.tested=!0,Ea.writable=!1}return Ea.writable};function c5(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((n,a)=>{t[a]=n})}catch{}return r.searchParams.forEach((s,n)=>{t[n]=s}),t}const Rk=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),u5=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",Ti=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},ja=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Un=async(e,t)=>{await e.removeItem(t)};class f0{constructor(){this.promise=new f0.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}f0.promiseConstructor=Promise;function kf(e){const t=e.split(".");if(t.length!==3)throw new _m("Invalid JWT structure");for(let s=0;s<t.length;s++)if(!QP.test(t[s]))throw new _m("JWT not in base64url format");return{header:JSON.parse(c1(t[0])),payload:JSON.parse(c1(t[1])),signature:ro(t[2]),raw:{header:t[0],payload:t[1]}}}async function d5(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function f5(e,t){return new Promise((s,n)=>{(async()=>{for(let a=0;a<1/0;a++)try{const i=await e(a);if(!t(a,null,i)){s(i);return}}catch(i){if(!t(a,i)){n(i);return}}})()})}function h5(e){return("0"+e.toString(16)).substr(-2)}function m5(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=r.length;let n="";for(let a=0;a<56;a++)n+=r.charAt(Math.floor(Math.random()*s));return n}return crypto.getRandomValues(t),Array.from(t,h5).join("")}async function p5(e){const r=new TextEncoder().encode(e),s=await crypto.subtle.digest("SHA-256",r),n=new Uint8Array(s);return Array.from(n).map(a=>String.fromCharCode(a)).join("")}async function x5(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await p5(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function wi(e,t,r=!1){const s=m5();let n=s;r&&(n+="/PASSWORD_RECOVERY"),await Ti(e,`${t}-code-verifier`,n);const a=await x5(s);return[a,s===a?"plain":"s256"]}const g5=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function v5(e){const t=e.headers.get(wm);if(!t||!t.match(g5))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function y5(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function w5(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const b5=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function bi(e){if(!b5.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Nf(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const s=r.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function _5(e,t){return new Proxy(e,{get:(r,s,n)=>{if(s==="__isInsecureUserWarningProxy")return!0;if(typeof s=="symbol"){const a=s.toString();if(a==="Symbol(Symbol.toPrimitive)"||a==="Symbol(Symbol.toStringTag)"||a==="Symbol(util.inspect.custom)"||a==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,s,n)}return!t.value&&typeof s=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(r,s,n)}})}function u1(e){return JSON.parse(JSON.stringify(e))}const Fa=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),S5=[502,503,504];async function d1(e){var t;if(!u5(e))throw new bm(Fa(e),0);if(S5.includes(e.status))throw new bm(Fa(e),e.status);let r;try{r=await e.json()}catch(a){throw new Ia(Fa(a),a)}let s;const n=v5(e);if(n&&n.getTime()>=Ak["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?s=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(s=r.error_code),s){if(s==="weak_password")throw new i1(Fa(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(s==="session_not_found")throw new ts}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((a,i)=>a&&typeof i=="string",!0))throw new i1(Fa(r),e.status,r.weak_password.reasons);throw new JP(Fa(r),e.status||500,s)}const k5=(e,t,r,s)=>{const n={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),n.body=JSON.stringify(s),Object.assign(Object.assign({},n),r))};async function ze(e,t,r,s){var n;const a=Object.assign({},s==null?void 0:s.headers);a[wm]||(a[wm]=Ak["2024-01-01"].name),s!=null&&s.jwt&&(a.Authorization=`Bearer ${s.jwt}`);const i=(n=s==null?void 0:s.query)!==null&&n!==void 0?n:{};s!=null&&s.redirectTo&&(i.redirect_to=s.redirectTo);const l=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",c=await N5(e,t,r+l,{headers:a,noResolveJson:s==null?void 0:s.noResolveJson},{},s==null?void 0:s.body);return s!=null&&s.xform?s==null?void 0:s.xform(c):{data:Object.assign({},c),error:null}}async function N5(e,t,r,s,n,a){const i=k5(t,s,n,a);let l;try{l=await e(r,Object.assign({},i))}catch(c){throw console.error(c),new bm(Fa(c),0)}if(l.ok||await d1(l),s!=null&&s.noResolveJson)return l;try{return await l.json()}catch(c){await d1(c)}}function Bs(e){var t;let r=null;T5(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=o5(e.expires_in)));const s=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:s},error:null}}function f1(e){const t=Bs(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,s)=>r&&typeof s=="string",!0)&&(t.data.weak_password=e.weak_password),t}function Gn(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function E5(e){return{data:e,error:null}}function j5(e){const{action_link:t,email_otp:r,hashed_token:s,redirect_to:n,verification_type:a}=e,i=Fo(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:t,email_otp:r,hashed_token:s,redirect_to:n,verification_type:a},c=Object.assign({},i);return{data:{properties:l,user:c},error:null}}function h1(e){return e}function T5(e){return e.access_token&&e.refresh_token&&e.expires_in}const Ef=["global","local","others"];class C5{constructor({url:t="",headers:r={},fetch:s}){this.url=t,this.headers=r,this.fetch=Rk(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=Ef[0]){if(Ef.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Ef.join(", ")}`);try{return await ze(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(s){if(Le(s))return{data:null,error:s};throw s}}async inviteUserByEmail(t,r={}){try{return await ze(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Gn})}catch(s){if(Le(s))return{data:{user:null},error:s};throw s}}async generateLink(t){try{const{options:r}=t,s=Fo(t,["options"]),n=Object.assign(Object.assign({},s),r);return"newEmail"in s&&(n.new_email=s==null?void 0:s.newEmail,delete n.newEmail),await ze(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:j5,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(Le(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await ze(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Gn})}catch(r){if(Le(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,s,n,a,i,l,c;try{const u={nextPage:null,lastPage:0,total:0},d=await ze(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:"",per_page:(a=(n=t==null?void 0:t.perPage)===null||n===void 0?void 0:n.toString())!==null&&a!==void 0?a:""},xform:h1});if(d.error)throw d.error;const f=await d.json(),h=(i=d.headers.get("x-total-count"))!==null&&i!==void 0?i:0,m=(c=(l=d.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return m.length>0&&(m.forEach(x=>{const p=parseInt(x.split(";")[0].split("=")[1].substring(0,1)),g=JSON.parse(x.split(";")[1].split("=")[1]);u[`${g}Page`]=p}),u.total=parseInt(h)),{data:Object.assign(Object.assign({},f),u),error:null}}catch(u){if(Le(u))return{data:{users:[]},error:u};throw u}}async getUserById(t){bi(t);try{return await ze(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Gn})}catch(r){if(Le(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){bi(t);try{return await ze(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:Gn})}catch(s){if(Le(s))return{data:{user:null},error:s};throw s}}async deleteUser(t,r=!1){bi(t);try{return await ze(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:Gn})}catch(s){if(Le(s))return{data:{user:null},error:s};throw s}}async _listFactors(t){bi(t.userId);try{const{data:r,error:s}=await ze(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:r,error:s}}catch(r){if(Le(r))return{data:null,error:r};throw r}}async _deleteFactor(t){bi(t.userId),bi(t.id);try{return{data:await ze(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Le(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,s,n,a,i,l,c;try{const u={nextPage:null,lastPage:0,total:0},d=await ze(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:"",per_page:(a=(n=t==null?void 0:t.perPage)===null||n===void 0?void 0:n.toString())!==null&&a!==void 0?a:""},xform:h1});if(d.error)throw d.error;const f=await d.json(),h=(i=d.headers.get("x-total-count"))!==null&&i!==void 0?i:0,m=(c=(l=d.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return m.length>0&&(m.forEach(x=>{const p=parseInt(x.split(";")[0].split("=")[1].substring(0,1)),g=JSON.parse(x.split(";")[1].split("=")[1]);u[`${g}Page`]=p}),u.total=parseInt(h)),{data:Object.assign(Object.assign({},f),u),error:null}}catch(u){if(Le(u))return{data:{clients:[]},error:u};throw u}}async _createOAuthClient(t){try{return await ze(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Le(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await ze(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Le(r))return{data:null,error:r};throw r}}async _updateOAuthClient(t,r){try{return await ze(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:r,headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(Le(s))return{data:null,error:s};throw s}}async _deleteOAuthClient(t){try{return await ze(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Le(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await ze(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Le(r))return{data:null,error:r};throw r}}}function m1(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const _i={debug:!!(globalThis&&Pk()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Ik extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class A5 extends Ik{}async function F5(e,t,r){_i.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const s=new globalThis.AbortController;return t>0&&setTimeout(()=>{s.abort(),_i.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async n=>{if(n){_i.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,n.name);try{return await r()}finally{_i.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,n.name)}}else{if(t===0)throw _i.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new A5(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(_i.debug)try{const a=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function P5(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function Ok(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function R5(e){return parseInt(e,16)}function I5(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,s=>s.toString(16).padStart(2,"0")).join("")}function O5(e){var t;const{chainId:r,domain:s,expirationTime:n,issuedAt:a=new Date,nonce:i,notBefore:l,requestId:c,resources:u,scheme:d,uri:f,version:h}=e;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!s)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(i&&i.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${i}`);if(!f)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(h!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${h}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const m=Ok(e.address),x=d?`${d}://${s}`:s,p=e.statement?`${e.statement}
`:"",g=`${x} wants you to sign in with your Ethereum account:
${m}

${p}`;let w=`URI: ${f}
Version: ${h}
Chain ID: ${r}${i?`
Nonce: ${i}`:""}
Issued At: ${a.toISOString()}`;if(n&&(w+=`
Expiration Time: ${n.toISOString()}`),l&&(w+=`
Not Before: ${l.toISOString()}`),c&&(w+=`
Request ID: ${c}`),u){let v=`
Resources:`;for(const y of u){if(!y||typeof y!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${y}`);v+=`
- ${y}`}w+=v}return`${g}
${w}`}class Kt extends Error{constructor({message:t,code:r,cause:s,name:n}){var a;super(t,{cause:s}),this.__isWebAuthnError=!0,this.name=(a=n??(s instanceof Error?s.name:void 0))!==null&&a!==void 0?a:"Unknown Error",this.code=r}}class Nd extends Kt{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function D5({error:e,options:t}){var r,s,n;const{publicKey:a}=t;if(!a)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Kt({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((r=a.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new Kt({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((s=a.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new Kt({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((n=a.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new Kt({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new Kt({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new Kt({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return a.pubKeyCredParams.filter(l=>l.type==="public-key").length===0?new Kt({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new Kt({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const i=window.location.hostname;if(Dk(i)){if(a.rp.id!==i)return new Kt({message:`The RP ID "${a.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Kt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(a.user.id.byteLength<1||a.user.id.byteLength>64)return new Kt({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new Kt({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Kt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function L5({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Kt({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new Kt({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const s=window.location.hostname;if(Dk(s)){if(r.rpId!==s)return new Kt({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Kt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new Kt({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Kt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}class M5{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const B5=new M5;function U5(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:s}=e,n=Fo(e,["challenge","user","excludeCredentials"]),a=ro(t).buffer,i=Object.assign(Object.assign({},r),{id:ro(r.id).buffer}),l=Object.assign(Object.assign({},n),{challenge:a,user:i});if(s&&s.length>0){l.excludeCredentials=new Array(s.length);for(let c=0;c<s.length;c++){const u=s[c];l.excludeCredentials[c]=Object.assign(Object.assign({},u),{id:ro(u.id).buffer,type:u.type||"public-key",transports:u.transports})}}return l}function z5(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,s=Fo(e,["challenge","allowCredentials"]),n=ro(t).buffer,a=Object.assign(Object.assign({},s),{challenge:n});if(r&&r.length>0){a.allowCredentials=new Array(r.length);for(let i=0;i<r.length;i++){const l=r[i];a.allowCredentials[i]=Object.assign(Object.assign({},l),{id:ro(l.id).buffer,type:l.type||"public-key",transports:l.transports})}}return a}function $5(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:za(new Uint8Array(e.response.attestationObject)),clientDataJSON:za(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function V5(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e,s=e.getClientExtensionResults(),n=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:za(new Uint8Array(n.authenticatorData)),clientDataJSON:za(new Uint8Array(n.clientDataJSON)),signature:za(new Uint8Array(n.signature)),userHandle:n.userHandle?za(new Uint8Array(n.userHandle)):void 0},type:"public-key",clientExtensionResults:s,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function Dk(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function p1(){var e,t;return!!(cr()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.get)=="function")}async function W5(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Nd("Browser returned unexpected credential type",t)}:{data:null,error:new Nd("Empty credential response",t)}}catch(t){return{data:null,error:D5({error:t,options:e})}}}async function q5(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Nd("Browser returned unexpected credential type",t)}:{data:null,error:new Nd("Empty credential response",t)}}catch(t){return{data:null,error:L5({error:t,options:e})}}}const H5={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},G5={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Ed(...e){const t=n=>n!==null&&typeof n=="object"&&!Array.isArray(n),r=n=>n instanceof ArrayBuffer||ArrayBuffer.isView(n),s={};for(const n of e)if(n)for(const a in n){const i=n[a];if(i!==void 0)if(Array.isArray(i))s[a]=i;else if(r(i))s[a]=i;else if(t(i)){const l=s[a];t(l)?s[a]=Ed(l,i):s[a]=Ed(i)}else s[a]=i}return s}function K5(e,t){return Ed(H5,e,t||{})}function X5(e,t){return Ed(G5,e,t||{})}class Q5{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:s,signal:n},a){try{const{data:i,error:l}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!i)return{data:null,error:l};const c=n??B5.createNewAbortSignal();if(i.webauthn.type==="create"){const{user:u}=i.webauthn.credential_options.publicKey;u.name||(u.name=`${u.id}:${s}`),u.displayName||(u.displayName=u.name)}switch(i.webauthn.type){case"create":{const u=K5(i.webauthn.credential_options.publicKey,a==null?void 0:a.create),{data:d,error:f}=await W5({publicKey:u,signal:c});return d?{data:{factorId:t,challengeId:i.id,webauthn:{type:i.webauthn.type,credential_response:d}},error:null}:{data:null,error:f}}case"request":{const u=X5(i.webauthn.credential_options.publicKey,a==null?void 0:a.request),{data:d,error:f}=await q5(Object.assign(Object.assign({},i.webauthn.credential_options),{publicKey:u,signal:c}));return d?{data:{factorId:t,challengeId:i.id,webauthn:{type:i.webauthn.type,credential_response:d}},error:null}:{data:null,error:f}}}}catch(i){return Le(i)?{data:null,error:i}:{data:null,error:new Ia("Unexpected error in challenge",i)}}}async _verify({challengeId:t,factorId:r,webauthn:s}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:s})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:n}={}},a){if(!r)return{data:null,error:new sc("rpId is required for WebAuthn authentication")};try{if(!p1())return{data:null,error:new Ia("Browser does not support WebAuthn",null)};const{data:i,error:l}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:s},signal:n},{request:a});if(!i)return{data:null,error:l};const{webauthn:c}=i;return this._verify({factorId:t,challengeId:i.challengeId,webauthn:{type:c.type,rpId:r,rpOrigins:s,credential_response:c.credential_response}})}catch(i){return Le(i)?{data:null,error:i}:{data:null,error:new Ia("Unexpected error in authenticate",i)}}}async _register({friendlyName:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:n}={}},a){if(!r)return{data:null,error:new sc("rpId is required for WebAuthn registration")};try{if(!p1())return{data:null,error:new Ia("Browser does not support WebAuthn",null)};const{data:i,error:l}=await this._enroll({friendlyName:t});if(!i)return await this.client.mfa.listFactors().then(d=>{var f;return(f=d.data)===null||f===void 0?void 0:f.all.find(h=>h.factor_type==="webauthn"&&h.friendly_name===t&&h.status!=="unverified")}).then(d=>d?this.client.mfa.unenroll({factorId:d==null?void 0:d.id}):void 0),{data:null,error:l};const{data:c,error:u}=await this._challenge({factorId:i.id,friendlyName:i.friendly_name,webauthn:{rpId:r,rpOrigins:s},signal:n},{create:a});return c?this._verify({factorId:i.id,challengeId:c.challengeId,webauthn:{rpId:r,rpOrigins:s,type:c.webauthn.type,credential_response:c.webauthn.credential_response}}):{data:null,error:u}}catch(i){return Le(i)?{data:null,error:i}:{data:null,error:new Ia("Unexpected error in register",i)}}}}P5();const Y5={url:GP,storageKey:KP,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:XP,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function x1(e,t,r){return await r()}const Si={};class nc{get jwks(){var t,r;return(r=(t=Si[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){Si[this.storageKey]=Object.assign(Object.assign({},Si[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=Si[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){Si[this.storageKey]=Object.assign(Object.assign({},Si[this.storageKey]),{cachedAt:t})}constructor(t){var r,s,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const a=Object.assign(Object.assign({},Y5),t);if(this.storageKey=a.storageKey,this.instanceID=(r=nc.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,nc.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.instanceID>0&&cr()){const i=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(i),this.logDebugMessages&&console.trace(i)}if(this.persistSession=a.persistSession,this.autoRefreshToken=a.autoRefreshToken,this.admin=new C5({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=Rk(a.fetch),this.lock=a.lock||x1,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,this.throwOnError=a.throwOnError,a.lock?this.lock=a.lock:cr()&&(!((s=globalThis==null?void 0:globalThis.navigator)===null||s===void 0)&&s.locks)?this.lock=F5:this.lock=x1,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new Q5(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:Pk()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=m1(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=m1(this.memoryStorage)),cr()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${Ck}) ${new Date().toISOString()}`}_debug(...t){return this.logDebugMessages&&this.logger(this._logPrefix(),...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let r={},s="none";if(cr()&&(r=c5(window.location.href),this._isImplicitGrantCallback(r)?s="implicit":await this._isPKCECallback(r)&&(s="pkce")),cr()&&this.detectSessionInUrl&&s!=="none"){const{data:n,error:a}=await this._getSessionFromURL(r,s);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),t5(a)){const c=(t=a.details)===null||t===void 0?void 0:t.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:a}}return await this._removeSession(),{error:a}}const{session:i,redirectType:l}=n;return this._debug("#_initialize()","detected session in URL",i,"redirect type",l),await this._saveSession(i),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Le(r)?this._returnResult({error:r}):this._returnResult({error:new Ia("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,s,n;try{const a=await ze(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(n=t==null?void 0:t.options)===null||n===void 0?void 0:n.captchaToken}},xform:Bs}),{data:i,error:l}=a;if(l||!i)return this._returnResult({data:{user:null,session:null},error:l});const c=i.session,u=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:u,session:c},error:null})}catch(a){if(Le(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signUp(t){var r,s,n;try{let a;if("email"in t){const{email:d,password:f,options:h}=t;let m=null,x=null;this.flowType==="pkce"&&([m,x]=await wi(this.storage,this.storageKey)),a=await ze(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h==null?void 0:h.emailRedirectTo,body:{email:d,password:f,data:(r=h==null?void 0:h.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:m,code_challenge_method:x},xform:Bs})}else if("phone"in t){const{phone:d,password:f,options:h}=t;a=await ze(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:f,data:(s=h==null?void 0:h.data)!==null&&s!==void 0?s:{},channel:(n=h==null?void 0:h.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:Bs})}else throw new pu("You must provide either an email or phone number and a password");const{data:i,error:l}=a;if(l||!i)return this._returnResult({data:{user:null,session:null},error:l});const c=i.session,u=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:u,session:c},error:null})}catch(a){if(Le(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithPassword(t){try{let r;if("email"in t){const{email:a,password:i,options:l}=t;r=await ze(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:a,password:i,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:f1})}else if("phone"in t){const{phone:a,password:i,options:l}=t;r=await ze(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:a,password:i,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:f1})}else throw new pu("You must provide either an email or phone number and a password");const{data:s,error:n}=r;if(n)return this._returnResult({data:{user:null,session:null},error:n});if(!s||!s.session||!s.user){const a=new yi;return this._returnResult({data:{user:null,session:null},error:a})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:n})}catch(r){if(Le(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(t){var r,s,n,a;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(s=t.options)===null||s===void 0?void 0:s.scopes,queryParams:(n=t.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(a=t.options)===null||a===void 0?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,s,n,a,i,l,c,u,d,f,h;let m,x;if("message"in t)m=t.message,x=t.signature;else{const{chain:p,wallet:g,statement:w,options:v}=t;let y;if(cr())if(typeof g=="object")y=g;else{const T=window;if("ethereum"in T&&typeof T.ethereum=="object"&&"request"in T.ethereum&&typeof T.ethereum.request=="function")y=T.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof g!="object"||!(v!=null&&v.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");y=g}const b=new URL((r=v==null?void 0:v.url)!==null&&r!==void 0?r:window.location.href),S=await y.request({method:"eth_requestAccounts"}).then(T=>T).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!S||S.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const _=Ok(S[0]);let k=(s=v==null?void 0:v.signInWithEthereum)===null||s===void 0?void 0:s.chainId;if(!k){const T=await y.request({method:"eth_chainId"});k=R5(T)}const E={domain:b.host,address:_,statement:w,uri:b.href,version:"1",chainId:k,nonce:(n=v==null?void 0:v.signInWithEthereum)===null||n===void 0?void 0:n.nonce,issuedAt:(i=(a=v==null?void 0:v.signInWithEthereum)===null||a===void 0?void 0:a.issuedAt)!==null&&i!==void 0?i:new Date,expirationTime:(l=v==null?void 0:v.signInWithEthereum)===null||l===void 0?void 0:l.expirationTime,notBefore:(c=v==null?void 0:v.signInWithEthereum)===null||c===void 0?void 0:c.notBefore,requestId:(u=v==null?void 0:v.signInWithEthereum)===null||u===void 0?void 0:u.requestId,resources:(d=v==null?void 0:v.signInWithEthereum)===null||d===void 0?void 0:d.resources};m=O5(E),x=await y.request({method:"personal_sign",params:[I5(m),_]})}try{const{data:p,error:g}=await ze(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:m,signature:x},!((f=t.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(h=t.options)===null||h===void 0?void 0:h.captchaToken}}:null),xform:Bs});if(g)throw g;if(!p||!p.session||!p.user){const w=new yi;return this._returnResult({data:{user:null,session:null},error:w})}return p.session&&(await this._saveSession(p.session),await this._notifyAllSubscribers("SIGNED_IN",p.session)),this._returnResult({data:Object.assign({},p),error:g})}catch(p){if(Le(p))return this._returnResult({data:{user:null,session:null},error:p});throw p}}async signInWithSolana(t){var r,s,n,a,i,l,c,u,d,f,h,m;let x,p;if("message"in t)x=t.message,p=t.signature;else{const{chain:g,wallet:w,statement:v,options:y}=t;let b;if(cr())if(typeof w=="object")b=w;else{const _=window;if("solana"in _&&typeof _.solana=="object"&&("signIn"in _.solana&&typeof _.solana.signIn=="function"||"signMessage"in _.solana&&typeof _.solana.signMessage=="function"))b=_.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof w!="object"||!(y!=null&&y.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");b=w}const S=new URL((r=y==null?void 0:y.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in b&&b.signIn){const _=await b.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},y==null?void 0:y.signInWithSolana),{version:"1",domain:S.host,uri:S.href}),v?{statement:v}:null));let k;if(Array.isArray(_)&&_[0]&&typeof _[0]=="object")k=_[0];else if(_&&typeof _=="object"&&"signedMessage"in _&&"signature"in _)k=_;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in k&&"signature"in k&&(typeof k.signedMessage=="string"||k.signedMessage instanceof Uint8Array)&&k.signature instanceof Uint8Array)x=typeof k.signedMessage=="string"?k.signedMessage:new TextDecoder().decode(k.signedMessage),p=k.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in b)||typeof b.signMessage!="function"||!("publicKey"in b)||typeof b!="object"||!b.publicKey||!("toBase58"in b.publicKey)||typeof b.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");x=[`${S.host} wants you to sign in with your Solana account:`,b.publicKey.toBase58(),...v?["",v,""]:[""],"Version: 1",`URI: ${S.href}`,`Issued At: ${(n=(s=y==null?void 0:y.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&n!==void 0?n:new Date().toISOString()}`,...!((a=y==null?void 0:y.signInWithSolana)===null||a===void 0)&&a.notBefore?[`Not Before: ${y.signInWithSolana.notBefore}`]:[],...!((i=y==null?void 0:y.signInWithSolana)===null||i===void 0)&&i.expirationTime?[`Expiration Time: ${y.signInWithSolana.expirationTime}`]:[],...!((l=y==null?void 0:y.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${y.signInWithSolana.chainId}`]:[],...!((c=y==null?void 0:y.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${y.signInWithSolana.nonce}`]:[],...!((u=y==null?void 0:y.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${y.signInWithSolana.requestId}`]:[],...!((f=(d=y==null?void 0:y.signInWithSolana)===null||d===void 0?void 0:d.resources)===null||f===void 0)&&f.length?["Resources",...y.signInWithSolana.resources.map(k=>`- ${k}`)]:[]].join(`
`);const _=await b.signMessage(new TextEncoder().encode(x),"utf8");if(!_||!(_ instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");p=_}}try{const{data:g,error:w}=await ze(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:x,signature:za(p)},!((h=t.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(m=t.options)===null||m===void 0?void 0:m.captchaToken}}:null),xform:Bs});if(w)throw w;if(!g||!g.session||!g.user){const v=new yi;return this._returnResult({data:{user:null,session:null},error:v})}return g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),this._returnResult({data:Object.assign({},g),error:w})}catch(g){if(Le(g))return this._returnResult({data:{user:null,session:null},error:g});throw g}}async _exchangeCodeForSession(t){const r=await ja(this.storage,`${this.storageKey}-code-verifier`),[s,n]=(r??"").split("/");try{const{data:a,error:i}=await ze(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:s},xform:Bs});if(await Un(this.storage,`${this.storageKey}-code-verifier`),i)throw i;if(!a||!a.session||!a.user){const l=new yi;return this._returnResult({data:{user:null,session:null,redirectType:null},error:l})}return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),this._returnResult({data:Object.assign(Object.assign({},a),{redirectType:n??null}),error:i})}catch(a){if(Le(a))return this._returnResult({data:{user:null,session:null,redirectType:null},error:a});throw a}}async signInWithIdToken(t){try{const{options:r,provider:s,token:n,access_token:a,nonce:i}=t,l=await ze(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:n,access_token:a,nonce:i,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:Bs}),{data:c,error:u}=l;if(u)return this._returnResult({data:{user:null,session:null},error:u});if(!c||!c.session||!c.user){const d=new yi;return this._returnResult({data:{user:null,session:null},error:d})}return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),this._returnResult({data:c,error:u})}catch(r){if(Le(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(t){var r,s,n,a,i;try{if("email"in t){const{email:l,options:c}=t;let u=null,d=null;this.flowType==="pkce"&&([u,d]=await wi(this.storage,this.storageKey));const{error:f}=await ze(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(r=c==null?void 0:c.data)!==null&&r!==void 0?r:{},create_user:(s=c==null?void 0:c.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:u,code_challenge_method:d},redirectTo:c==null?void 0:c.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:f})}if("phone"in t){const{phone:l,options:c}=t,{data:u,error:d}=await ze(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(n=c==null?void 0:c.data)!==null&&n!==void 0?n:{},create_user:(a=c==null?void 0:c.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(i=c==null?void 0:c.channel)!==null&&i!==void 0?i:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:d})}throw new pu("You must provide either an email or phone number.")}catch(l){if(Le(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async verifyOtp(t){var r,s;try{let n,a;"options"in t&&(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo,a=(s=t.options)===null||s===void 0?void 0:s.captchaToken);const{data:i,error:l}=await ze(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:a}}),redirectTo:n,xform:Bs});if(l)throw l;if(!i)throw new Error("An error occurred on token verification.");const c=i.session,u=i.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),this._returnResult({data:{user:u,session:c},error:null})}catch(n){if(Le(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithSSO(t){var r,s,n,a,i;try{let l=null,c=null;this.flowType==="pkce"&&([l,c]=await wi(this.storage,this.storageKey));const u=await ze(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(s=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&s!==void 0?s:void 0}),!((n=t==null?void 0:t.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:c}),headers:this.headers,xform:E5});return!((a=u.data)===null||a===void 0)&&a.url&&cr()&&!(!((i=t.options)===null||i===void 0)&&i.skipBrowserRedirect)&&window.location.assign(u.data.url),this._returnResult(u)}catch(l){if(Le(l))return this._returnResult({data:null,error:l});throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:s}=t;if(s)throw s;if(!r)throw new ts;const{error:n}=await ze(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:n})})}catch(t){if(Le(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:s,type:n,options:a}=t,{error:i}=await ze(this.fetch,"POST",r,{headers:this.headers,body:{email:s,type:n,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},redirectTo:a==null?void 0:a.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:i})}else if("phone"in t){const{phone:s,type:n,options:a}=t,{data:i,error:l}=await ze(this.fetch,"POST",r,{headers:this.headers,body:{phone:s,type:n,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:i==null?void 0:i.message_id},error:l})}throw new pu("You must provide either an email or phone number and a type")}catch(r){if(Le(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await s,await r()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=r();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await ja(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const s=t.expires_at?t.expires_at*1e3-Date.now()<_f:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",t.expires_at),!s){if(this.userStorage){const i=await ja(this.userStorage,this.storageKey+"-user");i!=null&&i.user?t.user=i.user:t.user=Nf()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const i={value:this.suppressGetSessionWarning};t.user=_5(t.user,i),i.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:n,error:a}=await this._callRefreshToken(t.refresh_token);return a?this._returnResult({data:{session:null},error:a}):this._returnResult({data:{session:n},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await ze(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Gn}):await this._useSession(async r=>{var s,n,a;const{data:i,error:l}=r;if(l)throw l;return!(!((s=i.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new ts}:await ze(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0,xform:Gn})})}catch(r){if(Le(r))return e5(r)&&(await this._removeSession(),await Un(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async s=>{const{data:n,error:a}=s;if(a)throw a;if(!n.session)throw new ts;const i=n.session;let l=null,c=null;this.flowType==="pkce"&&t.email!=null&&([l,c]=await wi(this.storage,this.storageKey));const{data:u,error:d}=await ze(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:l,code_challenge_method:c}),jwt:i.access_token,xform:Gn});if(d)throw d;return i.user=u.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),this._returnResult({data:{user:i.user},error:null})})}catch(s){if(Le(s))return this._returnResult({data:{user:null},error:s});throw s}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new ts;const r=Date.now()/1e3;let s=r,n=!0,a=null;const{payload:i}=kf(t.access_token);if(i.exp&&(s=i.exp,n=s<=r),n){const{data:l,error:c}=await this._callRefreshToken(t.refresh_token);if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!l)return{data:{user:null,session:null},error:null};a=l}else{const{data:l,error:c}=await this._getUser(t.access_token);if(c)throw c;a={access_token:t.access_token,refresh_token:t.refresh_token,user:l.user,token_type:"bearer",expires_in:s-r,expires_at:s},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return this._returnResult({data:{user:a.user,session:a},error:null})}catch(r){if(Le(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var s;if(!t){const{data:i,error:l}=r;if(l)throw l;t=(s=i.session)!==null&&s!==void 0?s:void 0}if(!(t!=null&&t.refresh_token))throw new ts;const{data:n,error:a}=await this._callRefreshToken(t.refresh_token);return a?this._returnResult({data:{user:null,session:null},error:a}):n?this._returnResult({data:{user:n.user,session:n},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(Le(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(t,r){try{if(!cr())throw new xu("No browser detected.");if(t.error||t.error_description||t.error_code)throw new xu(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new a1("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new xu("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new a1("No code detected.");const{data:v,error:y}=await this._exchangeCodeForSession(t.code);if(y)throw y;const b=new URL(window.location.href);return b.searchParams.delete("code"),window.history.replaceState(window.history.state,"",b.toString()),{data:{session:v.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:n,access_token:a,refresh_token:i,expires_in:l,expires_at:c,token_type:u}=t;if(!a||!l||!i||!u)throw new xu("No session defined in URL");const d=Math.round(Date.now()/1e3),f=parseInt(l);let h=d+f;c&&(h=parseInt(c));const m=h-d;m*1e3<=ji&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${m}s, should have been closer to ${f}s`);const x=h-f;d-x>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",x,h,d):d-x<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",x,h,d);const{data:p,error:g}=await this._getUser(a);if(g)throw g;const w={provider_token:s,provider_refresh_token:n,access_token:a,expires_in:f,expires_at:h,refresh_token:i,token_type:u,user:p.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:w,redirectType:t.type},error:null})}catch(s){if(Le(s))return this._returnResult({data:{session:null,redirectType:null},error:s});throw s}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await ja(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var s;const{data:n,error:a}=r;if(a)return this._returnResult({error:a});const i=(s=n.session)===null||s===void 0?void 0:s.access_token;if(i){const{error:l}=await this.admin.signOut(i,t);if(l&&!(ZP(l)&&(l.status===404||l.status===401||l.status===403)))return this._returnResult({error:l})}return t!=="others"&&(await this._removeSession(),await Un(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const r=l5(),s={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:s}}}async _emitInitialSession(t){return await this._useSession(async r=>{var s,n;try{const{data:{session:a},error:i}=r;if(i)throw i;await((s=this.stateChangeEmitters.get(t))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",t,"session",a)}catch(a){await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",a),console.error(a)}})}async resetPasswordForEmail(t,r={}){let s=null,n=null;this.flowType==="pkce"&&([s,n]=await wi(this.storage,this.storageKey,!0));try{return await ze(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:s,code_challenge_method:n,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(a){if(Le(a))return this._returnResult({data:null,error:a});throw a}}async getUserIdentities(){var t;try{const{data:r,error:s}=await this.getUser();if(s)throw s;return this._returnResult({data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(r){if(Le(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:s,error:n}=await this._useSession(async a=>{var i,l,c,u,d;const{data:f,error:h}=a;if(h)throw h;const m=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(i=t.options)===null||i===void 0?void 0:i.redirectTo,scopes:(l=t.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=t.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await ze(this.fetch,"GET",m,{headers:this.headers,jwt:(d=(u=f.session)===null||u===void 0?void 0:u.access_token)!==null&&d!==void 0?d:void 0})});if(n)throw n;return cr()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(s==null?void 0:s.url),this._returnResult({data:{provider:t.provider,url:s==null?void 0:s.url},error:null})}catch(s){if(Le(s))return this._returnResult({data:{provider:t.provider,url:null},error:s});throw s}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var s;try{const{error:n,data:{session:a}}=r;if(n)throw n;const{options:i,provider:l,token:c,access_token:u,nonce:d}=t,f=await ze(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(s=a==null?void 0:a.access_token)!==null&&s!==void 0?s:void 0,body:{provider:l,id_token:c,access_token:u,nonce:d,link_identity:!0,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},xform:Bs}),{data:h,error:m}=f;return m?this._returnResult({data:{user:null,session:null},error:m}):!h||!h.session||!h.user?this._returnResult({data:{user:null,session:null},error:new yi}):(h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("USER_UPDATED",h.session)),this._returnResult({data:h,error:m}))}catch(n){if(Le(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var s,n;const{data:a,error:i}=r;if(i)throw i;return await ze(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(n=(s=a.session)===null||s===void 0?void 0:s.access_token)!==null&&n!==void 0?n:void 0})})}catch(r){if(Le(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const s=Date.now();return await f5(async n=>(n>0&&await d5(200*Math.pow(2,n-1)),this._debug(r,"refreshing attempt",n),await ze(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Bs})),(n,a)=>{const i=200*Math.pow(2,n);return a&&Sf(a)&&Date.now()+i-s<ji})}catch(s){if(this._debug(r,"error",s),Le(s))return this._returnResult({data:{session:null,user:null},error:s});throw s}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const s=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",s),cr()&&!r.skipBrowserRedirect&&window.location.assign(s),{data:{provider:t,url:s},error:null}}async _recoverAndRefresh(){var t,r;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const n=await ja(this.storage,this.storageKey);if(n&&this.userStorage){let i=await ja(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!i&&(i={user:n.user},await Ti(this.userStorage,this.storageKey+"-user",i)),n.user=(t=i==null?void 0:i.user)!==null&&t!==void 0?t:Nf()}else if(n&&!n.user&&!n.user){const i=await ja(this.storage,this.storageKey+"-user");i&&(i!=null&&i.user)?(n.user=i.user,await Un(this.storage,this.storageKey+"-user"),await Ti(this.storage,this.storageKey,n)):n.user=Nf()}if(this._debug(s,"session from storage",n),!this._isValidSession(n)){this._debug(s,"session is not valid"),n!==null&&await this._removeSession();return}const a=((r=n.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<_f;if(this._debug(s,`session has${a?"":" not"} expired with margin of ${_f}s`),a){if(this.autoRefreshToken&&n.refresh_token){const{error:i}=await this._callRefreshToken(n.refresh_token);i&&(console.error(i),Sf(i)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else if(n.user&&n.user.__isUserNotAvailableProxy===!0)try{const{data:i,error:l}=await this._getUser(n.access_token);!l&&(i!=null&&i.user)?(n.user=i.user,await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(i){console.error("Error getting user data:",i),this._debug(s,"error getting user data, skipping SIGNED_IN notification",i)}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(s,"error",n),console.error(n);return}finally{this._debug(s,"end")}}async _callRefreshToken(t){var r,s;if(!t)throw new ts;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new f0;const{data:a,error:i}=await this._refreshAccessToken(t);if(i)throw i;if(!a.session)throw new ts;await this._saveSession(a.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const l={data:a.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(a){if(this._debug(n,"error",a),Le(a)){const i={data:null,error:a};return Sf(a)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(i),i}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(a),a}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(t,r,s=!0){const n=`#_notifyAllSubscribers(${t})`;this._debug(n,"begin",r,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:t,session:r});const a=[],i=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(t,r)}catch(c){a.push(c)}});if(await Promise.all(i),a.length>0){for(let l=0;l<a.length;l+=1)console.error(a[l]);throw a[0]}}finally{this._debug(n,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const r=Object.assign({},t),s=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!s&&r.user&&await Ti(this.userStorage,this.storageKey+"-user",{user:r.user});const n=Object.assign({},r);delete n.user;const a=u1(n);await Ti(this.storage,this.storageKey,a)}else{const n=u1(r);await Ti(this.storage,this.storageKey,n)}}async _removeSession(){this._debug("#_removeSession()"),await Un(this.storage,this.storageKey),await Un(this.storage,this.storageKey+"-code-verifier"),await Un(this.storage,this.storageKey+"-user"),this.userStorage&&await Un(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&cr()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),ji);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:s}}=r;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((s.expires_at*1e3-t)/ji);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${ji}ms, refresh threshold is ${ym} ticks`),n<=ym&&await this._callRefreshToken(s.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof Ik)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!cr()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,s){const n=[`provider=${encodeURIComponent(r)}`];if(s!=null&&s.redirectTo&&n.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s!=null&&s.scopes&&n.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[a,i]=await wi(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(i)}`});n.push(l.toString())}if(s!=null&&s.queryParams){const a=new URLSearchParams(s.queryParams);n.push(a.toString())}return s!=null&&s.skipBrowserRedirect&&n.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${t}?${n.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var s;const{data:n,error:a}=r;return a?this._returnResult({data:null,error:a}):await ze(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token})})}catch(r){if(Le(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(t){try{return await this._useSession(async r=>{var s,n;const{data:a,error:i}=r;if(i)return this._returnResult({data:null,error:i});const l=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:c,error:u}=await ze(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(s=a==null?void 0:a.session)===null||s===void 0?void 0:s.access_token});return u?this._returnResult({data:null,error:u}):(t.factorType==="totp"&&c.type==="totp"&&(!((n=c==null?void 0:c.totp)===null||n===void 0)&&n.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),this._returnResult({data:c,error:null}))})}catch(r){if(Le(r))return this._returnResult({data:null,error:r});throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var s;const{data:n,error:a}=r;if(a)return this._returnResult({data:null,error:a});const i=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?$5(t.webauthn.credential_response):V5(t.webauthn.credential_response)})}:{code:t.code}),{data:l,error:c}=await ze(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:i,headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token});return c?this._returnResult({data:null,error:c}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),this._returnResult({data:l,error:c}))})}catch(r){if(Le(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var s;const{data:n,error:a}=r;if(a)return this._returnResult({data:null,error:a});const i=await ze(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token});if(i.error)return i;const{data:l}=i;if(l.type!=="webauthn")return{data:l,error:null};switch(l.webauthn.type){case"create":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:U5(l.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:z5(l.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(Le(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(t){const{data:r,error:s}=await this._challenge({factorId:t.factorId});return s?this._returnResult({data:null,error:s}):await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:s}=await this.getUser();if(s)return{data:null,error:s};const n={all:[],phone:[],totp:[],webauthn:[]};for(const a of(t=r==null?void 0:r.factors)!==null&&t!==void 0?t:[])n.all.push(a),a.status==="verified"&&n[a.factor_type].push(a);return{data:n,error:null}}async _getAuthenticatorAssuranceLevel(){var t,r;const{data:{session:s},error:n}=await this.getSession();if(n)return this._returnResult({data:null,error:n});if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=kf(s.access_token);let i=null;a.aal&&(i=a.aal);let l=i;((r=(t=s.user.factors)===null||t===void 0?void 0:t.filter(d=>d.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(l="aal2");const u=a.amr||[];return{data:{currentLevel:i,nextLevel:l,currentAuthenticationMethods:u},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async r=>{const{data:{session:s},error:n}=r;return n?this._returnResult({data:null,error:n}):s?await ze(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:s.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new ts})})}catch(r){if(Le(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(t,r){try{return await this._useSession(async s=>{const{data:{session:n},error:a}=s;if(a)return this._returnResult({data:null,error:a});if(!n)return this._returnResult({data:null,error:new ts});const i=await ze(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:n.access_token,body:{action:"approve"},xform:l=>({data:l,error:null})});return i.data&&i.data.redirect_url&&cr()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(i.data.redirect_url),i})}catch(s){if(Le(s))return this._returnResult({data:null,error:s});throw s}}async _denyAuthorization(t,r){try{return await this._useSession(async s=>{const{data:{session:n},error:a}=s;if(a)return this._returnResult({data:null,error:a});if(!n)return this._returnResult({data:null,error:new ts});const i=await ze(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:n.access_token,body:{action:"deny"},xform:l=>({data:l,error:null})});return i.data&&i.data.redirect_url&&cr()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(i.data.redirect_url),i})}catch(s){if(Le(s))return this._returnResult({data:null,error:s});throw s}}async _listOAuthGrants(){try{return await this._useSession(async t=>{const{data:{session:r},error:s}=t;return s?this._returnResult({data:null,error:s}):r?await ze(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:n=>({data:n,error:null})}):this._returnResult({data:null,error:new ts})})}catch(t){if(Le(t))return this._returnResult({data:null,error:t});throw t}}async _revokeOAuthGrant(t){try{return await this._useSession(async r=>{const{data:{session:s},error:n}=r;return n?this._returnResult({data:null,error:n}):s?await ze(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:s.access_token,query:{client_id:t.clientId},xform:()=>({data:{},error:null})}):this._returnResult({data:null,error:new ts})})}catch(r){if(Le(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(t,r={keys:[]}){let s=r.keys.find(l=>l.kid===t);if(s)return s;const n=Date.now();if(s=this.jwks.keys.find(l=>l.kid===t),s&&this.jwks_cached_at+YP>n)return s;const{data:a,error:i}=await ze(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;return!a.keys||a.keys.length===0||(this.jwks=a,this.jwks_cached_at=n,s=a.keys.find(l=>l.kid===t),!s)?null:s}async getClaims(t,r={}){try{let s=t;if(!s){const{data:m,error:x}=await this.getSession();if(x||!m.session)return this._returnResult({data:null,error:x});s=m.session.access_token}const{header:n,payload:a,signature:i,raw:{header:l,payload:c}}=kf(s);r!=null&&r.allowExpired||y5(a.exp);const u=!n.alg||n.alg.startsWith("HS")||!n.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(n.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!u){const{error:m}=await this.getUser(s);if(m)throw m;return{data:{claims:a,header:n,signature:i},error:null}}const d=w5(n.alg),f=await crypto.subtle.importKey("jwk",u,d,!0,["verify"]);if(!await crypto.subtle.verify(d,f,i,i5(`${l}.${c}`)))throw new _m("Invalid JWT signature");return{data:{claims:a,header:n,signature:i},error:null}}catch(s){if(Le(s))return this._returnResult({data:null,error:s});throw s}}}nc.nextInstanceID={};const J5=nc;class Z5 extends J5{constructor(t){super(t)}}class eR{constructor(t,r,s){var n,a,i;this.supabaseUrl=t,this.supabaseKey=r;const l=HP(t);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,u={db:MP,realtime:UP,auth:Object.assign(Object.assign({},BP),{storageKey:c}),global:LP},d=qP(s??{},u);this.storageKey=(n=d.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(a=d.global.headers)!==null&&a!==void 0?a:{},d.accessToken?(this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(f,h)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(h)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((i=d.auth)!==null&&i!==void 0?i:{},this.headers,d.global.fetch),this.fetch=VP(r,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.accessToken&&this.accessToken().then(f=>this.realtime.setAuth(f)).catch(f=>console.warn("Failed to set initial Realtime auth token:",f)),this.rest=new GF(new URL("rest/v1",l).href,{headers:this.headers,schema:d.db.schema,fetch:this.fetch}),this.storage=new IP(this.storageUrl.href,this.headers,this.fetch,s==null?void 0:s.storage),d.accessToken||this._listenForAuthEvents()}get functions(){return new WF(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},s={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,r,s)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var t,r;if(this.accessToken)return await this.accessToken();const{data:s}=await this.auth.getSession();return(r=(t=s.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:s,storage:n,userStorage:a,storageKey:i,flowType:l,lock:c,debug:u,throwOnError:d},f,h){const m={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Z5({url:this.authUrl.href,headers:Object.assign(Object.assign({},m),f),storageKey:i,autoRefreshToken:t,persistSession:r,detectSessionInUrl:s,storage:n,userStorage:a,flowType:l,lock:c,debug:u,throwOnError:d,fetch:h,hasCustomAuthorizationHeader:Object.keys(this.headers).some(x=>x.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new uP(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,s)=>{this._handleTokenChanged(r,"CLIENT",s==null?void 0:s.access_token)})}_handleTokenChanged(t,r,s){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==s?(this.changedAccessToken=s,this.realtime.setAuth(s)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const tR=(e,t,r)=>new eR(e,t,r);function rR(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}rR()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const sR="https://cbankidsdfsvsgfygbzt.supabase.co",nR="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNiYW5raWRzZGZzdnNnZnlnYnp0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMzMTk3NDgsImV4cCI6MjA3ODg5NTc0OH0.SXgc-9ZamplKeJm5_nl8J2-UzO7A0f8KbAnPZEmsiSo",ie=tR(sR,nR,{auth:{persistSession:!0,autoRefreshToken:!0}}),aR=["your-email@domain.com","backup@domain.com"];function Lk(e){return e?aR.includes(e.toLowerCase()):!1}async function iR(e,t,r,s){const{data:{session:n}}=await ie.auth.getSession();if(!n||!Lk(n.user.email)){console.warn("Attempted admin action without super admin access");return}try{const{error:a}=await ie.rpc("log_admin_action",{p_admin_email:n.user.email,p_action:e,p_target_type:t||null,p_target_id:r||null,p_details:s||{}});a&&console.error("Failed to log admin action:",a)}catch(a){console.error("Error logging admin action:",a)}}async function oR(){const{data:e,error:t}=await ie.from("admin_organisations_dashboard").select("*").order("created_at",{ascending:!1});if(t)throw t;return e||[]}async function lR(e){let t=ie.from("admin_global_quotes").select("*").order("created_at",{ascending:!1});const{data:r,error:s}=await t.limit(1e3);if(s)throw s;return r||[]}async function cR(e,t){const{data:{session:r}}=await ie.auth.getSession();if(!(r!=null&&r.user.email))throw new Error("Not authenticated");const{data:s,error:n}=await ie.rpc("admin_extend_trial",{p_admin_email:r.user.email,p_org_id:e,p_days:t});if(n)throw n;return{success:s.success,newTrialEndDate:s.new_trial_end_date}}async function uR(e,t){const{data:{session:r}}=await ie.auth.getSession();if(!(r!=null&&r.user.email))throw new Error("Not authenticated");const{data:s,error:n}=await ie.rpc("admin_update_subscription",{p_admin_email:r.user.email,p_org_id:e,p_new_status:t});if(n)throw n;return{success:s.success,newStatus:s.new_status}}async function dR(e){await iR("impersonate_org","organisation",e),localStorage.setItem("admin_impersonate_org",e),window.location.href="/dashboard"}async function fR(){localStorage.removeItem("admin_impersonate_org"),window.location.href="/admin/dashboard"}function hR(){return localStorage.getItem("admin_impersonate_org")}function mR(){return!!localStorage.getItem("admin_impersonate_org")}async function pR(e,t){const{data:{session:r}}=await ie.auth.getSession();if(!(r!=null&&r.user.email))throw new Error("Not authenticated");const{data:s,error:n}=await ie.rpc("admin_add_trade_license",{p_admin_email:r.user.email,p_org_id:e,p_trade:t});if(n)throw n;return{success:s.success,message:s.message,licensedTrades:s.licensed_trades}}async function xR(e,t){const{data:{session:r}}=await ie.auth.getSession();if(!(r!=null&&r.user.email))throw new Error("Not authenticated");const{data:s,error:n}=await ie.rpc("admin_remove_trade_license",{p_admin_email:r.user.email,p_org_id:e,p_trade:t});if(n)throw n;return{success:s.success,message:s.message,licensedTrades:s.licensed_trades}}const Sx={passive_fire:"PassiveFire Verify+",electrical:"Electrical Verify+",plumbing:"Plumbing Verify+",mechanical:"Mechanical Verify+",other:"Other"},Hs=[{value:"passive_fire",label:"PassiveFire Verify+",price:299,color:"orange"},{value:"electrical",label:"Electrical Verify+",price:349,color:"yellow"},{value:"plumbing",label:"Plumbing Verify+",price:329,color:"blue"},{value:"mechanical",label:"Mechanical Verify+",price:399,color:"green"}];function gR({currentTrades:e,subscriptionStatus:t,onDismiss:r}){const[s,n]=j.useState(!1);if(s||e.length>=4||t==="trial")return null;const a=Hs.filter(m=>!e.includes(m.value));if(a.length===0)return null;const i=()=>{const m=e.reduce((x,p)=>{const g=Hs.find(w=>w.value===p);return x+((g==null?void 0:g.price)||0)},0);return e.length===2?m*.85:e.length===3?m*.75:m},l=m=>{const x=e.length+m,p=e.reduce((g,w)=>{const v=Hs.find(y=>y.value===w);return g+((v==null?void 0:v.price)||0)},0)+a.slice(0,m).reduce((g,w)=>g+w.price,0);return x===2?p*.85:x===3?p*.75:x>=4?p*.65:p},c=i(),u=l(a.length),d=u-c,f=()=>{n(!0),r&&r()},h=()=>{alert(`Contact your account manager to add trades to your license.

Or email: support@verifyhub.com`)};return o.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 text-white px-6 py-4 shadow-lg",children:o.jsxs("div",{className:"max-w-7xl mx-auto flex items-center justify-between gap-4",children:[o.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[o.jsx("div",{className:"hidden md:flex items-center justify-center w-12 h-12 bg-white/20 rounded-full",children:o.jsx(Ao,{size:24})}),o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"font-bold text-lg mb-1",children:["Unlock ",a.length," More Trade",a.length>1?"s":""]}),o.jsxs("div",{className:"text-blue-100 text-sm",children:["Add ",a.slice(0,3).map(m=>{var x;return(x=Sx[m.value])==null?void 0:x.replace(" Verify+","")}).join(", "),a.length>3&&` + ${a.length-3} more`," ","for only ",o.jsxs("span",{className:"font-bold text-white",children:["$",Math.round(d),"/mo more"]})," "," Total $",Math.round(u),"/mo",e.length+a.length>=4&&o.jsx("span",{className:"ml-1",children:"(35% bundle discount)"})]})]})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("button",{onClick:h,className:"px-6 py-2 bg-white text-blue-700 rounded-md hover:bg-blue-50 font-semibold transition-colors whitespace-nowrap",children:"Upgrade Now"}),o.jsx("button",{onClick:f,className:"p-2 hover:bg-white/10 rounded transition-colors",title:"Dismiss",children:o.jsx(ps,{size:20})})]})]})})}const Mk=j.createContext(void 0);function vR({children:e}){const[t,r]=j.useState(null),[s,n]=j.useState([]),[a,i]=j.useState(!0);j.useEffect(()=>{l()},[]);const l=async()=>{i(!0);const{data:{user:f}}=await ie.auth.getUser();if(!f){i(!1);return}const h=hR();if(h){const{data:x}=await ie.from("organisations").select("*").eq("id",h).single();if(x){n([x]),r(x),i(!1);return}}const{data:m}=await ie.from("organisation_members").select("organisation_id, organisations(*)").eq("user_id",f.id);if(m){const x=m.map(g=>g.organisations).filter(Boolean);n(x);const p=localStorage.getItem("passivefire_current_organisation_id");if(p){const g=x.find(w=>w.id===p);g?r(g):x.length>0&&(r(x[0]),localStorage.setItem("passivefire_current_organisation_id",x[0].id))}else x.length>0&&(r(x[0]),localStorage.setItem("passivefire_current_organisation_id",x[0].id))}i(!1)},c=async()=>{await l()},u=f=>{r(f),f?localStorage.setItem("passivefire_current_organisation_id",f.id):localStorage.removeItem("passivefire_current_organisation_id")},d=f=>!0;return o.jsx(Mk.Provider,{value:{currentOrganisation:t,organisations:s,loading:a,setCurrentOrganisation:u,refreshOrganisations:c,hasPermission:d},children:e})}function wa(){const e=j.useContext(Mk);if(e===void 0)throw new Error("useOrganisation must be used within an OrganisationProvider");return e}const yR=[{id:"dashboard",label:"Project Dashboard",icon:am},{id:"quotes",label:"Import Quotes",icon:Tr},{id:"review",label:"Review & Clean",icon:yF},{id:"quoteintel",label:"Quote Intelligence",icon:u0},{id:"scope",label:"Scope Matrix",icon:jF},{id:"reports",label:"Reports",icon:mF},{id:"contract",label:"Contract Manager",icon:gF},{id:"settings",label:"Settings",icon:om,requiresManagePermission:!0}];function wR({activeTab:e,onTabChange:t}){const[r,s]=j.useState(!1),{hasPermission:n}=wa();return o.jsxs("div",{className:`${r?"w-20":"w-64"} bg-white border-r border-gray-200 flex flex-col transition-all duration-200 relative`,children:[o.jsx("div",{className:"p-4 border-b border-gray-200",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-8 h-8 bg-brand-primary rounded-lg flex items-center justify-center flex-shrink-0",children:o.jsx(NF,{className:"w-5 h-5 text-white"})}),!r&&o.jsxs("div",{children:[o.jsx("h1",{className:"text-[14px] font-bold brand-navy leading-tight",children:"PassiveFire"}),o.jsx("p",{className:"text-[11px] text-gray-600",children:"Verify+"})]})]})}),o.jsx("nav",{className:"flex-1 p-2 space-y-0.5",children:yR.map(a=>{if(a.requiresManagePermission&&!n("manage"))return null;const i=a.icon,l=e===a.id;return o.jsxs("button",{onClick:()=>t(a.id),className:`
                w-full flex items-center gap-3 px-3 py-2 rounded-md text-[14px] font-medium transition-all
                ${l?"bg-orange-50 brand-primary":"text-gray-700 hover:bg-gray-50"}
                ${r?"justify-center":""}
              `,title:r?a.label:void 0,children:[o.jsx(i,{size:18,className:"flex-shrink-0"}),!r&&o.jsx("span",{children:a.label})]},a.id)})}),o.jsx("button",{onClick:()=>s(!r),className:"absolute -right-3 top-20 w-6 h-6 bg-white border border-gray-200 rounded-full flex items-center justify-center hover:bg-gray-50 transition-colors shadow-sm",children:r?o.jsx(i0,{size:14}):o.jsx(NS,{size:14})})]})}function bR({currentProjectId:e,currentProjectName:t,onProjectChange:r,onBackToDashboard:s,notificationCount:n=0,onNavigateToAccount:a,onSwitchOrganisation:i}){const[l,c]=j.useState([]),[u,d]=j.useState(!1),[f,h]=j.useState(!1),[m,x]=j.useState(""),{currentOrganisation:p}=wa();j.useEffect(()=>{g(),w()},[p]);const g=async()=>{if(!p)return;const{data:y}=await ie.from("projects").select("id, name, client, reference").eq("organisation_id",p.id).order("updated_at",{ascending:!1});y&&c(y)},w=async()=>{const{data:y}=await ie.auth.getUser();y.user&&x(y.user.email||"")},v=async()=>{await ie.auth.signOut(),window.location.href="/"};return o.jsx("header",{className:"bg-white border-b border-gray-200 px-6 py-4",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"PassiveFire Verify+"}),p&&o.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[o.jsx(go,{size:16}),o.jsx("span",{children:p.name})]}),e&&o.jsxs("div",{className:"relative",children:[o.jsxs("button",{onClick:()=>d(!u),className:"flex items-center gap-2 px-3 py-2 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:[o.jsx("span",{className:"font-medium",children:t||"Select Project"}),o.jsx(ri,{size:16})]}),u&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>d(!1)}),o.jsx("div",{className:"absolute top-full left-0 mt-2 w-64 bg-white rounded-lg shadow-lg border border-gray-200 z-20 max-h-96 overflow-y-auto",children:o.jsxs("div",{className:"p-2",children:[o.jsx("button",{onClick:()=>{s(),d(!1)},className:"w-full text-left px-3 py-2 hover:bg-gray-100 rounded-lg text-sm font-medium text-blue-600",children:"All Projects"}),o.jsx("div",{className:"border-t border-gray-200 my-2"}),l.map(y=>o.jsxs("button",{onClick:()=>{r(y.id),d(!1)},className:`w-full text-left px-3 py-2 hover:bg-gray-100 rounded-lg text-sm ${y.id===e?"bg-blue-50 text-blue-600":""}`,children:[o.jsx("div",{className:"font-medium",children:y.name}),y.client&&o.jsx("div",{className:"text-xs text-gray-500",children:y.client})]},y.id))]})})]})]})]}),o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsxs("button",{className:"relative p-2 hover:bg-gray-100 rounded-lg transition-colors",children:[o.jsx(pF,{size:20}),n>0&&o.jsx("span",{className:"absolute top-1 right-1 w-4 h-4 bg-red-500 text-white text-xs rounded-full flex items-center justify-center",children:n})]}),o.jsxs("div",{className:"relative",children:[o.jsxs("button",{onClick:()=>h(!f),className:"flex items-center gap-2 p-2 hover:bg-gray-100 rounded-lg transition-colors",children:[o.jsx(hx,{size:20}),o.jsx(ri,{size:16})]}),f&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>h(!1)}),o.jsxs("div",{className:"absolute top-full right-0 mt-2 w-64 bg-white rounded-lg shadow-lg border border-gray-200 z-20",children:[o.jsxs("div",{className:"p-4 border-b border-gray-200",children:[o.jsx("div",{className:"text-sm font-medium text-gray-900",children:m}),p&&o.jsx("div",{className:"text-xs text-gray-500 mt-1",children:p.name})]}),o.jsxs("div",{className:"p-2",children:[o.jsx("button",{onClick:()=>{a(),h(!1)},className:"w-full text-left px-3 py-2 hover:bg-gray-100 rounded-lg text-sm",children:"Account Settings"}),o.jsx("button",{onClick:()=>{i(),h(!1)},className:"w-full text-left px-3 py-2 hover:bg-gray-100 rounded-lg text-sm",children:"Switch Organisation"}),o.jsx("div",{className:"border-t border-gray-200 my-2"}),o.jsx("button",{onClick:v,className:"w-full text-left px-3 py-2 hover:bg-gray-100 rounded-lg text-sm text-red-600",children:"Sign Out"})]})]})]})]})]})]})})}function ua({title:e,subtitle:t,metadata:r}){return o.jsxs("div",{className:"flex items-start justify-between mb-3",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-[30px] font-bold text-gray-900 mb-1",children:e}),o.jsx("p",{className:"text-[14px] text-gray-600",children:t})]}),r&&r.length>0&&o.jsx("div",{className:"flex items-center gap-2",children:r.map((s,n)=>o.jsxs("div",{className:"px-3 py-1.5 rounded-full bg-gray-100 border border-gray-200 text-xs",children:[o.jsxs("span",{className:"text-gray-600",children:[s.label,":"]})," ",o.jsx("span",{className:"font-medium text-gray-900",children:s.value})]},n))})]})}function tn({projectId:e,projectName:t,allProjects:r,onProjectSelect:s,onCreateProject:n,onNavigateToQuotes:a,onNavigateToMatrix:i,onNavigateToReports:l}){const{currentOrganisation:c}=wa(),[u,d]=j.useState(!1),[f,h]=j.useState(""),[m,x]=j.useState(""),[p,g]=j.useState(""),[w,v]=j.useState(!1),[y,b]=j.useState(!0),[S,_]=j.useState({quoteCount:0,supplierCount:0,systemsDetected:0,systemsCovered:0,coveragePercent:0,completedSteps:0,totalSteps:6,hasQuotes:!1,hasReviewedItems:!1,hasScopeMatrix:!1,hasReports:!1}),[k,E]=j.useState([]);j.useEffect(()=>{e?T():b(!1)},[e]);const T=async()=>{if(e){b(!0);try{const{data:Y}=await ie.from("quotes").select("id, supplier_name").eq("project_id",e),G=(Y==null?void 0:Y.length)||0,ce=new Set(Y==null?void 0:Y.map(pe=>pe.supplier_name)).size,{data:Q}=await ie.from("quote_items").select("system_id, quote_id").in("quote_id",(Y==null?void 0:Y.map(pe=>pe.id))||[]),B=(Q==null?void 0:Q.filter(pe=>pe.system_id).map(pe=>pe.system_id))||[],fe=new Set(B).size,V=new Set((Q==null?void 0:Q.filter(pe=>pe.system_id).map(pe=>pe.system_id))||[]).size,L=fe>0?Math.round(V/fe*100):0,{data:U}=await ie.from("project_settings").select("*").eq("project_id",e).maybeSingle(),{data:ne}=await ie.from("award_reports").select("id").eq("project_id",e).eq("status","ready"),xe={quoteCount:G,supplierCount:ce,systemsDetected:fe,systemsCovered:V,coveragePercent:L,completedSteps:0,totalSteps:6,hasQuotes:G>0,hasReviewedItems:(U==null?void 0:U.review_clean_completed)||!1,hasScopeMatrix:(U==null?void 0:U.scope_matrix_completed)||!1,hasReports:((ne==null?void 0:ne.length)||0)>0};_(xe),M(xe)}catch(Y){console.error("Error loading project data:",Y)}finally{b(!1)}}},M=Y=>{const G=[{id:"import",name:"Import Quotes",status:Y.hasQuotes?"completed":"not_started",route:"quotes"},{id:"review",name:"Review & Clean",status:Y.hasReviewedItems?"completed":Y.hasQuotes?"in_progress":"not_started",route:"review-clean"},{id:"intelligence",name:"Quote Intelligence",status:Y.hasReviewedItems?"completed":"not_started",route:"quote-intelligence"},{id:"matrix",name:"Scope Matrix",status:Y.hasScopeMatrix?"completed":Y.hasReviewedItems?"in_progress":"not_started",route:"scope-matrix"},{id:"reports",name:"Reports",status:Y.hasReports?"completed":"not_started",route:"reports"}],ce=G.filter(Q=>Q.status==="completed").length;_(Q=>({...Q,completedSteps:ce})),E(G)},q=Y=>{switch(Y){case"quotes":a();break;case"scope-matrix":i();break;case"reports":l();break;default:console.log("Navigation to",Y,"not yet implemented")}},D=()=>{d(!0)},W=()=>{d(!1),h(""),x(""),g("")},ee=async Y=>{if(Y.preventDefault(),!f.trim())return;v(!0);const G=await n(f,m,p);v(!1),G&&W()};return o.jsx("div",{className:"min-h-screen bg-gray-50",children:o.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-6",children:[e&&o.jsx("div",{className:"mb-3",children:o.jsxs("div",{className:"text-xs text-gray-500 mb-1",children:["Projects > ",t]})}),o.jsx(ua,{title:e?t||"Project Dashboard":"All Projects",subtitle:e?"Manage your quote analysis workflow":"Select or create a project"}),e?y?o.jsx("div",{className:"flex items-center justify-center py-12",children:o.jsx("div",{className:"text-gray-400",children:"Loading project dashboard..."})}):o.jsxs("div",{className:"mt-3 space-y-3",children:[o.jsxs("div",{className:"flex items-center justify-between py-2 px-4 bg-white border-b border-gray-200",children:[o.jsxs("div",{className:"flex items-center gap-2 text-[13px] text-gray-600",children:[o.jsx(go,{size:14}),o.jsx("span",{children:(c==null?void 0:c.name)||"Loading..."})]}),o.jsxs("div",{className:"flex items-center gap-2 text-[13px] text-gray-500",children:[o.jsx(o0,{size:13}),o.jsxs("span",{children:["Last updated: ",new Date().toLocaleDateString()]})]})]}),o.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3",children:[o.jsxs("div",{className:"flex items-center gap-3 py-2 px-3 bg-gray-50 rounded-lg",children:[o.jsx("div",{className:"p-2 bg-blue-50 rounded",children:o.jsx(Tr,{className:"text-blue-600",size:18})}),o.jsxs("div",{children:[o.jsx("div",{className:"text-[13px] text-gray-600 font-medium",children:"Quotes Imported"}),o.jsx("div",{className:"text-2xl font-bold text-gray-900",children:S.quoteCount}),o.jsxs("div",{className:"text-[11px] text-gray-500",children:["from ",S.supplierCount," ",S.supplierCount===1?"supplier":"suppliers"]})]})]}),o.jsxs("div",{className:"flex items-center gap-3 py-2 px-3 bg-gray-50 rounded-lg",children:[o.jsx("div",{className:"p-2 bg-violet-50 rounded",children:o.jsx(AF,{className:"text-violet-600",size:18})}),o.jsxs("div",{children:[o.jsx("div",{className:"text-[13px] text-gray-600 font-medium",children:"Systems Detected"}),o.jsx("div",{className:"text-2xl font-bold text-gray-900",children:S.systemsDetected}),o.jsx("div",{className:"text-[11px] text-gray-500",children:"Unique systems in project"})]})]}),o.jsxs("div",{className:"flex items-center gap-3 py-2 px-3 bg-gray-50 rounded-lg",children:[o.jsx("div",{className:`p-2 rounded ${S.coveragePercent>=80?"bg-green-50":S.coveragePercent>=50?"bg-amber-50":"bg-red-50"}`,children:o.jsx(lm,{className:S.coveragePercent>=80?"text-green-600":S.coveragePercent>=50?"text-amber-600":"text-red-600",size:18})}),o.jsxs("div",{children:[o.jsx("div",{className:"text-[13px] text-gray-600 font-medium",children:"Coverage"}),o.jsxs("div",{className:`text-2xl font-bold ${S.coveragePercent>=80?"text-green-600":S.coveragePercent>=50?"text-amber-600":"text-red-600"}`,children:[S.coveragePercent,"%"]}),o.jsxs("div",{className:"text-[11px] text-gray-500",children:[S.systemsCovered,"/",S.systemsDetected," systems covered"]})]})]}),o.jsxs("div",{className:"flex items-center gap-3 py-2 px-3 bg-gray-50 rounded-lg",children:[o.jsx("div",{className:"p-2 bg-blue-50 rounded",children:o.jsx(Yt,{className:"text-blue-600",size:18})}),o.jsxs("div",{children:[o.jsx("div",{className:"text-[13px] text-gray-600 font-medium",children:"Progress"}),o.jsxs("div",{className:"text-2xl font-bold text-gray-900",children:[S.completedSteps,"/",S.totalSteps]}),o.jsx("div",{className:"text-[11px] text-gray-500",children:"Steps completed"})]})]})]})}),o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200",children:[o.jsx("div",{className:"px-4 py-3 border-b border-gray-200",children:o.jsx("h2",{className:"text-[20px] font-semibold text-gray-900",children:"Project Workflow"})}),o.jsx("div",{children:k.map((Y,G)=>{const ce=Y.status==="completed",Q=!ce;return o.jsxs("div",{onClick:Q?()=>q(Y.route):void 0,className:`w-full flex items-center gap-3 py-3 px-4 border-b border-gray-100 last:border-b-0 ${Q?"cursor-pointer hover:bg-gray-50 group":"cursor-default"} transition-colors`,children:[ce?o.jsx(Yt,{size:16,className:"text-green-600 flex-shrink-0"}):o.jsx("div",{className:"flex items-center justify-center w-6 h-6 rounded-full bg-gray-100 text-[11px] font-semibold text-gray-600 group-hover:bg-blue-100 group-hover:text-blue-600 transition-colors flex-shrink-0",children:G+1}),o.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[Y.status==="in_progress"?o.jsx(zy,{className:"text-blue-600 fill-blue-100 flex-shrink-0",size:18}):Y.status==="not_started"?o.jsx(zy,{className:"text-gray-400 flex-shrink-0",size:18}):null,o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:"font-medium text-gray-900 text-[15px]",children:Y.name}),o.jsx("div",{className:"text-[11px] text-gray-500 capitalize",children:Y.status.replace("_"," ")})]})]}),Q&&o.jsx(Wu,{className:"text-gray-400 group-hover:text-blue-600 transition-colors flex-shrink-0",size:14})]},Y.id)})})]})]}):o.jsxs("div",{className:"mt-6",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[o.jsxs("button",{onClick:D,className:"p-6 border-2 border-dashed border-gray-300 rounded-xl hover:border-blue-500 hover:bg-blue-50 transition-colors",children:[o.jsx(l0,{className:"mx-auto mb-2 text-gray-400",size:32}),o.jsx("div",{className:"font-medium",children:"Create New Project"})]}),r.map(Y=>o.jsxs("button",{onClick:()=>s(Y.id),className:"p-6 bg-white border border-gray-200 rounded-xl hover:border-blue-500 hover:shadow-lg transition-all text-left",children:[o.jsx(TS,{className:"mb-2 text-blue-600",size:24}),o.jsx("div",{className:"font-semibold text-gray-900 mb-1",children:Y.name}),o.jsx("div",{className:"text-sm text-gray-500",children:Y.client_reference})]},Y.id))]}),u&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 w-full max-w-md",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Create New Project"}),o.jsx("button",{onClick:W,className:"text-gray-400 hover:text-gray-600 transition-colors",children:o.jsx(ps,{size:24})})]}),o.jsxs("form",{onSubmit:ee,children:[o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsxs("label",{htmlFor:"projectName",className:"block text-sm font-medium text-gray-700 mb-1",children:["Project Name ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{id:"projectName",type:"text",value:f,onChange:Y=>h(Y.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white text-gray-900",placeholder:"Enter project name",required:!0,autoFocus:!0})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"projectClient",className:"block text-sm font-medium text-gray-700 mb-1",children:"Client Name"}),o.jsx("input",{id:"projectClient",type:"text",value:m,onChange:Y=>x(Y.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white text-gray-900",placeholder:"Enter client name"})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"projectReference",className:"block text-sm font-medium text-gray-700 mb-1",children:"Project Reference"}),o.jsx("input",{id:"projectReference",type:"text",value:p,onChange:Y=>g(Y.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white text-gray-900",placeholder:"Enter project reference"})]})]}),o.jsxs("div",{className:"flex gap-3 mt-6",children:[o.jsx("button",{type:"button",onClick:W,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",disabled:w,children:"Cancel"}),o.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed",disabled:w||!f.trim(),children:w?"Creating...":"Create Project"})]})]})]})})]})]})})}async function _R(e){return console.log("PDF Parser not fully implemented",e.name),{pages:[],text:"",metadata:{}}}async function SR(e){return console.log("Excel Parser not fully implemented",e.name),{sheets:[],data:[]}}async function kR(e){return console.log("CSV Parser not fully implemented",e.name),{data:[]}}function NR({value:e,onChange:t,error:r}){return o.jsxs("div",{className:"w-full",children:[o.jsx("input",{type:"text",value:e,onChange:s=>t(s.target.value),placeholder:"Supplier name...",className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 bg-white text-gray-900 ${r?"border-red-500":"border-gray-300"}`}),r&&o.jsx("p",{className:"text-sm text-red-500 mt-1",children:r})]})}const ER=[{name:"Electrical Services",enabled:!0,count:0},{name:"Fire Protection Services",enabled:!0,count:0},{name:"Hydraulics Services",enabled:!0,count:0},{name:"Mechanical Services",enabled:!0,count:0},{name:"Structural Penetrations",enabled:!0,count:0},{name:"Passive Fire (General)",enabled:!0,count:0},{name:"Optional Extras",enabled:!1,count:0},{name:"Excluded",enabled:!1,count:0},{name:"Summary Blocks",enabled:!1,count:0},{name:"Admin / Notes / T&Cs",enabled:!1,count:0}];function jR({projectId:e,lines:t,summaryBlocks:r,supplierName:s,onSupplierNameChange:n,onLineUpdate:a,onSave:i,onCancel:l,isSaving:c=!1,demoMode:u=!1}){console.log("[ImportPreviewNew] Rendering with",t.length,"lines"),console.log("[ImportPreviewNew] Supplier name:",s);const[d,f]=j.useState(()=>{const W=new Set(t.map(ee=>ee.section));return console.log("[ImportPreviewNew] All unique sections in lines:",Array.from(W)),console.log("[ImportPreviewNew] Lines sample:",t.slice(0,5).map(ee=>({section:ee.section,desc:ee.description.substring(0,50)}))),ER.map(ee=>{const Y=t.filter(G=>G.section===ee.name).length;return console.log(`[ImportPreviewNew] Section "${ee.name}": ${Y} items`),{...ee,count:Y}})}),[h,m]=j.useState(!1),[x,p]=j.useState(null),[g,w]=j.useState({}),[v,y]=j.useState(!0),b=j.useMemo(()=>{let W=t.filter(ee=>{const Y=d.find(G=>G.name===ee.section);return(Y==null?void 0:Y.enabled)??!1});return h&&(W=W.filter(ee=>ee.flags.length>0)),W.sort((ee,Y)=>ee.flags.length>0&&Y.flags.length===0?-1:ee.flags.length===0&&Y.flags.length>0?1:0)},[t,d,h]),S=j.useMemo(()=>{const W=t.filter(ce=>ce.flags.length===0).length,ee=t.filter(ce=>ce.flags.length>0).length,Y=t.filter(ce=>!ce.unit||!ce.size||!ce.qty).length,G=b.reduce((ce,Q)=>ce+(Q.total||0),0);return{detectedLines:W,flaggedLines:ee,gapLines:Y,selectedCount:b.length,selectedSum:G}},[t,b]),_=W=>{f(ee=>ee.map(Y=>Y.name===W?{...Y,enabled:!Y.enabled}:Y))},k=()=>{f(W=>W.map(ee=>({...ee,enabled:!0})))},E=()=>{f(W=>W.map(ee=>({...ee,enabled:!1})))},T=W=>{p(W.id),w({...W})},M=()=>{x&&g&&(a(x,g),p(null),w({}))},q=()=>{p(null),w({})},D=()=>{i(b)};return o.jsxs("div",{className:"flex gap-6 h-[calc(100vh-12rem)]",children:[o.jsxs("div",{className:"w-64 flex-shrink-0 bg-white rounded-lg shadow-sm border border-gray-200 p-4 overflow-y-auto",children:[o.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-4",children:"Include in schedule"}),o.jsx("div",{className:"space-y-2",children:d.map(W=>o.jsxs("label",{className:"flex items-center justify-between p-2 hover:bg-gray-50 rounded cursor-pointer group",children:[o.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[o.jsx("input",{type:"checkbox",checked:W.enabled,onChange:()=>_(W.name),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500 flex-shrink-0"}),o.jsx("span",{className:"text-xs text-gray-700 truncate",title:W.name,children:W.name})]}),o.jsx("span",{className:"text-xs font-medium text-gray-500 ml-2 flex-shrink-0",children:W.count})]},W.name))})]}),o.jsxs("div",{className:"flex-1 flex flex-col min-w-0 gap-4",children:[o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:[o.jsx("div",{className:"flex items-center justify-between mb-4",children:o.jsx("div",{className:"flex-1 max-w-md",children:o.jsx(NR,{projectId:e,value:s,onChange:n,error:!s.trim()&&b.length>0?"Supplier name is required":void 0})})}),o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-green-50 border border-green-200 rounded-md",children:[o.jsx(Yt,{size:16,className:"text-green-600"}),o.jsxs("span",{className:"text-sm font-medium text-green-900",children:[S.detectedLines," Detected"]})]}),o.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-amber-50 border border-amber-200 rounded-md",children:[o.jsx(Je,{size:16,className:"text-amber-600"}),o.jsxs("span",{className:"text-sm font-medium text-amber-900",children:[S.flaggedLines," Flagged"]})]}),o.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-blue-50 border border-blue-200 rounded-md",children:[o.jsx(jS,{size:16,className:"text-blue-600"}),o.jsxs("span",{className:"text-sm font-medium text-blue-900",children:[S.gapLines," Gaps"]})]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("button",{onClick:k,className:"px-3 py-1.5 text-xs font-medium text-blue-600 hover:bg-blue-50 rounded-md transition-colors",children:"Select All"}),o.jsx("button",{onClick:E,className:"px-3 py-1.5 text-xs font-medium text-gray-600 hover:bg-gray-50 rounded-md transition-colors",children:"Select None"}),o.jsx("button",{onClick:()=>m(!h),className:`px-3 py-1.5 text-xs font-medium rounded-md transition-colors ${h?"bg-amber-100 text-amber-900":"text-gray-600 hover:bg-gray-50"}`,children:"Show Flagged Only"})]})]})]}),o.jsx("div",{className:"flex-1 bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden flex flex-col",children:o.jsx("div",{className:"flex-1 overflow-auto",children:o.jsxs("table",{className:"w-full",children:[o.jsx("thead",{className:"bg-gray-50 border-b border-gray-200 sticky top-0",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Section"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Description"}),o.jsx("th",{className:"px-3 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Qty"}),o.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Unit"}),o.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Rate"}),o.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Total"}),o.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Flags"}),o.jsx("th",{className:"px-3 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),o.jsx("tbody",{className:"divide-y divide-gray-200",children:b.map(W=>o.jsx("tr",{className:`${W.flags.length>0?"bg-amber-50":""} ${x===W.id?"bg-blue-50":""}`,children:x===W.id?o.jsxs(o.Fragment,{children:[o.jsx("td",{className:"px-3 py-2",children:o.jsx("input",{type:"text",value:g.section||"",onChange:ee=>w({...g,section:ee.target.value}),className:"w-full px-2 py-1 border border-gray-300 rounded text-xs"})}),o.jsx("td",{className:"px-4 py-2",children:o.jsx("input",{type:"text",value:g.description||"",onChange:ee=>w({...g,description:ee.target.value}),className:"w-full px-2 py-1 border border-gray-300 rounded text-xs"})}),o.jsx("td",{className:"px-3 py-2",children:o.jsx("input",{type:"number",value:g.qty||"",onChange:ee=>w({...g,qty:parseFloat(ee.target.value)||void 0}),className:"w-16 px-2 py-1 border border-gray-300 rounded text-xs text-right"})}),o.jsx("td",{className:"px-3 py-2",children:o.jsx("input",{type:"text",value:g.unit||"",onChange:ee=>w({...g,unit:ee.target.value}),className:"w-16 px-2 py-1 border border-gray-300 rounded text-xs"})}),o.jsx("td",{className:"px-4 py-2",children:o.jsx("input",{type:"number",value:g.rate||"",onChange:ee=>w({...g,rate:parseFloat(ee.target.value)||void 0}),className:"w-20 px-2 py-1 border border-gray-300 rounded text-xs text-right"})}),o.jsx("td",{className:"px-4 py-2",children:o.jsx("input",{type:"number",value:g.total||"",onChange:ee=>w({...g,total:parseFloat(ee.target.value)||void 0}),className:"w-20 px-2 py-1 border border-gray-300 rounded text-xs text-right"})}),o.jsx("td",{className:"px-3 py-2"}),o.jsx("td",{className:"px-3 py-2",children:o.jsxs("div",{className:"flex items-center justify-center gap-1",children:[o.jsx("button",{onClick:M,className:"p-1 text-green-600 hover:bg-green-50 rounded",title:"Save",children:o.jsx(im,{size:14})}),o.jsx("button",{onClick:q,className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"Cancel",children:o.jsx(ps,{size:14})})]})})]}):o.jsxs(o.Fragment,{children:[o.jsx("td",{className:"px-3 py-2 text-xs text-gray-600",children:W.section}),o.jsx("td",{className:"px-4 py-2 text-xs text-gray-900",children:W.description}),o.jsx("td",{className:"px-3 py-2 text-xs text-gray-900 text-right",children:W.qty||"-"}),o.jsx("td",{className:"px-3 py-2 text-xs text-gray-600",children:W.unit||"-"}),o.jsx("td",{className:"px-4 py-2 text-xs text-gray-900 text-right",children:W.rate?`$${W.rate.toFixed(2)}`:"-"}),o.jsx("td",{className:"px-4 py-2 text-xs text-gray-900 text-right font-medium",children:W.total?`$${W.total.toFixed(2)}`:"-"}),o.jsx("td",{className:"px-3 py-2",children:o.jsx("div",{className:"flex flex-wrap gap-1",children:W.flags.map((ee,Y)=>o.jsx("span",{className:"px-1.5 py-0.5 text-[10px] font-medium bg-amber-100 text-amber-800 rounded",children:ee},Y))})}),o.jsx("td",{className:"px-3 py-2",children:o.jsx("button",{onClick:()=>T(W),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",title:"Edit",children:o.jsx(AS,{size:14})})})]})},W.id))})]})})}),o.jsxs("div",{className:"flex items-center justify-between bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:[o.jsxs("div",{className:"flex items-center gap-6",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-xs text-gray-500",children:"Selected Lines"}),o.jsx("p",{className:"text-lg font-bold text-gray-900",children:S.selectedCount})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-xs text-gray-500",children:"Selected Sum"}),o.jsxs("p",{className:"text-lg font-bold text-green-600",children:["$",S.selectedSum.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("button",{onClick:l,className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 transition-colors",children:"Cancel"}),o.jsxs("button",{onClick:D,disabled:!s.trim()||b.length===0||c||u,className:"flex items-center gap-2 px-8 py-3 bg-gradient-to-r from-green-600 to-green-500 text-white text-lg font-bold rounded-lg hover:from-green-700 hover:to-green-600 shadow-lg hover:shadow-xl transition-all disabled:bg-gray-400 disabled:cursor-not-allowed transform hover:scale-105",children:[o.jsx(dx,{size:20}),c?"Saving...":u?"Demo Mode":"Proceed with Mapping"]})]})]})]}),r.length>0&&o.jsxs("div",{className:"w-64 flex-shrink-0 bg-white rounded-lg shadow-sm border border-gray-200 p-4 overflow-y-auto",children:[o.jsxs("button",{onClick:()=>y(!v),className:"flex items-center justify-between w-full mb-3",children:[o.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Quote Summary"}),v?o.jsx(ri,{size:16}):o.jsx(i0,{size:16})]}),v&&o.jsx("div",{className:"space-y-2",children:r.map((W,ee)=>o.jsxs("div",{className:`flex justify-between items-center py-2 px-3 rounded ${W.type==="grand_total"?"bg-blue-50 border border-blue-200":"bg-gray-50"}`,children:[o.jsx("span",{className:`text-xs ${W.type==="grand_total"?"font-semibold text-gray-900":"text-gray-600"}`,children:W.label}),o.jsxs("span",{className:`text-xs font-medium ${W.type==="grand_total"?"text-blue-900":"text-gray-900"}`,children:["$",W.value.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]},ee))})]})]})}function TR({projectId:e,onJobCompleted:t}){const[r,s]=j.useState([]),[n,a]=j.useState(!0),[i,l]=j.useState(new Set);j.useEffect(()=>{c();const b=ie.channel("parsing_jobs_changes").on("postgres_changes",{event:"*",schema:"public",table:"parsing_jobs",filter:`project_id=eq.${e}`},_=>{if(_.eventType==="INSERT")s(k=>[_.new,...k]);else if(_.eventType==="UPDATE"){const k=_.new;s(E=>E.map(T=>T.id===k.id?k:T)),k.status==="completed"&&k.quote_id&&(t==null||t(k.id,k.quote_id))}else _.eventType==="DELETE"&&s(k=>k.filter(E=>E.id!==_.old.id))}).subscribe(),S=setInterval(()=>{r.some(k=>k.status==="pending"||k.status==="processing")&&c()},3e3);return()=>{b.unsubscribe(),clearInterval(S)}},[e,r]);const c=async()=>{try{const{data:b,error:S}=await ie.from("parsing_jobs").select("*").eq("project_id",e).order("created_at",{ascending:!1}).limit(20);!S&&b&&s(b)}catch(b){console.error("Error loading parsing jobs:",b)}finally{a(!1)}},u=b=>{if(b.status!=="processing")return!1;const S=new Date(b.updated_at);return(new Date().getTime()-S.getTime())/1e3/60>5},d=async b=>{l(S=>new Set(S).add(b));try{const S=await fetch("https://cbankidsdfsvsgfygbzt.supabase.co/functions/v1/resume_parsing_job",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNiYW5raWRzZGZzdnNnZnlnYnp0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMzMTk3NDgsImV4cCI6MjA3ODg5NTc0OH0.SXgc-9ZamplKeJm5_nl8J2-UzO7A0f8KbAnPZEmsiSo"},body:JSON.stringify({jobId:b})}),_=await S.json();if(!S.ok)throw new Error(_.error||"Failed to resume job");_.success&&_.quoteId?(t==null||t(b,_.quoteId),alert(_.message||`Successfully recovered ${_.recoveredItems} items`)):alert(_.message||"Job was too incomplete to recover"),await c()}catch(S){console.error("Error resuming job:",S),alert(`Failed to resume job: ${S instanceof Error?S.message:"Unknown error"}`)}finally{l(S=>{const _=new Set(S);return _.delete(b),_})}},f=()=>{const b=[],S=[],_=[],k=[];return r.forEach(E=>{var T,M;if(E.status==="pending"||E.status==="processing")k.push(E);else if(E.status==="completed"){const q=((T=E.parsed_lines)==null?void 0:T.length)||0,D=((M=E.error_message)==null?void 0:M.includes("chunks failed"))||!1;q===0?_.push(E):D?S.push(E):b.push(E)}else E.status==="failed"&&_.push(E)}),{successful:b,partial:S,failed:_,active:k}},h=b=>new Date(b).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0});if(n)return o.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:o.jsxs("div",{className:"flex items-center justify-center",children:[o.jsx(js,{className:"w-5 h-5 text-gray-400 animate-spin"}),o.jsx("span",{className:"ml-2 text-sm text-gray-600",children:"Loading jobs..."})]})});if(r.length===0)return null;const{successful:m,partial:x,failed:p,active:g}=f(),w=m.length,v=x.length,y=p.length;return o.jsxs("div",{className:"space-y-6 mb-6",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsx("div",{className:"bg-white rounded-2xl border border-gray-200 p-5 hover:shadow-md transition-shadow",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Successfully Imported"}),o.jsx("div",{className:"text-3xl font-bold text-gray-900",children:w})]}),o.jsx("div",{className:"w-12 h-12 bg-green-50 rounded-xl flex items-center justify-center",children:o.jsx(Yt,{className:"text-green-600",size:24})})]})}),o.jsx("div",{className:"bg-white rounded-2xl border border-gray-200 p-5 hover:shadow-md transition-shadow",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Partial Imports"}),o.jsx("div",{className:"text-3xl font-bold text-gray-900",children:v})]}),o.jsx("div",{className:"w-12 h-12 bg-yellow-50 rounded-xl flex items-center justify-center",children:o.jsx(_n,{className:"text-yellow-600",size:24})})]})}),o.jsx("div",{className:"bg-white rounded-2xl border border-gray-200 p-5 hover:shadow-md transition-shadow",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Failed Imports"}),o.jsx("div",{className:"text-3xl font-bold text-gray-900",children:y})]}),o.jsx("div",{className:"w-12 h-12 bg-red-50 rounded-xl flex items-center justify-center",children:o.jsx(to,{className:"text-red-600",size:24})})]})})]}),g.length>0&&o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-5",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Processing"}),o.jsx("div",{className:"space-y-2",children:g.map(b=>o.jsxs("div",{className:"flex items-center gap-3 py-2 px-3 bg-blue-50 rounded-lg border border-blue-200",children:[o.jsx(js,{className:"w-4 h-4 text-blue-600 animate-spin flex-shrink-0"}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:"font-semibold text-gray-900 text-sm",children:b.supplier_name}),o.jsxs("div",{className:"text-xs text-gray-500 mt-0.5",children:["File: ",b.file_name]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-24 bg-gray-200 rounded-full h-2",children:o.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${b.progress}%`}})}),o.jsxs("span",{className:"text-xs text-gray-600 w-10 text-right",children:[b.progress,"%"]}),u(b)&&o.jsxs("button",{onClick:()=>d(b.id),disabled:i.has(b.id),className:"flex items-center gap-1 px-2 py-1 text-xs font-medium text-orange-700 bg-orange-100 hover:bg-orange-200 rounded disabled:opacity-50",children:[i.has(b.id)?o.jsx(js,{className:"w-3 h-3 animate-spin"}):o.jsx(Kr,{className:"w-3 h-3"}),"Resume"]})]})]},b.id))})]}),m.length>0&&o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-5",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Successfully Imported Quotes"}),o.jsx("div",{className:"space-y-2",children:m.map(b=>{var S;return o.jsxs("div",{className:"flex items-center gap-3 py-2 px-3 hover:bg-gray-50 rounded-lg transition-colors",children:[o.jsx(Yt,{className:"w-4 h-4 text-green-600 flex-shrink-0"}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:"font-semibold text-gray-900 text-sm",children:b.supplier_name}),o.jsxs("div",{className:"text-xs text-gray-500 mt-0.5",children:[((S=b.parsed_lines)==null?void 0:S.length)||0," items  File: ",b.file_name,"  Imported ",h(b.updated_at)]})]})]},b.id)})})]}),(x.length>0||p.length>0)&&o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-5",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Quotes With Issues"}),x.length>0&&o.jsxs("div",{className:"mb-4",children:[o.jsxs("h4",{className:"text-sm font-semibold text-yellow-900 mb-2 flex items-center gap-2",children:[o.jsx(_n,{size:16}),"Partial Imports (",x.length,")"]}),o.jsx("div",{className:"space-y-2",children:x.map(b=>{var k,E,T;const S=((k=b.parsed_lines)==null?void 0:k.length)||0,_=((T=(E=b.error_message)==null?void 0:E.match(/(\d+) chunks? failed/))==null?void 0:T[1])||"0";return o.jsx("div",{className:"border border-yellow-300 rounded-lg p-3 bg-yellow-50",children:o.jsxs("div",{className:"flex items-start justify-between",children:[o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[o.jsx(_n,{className:"w-4 h-4 text-yellow-600"}),o.jsx("span",{className:"text-sm font-semibold text-gray-900",children:b.supplier_name})]}),o.jsxs("div",{className:"text-xs text-gray-700 mb-1",children:[S," items extracted, ",_," chunks failed"]}),o.jsxs("div",{className:"text-xs text-gray-500",children:["File: ",b.file_name]})]}),o.jsxs("button",{onClick:()=>d(b.id),disabled:i.has(b.id),className:"flex items-center gap-1 px-3 py-1.5 text-xs font-medium text-yellow-700 bg-yellow-100 hover:bg-yellow-200 rounded disabled:opacity-50 border border-yellow-300",children:[i.has(b.id)?o.jsx(js,{className:"w-3 h-3 animate-spin"}):o.jsx(Kr,{className:"w-3 h-3"}),"Retry Failed"]})]})},b.id)})})]}),p.length>0&&o.jsxs("div",{children:[o.jsxs("h4",{className:"text-sm font-semibold text-red-900 mb-2 flex items-center gap-2",children:[o.jsx(to,{size:16}),"Failed Imports (",p.length,")"]}),o.jsx("div",{className:"space-y-2",children:p.map(b=>{var k;const _=(((k=b.parsed_lines)==null?void 0:k.length)||0)===0&&b.status==="completed"?"Parsed successfully but returned 0 line items":b.error_message||"Could not extract tables";return o.jsx("div",{className:"border border-red-300 rounded-lg p-3 bg-red-50",children:o.jsxs("div",{className:"flex items-start justify-between",children:[o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[o.jsx(to,{className:"w-4 h-4 text-red-600"}),o.jsx("span",{className:"text-sm font-semibold text-gray-900",children:b.supplier_name||"Unknown Supplier"})]}),o.jsxs("div",{className:"text-xs text-gray-700 mb-1",children:["Reason: ",_]}),o.jsxs("div",{className:"text-xs text-gray-500",children:["File: ",b.file_name]})]}),o.jsxs("button",{onClick:()=>d(b.id),disabled:i.has(b.id),className:"flex items-center gap-1 px-3 py-1.5 text-xs font-medium text-red-700 bg-red-100 hover:bg-red-200 rounded disabled:opacity-50 border border-red-300",children:[i.has(b.id)?o.jsx(js,{className:"w-3 h-3 animate-spin"}):o.jsx(Kr,{className:"w-3 h-3"}),"Try Again"]})]})},b.id)})})]})]})]})}function CR(e){return console.log("Quote Adapter not fully implemented"),e}function AR({projectId:e,onQuotesImported:t,onNavigateToDashboard:r}){const[s,n]=j.useState([]),[a,i]=j.useState(!1),[l,c]=j.useState(!0),[u,d]=j.useState([]),[f,h]=j.useState([]),[m,x]=j.useState([]),[p,g]=j.useState(""),[w,v]=j.useState(!1),[y,b]=j.useState(null),[S,_]=j.useState(!1),[k,E]=j.useState(null),[T,M]=j.useState(0),[q,D]=j.useState(!0),[W,ee]=j.useState(null),Y=j.useRef(null);j.useEffect(()=>{e?G():D(!1)},[e]);const G=async()=>{if(e){D(!0);try{const{data:oe}=await ie.from("projects").select("id, name, client, updated_at").eq("id",e).maybeSingle();if(oe){E(oe);const{data:ue,error:we}=await ie.from("quotes").select("supplier_name").eq("project_id",e);if(!we&&ue){const P=new Set(ue.map(Me=>Me.supplier_name));M(P.size)}}}catch(oe){console.error("Error loading project info:",oe)}finally{D(!1)}}},ce=[".pdf",".xlsx",".xls",".csv","application/pdf","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","text/csv"],Q=oe=>{oe.preventDefault(),_(!0)},B=()=>{_(!1)},me=async oe=>{oe.preventDefault(),_(!1);const ue=Array.from(oe.dataTransfer.files);await A(ue)},fe=async oe=>{const ue=oe.target.files;ue&&ue.length>0&&await A(Array.from(ue))},A=async oe=>{const ue=oe.filter(P=>{var je;const Me="."+((je=P.name.split(".").pop())==null?void 0:je.toLowerCase());return ce.includes(Me)||ce.includes(P.type)});if(ue.length===0){b({type:"error",text:"No valid files selected. Please upload PDF, Excel, or CSV files."});return}n(ue);const we=ue.find(P=>P.name.toLowerCase().endsWith(".pdf"));b(we?{type:"success",text:`PDF file attached: ${we.name}. Enter supplier name and click "Parse Quote" to process with external extractor.`}:{type:"success",text:'File attached. Enter supplier name and click "Parse Quote" to continue.'})},V=async oe=>{if(!e||!p.trim()){b({type:"error",text:"Please provide a supplier name."});return}i(!0),b(null);try{const{data:{session:ue}}=await ie.auth.getSession();if(!ue)throw new Error("No active session");for(const we of oe){if(we.name.toLowerCase().endsWith(".pdf")){console.log(`PDF detected: ${we.name}, trying external extractor first...`);const J=new FormData;J.append("file",we),J.append("projectId",e),J.append("supplierName",p.trim());const K="https://cbankidsdfsvsgfygbzt.supabase.co/functions/v1/parse_quote_with_extractor",le={Authorization:`Bearer ${ue.access_token}`};try{const ye=await fetch(K,{method:"POST",headers:le,body:J}),Re=await ye.json();if(ye.ok&&Re.success){console.log("Extractor  Import Quotes:",Re),b({type:"success",text:`${we.name} successfully parsed using external extractor! Found ${Re.itemsCount} items. Redirecting to review...`}),n([]),g(""),await G(),t(),setTimeout(()=>{r&&r()},1500);continue}else if(Re.fallback_required)console.log("Extractor failed, falling back to background job...");else throw new Error(Re.error||"Extractor failed")}catch(ye){console.error("External extractor error, falling back to background job:",ye),b({type:"info",text:`External extractor unavailable for ${we.name}, using background parser...`})}}const je=new FormData;je.append("file",we),je.append("projectId",e),je.append("supplierName",p.trim());const X="https://cbankidsdfsvsgfygbzt.supabase.co/functions/v1/start_parsing_job",z={Authorization:`Bearer ${ue.access_token}`},H=await fetch(X,{method:"POST",headers:z,body:je});if(!H.ok){const J=await H.json();throw new Error(J.error||"Failed to start parsing job")}const Z=await H.json();b({type:"success",text:`${we.name} is being parsed in the background. You can navigate away and it will continue processing.`})}n([]),g("")}catch(ue){console.error("Background parsing error:",ue),b({type:"error",text:ue.message||"Failed to start background parsing"})}finally{i(!1)}},L=async oe=>{var ue;i(!0),b(null),d([]);try{const we=[];for(const P of oe){const Me=(ue=P.name.split(".").pop())==null?void 0:ue.toLowerCase();let je=[];try{if(Me==="pdf"?(b({type:"info",text:`Parsing PDF: ${P.name}...`}),je=await _R(P)):Me==="xlsx"||Me==="xls"?(b({type:"info",text:`Parsing Excel: ${P.name}...`}),je=await SR(P)):Me==="csv"&&(b({type:"info",text:`Parsing CSV: ${P.name}...`}),je=await kR(P)),je.length>0){const X=crypto.randomUUID();je.forEach(z=>{z.supplierId=X,z.supplierName=p.trim()}),we.push(...je)}}catch(X){console.error(`Error parsing ${P.name}:`,X),b({type:"error",text:`Failed to parse ${P.name}. The file format may not be supported or the content is unreadable.`})}}if(we.length>0){d(we);const P=CR(we);h(P),x([]),b({type:"success",text:`Successfully parsed ${we.length} line items from ${p}`})}else b({type:"error",text:"No data could be extracted from the files. Please check the file format and content."})}catch(we){console.error("Parsing error:",we),b({type:"error",text:"An error occurred while parsing the files."})}finally{i(!1)}},U=(oe,ue)=>{h(we=>we.map(P=>P.id===oe?{...P,...ue}:P))},ne=async()=>{if(!e||!p.trim()){b({type:"error",text:"Please provide a supplier name."});return}v(!0),b(null);try{const oe=f.filter(X=>X.include!==!1);if(oe.length===0){b({type:"error",text:"No items selected for import."}),v(!1);return}const{data:{session:ue}}=await ie.auth.getSession();if(!ue)throw new Error("No active session");let we=W;if(!we){const X=`https://cbankidsdfsvsgfygbzt.supabase.co/functions/v1/upload_quote/projects/${e}/quotes/upload`,z={Authorization:`Bearer ${ue.access_token}`},H=new FormData;if(s&&s.length>0)H.append("file",s[0]);else{const K=new File([""],"quote.pdf",{type:"application/pdf"});H.append("file",K)}H.append("vendorName",p);const Z=await fetch(X,{method:"POST",headers:z,body:H});if(!Z.ok){const K=await Z.json();throw new Error(`Failed to create quote: ${K.error||Z.statusText}`)}we=(await Z.json()).quoteId,ee(we)}const P=`https://cbankidsdfsvsgfygbzt.supabase.co/functions/v1/apply_selections/projects/${e}/selections/apply`,Me={Authorization:`Bearer ${ue.access_token}`,"Content-Type":"application/json"},je=await fetch(P,{method:"POST",headers:Me,body:JSON.stringify({quoteId:we,items:oe.map(X=>({lineId:X.id,mapKey:X.normalised_key||"",description:X.description,qty:X.qty||0,unit:X.unit||"",unitPrice:X.unit_price||0,total:X.total||0}))})});if(!je.ok){const X=await je.json();throw new Error(`Failed to apply selections: ${X.error||je.statusText}`)}b({type:"success",text:`Successfully saved ${oe.length} items!`}),n([]),d([]),h([]),x([]),g(""),ee(null),await G(),t(),setTimeout(()=>{r&&r()},1500)}catch(oe){console.error("Save error:",oe),b({type:"error",text:oe instanceof Error?oe.message:"Failed to save selections"})}finally{v(!1)}},xe=()=>{n([]),d([]),h([]),x([]),g(""),b(null)};if(q)return o.jsx("div",{className:"flex items-center justify-center min-h-96",children:o.jsx("div",{className:"text-gray-600",children:"Loading project information..."})});if(u.length>0)return o.jsxs("div",{className:"p-6 max-w-full",children:[o.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-5 mb-6",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-10 h-10 rounded-full bg-orange-50 flex items-center justify-center",children:o.jsx($y,{className:"text-brand-primary",size:20})}),o.jsxs("div",{children:[o.jsx("h2",{className:"text-lg font-bold text-gray-900",children:"Import Preview"}),o.jsx("p",{className:"text-sm text-gray-600",children:p||"No supplier name provided"})]})]}),o.jsx("button",{onClick:xe,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",title:"Cancel and start over",children:o.jsx(ps,{size:20})})]})}),y&&o.jsx("div",{className:`p-4 rounded-xl mb-6 ${y.type==="success"?"bg-green-50 border border-green-200":y.type==="error"?"bg-red-50 border border-red-200":"bg-blue-50 border border-blue-200"}`,children:o.jsxs("div",{className:"flex items-start gap-2",children:[o.jsx(Je,{size:18,className:`mt-0.5 flex-shrink-0 ${y.type==="success"?"text-green-600":y.type==="error"?"text-red-600":"text-blue-600"}`}),o.jsx("span",{className:y.type==="success"?"text-green-800":y.type==="error"?"text-red-800":"text-blue-800",children:y.text})]})}),o.jsx(jR,{projectId:e||"",lines:f,summaryBlocks:m,supplierName:p,onSupplierNameChange:g,onLineUpdate:U,onSave:ne,onCancel:xe,isSaving:w,demoMode:!1})]});if(!e||!k)return o.jsx("div",{className:"flex items-center justify-center min-h-96",children:o.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-8 text-center max-w-md",children:[o.jsx(Je,{className:"mx-auto mb-4 text-yellow-500",size:48}),o.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:"No Project Selected"}),o.jsx("p",{className:"text-gray-600 mb-6",children:"You need to select or create a project before importing quotes."}),o.jsx("button",{onClick:r,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm font-medium inline-flex items-center gap-2",children:"Go to Project Dashboard"})]})});const pe=[{label:"Project",value:k.name},{label:"Suppliers",value:T.toString()},{label:"Last Updated",value:new Date(k.updated_at).toLocaleDateString()}];return o.jsxs("div",{className:"p-6 max-w-full",children:[o.jsx(ua,{title:"Quotes",subtitle:"Import supplier quotes and prepare them for analysis.",metadata:pe}),e&&o.jsx(TR,{projectId:e,onJobCompleted:G}),y&&o.jsx("div",{className:`p-4 rounded-xl mb-6 ${y.type==="success"?"bg-green-50 border border-green-200":y.type==="error"?"bg-red-50 border border-red-200":"bg-blue-50 border border-blue-200"}`,children:o.jsxs("div",{className:"flex items-start gap-2",children:[y.type==="success"?o.jsx(Yt,{size:18,className:"mt-0.5 flex-shrink-0 text-green-600"}):o.jsx(Je,{size:18,className:"mt-0.5 flex-shrink-0 text-blue-600"}),o.jsx("span",{className:y.type==="success"?"text-green-800":y.type==="error"?"text-red-800":"text-blue-800",children:y.text})]})}),o.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 mb-6",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[o.jsx("div",{className:"w-10 h-10 rounded-full bg-orange-50 flex items-center justify-center",children:o.jsx(cm,{className:"text-brand-primary",size:20})}),o.jsxs("div",{children:[o.jsx("h2",{className:"text-lg font-bold text-gray-900",children:"Import Quotes"}),o.jsx("p",{className:"text-sm text-gray-600",children:"Upload PDF, Excel, or CSV files from suppliers."})]})]}),o.jsxs("div",{className:"mb-6",children:[o.jsx("label",{htmlFor:"supplier-name-input",className:"block text-sm font-medium text-gray-700 mb-2",children:"Supplier Name"}),o.jsx("input",{id:"supplier-name-input",type:"text",value:p,onChange:oe=>g(oe.target.value),placeholder:"Enter supplier name...",className:"w-full max-w-md px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#0A66C2] focus:border-[#0A66C2] transition bg-white text-gray-900"}),o.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"This name will be displayed throughout the analysis instead of the file name"})]}),o.jsx("div",{onDragOver:Q,onDragLeave:B,onDrop:me,className:`rounded-xl p-12 text-center transition-all border-2 border-dashed ${S?"border-brand-primary bg-orange-50":s.length>0?"border-green-300 bg-green-50":"border-gray-300 bg-gray-50 hover:border-gray-400"}`,children:s.length>0?o.jsxs("div",{children:[o.jsx(Yt,{className:"mx-auto mb-4 text-green-600",size:48}),o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"File Attached"}),o.jsx("p",{className:"text-sm text-gray-600 mb-4",children:s[0].name}),o.jsxs("div",{className:"flex items-center justify-center gap-3",children:[o.jsx("button",{onClick:()=>{n([]),b(null)},className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors text-sm font-medium",children:"Remove File"}),o.jsxs("button",{onClick:()=>{if(!p.trim()){b({type:"error",text:"Please enter a supplier name first."});return}l?V(s):L(s)},disabled:a||!p.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed inline-flex items-center gap-2",children:[a&&o.jsx(js,{className:"animate-spin",size:18}),a?"Starting Parse...":"Parse Quote (Background)"]})]})]}):o.jsxs(o.Fragment,{children:[o.jsx($y,{className:`mx-auto mb-4 ${S?"text-brand-primary":"text-gray-400"}`,size:48}),o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:S?"Drop file here":"Drag and drop file here"}),o.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"or click to browse"}),o.jsx("input",{ref:Y,type:"file",accept:".pdf,.xlsx,.xls,.csv",multiple:!1,onChange:fe,className:"hidden"}),o.jsx("button",{onClick:()=>{var oe;return(oe=Y.current)==null?void 0:oe.click()},disabled:a,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:"Attach File"}),o.jsx("p",{className:"text-xs text-gray-500 mt-4",children:"Supported formats: PDF, Excel (.xlsx, .xls), CSV"})]})})]}),a&&o.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-xl mb-6 p-4",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(js,{className:"animate-spin text-blue-600 flex-shrink-0",size:20}),o.jsxs("div",{children:[o.jsx("div",{className:"font-medium text-blue-900",children:"Processing Quote..."}),o.jsx("div",{className:"text-sm text-blue-700 mt-0.5",children:"Extracting and analyzing quote data. This may take a minute for complex documents."})]})]})}),o.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[o.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Import Engine Features"}),o.jsxs("ul",{className:"text-sm text-gray-600 space-y-2",children:[o.jsxs("li",{className:"flex items-start gap-2",children:[o.jsx(Yt,{size:16,className:"text-green-600 mt-0.5 flex-shrink-0"}),o.jsx("span",{children:"Automatic table detection for most supplier quote formats"})]}),o.jsxs("li",{className:"flex items-start gap-2",children:[o.jsx(Yt,{size:16,className:"text-green-600 mt-0.5 flex-shrink-0"}),o.jsx("span",{children:"Fallback text parsing when tables can't be detected"})]}),o.jsxs("li",{className:"flex items-start gap-2",children:[o.jsx(Yt,{size:16,className:"text-green-600 mt-0.5 flex-shrink-0"}),o.jsx("span",{children:"Support for multiple files per supplier"})]})]})]})]})}function FR(e){return o.jsx(AR,{...e})}const PR=[{normalized:"ea",displayName:"Each",aliases:[/^ea$/i,/^each$/i,/^nr$/i,/^no\.?$/i,/^number$/i,/^per$/i,/^item$/i,/^unit$/i,/^pce$/i,/^piece$/i]},{normalized:"m",displayName:"Square Meters",aliases:[/^m$/i,/^m2$/i,/^sqm$/i,/^sq\.?\s*m$/i,/^square\s*m(eter)?s?$/i,/^msq$/i]},{normalized:"m",displayName:"Linear Meters",aliases:[/^m$/i,/^lm$/i,/^lin\.?\s*m$/i,/^linear\s*m(eter)?s?$/i,/^metre?s?$/i,/^meter?s?$/i,/^mtrs?$/i,/^per\s*m(etre)?$/i,/^running\s*m(etre)?$/i]},{normalized:"L",displayName:"Liters",aliases:[/^l$/i,/^litre?s?$/i]},{normalized:"m",displayName:"Cubic Meters",aliases:[/^m$/i,/^m3$/i,/^cum$/i,/^cu\.?\s*m$/i,/^cubic\s*m(eter)?s?$/i]},{normalized:"hr",displayName:"Hours",aliases:[/^hr$/i,/^hrs?$/i,/^hour?s?$/i]},{normalized:"kg",displayName:"Kilograms",aliases:[/^kg$/i,/^kgs?$/i,/^kilogram?s?$/i]},{normalized:"t",displayName:"Tons",aliases:[/^t$/i,/^ton?s?$/i,/^tonne?s?$/i]},{normalized:"sum",displayName:"Sum",aliases:[/^sum$/i,/^p\.?s\.?$/i,/^prov\.?\s*sum$/i]}];function g1(e){if(!e)return{original:"",normalized:"ea",displayName:"Each",confidence:.5};const t=e.trim();if(t.length===0)return{original:e,normalized:"ea",displayName:"Each",confidence:.5};for(const r of PR)for(const s of r.aliases)if(s.test(t))return{original:e,normalized:r.normalized,displayName:r.displayName,confidence:1};return{original:e,normalized:t.toLowerCase(),displayName:t,confidence:.3}}function jf(e){if(typeof e=="number")return e;if(typeof e=="string"){const t=parseFloat(e.replace(/[^0-9.-]/g,""));return isNaN(t)?null:t}return null}function RR(e,t){return e&&t&&e!==0?t/e:null}function IR(e,t){return e&&t?e*t:null}function v1(e){if(!e||typeof e!="string")return{confidence:0};const t=e.toLowerCase();let r=0;const s={confidence:0};return s.size=OR(e),s.size&&r++,s.frr=DR(e),s.frr&&r++,s.service=LR(t),s.service&&r++,s.subclass=MR(t),s.subclass&&r++,s.material=BR(t),s.material&&r++,s.confidence=r/5,s}function OR(e){const t=[/(\d+(?:\.\d+)?)\s*(?:mm|millimeter|millimetre)/gi,/(\d+(?:\.\d+)?)\s*(?:inch|in|")/gi,/(\d+(?:\.\d+)?)\s*x\s*(\d+(?:\.\d+)?)\s*(?:mm|millimeter|millimetre|inch|in|")?/gi,/(\d+(?:\.\d+)?)\s*(?:mm|inch|in|")?\s*(?:dia|diameter||)/gi,/DN\s*(\d+)/gi,/NB\s*(\d+)/gi];for(const r of t){const s=e.match(r);if(s)return s[0].trim()}}function DR(e){const t=[/FRL\s*[-/]?\s*(\d+)(?:\s*[-/]\s*(\d+)(?:\s*[-/]\s*(\d+))?)?/gi,/(\d+)\s*[-/]\s*(\d+)\s*[-/]\s*(\d+)/g,/(\d+)\s*min(?:ute)?s?\s*fire\s*rat(?:ing|ed)/gi,/fire\s*rat(?:ing|ed)?\s*(?:of|:)?\s*(\d+)/gi,/-\/(\d+)\/(\d+)/g];for(const r of t){const s=e.match(r);if(s)return s[0].trim()}}function LR(e){const t={Electrical:["electrical","electric","power","cable","wiring","conduit"],Mechanical:["mechanical","hvac","duct","ducting","ventilation","air conditioning"],Fire:["fire","sprinkler","fire protection"],Plumbing:["plumbing","pipe","piping","water","drainage","sewer"],Data:["data","telecom","communication","network","fibre","fiber"],Gas:["gas","natural gas","lpg"]};for(const[r,s]of Object.entries(t))if(s.some(n=>e.includes(n)))return r}function MR(e){const t={Cables:["cable","cabling","wire","wiring"],Conduit:["conduit","trunking"],Ducts:["duct","ducting"],Pipes:["pipe","piping"],Tray:["tray","cable tray","ladder"],Penetration:["penetration","opening","hole","aperture"],Seal:["seal","sealing","sealant","firestop"],Batt:["batt","blanket","wrap"],Board:["board","panel"],Collar:["collar","wrap"],Block:["block","brick"],Damper:["damper","fire damper"]};for(const[r,s]of Object.entries(t))if(s.some(n=>e.includes(n)))return r}function BR(e){const t={Steel:["steel","galvanised","galvanized"],PVC:["pvc","polyvinyl"],Copper:["copper","cu"],Aluminium:["aluminium","aluminum"],Concrete:["concrete"],Plasterboard:["plasterboard","gypsum","drywall"],Ceramic:["ceramic","fibre","fiber"],Intumescent:["intumescent"],"Mineral Wool":["mineral wool","rockwool","rock wool"]};for(const[r,s]of Object.entries(t))if(s.some(n=>e.includes(n)))return r}function y1(e){let t=0;return e.qty&&e.rate&&(t+=40),e.unit&&(t+=20),e.description&&e.description.length>10&&(t+=20),e.system_id&&(t+=20),Math.min(t,100)}function UR(e){return e>=80?"text-green-600":e>=60?"text-amber-600":"text-red-600"}function zR(e){return e>=80?"High":e>=60?"Medium":"Low"}const Bk=[{id:"ELEC_CABLE_120_SM",label:"Electrical Cables - Small (FRL 120)",service:"Electrical",frr:120,size_min:0,size_max:50,subclass:"Cables"},{id:"ELEC_CABLE_120_MD",label:"Electrical Cables - Medium (FRL 120)",service:"Electrical",frr:120,size_min:51,size_max:150,subclass:"Cables"},{id:"ELEC_CABLE_120_LG",label:"Electrical Cables - Large (FRL 120)",service:"Electrical",frr:120,size_min:151,size_max:300,subclass:"Cables"},{id:"ELEC_CABLE_90_SM",label:"Electrical Cables - Small (FRL 90)",service:"Electrical",frr:90,size_min:0,size_max:50,subclass:"Cables"},{id:"ELEC_CABLE_90_MD",label:"Electrical Cables - Medium (FRL 90)",service:"Electrical",frr:90,size_min:51,size_max:150,subclass:"Cables"},{id:"ELEC_CABLE_90_LG",label:"Electrical Cables - Large (FRL 90)",service:"Electrical",frr:90,size_min:151,size_max:300,subclass:"Cables"},{id:"ELEC_CONDUIT_120_SM",label:"Electrical Conduit - Small (FRL 120)",service:"Electrical",frr:120,size_min:0,size_max:40,subclass:"Conduit"},{id:"ELEC_CONDUIT_120_MD",label:"Electrical Conduit - Medium (FRL 120)",service:"Electrical",frr:120,size_min:41,size_max:100,subclass:"Conduit"},{id:"ELEC_CONDUIT_120_LG",label:"Electrical Conduit - Large (FRL 120)",service:"Electrical",frr:120,size_min:101,size_max:200,subclass:"Conduit"},{id:"MECH_DUCT_120_SM",label:"Mechanical Duct - Small (FRL 120)",service:"Mechanical",frr:120,size_min:0,size_max:200,subclass:"Ducts"},{id:"MECH_DUCT_120_MD",label:"Mechanical Duct - Medium (FRL 120)",service:"Mechanical",frr:120,size_min:201,size_max:500,subclass:"Ducts"},{id:"MECH_DUCT_120_LG",label:"Mechanical Duct - Large (FRL 120)",service:"Mechanical",frr:120,size_min:501,size_max:1e3,subclass:"Ducts"},{id:"MECH_DUCT_90_SM",label:"Mechanical Duct - Small (FRL 90)",service:"Mechanical",frr:90,size_min:0,size_max:200,subclass:"Ducts"},{id:"MECH_DUCT_90_MD",label:"Mechanical Duct - Medium (FRL 90)",service:"Mechanical",frr:90,size_min:201,size_max:500,subclass:"Ducts"},{id:"MECH_DUCT_90_LG",label:"Mechanical Duct - Large (FRL 90)",service:"Mechanical",frr:90,size_min:501,size_max:1e3,subclass:"Ducts"},{id:"PLUMB_PIPE_120_SM",label:"Plumbing Pipe - Small (FRL 120)",service:"Plumbing",frr:120,size_min:0,size_max:50,subclass:"Pipes"},{id:"PLUMB_PIPE_120_MD",label:"Plumbing Pipe - Medium (FRL 120)",service:"Plumbing",frr:120,size_min:51,size_max:150,subclass:"Pipes"},{id:"PLUMB_PIPE_120_LG",label:"Plumbing Pipe - Large (FRL 120)",service:"Plumbing",frr:120,size_min:151,size_max:300,subclass:"Pipes"},{id:"PLUMB_PIPE_90_SM",label:"Plumbing Pipe - Small (FRL 90)",service:"Plumbing",frr:90,size_min:0,size_max:50,subclass:"Pipes"},{id:"PLUMB_PIPE_90_MD",label:"Plumbing Pipe - Medium (FRL 90)",service:"Plumbing",frr:90,size_min:51,size_max:150,subclass:"Pipes"},{id:"PLUMB_PIPE_90_LG",label:"Plumbing Pipe - Large (FRL 90)",service:"Plumbing",frr:90,size_min:151,size_max:300,subclass:"Pipes"},{id:"DATA_CABLE_120_SM",label:"Data Cables - Small (FRL 120)",service:"Data",frr:120,size_min:0,size_max:50,subclass:"Cables"},{id:"DATA_CABLE_120_MD",label:"Data Cables - Medium (FRL 120)",service:"Data",frr:120,size_min:51,size_max:150,subclass:"Cables"},{id:"DATA_CABLE_120_LG",label:"Data Cables - Large (FRL 120)",service:"Data",frr:120,size_min:151,size_max:300,subclass:"Cables"},{id:"FIRE_SPRINK_120_SM",label:"Fire Sprinkler Pipe - Small (FRL 120)",service:"Fire",frr:120,size_min:0,size_max:50,subclass:"Pipes"},{id:"FIRE_SPRINK_120_MD",label:"Fire Sprinkler Pipe - Medium (FRL 120)",service:"Fire",frr:120,size_min:51,size_max:150,subclass:"Pipes"},{id:"FIRE_SPRINK_120_LG",label:"Fire Sprinkler Pipe - Large (FRL 120)",service:"Fire",frr:120,size_min:151,size_max:300,subclass:"Pipes"},{id:"GAS_PIPE_120_SM",label:"Gas Pipe - Small (FRL 120)",service:"Gas",frr:120,size_min:0,size_max:50,subclass:"Pipes"},{id:"GAS_PIPE_120_MD",label:"Gas Pipe - Medium (FRL 120)",service:"Gas",frr:120,size_min:51,size_max:100,subclass:"Pipes"},{id:"CABLE_TRAY_120",label:"Cable Tray (FRL 120)",service:"Electrical",frr:120,size_min:100,size_max:600,subclass:"Tray"},{id:"CABLE_TRAY_90",label:"Cable Tray (FRL 90)",service:"Electrical",frr:90,size_min:100,size_max:600,subclass:"Tray"},{id:"PEN_SEAL_120_SM",label:"Penetration Seal - Small (FRL 120)",frr:120,size_min:0,size_max:75,subclass:"Seal"},{id:"PEN_SEAL_120_MD",label:"Penetration Seal - Medium (FRL 120)",frr:120,size_min:76,size_max:200,subclass:"Seal"},{id:"PEN_SEAL_120_LG",label:"Penetration Seal - Large (FRL 120)",frr:120,size_min:201,size_max:500,subclass:"Seal"},{id:"PEN_SEAL_90_SM",label:"Penetration Seal - Small (FRL 90)",frr:90,size_min:0,size_max:75,subclass:"Seal"},{id:"PEN_SEAL_90_MD",label:"Penetration Seal - Medium (FRL 90)",frr:90,size_min:76,size_max:200,subclass:"Seal"},{id:"PEN_SEAL_90_LG",label:"Penetration Seal - Large (FRL 90)",frr:90,size_min:201,size_max:500,subclass:"Seal"},{id:"LINEAR_JOINT_120",label:"Linear Joint - Control Joint (FRL 120)",frr:120,size_min:10,size_max:50,subclass:"Seal"},{id:"LINEAR_JOINT_90",label:"Linear Joint - Control Joint (FRL 90)",frr:90,size_min:10,size_max:50,subclass:"Seal"},{id:"FIRE_DAMPER_120",label:"Fire Damper (FRL 120)",service:"Mechanical",frr:120,size_min:100,size_max:1e3,subclass:"Damper"},{id:"FIRE_DAMPER_90",label:"Fire Damper (FRL 90)",service:"Mechanical",frr:90,size_min:100,size_max:1e3,subclass:"Damper"},{id:"COLLAR_120_SM",label:"Fire Collar - Small (FRL 120)",frr:120,size_min:0,size_max:100,subclass:"Collar"},{id:"COLLAR_120_MD",label:"Fire Collar - Medium (FRL 120)",frr:120,size_min:101,size_max:200,subclass:"Collar"},{id:"COLLAR_120_LG",label:"Fire Collar - Large (FRL 120)",frr:120,size_min:201,size_max:400,subclass:"Collar"},{id:"BATT_WRAP_120",label:"Fire Batt/Wrap (FRL 120)",frr:120,subclass:"Batt"},{id:"BATT_WRAP_90",label:"Fire Batt/Wrap (FRL 90)",frr:90,subclass:"Batt"},{id:"BOARD_120",label:"Fire Rated Board (FRL 120)",frr:120,subclass:"Board"},{id:"BOARD_90",label:"Fire Rated Board (FRL 90)",frr:90,subclass:"Board"}];function $R(e){if(!e||!e.description)return{systemId:null,systemLabel:null,confidence:0,needsReview:!0,matchedFactors:[],missedFactors:["No description provided"]};const t=[],r=[];let s=null,n=0;for(const l of Bk){let c=0;const u=[];if(e.service&&l.service&&(e.service.toLowerCase().includes(l.service.toLowerCase())||l.service.toLowerCase().includes(e.service.toLowerCase()))&&(c+=30,u.push(`Service: ${e.service}`)),e.size&&l.size_min!==void 0&&l.size_max!==void 0){const d=parseFloat(e.size.replace(/[^\d.]/g,""));!isNaN(d)&&d>=l.size_min&&d<=l.size_max&&(c+=25,u.push(`Size: ${e.size}`))}if(e.frr&&l.frr){const d=parseInt(e.frr.replace(/[^\d]/g,""));!isNaN(d)&&d===l.frr&&(c+=20,u.push(`FRR: ${e.frr}`))}e.subclass&&l.label.toLowerCase().includes(e.subclass.toLowerCase())&&(c+=15,u.push(`Type: ${e.subclass}`)),c>n&&(n=c,s={template:l,score:c},t.length=0,t.push(...u))}if(e.service||r.push("Service type not identified"),e.size||r.push("Size not found"),e.frr||r.push("FRR not specified"),!s||n<20)return{systemId:null,systemLabel:null,confidence:0,needsReview:!0,matchedFactors:t,missedFactors:r.length>0?r:["No matching system template found"]};const a=Math.min(n/90,1),i=a<.7;return{systemId:s.template.id,systemLabel:s.template.label,confidence:a,needsReview:i,matchedFactors:t,missedFactors:r}}function h0({currentStep:e,totalSteps:t=5,onBack:r,onNext:s,backLabel:n,nextLabel:a,disabledNext:i=!1}){return o.jsx("div",{className:"border-t border-gray-200 bg-white px-8 py-4",children:o.jsxs("div",{className:"flex items-center justify-between max-w-7xl mx-auto",children:[o.jsx("div",{className:"flex-1",children:r&&o.jsxs("button",{onClick:r,className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:[o.jsx(NS,{size:16}),n||"Back"]})}),o.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:["Step ",e+1," of ",t]}),o.jsx("div",{className:"flex-1 flex justify-end",children:s&&o.jsxs("button",{onClick:s,disabled:i,className:`inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-white rounded-lg transition-colors ${i?"bg-gray-300 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:[a||"Next step",o.jsx(i0,{size:16})]})})]})})}function kx(e){return e.quantity===null||e.quantity===void 0||e.quantity===0}function VR(e){return e.toLowerCase().replace(/\s+/g," ").replace(/(\d+(\.\d+)?\s*mm)/g,"").replace(/fc\s*\d+/g,"").replace(/[-,]/g," ").trim()}function WR(e){return e.replace(/\s+/g," ").split(" ").slice(0,8).join(" ")}const Tf={ea:"No",each:"No",nr:"No",no:"No",m:"lm","linear meter":"lm","lineal meter":"lm",meter:"lm",metres:"lm",meters:"lm"};function qR({rawUnit:e,normalizedUnit:t,canonicalUnit:r}){const s=t||r,n=s||Tf[e.toLowerCase()]||e,a=s?s.toLowerCase()!==e.toLowerCase():Tf[e.toLowerCase()]&&Tf[e.toLowerCase()]!==e;return o.jsxs("div",{className:"flex flex-col text-sm",children:[o.jsx("span",{className:"font-medium text-gray-900",children:n}),a&&o.jsxs("span",{className:"text-[10px] text-slate-500",children:['normalised from "',e,'"']})]})}function HR({rawDescription:e,normalizedDescription:t}){const r=t||e,s=t&&t.trim()!==e.trim();return o.jsxs("div",{className:"flex flex-col text-sm max-w-xs",children:[o.jsx("span",{className:"font-medium text-gray-900 truncate",title:r,children:r}),s&&o.jsxs("span",{className:"text-[11px] text-slate-500 truncate",title:e,children:["original: ",e]})]})}function GR({mappedServiceType:e,mappedSystem:t,mappedPenetration:r,mappingConfidence:s,size:n,frr:a,service:i,subclass:l,material:c}){const u=e||t||r;return o.jsx("div",{className:"text-xs space-y-1",children:u?o.jsxs("div",{className:"flex flex-wrap gap-1",children:[e&&o.jsx("span",{className:"px-2 py-0.5 rounded-full bg-blue-100 text-blue-900 font-semibold",children:e}),t&&o.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-100 text-emerald-900 font-semibold",children:t}),r&&o.jsx("span",{className:"px-2 py-0.5 rounded-full bg-pink-100 text-pink-900 font-semibold",children:r}),typeof s=="number"&&o.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-gray-200 text-gray-900 font-semibold",children:[(s*100).toFixed(0),"%"]})]}):o.jsxs(o.Fragment,{children:[n&&o.jsxs("div",{className:"text-gray-900 font-medium",children:["Size: ",o.jsx("span",{className:"font-semibold",children:n})]}),a&&o.jsxs("div",{className:"text-gray-900 font-medium",children:["FRR: ",o.jsx("span",{className:"font-semibold",children:a})]}),i&&o.jsxs("div",{className:"text-blue-800 font-medium",children:["Service: ",o.jsx("span",{className:"font-semibold",children:i})]}),l&&o.jsxs("div",{className:"text-gray-900 font-medium",children:["Type: ",o.jsx("span",{className:"font-semibold",children:l})]}),c&&o.jsxs("div",{className:"text-gray-900 font-medium",children:["Material: ",o.jsx("span",{className:"font-semibold",children:c})]})]})})}function KR({projectId:e,onNavigateBack:t,onNavigateNext:r}){const[s,n]=j.useState([]),[a,i]=j.useState([]),[l,c]=j.useState(null),[u,d]=j.useState([]),[f,h]=j.useState(null),[m,x]=j.useState({}),[p,g]=j.useState(!0),[w,v]=j.useState(!1),[y,b]=j.useState(!1),[S,_]=j.useState(!1),[k,E]=j.useState(!1),[T,M]=j.useState(null),[q,D]=j.useState(null),[W,ee]=j.useState(null),Y=Bk,G=async()=>{await ie.from("projects").update({updated_at:new Date().toISOString()}).eq("id",e)},ce=async()=>{try{await ie.from("project_settings").upsert({project_id:e,review_clean_completed:!0,updated_at:new Date().toISOString()},{onConflict:"project_id"})}catch(z){console.error("Error marking Review & Clean as complete:",z)}};j.useEffect(()=>{Q()},[e]),j.useEffect(()=>{l&&B(l)},[l]);const Q=async()=>{g(!0);const{data:z,error:H}=await ie.from("quotes").select("*").eq("project_id",e).order("import_date",{ascending:!1});if(!H&&z){n(z);const{data:Z}=await ie.from("parsing_jobs").select("quote_id, status, error_message, parsed_lines").eq("project_id",e),J=new Map;Z&&Z.forEach(le=>{le.quote_id&&J.set(le.quote_id,le)});const K=z.filter(le=>{var Te;const ye=J.get(le.id);if((le.items_count||0)===0)return!1;if(ye){const Ue=((Te=ye.error_message)==null?void 0:Te.includes("chunks failed"))||!1;if(ye.status==="failed"||Ue)return!1}return!0});i(K),K.length>0&&!l?c(K[0].id):K.length===0?c(null):l&&!K.find(le=>le.id===l)&&c(K[0].id)}g(!1)},B=async z=>{const{data:H,error:Z}=await ie.from("quote_items").select("*").eq("quote_id",z).order("created_at",{ascending:!0});!Z&&H&&d(H)},me=async z=>{if(!l){console.error("normaliseAllItems: No selectedQuote");return}v(!0),M({type:"info",text:"Normalising items..."});const H=z||u;console.log("normaliseAllItems: Processing",H.length,"items");try{const Z=H.map(K=>{const le=jf(K.quantity),ye=jf(K.unit_price);let Re=jf(K.total_price);const Te=RR(Re,le),Ue=IR(le,ye),it=ye||Te,pt=Re||Ue,tt=g1(K.unit),Ce=v1(K.description),{confidence:Fe,issues:rt}=y1(K.description,le,K.unit,tt.canonical,it,pt,Ce.confidence);return{id:K.id,quantity:le||K.quantity,unit_price:it||K.unit_price,total_price:pt||K.total_price,canonical_unit:tt.canonical||"",size:Ce.size||"",frr:Ce.frr||"",service:Ce.service||"",subclass:Ce.subclass||"",material:Ce.material||"",confidence:Fe,issues:JSON.stringify(rt)}});console.log("normaliseAllItems: Saving",Z.length,"updates to database");for(const K of Z){const{id:le,...ye}=K,{error:Re}=await ie.from("quote_items").update(ye).eq("id",le);Re&&console.error("normaliseAllItems: Error updating item",le,Re)}await G(),await B(l),await Q();const J=Z.filter(K=>K.confidence<.6).length;console.log("normaliseAllItems: Complete!",Z.length,"items,",J,"low confidence"),M({type:"success",text:`Normalisation complete! ${Z.length} items processed. ${J} items need review.`})}catch(Z){console.error("Normalisation error:",Z),M({type:"error",text:"Failed to normalise items. Please try again."})}finally{v(!1)}},fe=async z=>{if(!l){console.error("mapAllItemsToSystems: No selectedQuote");return}b(!0),M({type:"info",text:"Mapping items to systems..."});const H=z||u;console.log("mapAllItemsToSystems: Processing",H.length,"items");try{const Z=H.map(Te=>{const Ue=$R({description:Te.description,size:Te.size,frr:Te.frr,service:Te.service,subclass:Te.subclass,material:Te.material});return{id:Te.id,system_id:Ue.systemId||null,system_label:Ue.systemLabel||null,system_confidence:Ue.confidence,system_needs_review:Ue.needsReview,system_manual_override:!1,matched_factors:JSON.stringify(Ue.matchedFactors),missed_factors:JSON.stringify(Ue.missedFactors)}});console.log("mapAllItemsToSystems: Saving",Z.length,"updates to database"),console.log("mapAllItemsToSystems: Sample update:",Z[0]);const J=Z.filter(Te=>Te.system_id);console.log("mapAllItemsToSystems: Items with system_id:",J.length,"/",Z.length);for(const Te of Z){const{id:Ue,...it}=Te,{error:pt}=await ie.from("quote_items").update(it).eq("id",Ue);pt&&console.error("mapAllItemsToSystems: Error updating item",Ue,pt)}console.log("mapAllItemsToSystems: Database updates complete. Verifying...");const{data:K,error:le}=await ie.from("quote_items").select("id, description, system_id, system_label, size, frr, service, subclass").eq("quote_id",l).limit(5);if(K){console.log("mapAllItemsToSystems: Verification - Sample saved items:",K);const Te=K.filter(Ue=>Ue.system_id);console.log("mapAllItemsToSystems: Verification - Items with system_id:",Te.length,"/",K.length)}await G(),await B(l),await ce();const ye=Z.filter(Te=>Te.system_needs_review).length,Re=Z.filter(Te=>Te.system_id).length;console.log("mapAllItemsToSystems: Complete!",Re,"/",Z.length,"mapped,",ye,"need review"),M({type:"success",text:`Mapping complete! ${Re}/${Z.length} items mapped. ${ye} need review.`})}catch(Z){console.error("Mapping error:",Z),M({type:"error",text:"Failed to map items to systems. Please try again."})}finally{b(!1)}},A=async z=>{if(!l||w||y||S)return;_(!0),M({type:"info",text:"Step 1/2: Normalising items..."});const H=z||u;try{let Z=!0;try{await me(H)}catch(le){console.error("Normalise step failed:",le),M({type:"error",text:"Normalise failed  please try again."}),Z=!1}if(!Z)return;M({type:"info",text:"Step 2/2: Mapping items to systems..."}),await new Promise(le=>setTimeout(le,200));const{data:J}=await ie.from("quote_items").select("*").eq("quote_id",l).order("created_at",{ascending:!0});let K=!0;try{await fe(J||H)}catch(le){console.error("Mapping step failed:",le),M({type:"error",text:"System mapping failed  please review items."}),K=!1}if(!K)return;M({type:"success",text:"Smart Clean complete! All items normalised and mapped."})}catch(Z){console.error("Smart Clean error:",Z),M({type:"error",text:"Smart Clean failed. Please try individual steps."})}finally{_(!1)}},V=async()=>{if(!l||w||y||S)return;const z=s.find(H=>H.id===l);if(z){_(!0),M({type:"info",text:`Processing "${z.supplier_name}"...`});try{await ie.from("quotes").update({status:"processing",processing_started_at:new Date().toISOString()}).eq("id",l),await A(u),await ie.from("quotes").update({status:"ready",processing_completed_at:new Date().toISOString()}).eq("id",l),await Q(),M({type:"success",text:`"${z.supplier_name}" processed successfully!`})}catch(H){console.error("Clean & Map error:",H),await ie.from("quotes").update({status:"error",processing_error:H instanceof Error?H.message:"Unknown error",processing_completed_at:new Date().toISOString()}).eq("id",l),await Q(),M({type:"error",text:`Failed to process "${z.supplier_name}"`})}finally{_(!1)}}},L=async()=>{if(w||y||S||k)return;const z=a.filter(H=>H.status==="imported"||H.status==="pending"||H.status==="error");if(z.length===0){M({type:"info",text:"No pending quotes to process."});return}console.log("========== PROCESS PENDING QUOTES STARTED =========="),console.log("Processing",z.length,"pending quotes"),E(!0);try{for(let H=0;H<z.length;H++){const Z=z[H];console.log(`
--- Processing quote ${H+1}/${z.length}: ${Z.supplier_name} ---`),M({type:"info",text:`Processing quote ${H+1}/${z.length}: ${Z.supplier_name}`}),c(Z.id),await ie.from("quotes").update({status:"processing",processing_started_at:new Date().toISOString()}).eq("id",Z.id);const{data:J}=await ie.from("quote_items").select("*").eq("quote_id",Z.id).order("created_at",{ascending:!0});if(!J||J.length===0){console.warn(`No items found for quote ${Z.supplier_name}`),await ie.from("quotes").update({status:"error",processing_error:"No items found"}).eq("id",Z.id);continue}console.log("Loaded",J.length,"items for quote",Z.supplier_name),d(J);try{await A(J),await ie.from("quotes").update({status:"ready",processing_completed_at:new Date().toISOString()}).eq("id",Z.id),console.log("Successfully processed quote:",Z.supplier_name)}catch(K){console.error(`Processing failed for quote ${Z.supplier_name}:`,K),await ie.from("quotes").update({status:"error",processing_error:K instanceof Error?K.message:"Unknown error",processing_completed_at:new Date().toISOString()}).eq("id",Z.id)}}console.log(`
========== PROCESS PENDING QUOTES COMPLETE ==========`),l&&await B(l),await Q(),M({type:"success",text:`All ${z.length} pending quotes processed.`})}catch(H){console.error("Process All Pending error:",H),M({type:"error",text:"Failed to process all quotes. Some quotes may have been processed."})}finally{E(!1)}},U=async(z,H)=>{const Z=Y.find(K=>K.id===H);if(!Z)return;const{error:J}=await ie.from("quote_items").update({system_id:H,system_label:Z.label,system_manual_override:!0,system_needs_review:!1}).eq("id",z);!J&&l&&(await G(),B(l))},ne=z=>{h(z.id),x({description:z.description,quantity:z.quantity,unit:z.unit,unit_price:z.unit_price,canonical_unit:z.canonical_unit,size:z.size,frr:z.frr,service:z.service,subclass:z.subclass,material:z.material})},xe=()=>{h(null),x({})},pe=async z=>{const H=(m.quantity||0)*(m.unit_price||0),Z=g1(m.unit),J=v1(m.description||""),{confidence:K,issues:le}=y1(m.description,m.quantity,m.unit,m.canonical_unit||Z.canonical,m.unit_price,H,J.confidence),{error:ye}=await ie.from("quote_items").update({...m,total_price:H,canonical_unit:m.canonical_unit||Z.canonical||"",confidence:K,issues:JSON.stringify(le)}).eq("id",z);ye||(await G(),h(null),x({}),B(l),Q())},oe=async(z,H)=>{const{error:Z}=await ie.from("quote_items").update({is_excluded:!H}).eq("id",z);!Z&&l&&(await G(),B(l))},ue=async z=>{if(!confirm("Are you sure you want to delete this item?"))return;const{error:H}=await ie.from("quote_items").delete().eq("id",z);!H&&l&&(await G(),B(l),Q())},we=async z=>{if(!confirm("Are you sure you want to delete this entire quote?"))return;const{error:H}=await ie.from("quotes").delete().eq("id",z);H||(l===z&&(c(null),d([])),Q())},P=z=>{if(z===void 0||z===0)return o.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-medium rounded-full bg-gray-100 text-gray-600",children:"Not analysed"});const H=UR(z),Z=zR(z),J={green:"bg-green-100 text-green-800",amber:"bg-yellow-100 text-yellow-800",red:"bg-red-100 text-red-800"};return o.jsxs("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${J[H]}`,children:[Z," (",Math.round(z*100),"%)"]})},Me=z=>{if(!z)return[];if(typeof z=="string")try{return JSON.parse(z)}catch{return[]}return Array.isArray(z)?z:[]};if(p)return o.jsx("div",{className:"flex items-center justify-center h-64",children:o.jsx("div",{className:"text-gray-500",children:"Loading quotes..."})});if(s.length===0)return o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center",children:[o.jsx("p",{className:"text-gray-500 text-lg",children:"No quotes imported yet."}),o.jsx("p",{className:"text-gray-400 mt-2",children:"Go to Import Quotes to add your first quote."})]});const je=s.find(z=>z.id===l),X=(je==null?void 0:je.reconciliation_status)==="failed";return o.jsxs("div",{className:"space-y-6",children:[X&&je&&o.jsx("div",{className:"bg-red-50 border-2 border-red-400 rounded-lg p-4",children:o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx(Je,{size:24,className:"text-red-600 flex-shrink-0 mt-0.5"}),o.jsxs("div",{className:"flex-1",children:[o.jsx("h4",{className:"font-bold text-red-900 text-lg",children:" Totals Reconciliation Failed"}),o.jsx("p",{className:"text-red-800 mt-1",children:je.reconciliation_notes}),o.jsxs("p",{className:"text-red-700 mt-2 text-sm",children:[o.jsx("strong",{children:"Variance:"})," ",((je.reconciliation_variance||0)*100).toFixed(2),"%",je.quoted_total&&o.jsxs(o.Fragment,{children:[" | ",o.jsx("strong",{children:"PDF Total:"})," $",je.quoted_total.toLocaleString()," | ",o.jsx("strong",{children:"Extracted Total:"})," $",je.total_amount.toLocaleString()]})]}),o.jsx("p",{className:"text-red-800 mt-3 font-medium",children:"This quote requires manual review. Possible causes: column swap, missing items, or incorrect extraction."})]})]})}),T&&o.jsx("div",{className:`p-4 rounded-md ${T.type==="success"?"bg-green-50 text-green-800":T.type==="error"?"bg-red-50 text-red-800":"bg-blue-50 text-blue-800"}`,children:o.jsxs("div",{className:"flex items-start gap-2",children:[o.jsx(Je,{size:18,className:"mt-0.5 flex-shrink-0"}),o.jsx("span",{children:T.text})]})}),a.length===0&&!p?o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-12 text-center",children:[o.jsx(Je,{className:"mx-auto text-gray-400 mb-4",size:48}),o.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"No quotes ready to clean"}),o.jsx("p",{className:"text-gray-600 mb-6",children:"Import supplier quotes or fix failed imports on the Import Quotes page before continuing."}),o.jsx("button",{onClick:()=>window.location.href="#/import",className:"px-6 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-md font-medium transition-colors",children:"Go to Import Quotes"}),o.jsx("p",{className:"text-xs text-gray-500 mt-4",children:"Only successfully imported quotes with line items will appear here."})]}):o.jsxs("div",{className:"grid grid-cols-12 gap-6",children:[o.jsx("div",{className:"col-span-3",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[o.jsx("div",{className:"p-4 border-b border-gray-200",children:o.jsx("h3",{className:"font-semibold text-gray-900",children:"Quotes"})}),o.jsx("div",{className:"divide-y divide-gray-200",children:a.map(z=>o.jsx("div",{className:`p-4 cursor-pointer hover:bg-gray-50 transition-colors ${l===z.id?"bg-gray-50 border-l-4 border-blue-600":""}`,onClick:()=>c(z.id),children:o.jsxs("div",{className:"flex items-start justify-between",children:[o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("p",{className:"font-semibold text-gray-900 text-sm truncate",children:z.supplier_name}),o.jsx("p",{className:"text-xs text-gray-500 truncate mt-0.5",children:z.quote_reference||"No reference"}),o.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[o.jsxs("span",{className:"text-sm font-medium text-gray-900",children:["$",z.total_amount.toLocaleString()]}),o.jsx("span",{className:"inline-flex px-2 py-0.5 text-xs font-medium rounded-full bg-green-100 text-green-800 border border-green-300",children:"Ready to clean"})]})]}),o.jsx("button",{onClick:H=>{H.stopPropagation(),we(z.id)},className:"p-1 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded",children:o.jsx(tc,{size:14})})]})},z.id))})]})}),o.jsx("div",{className:"col-span-9",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[o.jsx("div",{className:"p-4 border-b border-gray-200",children:o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsxs("div",{children:[o.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:["Review & Clean ",je&&` ${je.supplier_name}`]}),o.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Normalise, clean and map items for this supplier quote."})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("button",{onClick:V,disabled:S||w||y||!l||u.length===0,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed text-sm font-medium",title:"Run normalisation and mapping for this quote",children:[o.jsx(qu,{size:16}),S?"Processing...":"Clean & Map Quote"]}),o.jsxs("button",{onClick:L,disabled:k||w||y||S||a.length===0,className:"flex items-center gap-2 px-3 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 transition-colors disabled:bg-gray-100 disabled:cursor-not-allowed text-sm",title:"Process all pending/error quotes",children:[o.jsx(LF,{size:14}),k?"Processing...":"Run for All Pending"]})]})]})}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full",children:[o.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Description"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Qty"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Unit"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Rate"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Total"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Attributes"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Suggest System"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Confidence"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),o.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),o.jsx("tbody",{className:"divide-y divide-gray-200",children:u.map(z=>{const H=Me(z.issues);return o.jsx("tr",{className:z.is_excluded?"bg-gray-50 opacity-60":"",children:f===z.id?o.jsxs(o.Fragment,{children:[o.jsx("td",{className:"px-4 py-3",children:o.jsx("input",{type:"text",value:m.description||"",onChange:Z=>x({...m,description:Z.target.value}),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm text-gray-900"})}),o.jsx("td",{className:"px-4 py-3",children:o.jsx("input",{type:"number",value:m.quantity||"",onChange:Z=>x({...m,quantity:parseFloat(Z.target.value)||0}),className:"w-20 px-2 py-1 border border-gray-300 rounded text-sm text-gray-900",step:"0.01"})}),o.jsx("td",{className:"px-4 py-3",children:o.jsx("input",{type:"text",value:m.unit||"",onChange:Z=>x({...m,unit:Z.target.value}),className:"w-20 px-2 py-1 border border-gray-300 rounded text-sm text-gray-900"})}),o.jsx("td",{className:"px-4 py-3",children:o.jsx("input",{type:"number",value:m.unit_price||"",onChange:Z=>x({...m,unit_price:parseFloat(Z.target.value)||0}),className:"w-24 px-2 py-1 border border-gray-300 rounded text-sm text-gray-900",step:"0.01"})}),o.jsxs("td",{className:"px-4 py-3 text-sm text-gray-900",children:["$",((m.quantity||0)*(m.unit_price||0)).toFixed(2)]}),o.jsx("td",{className:"px-4 py-3",children:o.jsxs("div",{className:"text-xs space-y-1",children:[m.canonical_unit&&o.jsxs("div",{children:["Unit: ",m.canonical_unit]}),m.service&&o.jsxs("div",{children:["Service: ",m.service]})]})}),o.jsx("td",{className:"px-4 py-3",children:o.jsx("span",{className:"text-sm text-gray-500",children:"Editing..."})}),o.jsx("td",{className:"px-4 py-3",children:o.jsx("span",{className:"text-sm text-gray-500",children:"Editing"})}),o.jsx("td",{className:"px-4 py-3",children:o.jsx("span",{className:"text-sm text-gray-500",children:"-"})}),o.jsx("td",{className:"px-4 py-3 text-right",children:o.jsxs("div",{className:"flex items-center justify-end gap-2",children:[o.jsx("button",{onClick:()=>pe(z.id),className:"p-1 text-green-600 hover:bg-green-50 rounded",children:o.jsx(dx,{size:18})}),o.jsx("button",{onClick:xe,className:"p-1 text-red-600 hover:bg-red-50 rounded",children:o.jsx(ps,{size:18})})]})})]}):o.jsxs(o.Fragment,{children:[o.jsx("td",{className:"px-4 py-3 max-w-xs",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(HR,{rawDescription:z.raw_description||z.description,normalizedDescription:z.normalized_description}),kx(z)&&o.jsx("span",{className:"inline-flex px-2 py-0.5 text-xs font-medium rounded-full bg-yellow-100 text-yellow-800 whitespace-nowrap",children:"Needs quantity"})]})}),o.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:z.quantity}),o.jsx("td",{className:"px-4 py-3",children:o.jsx(qR,{rawUnit:z.raw_unit||z.unit,normalizedUnit:z.normalized_unit,canonicalUnit:z.canonical_unit})}),o.jsxs("td",{className:"px-4 py-3 text-sm text-gray-900",children:["$",z.unit_price.toFixed(2)]}),o.jsxs("td",{className:"px-4 py-3 text-sm text-gray-900",children:["$",z.total_price.toFixed(2)]}),o.jsx("td",{className:"px-4 py-3",children:o.jsx(GR,{mappedServiceType:z.mapped_service_type,mappedSystem:z.mapped_system,mappedPenetration:z.mapped_penetration,mappingConfidence:z.mapping_confidence,size:z.size,frr:z.frr,service:z.service,subclass:z.subclass,material:z.material})}),o.jsx("td",{className:"px-4 py-3",children:z.system_label?o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex items-start gap-2",children:[o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:"text-xs font-medium text-gray-900 truncate",title:z.system_label,children:z.system_label}),o.jsx("div",{className:"text-xs text-gray-500",children:z.system_id}),z.system_manual_override&&o.jsx("div",{className:"text-xs text-blue-600 mt-0.5",children:"Manual override"})]}),z.system_confidence!==void 0&&o.jsxs("span",{className:`inline-flex px-1.5 py-0.5 text-xs font-medium rounded ${z.system_confidence>=.7?"bg-green-100 text-green-800":z.system_confidence>=.5?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:[Math.round(z.system_confidence*100),"%"]})]}),o.jsxs("select",{value:z.system_id||"",onChange:Z=>U(z.id,Z.target.value),className:"w-full text-xs border border-gray-300 rounded px-2 py-1 focus:ring-2 focus:ring-blue-500 focus:border-transparent text-gray-900",children:[o.jsx("option",{value:"",children:"-- Change System --"}),Y.map(Z=>o.jsx("option",{value:Z.id,children:Z.label},Z.id))]}),(z.matched_factors||z.missed_factors)&&o.jsxs("button",{onClick:()=>ee(W===z.id?null:z.id),className:"text-xs text-blue-600 hover:text-blue-800 flex items-center gap-1",children:[o.jsx(Je,{size:12}),"Match details"]}),W===z.id&&o.jsxs("div",{className:"mt-1 p-2 bg-gray-50 rounded text-xs",children:[z.matched_factors&&JSON.parse(z.matched_factors).length>0&&o.jsxs("div",{className:"mb-2",children:[o.jsx("div",{className:"font-medium text-green-700 mb-1",children:"Matched:"}),o.jsx("ul",{className:"list-disc list-inside text-green-600 space-y-0.5",children:JSON.parse(z.matched_factors).map((Z,J)=>o.jsx("li",{children:Z},J))})]}),z.missed_factors&&JSON.parse(z.missed_factors).length>0&&o.jsxs("div",{children:[o.jsx("div",{className:"font-medium text-red-700 mb-1",children:"Missed:"}),o.jsx("ul",{className:"list-disc list-inside text-red-600 space-y-0.5",children:JSON.parse(z.missed_factors).map((Z,J)=>o.jsx("li",{children:Z},J))})]})]})]}):o.jsx("div",{className:"text-xs text-gray-400",children:"Not mapped"})}),o.jsxs("td",{className:"px-4 py-3",children:[o.jsxs("div",{className:"space-y-1",children:[P(z.confidence),H.length>0&&o.jsxs("button",{onClick:()=>D(q===z.id?null:z.id),className:"text-xs text-red-600 hover:text-red-800 flex items-center gap-1",children:[o.jsx(Je,{size:12}),H.length," issue",H.length!==1?"s":""]})]}),q===z.id&&H.length>0&&o.jsx("div",{className:"mt-2 p-2 bg-red-50 rounded text-xs text-red-800",children:o.jsx("ul",{className:"list-disc list-inside space-y-1",children:H.map((Z,J)=>o.jsx("li",{children:Z},J))})})]}),o.jsx("td",{className:"px-4 py-3",children:o.jsx("button",{onClick:()=>oe(z.id,z.is_excluded),className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${z.is_excluded?"bg-red-100 text-red-800 hover:bg-red-200":"bg-green-100 text-green-800 hover:bg-green-200"}`,children:z.is_excluded?"Excluded":"Included"})}),o.jsx("td",{className:"px-4 py-3 text-right",children:o.jsxs("div",{className:"flex items-center justify-end gap-2",children:[o.jsx("button",{onClick:()=>ne(z),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",children:o.jsx(AS,{size:16})}),o.jsx("button",{onClick:()=>ue(z.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",children:o.jsx(tc,{size:16})})]})})]})},z.id)})})]})})]})})]}),o.jsx(h0,{currentStep:2,onBack:t,onNext:r,backLabel:"Back: Import Quotes",nextLabel:"Next: Quote Intelligence"})]})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var jd={};jd.version="0.18.5";var Uk=1252,XR=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Nx={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Ex=function(e){XR.indexOf(e)!=-1&&(Uk=Nx[0]=e)};function QR(){Ex(1252)}var Gs=function(e){Ex(e)};function jx(){Gs(1200),QR()}function w1(e){for(var t=[],r=0,s=e.length;r<s;++r)t[r]=e.charCodeAt(r);return t}function YR(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function zk(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var nl=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?YR(e.slice(2)):t==254&&r==255?zk(e.slice(2)):t==65279?e.slice(1):e},gu=function(t){return String.fromCharCode(t)},b1=function(t){return String.fromCharCode(t)},ac,Qn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function ic(e){for(var t="",r=0,s=0,n=0,a=0,i=0,l=0,c=0,u=0;u<e.length;)r=e.charCodeAt(u++),a=r>>2,s=e.charCodeAt(u++),i=(r&3)<<4|s>>4,n=e.charCodeAt(u++),l=(s&15)<<2|n>>6,c=n&63,isNaN(s)?l=c=64:isNaN(n)&&(c=64),t+=Qn.charAt(a)+Qn.charAt(i)+Qn.charAt(l)+Qn.charAt(c);return t}function fs(e){var t="",r=0,s=0,n=0,a=0,i=0,l=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)a=Qn.indexOf(e.charAt(u++)),i=Qn.indexOf(e.charAt(u++)),r=a<<2|i>>4,t+=String.fromCharCode(r),l=Qn.indexOf(e.charAt(u++)),s=(i&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(s)),c=Qn.indexOf(e.charAt(u++)),n=(l&3)<<6|c,c!==64&&(t+=String.fromCharCode(n));return t}var Qe=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Dn=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function da(e){return Qe?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function _1(e){return Qe?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var os=function(t){return Qe?Dn(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function m0(e){if(typeof ArrayBuffer>"u")return os(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),s=0;s!=e.length;++s)r[s]=e.charCodeAt(s)&255;return t}function ba(e){if(Array.isArray(e))return e.map(function(s){return String.fromCharCode(s)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function JR(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function Tx(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Tx(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var ir=Qe?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Dn(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var s=new Uint8Array(r),n=0;for(t=0,r=0;t<e.length;r+=n,++t)if(n=e[t].length,e[t]instanceof Uint8Array)s.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";s.set(new Uint8Array(e[t]),r)}return s}return[].concat.apply([],e.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function ZR(e){for(var t=[],r=0,s=e.length+250,n=da(e.length+255),a=0;a<e.length;++a){var i=e.charCodeAt(a);if(i<128)n[r++]=i;else if(i<2048)n[r++]=192|i>>6&31,n[r++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var l=e.charCodeAt(++a)&1023;n[r++]=240|i>>8&7,n[r++]=128|i>>2&63,n[r++]=128|l>>6&15|(i&3)<<4,n[r++]=128|l&63}else n[r++]=224|i>>12&15,n[r++]=128|i>>6&63,n[r++]=128|i&63;r>s&&(t.push(n.slice(0,r)),r=0,n=da(65535),s=65530)}return t.push(n.slice(0,r)),ir(t)}var Ur=/\u0000/g,al=/[\u0001-\u0006]/g;function so(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Ks(e,t){var r=""+e;return r.length>=t?r:Dt("0",t-r.length)+r}function Cx(e,t){var r=""+e;return r.length>=t?r:Dt(" ",t-r.length)+r}function Td(e,t){var r=""+e;return r.length>=t?r:r+Dt(" ",t-r.length)}function eI(e,t){var r=""+Math.round(e);return r.length>=t?r:Dt("0",t-r.length)+r}function tI(e,t){var r=""+e;return r.length>=t?r:Dt("0",t-r.length)+r}var S1=Math.pow(2,32);function ki(e,t){if(e>S1||e<-S1)return eI(e,t);var r=Math.round(e);return tI(r,t)}function Cd(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var k1=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Cf=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function rI(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var $e={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},N1={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},sI={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Ad(e,t,r){for(var s=e<0?-1:1,n=e*s,a=0,i=1,l=0,c=1,u=0,d=0,f=Math.floor(n);u<t&&(f=Math.floor(n),l=f*i+a,d=f*u+c,!(n-f<5e-8));)n=1/(n-f),a=i,i=l,c=u,u=d;if(d>t&&(u>t?(d=c,l=a):(d=u,l=i)),!r)return[0,s*l,d];var h=Math.floor(s*l/d);return[h,s*l-h*d,d]}function $a(e,t,r){if(e>2958465||e<0)return null;var s=e|0,n=Math.floor(86400*(e-s)),a=0,i=[],l={D:s,T:n,u:86400*(e-s)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(s+=1462),l.u>.9999&&(l.u=0,++n==86400&&(l.T=n=0,++s,++l.D)),s===60)i=r?[1317,10,29]:[1900,2,29],a=3;else if(s===0)i=r?[1317,8,29]:[1900,1,0],a=6;else{s>60&&--s;var c=new Date(1900,0,1);c.setDate(c.getDate()+s-1),i=[c.getFullYear(),c.getMonth()+1,c.getDate()],a=c.getDay(),s<60&&(a=(a+6)%7),r&&(a=cI(c,i))}return l.y=i[0],l.m=i[1],l.d=i[2],l.S=n%60,n=Math.floor(n/60),l.M=n%60,n=Math.floor(n/60),l.H=n,l.q=a,l}var $k=new Date(1899,11,31,0,0,0),nI=$k.getTime(),aI=new Date(1900,2,1,0,0,0);function Vk(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=aI&&(r+=24*60*60*1e3),(r-(nI+(e.getTimezoneOffset()-$k.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Ax(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function iI(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function oI(e){var t=e<0?12:11,r=Ax(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function lI(e){var t=Ax(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function oc(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=oI(e):t===10?r=e.toFixed(10).substr(0,12):r=lI(e),Ax(iI(r.toUpperCase()))}function si(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):oc(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Os(14,Vk(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function cI(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function uI(e,t,r,s){var n="",a=0,i=0,l=r.y,c,u=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:c=l%100,u=2;break;default:c=l%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,u=t.length;break;case 3:return Cf[r.m-1][1];case 5:return Cf[r.m-1][0];default:return Cf[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,u=t.length;break;case 3:return k1[r.q][0];default:return k1[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Ks(r.S,t.length):(s>=2?i=s===3?1e3:100:i=s===1?10:1,a=Math.round(i*(r.S+r.u)),a>=60*i&&(a=0),t==="s"?a===0?"0":""+a/i:(n=Ks(a,2+s),t==="ss"?n.substr(0,2):"."+n.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:c=l,u=1;break}var d=u>0?Ks(c,u):"";return d}function Yn(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,s=e.substr(0,r);r!=e.length;r+=t)s+=(s.length>0?",":"")+e.substr(r,t);return s}var Wk=/%/g;function dI(e,t,r){var s=t.replace(Wk,""),n=t.length-s.length;return Nn(e,s,r*Math.pow(10,2*n))+Dt("%",n)}function fI(e,t,r){for(var s=t.length-1;t.charCodeAt(s-1)===44;)--s;return Nn(e,t.substr(0,s),r/Math.pow(10,3*(t.length-s)))}function qk(e,t){var r,s=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+qk(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%n;if(a<0&&(a+=n),r=(t/Math.pow(10,a)).toPrecision(s+1+(n+a)%n),r.indexOf("e")===-1){var i=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,n)+"."+r.substr(2+n),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,d){return c+u+d.substr(0,(n+a)%n)+"."+d.substr(a)+"E"})}else r=t.toExponential(s);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var Hk=/# (\?+)( ?)\/( ?)(\d+)/;function hI(e,t,r){var s=parseInt(e[4],10),n=Math.round(t*s),a=Math.floor(n/s),i=n-a*s,l=s;return r+(a===0?"":""+a)+" "+(i===0?Dt(" ",e[1].length+1+e[4].length):Cx(i,e[1].length)+e[2]+"/"+e[3]+Ks(l,e[4].length))}function mI(e,t,r){return r+(t===0?"":""+t)+Dt(" ",e[1].length+2+e[4].length)}var Gk=/^#*0*\.([0#]+)/,Kk=/\).*[0#]/,Xk=/\(###\) ###\\?-####/;function Or(e){for(var t="",r,s=0;s!=e.length;++s)switch(r=e.charCodeAt(s)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function E1(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function j1(e,t){var r=e-Math.floor(e),s=Math.pow(10,t);return t<(""+Math.round(r*s)).length?0:Math.round(r*s)}function pI(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function xI(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function ys(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Kk)){var s=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ys("n",s,r):"("+ys("n",s,-r)+")"}if(t.charCodeAt(t.length-1)===44)return fI(e,t,r);if(t.indexOf("%")!==-1)return dI(e,t,r);if(t.indexOf("E")!==-1)return qk(t,r);if(t.charCodeAt(0)===36)return"$"+ys(e,t.substr(t.charAt(1)==" "?2:1),r);var n,a,i,l,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+ki(c,t.length);if(t.match(/^[#?]+$/))return n=ki(r,0),n==="0"&&(n=""),n.length>t.length?n:Or(t.substr(0,t.length-n.length))+n;if(a=t.match(Hk))return hI(a,c,u);if(t.match(/^#+0+$/))return u+ki(c,t.length-t.indexOf("0"));if(a=t.match(Gk))return n=E1(r,a[1].length).replace(/^([^\.]+)$/,"$1."+Or(a[1])).replace(/\.$/,"."+Or(a[1])).replace(/\.(\d*)$/,function(x,p){return"."+p+Dt("0",Or(a[1]).length-p.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return u+E1(c,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return u+Yn(ki(c,0));if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ys(e,t,-r):Yn(""+(Math.floor(r)+pI(r,a[1].length)))+"."+Ks(j1(r,a[1].length),a[1].length);if(a=t.match(/^#,#*,#0/))return ys(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=so(ys(e,t.replace(/[\\-]/g,""),r)),i=0,so(so(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return i<n.length?n.charAt(i++):x==="0"?"0":""}));if(t.match(Xk))return n=ys(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var d="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),l=Ad(c,Math.pow(10,i)-1,!1),n=""+u,d=Nn("n",a[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),n+=d+a[2]+"/"+a[3],d=Td(l[2],i),d.length<a[4].length&&(d=Or(a[4].substr(a[4].length-d.length))+d),n+=d,n;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),l=Ad(c,Math.pow(10,i)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Cx(l[1],i)+a[2]+"/"+a[3]+Td(l[2],i):Dt(" ",2*i+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return n=ki(r,0),t.length<=n.length?n:Or(t.substr(0,t.length-n.length))+n;if(a=t.match(/^([#0?]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=n.indexOf(".");var f=t.indexOf(".")-i,h=t.length-n.length-f;return Or(t.substr(0,f)+n+t.substr(t.length-h))}if(a=t.match(/^00,000\.([#0]*0)$/))return i=j1(r,a[1].length),r<0?"-"+ys(e,t,-r):Yn(xI(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?Ks(0,3-x.length):"")+x})+"."+Ks(i,a[1].length);switch(t){case"###,##0.00":return ys(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var m=Yn(ki(c,0));return m!=="0"?u+m:"";case"###,###.00":return ys(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return ys(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function gI(e,t,r){for(var s=t.length-1;t.charCodeAt(s-1)===44;)--s;return Nn(e,t.substr(0,s),r/Math.pow(10,3*(t.length-s)))}function vI(e,t,r){var s=t.replace(Wk,""),n=t.length-s.length;return Nn(e,s,r*Math.pow(10,2*n))+Dt("%",n)}function Qk(e,t){var r,s=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Qk(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%n;if(a<0&&(a+=n),r=(t/Math.pow(10,a)).toPrecision(s+1+(n+a)%n),!r.match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,d){return c+u+d.substr(0,(n+a)%n)+"."+d.substr(a)+"E"})}else r=t.toExponential(s);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function sn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Kk)){var s=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?sn("n",s,r):"("+sn("n",s,-r)+")"}if(t.charCodeAt(t.length-1)===44)return gI(e,t,r);if(t.indexOf("%")!==-1)return vI(e,t,r);if(t.indexOf("E")!==-1)return Qk(t,r);if(t.charCodeAt(0)===36)return"$"+sn(e,t.substr(t.charAt(1)==" "?2:1),r);var n,a,i,l,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Ks(c,t.length);if(t.match(/^[#?]+$/))return n=""+r,r===0&&(n=""),n.length>t.length?n:Or(t.substr(0,t.length-n.length))+n;if(a=t.match(Hk))return mI(a,c,u);if(t.match(/^#+0+$/))return u+Ks(c,t.length-t.indexOf("0"));if(a=t.match(Gk))return n=(""+r).replace(/^([^\.]+)$/,"$1."+Or(a[1])).replace(/\.$/,"."+Or(a[1])),n=n.replace(/\.(\d*)$/,function(x,p){return"."+p+Dt("0",Or(a[1]).length-p.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return u+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return u+Yn(""+c);if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+sn(e,t,-r):Yn(""+r)+"."+Dt("0",a[1].length);if(a=t.match(/^#,#*,#0/))return sn(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=so(sn(e,t.replace(/[\\-]/g,""),r)),i=0,so(so(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return i<n.length?n.charAt(i++):x==="0"?"0":""}));if(t.match(Xk))return n=sn(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var d="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),l=Ad(c,Math.pow(10,i)-1,!1),n=""+u,d=Nn("n",a[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),n+=d+a[2]+"/"+a[3],d=Td(l[2],i),d.length<a[4].length&&(d=Or(a[4].substr(a[4].length-d.length))+d),n+=d,n;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),l=Ad(c,Math.pow(10,i)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Cx(l[1],i)+a[2]+"/"+a[3]+Td(l[2],i):Dt(" ",2*i+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return n=""+r,t.length<=n.length?n:Or(t.substr(0,t.length-n.length))+n;if(a=t.match(/^([#0]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=n.indexOf(".");var f=t.indexOf(".")-i,h=t.length-n.length-f;return Or(t.substr(0,f)+n+t.substr(t.length-h))}if(a=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+sn(e,t,-r):Yn(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?Ks(0,3-x.length):"")+x})+"."+Ks(0,a[1].length);switch(t){case"###,###":case"##,###":case"#,###":var m=Yn(""+c);return m!=="0"?u+m:"";default:if(t.match(/\.[0#?]*$/))return sn(e,t.slice(0,t.lastIndexOf(".")),r)+Or(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Nn(e,t,r){return(r|0)===r?sn(e,t,r):ys(e,t,r)}function yI(e){for(var t=[],r=!1,s=0,n=0;s<e.length;++s)switch(e.charCodeAt(s)){case 34:r=!r;break;case 95:case 42:case 92:++s;break;case 59:t[t.length]=e.substr(n,s-n),n=s+1}if(t[t.length]=e.substr(n),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var Yk=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Io(e){for(var t=0,r="",s="";t<e.length;)switch(r=e.charAt(t)){case"G":Cd(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(s=r;e.charAt(t++)!=="]"&&t<e.length;)s+=e.charAt(t);if(s.match(Yk))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function wI(e,t,r,s){for(var n=[],a="",i=0,l="",c="t",u,d,f,h="H";i<e.length;)switch(l=e.charAt(i)){case"G":if(!Cd(e,i))throw new Error("unrecognized character "+l+" in "+e);n[n.length]={t:"G",v:"General"},i+=7;break;case'"':for(a="";(f=e.charCodeAt(++i))!==34&&i<e.length;)a+=String.fromCharCode(f);n[n.length]={t:"t",v:a},++i;break;case"\\":var m=e.charAt(++i),x=m==="("||m===")"?m:"t";n[n.length]={t:x,v:m},++i;break;case"_":n[n.length]={t:"t",v:" "},i+=2;break;case"@":n[n.length]={t:"T",v:t},++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2"){if(u==null&&(u=$a(t,r,e.charAt(i+1)==="2"),u==null))return"";n[n.length]={t:"X",v:e.substr(i,2)},c=l,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=$a(t,r),u==null))return"";for(a=l;++i<e.length&&e.charAt(i).toLowerCase()===l;)a+=l;l==="m"&&c.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=h),n[n.length]={t:l,v:a},c=l;break;case"A":case"a":case"":var p={t:l,v:l};if(u==null&&(u=$a(t,r)),e.substr(i,3).toUpperCase()==="A/P"?(u!=null&&(p.v=u.H>=12?"P":"A"),p.t="T",h="h",i+=3):e.substr(i,5).toUpperCase()==="AM/PM"?(u!=null&&(p.v=u.H>=12?"PM":"AM"),p.t="T",i+=5,h="h"):e.substr(i,5).toUpperCase()==="/"?(u!=null&&(p.v=u.H>=12?"":""),p.t="T",i+=5,h="h"):(p.t="t",++i),u==null&&p.t==="T")return"";n[n.length]=p,c=l;break;case"[":for(a=l;e.charAt(i++)!=="]"&&i<e.length;)a+=e.charAt(i);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(Yk)){if(u==null&&(u=$a(t,r),u==null))return"";n[n.length]={t:"Z",v:a.toLowerCase()},c=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",Io(e)||(n[n.length]={t:"t",v:a}));break;case".":if(u!=null){for(a=l;++i<e.length&&(l=e.charAt(i))==="0";)a+=l;n[n.length]={t:"s",v:a};break}case"0":case"#":for(a=l;++i<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(i))>-1;)a+=l;n[n.length]={t:"n",v:a};break;case"?":for(a=l;e.charAt(++i)===l;)a+=l;n[n.length]={t:l,v:a},c=l;break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":n[n.length]={t:s===1?"t":l,v:l},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=l;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;)a+=e.charAt(i);n[n.length]={t:"D",v:a};break;case" ":n[n.length]={t:l,v:l},++i;break;case"$":n[n.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);n[n.length]={t:"t",v:l},++i;break}var g=0,w=0,v;for(i=n.length-1,c="t";i>=0;--i)switch(n[i].t){case"h":case"H":n[i].t=h,c="h",g<1&&(g=1);break;case"s":(v=n[i].v.match(/\.0+$/))&&(w=Math.max(w,v[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":c=n[i].t;break;case"m":c==="s"&&(n[i].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&n[i].v.match(/[Hh]/)&&(g=1),g<2&&n[i].v.match(/[Mm]/)&&(g=2),g<3&&n[i].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var y="",b;for(i=0;i<n.length;++i)switch(n[i].t){case"t":case"T":case" ":case"D":break;case"X":n[i].v="",n[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":n[i].v=uI(n[i].t.charCodeAt(0),n[i].v,u,w),n[i].t="t";break;case"n":case"?":for(b=i+1;n[b]!=null&&((l=n[b].t)==="?"||l==="D"||(l===" "||l==="t")&&n[b+1]!=null&&(n[b+1].t==="?"||n[b+1].t==="t"&&n[b+1].v==="/")||n[i].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(n[b].v==="/"||n[b].v===" "&&n[b+1]!=null&&n[b+1].t=="?"));)n[i].v+=n[b].v,n[b]={v:"",t:";"},++b;y+=n[i].v,i=b-1;break;case"G":n[i].t="t",n[i].v=si(t,r);break}var S="",_,k;if(y.length>0){y.charCodeAt(0)==40?(_=t<0&&y.charCodeAt(0)===45?-t:t,k=Nn("n",y,_)):(_=t<0&&s>1?-t:t,k=Nn("n",y,_),_<0&&n[0]&&n[0].t=="t"&&(k=k.substr(1),n[0].v="-"+n[0].v)),b=k.length-1;var E=n.length;for(i=0;i<n.length;++i)if(n[i]!=null&&n[i].t!="t"&&n[i].v.indexOf(".")>-1){E=i;break}var T=n.length;if(E===n.length&&k.indexOf("E")===-1){for(i=n.length-1;i>=0;--i)n[i]==null||"n?".indexOf(n[i].t)===-1||(b>=n[i].v.length-1?(b-=n[i].v.length,n[i].v=k.substr(b+1,n[i].v.length)):b<0?n[i].v="":(n[i].v=k.substr(0,b+1),b=-1),n[i].t="t",T=i);b>=0&&T<n.length&&(n[T].v=k.substr(0,b+1)+n[T].v)}else if(E!==n.length&&k.indexOf("E")===-1){for(b=k.indexOf(".")-1,i=E;i>=0;--i)if(!(n[i]==null||"n?".indexOf(n[i].t)===-1)){for(d=n[i].v.indexOf(".")>-1&&i===E?n[i].v.indexOf(".")-1:n[i].v.length-1,S=n[i].v.substr(d+1);d>=0;--d)b>=0&&(n[i].v.charAt(d)==="0"||n[i].v.charAt(d)==="#")&&(S=k.charAt(b--)+S);n[i].v=S,n[i].t="t",T=i}for(b>=0&&T<n.length&&(n[T].v=k.substr(0,b+1)+n[T].v),b=k.indexOf(".")+1,i=E;i<n.length;++i)if(!(n[i]==null||"n?(".indexOf(n[i].t)===-1&&i!==E)){for(d=n[i].v.indexOf(".")>-1&&i===E?n[i].v.indexOf(".")+1:0,S=n[i].v.substr(0,d);d<n[i].v.length;++d)b<k.length&&(S+=k.charAt(b++));n[i].v=S,n[i].t="t",T=i}}}for(i=0;i<n.length;++i)n[i]!=null&&"n?".indexOf(n[i].t)>-1&&(_=s>1&&t<0&&i>0&&n[i-1].v==="-"?-t:t,n[i].v=Nn(n[i].t,n[i].v,_),n[i].t="t");var M="";for(i=0;i!==n.length;++i)n[i]!=null&&(M+=n[i].v);return M}var T1=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function C1(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function bI(e,t){var r=yI(e),s=r.length,n=r[s-1].indexOf("@");if(s<4&&n>-1&&--s,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||n>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=n>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=n>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=n>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[s,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var i=r[0].match(T1),l=r[1].match(T1);return C1(t,i)?[s,r[0]]:C1(t,l)?[s,r[1]]:[s,r[i!=null&&l!=null?2:1]]}return[s,a]}function Os(e,t,r){r==null&&(r={});var s="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?s=r.dateNF:s=e;break;case"number":e==14&&r.dateNF?s=r.dateNF:s=(r.table!=null?r.table:$e)[e],s==null&&(s=r.table&&r.table[N1[e]]||$e[N1[e]]),s==null&&(s=sI[e]||"General");break}if(Cd(s,0))return si(t,r);t instanceof Date&&(t=Vk(t,r.date1904));var n=bI(s,t);if(Cd(n[1]))return si(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return wI(n[1],t,r,n[0])}function En(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if($e[r]==null){t<0&&(t=r);continue}if($e[r]==e){t=r;break}}t<0&&(t=391)}return $e[t]=e,t}function p0(e){for(var t=0;t!=392;++t)e[t]!==void 0&&En(e[t],t)}function Oo(){$e=rI()}var _I={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Jk=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function SI(e){var t=typeof e=="number"?$e[e]:e;return t=t.replace(Jk,"(\\d+)"),new RegExp("^"+t+"$")}function kI(e,t,r){var s=-1,n=-1,a=-1,i=-1,l=-1,c=-1;(t.match(Jk)||[]).forEach(function(f,h){var m=parseInt(r[h+1],10);switch(f.toLowerCase().charAt(0)){case"y":s=m;break;case"d":a=m;break;case"h":i=m;break;case"s":c=m;break;case"m":i>=0?l=m:n=m;break}}),c>=0&&l==-1&&n>=0&&(l=n,n=-1);var u=(""+(s>=0?s:new Date().getFullYear())).slice(-4)+"-"+("00"+(n>=1?n:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var d=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return i==-1&&l==-1&&c==-1?u:s==-1&&n==-1&&a==-1?d:u+"T"+d}var NI=function(){var e={};e.version="1.2.0";function t(){for(var k=0,E=new Array(256),T=0;T!=256;++T)k=T,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,E[T]=k;return typeof Int32Array<"u"?new Int32Array(E):E}var r=t();function s(k){var E=0,T=0,M=0,q=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(M=0;M!=256;++M)q[M]=k[M];for(M=0;M!=256;++M)for(T=k[M],E=256+M;E<4096;E+=256)T=q[E]=T>>>8^k[T&255];var D=[];for(M=1;M!=16;++M)D[M-1]=typeof Int32Array<"u"?q.subarray(M*256,M*256+256):q.slice(M*256,M*256+256);return D}var n=s(r),a=n[0],i=n[1],l=n[2],c=n[3],u=n[4],d=n[5],f=n[6],h=n[7],m=n[8],x=n[9],p=n[10],g=n[11],w=n[12],v=n[13],y=n[14];function b(k,E){for(var T=E^-1,M=0,q=k.length;M<q;)T=T>>>8^r[(T^k.charCodeAt(M++))&255];return~T}function S(k,E){for(var T=E^-1,M=k.length-15,q=0;q<M;)T=y[k[q++]^T&255]^v[k[q++]^T>>8&255]^w[k[q++]^T>>16&255]^g[k[q++]^T>>>24]^p[k[q++]]^x[k[q++]]^m[k[q++]]^h[k[q++]]^f[k[q++]]^d[k[q++]]^u[k[q++]]^c[k[q++]]^l[k[q++]]^i[k[q++]]^a[k[q++]]^r[k[q++]];for(M+=15;q<M;)T=T>>>8^r[(T^k[q++])&255];return~T}function _(k,E){for(var T=E^-1,M=0,q=k.length,D=0,W=0;M<q;)D=k.charCodeAt(M++),D<128?T=T>>>8^r[(T^D)&255]:D<2048?(T=T>>>8^r[(T^(192|D>>6&31))&255],T=T>>>8^r[(T^(128|D&63))&255]):D>=55296&&D<57344?(D=(D&1023)+64,W=k.charCodeAt(M++)&1023,T=T>>>8^r[(T^(240|D>>8&7))&255],T=T>>>8^r[(T^(128|D>>2&63))&255],T=T>>>8^r[(T^(128|W>>6&15|(D&3)<<4))&255],T=T>>>8^r[(T^(128|W&63))&255]):(T=T>>>8^r[(T^(224|D>>12&15))&255],T=T>>>8^r[(T^(128|D>>6&63))&255],T=T>>>8^r[(T^(128|D&63))&255]);return~T}return e.table=r,e.bstr=b,e.buf=S,e.str=_,e}(),Be=function(){var t={};t.version="1.2.1";function r(N,R){for(var C=N.split("/"),F=R.split("/"),I=0,O=0,re=Math.min(C.length,F.length);I<re;++I){if(O=C[I].length-F[I].length)return O;if(C[I]!=F[I])return C[I]<F[I]?-1:1}return C.length-F.length}function s(N){if(N.charAt(N.length-1)=="/")return N.slice(0,-1).indexOf("/")===-1?N:s(N.slice(0,-1));var R=N.lastIndexOf("/");return R===-1?N:N.slice(0,R+1)}function n(N){if(N.charAt(N.length-1)=="/")return n(N.slice(0,-1));var R=N.lastIndexOf("/");return R===-1?N:N.slice(R+1)}function a(N,R){typeof R=="string"&&(R=new Date(R));var C=R.getHours();C=C<<6|R.getMinutes(),C=C<<5|R.getSeconds()>>>1,N.write_shift(2,C);var F=R.getFullYear()-1980;F=F<<4|R.getMonth()+1,F=F<<5|R.getDate(),N.write_shift(2,F)}function i(N){var R=N.read_shift(2)&65535,C=N.read_shift(2)&65535,F=new Date,I=C&31;C>>>=5;var O=C&15;C>>>=4,F.setMilliseconds(0),F.setFullYear(C+1980),F.setMonth(O-1),F.setDate(I);var re=R&31;R>>>=5;var he=R&63;return R>>>=6,F.setHours(R),F.setMinutes(he),F.setSeconds(re<<1),F}function l(N){mr(N,0);for(var R={},C=0;N.l<=N.length-4;){var F=N.read_shift(2),I=N.read_shift(2),O=N.l+I,re={};switch(F){case 21589:C=N.read_shift(1),C&1&&(re.mtime=N.read_shift(4)),I>5&&(C&2&&(re.atime=N.read_shift(4)),C&4&&(re.ctime=N.read_shift(4))),re.mtime&&(re.mt=new Date(re.mtime*1e3));break}N.l=O,R[F]=re}return R}var c;function u(){return c||(c={})}function d(N,R){if(N[0]==80&&N[1]==75)return xs(N,R);if((N[0]|32)==109&&(N[1]|32)==105)return Mo(N,R);if(N.length<512)throw new Error("CFB file size "+N.length+" < 512");var C=3,F=512,I=0,O=0,re=0,he=0,te=0,se=[],ae=N.slice(0,512);mr(ae,0);var be=f(ae);switch(C=be[0],C){case 3:F=512;break;case 4:F=4096;break;case 0:if(be[1]==0)return xs(N,R);default:throw new Error("Major Version: Expected 3 or 4 saw "+C)}F!==512&&(ae=N.slice(0,F),mr(ae,28));var Ee=N.slice(0,F);h(ae,C);var Ie=ae.read_shift(4,"i");if(C===3&&Ie!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ie);ae.l+=4,re=ae.read_shift(4,"i"),ae.l+=4,ae.chk("00100000","Mini Stream Cutoff Size: "),he=ae.read_shift(4,"i"),I=ae.read_shift(4,"i"),te=ae.read_shift(4,"i"),O=ae.read_shift(4,"i");for(var Se=-1,Pe=0;Pe<109&&(Se=ae.read_shift(4,"i"),!(Se<0));++Pe)se[Pe]=Se;var He=m(N,F);g(te,O,He,F,se);var Nt=v(He,re,se,F);Nt[re].name="!Directory",I>0&&he!==W&&(Nt[he].name="!MiniFAT"),Nt[se[0]].name="!FAT",Nt.fat_addrs=se,Nt.ssz=F;var Et={},vr=[],Bo=[],Uo=[];y(re,Nt,He,vr,I,Et,Bo,he),x(Bo,Uo,vr),vr.shift();var zo={FileIndex:Bo,FullPaths:Uo};return R&&R.raw&&(zo.raw={header:Ee,sectors:He}),zo}function f(N){if(N[N.l]==80&&N[N.l+1]==75)return[0,0];N.chk(ee,"Header Signature: "),N.l+=16;var R=N.read_shift(2,"u");return[N.read_shift(2,"u"),R]}function h(N,R){var C=9;switch(N.l+=2,C=N.read_shift(2)){case 9:if(R!=3)throw new Error("Sector Shift: Expected 9 saw "+C);break;case 12:if(R!=4)throw new Error("Sector Shift: Expected 12 saw "+C);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+C)}N.chk("0600","Mini Sector Shift: "),N.chk("000000000000","Reserved: ")}function m(N,R){for(var C=Math.ceil(N.length/R)-1,F=[],I=1;I<C;++I)F[I-1]=N.slice(I*R,(I+1)*R);return F[C-1]=N.slice(C*R),F}function x(N,R,C){for(var F=0,I=0,O=0,re=0,he=0,te=C.length,se=[],ae=[];F<te;++F)se[F]=ae[F]=F,R[F]=C[F];for(;he<ae.length;++he)F=ae[he],I=N[F].L,O=N[F].R,re=N[F].C,se[F]===F&&(I!==-1&&se[I]!==I&&(se[F]=se[I]),O!==-1&&se[O]!==O&&(se[F]=se[O])),re!==-1&&(se[re]=F),I!==-1&&F!=se[F]&&(se[I]=se[F],ae.lastIndexOf(I)<he&&ae.push(I)),O!==-1&&F!=se[F]&&(se[O]=se[F],ae.lastIndexOf(O)<he&&ae.push(O));for(F=1;F<te;++F)se[F]===F&&(O!==-1&&se[O]!==O?se[F]=se[O]:I!==-1&&se[I]!==I&&(se[F]=se[I]));for(F=1;F<te;++F)if(N[F].type!==0){if(he=F,he!=se[he])do he=se[he],R[F]=R[he]+"/"+R[F];while(he!==0&&se[he]!==-1&&he!=se[he]);se[F]=-1}for(R[0]+="/",F=1;F<te;++F)N[F].type!==2&&(R[F]+="/")}function p(N,R,C){for(var F=N.start,I=N.size,O=[],re=F;C&&I>0&&re>=0;)O.push(R.slice(re*D,re*D+D)),I-=D,re=Oa(C,re*4);return O.length===0?de(0):ir(O).slice(0,N.size)}function g(N,R,C,F,I){var O=W;if(N===W){if(R!==0)throw new Error("DIFAT chain shorter than expected")}else if(N!==-1){var re=C[N],he=(F>>>2)-1;if(!re)return;for(var te=0;te<he&&(O=Oa(re,te*4))!==W;++te)I.push(O);g(Oa(re,F-4),R-1,C,F,I)}}function w(N,R,C,F,I){var O=[],re=[];I||(I=[]);var he=F-1,te=0,se=0;for(te=R;te>=0;){I[te]=!0,O[O.length]=te,re.push(N[te]);var ae=C[Math.floor(te*4/F)];if(se=te*4&he,F<4+se)throw new Error("FAT boundary crossed: "+te+" 4 "+F);if(!N[ae])break;te=Oa(N[ae],se)}return{nodes:O,data:z1([re])}}function v(N,R,C,F){var I=N.length,O=[],re=[],he=[],te=[],se=F-1,ae=0,be=0,Ee=0,Ie=0;for(ae=0;ae<I;++ae)if(he=[],Ee=ae+R,Ee>=I&&(Ee-=I),!re[Ee]){te=[];var Se=[];for(be=Ee;be>=0;){Se[be]=!0,re[be]=!0,he[he.length]=be,te.push(N[be]);var Pe=C[Math.floor(be*4/F)];if(Ie=be*4&se,F<4+Ie)throw new Error("FAT boundary crossed: "+be+" 4 "+F);if(!N[Pe]||(be=Oa(N[Pe],Ie),Se[be]))break}O[Ee]={nodes:he,data:z1([te])}}return O}function y(N,R,C,F,I,O,re,he){for(var te=0,se=F.length?2:0,ae=R[N].data,be=0,Ee=0,Ie;be<ae.length;be+=128){var Se=ae.slice(be,be+128);mr(Se,64),Ee=Se.read_shift(2),Ie=Lx(Se,0,Ee-se),F.push(Ie);var Pe={name:Ie,type:Se.read_shift(1),color:Se.read_shift(1),L:Se.read_shift(4,"i"),R:Se.read_shift(4,"i"),C:Se.read_shift(4,"i"),clsid:Se.read_shift(16),state:Se.read_shift(4,"i"),start:0,size:0},He=Se.read_shift(2)+Se.read_shift(2)+Se.read_shift(2)+Se.read_shift(2);He!==0&&(Pe.ct=b(Se,Se.l-8));var Nt=Se.read_shift(2)+Se.read_shift(2)+Se.read_shift(2)+Se.read_shift(2);Nt!==0&&(Pe.mt=b(Se,Se.l-8)),Pe.start=Se.read_shift(4,"i"),Pe.size=Se.read_shift(4,"i"),Pe.size<0&&Pe.start<0&&(Pe.size=Pe.type=0,Pe.start=W,Pe.name=""),Pe.type===5?(te=Pe.start,I>0&&te!==W&&(R[te].name="!StreamData")):Pe.size>=4096?(Pe.storage="fat",R[Pe.start]===void 0&&(R[Pe.start]=w(C,Pe.start,R.fat_addrs,R.ssz)),R[Pe.start].name=Pe.name,Pe.content=R[Pe.start].data.slice(0,Pe.size)):(Pe.storage="minifat",Pe.size<0?Pe.size=0:te!==W&&Pe.start!==W&&R[te]&&(Pe.content=p(Pe,R[te].data,(R[he]||{}).data))),Pe.content&&mr(Pe.content,0),O[Ie]=Pe,re.push(Pe)}}function b(N,R){return new Date((ns(N,R+4)/1e7*Math.pow(2,32)+ns(N,R)/1e7-11644473600)*1e3)}function S(N,R){return u(),d(c.readFileSync(N),R)}function _(N,R){var C=R&&R.type;switch(C||Qe&&Buffer.isBuffer(N)&&(C="buffer"),C||"base64"){case"file":return S(N,R);case"base64":return d(os(fs(N)),R);case"binary":return d(os(N),R)}return d(N,R)}function k(N,R){var C=R||{},F=C.root||"Root Entry";if(N.FullPaths||(N.FullPaths=[]),N.FileIndex||(N.FileIndex=[]),N.FullPaths.length!==N.FileIndex.length)throw new Error("inconsistent CFB structure");N.FullPaths.length===0&&(N.FullPaths[0]=F+"/",N.FileIndex[0]={name:F,type:5}),C.CLSID&&(N.FileIndex[0].clsid=C.CLSID),E(N)}function E(N){var R="Sh33tJ5";if(!Be.find(N,"/"+R)){var C=de(4);C[0]=55,C[1]=C[3]=50,C[2]=54,N.FileIndex.push({name:R,type:2,content:C,size:4,L:69,R:69,C:69}),N.FullPaths.push(N.FullPaths[0]+R),T(N)}}function T(N,R){k(N);for(var C=!1,F=!1,I=N.FullPaths.length-1;I>=0;--I){var O=N.FileIndex[I];switch(O.type){case 0:F?C=!0:(N.FileIndex.pop(),N.FullPaths.pop());break;case 1:case 2:case 5:F=!0,isNaN(O.R*O.L*O.C)&&(C=!0),O.R>-1&&O.L>-1&&O.R==O.L&&(C=!0);break;default:C=!0;break}}if(!(!C&&!R)){var re=new Date(1987,1,19),he=0,te=Object.create?Object.create(null):{},se=[];for(I=0;I<N.FullPaths.length;++I)te[N.FullPaths[I]]=!0,N.FileIndex[I].type!==0&&se.push([N.FullPaths[I],N.FileIndex[I]]);for(I=0;I<se.length;++I){var ae=s(se[I][0]);F=te[ae],F||(se.push([ae,{name:n(ae).replace("/",""),type:1,clsid:G,ct:re,mt:re,content:null}]),te[ae]=!0)}for(se.sort(function(Ie,Se){return r(Ie[0],Se[0])}),N.FullPaths=[],N.FileIndex=[],I=0;I<se.length;++I)N.FullPaths[I]=se[I][0],N.FileIndex[I]=se[I][1];for(I=0;I<se.length;++I){var be=N.FileIndex[I],Ee=N.FullPaths[I];if(be.name=n(Ee).replace("/",""),be.L=be.R=be.C=-(be.color=1),be.size=be.content?be.content.length:0,be.start=0,be.clsid=be.clsid||G,I===0)be.C=se.length>1?1:-1,be.size=0,be.type=5;else if(Ee.slice(-1)=="/"){for(he=I+1;he<se.length&&s(N.FullPaths[he])!=Ee;++he);for(be.C=he>=se.length?-1:he,he=I+1;he<se.length&&s(N.FullPaths[he])!=s(Ee);++he);be.R=he>=se.length?-1:he,be.type=1}else s(N.FullPaths[I+1]||"")==s(Ee)&&(be.R=I+1),be.type=2}}}function M(N,R){var C=R||{};if(C.fileType=="mad")return hg(N,C);switch(T(N),C.fileType){case"zip":return es(N,C)}var F=function(Ie){for(var Se=0,Pe=0,He=0;He<Ie.FileIndex.length;++He){var Nt=Ie.FileIndex[He];if(Nt.content){var Et=Nt.content.length;Et>0&&(Et<4096?Se+=Et+63>>6:Pe+=Et+511>>9)}}for(var vr=Ie.FullPaths.length+3>>2,Bo=Se+7>>3,Uo=Se+127>>7,zo=Bo+Pe+vr+Uo,ka=zo+127>>7,j0=ka<=109?0:Math.ceil((ka-109)/127);zo+ka+j0+127>>7>ka;)j0=++ka<=109?0:Math.ceil((ka-109)/127);var xn=[1,j0,ka,Uo,vr,Pe,Se,0];return Ie.FileIndex[0].size=Se<<6,xn[7]=(Ie.FileIndex[0].start=xn[0]+xn[1]+xn[2]+xn[3]+xn[4]+xn[5])+(xn[6]+7>>3),xn}(N),I=de(F[7]<<9),O=0,re=0;{for(O=0;O<8;++O)I.write_shift(1,Y[O]);for(O=0;O<8;++O)I.write_shift(2,0);for(I.write_shift(2,62),I.write_shift(2,3),I.write_shift(2,65534),I.write_shift(2,9),I.write_shift(2,6),O=0;O<3;++O)I.write_shift(2,0);for(I.write_shift(4,0),I.write_shift(4,F[2]),I.write_shift(4,F[0]+F[1]+F[2]+F[3]-1),I.write_shift(4,0),I.write_shift(4,4096),I.write_shift(4,F[3]?F[0]+F[1]+F[2]-1:W),I.write_shift(4,F[3]),I.write_shift(-4,F[1]?F[0]-1:W),I.write_shift(4,F[1]),O=0;O<109;++O)I.write_shift(-4,O<F[2]?F[1]+O:-1)}if(F[1])for(re=0;re<F[1];++re){for(;O<236+re*127;++O)I.write_shift(-4,O<F[2]?F[1]+O:-1);I.write_shift(-4,re===F[1]-1?W:re+1)}var he=function(Ie){for(re+=Ie;O<re-1;++O)I.write_shift(-4,O+1);Ie&&(++O,I.write_shift(-4,W))};for(re=O=0,re+=F[1];O<re;++O)I.write_shift(-4,ce.DIFSECT);for(re+=F[2];O<re;++O)I.write_shift(-4,ce.FATSECT);he(F[3]),he(F[4]);for(var te=0,se=0,ae=N.FileIndex[0];te<N.FileIndex.length;++te)ae=N.FileIndex[te],ae.content&&(se=ae.content.length,!(se<4096)&&(ae.start=re,he(se+511>>9)));for(he(F[6]+7>>3);I.l&511;)I.write_shift(-4,ce.ENDOFCHAIN);for(re=O=0,te=0;te<N.FileIndex.length;++te)ae=N.FileIndex[te],ae.content&&(se=ae.content.length,!(!se||se>=4096)&&(ae.start=re,he(se+63>>6)));for(;I.l&511;)I.write_shift(-4,ce.ENDOFCHAIN);for(O=0;O<F[4]<<2;++O){var be=N.FullPaths[O];if(!be||be.length===0){for(te=0;te<17;++te)I.write_shift(4,0);for(te=0;te<3;++te)I.write_shift(4,-1);for(te=0;te<12;++te)I.write_shift(4,0);continue}ae=N.FileIndex[O],O===0&&(ae.start=ae.size?ae.start-1:W);var Ee=O===0&&C.root||ae.name;if(se=2*(Ee.length+1),I.write_shift(64,Ee,"utf16le"),I.write_shift(2,se),I.write_shift(1,ae.type),I.write_shift(1,ae.color),I.write_shift(-4,ae.L),I.write_shift(-4,ae.R),I.write_shift(-4,ae.C),ae.clsid)I.write_shift(16,ae.clsid,"hex");else for(te=0;te<4;++te)I.write_shift(4,0);I.write_shift(4,ae.state||0),I.write_shift(4,0),I.write_shift(4,0),I.write_shift(4,0),I.write_shift(4,0),I.write_shift(4,ae.start),I.write_shift(4,ae.size),I.write_shift(4,0)}for(O=1;O<N.FileIndex.length;++O)if(ae=N.FileIndex[O],ae.size>=4096)if(I.l=ae.start+1<<9,Qe&&Buffer.isBuffer(ae.content))ae.content.copy(I,I.l,0,ae.size),I.l+=ae.size+511&-512;else{for(te=0;te<ae.size;++te)I.write_shift(1,ae.content[te]);for(;te&511;++te)I.write_shift(1,0)}for(O=1;O<N.FileIndex.length;++O)if(ae=N.FileIndex[O],ae.size>0&&ae.size<4096)if(Qe&&Buffer.isBuffer(ae.content))ae.content.copy(I,I.l,0,ae.size),I.l+=ae.size+63&-64;else{for(te=0;te<ae.size;++te)I.write_shift(1,ae.content[te]);for(;te&63;++te)I.write_shift(1,0)}if(Qe)I.l=I.length;else for(;I.l<I.length;)I.write_shift(1,0);return I}function q(N,R){var C=N.FullPaths.map(function(te){return te.toUpperCase()}),F=C.map(function(te){var se=te.split("/");return se[se.length-(te.slice(-1)=="/"?2:1)]}),I=!1;R.charCodeAt(0)===47?(I=!0,R=C[0].slice(0,-1)+R):I=R.indexOf("/")!==-1;var O=R.toUpperCase(),re=I===!0?C.indexOf(O):F.indexOf(O);if(re!==-1)return N.FileIndex[re];var he=!O.match(al);for(O=O.replace(Ur,""),he&&(O=O.replace(al,"!")),re=0;re<C.length;++re)if((he?C[re].replace(al,"!"):C[re]).replace(Ur,"")==O||(he?F[re].replace(al,"!"):F[re]).replace(Ur,"")==O)return N.FileIndex[re];return null}var D=64,W=-2,ee="d0cf11e0a1b11ae1",Y=[208,207,17,224,161,177,26,225],G="00000000000000000000000000000000",ce={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:W,FREESECT:-1,HEADER_SIGNATURE:ee,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:G,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Q(N,R,C){u();var F=M(N,C);c.writeFileSync(R,F)}function B(N){for(var R=new Array(N.length),C=0;C<N.length;++C)R[C]=String.fromCharCode(N[C]);return R.join("")}function me(N,R){var C=M(N,R);switch(R&&R.type||"buffer"){case"file":return u(),c.writeFileSync(R.filename,C),C;case"binary":return typeof C=="string"?C:B(C);case"base64":return ic(typeof C=="string"?C:B(C));case"buffer":if(Qe)return Buffer.isBuffer(C)?C:Dn(C);case"array":return typeof C=="string"?os(C):C}return C}var fe;function A(N){try{var R=N.InflateRaw,C=new R;if(C._processChunk(new Uint8Array([3,0]),C._finishFlushFlag),C.bytesRead)fe=N;else throw new Error("zlib does not expose bytesRead")}catch(F){console.error("cannot use native zlib: "+(F.message||F))}}function V(N,R){if(!fe)return Rr(N,R);var C=fe.InflateRaw,F=new C,I=F._processChunk(N.slice(N.l),F._finishFlushFlag);return N.l+=F.bytesRead,I}function L(N){return fe?fe.deflateRawSync(N):Fe(N)}var U=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ne=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],xe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function pe(N){var R=(N<<1|N<<11)&139536|(N<<5|N<<15)&558144;return(R>>16|R>>8|R)&255}for(var oe=typeof Uint8Array<"u",ue=oe?new Uint8Array(256):[],we=0;we<256;++we)ue[we]=pe(we);function P(N,R){var C=ue[N&255];return R<=8?C>>>8-R:(C=C<<8|ue[N>>8&255],R<=16?C>>>16-R:(C=C<<8|ue[N>>16&255],C>>>24-R))}function Me(N,R){var C=R&7,F=R>>>3;return(N[F]|(C<=6?0:N[F+1]<<8))>>>C&3}function je(N,R){var C=R&7,F=R>>>3;return(N[F]|(C<=5?0:N[F+1]<<8))>>>C&7}function X(N,R){var C=R&7,F=R>>>3;return(N[F]|(C<=4?0:N[F+1]<<8))>>>C&15}function z(N,R){var C=R&7,F=R>>>3;return(N[F]|(C<=3?0:N[F+1]<<8))>>>C&31}function H(N,R){var C=R&7,F=R>>>3;return(N[F]|(C<=1?0:N[F+1]<<8))>>>C&127}function Z(N,R,C){var F=R&7,I=R>>>3,O=(1<<C)-1,re=N[I]>>>F;return C<8-F||(re|=N[I+1]<<8-F,C<16-F)||(re|=N[I+2]<<16-F,C<24-F)||(re|=N[I+3]<<24-F),re&O}function J(N,R,C){var F=R&7,I=R>>>3;return F<=5?N[I]|=(C&7)<<F:(N[I]|=C<<F&255,N[I+1]=(C&7)>>8-F),R+3}function K(N,R,C){var F=R&7,I=R>>>3;return C=(C&1)<<F,N[I]|=C,R+1}function le(N,R,C){var F=R&7,I=R>>>3;return C<<=F,N[I]|=C&255,C>>>=8,N[I+1]=C,R+8}function ye(N,R,C){var F=R&7,I=R>>>3;return C<<=F,N[I]|=C&255,C>>>=8,N[I+1]=C&255,N[I+2]=C>>>8,R+16}function Re(N,R){var C=N.length,F=2*C>R?2*C:R+5,I=0;if(C>=R)return N;if(Qe){var O=_1(F);if(N.copy)N.copy(O);else for(;I<N.length;++I)O[I]=N[I];return O}else if(oe){var re=new Uint8Array(F);if(re.set)re.set(N);else for(;I<C;++I)re[I]=N[I];return re}return N.length=F,N}function Te(N){for(var R=new Array(N),C=0;C<N;++C)R[C]=0;return R}function Ue(N,R,C){var F=1,I=0,O=0,re=0,he=0,te=N.length,se=oe?new Uint16Array(32):Te(32);for(O=0;O<32;++O)se[O]=0;for(O=te;O<C;++O)N[O]=0;te=N.length;var ae=oe?new Uint16Array(te):Te(te);for(O=0;O<te;++O)se[I=N[O]]++,F<I&&(F=I),ae[O]=0;for(se[0]=0,O=1;O<=F;++O)se[O+16]=he=he+se[O-1]<<1;for(O=0;O<te;++O)he=N[O],he!=0&&(ae[O]=se[he+16]++);var be=0;for(O=0;O<te;++O)if(be=N[O],be!=0)for(he=P(ae[O],F)>>F-be,re=(1<<F+4-be)-1;re>=0;--re)R[he|re<<be]=be&15|O<<4;return F}var it=oe?new Uint16Array(512):Te(512),pt=oe?new Uint16Array(32):Te(32);if(!oe){for(var tt=0;tt<512;++tt)it[tt]=0;for(tt=0;tt<32;++tt)pt[tt]=0}(function(){for(var N=[],R=0;R<32;R++)N.push(5);Ue(N,pt,32);var C=[];for(R=0;R<=143;R++)C.push(8);for(;R<=255;R++)C.push(9);for(;R<=279;R++)C.push(7);for(;R<=287;R++)C.push(8);Ue(C,it,288)})();var Ce=function(){for(var R=oe?new Uint8Array(32768):[],C=0,F=0;C<xe.length-1;++C)for(;F<xe[C+1];++F)R[F]=C;for(;F<32768;++F)R[F]=29;var I=oe?new Uint8Array(259):[];for(C=0,F=0;C<ne.length-1;++C)for(;F<ne[C+1];++F)I[F]=C;function O(he,te){for(var se=0;se<he.length;){var ae=Math.min(65535,he.length-se),be=se+ae==he.length;for(te.write_shift(1,+be),te.write_shift(2,ae),te.write_shift(2,~ae&65535);ae-- >0;)te[te.l++]=he[se++]}return te.l}function re(he,te){for(var se=0,ae=0,be=oe?new Uint16Array(32768):[];ae<he.length;){var Ee=Math.min(65535,he.length-ae);if(Ee<10){for(se=J(te,se,+(ae+Ee==he.length)),se&7&&(se+=8-(se&7)),te.l=se/8|0,te.write_shift(2,Ee),te.write_shift(2,~Ee&65535);Ee-- >0;)te[te.l++]=he[ae++];se=te.l*8;continue}se=J(te,se,+(ae+Ee==he.length)+2);for(var Ie=0;Ee-- >0;){var Se=he[ae];Ie=(Ie<<5^Se)&32767;var Pe=-1,He=0;if((Pe=be[Ie])&&(Pe|=ae&-32768,Pe>ae&&(Pe-=32768),Pe<ae))for(;he[Pe+He]==he[ae+He]&&He<250;)++He;if(He>2){Se=I[He],Se<=22?se=le(te,se,ue[Se+1]>>1)-1:(le(te,se,3),se+=5,le(te,se,ue[Se-23]>>5),se+=3);var Nt=Se<8?0:Se-4>>2;Nt>0&&(ye(te,se,He-ne[Se]),se+=Nt),Se=R[ae-Pe],se=le(te,se,ue[Se]>>3),se-=3;var Et=Se<4?0:Se-2>>1;Et>0&&(ye(te,se,ae-Pe-xe[Se]),se+=Et);for(var vr=0;vr<He;++vr)be[Ie]=ae&32767,Ie=(Ie<<5^he[ae])&32767,++ae;Ee-=He-1}else Se<=143?Se=Se+48:se=K(te,se,1),se=le(te,se,ue[Se]),be[Ie]=ae&32767,++ae}se=le(te,se,0)-1}return te.l=(se+7)/8|0,te.l}return function(te,se){return te.length<8?O(te,se):re(te,se)}}();function Fe(N){var R=de(50+Math.floor(N.length*1.1)),C=Ce(N,R);return R.slice(0,C)}var rt=oe?new Uint16Array(32768):Te(32768),sr=oe?new Uint16Array(32768):Te(32768),xt=oe?new Uint16Array(128):Te(128),Vr=1,ve=1;function Ge(N,R){var C=z(N,R)+257;R+=5;var F=z(N,R)+1;R+=5;var I=X(N,R)+4;R+=4;for(var O=0,re=oe?new Uint8Array(19):Te(19),he=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],te=1,se=oe?new Uint8Array(8):Te(8),ae=oe?new Uint8Array(8):Te(8),be=re.length,Ee=0;Ee<I;++Ee)re[U[Ee]]=O=je(N,R),te<O&&(te=O),se[O]++,R+=3;var Ie=0;for(se[0]=0,Ee=1;Ee<=te;++Ee)ae[Ee]=Ie=Ie+se[Ee-1]<<1;for(Ee=0;Ee<be;++Ee)(Ie=re[Ee])!=0&&(he[Ee]=ae[Ie]++);var Se=0;for(Ee=0;Ee<be;++Ee)if(Se=re[Ee],Se!=0){Ie=ue[he[Ee]]>>8-Se;for(var Pe=(1<<7-Se)-1;Pe>=0;--Pe)xt[Ie|Pe<<Se]=Se&7|Ee<<3}var He=[];for(te=1;He.length<C+F;)switch(Ie=xt[H(N,R)],R+=Ie&7,Ie>>>=3){case 16:for(O=3+Me(N,R),R+=2,Ie=He[He.length-1];O-- >0;)He.push(Ie);break;case 17:for(O=3+je(N,R),R+=3;O-- >0;)He.push(0);break;case 18:for(O=11+H(N,R),R+=7;O-- >0;)He.push(0);break;default:He.push(Ie),te<Ie&&(te=Ie);break}var Nt=He.slice(0,C),Et=He.slice(C);for(Ee=C;Ee<286;++Ee)Nt[Ee]=0;for(Ee=F;Ee<30;++Ee)Et[Ee]=0;return Vr=Ue(Nt,rt,286),ve=Ue(Et,sr,30),R}function kt(N,R){if(N[0]==3&&!(N[1]&3))return[da(R),2];for(var C=0,F=0,I=_1(R||1<<18),O=0,re=I.length>>>0,he=0,te=0;!(F&1);){if(F=je(N,C),C+=3,F>>>1)F>>1==1?(he=9,te=5):(C=Ge(N,C),he=Vr,te=ve);else{C&7&&(C+=8-(C&7));var se=N[C>>>3]|N[(C>>>3)+1]<<8;if(C+=32,se>0)for(!R&&re<O+se&&(I=Re(I,O+se),re=I.length);se-- >0;)I[O++]=N[C>>>3],C+=8;continue}for(;;){!R&&re<O+32767&&(I=Re(I,O+32767),re=I.length);var ae=Z(N,C,he),be=F>>>1==1?it[ae]:rt[ae];if(C+=be&15,be>>>=4,!(be>>>8&255))I[O++]=be;else{if(be==256)break;be-=257;var Ee=be<8?0:be-4>>2;Ee>5&&(Ee=0);var Ie=O+ne[be];Ee>0&&(Ie+=Z(N,C,Ee),C+=Ee),ae=Z(N,C,te),be=F>>>1==1?pt[ae]:sr[ae],C+=be&15,be>>>=4;var Se=be<4?0:be-2>>1,Pe=xe[be];for(Se>0&&(Pe+=Z(N,C,Se),C+=Se),!R&&re<Ie&&(I=Re(I,Ie+100),re=I.length);O<Ie;)I[O]=I[O-Pe],++O}}}return R?[I,C+7>>>3]:[I.slice(0,O),C+7>>>3]}function Rr(N,R){var C=N.slice(N.l||0),F=kt(C,R);return N.l+=F[1],F[0]}function Wt(N,R){if(N)typeof console<"u"&&console.error(R);else throw new Error(R)}function xs(N,R){var C=N;mr(C,0);var F=[],I=[],O={FileIndex:F,FullPaths:I};k(O,{root:R.root});for(var re=C.length-4;(C[re]!=80||C[re+1]!=75||C[re+2]!=5||C[re+3]!=6)&&re>=0;)--re;C.l=re+4,C.l+=4;var he=C.read_shift(2);C.l+=6;var te=C.read_shift(4);for(C.l=te,re=0;re<he;++re){C.l+=20;var se=C.read_shift(4),ae=C.read_shift(4),be=C.read_shift(2),Ee=C.read_shift(2),Ie=C.read_shift(2);C.l+=8;var Se=C.read_shift(4),Pe=l(C.slice(C.l+be,C.l+be+Ee));C.l+=be+Ee+Ie;var He=C.l;C.l=Se+4,pn(C,se,ae,O,Pe),C.l=He}return O}function pn(N,R,C,F,I){N.l+=2;var O=N.read_shift(2),re=N.read_shift(2),he=i(N);if(O&8257)throw new Error("Unsupported ZIP encryption");for(var te=N.read_shift(4),se=N.read_shift(4),ae=N.read_shift(4),be=N.read_shift(2),Ee=N.read_shift(2),Ie="",Se=0;Se<be;++Se)Ie+=String.fromCharCode(N[N.l++]);if(Ee){var Pe=l(N.slice(N.l,N.l+Ee));(Pe[21589]||{}).mt&&(he=Pe[21589].mt),((I||{})[21589]||{}).mt&&(he=I[21589].mt)}N.l+=Ee;var He=N.slice(N.l,N.l+se);switch(re){case 8:He=V(N,ae);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+re)}var Nt=!1;O&8&&(te=N.read_shift(4),te==134695760&&(te=N.read_shift(4),Nt=!0),se=N.read_shift(4),ae=N.read_shift(4)),se!=R&&Wt(Nt,"Bad compressed size: "+R+" != "+se),ae!=C&&Wt(Nt,"Bad uncompressed size: "+C+" != "+ae),Bc(F,Ie,He,{unsafe:!0,mt:he})}function es(N,R){var C=R||{},F=[],I=[],O=de(1),re=C.compression?8:0,he=0,te=0,se=0,ae=0,be=0,Ee=N.FullPaths[0],Ie=Ee,Se=N.FileIndex[0],Pe=[],He=0;for(te=1;te<N.FullPaths.length;++te)if(Ie=N.FullPaths[te].slice(Ee.length),Se=N.FileIndex[te],!(!Se.size||!Se.content||Ie=="Sh33tJ5")){var Nt=ae,Et=de(Ie.length);for(se=0;se<Ie.length;++se)Et.write_shift(1,Ie.charCodeAt(se)&127);Et=Et.slice(0,Et.l),Pe[be]=NI.buf(Se.content,0);var vr=Se.content;re==8&&(vr=L(vr)),O=de(30),O.write_shift(4,67324752),O.write_shift(2,20),O.write_shift(2,he),O.write_shift(2,re),Se.mt?a(O,Se.mt):O.write_shift(4,0),O.write_shift(-4,Pe[be]),O.write_shift(4,vr.length),O.write_shift(4,Se.content.length),O.write_shift(2,Et.length),O.write_shift(2,0),ae+=O.length,F.push(O),ae+=Et.length,F.push(Et),ae+=vr.length,F.push(vr),O=de(46),O.write_shift(4,33639248),O.write_shift(2,0),O.write_shift(2,20),O.write_shift(2,he),O.write_shift(2,re),O.write_shift(4,0),O.write_shift(-4,Pe[be]),O.write_shift(4,vr.length),O.write_shift(4,Se.content.length),O.write_shift(2,Et.length),O.write_shift(2,0),O.write_shift(2,0),O.write_shift(2,0),O.write_shift(2,0),O.write_shift(4,0),O.write_shift(4,Nt),He+=O.l,I.push(O),He+=Et.length,I.push(Et),++be}return O=de(22),O.write_shift(4,101010256),O.write_shift(2,0),O.write_shift(2,0),O.write_shift(2,be),O.write_shift(2,be),O.write_shift(4,He),O.write_shift(4,ae),O.write_shift(2,0),ir([ir(F),ir(I),O])}var et={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function gi(N,R){if(N.ctype)return N.ctype;var C=N.name||"",F=C.match(/\.([^\.]+)$/);return F&&et[F[1]]||R&&(F=(C=R).match(/[\.\\]([^\.\\])+$/),F&&et[F[1]])?et[F[1]]:"application/octet-stream"}function S0(N){for(var R=ic(N),C=[],F=0;F<R.length;F+=76)C.push(R.slice(F,F+76));return C.join(`\r
`)+`\r
`}function k0(N){var R=N.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(se){var ae=se.charCodeAt(0).toString(16).toUpperCase();return"="+(ae.length==1?"0"+ae:ae)});R=R.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),R.charAt(0)==`
`&&(R="=0D"+R.slice(1)),R=R.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var C=[],F=R.split(`\r
`),I=0;I<F.length;++I){var O=F[I];if(O.length==0){C.push("");continue}for(var re=0;re<O.length;){var he=76,te=O.slice(re,re+he);te.charAt(he-1)=="="?he--:te.charAt(he-2)=="="?he-=2:te.charAt(he-3)=="="&&(he-=3),te=O.slice(re,re+he),re+=he,re<O.length&&(te+="="),C.push(te)}}return C.join(`\r
`)}function Mc(N){for(var R=[],C=0;C<N.length;++C){for(var F=N[C];C<=N.length&&F.charAt(F.length-1)=="=";)F=F.slice(0,F.length-1)+N[++C];R.push(F)}for(var I=0;I<R.length;++I)R[I]=R[I].replace(/[=][0-9A-Fa-f]{2}/g,function(O){return String.fromCharCode(parseInt(O.slice(1),16))});return os(R.join(`\r
`))}function N0(N,R,C){for(var F="",I="",O="",re,he=0;he<10;++he){var te=R[he];if(!te||te.match(/^\s*$/))break;var se=te.match(/^(.*?):\s*([^\s].*)$/);if(se)switch(se[1].toLowerCase()){case"content-location":F=se[2].trim();break;case"content-type":O=se[2].trim();break;case"content-transfer-encoding":I=se[2].trim();break}}switch(++he,I.toLowerCase()){case"base64":re=os(fs(R.slice(he).join("")));break;case"quoted-printable":re=Mc(R.slice(he));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+I)}var ae=Bc(N,F.slice(C.length),re,{unsafe:!0});O&&(ae.ctype=O)}function Mo(N,R){if(B(N.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var C=R&&R.root||"",F=(Qe&&Buffer.isBuffer(N)?N.toString("binary"):B(N)).split(`\r
`),I=0,O="";for(I=0;I<F.length;++I)if(O=F[I],!!/^Content-Location:/i.test(O)&&(O=O.slice(O.indexOf("file")),C||(C=O.slice(0,O.lastIndexOf("/")+1)),O.slice(0,C.length)!=C))for(;C.length>0&&(C=C.slice(0,C.length-1),C=C.slice(0,C.lastIndexOf("/")+1),O.slice(0,C.length)!=C););var re=(F[1]||"").match(/boundary="(.*?)"/);if(!re)throw new Error("MAD cannot find boundary");var he="--"+(re[1]||""),te=[],se=[],ae={FileIndex:te,FullPaths:se};k(ae);var be,Ee=0;for(I=0;I<F.length;++I){var Ie=F[I];Ie!==he&&Ie!==he+"--"||(Ee++&&N0(ae,F.slice(be,I),C),be=I)}return ae}function hg(N,R){var C=R||{},F=C.boundary||"SheetJS";F="------="+F;for(var I=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+F.slice(2)+'"',"","",""],O=N.FullPaths[0],re=O,he=N.FileIndex[0],te=1;te<N.FullPaths.length;++te)if(re=N.FullPaths[te].slice(O.length),he=N.FileIndex[te],!(!he.size||!he.content||re=="Sh33tJ5")){re=re.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(He){return"_x"+He.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(He){return"_u"+He.charCodeAt(0).toString(16)+"_"});for(var se=he.content,ae=Qe&&Buffer.isBuffer(se)?se.toString("binary"):B(se),be=0,Ee=Math.min(1024,ae.length),Ie=0,Se=0;Se<=Ee;++Se)(Ie=ae.charCodeAt(Se))>=32&&Ie<128&&++be;var Pe=be>=Ee*4/5;I.push(F),I.push("Content-Location: "+(C.root||"file:///C:/SheetJS/")+re),I.push("Content-Transfer-Encoding: "+(Pe?"quoted-printable":"base64")),I.push("Content-Type: "+gi(he,re)),I.push(""),I.push(Pe?k0(ae):S0(ae))}return I.push(F+`--\r
`),I.join(`\r
`)}function mg(N){var R={};return k(R,N),R}function Bc(N,R,C,F){var I=F&&F.unsafe;I||k(N);var O=!I&&Be.find(N,R);if(!O){var re=N.FullPaths[0];R.slice(0,re.length)==re?re=R:(re.slice(-1)!="/"&&(re+="/"),re=(re+R).replace("//","/")),O={name:n(R),type:2},N.FileIndex.push(O),N.FullPaths.push(re),I||Be.utils.cfb_gc(N)}return O.content=C,O.size=C?C.length:0,F&&(F.CLSID&&(O.clsid=F.CLSID),F.mt&&(O.mt=F.mt),F.ct&&(O.ct=F.ct)),O}function pg(N,R){k(N);var C=Be.find(N,R);if(C){for(var F=0;F<N.FileIndex.length;++F)if(N.FileIndex[F]==C)return N.FileIndex.splice(F,1),N.FullPaths.splice(F,1),!0}return!1}function E0(N,R,C){k(N);var F=Be.find(N,R);if(F){for(var I=0;I<N.FileIndex.length;++I)if(N.FileIndex[I]==F)return N.FileIndex[I].name=n(C),N.FullPaths[I]=C,!0}return!1}function Uc(N){T(N,!0)}return t.find=q,t.read=_,t.parse=d,t.write=me,t.writeFile=Q,t.utils={cfb_new:mg,cfb_add:Bc,cfb_del:pg,cfb_mov:E0,cfb_gc:Uc,ReadShift:Sl,CheckField:wN,prep_blob:mr,bconcat:ir,use_zlib:A,_deflateRaw:Fe,_inflateRaw:Rr,consts:ce},t}();function EI(e){return typeof e=="string"?m0(e):Array.isArray(e)?JR(e):e}function Ac(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=m0(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var s=r=="utf8"?ln(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(s,e);if(typeof Blob<"u"){var n=new Blob([EI(s)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(n,e);if(typeof saveAs<"u")return saveAs(n,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var a=URL.createObjectURL(n);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),chrome.downloads.download({url:a,filename:e,saveAs:!0});var i=document.createElement("a");if(i.download!=null)return i.download=e,i.href=a,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),a}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(e);return l.open("w"),l.encoding="binary",Array.isArray(t)&&(t=ba(t)),l.write(t),l.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function jI(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(s){if(!s.message||!s.message.match(/onstruct/))throw s}throw new Error("Cannot access file "+e)}function Mt(e){for(var t=Object.keys(e),r=[],s=0;s<t.length;++s)Object.prototype.hasOwnProperty.call(e,t[s])&&r.push(t[s]);return r}function A1(e,t){for(var r=[],s=Mt(e),n=0;n!==s.length;++n)r[e[s[n]][t]]==null&&(r[e[s[n]][t]]=s[n]);return r}function x0(e){for(var t=[],r=Mt(e),s=0;s!==r.length;++s)t[e[r[s]]]=r[s];return t}function g0(e){for(var t=[],r=Mt(e),s=0;s!==r.length;++s)t[e[r[s]]]=parseInt(r[s],10);return t}function TI(e){for(var t=[],r=Mt(e),s=0;s!==r.length;++s)t[e[r[s]]]==null&&(t[e[r[s]]]=[]),t[e[r[s]]].push(r[s]);return t}var Fd=new Date(1899,11,30,0,0,0);function rr(e,t){var r=e.getTime(),s=Fd.getTime()+(e.getTimezoneOffset()-Fd.getTimezoneOffset())*6e4;return(r-s)/(24*60*60*1e3)}var Zk=new Date,CI=Fd.getTime()+(Zk.getTimezoneOffset()-Fd.getTimezoneOffset())*6e4,F1=Zk.getTimezoneOffset();function v0(e){var t=new Date;return t.setTime(e*24*60*60*1e3+CI),t.getTimezoneOffset()!==F1&&t.setTime(t.getTime()+(t.getTimezoneOffset()-F1)*6e4),t}function AI(e){var t=0,r=0,s=!1,n=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!n)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var a=1;a!=n.length;++a)if(n[a]){switch(r=1,a>3&&(s=!0),n[a].slice(n[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+n[a].slice(n[a].length-1));case"D":r*=24;case"H":r*=60;case"M":if(s)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(n[a],10)}return t}var P1=new Date("2017-02-19T19:06:09.000Z"),eN=isNaN(P1.getFullYear())?new Date("2/19/17"):P1,FI=eN.getFullYear()==2017;function wt(e,t){var r=new Date(e);if(FI)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(eN.getFullYear()==1917&&!isNaN(r.getFullYear())){var s=r.getFullYear();return e.indexOf(""+s)>-1||r.setFullYear(r.getFullYear()+100),r}var n=e.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function ni(e,t){if(Qe&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return ln(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return ln(zk(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return ln(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return ln(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(a){return r[a]||a})}catch{}for(var s=[],n=0;n!=e.length;++n)s.push(String.fromCharCode(e[n]));return s.join("")}function bt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=bt(e[r]));return t}function Dt(e,t){for(var r="";r.length<t;)r+=e;return r}function Ys(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,s=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(s))||(s=s.replace(/[(](.*)[)]/,function(n,a){return r=-r,a}),!isNaN(t=Number(s)))?t/r:t}var PI=["january","february","march","april","may","june","july","august","september","october","november","december"];function wo(e){var t=new Date(e),r=new Date(NaN),s=t.getYear(),n=t.getMonth(),a=t.getDate();if(isNaN(a))return r;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&PI.indexOf(i)==-1)return r}else if(i.match(/[a-z]/))return r;return s<0||s>8099?r:(n>0||a>1)&&s!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var RI=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,s,n){if(e||typeof s=="string")return r.split(s);for(var a=r.split(s),i=[a[0]],l=1;l<a.length;++l)i.push(n),i.push(a[l]);return i}}();function tN(e){return e?e.content&&e.type?ni(e.content,!0):e.data?nl(e.data):e.asNodeBuffer&&Qe?nl(e.asNodeBuffer().toString("binary")):e.asBinary?nl(e.asBinary()):e._data&&e._data.getContent?nl(ni(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function rN(e){if(!e)return null;if(e.data)return w1(e.data);if(e.asNodeBuffer&&Qe)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?w1(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function II(e){return e&&e.name.slice(-4)===".bin"?rN(e):tN(e)}function Ss(e,t){for(var r=e.FullPaths||Mt(e.files),s=t.toLowerCase().replace(/[\/]/g,"\\"),n=s.replace(/\\/g,"/"),a=0;a<r.length;++a){var i=r[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(s==i||n==i)return e.files?e.files[r[a]]:e.FileIndex[a]}return null}function Fx(e,t){var r=Ss(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Ht(e,t,r){if(!r)return II(Fx(e,t));if(!t)return null;try{return Ht(e,t)}catch{return null}}function ls(e,t,r){if(!r)return tN(Fx(e,t));if(!t)return null;try{return ls(e,t)}catch{return null}}function OI(e,t,r){return rN(Fx(e,t))}function R1(e){for(var t=e.FullPaths||Mt(e.files),r=[],s=0;s<t.length;++s)t[s].slice(-1)!="/"&&r.push(t[s].replace(/^Root Entry[\/]/,""));return r.sort()}function Xe(e,t,r){if(e.FullPaths){if(typeof r=="string"){var s;return Qe?s=Dn(r):s=ZR(r),Be.utils.cfb_add(e,t,s)}Be.utils.cfb_add(e,t,r)}else e.file(t,r)}function Px(){return Be.utils.cfb_new()}function sN(e,t){switch(t.type){case"base64":return Be.read(e,{type:"base64"});case"binary":return Be.read(e,{type:"binary"});case"buffer":case"array":return Be.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function il(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var s=e.split("/");s.length!==0;){var n=s.shift();n===".."?r.pop():n!=="."&&r.push(n)}return r.join("/")}var Vt=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,DI=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,I1=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,LI=/<[^>]*>/g,Pr=Vt.match(I1)?I1:LI,MI=/<\w*:/,BI=/<(\/?)\w+:/;function qe(e,t,r){for(var s={},n=0,a=0;n!==e.length&&!((a=e.charCodeAt(n))===32||a===10||a===13);++n);if(t||(s[0]=e.slice(0,n)),n===e.length)return s;var i=e.match(DI),l=0,c="",u=0,d="",f="",h=1;if(i)for(u=0;u!=i.length;++u){for(f=i[u],a=0;a!=f.length&&f.charCodeAt(a)!==61;++a);for(d=f.slice(0,a).trim();f.charCodeAt(a+1)==32;)++a;for(h=(n=f.charCodeAt(a+1))==34||n==39?1:0,c=f.slice(a+1+h,f.length-h),l=0;l!=d.length&&d.charCodeAt(l)!==58;++l);if(l===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),s[d]=c,s[d.toLowerCase()]=c;else{var m=(l===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(l+1);if(s[m]&&d.slice(l-3,l)=="ext")continue;s[m]=c,s[m.toLowerCase()]=c}}return s}function hn(e){return e.replace(BI,"<$1")}var nN={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Rx=x0(nN),nt=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(s){var n=s+"",a=n.indexOf("<![CDATA[");if(a==-1)return n.replace(e,function(l,c){return nN[l]||String.fromCharCode(parseInt(c,l.indexOf("x")>-1?16:10))||l}).replace(t,function(l,c){return String.fromCharCode(parseInt(c,16))});var i=n.indexOf("]]>");return r(n.slice(0,a))+n.slice(a+9,i)+r(n.slice(i+3))}}(),Ix=/[&<>'"]/g,UI=/[\u0000-\u0008\u000b-\u001f]/g;function ut(e){var t=e+"";return t.replace(Ix,function(r){return Rx[r]}).replace(UI,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function O1(e){return ut(e).replace(/ /g,"_x0020_")}var aN=/[\u0000-\u001f]/g;function Ox(e){var t=e+"";return t.replace(Ix,function(r){return Rx[r]}).replace(/\n/g,"<br/>").replace(aN,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function zI(e){var t=e+"";return t.replace(Ix,function(r){return Rx[r]}).replace(aN,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var D1=function(){var e=/&#(\d+);/g;function t(r,s){return String.fromCharCode(parseInt(s,10))}return function(s){return s.replace(e,t)}}();function $I(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function vt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Af(e){for(var t="",r=0,s=0,n=0,a=0,i=0,l=0;r<e.length;){if(s=e.charCodeAt(r++),s<128){t+=String.fromCharCode(s);continue}if(n=e.charCodeAt(r++),s>191&&s<224){i=(s&31)<<6,i|=n&63,t+=String.fromCharCode(i);continue}if(a=e.charCodeAt(r++),s<240){t+=String.fromCharCode((s&15)<<12|(n&63)<<6|a&63);continue}i=e.charCodeAt(r++),l=((s&7)<<18|(n&63)<<12|(a&63)<<6|i&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function L1(e){var t=da(2*e.length),r,s,n=1,a=0,i=0,l;for(s=0;s<e.length;s+=n)n=1,(l=e.charCodeAt(s))<128?r=l:l<224?(r=(l&31)*64+(e.charCodeAt(s+1)&63),n=2):l<240?(r=(l&15)*4096+(e.charCodeAt(s+1)&63)*64+(e.charCodeAt(s+2)&63),n=3):(n=4,r=(l&7)*262144+(e.charCodeAt(s+1)&63)*4096+(e.charCodeAt(s+2)&63)*64+(e.charCodeAt(s+3)&63),r-=65536,i=55296+(r>>>10&1023),r=56320+(r&1023)),i!==0&&(t[a++]=i&255,t[a++]=i>>>8,i=0),t[a++]=r%256,t[a++]=r>>>8;return t.slice(0,a).toString("ucs2")}function M1(e){return Dn(e,"binary").toString("utf8")}var vu="foo bar baz",ft=Qe&&(M1(vu)==Af(vu)&&M1||L1(vu)==Af(vu)&&L1)||Af,ln=Qe?function(e){return Dn(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,s=0,n=0;r<e.length;)switch(s=e.charCodeAt(r++),!0){case s<128:t.push(String.fromCharCode(s));break;case s<2048:t.push(String.fromCharCode(192+(s>>6))),t.push(String.fromCharCode(128+(s&63)));break;case(s>=55296&&s<57344):s-=55296,n=e.charCodeAt(r++)-56320+(s<<10),t.push(String.fromCharCode(240+(n>>18&7))),t.push(String.fromCharCode(144+(n>>12&63))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)));break;default:t.push(String.fromCharCode(224+(s>>12))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)))}return t.join("")},lc=function(){var e={};return function(r,s){var n=r+"|"+(s||"");return e[n]?e[n]:e[n]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",s||"")}}(),iN=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var s=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),n=0;n<e.length;++n)s=s.replace(e[n][0],e[n][1]);return s}}(),VI=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),WI=/<\/?(?:vt:)?variant>/g,qI=/<(?:vt:)([^>]*)>([\s\S]*)</;function B1(e,t){var r=qe(e),s=e.match(VI(r.baseType))||[],n=[];if(s.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+s.length+" != "+r.size);return n}return s.forEach(function(a){var i=a.replace(WI,"").match(qI);i&&n.push({v:ft(i[2]),t:i[1]})}),n}var oN=/(^\s|\s$|\n)/;function pr(e,t){return"<"+e+(t.match(oN)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function cc(e){return Mt(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function ke(e,t,r){return"<"+e+(r!=null?cc(r):"")+(t!=null?(t.match(oN)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Sm(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function HI(e,t){switch(typeof e){case"string":var r=ke("vt:lpwstr",ut(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return ke((e|0)==e?"vt:i4":"vt:r8",ut(String(e)));case"boolean":return ke("vt:bool",e?"true":"false")}if(e instanceof Date)return ke("vt:filetime",Sm(e));throw new Error("Unable to serialize "+e)}function Dx(e){if(Qe&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return ft(ba(Tx(e)));throw new Error("Bad input format: expected Buffer or string")}var uc=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,er={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},di=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],ss={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function GI(e,t){for(var r=1-2*(e[t+7]>>>7),s=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),n=e[t+6]&15,a=5;a>=0;--a)n=n*256+e[t+a];return s==2047?n==0?r*(1/0):NaN:(s==0?s=-1022:(s-=1023,n+=Math.pow(2,52)),r*Math.pow(2,s-52)*n)}function KI(e,t,r){var s=(t<0||1/t==-1/0?1:0)<<7,n=0,a=0,i=s?-t:t;isFinite(i)?i==0?n=a=0:(n=Math.floor(Math.log(i)/Math.LN2),a=i*Math.pow(2,52-n),n<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?n=-1022:(a-=Math.pow(2,52),n+=1023)):(n=2047,a=isNaN(t)?26985:0);for(var l=0;l<=5;++l,a/=256)e[r+l]=a&255;e[r+6]=(n&15)<<4|a&15,e[r+7]=n>>4|s}var U1=function(e){for(var t=[],r=10240,s=0;s<e[0].length;++s)if(e[0][s])for(var n=0,a=e[0][s].length;n<a;n+=r)t.push.apply(t,e[0][s].slice(n,n+r));return t},z1=Qe?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Dn(t)})):U1(e)}:U1,$1=function(e,t,r){for(var s=[],n=t;n<r;n+=2)s.push(String.fromCharCode(Sn(e,n)));return s.join("").replace(Ur,"")},Lx=Qe?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Ur,""):$1(e,t,r)}:$1,V1=function(e,t,r){for(var s=[],n=t;n<t+r;++n)s.push(("0"+e[n].toString(16)).slice(-2));return s.join("")},lN=Qe?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):V1(e,t,r)}:V1,W1=function(e,t,r){for(var s=[],n=t;n<r;n++)s.push(String.fromCharCode(Ci(e,n)));return s.join("")},Fc=Qe?function(t,r,s){return Buffer.isBuffer(t)?t.toString("utf8",r,s):W1(t,r,s)}:W1,cN=function(e,t){var r=ns(e,t);return r>0?Fc(e,t+4,t+4+r-1):""},uN=cN,dN=function(e,t){var r=ns(e,t);return r>0?Fc(e,t+4,t+4+r-1):""},fN=dN,hN=function(e,t){var r=2*ns(e,t);return r>0?Fc(e,t+4,t+4+r-1):""},mN=hN,pN=function(t,r){var s=ns(t,r);return s>0?Lx(t,r+4,r+4+s):""},xN=pN,gN=function(e,t){var r=ns(e,t);return r>0?Fc(e,t+4,t+4+r):""},vN=gN,yN=function(e,t){return GI(e,t)},Pd=yN,Mx=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Qe&&(uN=function(t,r){if(!Buffer.isBuffer(t))return cN(t,r);var s=t.readUInt32LE(r);return s>0?t.toString("utf8",r+4,r+4+s-1):""},fN=function(t,r){if(!Buffer.isBuffer(t))return dN(t,r);var s=t.readUInt32LE(r);return s>0?t.toString("utf8",r+4,r+4+s-1):""},mN=function(t,r){if(!Buffer.isBuffer(t))return hN(t,r);var s=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+s-1)},xN=function(t,r){if(!Buffer.isBuffer(t))return pN(t,r);var s=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+s)},vN=function(t,r){if(!Buffer.isBuffer(t))return gN(t,r);var s=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+s)},Pd=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):yN(t,r)},Mx=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Ci=function(e,t){return e[t]},Sn=function(e,t){return e[t+1]*256+e[t]},XI=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},ns=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Oa=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},QI=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Sl(e,t){var r="",s,n,a=[],i,l,c,u;switch(t){case"dbcs":if(u=this.l,Qe&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(Sn(this,u)),u+=2;e*=2;break;case"utf8":r=Fc(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Lx(this,this.l,this.l+e);break;case"wstr":return Sl.call(this,e,"dbcs");case"lpstr-ansi":r=uN(this,this.l),e=4+ns(this,this.l);break;case"lpstr-cp":r=fN(this,this.l),e=4+ns(this,this.l);break;case"lpwstr":r=mN(this,this.l),e=4+2*ns(this,this.l);break;case"lpp4":e=4+ns(this,this.l),r=xN(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+ns(this,this.l),r=vN(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(i=Ci(this,this.l+e++))!==0;)a.push(gu(i));r=a.join("");break;case"_wstr":for(e=0,r="";(i=Sn(this,this.l+e))!==0;)a.push(gu(i)),e+=2;e+=2,r=a.join("");break;case"dbcs-cont":for(r="",u=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return i=Ci(this,u),this.l=u+1,l=Sl.call(this,e-c,i?"dbcs-cont":"sbcs-cont"),a.join("")+l;a.push(gu(Sn(this,u))),u+=2}r=a.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return i=Ci(this,u),this.l=u+1,l=Sl.call(this,e-c,i?"dbcs-cont":"sbcs-cont"),a.join("")+l;a.push(gu(Ci(this,u))),u+=1}r=a.join("");break;default:switch(e){case 1:return s=Ci(this,this.l),this.l++,s;case 2:return s=(t==="i"?XI:Sn)(this,this.l),this.l+=2,s;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(s=(e>0?Oa:QI)(this,this.l),this.l+=4,s):(n=ns(this,this.l),this.l+=4,n);case 8:case-8:if(t==="f")return e==8?n=Pd(this,this.l):n=Pd([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;e=8;case 16:r=lN(this,this.l,e);break}}return this.l+=e,r}var YI=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},JI=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},ZI=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function eO(e,t,r){var s=0,n=0;if(r==="dbcs"){for(n=0;n!=t.length;++n)ZI(this,t.charCodeAt(n),this.l+2*n);s=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=t.length;++n)this[this.l+n]=t.charCodeAt(n)&255;s=t.length}else if(r==="hex"){for(;n<e;++n)this[this.l++]=parseInt(t.slice(2*n,2*n+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+e,this.length);for(n=0;n<Math.min(t.length,e);++n){var i=t.charCodeAt(n);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(e){case 1:s=1,this[this.l]=t&255;break;case 2:s=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:s=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:s=4,YI(this,t,this.l);break;case 8:if(s=8,r==="f"){KI(this,t,this.l);break}case 16:break;case-4:s=4,JI(this,t,this.l);break}return this.l+=s,this}function wN(e,t){var r=lN(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function mr(e,t){e.l=t,e.read_shift=Sl,e.chk=wN,e.write_shift=eO}function Fr(e,t){e.l+=t}function de(e){var t=da(e);return mr(t,0),t}function Ln(e,t,r){if(e){var s,n,a;mr(e,e.l||0);for(var i=e.length,l=0,c=0;e.l<i;){l=e.read_shift(1),l&128&&(l=(l&127)+((e.read_shift(1)&127)<<7));var u=xc[l]||xc[65535];for(s=e.read_shift(1),a=s&127,n=1;n<4&&s&128;++n)a+=((s=e.read_shift(1))&127)<<7*n;c=e.l+a;var d=u.f&&u.f(e,a,r);if(e.l=c,t(d,u,l))return}}}function Jr(){var e=[],t=Qe?256:2048,r=function(u){var d=de(u);return mr(d,0),d},s=r(t),n=function(){s&&(s.length>s.l&&(s=s.slice(0,s.l),s.l=s.length),s.length>0&&e.push(s),s=null)},a=function(u){return s&&u<s.length-s.l?s:(n(),s=r(Math.max(u+1,t)))},i=function(){return n(),ir(e)},l=function(u){n(),s=u,s.l==null&&(s.l=s.length),a(t)};return{next:a,push:l,end:i,_bufs:e}}function ge(e,t,r,s){var n=+t,a;if(!isNaN(n)){s||(s=xc[n].p||(r||[]).length||0),a=1+(n>=128?1:0)+1,s>=128&&++a,s>=16384&&++a,s>=2097152&&++a;var i=e.next(a);n<=127?i.write_shift(1,n):(i.write_shift(1,(n&127)+128),i.write_shift(1,n>>7));for(var l=0;l!=4;++l)if(s>=128)i.write_shift(1,(s&127)+128),s>>=7;else{i.write_shift(1,s);break}s>0&&Mx(r)&&e.push(r)}}function kl(e,t,r){var s=bt(e);if(t.s?(s.cRel&&(s.c+=t.s.c),s.rRel&&(s.r+=t.s.r)):(s.cRel&&(s.c+=t.c),s.rRel&&(s.r+=t.r)),!r||r.biff<12){for(;s.c>=256;)s.c-=256;for(;s.r>=65536;)s.r-=65536}return s}function q1(e,t,r){var s=bt(e);return s.s=kl(s.s,t.s,r),s.e=kl(s.e,t.s,r),s}function Nl(e,t){if(e.cRel&&e.c<0)for(e=bt(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=bt(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Ve(e);return!e.cRel&&e.cRel!=null&&(r=sO(r)),!e.rRel&&e.rRel!=null&&(r=tO(r)),r}function Ff(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+At(e.s.c)+":"+(e.e.cRel?"":"$")+At(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+$t(e.s.r)+":"+(e.e.rRel?"":"$")+$t(e.e.r):Nl(e.s,t.biff)+":"+Nl(e.e,t.biff)}function Bx(e){return parseInt(rO(e),10)-1}function $t(e){return""+(e+1)}function tO(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function rO(e){return e.replace(/\$(\d+)$/,"$1")}function Ux(e){for(var t=nO(e),r=0,s=0;s!==t.length;++s)r=26*r+t.charCodeAt(s)-64;return r-1}function At(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function sO(e){return e.replace(/^([A-Z])/,"$$$1")}function nO(e){return e.replace(/^\$([A-Z])/,"$1")}function aO(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Ft(e){for(var t=0,r=0,s=0;s<e.length;++s){var n=e.charCodeAt(s);n>=48&&n<=57?t=10*t+(n-48):n>=65&&n<=90&&(r=26*r+(n-64))}return{c:r-1,r:t-1}}function Ve(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Zr(e){var t=e.indexOf(":");return t==-1?{s:Ft(e),e:Ft(e)}:{s:Ft(e.slice(0,t)),e:Ft(e.slice(t+1))}}function Ke(e,t){return typeof t>"u"||typeof t=="number"?Ke(e.s,e.e):(typeof e!="string"&&(e=Ve(e)),typeof t!="string"&&(t=Ve(t)),e==t?e:e+":"+t)}function at(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,s=0,n=0,a=e.length;for(r=0;s<a&&!((n=e.charCodeAt(s)-64)<1||n>26);++s)r=26*r+n;for(t.s.c=--r,r=0;s<a&&!((n=e.charCodeAt(s)-48)<0||n>9);++s)r=10*r+n;if(t.s.r=--r,s===a||n!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++s,r=0;s!=a&&!((n=e.charCodeAt(s)-64)<1||n>26);++s)r=26*r+n;for(t.e.c=--r,r=0;s!=a&&!((n=e.charCodeAt(s)-48)<0||n>9);++s)r=10*r+n;return t.e.r=--r,t}function H1(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Os(e.z,r?rr(t):t)}catch{}try{return e.w=Os((e.XF||{}).numFmtId||(r?14:0),r?rr(t):t)}catch{return""+t}}function In(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Mn[e.v]||e.v:t==null?H1(e,e.v):H1(e,t))}function _a(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",s={};return s[r]=e,{SheetNames:[r],Sheets:s}}function bN(e,t,r){var s=r||{},n=e?Array.isArray(e):s.dense,a=e||(n?[]:{}),i=0,l=0;if(a&&s.origin!=null){if(typeof s.origin=="number")i=s.origin;else{var c=typeof s.origin=="string"?Ft(s.origin):s.origin;i=c.r,l=c.c}a["!ref"]||(a["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var d=at(a["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),i==-1&&(u.e.r=i=d.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[f].length;++h)if(!(typeof t[f][h]>"u")){var m={v:t[f][h]},x=i+f,p=l+h;if(u.s.r>x&&(u.s.r=x),u.s.c>p&&(u.s.c=p),u.e.r<x&&(u.e.r=x),u.e.c<p&&(u.e.c=p),t[f][h]&&typeof t[f][h]=="object"&&!Array.isArray(t[f][h])&&!(t[f][h]instanceof Date))m=t[f][h];else if(Array.isArray(m.v)&&(m.f=t[f][h][1],m.v=m.v[0]),m.v===null)if(m.f)m.t="n";else if(s.nullError)m.t="e",m.v=0;else if(s.sheetStubs)m.t="z";else continue;else typeof m.v=="number"?m.t="n":typeof m.v=="boolean"?m.t="b":m.v instanceof Date?(m.z=s.dateNF||$e[14],s.cellDates?(m.t="d",m.w=Os(m.z,rr(m.v))):(m.t="n",m.v=rr(m.v),m.w=Os(m.z,m.v))):m.t="s";if(n)a[x]||(a[x]=[]),a[x][p]&&a[x][p].z&&(m.z=a[x][p].z),a[x][p]=m;else{var g=Ve({c:p,r:x});a[g]&&a[g].z&&(m.z=a[g].z),a[g]=m}}}return u.s.c<1e7&&(a["!ref"]=Ke(u)),a}function Do(e,t){return bN(null,e,t)}function iO(e){return e.read_shift(4,"i")}function Js(e,t){return t||(t=de(4)),t.write_shift(4,e),t}function Cr(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function or(e,t){var r=!1;return t==null&&(r=!0,t=de(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function oO(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function lO(e,t){return t||(t=de(4)),t.write_shift(2,0),t.write_shift(2,0),t}function zx(e,t){var r=e.l,s=e.read_shift(1),n=Cr(e),a=[],i={t:n,h:n};if(s&1){for(var l=e.read_shift(4),c=0;c!=l;++c)a.push(oO(e));i.r=a}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}function cO(e,t){var r=!1;return t==null&&(r=!0,t=de(15+4*e.t.length)),t.write_shift(1,0),or(e.t,t),r?t.slice(0,t.l):t}var uO=zx;function dO(e,t){var r=!1;return t==null&&(r=!0,t=de(23+4*e.t.length)),t.write_shift(1,1),or(e.t,t),t.write_shift(4,1),lO({},t),r?t.slice(0,t.l):t}function Ds(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function fi(e,t){return t==null&&(t=de(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function hi(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function mi(e,t){return t==null&&(t=de(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var fO=Cr,_N=or;function $x(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Rd(e,t){var r=!1;return t==null&&(r=!0,t=de(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var hO=Cr,km=$x,Vx=Rd;function Wx(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,s=t[0]&2;e.l+=4;var n=s===0?Pd([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Oa(t,0)>>2;return r?n/100:n}function SN(e,t){t==null&&(t=de(4));var r=0,s=0,n=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?s=1:n==(n|0)&&n>=-536870912&&n<1<<29&&(s=1,r=1),s)t.write_shift(-4,((r?n:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function kN(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function mO(e,t){return t||(t=de(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var pi=kN,Lo=mO;function Er(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function ai(e,t){return(t||de(8)).write_shift(8,e,"f")}function pO(e){var t={},r=e.read_shift(1),s=r>>>1,n=e.read_shift(1),a=e.read_shift(2,"i"),i=e.read_shift(1),l=e.read_shift(1),c=e.read_shift(1);switch(e.l++,s){case 0:t.auto=1;break;case 1:t.index=n;var u=Ga[n];u&&(t.rgb=fc(u));break;case 2:t.rgb=fc([i,l,c]);break;case 3:t.theme=n;break}return a!=0&&(t.tint=a>0?a/32767:a/32768),t}function Id(e,t){if(t||(t=de(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var s=e.rgb||"FFFFFF";typeof s=="number"&&(s=("000000"+s.toString(16)).slice(-6)),t.write_shift(1,parseInt(s.slice(0,2),16)),t.write_shift(1,parseInt(s.slice(2,4),16)),t.write_shift(1,parseInt(s.slice(4,6),16)),t.write_shift(1,255)}return t}function xO(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function gO(e,t){t||(t=de(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function NN(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},s=e.read_shift(4);switch(s){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(s>400)throw new Error("Unsupported Clipboard: "+s.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function vO(e){return NN(e,1)}function yO(e){return NN(e,2)}var qx=2,Wr=3,yu=11,G1=12,Od=19,wu=64,wO=65,bO=71,_O=4108,SO=4126,nr=80,EN=81,kO=[nr,EN],Nm={1:{n:"CodePage",t:qx},2:{n:"Category",t:nr},3:{n:"PresentationFormat",t:nr},4:{n:"ByteCount",t:Wr},5:{n:"LineCount",t:Wr},6:{n:"ParagraphCount",t:Wr},7:{n:"SlideCount",t:Wr},8:{n:"NoteCount",t:Wr},9:{n:"HiddenCount",t:Wr},10:{n:"MultimediaClipCount",t:Wr},11:{n:"ScaleCrop",t:yu},12:{n:"HeadingPairs",t:_O},13:{n:"TitlesOfParts",t:SO},14:{n:"Manager",t:nr},15:{n:"Company",t:nr},16:{n:"LinksUpToDate",t:yu},17:{n:"CharacterCount",t:Wr},19:{n:"SharedDoc",t:yu},22:{n:"HyperlinksChanged",t:yu},23:{n:"AppVersion",t:Wr,p:"version"},24:{n:"DigSig",t:wO},26:{n:"ContentType",t:nr},27:{n:"ContentStatus",t:nr},28:{n:"Language",t:nr},29:{n:"Version",t:nr},255:{},2147483648:{n:"Locale",t:Od},2147483651:{n:"Behavior",t:Od},1919054434:{}},Em={1:{n:"CodePage",t:qx},2:{n:"Title",t:nr},3:{n:"Subject",t:nr},4:{n:"Author",t:nr},5:{n:"Keywords",t:nr},6:{n:"Comments",t:nr},7:{n:"Template",t:nr},8:{n:"LastAuthor",t:nr},9:{n:"RevNumber",t:nr},10:{n:"EditTime",t:wu},11:{n:"LastPrinted",t:wu},12:{n:"CreatedDate",t:wu},13:{n:"ModifiedDate",t:wu},14:{n:"PageCount",t:Wr},15:{n:"WordCount",t:Wr},16:{n:"CharCount",t:Wr},17:{n:"Thumbnail",t:bO},18:{n:"Application",t:nr},19:{n:"DocSecurity",t:Wr},255:{},2147483648:{n:"Locale",t:Od},2147483651:{n:"Behavior",t:Od},1919054434:{}},K1={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},NO=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function EO(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var jO=EO([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Ga=bt(jO),Mn={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},jN={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},jm={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},bu={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Hx(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function TO(e){var t=Hx();if(!e||!e.match)return t;var r={};if((e.match(Pr)||[]).forEach(function(s){var n=qe(s);switch(n[0].replace(MI,"<")){case"<?xml":break;case"<Types":t.xmlns=n["xmlns"+(n[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[n.Extension]=n.ContentType;break;case"<Override":t[jm[n.ContentType]]!==void 0&&t[jm[n.ContentType]].push(n.PartName);break}}),t.xmlns!==er.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function TN(e,t){var r=TI(jm),s=[],n;s[s.length]=Vt,s[s.length]=ke("Types",null,{xmlns:er.CT,"xmlns:xsd":er.xsd,"xmlns:xsi":er.xsi}),s=s.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return ke("Default",null,{Extension:c[0],ContentType:c[1]})}));var a=function(c){e[c]&&e[c].length>0&&(n=e[c][0],s[s.length]=ke("Override",null,{PartName:(n[0]=="/"?"":"/")+n,ContentType:bu[c][t.bookType]||bu[c].xlsx}))},i=function(c){(e[c]||[]).forEach(function(u){s[s.length]=ke("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:bu[c][t.bookType]||bu[c].xlsx})})},l=function(c){(e[c]||[]).forEach(function(u){s[s.length]=ke("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[c][0]})})};return a("workbooks"),i("sheets"),i("charts"),l("themes"),["strs","styles"].forEach(a),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),i("metadata"),l("people"),s.length>2&&(s[s.length]="</Types>",s[1]=s[1].replace("/>",">")),s.join("")}var Ye={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function dc(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function El(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var s={};return(e.match(Pr)||[]).forEach(function(n){var a=qe(n);if(a[0]==="<Relationship"){var i={};i.Type=a.Type,i.Target=a.Target,i.Id=a.Id,a.TargetMode&&(i.TargetMode=a.TargetMode);var l=a.TargetMode==="External"?a.Target:il(a.Target,t);r[l]=i,s[a.Id]=i}}),r["!id"]=s,r}function no(e){var t=[Vt,ke("Relationships",null,{xmlns:er.RELS})];return Mt(e["!id"]).forEach(function(r){t[t.length]=ke("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function ct(e,t,r,s,n,a){if(n||(n={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,n.Id="rId"+t,n.Type=s,n.Target=r,[Ye.HLINK,Ye.XPATH,Ye.XMISS].indexOf(n.Type)>-1&&(n.TargetMode="External"),e["!id"][n.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][n.Id]=n,e[("/"+n.Target).replace("//","/")]=n,t}var CO="application/vnd.oasis.opendocument.spreadsheet";function AO(e,t){for(var r=Dx(e),s,n;s=uc.exec(r);)switch(s[3]){case"manifest":break;case"file-entry":if(n=qe(s[0],!1),n.path=="/"&&n.type!==CO)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw s}}function FO(e){var t=[Vt];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function X1(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function PO(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function RO(e){var t=[Vt];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(X1(e[r][0],e[r][1])),t.push(PO("",e[r][0]));return t.push(X1("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function CN(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+jd.version+"</meta:generator></office:meta></office:document-meta>"}var Ps=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],IO=function(){for(var e=new Array(Ps.length),t=0;t<Ps.length;++t){var r=Ps[t],s="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+s+"[^>]*>([\\s\\S]*?)</"+s+">")}return e}();function AN(e){var t={};e=ft(e);for(var r=0;r<Ps.length;++r){var s=Ps[r],n=e.match(IO[r]);n!=null&&n.length>0&&(t[s[1]]=nt(n[1])),s[2]==="date"&&t[s[1]]&&(t[s[1]]=wt(t[s[1]]))}return t}function Pf(e,t,r,s,n){n[e]!=null||t==null||t===""||(n[e]=t,t=ut(t),s[s.length]=r?ke(e,t,r):pr(e,t))}function FN(e,t){var r=t||{},s=[Vt,ke("cp:coreProperties",null,{"xmlns:cp":er.CORE_PROPS,"xmlns:dc":er.dc,"xmlns:dcterms":er.dcterms,"xmlns:dcmitype":er.dcmitype,"xmlns:xsi":er.xsi})],n={};if(!e&&!r.Props)return s.join("");e&&(e.CreatedDate!=null&&Pf("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Sm(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},s,n),e.ModifiedDate!=null&&Pf("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Sm(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},s,n));for(var a=0;a!=Ps.length;++a){var i=Ps[a],l=r.Props&&r.Props[i[1]]!=null?r.Props[i[1]]:e?e[i[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&Pf(i[0],l,null,s,n)}return s.length>2&&(s[s.length]="</cp:coreProperties>",s[1]=s[1].replace("/>",">")),s.join("")}var Ka=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],PN=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function RN(e,t,r,s){var n=[];if(typeof e=="string")n=B1(e,s);else for(var a=0;a<e.length;++a)n=n.concat(e[a].map(function(d){return{v:d}}));var i=typeof t=="string"?B1(t,s).map(function(d){return d.v}):t,l=0,c=0;if(i.length>0)for(var u=0;u!==n.length;u+=2){switch(c=+n[u+1].v,n[u].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=i.slice(l,l+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=c,r.DefinedNames=i.slice(l,l+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=i.slice(l,l+c);break}l+=c}}function OO(e,t,r){var s={};return t||(t={}),e=ft(e),Ka.forEach(function(n){var a=(e.match(lc(n[0]))||[])[1];switch(n[2]){case"string":a&&(t[n[1]]=nt(a));break;case"bool":t[n[1]]=a==="true";break;case"raw":var i=e.match(new RegExp("<"+n[0]+"[^>]*>([\\s\\S]*?)</"+n[0]+">"));i&&i.length>0&&(s[n[1]]=i[1]);break}}),s.HeadingPairs&&s.TitlesOfParts&&RN(s.HeadingPairs,s.TitlesOfParts,t,r),t}function IN(e){var t=[],r=ke;return e||(e={}),e.Application="SheetJS",t[t.length]=Vt,t[t.length]=ke("Properties",null,{xmlns:er.EXT_PROPS,"xmlns:vt":er.vt}),Ka.forEach(function(s){if(e[s[1]]!==void 0){var n;switch(s[2]){case"string":n=ut(String(e[s[1]]));break;case"bool":n=e[s[1]]?"true":"false";break}n!==void 0&&(t[t.length]=r(s[0],n))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(s){return"<vt:lpstr>"+ut(s)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var DO=/<[^>]+>[^<]*/g;function LO(e,t){var r={},s="",n=e.match(DO);if(n)for(var a=0;a!=n.length;++a){var i=n[a],l=qe(i);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":s=nt(l.name);break;case"</property>":s=null;break;default:if(i.indexOf("<vt:")===0){var c=i.split(">"),u=c[0].slice(4),d=c[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[s]=nt(d);break;case"bool":r[s]=vt(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[s]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[s]=parseFloat(d);break;case"filetime":case"date":r[s]=wt(d);break;case"cy":case"error":r[s]=nt(d);break;default:if(u.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",i,u,c)}}else if(i.slice(0,2)!=="</"){if(t.WTF)throw new Error(i)}}}return r}function ON(e){var t=[Vt,ke("Properties",null,{xmlns:er.CUST_PROPS,"xmlns:vt":er.vt})];if(!e)return t.join("");var r=1;return Mt(e).forEach(function(n){++r,t[t.length]=ke("property",HI(e[n]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:ut(n)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Tm={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Rf;function MO(e,t,r){Rf||(Rf=x0(Tm)),t=Rf[t]||t,e[t]=r}function BO(e,t){var r=[];return Mt(Tm).map(function(s){for(var n=0;n<Ps.length;++n)if(Ps[n][1]==s)return Ps[n];for(n=0;n<Ka.length;++n)if(Ka[n][1]==s)return Ka[n];throw s}).forEach(function(s){if(e[s[1]]!=null){var n=t&&t.Props&&t.Props[s[1]]!=null?t.Props[s[1]]:e[s[1]];switch(s[2]){case"date":n=new Date(n).toISOString().replace(/\.\d*Z/,"Z");break}typeof n=="number"?n=String(n):n===!0||n===!1?n=n?"1":"0":n instanceof Date&&(n=new Date(n).toISOString().replace(/\.\d*Z/,"")),r.push(pr(Tm[s[1]]||s[1],n))}}),ke("DocumentProperties",r.join(""),{xmlns:ss.o})}function UO(e,t){var r=["Worksheets","SheetNames"],s="CustomDocumentProperties",n=[];return e&&Mt(e).forEach(function(a){if(Object.prototype.hasOwnProperty.call(e,a)){for(var i=0;i<Ps.length;++i)if(a==Ps[i][1])return;for(i=0;i<Ka.length;++i)if(a==Ka[i][1])return;for(i=0;i<r.length;++i)if(a==r[i])return;var l=e[a],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l=String(l),n.push(ke(O1(a),l,{"dt:dt":c}))}}),t&&Mt(t).forEach(function(a){if(Object.prototype.hasOwnProperty.call(t,a)&&!(e&&Object.prototype.hasOwnProperty.call(e,a))){var i=t[a],l="string";typeof i=="number"?(l="float",i=String(i)):i===!0||i===!1?(l="boolean",i=i?"1":"0"):i instanceof Date?(l="dateTime.tz",i=i.toISOString()):i=String(i),n.push(ke(O1(a),i,{"dt:dt":l}))}}),"<"+s+' xmlns="'+ss.o+'">'+n.join("")+"</"+s+">"}function Gx(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function zO(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,s=r%Math.pow(2,32),n=(r-s)/Math.pow(2,32);s*=1e7,n*=1e7;var a=s/Math.pow(2,32)|0;a>0&&(s=s%Math.pow(2,32),n+=a);var i=de(8);return i.write_shift(4,s),i.write_shift(4,n),i}function DN(e,t,r){var s=e.l,n=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-s&3;)++e.l;return n}function LN(e,t,r){var s=e.read_shift(0,"lpwstr");return s}function MN(e,t,r){return t===31?LN(e):DN(e,t,r)}function Cm(e,t,r){return MN(e,t,r===!1?0:4)}function $O(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return MN(e,t,0)}function VO(e){for(var t=e.read_shift(4),r=[],s=0;s!=t;++s){var n=e.l;r[s]=e.read_shift(0,"lpwstr").replace(Ur,""),e.l-n&2&&(e.l+=2)}return r}function WO(e){for(var t=e.read_shift(4),r=[],s=0;s!=t;++s)r[s]=e.read_shift(0,"lpstr-cp").replace(Ur,"");return r}function qO(e){var t=e.l,r=Dd(e,EN);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var s=Dd(e,Wr);return[r,s]}function HO(e){for(var t=e.read_shift(4),r=[],s=0;s<t/2;++s)r.push(qO(e));return r}function Q1(e,t){for(var r=e.read_shift(4),s={},n=0;n!=r;++n){var a=e.read_shift(4),i=e.read_shift(4);s[a]=e.read_shift(i,t===1200?"utf16le":"utf8").replace(Ur,"").replace(al,"!"),t===1200&&i%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),s}function BN(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function GO(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Dd(e,t,r){var s=e.read_shift(2),n,a=r||{};if(e.l+=2,t!==G1&&s!==t&&kO.indexOf(t)===-1&&!((t&65534)==4126&&(s&65534)==4126))throw new Error("Expected type "+t+" saw "+s);switch(t===G1?s:t){case 2:return n=e.read_shift(2,"i"),a.raw||(e.l+=2),n;case 3:return n=e.read_shift(4,"i"),n;case 11:return e.read_shift(4)!==0;case 19:return n=e.read_shift(4),n;case 30:return DN(e,s,4).replace(Ur,"");case 31:return LN(e);case 64:return Gx(e);case 65:return BN(e);case 71:return GO(e);case 80:return Cm(e,s,!a.raw).replace(Ur,"");case 81:return $O(e,s).replace(Ur,"");case 4108:return HO(e);case 4126:case 4127:return s==4127?VO(e):WO(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+s)}}function Y1(e,t){var r=de(4),s=de(4);switch(r.write_shift(4,e==80?31:e),e){case 3:s.write_shift(-4,t);break;case 5:s=de(8),s.write_shift(8,t,"f");break;case 11:s.write_shift(4,t?1:0);break;case 64:s=zO(t);break;case 31:case 80:for(s=de(4+2*(t.length+1)+(t.length%2?0:2)),s.write_shift(4,t.length+1),s.write_shift(0,t,"dbcs");s.l!=s.length;)s.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return ir([r,s])}function J1(e,t){var r=e.l,s=e.read_shift(4),n=e.read_shift(4),a=[],i=0,l=0,c=-1,u={};for(i=0;i!=n;++i){var d=e.read_shift(4),f=e.read_shift(4);a[i]=[d,f+r]}a.sort(function(v,y){return v[1]-y[1]});var h={};for(i=0;i!=n;++i){if(e.l!==a[i][1]){var m=!0;if(i>0&&t)switch(t[a[i-1][0]].t){case 2:e.l+2===a[i][1]&&(e.l+=2,m=!1);break;case 80:e.l<=a[i][1]&&(e.l=a[i][1],m=!1);break;case 4108:e.l<=a[i][1]&&(e.l=a[i][1],m=!1);break}if((!t||i==0)&&e.l<=a[i][1]&&(m=!1,e.l=a[i][1]),m)throw new Error("Read Error: Expected address "+a[i][1]+" at "+e.l+" :"+i)}if(t){var x=t[a[i][0]];if(h[x.n]=Dd(e,x.t,{raw:!0}),x.p==="version"&&(h[x.n]=String(h[x.n]>>16)+"."+("0000"+String(h[x.n]&65535)).slice(-4)),x.n=="CodePage")switch(h[x.n]){case 0:h[x.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Gs(l=h[x.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[x.n])}}else if(a[i][0]===1){if(l=h.CodePage=Dd(e,qx),Gs(l),c!==-1){var p=e.l;e.l=a[c][1],u=Q1(e,l),e.l=p}}else if(a[i][0]===0){if(l===0){c=i,e.l=a[i+1][1];continue}u=Q1(e,l)}else{var g=u[a[i][0]],w;switch(e[e.l]){case 65:e.l+=4,w=BN(e);break;case 30:e.l+=4,w=Cm(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,w=Cm(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,w=e.read_shift(4,"i");break;case 19:e.l+=4,w=e.read_shift(4);break;case 5:e.l+=4,w=e.read_shift(8,"f");break;case 11:e.l+=4,w=Bt(e,4);break;case 64:e.l+=4,w=wt(Gx(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[g]=w}}return e.l=r+s,h}var UN=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function KO(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function Z1(e,t,r){var s=de(8),n=[],a=[],i=8,l=0,c=de(8),u=de(8);if(c.write_shift(4,2),c.write_shift(4,1200),u.write_shift(4,1),a.push(c),n.push(u),i+=8+c.length,!t){u=de(8),u.write_shift(4,0),n.unshift(u);var d=[de(4)];for(d[0].write_shift(4,e.length),l=0;l<e.length;++l){var f=e[l][0];for(c=de(8+2*(f.length+1)+(f.length%2?0:2)),c.write_shift(4,l+2),c.write_shift(4,f.length+1),c.write_shift(0,f,"dbcs");c.l!=c.length;)c.write_shift(1,0);d.push(c)}c=ir(d),a.unshift(c),i+=8+c.length}for(l=0;l<e.length;++l)if(!(t&&!t[e[l][0]])&&!(UN.indexOf(e[l][0])>-1||PN.indexOf(e[l][0])>-1)&&e[l][1]!=null){var h=e[l][1],m=0;if(t){m=+t[e[l][0]];var x=r[m];if(x.p=="version"&&typeof h=="string"){var p=h.split(".");h=(+p[0]<<16)+(+p[1]||0)}c=Y1(x.t,h)}else{var g=KO(h);g==-1&&(g=31,h=String(h)),c=Y1(g,h)}a.push(c),u=de(8),u.write_shift(4,t?m:2+l),n.push(u),i+=8+c.length}var w=8*(a.length+1);for(l=0;l<a.length;++l)n[l].write_shift(4,w),w+=a[l].length;return s.write_shift(4,i),s.write_shift(4,a.length),ir([s].concat(n).concat(a))}function ew(e,t,r){var s=e.content;if(!s)return{};mr(s,0);var n,a,i,l,c=0;s.chk("feff","Byte Order: "),s.read_shift(2);var u=s.read_shift(4),d=s.read_shift(16);if(d!==Be.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(n=s.read_shift(4),n!==1&&n!==2)throw new Error("Unrecognized #Sets: "+n);if(a=s.read_shift(16),l=s.read_shift(4),n===1&&l!==s.l)throw new Error("Length mismatch: "+l+" !== "+s.l);n===2&&(i=s.read_shift(16),c=s.read_shift(4));var f=J1(s,t),h={SystemIdentifier:u};for(var m in f)h[m]=f[m];if(h.FMTID=a,n===1)return h;if(c-s.l==2&&(s.l+=2),s.l!==c)throw new Error("Length mismatch 2: "+s.l+" !== "+c);var x;try{x=J1(s,null)}catch{}for(m in x)h[m]=x[m];return h.FMTID=[a,i],h}function tw(e,t,r,s,n,a){var i=de(n?68:48),l=[i];i.write_shift(2,65534),i.write_shift(2,0),i.write_shift(4,842412599),i.write_shift(16,Be.utils.consts.HEADER_CLSID,"hex"),i.write_shift(4,n?2:1),i.write_shift(16,t,"hex"),i.write_shift(4,n?68:48);var c=Z1(e,r,s);if(l.push(c),n){var u=Z1(n,null,null);i.write_shift(16,a,"hex"),i.write_shift(4,68+c.length),l.push(u)}return ir(l)}function zn(e,t){return e.read_shift(t),null}function XO(e,t){t||(t=de(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function QO(e,t,r){for(var s=[],n=e.l+t;e.l<n;)s.push(r(e,n-e.l));if(n!==e.l)throw new Error("Slurp error");return s}function Bt(e,t){return e.read_shift(t)===1}function Dr(e,t){return t||(t=de(2)),t.write_shift(2,+!!e),t}function Gt(e){return e.read_shift(2,"u")}function ks(e,t){return t||(t=de(2)),t.write_shift(2,e),t}function zN(e,t){return QO(e,t,Gt)}function YO(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function $N(e,t,r){return r||(r=de(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function Pc(e,t,r){var s=e.read_shift(r&&r.biff>=12?2:1),n="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=e.read_shift(1);a&&(n="dbcs-cont")}else r.biff==12&&(n="wstr");r.biff>=2&&r.biff<=5&&(n="cpstr");var i=s?e.read_shift(s,n):"";return i}function JO(e){var t=e.read_shift(2),r=e.read_shift(1),s=r&4,n=r&8,a=1+(r&1),i=0,l,c={};n&&(i=e.read_shift(2)),s&&(l=e.read_shift(4));var u=a==2?"dbcs-cont":"sbcs-cont",d=t===0?"":e.read_shift(t,u);return n&&(e.l+=4*i),s&&(e.l+=l),c.t=d,n||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function ZO(e){var t=e.t||"",r=de(3);r.write_shift(2,t.length),r.write_shift(1,1);var s=de(2*t.length);s.write_shift(2*t.length,t,"utf16le");var n=[r,s];return ir(n)}function ii(e,t,r){var s;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var n=e.read_shift(1);return n===0?s=e.read_shift(t,"sbcs-cont"):s=e.read_shift(t,"dbcs-cont"),s}function Rc(e,t,r){var s=e.read_shift(r&&r.biff==2?1:2);return s===0?(e.l++,""):ii(e,s,r)}function xi(e,t,r){if(r.biff>5)return Rc(e,t,r);var s=e.read_shift(1);return s===0?(e.l++,""):e.read_shift(s,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function VN(e,t,r){return r||(r=de(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function eD(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function tD(e){var t=e.read_shift(4),r=e.l,s=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(s=!0),e.l=r);var n=e.read_shift((s?t-24:t)>>1,"utf16le").replace(Ur,"");return s&&(e.l+=24),n}function rD(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var s=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var n=e.read_shift(4);if(n===0)return r+s.replace(/\\/g,"/");var a=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=e.read_shift(a>>1,"utf16le").replace(Ur,"");return r+i}function sD(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return tD(e);case"0303000000000000c000000000000046":return rD(e);default:throw new Error("Unsupported Moniker "+r)}}function _u(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Ur,""):"";return r}function rw(e,t){t||(t=de(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function nD(e,t){var r=e.l+t,s=e.read_shift(4);if(s!==2)throw new Error("Unrecognized streamVersion: "+s);var n=e.read_shift(2);e.l+=2;var a,i,l,c,u="",d,f;n&16&&(a=_u(e,r-e.l)),n&128&&(i=_u(e,r-e.l)),(n&257)===257&&(l=_u(e,r-e.l)),(n&257)===1&&(c=sD(e,r-e.l)),n&8&&(u=_u(e,r-e.l)),n&32&&(d=e.read_shift(16)),n&64&&(f=Gx(e)),e.l=r;var h=i||l||c||"";h&&u&&(h+="#"+u),h||(h="#"+u),n&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var m={Target:h};return d&&(m.guid=d),f&&(m.time=f),a&&(m.Tooltip=a),m}function aD(e){var t=de(512),r=0,s=e.Target;s.slice(0,7)=="file://"&&(s=s.slice(7));var n=s.indexOf("#"),a=n>-1?31:23;switch(s.charAt(0)){case"#":a=28;break;case".":a&=-3;break}t.write_shift(4,2),t.write_shift(4,a);var i=[8,6815827,6619237,4849780,83];for(r=0;r<i.length;++r)t.write_shift(4,i[r]);if(a==28)s=s.slice(1),rw(s,t);else if(a&2){for(i="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));var l=n>-1?s.slice(0,n):s;for(t.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)t.write_shift(2,l.charCodeAt(r));t.write_shift(2,0),a&8&&rw(n>-1?s.slice(n+1):"",t)}else{for(i="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));for(var c=0;s.slice(c*3,c*3+3)=="../"||s.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,s.length-3*c+1),r=0;r<s.length-3*c;++r)t.write_shift(1,s.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function WN(e){var t=e.read_shift(1),r=e.read_shift(1),s=e.read_shift(1),n=e.read_shift(1);return[t,r,s,n]}function qN(e,t){var r=WN(e);return r[3]=0,r}function mn(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2);return{r:t,c:r,ixfe:s}}function oi(e,t,r,s){return s||(s=de(6)),s.write_shift(2,e),s.write_shift(2,t),s.write_shift(2,r||0),s}function iD(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function oD(e,t,r){return t===0?"":xi(e,t,r)}function lD(e,t,r){var s=r.biff>8?4:2,n=e.read_shift(s),a=e.read_shift(s,"i"),i=e.read_shift(s,"i");return[n,a,i]}function HN(e){var t=e.read_shift(2),r=Wx(e);return[t,r]}function cD(e,t,r){e.l+=4,t-=4;var s=e.l+t,n=Pc(e,t,r),a=e.read_shift(2);if(s-=e.l,a!==s)throw new Error("Malformed AddinUdf: padding = "+s+" != "+a);return e.l+=a,n}function y0(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2),n=e.read_shift(2);return{s:{c:s,r:t},e:{c:n,r}}}function GN(e,t){return t||(t=de(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function KN(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(1),n=e.read_shift(1);return{s:{c:s,r:t},e:{c:n,r}}}var uD=KN;function XN(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2);return e.l+=12,[r,t,s]}function dD(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function fD(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function br(e){e.l+=2,e.l+=e.read_shift(2)}var hD={0:br,4:br,5:br,6:br,7:fD,8:br,9:br,10:br,11:br,12:br,13:dD,14:br,15:br,16:br,17:br,18:br,19:br,20:br,21:XN};function mD(e,t){for(var r=e.l+t,s=[];e.l<r;){var n=e.read_shift(2);e.l-=2;try{s.push(hD[n](e,r-e.l))}catch{return e.l=r,s}}return e.l!=r&&(e.l=r),s}function Su(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function Kx(e,t,r){var s=1536,n=16;switch(r.bookType){case"biff8":break;case"biff5":s=1280,n=8;break;case"biff4":s=4,n=6;break;case"biff3":s=3,n=6;break;case"biff2":s=2,n=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var a=de(n);return a.write_shift(2,s),a.write_shift(2,t),n>4&&a.write_shift(2,29282),n>6&&a.write_shift(2,1997),n>8&&(a.write_shift(2,49161),a.write_shift(2,1),a.write_shift(2,1798),a.write_shift(2,0)),a}function pD(e,t){return t===0||e.read_shift(2),1200}function xD(e,t,r){if(r.enc)return e.l+=t,"";var s=e.l,n=xi(e,0,r);return e.read_shift(t+s-e.l),n}function gD(e,t){var r=!t||t.biff==8,s=de(r?112:54);for(s.write_shift(t.biff==8?2:1,7),r&&s.write_shift(1,0),s.write_shift(4,859007059),s.write_shift(4,5458548|(r?0:536870912));s.l<s.length;)s.write_shift(1,r?0:32);return s}function vD(e,t,r){var s=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:s&16,fBelow:s&64,fRight:s&128}}function yD(e,t,r){var s=e.read_shift(4),n=e.read_shift(1)&3,a=e.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var i=Pc(e,0,r);return i.length===0&&(i="Sheet1"),{pos:s,hs:n,dt:a,name:i}}function wD(e,t){var r=!t||t.biff>=8?2:1,s=de(8+r*e.name.length);s.write_shift(4,e.pos),s.write_shift(1,e.hs||0),s.write_shift(1,e.dt),s.write_shift(1,e.name.length),t.biff>=8&&s.write_shift(1,1),s.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var n=s.slice(0,s.l);return n.l=s.l,n}function bD(e,t){for(var r=e.l+t,s=e.read_shift(4),n=e.read_shift(4),a=[],i=0;i!=n&&e.l<r;++i)a.push(JO(e));return a.Count=s,a.Unique=n,a}function _D(e,t){var r=de(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var s=[],n=0;n<e.length;++n)s[n]=ZO(e[n]);var a=ir([r].concat(s));return a.parts=[r.length].concat(s.map(function(i){return i.length})),a}function SD(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function kD(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var s=e.read_shift(1);return e.l+=3,s&7&&(t.level=s&7),s&32&&(t.hidden=!0),s&64&&(t.hpt=r/20),t}function ND(e){var t=iD(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function ED(e){return e.read_shift(2),e.read_shift(4)}function sw(e,t,r){var s=0;r&&r.biff==2||(s=e.read_shift(2));var n=e.read_shift(2);r&&r.biff==2&&(s=1-(n>>15),n&=32767);var a={Unsynced:s&1,DyZero:(s&2)>>1,ExAsc:(s&4)>>2,ExDsc:(s&8)>>3};return[a,n]}function jD(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),u=e.read_shift(2);return{Pos:[t,r],Dim:[s,n],Flags:a,CurTab:i,FirstTab:l,Selected:c,TabRatio:u}}function TD(){var e=de(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function CD(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var s=e.read_shift(2);return{RTL:s&64}}function AD(e){var t=de(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function FD(){}function PD(e,t,r){var s={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return s.name=Pc(e,0,r),s}function RD(e,t){var r=e.name||"Arial",s=t&&t.biff==5,n=s?15+r.length:16+2*r.length,a=de(n);return a.write_shift(2,e.sz*20),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,r.length),s||a.write_shift(1,1),a.write_shift((s?1:2)*r.length,r,s?"sbcs":"utf16le"),a}function ID(e){var t=mn(e);return t.isst=e.read_shift(4),t}function OD(e,t,r,s){var n=de(10);return oi(e,t,s,n),n.write_shift(4,r),n}function DD(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var s=e.l+t,n=mn(e);r.biff==2&&e.l++;var a=Rc(e,s-e.l,r);return n.val=a,n}function LD(e,t,r,s,n){var a=!n||n.biff==8,i=de(8+ +a+(1+a)*r.length);return oi(e,t,s,i),i.write_shift(2,r.length),a&&i.write_shift(1,1),i.write_shift((1+a)*r.length,r,a?"utf16le":"sbcs"),i}function MD(e,t,r){var s=e.read_shift(2),n=xi(e,0,r);return[s,n]}function BD(e,t,r,s){var n=r&&r.biff==5;s||(s=de(n?3+t.length:5+2*t.length)),s.write_shift(2,e),s.write_shift(n?1:2,t.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*t.length,t,n?"sbcs":"utf16le");var a=s.length>s.l?s.slice(0,s.l):s;return a.l==null&&(a.l=a.length),a}var UD=xi;function nw(e,t,r){var s=e.l+t,n=r.biff==8||!r.biff?4:2,a=e.read_shift(n),i=e.read_shift(n),l=e.read_shift(2),c=e.read_shift(2);return e.l=s,{s:{r:a,c:l},e:{r:i,c}}}function zD(e,t){var r=t.biff==8||!t.biff?4:2,s=de(2*r+6);return s.write_shift(r,e.s.r),s.write_shift(r,e.e.r+1),s.write_shift(2,e.s.c),s.write_shift(2,e.e.c+1),s.write_shift(2,0),s}function $D(e){var t=e.read_shift(2),r=e.read_shift(2),s=HN(e);return{r:t,c:r,ixfe:s[0],rknum:s[1]}}function VD(e,t){for(var r=e.l+t-2,s=e.read_shift(2),n=e.read_shift(2),a=[];e.l<r;)a.push(HN(e));if(e.l!==r)throw new Error("MulRK read error");var i=e.read_shift(2);if(a.length!=i-n+1)throw new Error("MulRK length mismatch");return{r:s,c:n,C:i,rkrec:a}}function WD(e,t){for(var r=e.l+t-2,s=e.read_shift(2),n=e.read_shift(2),a=[];e.l<r;)a.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var i=e.read_shift(2);if(a.length!=i-n+1)throw new Error("MulBlank length mismatch");return{r:s,c:n,C:i,ixfe:a}}function qD(e,t,r,s){var n={},a=e.read_shift(4),i=e.read_shift(4),l=e.read_shift(4),c=e.read_shift(2);return n.patternType=NO[l>>26],s.cellStyles&&(n.alc=a&7,n.fWrap=a>>3&1,n.alcV=a>>4&7,n.fJustLast=a>>7&1,n.trot=a>>8&255,n.cIndent=a>>16&15,n.fShrinkToFit=a>>20&1,n.iReadOrder=a>>22&2,n.fAtrNum=a>>26&1,n.fAtrFnt=a>>27&1,n.fAtrAlc=a>>28&1,n.fAtrBdr=a>>29&1,n.fAtrPat=a>>30&1,n.fAtrProt=a>>31&1,n.dgLeft=i&15,n.dgRight=i>>4&15,n.dgTop=i>>8&15,n.dgBottom=i>>12&15,n.icvLeft=i>>16&127,n.icvRight=i>>23&127,n.grbitDiag=i>>30&3,n.icvTop=l&127,n.icvBottom=l>>7&127,n.icvDiag=l>>14&127,n.dgDiag=l>>21&15,n.icvFore=c&127,n.icvBack=c>>7&127,n.fsxButton=c>>14&1),n}function HD(e,t,r){var s={};return s.ifnt=e.read_shift(2),s.numFmtId=e.read_shift(2),s.flags=e.read_shift(2),s.fStyle=s.flags>>2&1,t-=6,s.data=qD(e,t,s.fStyle,r),s}function aw(e,t,r,s){var n=r&&r.biff==5;s||(s=de(n?16:20)),s.write_shift(2,0),e.style?(s.write_shift(2,e.numFmtId||0),s.write_shift(2,65524)):(s.write_shift(2,e.numFmtId||0),s.write_shift(2,t<<4));var a=0;return e.numFmtId>0&&n&&(a|=1024),s.write_shift(4,a),s.write_shift(4,0),n||s.write_shift(4,0),s.write_shift(2,0),s}function GD(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function KD(e){var t=de(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function iw(e,t,r){var s=mn(e);(r.biff==2||t==9)&&++e.l;var n=YO(e);return s.val=n,s.t=n===!0||n===!1?"b":"e",s}function XD(e,t,r,s,n,a){var i=de(8);return oi(e,t,s,i),$N(r,a,i),i}function QD(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var s=mn(e),n=Er(e);return s.val=n,s}function YD(e,t,r,s){var n=de(14);return oi(e,t,s,n),ai(r,n),n}var ow=oD;function JD(e,t,r){var s=e.l+t,n=e.read_shift(2),a=e.read_shift(2);if(r.sbcch=a,a==1025||a==14849)return[a,n];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var i=ii(e,a),l=[];s>e.l;)l.push(Rc(e));return[a,n,i,l]}function lw(e,t,r){var s=e.read_shift(2),n,a={fBuiltIn:s&1,fWantAdvise:s>>>1&1,fWantPict:s>>>2&1,fOle:s>>>3&1,fOleLink:s>>>4&1,cf:s>>>5&1023,fIcon:s>>>15&1};return r.sbcch===14849&&(n=cD(e,t-2,r)),a.body=n||e.read_shift(t-2),typeof n=="string"&&(a.Name=n),a}var ZD=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function cw(e,t,r){var s=e.l+t,n=e.read_shift(2),a=e.read_shift(1),i=e.read_shift(1),l=e.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),c=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var u=ii(e,i,r);n&32&&(u=ZD[u.charCodeAt(0)]);var d=s-e.l;r&&r.biff==2&&--d;var f=s==e.l||l===0||!(d>0)?[]:m7(e,d,r,l);return{chKey:a,Name:u,itab:c,rgce:f}}function QN(e,t,r){if(r.biff<8)return e8(e,t,r);for(var s=[],n=e.l+t,a=e.read_shift(r.biff>8?4:2);a--!==0;)s.push(lD(e,r.biff>8?12:6,r));if(e.l!=n)throw new Error("Bad ExternSheet: "+e.l+" != "+n);return s}function e8(e,t,r){e[e.l+1]==3&&e[e.l]++;var s=Pc(e,t,r);return s.charCodeAt(0)==3?s.slice(1):s}function t8(e,t,r){if(r.biff<8){e.l+=t;return}var s=e.read_shift(2),n=e.read_shift(2),a=ii(e,s,r),i=ii(e,n,r);return[a,i]}function r8(e,t,r){var s=KN(e);e.l++;var n=e.read_shift(1);return t-=8,[p7(e,t,r),n,s]}function uw(e,t,r){var s=uD(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[s,f7(e,t,r)]}function s8(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,s=e.read_shift(4);return[t,r,s]}function n8(e,t,r){if(!(r.biff<8)){var s=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),l=xi(e,0,r);return r.biff<8&&e.read_shift(1),[{r:s,c:n},l,i,a]}}function a8(e,t,r){return n8(e,t,r)}function i8(e,t){for(var r=[],s=e.read_shift(2);s--;)r.push(y0(e));return r}function o8(e){var t=de(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)GN(e[r],t);return t}function l8(e,t,r){if(r&&r.biff<8)return u8(e,t,r);var s=XN(e),n=mD(e,t-22,s[1]);return{cmo:s,ft:n}}var c8={8:function(e,t){var r=e.l+t;e.l+=10;var s=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var n=e.read_shift(1);return e.l+=n,e.l=r,{fmt:s}}};function u8(e,t,r){e.l+=4;var s=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var i=[];return i.push((c8[s]||Fr)(e,t,r)),{cmo:[n,s,a],ft:i}}function d8(e,t,r){var s=e.l,n="";try{e.l+=4;var a=(r.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(a)==-1?e.l+=6:i=eD(e,6,r);var l=e.read_shift(2);e.read_shift(2),Gt(e,2);var c=e.read_shift(2);e.l+=c;for(var u=1;u<e.lens.length-1;++u){if(e.l-s!=e.lens[u])throw new Error("TxO: bad continue record");var d=e[e.l],f=ii(e,e.lens[u+1]-e.lens[u]-1);if(n+=f,n.length>=(d?l:2*l))break}if(n.length!==l&&n.length!==l*2)throw new Error("cchText: "+l+" != "+n.length);return e.l=s+t,{t:n}}catch{return e.l=s+t,{t:n}}}function f8(e,t){var r=y0(e);e.l+=16;var s=nD(e,t-24);return[r,s]}function h8(e){var t=de(24),r=Ft(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var s="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<16;++n)t.write_shift(1,parseInt(s[n],16));return ir([t,aD(e[1])])}function m8(e,t){e.read_shift(2);var r=y0(e),s=e.read_shift((t-10)/2,"dbcs-cont");return s=s.replace(Ur,""),[r,s]}function p8(e){var t=e[1].Tooltip,r=de(10+2*(t.length+1));r.write_shift(2,2048);var s=Ft(e[0]);r.write_shift(2,s.r),r.write_shift(2,s.r),r.write_shift(2,s.c),r.write_shift(2,s.c);for(var n=0;n<t.length;++n)r.write_shift(2,t.charCodeAt(n));return r.write_shift(2,0),r}function x8(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=K1[r]||r,r=e.read_shift(2),t[1]=K1[r]||r,t}function g8(e){return e||(e=de(4)),e.write_shift(2,1),e.write_shift(2,1),e}function v8(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(qN(e));return r}function y8(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(qN(e));return r}function w8(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function YN(e,t,r){if(!r.cellStyles)return Fr(e,t);var s=r&&r.biff>=12?4:2,n=e.read_shift(s),a=e.read_shift(s),i=e.read_shift(s),l=e.read_shift(s),c=e.read_shift(2);s==2&&(e.l+=2);var u={s:n,e:a,w:i,ixfe:l,flags:c};return(r.biff>=5||!r.biff)&&(u.level=c>>8&7),u}function b8(e,t){var r=de(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var s=0;return e.hidden&&(s|=1),r.write_shift(1,s),s=e.level||0,r.write_shift(1,s),r.write_shift(2,0),r}function _8(e,t){var r={};return t<32||(e.l+=16,r.header=Er(e),r.footer=Er(e),e.l+=2),r}function S8(e,t,r){var s={area:!1};if(r.biff!=5)return e.l+=t,s;var n=e.read_shift(1);return e.l+=3,n&16&&(s.area=!0),s}function k8(e){for(var t=de(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var N8=mn,E8=zN,j8=Rc;function T8(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(4),n={fmt:t,env:r,len:s,data:e.slice(e.l,e.l+s)};return e.l+=s,n}function C8(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var s=mn(e);++e.l;var n=xi(e,t-7,r);return s.t="str",s.val=n,s}function A8(e){var t=mn(e);++e.l;var r=Er(e);return t.t="n",t.val=r,t}function F8(e,t,r){var s=de(15);return Lc(s,e,t),s.write_shift(8,r,"f"),s}function P8(e){var t=mn(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function R8(e,t,r){var s=de(9);return Lc(s,e,t),s.write_shift(2,r),s}function I8(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function O8(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function D8(e,t,r){var s=e.l+t,n=mn(e),a=e.read_shift(2),i=ii(e,a,r);return e.l=s,n.t="str",n.val=i,n}var L8=[2,3,48,49,131,139,140,245],Am=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=x0({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,c){var u=[],d=da(1);switch(c.type){case"base64":d=os(fs(l));break;case"binary":d=os(l);break;case"buffer":case"array":d=l;break}mr(d,0);var f=d.read_shift(1),h=!!(f&136),m=!1,x=!1;switch(f){case 2:break;case 3:break;case 48:m=!0,h=!0;break;case 49:m=!0,h=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var p=0,g=521;f==2&&(p=d.read_shift(2)),d.l+=3,f!=2&&(p=d.read_shift(4)),p>1048576&&(p=1e6),f!=2&&(g=d.read_shift(2));var w=d.read_shift(2),v=c.codepage||1252;f!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(v=e[d[d.l]]),d.l+=1,d.l+=2),x&&(d.l+=36);for(var y=[],b={},S=Math.min(d.length,f==2?521:g-10-(m?264:0)),_=x?32:11;d.l<S&&d[d.l]!=13;)switch(b={},b.name=ac.utils.decode(v,d.slice(d.l,d.l+_)).replace(/[\u0000\r\n].*$/g,""),d.l+=_,b.type=String.fromCharCode(d.read_shift(1)),f!=2&&!x&&(b.offset=d.read_shift(4)),b.len=d.read_shift(1),f==2&&(b.offset=d.read_shift(2)),b.dec=d.read_shift(1),b.name.length&&y.push(b),f!=2&&(d.l+=x?13:14),b.type){case"B":(!m||b.len!=8)&&c.WTF&&console.log("Skipping "+b.name+":"+b.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+b.name+":"+b.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+b.type)}if(d[d.l]!==13&&(d.l=g-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=g;var k=0,E=0;for(u[0]=[],E=0;E!=y.length;++E)u[0][E]=y[E].name;for(;p-- >0;){if(d[d.l]===42){d.l+=w;continue}for(++d.l,u[++k]=[],E=0,E=0;E!=y.length;++E){var T=d.slice(d.l,d.l+y[E].len);d.l+=y[E].len,mr(T,0);var M=ac.utils.decode(v,T);switch(y[E].type){case"C":M.trim().length&&(u[k][E]=M.replace(/\s+$/,""));break;case"D":M.length===8?u[k][E]=new Date(+M.slice(0,4),+M.slice(4,6)-1,+M.slice(6,8)):u[k][E]=M;break;case"F":u[k][E]=parseFloat(M.trim());break;case"+":case"I":u[k][E]=x?T.read_shift(-4,"i")^2147483648:T.read_shift(4,"i");break;case"L":switch(M.trim().toUpperCase()){case"Y":case"T":u[k][E]=!0;break;case"N":case"F":u[k][E]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+M+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));u[k][E]="##MEMO##"+(x?parseInt(M.trim(),10):T.read_shift(4));break;case"N":M=M.replace(/\u0000/g,"").trim(),M&&M!="."&&(u[k][E]=+M||0);break;case"@":u[k][E]=new Date(T.read_shift(-8,"f")-621356832e5);break;case"T":u[k][E]=new Date((T.read_shift(4)-2440588)*864e5+T.read_shift(4));break;case"Y":u[k][E]=T.read_shift(4,"i")/1e4+T.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[k][E]=-T.read_shift(-8,"f");break;case"B":if(m&&y[E].len==8){u[k][E]=T.read_shift(8,"f");break}case"G":case"P":T.l+=y[E].len;break;case"0":if(y[E].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+y[E].type)}}}if(f!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=y,u}function s(l,c){var u=c||{};u.dateNF||(u.dateNF="yyyymmdd");var d=Do(r(l,u),u);return d["!cols"]=u.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete u.DBF,d}function n(l,c){try{return _a(s(l,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function i(l,c){var u=c||{};if(+u.codepage>=0&&Gs(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var d=Jr(),f=Bd(l,{header:1,raw:!0,cellDates:!0}),h=f[0],m=f.slice(1),x=l["!cols"]||[],p=0,g=0,w=0,v=1;for(p=0;p<h.length;++p){if(((x[p]||{}).DBF||{}).name){h[p]=x[p].DBF.name,++w;continue}if(h[p]!=null){if(++w,typeof h[p]=="number"&&(h[p]=h[p].toString(10)),typeof h[p]!="string")throw new Error("DBF Invalid column name "+h[p]+" |"+typeof h[p]+"|");if(h.indexOf(h[p])!==p){for(g=0;g<1024;++g)if(h.indexOf(h[p]+"_"+g)==-1){h[p]+="_"+g;break}}}}var y=at(l["!ref"]),b=[],S=[],_=[];for(p=0;p<=y.e.c-y.s.c;++p){var k="",E="",T=0,M=[];for(g=0;g<m.length;++g)m[g][p]!=null&&M.push(m[g][p]);if(M.length==0||h[p]==null){b[p]="?";continue}for(g=0;g<M.length;++g){switch(typeof M[g]){case"number":E="B";break;case"string":E="C";break;case"boolean":E="L";break;case"object":E=M[g]instanceof Date?"D":"C";break;default:E="C"}T=Math.max(T,String(M[g]).length),k=k&&k!=E?"C":E}T>250&&(T=250),E=((x[p]||{}).DBF||{}).type,E=="C"&&x[p].DBF.len>T&&(T=x[p].DBF.len),k=="B"&&E=="N"&&(k="N",_[p]=x[p].DBF.dec,T=x[p].DBF.len),S[p]=k=="C"||E=="N"?T:a[k]||0,v+=S[p],b[p]=k}var q=d.next(32);for(q.write_shift(4,318902576),q.write_shift(4,m.length),q.write_shift(2,296+32*w),q.write_shift(2,v),p=0;p<4;++p)q.write_shift(4,0);for(q.write_shift(4,0|(+t[Uk]||3)<<8),p=0,g=0;p<h.length;++p)if(h[p]!=null){var D=d.next(32),W=(h[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);D.write_shift(1,W,"sbcs"),D.write_shift(1,b[p]=="?"?"C":b[p],"sbcs"),D.write_shift(4,g),D.write_shift(1,S[p]||a[b[p]]||0),D.write_shift(1,_[p]||0),D.write_shift(1,2),D.write_shift(4,0),D.write_shift(1,0),D.write_shift(4,0),D.write_shift(4,0),g+=S[p]||a[b[p]]||0}var ee=d.next(264);for(ee.write_shift(4,13),p=0;p<65;++p)ee.write_shift(4,0);for(p=0;p<m.length;++p){var Y=d.next(v);for(Y.write_shift(1,0),g=0;g<h.length;++g)if(h[g]!=null)switch(b[g]){case"L":Y.write_shift(1,m[p][g]==null?63:m[p][g]?84:70);break;case"B":Y.write_shift(8,m[p][g]||0,"f");break;case"N":var G="0";for(typeof m[p][g]=="number"&&(G=m[p][g].toFixed(_[g]||0)),w=0;w<S[g]-G.length;++w)Y.write_shift(1,32);Y.write_shift(1,G,"sbcs");break;case"D":m[p][g]?(Y.write_shift(4,("0000"+m[p][g].getFullYear()).slice(-4),"sbcs"),Y.write_shift(2,("00"+(m[p][g].getMonth()+1)).slice(-2),"sbcs"),Y.write_shift(2,("00"+m[p][g].getDate()).slice(-2),"sbcs")):Y.write_shift(8,"00000000","sbcs");break;case"C":var ce=String(m[p][g]!=null?m[p][g]:"").slice(0,S[g]);for(Y.write_shift(1,ce,"sbcs"),w=0;w<S[g]-ce.length;++w)Y.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:n,to_sheet:s,from_sheet:i}}(),JN=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Mt(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,m){var x=e[m];return typeof x=="number"?b1(x):x},s=function(h,m,x){var p=m.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return p==59?h:b1(p)};e["|"]=254;function n(h,m){switch(m.type){case"base64":return a(fs(h),m);case"binary":return a(h,m);case"buffer":return a(Qe&&Buffer.isBuffer(h)?h.toString("binary"):ba(h),m);case"array":return a(ni(h),m)}throw new Error("Unrecognized type "+m.type)}function a(h,m){var x=h.split(/[\n\r]+/),p=-1,g=-1,w=0,v=0,y=[],b=[],S=null,_={},k=[],E=[],T=[],M=0,q;for(+m.codepage>=0&&Gs(+m.codepage);w!==x.length;++w){M=0;var D=x[w].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,s).replace(t,r),W=D.replace(/;;/g,"\0").split(";").map(function(U){return U.replace(/\u0000/g,";")}),ee=W[0],Y;if(D.length>0)switch(ee){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":W[1].charAt(0)=="P"&&b.push(D.slice(3).replace(/;;/g,";"));break;case"C":var G=!1,ce=!1,Q=!1,B=!1,me=-1,fe=-1;for(v=1;v<W.length;++v)switch(W[v].charAt(0)){case"A":break;case"X":g=parseInt(W[v].slice(1))-1,ce=!0;break;case"Y":for(p=parseInt(W[v].slice(1))-1,ce||(g=0),q=y.length;q<=p;++q)y[q]=[];break;case"K":Y=W[v].slice(1),Y.charAt(0)==='"'?Y=Y.slice(1,Y.length-1):Y==="TRUE"?Y=!0:Y==="FALSE"?Y=!1:isNaN(Ys(Y))?isNaN(wo(Y).getDate())||(Y=wt(Y)):(Y=Ys(Y),S!==null&&Io(S)&&(Y=v0(Y))),G=!0;break;case"E":B=!0;var A=ao(W[v].slice(1),{r:p,c:g});y[p][g]=[y[p][g],A];break;case"S":Q=!0,y[p][g]=[y[p][g],"S5S"];break;case"G":break;case"R":me=parseInt(W[v].slice(1))-1;break;case"C":fe=parseInt(W[v].slice(1))-1;break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+D)}if(G&&(y[p][g]&&y[p][g].length==2?y[p][g][0]=Y:y[p][g]=Y,S=null),Q){if(B)throw new Error("SYLK shared formula cannot have own formula");var V=me>-1&&y[me][fe];if(!V||!V[1])throw new Error("SYLK shared formula cannot find base");y[p][g][1]=xE(V[1],{r:p-me,c:g-fe})}break;case"F":var L=0;for(v=1;v<W.length;++v)switch(W[v].charAt(0)){case"X":g=parseInt(W[v].slice(1))-1,++L;break;case"Y":for(p=parseInt(W[v].slice(1))-1,q=y.length;q<=p;++q)y[q]=[];break;case"M":M=parseInt(W[v].slice(1))/20;break;case"F":break;case"G":break;case"P":S=b[parseInt(W[v].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(T=W[v].slice(1).split(" "),q=parseInt(T[0],10);q<=parseInt(T[1],10);++q)M=parseInt(T[2],10),E[q-1]=M===0?{hidden:!0}:{wch:M},fa(E[q-1]);break;case"C":g=parseInt(W[v].slice(1))-1,E[g]||(E[g]={});break;case"R":p=parseInt(W[v].slice(1))-1,k[p]||(k[p]={}),M>0?(k[p].hpt=M,k[p].hpx=_o(M)):M===0&&(k[p].hidden=!0);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+D)}L<1&&(S=null);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+D)}}return k.length>0&&(_["!rows"]=k),E.length>0&&(_["!cols"]=E),m&&m.sheetRows&&(y=y.slice(0,m.sheetRows)),[y,_]}function i(h,m){var x=n(h,m),p=x[0],g=x[1],w=Do(p,m);return Mt(g).forEach(function(v){w[v]=g[v]}),w}function l(h,m){return _a(i(h,m),m)}function c(h,m,x,p){var g="C;Y"+(x+1)+";X"+(p+1)+";K";switch(h.t){case"n":g+=h.v||0,h.f&&!h.F&&(g+=";E"+eg(h.f,{r:x,c:p}));break;case"b":g+=h.v?"TRUE":"FALSE";break;case"e":g+=h.w||h.v;break;case"d":g+='"'+(h.w||h.v)+'"';break;case"s":g+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function u(h,m){m.forEach(function(x,p){var g="F;W"+(p+1)+" "+(p+1)+" ";x.hidden?g+="0":(typeof x.width=="number"&&!x.wpx&&(x.wpx=hc(x.width)),typeof x.wpx=="number"&&!x.wch&&(x.wch=mc(x.wpx)),typeof x.wch=="number"&&(g+=Math.round(x.wch))),g.charAt(g.length-1)!=" "&&h.push(g)})}function d(h,m){m.forEach(function(x,p){var g="F;";x.hidden?g+="M0;":x.hpt?g+="M"+20*x.hpt+";":x.hpx&&(g+="M"+20*pc(x.hpx)+";"),g.length>2&&h.push(g+"R"+(p+1))})}function f(h,m){var x=["ID;PWXL;N;E"],p=[],g=at(h["!ref"]),w,v=Array.isArray(h),y=`\r
`;x.push("P;PGeneral"),x.push("F;P0;DG0G8;M255"),h["!cols"]&&u(x,h["!cols"]),h["!rows"]&&d(x,h["!rows"]),x.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var b=g.s.r;b<=g.e.r;++b)for(var S=g.s.c;S<=g.e.c;++S){var _=Ve({r:b,c:S});w=v?(h[b]||[])[S]:h[_],!(!w||w.v==null&&(!w.f||w.F))&&p.push(c(w,h,b,S))}return x.join(y)+y+p.join(y)+y+"E"+y}return{to_workbook:l,to_sheet:i,from_sheet:f}}(),ZN=function(){function e(a,i){switch(i.type){case"base64":return t(fs(a),i);case"binary":return t(a,i);case"buffer":return t(Qe&&Buffer.isBuffer(a)?a.toString("binary"):ba(a),i);case"array":return t(ni(a),i)}throw new Error("Unrecognized type "+i.type)}function t(a,i){for(var l=a.split(`
`),c=-1,u=-1,d=0,f=[];d!==l.length;++d){if(l[d].trim()==="BOT"){f[++c]=[],u=0;continue}if(!(c<0)){var h=l[d].trim().split(","),m=h[0],x=h[1];++d;for(var p=l[d]||"";(p.match(/["]/g)||[]).length&1&&d<l.length-1;)p+=`
`+l[++d];switch(p=p.trim(),+m){case-1:if(p==="BOT"){f[++c]=[],u=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?f[c][u]=!0:p==="FALSE"?f[c][u]=!1:isNaN(Ys(x))?isNaN(wo(x).getDate())?f[c][u]=x:f[c][u]=wt(x):f[c][u]=Ys(x),++u;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),f[c][u++]=p!==""?p:null;break}if(p==="EOD")break}}return i&&i.sheetRows&&(f=f.slice(0,i.sheetRows)),f}function r(a,i){return Do(e(a,i),i)}function s(a,i){return _a(r(a,i),i)}var n=function(){var a=function(c,u,d,f,h){c.push(u),c.push(d+","+f),c.push('"'+h.replace(/"/g,'""')+'"')},i=function(c,u,d,f){c.push(u+","+d),c.push(u==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(c){var u=[],d=at(c["!ref"]),f,h=Array.isArray(c);a(u,"TABLE",0,1,"sheetjs"),a(u,"VECTORS",0,d.e.r-d.s.r+1,""),a(u,"TUPLES",0,d.e.c-d.s.c+1,""),a(u,"DATA",0,0,"");for(var m=d.s.r;m<=d.e.r;++m){i(u,-1,0,"BOT");for(var x=d.s.c;x<=d.e.c;++x){var p=Ve({r:m,c:x});if(f=h?(c[m]||[])[x]:c[p],!f){i(u,1,0,"");continue}switch(f.t){case"n":var g=f.w;!g&&f.v!=null&&(g=f.v),g==null?f.f&&!f.F?i(u,1,0,"="+f.f):i(u,1,0,""):i(u,0,g,"V");break;case"b":i(u,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":i(u,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=Os(f.z||$e[14],rr(wt(f.v)))),i(u,0,f.w,"V");break;default:i(u,1,0,"")}}}i(u,-1,0,"EOD");var w=`\r
`,v=u.join(w);return v}}();return{to_workbook:s,to_sheet:r,from_sheet:n}}(),eE=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,h){for(var m=f.split(`
`),x=-1,p=-1,g=0,w=[];g!==m.length;++g){var v=m[g].trim().split(":");if(v[0]==="cell"){var y=Ft(v[1]);if(w.length<=y.r)for(x=w.length;x<=y.r;++x)w[x]||(w[x]=[]);switch(x=y.r,p=y.c,v[2]){case"t":w[x][p]=e(v[3]);break;case"v":w[x][p]=+v[3];break;case"vtf":var b=v[v.length-1];case"vtc":switch(v[3]){case"nl":w[x][p]=!!+v[4];break;default:w[x][p]=+v[4];break}v[2]=="vtf"&&(w[x][p]=[w[x][p],b])}}}return h&&h.sheetRows&&(w=w.slice(0,h.sheetRows)),w}function s(f,h){return Do(r(f,h),h)}function n(f,h){return _a(s(f,h),h)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function u(f){if(!f||!f["!ref"])return"";for(var h=[],m=[],x,p="",g=Zr(f["!ref"]),w=Array.isArray(f),v=g.s.r;v<=g.e.r;++v)for(var y=g.s.c;y<=g.e.c;++y)if(p=Ve({r:v,c:y}),x=w?(f[v]||[])[y]:f[p],!(!x||x.v==null||x.t==="z")){switch(m=["cell",p,"t"],x.t){case"s":case"str":m.push(t(x.v));break;case"n":x.f?(m[2]="vtf",m[3]="n",m[4]=x.v,m[5]=t(x.f)):(m[2]="v",m[3]=x.v);break;case"b":m[2]="vt"+(x.f?"f":"c"),m[3]="nl",m[4]=x.v?"1":"0",m[5]=t(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var b=rr(wt(x.v));m[2]="vtc",m[3]="nd",m[4]=""+b,m[5]=x.w||Os(x.z||$e[14],b);break;case"e":continue}h.push(m.join(":"))}return h.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function d(f){return[a,i,l,i,u(f),c].join(`
`)}return{to_workbook:n,to_sheet:s,from_sheet:d}}(),bo=function(){function e(d,f,h,m,x){x.raw?f[h][m]=d:d===""||(d==="TRUE"?f[h][m]=!0:d==="FALSE"?f[h][m]=!1:isNaN(Ys(d))?isNaN(wo(d).getDate())?f[h][m]=d:f[h][m]=wt(d):f[h][m]=Ys(d))}function t(d,f){var h=f||{},m=[];if(!d||d.length===0)return m;for(var x=d.split(/[\r\n]/),p=x.length-1;p>=0&&x[p].length===0;)--p;for(var g=10,w=0,v=0;v<=p;++v)w=x[v].indexOf(" "),w==-1?w=x[v].length:w++,g=Math.max(g,w);for(v=0;v<=p;++v){m[v]=[];var y=0;for(e(x[v].slice(0,g).trim(),m,v,y,h),y=1;y<=(x[v].length-g)/10+1;++y)e(x[v].slice(g+(y-1)*10,g+y*10).trim(),m,v,y,h)}return h.sheetRows&&(m=m.slice(0,h.sheetRows)),m}var r={44:",",9:"	",59:";",124:"|"},s={44:3,9:2,59:1,124:0};function n(d){for(var f={},h=!1,m=0,x=0;m<d.length;++m)(x=d.charCodeAt(m))==34?h=!h:!h&&x in r&&(f[x]=(f[x]||0)+1);x=[];for(m in f)Object.prototype.hasOwnProperty.call(f,m)&&x.push([f[m],m]);if(!x.length){f=s;for(m in f)Object.prototype.hasOwnProperty.call(f,m)&&x.push([f[m],m])}return x.sort(function(p,g){return p[0]-g[0]||s[p[1]]-s[g[1]]}),r[x.pop()[1]]||44}function a(d,f){var h=f||{},m="",x=h.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(m=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(m=d.charAt(4),d=d.slice(6)):m=n(d.slice(0,1024)):h&&h.FS?m=h.FS:m=n(d.slice(0,1024));var g=0,w=0,v=0,y=0,b=0,S=m.charCodeAt(0),_=!1,k=0,E=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var T=h.dateNF!=null?SI(h.dateNF):null;function M(){var q=d.slice(y,b),D={};if(q.charAt(0)=='"'&&q.charAt(q.length-1)=='"'&&(q=q.slice(1,-1).replace(/""/g,'"')),q.length===0)D.t="z";else if(h.raw)D.t="s",D.v=q;else if(q.trim().length===0)D.t="s",D.v=q;else if(q.charCodeAt(0)==61)q.charCodeAt(1)==34&&q.charCodeAt(q.length-1)==34?(D.t="s",D.v=q.slice(2,-1).replace(/""/g,'"')):JM(q)?(D.t="n",D.f=q.slice(1)):(D.t="s",D.v=q);else if(q=="TRUE")D.t="b",D.v=!0;else if(q=="FALSE")D.t="b",D.v=!1;else if(!isNaN(v=Ys(q)))D.t="n",h.cellText!==!1&&(D.w=q),D.v=v;else if(!isNaN(wo(q).getDate())||T&&q.match(T)){D.z=h.dateNF||$e[14];var W=0;T&&q.match(T)&&(q=kI(q,h.dateNF,q.match(T)||[]),W=1),h.cellDates?(D.t="d",D.v=wt(q,W)):(D.t="n",D.v=rr(wt(q,W))),h.cellText!==!1&&(D.w=Os(D.z,D.v instanceof Date?rr(D.v):D.v)),h.cellNF||delete D.z}else D.t="s",D.v=q;if(D.t=="z"||(h.dense?(x[g]||(x[g]=[]),x[g][w]=D):x[Ve({c:w,r:g})]=D),y=b+1,E=d.charCodeAt(y),p.e.c<w&&(p.e.c=w),p.e.r<g&&(p.e.r=g),k==S)++w;else if(w=0,++g,h.sheetRows&&h.sheetRows<=g)return!0}e:for(;b<d.length;++b)switch(k=d.charCodeAt(b)){case 34:E===34&&(_=!_);break;case S:case 10:case 13:if(!_&&M())break e;break}return b-y>0&&M(),x["!ref"]=Ke(p),x}function i(d,f){return!(f&&f.PRN)||f.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?a(d,f):Do(t(d,f),f)}function l(d,f){var h="",m=f.type=="string"?[0,0,0,0]:lg(d,f);switch(f.type){case"base64":h=fs(d);break;case"binary":h=d;break;case"buffer":f.codepage==65001?h=d.toString("utf8"):f.codepage&&typeof ac<"u"||(h=Qe&&Buffer.isBuffer(d)?d.toString("binary"):ba(d));break;case"array":h=ni(d);break;case"string":h=d;break;default:throw new Error("Unrecognized type "+f.type)}return m[0]==239&&m[1]==187&&m[2]==191?h=ft(h.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?h=ft(h):f.type=="binary"&&typeof ac<"u",h.slice(0,19)=="socialcalc:version:"?eE.to_sheet(f.type=="string"?h:ft(h),f):i(h,f)}function c(d,f){return _a(l(d,f),f)}function u(d){for(var f=[],h=at(d["!ref"]),m,x=Array.isArray(d),p=h.s.r;p<=h.e.r;++p){for(var g=[],w=h.s.c;w<=h.e.c;++w){var v=Ve({r:p,c:w});if(m=x?(d[p]||[])[w]:d[v],!m||m.v==null){g.push("          ");continue}for(var y=(m.w||(In(m),m.w)||"").slice(0,10);y.length<10;)y+=" ";g.push(y+(w===0?" ":""))}f.push(g.join(""))}return f.join(`
`)}return{to_workbook:c,to_sheet:l,from_sheet:u}}();function M8(e,t){var r=t||{},s=!!r.WTF;r.WTF=!0;try{var n=JN.to_workbook(e,r);return r.WTF=s,n}catch(a){if(r.WTF=s,!a.message.match(/SYLK bad record ID/)&&s)throw a;return bo.to_workbook(e,t)}}var Xa=function(){function e(A,V,L){if(A){mr(A,A.l||0);for(var U=L.Enum||me;A.l<A.length;){var ne=A.read_shift(2),xe=U[ne]||U[65535],pe=A.read_shift(2),oe=A.l+pe,ue=xe.f&&xe.f(A,pe,L);if(A.l=oe,V(ue,xe,ne))return}}}function t(A,V){switch(V.type){case"base64":return r(os(fs(A)),V);case"binary":return r(os(A),V);case"buffer":case"array":return r(A,V)}throw"Unsupported type "+V.type}function r(A,V){if(!A)return A;var L=V||{},U=L.dense?[]:{},ne="Sheet1",xe="",pe=0,oe={},ue=[],we=[],P={s:{r:0,c:0},e:{r:0,c:0}},Me=L.sheetRows||0;if(A[2]==0&&(A[3]==8||A[3]==9)&&A.length>=16&&A[14]==5&&A[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(A[2]==2)L.Enum=me,e(A,function(H,Z,J){switch(J){case 0:L.vers=H,H>=4096&&(L.qpro=!0);break;case 6:P=H;break;case 204:H&&(xe=H);break;case 222:xe=H;break;case 15:case 51:L.qpro||(H[1].v=H[1].v.slice(1));case 13:case 14:case 16:J==14&&(H[2]&112)==112&&(H[2]&15)>1&&(H[2]&15)<15&&(H[1].z=L.dateNF||$e[14],L.cellDates&&(H[1].t="d",H[1].v=v0(H[1].v))),L.qpro&&H[3]>pe&&(U["!ref"]=Ke(P),oe[ne]=U,ue.push(ne),U=L.dense?[]:{},P={s:{r:0,c:0},e:{r:0,c:0}},pe=H[3],ne=xe||"Sheet"+(pe+1),xe="");var K=L.dense?(U[H[0].r]||[])[H[0].c]:U[Ve(H[0])];if(K){K.t=H[1].t,K.v=H[1].v,H[1].z!=null&&(K.z=H[1].z),H[1].f!=null&&(K.f=H[1].f);break}L.dense?(U[H[0].r]||(U[H[0].r]=[]),U[H[0].r][H[0].c]=H[1]):U[Ve(H[0])]=H[1];break}},L);else if(A[2]==26||A[2]==14)L.Enum=fe,A[2]==14&&(L.qpro=!0,A.l=0),e(A,function(H,Z,J){switch(J){case 204:ne=H;break;case 22:H[1].v=H[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(H[3]>pe&&(U["!ref"]=Ke(P),oe[ne]=U,ue.push(ne),U=L.dense?[]:{},P={s:{r:0,c:0},e:{r:0,c:0}},pe=H[3],ne="Sheet"+(pe+1)),Me>0&&H[0].r>=Me)break;L.dense?(U[H[0].r]||(U[H[0].r]=[]),U[H[0].r][H[0].c]=H[1]):U[Ve(H[0])]=H[1],P.e.c<H[0].c&&(P.e.c=H[0].c),P.e.r<H[0].r&&(P.e.r=H[0].r);break;case 27:H[14e3]&&(we[H[14e3][0]]=H[14e3][1]);break;case 1537:we[H[0]]=H[1],H[0]==pe&&(ne=H[1]);break}},L);else throw new Error("Unrecognized LOTUS BOF "+A[2]);if(U["!ref"]=Ke(P),oe[xe||ne]=U,ue.push(xe||ne),!we.length)return{SheetNames:ue,Sheets:oe};for(var je={},X=[],z=0;z<we.length;++z)oe[ue[z]]?(X.push(we[z]||ue[z]),je[we[z]]=oe[we[z]]||oe[ue[z]]):(X.push(we[z]),je[we[z]]={"!ref":"A1"});return{SheetNames:X,Sheets:je}}function s(A,V){var L=V||{};if(+L.codepage>=0&&Gs(+L.codepage),L.type=="string")throw new Error("Cannot write WK1 to JS string");var U=Jr(),ne=at(A["!ref"]),xe=Array.isArray(A),pe=[];Ne(U,0,a(1030)),Ne(U,6,c(ne));for(var oe=Math.min(ne.e.r,8191),ue=ne.s.r;ue<=oe;++ue)for(var we=$t(ue),P=ne.s.c;P<=ne.e.c;++P){ue===ne.s.r&&(pe[P]=At(P));var Me=pe[P]+we,je=xe?(A[ue]||[])[P]:A[Me];if(!(!je||je.t=="z"))if(je.t=="n")(je.v|0)==je.v&&je.v>=-32768&&je.v<=32767?Ne(U,13,m(ue,P,je.v)):Ne(U,14,p(ue,P,je.v));else{var X=In(je);Ne(U,15,f(ue,P,X.slice(0,239)))}}return Ne(U,1),U.end()}function n(A,V){var L=V||{};if(+L.codepage>=0&&Gs(+L.codepage),L.type=="string")throw new Error("Cannot write WK3 to JS string");var U=Jr();Ne(U,0,i(A));for(var ne=0,xe=0;ne<A.SheetNames.length;++ne)(A.Sheets[A.SheetNames[ne]]||{})["!ref"]&&Ne(U,27,B(A.SheetNames[ne],xe++));var pe=0;for(ne=0;ne<A.SheetNames.length;++ne){var oe=A.Sheets[A.SheetNames[ne]];if(!(!oe||!oe["!ref"])){for(var ue=at(oe["!ref"]),we=Array.isArray(oe),P=[],Me=Math.min(ue.e.r,8191),je=ue.s.r;je<=Me;++je)for(var X=$t(je),z=ue.s.c;z<=ue.e.c;++z){je===ue.s.r&&(P[z]=At(z));var H=P[z]+X,Z=we?(oe[je]||[])[z]:oe[H];if(!(!Z||Z.t=="z"))if(Z.t=="n")Ne(U,23,M(je,z,pe,Z.v));else{var J=In(Z);Ne(U,22,k(je,z,pe,J.slice(0,239)))}}++pe}}return Ne(U,1),U.end()}function a(A){var V=de(2);return V.write_shift(2,A),V}function i(A){var V=de(26);V.write_shift(2,4096),V.write_shift(2,4),V.write_shift(4,0);for(var L=0,U=0,ne=0,xe=0;xe<A.SheetNames.length;++xe){var pe=A.SheetNames[xe],oe=A.Sheets[pe];if(!(!oe||!oe["!ref"])){++ne;var ue=Zr(oe["!ref"]);L<ue.e.r&&(L=ue.e.r),U<ue.e.c&&(U=ue.e.c)}}return L>8191&&(L=8191),V.write_shift(2,L),V.write_shift(1,ne),V.write_shift(1,U),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(1,1),V.write_shift(1,2),V.write_shift(4,0),V.write_shift(4,0),V}function l(A,V,L){var U={s:{c:0,r:0},e:{c:0,r:0}};return V==8&&L.qpro?(U.s.c=A.read_shift(1),A.l++,U.s.r=A.read_shift(2),U.e.c=A.read_shift(1),A.l++,U.e.r=A.read_shift(2),U):(U.s.c=A.read_shift(2),U.s.r=A.read_shift(2),V==12&&L.qpro&&(A.l+=2),U.e.c=A.read_shift(2),U.e.r=A.read_shift(2),V==12&&L.qpro&&(A.l+=2),U.s.c==65535&&(U.s.c=U.e.c=U.s.r=U.e.r=0),U)}function c(A){var V=de(8);return V.write_shift(2,A.s.c),V.write_shift(2,A.s.r),V.write_shift(2,A.e.c),V.write_shift(2,A.e.r),V}function u(A,V,L){var U=[{c:0,r:0},{t:"n",v:0},0,0];return L.qpro&&L.vers!=20768?(U[0].c=A.read_shift(1),U[3]=A.read_shift(1),U[0].r=A.read_shift(2),A.l+=2):(U[2]=A.read_shift(1),U[0].c=A.read_shift(2),U[0].r=A.read_shift(2)),U}function d(A,V,L){var U=A.l+V,ne=u(A,V,L);if(ne[1].t="s",L.vers==20768){A.l++;var xe=A.read_shift(1);return ne[1].v=A.read_shift(xe,"utf8"),ne}return L.qpro&&A.l++,ne[1].v=A.read_shift(U-A.l,"cstr"),ne}function f(A,V,L){var U=de(7+L.length);U.write_shift(1,255),U.write_shift(2,V),U.write_shift(2,A),U.write_shift(1,39);for(var ne=0;ne<U.length;++ne){var xe=L.charCodeAt(ne);U.write_shift(1,xe>=128?95:xe)}return U.write_shift(1,0),U}function h(A,V,L){var U=u(A,V,L);return U[1].v=A.read_shift(2,"i"),U}function m(A,V,L){var U=de(7);return U.write_shift(1,255),U.write_shift(2,V),U.write_shift(2,A),U.write_shift(2,L,"i"),U}function x(A,V,L){var U=u(A,V,L);return U[1].v=A.read_shift(8,"f"),U}function p(A,V,L){var U=de(13);return U.write_shift(1,255),U.write_shift(2,V),U.write_shift(2,A),U.write_shift(8,L,"f"),U}function g(A,V,L){var U=A.l+V,ne=u(A,V,L);if(ne[1].v=A.read_shift(8,"f"),L.qpro)A.l=U;else{var xe=A.read_shift(2);b(A.slice(A.l,A.l+xe),ne),A.l+=xe}return ne}function w(A,V,L){var U=V&32768;return V&=-32769,V=(U?A:0)+(V>=8192?V-16384:V),(U?"":"$")+(L?At(V):$t(V))}var v={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},y=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function b(A,V){mr(A,0);for(var L=[],U=0,ne="",xe="",pe="",oe="";A.l<A.length;){var ue=A[A.l++];switch(ue){case 0:L.push(A.read_shift(8,"f"));break;case 1:xe=w(V[0].c,A.read_shift(2),!0),ne=w(V[0].r,A.read_shift(2),!1),L.push(xe+ne);break;case 2:{var we=w(V[0].c,A.read_shift(2),!0),P=w(V[0].r,A.read_shift(2),!1);xe=w(V[0].c,A.read_shift(2),!0),ne=w(V[0].r,A.read_shift(2),!1),L.push(we+P+":"+xe+ne)}break;case 3:if(A.l<A.length){console.error("WK1 premature formula end");return}break;case 4:L.push("("+L.pop()+")");break;case 5:L.push(A.read_shift(2));break;case 6:{for(var Me="";ue=A[A.l++];)Me+=String.fromCharCode(ue);L.push('"'+Me.replace(/"/g,'""')+'"')}break;case 8:L.push("-"+L.pop());break;case 23:L.push("+"+L.pop());break;case 22:L.push("NOT("+L.pop()+")");break;case 20:case 21:oe=L.pop(),pe=L.pop(),L.push(["AND","OR"][ue-20]+"("+pe+","+oe+")");break;default:if(ue<32&&y[ue])oe=L.pop(),pe=L.pop(),L.push(pe+y[ue]+oe);else if(v[ue]){if(U=v[ue][1],U==69&&(U=A[A.l++]),U>L.length){console.error("WK1 bad formula parse 0x"+ue.toString(16)+":|"+L.join("|")+"|");return}var je=L.slice(-U);L.length-=U,L.push(v[ue][0]+"("+je.join(",")+")")}else return ue<=7?console.error("WK1 invalid opcode "+ue.toString(16)):ue<=24?console.error("WK1 unsupported op "+ue.toString(16)):ue<=30?console.error("WK1 invalid opcode "+ue.toString(16)):ue<=115?console.error("WK1 unsupported function opcode "+ue.toString(16)):console.error("WK1 unrecognized opcode "+ue.toString(16))}}L.length==1?V[1].f=""+L[0]:console.error("WK1 bad formula parse |"+L.join("|")+"|")}function S(A){var V=[{c:0,r:0},{t:"n",v:0},0];return V[0].r=A.read_shift(2),V[3]=A[A.l++],V[0].c=A[A.l++],V}function _(A,V){var L=S(A);return L[1].t="s",L[1].v=A.read_shift(V-4,"cstr"),L}function k(A,V,L,U){var ne=de(6+U.length);ne.write_shift(2,A),ne.write_shift(1,L),ne.write_shift(1,V),ne.write_shift(1,39);for(var xe=0;xe<U.length;++xe){var pe=U.charCodeAt(xe);ne.write_shift(1,pe>=128?95:pe)}return ne.write_shift(1,0),ne}function E(A,V){var L=S(A);L[1].v=A.read_shift(2);var U=L[1].v>>1;if(L[1].v&1)switch(U&7){case 0:U=(U>>3)*5e3;break;case 1:U=(U>>3)*500;break;case 2:U=(U>>3)/20;break;case 3:U=(U>>3)/200;break;case 4:U=(U>>3)/2e3;break;case 5:U=(U>>3)/2e4;break;case 6:U=(U>>3)/16;break;case 7:U=(U>>3)/64;break}return L[1].v=U,L}function T(A,V){var L=S(A),U=A.read_shift(4),ne=A.read_shift(4),xe=A.read_shift(2);if(xe==65535)return U===0&&ne===3221225472?(L[1].t="e",L[1].v=15):U===0&&ne===3489660928?(L[1].t="e",L[1].v=42):L[1].v=0,L;var pe=xe&32768;return xe=(xe&32767)-16446,L[1].v=(1-pe*2)*(ne*Math.pow(2,xe+32)+U*Math.pow(2,xe)),L}function M(A,V,L,U){var ne=de(14);if(ne.write_shift(2,A),ne.write_shift(1,L),ne.write_shift(1,V),U==0)return ne.write_shift(4,0),ne.write_shift(4,0),ne.write_shift(2,65535),ne;var xe=0,pe=0,oe=0,ue=0;return U<0&&(xe=1,U=-U),pe=Math.log2(U)|0,U/=Math.pow(2,pe-31),ue=U>>>0,ue&2147483648||(U/=2,++pe,ue=U>>>0),U-=ue,ue|=2147483648,ue>>>=0,U*=Math.pow(2,32),oe=U>>>0,ne.write_shift(4,oe),ne.write_shift(4,ue),pe+=16383+(xe?32768:0),ne.write_shift(2,pe),ne}function q(A,V){var L=T(A);return A.l+=V-14,L}function D(A,V){var L=S(A),U=A.read_shift(4);return L[1].v=U>>6,L}function W(A,V){var L=S(A),U=A.read_shift(8,"f");return L[1].v=U,L}function ee(A,V){var L=W(A);return A.l+=V-10,L}function Y(A,V){return A[A.l+V-1]==0?A.read_shift(V,"cstr"):""}function G(A,V){var L=A[A.l++];L>V-1&&(L=V-1);for(var U="";U.length<L;)U+=String.fromCharCode(A[A.l++]);return U}function ce(A,V,L){if(!(!L.qpro||V<21)){var U=A.read_shift(1);A.l+=17,A.l+=1,A.l+=2;var ne=A.read_shift(V-21,"cstr");return[U,ne]}}function Q(A,V){for(var L={},U=A.l+V;A.l<U;){var ne=A.read_shift(2);if(ne==14e3){for(L[ne]=[0,""],L[ne][0]=A.read_shift(2);A[A.l];)L[ne][1]+=String.fromCharCode(A[A.l]),A.l++;A.l++}}return L}function B(A,V){var L=de(5+A.length);L.write_shift(2,14e3),L.write_shift(2,V);for(var U=0;U<A.length;++U){var ne=A.charCodeAt(U);L[L.l++]=ne>127?95:ne}return L[L.l++]=0,L}var me={0:{n:"BOF",f:Gt},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:x},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Y},222:{n:"SHEETNAMELP",f:G},65535:{n:""}},fe={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:_},23:{n:"NUMBER17",f:T},24:{n:"NUMBER18",f:E},25:{n:"FORMULA19",f:q},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Q},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:D},38:{n:"??"},39:{n:"NUMBER27",f:W},40:{n:"FORMULA28",f:ee},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Y},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ce},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:s,book_to_wk3:n,to_workbook:t}}();function B8(e){var t={},r=e.match(Pr),s=0,n=!1;if(r)for(;s!=r.length;++s){var a=qe(r[s]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;t.cp=Nx[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=a.val;break;case"<sz":t.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":a.rgb&&(t.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(a[0].charCodeAt(1)!==47&&!n)throw new Error("Unrecognized rich format "+a[0])}}return t}var U8=function(){var e=lc("t"),t=lc("rPr");function r(a){var i=a.match(e);if(!i)return{t:"s",v:""};var l={t:"s",v:nt(i[1])},c=a.match(t);return c&&(l.s=B8(c[1])),l}var s=/<(?:\w+:)?r>/g,n=/<\/(?:\w+:)?r>/;return function(i){return i.replace(s,"").split(n).map(r).filter(function(l){return l.v})}}(),z8=function(){var t=/(\r\n|\n)/g;function r(n,a,i){var l=[];n.u&&l.push("text-decoration: underline;"),n.uval&&l.push("text-underline-style:"+n.uval+";"),n.sz&&l.push("font-size:"+n.sz+"pt;"),n.outline&&l.push("text-effect: outline;"),n.shadow&&l.push("text-shadow: auto;"),a.push('<span style="'+l.join("")+'">'),n.b&&(a.push("<b>"),i.push("</b>")),n.i&&(a.push("<i>"),i.push("</i>")),n.strike&&(a.push("<s>"),i.push("</s>"));var c=n.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(a.push("<"+c+">"),i.push("</"+c+">")),i.push("</span>"),n}function s(n){var a=[[],n.v,[]];return n.v?(n.s&&r(n.s,a[0],a[2]),a[0].join("")+a[1].replace(t,"<br/>")+a[2].join("")):""}return function(a){return a.map(s).join("")}}(),$8=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,V8=/<(?:\w+:)?r>/,W8=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Xx(e,t){var r=t?t.cellHTML:!0,s={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(s.t=nt(ft(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),s.r=ft(e),r&&(s.h=Ox(s.t))):e.match(V8)&&(s.r=ft(e),s.t=nt(ft((e.replace(W8,"").match($8)||[]).join("").replace(Pr,""))),r&&(s.h=z8(U8(s.r)))),s):{t:""}}var q8=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,H8=/<(?:\w+:)?(?:si|sstItem)>/g,G8=/<\/(?:\w+:)?(?:si|sstItem)>/;function K8(e,t){var r=[],s="";if(!e)return r;var n=e.match(q8);if(n){s=n[2].replace(H8,"").split(G8);for(var a=0;a!=s.length;++a){var i=Xx(s[a].trim(),t);i!=null&&(r[r.length]=i)}n=qe(n[1]),r.Count=n.count,r.Unique=n.uniqueCount}return r}var X8=/^\s|\s$|[\t\n\r]/;function tE(e,t){if(!t.bookSST)return"";var r=[Vt];r[r.length]=ke("sst",null,{xmlns:di[0],count:e.Count,uniqueCount:e.Unique});for(var s=0;s!=e.length;++s)if(e[s]!=null){var n=e[s],a="<si>";n.r?a+=n.r:(a+="<t",n.t||(n.t=""),n.t.match(X8)&&(a+=' xml:space="preserve"'),a+=">"+ut(n.t)+"</t>"),a+="</si>",r[r.length]=a}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function Q8(e){return[e.read_shift(4),e.read_shift(4)]}function Y8(e,t){var r=[],s=!1;return Ln(e,function(a,i,l){switch(l){case 159:r.Count=a[0],r.Unique=a[1];break;case 19:r.push(a);break;case 160:return!0;case 35:s=!0;break;case 36:s=!1;break;default:if(i.T,!s||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),r}function J8(e,t){return t||(t=de(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var Z8=cO;function eL(e){var t=Jr();ge(t,159,J8(e));for(var r=0;r<e.length;++r)ge(t,19,Z8(e[r]));return ge(t,160),t.end()}function rE(e){for(var t=[],r=e.split(""),s=0;s<r.length;++s)t[s]=r[s].charCodeAt(0);return t}function jn(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function tL(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=jn(e,4),t.U=jn(e,4),t.W=jn(e,4),t}function rL(e){for(var t=e.read_shift(4),r=e.l+t-4,s={},n=e.read_shift(4),a=[];n-- >0;)a.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(s.name=e.read_shift(0,"lpp4"),s.comps=a,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return s}function sL(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(rL(e));return t}function nL(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function aL(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=jn(e,4),t.U=jn(e,4),t.W=jn(e,4),t}function iL(e){var t=aL(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function sE(e,t){var r=e.l+t,s={};s.Flags=e.read_shift(4)&63,e.l+=4,s.AlgID=e.read_shift(4);var n=!1;switch(s.AlgID){case 26126:case 26127:case 26128:n=s.Flags==36;break;case 26625:n=s.Flags==4;break;case 0:n=s.Flags==16||s.Flags==4||s.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+s.AlgID}if(!n)throw new Error("Encryption Flags/AlgID mismatch");return s.AlgIDHash=e.read_shift(4),s.KeySize=e.read_shift(4),s.ProviderType=e.read_shift(4),e.l+=8,s.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,s}function nE(e,t){var r={},s=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,s),e.l=s,r}function oL(e){var t=jn(e);switch(t.Minor){case 2:return[t.Minor,lL(e)];case 3:return[t.Minor,cL()];case 4:return[t.Minor,uL(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function lL(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),s=sE(e,r),n=nE(e,e.length-e.l);return{t:"Std",h:s,v:n}}function cL(){throw new Error("File is password-protected: ECMA-376 Extensible")}function uL(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),s={};return r.replace(Pr,function(a){var i=qe(a);switch(hn(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(l){s[l]=i[l]});break;case"<dataIntegrity":s.encryptedHmacKey=i.encryptedHmacKey,s.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":s.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":s.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":s.encs.push(i);break;default:throw i[0]}}),s}function dL(e,t){var r={},s=r.EncryptionVersionInfo=jn(e,4);if(t-=4,s.Minor!=2)throw new Error("unrecognized minor version code: "+s.Minor);if(s.Major>4||s.Major<2)throw new Error("unrecognized major version code: "+s.Major);r.Flags=e.read_shift(4),t-=4;var n=e.read_shift(4);return t-=4,r.EncryptionHeader=sE(e,n),t-=n,r.EncryptionVerifier=nE(e,t),r}function fL(e){var t={},r=t.EncryptionVersionInfo=jn(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function Qx(e){var t=0,r,s=rE(e),n=s.length+1,a,i,l,c,u;for(r=da(n),r[0]=s.length,a=1;a!=n;++a)r[a]=s[a-1];for(a=n-1;a>=0;--a)i=r[a],l=t&16384?1:0,c=t<<1&32767,u=l|c,t=u^i;return t^52811}var aE=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],s=function(i){return(i/2|i*128)&255},n=function(i,l){return s(i^l)},a=function(i){for(var l=t[i.length-1],c=104,u=i.length-1;u>=0;--u)for(var d=i[u],f=0;f!=7;++f)d&64&&(l^=r[c]),d*=2,--c;return l};return function(i){for(var l=rE(i),c=a(l),u=l.length,d=da(16),f=0;f!=16;++f)d[f]=0;var h,m,x;for((u&1)===1&&(h=c>>8,d[u]=n(e[0],h),--u,h=c&255,m=l[l.length-1],d[u]=n(m,h));u>0;)--u,h=c>>8,d[u]=n(l[u],h),--u,h=c&255,d[u]=n(l[u],h);for(u=15,x=15-l.length;x>0;)h=c>>8,d[u]=n(e[x],h),--u,--x,h=c&255,d[u]=n(l[u],h),--u,--x;return d}}(),hL=function(e,t,r,s,n){n||(n=t),s||(s=aE(e));var a,i;for(a=0;a!=t.length;++a)i=t[a],i^=s[r],i=(i>>5|i<<3)&255,n[a]=i,++r;return[n,r,s]},mL=function(e){var t=0,r=aE(e);return function(s){var n=hL("",s,t,r);return t=n[1],n[0]}};function pL(e,t,r,s){var n={key:Gt(e),verificationBytes:Gt(e)};return r.password&&(n.verifier=Qx(r.password)),s.valid=n.verificationBytes===n.verifier,s.valid&&(s.insitu=mL(r.password)),n}function xL(e,t,r){var s=r||{};return s.Info=e.read_shift(2),e.l-=2,s.Info===1?s.Data=fL(e):s.Data=dL(e,t),s}function gL(e,t,r){var s={Type:r.biff>=8?e.read_shift(2):0};return s.Type?xL(e,t-2,s):pL(e,r.biff>=8?t:t-2,r,s),s}var iE=function(){function e(n,a){switch(a.type){case"base64":return t(fs(n),a);case"binary":return t(n,a);case"buffer":return t(Qe&&Buffer.isBuffer(n)?n.toString("binary"):ba(n),a);case"array":return t(ni(n),a)}throw new Error("Unrecognized type "+a.type)}function t(n,a){var i=a||{},l=i.dense?[]:{},c=n.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(d,f){Array.isArray(l)&&(l[f]=[]);for(var h=/\\\w+\b/g,m=0,x,p=-1;x=h.exec(d);){switch(x[0]){case"\\cell":var g=d.slice(m,h.lastIndex-x[0].length);if(g[0]==" "&&(g=g.slice(1)),++p,g.length){var w={v:g,t:"s"};Array.isArray(l)?l[f][p]=w:l[Ve({r:f,c:p})]=w}break}m=h.lastIndex}p>u.e.c&&(u.e.c=p)}),l["!ref"]=Ke(u),l}function r(n,a){return _a(e(n,a),a)}function s(n){for(var a=["{\\rtf1\\ansi"],i=at(n["!ref"]),l,c=Array.isArray(n),u=i.s.r;u<=i.e.r;++u){a.push("\\trowd\\trautofit1");for(var d=i.s.c;d<=i.e.c;++d)a.push("\\cellx"+(d+1));for(a.push("\\pard\\intbl"),d=i.s.c;d<=i.e.c;++d){var f=Ve({r:u,c:d});l=c?(n[u]||[])[d]:n[f],!(!l||l.v==null&&(!l.f||l.F))&&(a.push(" "+(l.w||(In(l),l.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:s}}();function vL(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function fc(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function yL(e){var t=e[0]/255,r=e[1]/255,s=e[2]/255,n=Math.max(t,r,s),a=Math.min(t,r,s),i=n-a;if(i===0)return[0,0,t];var l=0,c=0,u=n+a;switch(c=i/(u>1?2-u:u),n){case t:l=((r-s)/i+6)%6;break;case r:l=(s-t)/i+2;break;case s:l=(t-r)/i+4;break}return[l/6,c,u/2]}function wL(e){var t=e[0],r=e[1],s=e[2],n=r*2*(s<.5?s:1-s),a=s-n/2,i=[a,a,a],l=6*t,c;if(r!==0)switch(l|0){case 0:case 6:c=n*l,i[0]+=n,i[1]+=c;break;case 1:c=n*(2-l),i[0]+=c,i[1]+=n;break;case 2:c=n*(l-2),i[1]+=n,i[2]+=c;break;case 3:c=n*(4-l),i[1]+=c,i[2]+=n;break;case 4:c=n*(l-4),i[2]+=n,i[0]+=c;break;case 5:c=n*(6-l),i[2]+=c,i[0]+=n;break}for(var u=0;u!=3;++u)i[u]=Math.round(i[u]*255);return i}function Ld(e,t){if(t===0)return e;var r=yL(vL(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),fc(wL(r))}var oE=6,bL=15,_L=1,Nr=oE;function hc(e){return Math.floor((e+Math.round(128/Nr)/256)*Nr)}function mc(e){return Math.floor((e-5)/Nr*100+.5)/100}function Md(e){return Math.round((e*Nr+5)/Nr*256)/256}function If(e){return Md(mc(hc(e)))}function Yx(e){var t=Math.abs(e-If(e)),r=Nr;if(t>.005)for(Nr=_L;Nr<bL;++Nr)Math.abs(e-If(e))<=t&&(t=Math.abs(e-If(e)),r=Nr);Nr=r}function fa(e){e.width?(e.wpx=hc(e.width),e.wch=mc(e.wpx),e.MDW=Nr):e.wpx?(e.wch=mc(e.wpx),e.width=Md(e.wch),e.MDW=Nr):typeof e.wch=="number"&&(e.width=Md(e.wch),e.wpx=hc(e.width),e.MDW=Nr),e.customWidth&&delete e.customWidth}var SL=96,lE=SL;function pc(e){return e*96/lE}function _o(e){return e*lE/96}var kL={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function NL(e,t,r,s){t.Borders=[];var n={},a=!1;(e[0].match(Pr)||[]).forEach(function(i){var l=qe(i);switch(hn(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":n={},l.diagonalUp&&(n.diagonalUp=vt(l.diagonalUp)),l.diagonalDown&&(n.diagonalDown=vt(l.diagonalDown)),t.Borders.push(n);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(s&&s.WTF&&!a)throw new Error("unrecognized "+l[0]+" in borders")}})}function EL(e,t,r,s){t.Fills=[];var n={},a=!1;(e[0].match(Pr)||[]).forEach(function(i){var l=qe(i);switch(hn(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":n={},t.Fills.push(n);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(n),n={};break;case"<patternFill":case"<patternFill>":l.patternType&&(n.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":n.bgColor||(n.bgColor={}),l.indexed&&(n.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(n.bgColor.theme=parseInt(l.theme,10)),l.tint&&(n.bgColor.tint=parseFloat(l.tint)),l.rgb&&(n.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":n.fgColor||(n.fgColor={}),l.theme&&(n.fgColor.theme=parseInt(l.theme,10)),l.tint&&(n.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(n.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(s&&s.WTF&&!a)throw new Error("unrecognized "+l[0]+" in fills")}})}function jL(e,t,r,s){t.Fonts=[];var n={},a=!1;(e[0].match(Pr)||[]).forEach(function(i){var l=qe(i);switch(hn(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(n),n={};break;case"<name":l.val&&(n.name=ft(l.val));break;case"<name/>":case"</name>":break;case"<b":n.bold=l.val?vt(l.val):1;break;case"<b/>":n.bold=1;break;case"<i":n.italic=l.val?vt(l.val):1;break;case"<i/>":n.italic=1;break;case"<u":switch(l.val){case"none":n.underline=0;break;case"single":n.underline=1;break;case"double":n.underline=2;break;case"singleAccounting":n.underline=33;break;case"doubleAccounting":n.underline=34;break}break;case"<u/>":n.underline=1;break;case"<strike":n.strike=l.val?vt(l.val):1;break;case"<strike/>":n.strike=1;break;case"<outline":n.outline=l.val?vt(l.val):1;break;case"<outline/>":n.outline=1;break;case"<shadow":n.shadow=l.val?vt(l.val):1;break;case"<shadow/>":n.shadow=1;break;case"<condense":n.condense=l.val?vt(l.val):1;break;case"<condense/>":n.condense=1;break;case"<extend":n.extend=l.val?vt(l.val):1;break;case"<extend/>":n.extend=1;break;case"<sz":l.val&&(n.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(n.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(n.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(n.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=Nx[parseInt(l.val,10)];break;case"<color":if(n.color||(n.color={}),l.auto&&(n.color.auto=vt(l.auto)),l.rgb)n.color.rgb=l.rgb.slice(-6);else if(l.indexed){n.color.index=parseInt(l.indexed,10);var c=Ga[n.color.index];n.color.index==81&&(c=Ga[1]),c||(c=Ga[1]),n.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else l.theme&&(n.color.theme=parseInt(l.theme,10),l.tint&&(n.color.tint=parseFloat(l.tint)),l.theme&&r.themeElements&&r.themeElements.clrScheme&&(n.color.rgb=Ld(r.themeElements.clrScheme[n.color.theme].rgb,n.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(s&&s.WTF&&!a)throw new Error("unrecognized "+l[0]+" in fonts")}})}function TL(e,t,r){t.NumberFmt=[];for(var s=Mt($e),n=0;n<s.length;++n)t.NumberFmt[s[n]]=$e[s[n]];var a=e[0].match(Pr);if(a)for(n=0;n<a.length;++n){var i=qe(a[n]);switch(hn(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=nt(ft(i.formatCode)),c=parseInt(i.numFmtId,10);if(t.NumberFmt[c]=l,c>0){if(c>392){for(c=392;c>60&&t.NumberFmt[c]!=null;--c);t.NumberFmt[c]=l}En(l,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}function CL(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var s=r[0];s<=r[1];++s)e[s]!=null&&(t[t.length]=ke("numFmt",null,{numFmtId:s,formatCode:ut(e[s])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=ke("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var ku=["numFmtId","fillId","fontId","borderId","xfId"],Nu=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function AL(e,t,r){t.CellXf=[];var s,n=!1;(e[0].match(Pr)||[]).forEach(function(a){var i=qe(a),l=0;switch(hn(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(s=i,delete s[0],l=0;l<ku.length;++l)s[ku[l]]&&(s[ku[l]]=parseInt(s[ku[l]],10));for(l=0;l<Nu.length;++l)s[Nu[l]]&&(s[Nu[l]]=vt(s[Nu[l]]));if(t.NumberFmt&&s.numFmtId>392){for(l=392;l>60;--l)if(t.NumberFmt[s.numFmtId]==t.NumberFmt[l]){s.numFmtId=l;break}}t.CellXf.push(s);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};i.vertical&&(c.vertical=i.vertical),i.horizontal&&(c.horizontal=i.horizontal),i.textRotation!=null&&(c.textRotation=i.textRotation),i.indent&&(c.indent=i.indent),i.wrapText&&(c.wrapText=vt(i.wrapText)),s.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":n=!0;break;case"</AlternateContent>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(r&&r.WTF&&!n)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}function FL(e){var t=[];return t[t.length]=ke("cellXfs",null),e.forEach(function(r){t[t.length]=ke("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=ke("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var PL=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,s=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,n=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,c,u){var d={};if(!l)return d;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=l.match(t))&&TL(f,d,u),(f=l.match(n))&&jL(f,d,c,u),(f=l.match(s))&&EL(f,d,c,u),(f=l.match(a))&&NL(f,d,c,u),(f=l.match(r))&&AL(f,d,u),d}}();function cE(e,t){var r=[Vt,ke("styleSheet",null,{xmlns:di[0],"xmlns:vt":er.vt})],s;return e.SSF&&(s=CL(e.SSF))!=null&&(r[r.length]=s),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(s=FL(t.cellXfs))&&(r[r.length]=s),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function RL(e,t){var r=e.read_shift(2),s=Cr(e);return[r,s]}function IL(e,t,r){r||(r=de(6+4*t.length)),r.write_shift(2,e),or(t,r);var s=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),s}function OL(e,t,r){var s={};s.sz=e.read_shift(2)/20;var n=xO(e);n.fItalic&&(s.italic=1),n.fCondense&&(s.condense=1),n.fExtend&&(s.extend=1),n.fShadow&&(s.shadow=1),n.fOutline&&(s.outline=1),n.fStrikeout&&(s.strike=1);var a=e.read_shift(2);switch(a===700&&(s.bold=1),e.read_shift(2)){case 1:s.vertAlign="superscript";break;case 2:s.vertAlign="subscript";break}var i=e.read_shift(1);i!=0&&(s.underline=i);var l=e.read_shift(1);l>0&&(s.family=l);var c=e.read_shift(1);switch(c>0&&(s.charset=c),e.l++,s.color=pO(e),e.read_shift(1)){case 1:s.scheme="major";break;case 2:s.scheme="minor";break}return s.name=Cr(e),s}function DL(e,t){t||(t=de(25+4*32)),t.write_shift(2,e.sz*20),gO(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Id(e.color,t);var s=0;return s=2,t.write_shift(1,s),or(e.name,t),t.length>t.l?t.slice(0,t.l):t}var LL=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Of,ML=Fr;function dw(e,t){t||(t=de(4*3+8*7+16*1)),Of||(Of=x0(LL));var r=Of[e.patternType];r==null&&(r=40),t.write_shift(4,r);var s=0;if(r!=40)for(Id({auto:1},t),Id({auto:1},t);s<12;++s)t.write_shift(4,0);else{for(;s<4;++s)t.write_shift(4,0);for(;s<12;++s)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function BL(e,t){var r=e.l+t,s=e.read_shift(2),n=e.read_shift(2);return e.l=r,{ixfe:s,numFmtId:n}}function uE(e,t,r){r||(r=de(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var s=0;return r.write_shift(1,s),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Yo(e,t){return t||(t=de(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var UL=Fr;function zL(e,t){return t||(t=de(51)),t.write_shift(1,0),Yo(null,t),Yo(null,t),Yo(null,t),Yo(null,t),Yo(null,t),t.length>t.l?t.slice(0,t.l):t}function $L(e,t){return t||(t=de(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),Rd(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function VL(e,t,r){var s=de(2052);return s.write_shift(4,e),Rd(t,s),Rd(r,s),s.length>s.l?s.slice(0,s.l):s}function WL(e,t,r){var s={};s.NumberFmt=[];for(var n in $e)s.NumberFmt[n]=$e[n];s.CellXf=[],s.Fonts=[];var a=[],i=!1;return Ln(e,function(c,u,d){switch(d){case 44:s.NumberFmt[c[0]]=c[1],En(c[1],c[0]);break;case 43:s.Fonts.push(c),c.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(c.color.rgb=Ld(t.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&s.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:a.push(d),i=!0;break;case 38:a.pop(),i=!1;break;default:if(u.T>0)a.push(d);else if(u.T<0)a.pop();else if(!i||r.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),s}function qL(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var n=s[0];n<=s[1];++n)t[n]!=null&&++r}),r!=0&&(ge(e,615,Js(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var n=s[0];n<=s[1];++n)t[n]!=null&&ge(e,44,IL(n,t[n]))}),ge(e,616))}}function HL(e){var t=1;ge(e,611,Js(t)),ge(e,43,DL({sz:12,color:{theme:1},name:"Calibri",family:2})),ge(e,612)}function GL(e){var t=2;ge(e,603,Js(t)),ge(e,45,dw({patternType:"none"})),ge(e,45,dw({patternType:"gray125"})),ge(e,604)}function KL(e){var t=1;ge(e,613,Js(t)),ge(e,46,zL()),ge(e,614)}function XL(e){var t=1;ge(e,626,Js(t)),ge(e,47,uE({numFmtId:0},65535)),ge(e,627)}function QL(e,t){ge(e,617,Js(t.length)),t.forEach(function(r){ge(e,47,uE(r,0))}),ge(e,618)}function YL(e){var t=1;ge(e,619,Js(t)),ge(e,48,$L({xfId:0,name:"Normal"})),ge(e,620)}function JL(e){var t=0;ge(e,505,Js(t)),ge(e,506)}function ZL(e){var t=0;ge(e,508,VL(t,"TableStyleMedium9","PivotStyleMedium4")),ge(e,509)}function eM(e,t){var r=Jr();return ge(r,278),qL(r,e.SSF),HL(r),GL(r),KL(r),XL(r),QL(r,t.cellXfs),YL(r),JL(r),ZL(r),ge(r,279),r.end()}var tM=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function rM(e,t,r){t.themeElements.clrScheme=[];var s={};(e[0].match(Pr)||[]).forEach(function(n){var a=qe(n);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":s.rgb=a.val;break;case"<a:sysClr":s.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(t.themeElements.clrScheme[tM.indexOf(a[0])]=s,s={}):s.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function sM(){}function nM(){}var aM=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,iM=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,oM=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function lM(e,t,r){t.themeElements={};var s;[["clrScheme",aM,rM],["fontScheme",iM,sM],["fmtScheme",oM,nM]].forEach(function(n){if(!(s=e.match(n[1])))throw new Error(n[0]+" not found in themeElements");n[2](s,t,r)})}var cM=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function dE(e,t){(!e||e.length===0)&&(e=Jx());var r,s={};if(!(r=e.match(cM)))throw new Error("themeElements not found in theme");return lM(r[0],s,t),s.raw=e,s}function Jx(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Vt];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function uM(e,t,r){var s=e.l+t,n=e.read_shift(4);if(n!==124226){if(!r.cellStyles){e.l=s;return}var a=e.slice(e.l);e.l=s;var i;try{i=sN(a,{type:"array"})}catch{return}var l=ls(i,"theme/theme/theme1.xml",!0);if(l)return dE(l,r)}}function dM(e){return e.read_shift(4)}function fM(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=hM(e,4);break;case 2:t.xclrValue=WN(e);break;case 3:t.xclrValue=dM(e);break;case 4:e.l+=4;break}return e.l+=8,t}function hM(e,t){return Fr(e,t)}function mM(e,t){return Fr(e,t)}function pM(e){var t=e.read_shift(2),r=e.read_shift(2)-4,s=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:s[1]=fM(e);break;case 6:s[1]=mM(e,r);break;case 14:case 15:s[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return s}function xM(e,t){var r=e.l+t;e.l+=2;var s=e.read_shift(2);e.l+=2;for(var n=e.read_shift(2),a=[];n-- >0;)a.push(pM(e,r-e.l));return{ixfe:s,ext:a}}function gM(e,t){t.forEach(function(r){switch(r[0]){}})}function vM(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Cr(e)}}function yM(e){var t=de(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),or(e.name,t),t.slice(0,t.l)}function wM(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function bM(e){var t=de(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function _M(e,t){var r=de(8+2*t.length);return r.write_shift(4,e),or(t,r),r.slice(0,r.l)}function SM(e){return e.l+=4,e.read_shift(4)!=0}function kM(e,t){var r=de(8);return r.write_shift(4,e),r.write_shift(4,1),r}function NM(e,t,r){var s={Types:[],Cell:[],Value:[]},n=r||{},a=[],i=!1,l=2;return Ln(e,function(c,u,d){switch(d){case 335:s.Types.push({name:c.name});break;case 51:c.forEach(function(f){l==1?s.Cell.push({type:s.Types[f[0]-1].name,index:f[1]}):l==0&&s.Value.push({type:s.Types[f[0]-1].name,index:f[1]})});break;case 337:l=c?1:0;break;case 338:l=2;break;case 35:a.push(d),i=!0;break;case 36:a.pop(),i=!1;break;default:if(!u.T){if(!i||n.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),s}function EM(){var e=Jr();return ge(e,332),ge(e,334,Js(1)),ge(e,335,yM({name:"XLDAPR",version:12e4,flags:3496657072})),ge(e,336),ge(e,339,_M(1,"XLDAPR")),ge(e,52),ge(e,35,Js(514)),ge(e,4096,Js(0)),ge(e,4097,ks(1)),ge(e,36),ge(e,53),ge(e,340),ge(e,337,kM(1)),ge(e,51,bM([[1,0]])),ge(e,338),ge(e,333),e.end()}function jM(e,t,r){var s={Types:[],Cell:[],Value:[]};if(!e)return s;var n=!1,a=2,i;return e.replace(Pr,function(l){var c=qe(l);switch(hn(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":s.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<s.Types.length;++u)s.Types[u].name==c.name&&(i=s.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?s.Cell.push({type:s.Types[c.t-1].name,index:+c.v}):a==0&&s.Value.push({type:s.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+c.i);break;default:if(!n&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return l}),s}function fE(){var e=[Vt];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function TM(e){var t=[];if(!e)return t;var r=1;return(e.match(Pr)||[]).forEach(function(s){var n=qe(s);switch(n[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete n[0],n.i?r=n.i:n.i=r,t.push(n);break}}),t}function CM(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Ve(r);var s=e.read_shift(1);return s&2&&(t.l="1"),s&8&&(t.a="1"),t}function AM(e,t,r){var s=[];return Ln(e,function(a,i,l){switch(l){case 63:s.push(a);break;default:if(!i.T)throw new Error("Unexpected record 0x"+l.toString(16))}}),s}function FM(e,t,r,s){if(!e)return e;var n=s||{},a=!1;Ln(e,function(l,c,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!c.T){if(!a||n.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},n)}function PM(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var Gi=1024;function hE(e,t){for(var r=[21600,21600],s=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),n=[ke("xml",null,{"xmlns:v":ss.v,"xmlns:o":ss.o,"xmlns:x":ss.x,"xmlns:mv":ss.mv}).replace(/\/>/,">"),ke("o:shapelayout",ke("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),ke("v:shapetype",[ke("v:stroke",null,{joinstyle:"miter"}),ke("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:s})];Gi<e*1e3;)Gi+=1e3;return t.forEach(function(a){var i=Ft(a[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var c=l.type=="gradient"?ke("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=ke("v:fill",c,l),d={on:"t",obscured:"t"};++Gi,n=n.concat(["<v:shape"+cc({id:"_x0000_s"+Gi,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(a[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,ke("v:shadow",null,d),ke("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",pr("x:Anchor",[i.c+1,0,i.r+1,0,i.c+3,20,i.r+5,20].join(",")),pr("x:AutoFill","False"),pr("x:Row",String(i.r)),pr("x:Column",String(i.c)),a[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),n.push("</xml>"),n.join("")}function fw(e,t,r,s){var n=Array.isArray(e),a;t.forEach(function(i){var l=Ft(i.ref);if(n?(e[l.r]||(e[l.r]=[]),a=e[l.r][l.c]):a=e[i.ref],!a){a={t:"z"},n?e[l.r][l.c]=a:e[i.ref]=a;var c=at(e["!ref"]||"BDWGO1000001:A1");c.s.r>l.r&&(c.s.r=l.r),c.e.r<l.r&&(c.e.r=l.r),c.s.c>l.c&&(c.s.c=l.c),c.e.c<l.c&&(c.e.c=l.c);var u=Ke(c);u!==e["!ref"]&&(e["!ref"]=u)}a.c||(a.c=[]);var d={a:i.author,t:i.t,r:i.r,T:r};i.h&&(d.h=i.h);for(var f=a.c.length-1;f>=0;--f){if(!r&&a.c[f].T)return;r&&!a.c[f].T&&a.c.splice(f,1)}if(r&&s){for(f=0;f<s.length;++f)if(d.a==s[f].id){d.a=s[f].name||d.a;break}}a.c.push(d)})}function RM(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],s=[],n=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);n&&n[1]&&n[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var l=i.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&r.push(l[1])}});var a=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var l=i.match(/<(?:\w+:)?comment[^>]*>/);if(l){var c=qe(l[0]),u={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},d=Ft(c.ref);if(!(t.sheetRows&&t.sheetRows<=d.r)){var f=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!f&&!!f[1]&&Xx(f[1])||{r:"",t:"",h:""};u.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),u.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(u.h=h.h),s.push(u)}}}}),s}function mE(e){var t=[Vt,ke("comments",null,{xmlns:di[0]})],r=[];return t.push("<authors>"),e.forEach(function(s){s[1].forEach(function(n){var a=ut(n.a);r.indexOf(a)==-1&&(r.push(a),t.push("<author>"+a+"</author>")),n.T&&n.ID&&r.indexOf("tc="+n.ID)==-1&&(r.push("tc="+n.ID),t.push("<author>tc="+n.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(s){var n=0,a=[];if(s[1][0]&&s[1][0].T&&s[1][0].ID?n=r.indexOf("tc="+s[1][0].ID):s[1].forEach(function(c){c.a&&(n=r.indexOf(ut(c.a))),a.push(c.t||"")}),t.push('<comment ref="'+s[0]+'" authorId="'+n+'"><text>'),a.length<=1)t.push(pr("t",ut(a[0]||"")));else{for(var i=`Comment:
    `+a[0]+`
`,l=1;l<a.length;++l)i+=`Reply:
    `+a[l]+`
`;t.push(pr("t",ut(i)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function IM(e,t){var r=[],s=!1,n={},a=0;return e.replace(Pr,function(l,c){var u=qe(l);switch(hn(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":n={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":n.t!=null&&r.push(n);break;case"<text>":case"<text":a=c+l.length;break;case"</text>":n.t=e.slice(a,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":s=!0;break;case"</mentions>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(!s&&t.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return l}),r}function OM(e,t,r){var s=[Vt,ke("ThreadedComments",null,{xmlns:er.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(n){var a="";(n[1]||[]).forEach(function(i,l){if(!i.T){delete i.ID;return}i.a&&t.indexOf(i.a)==-1&&t.push(i.a);var c={ref:n[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};l==0?a=c.id:c.parentId=a,i.ID=c.id,i.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(i.a)).slice(-12)+"}"),s.push(ke("threadedComment",pr("text",i.t||""),c))})}),s.push("</ThreadedComments>"),s.join("")}function DM(e,t){var r=[],s=!1;return e.replace(Pr,function(a){var i=qe(a);switch(hn(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(!s&&t.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return a}),r}function LM(e){var t=[Vt,ke("personList",null,{xmlns:er.TCMNT,"xmlns:x":di[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,s){t.push(ke("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+s).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function MM(e){var t={};t.iauthor=e.read_shift(4);var r=pi(e);return t.rfx=r.s,t.ref=Ve(r.s),e.l+=16,t}function BM(e,t){return t==null&&(t=de(36)),t.write_shift(4,e[1].iauthor),Lo(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var UM=Cr;function zM(e){return or(e.slice(0,54))}function $M(e,t){var r=[],s=[],n={},a=!1;return Ln(e,function(l,c,u){switch(u){case 632:s.push(l);break;case 635:n=l;break;case 637:n.t=l.t,n.h=l.h,n.r=l.r;break;case 636:if(n.author=s[n.iauthor],delete n.iauthor,t.sheetRows&&n.rfx&&t.sheetRows<=n.rfx.r)break;n.t||(n.t=""),delete n.rfx,r.push(n);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!a||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}function VM(e){var t=Jr(),r=[];return ge(t,628),ge(t,630),e.forEach(function(s){s[1].forEach(function(n){r.indexOf(n.a)>-1||(r.push(n.a.slice(0,54)),ge(t,632,zM(n.a)))})}),ge(t,631),ge(t,633),e.forEach(function(s){s[1].forEach(function(n){n.iauthor=r.indexOf(n.a);var a={s:Ft(s[0]),e:Ft(s[0])};ge(t,635,BM([a,n])),n.t&&n.t.length>0&&ge(t,637,dO(n)),ge(t,636),delete n.iauthor})}),ge(t,634),ge(t,629),t.end()}var WM="application/vnd.ms-office.vbaProject";function qM(e){var t=Be.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,s){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var n=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Be.utils.cfb_add(t,n,e.FileIndex[s].content)}}),Be.write(t)}function HM(e,t){t.FullPaths.forEach(function(r,s){if(s!=0){var n=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");n.slice(-1)!=="/"&&Be.utils.cfb_add(e,n,t.FileIndex[s].content)}})}var pE=["xlsb","xlsm","xlam","biff8","xla"];function GM(){return{"!type":"dialog"}}function KM(){return{"!type":"dialog"}}function XM(){return{"!type":"macro"}}function QM(){return{"!type":"macro"}}var ao=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(s,n,a,i){var l=!1,c=!1;a.length==0?c=!0:a.charAt(0)=="["&&(c=!0,a=a.slice(1,-1)),i.length==0?l=!0:i.charAt(0)=="["&&(l=!0,i=i.slice(1,-1));var u=a.length>0?parseInt(a,10)|0:0,d=i.length>0?parseInt(i,10)|0:0;return l?d+=t.c:--d,c?u+=t.r:--u,n+(l?"":"$")+At(d)+(c?"":"$")+$t(u)}return function(n,a){return t=a,n.replace(e,r)}}(),Zx=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,eg=function(){return function(t,r){return t.replace(Zx,function(s,n,a,i,l,c){var u=Ux(i)-(a?0:r.c),d=Bx(c)-(l?0:r.r),f=d==0?"":l?d+1:"["+d+"]",h=u==0?"":a?u+1:"["+u+"]";return n+"R"+f+"C"+h})}}();function xE(e,t){return e.replace(Zx,function(r,s,n,a,i,l){return s+(n=="$"?n+a:At(Ux(a)+t.c))+(i=="$"?i+l:$t(Bx(l)+t.r))})}function YM(e,t,r){var s=Zr(t),n=s.s,a=Ft(r),i={r:a.r-n.r,c:a.c-n.c};return xE(e,i)}function JM(e){return e.length!=1}function hw(e){return e.replace(/_xlfn\./g,"")}function qt(e){e.l+=1}function ha(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function gE(e,t,r){var s=2;if(r){if(r.biff>=2&&r.biff<=5)return vE(e);r.biff==12&&(s=4)}var n=e.read_shift(s),a=e.read_shift(s),i=ha(e),l=ha(e);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:l[0],cRel:l[1],rRel:l[2]}}}function vE(e){var t=ha(e),r=ha(e),s=e.read_shift(1),n=e.read_shift(1);return{s:{r:t[0],c:s,cRel:t[1],rRel:t[2]},e:{r:r[0],c:n,cRel:r[1],rRel:r[2]}}}function ZM(e,t,r){if(r.biff<8)return vE(e);var s=e.read_shift(r.biff==12?4:2),n=e.read_shift(r.biff==12?4:2),a=ha(e),i=ha(e);return{s:{r:s,c:a[0],cRel:a[1],rRel:a[2]},e:{r:n,c:i[0],cRel:i[1],rRel:i[2]}}}function yE(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return e9(e);var s=e.read_shift(r&&r.biff==12?4:2),n=ha(e);return{r:s,c:n[0],cRel:n[1],rRel:n[2]}}function e9(e){var t=ha(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function t9(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function r9(e,t,r){var s=r&&r.biff?r.biff:8;if(s>=2&&s<=5)return s9(e);var n=e.read_shift(s>=12?4:2),a=e.read_shift(2),i=(a&16384)>>14,l=(a&32768)>>15;if(a&=16383,l==1)for(;n>524287;)n-=1048576;if(i==1)for(;a>8191;)a=a-16384;return{r:n,c:a,cRel:i,rRel:l}}function s9(e){var t=e.read_shift(2),r=e.read_shift(1),s=(t&32768)>>15,n=(t&16384)>>14;return t&=16383,s==1&&t>=8192&&(t=t-16384),n==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:n,rRel:s}}function n9(e,t,r){var s=(e[e.l++]&96)>>5,n=gE(e,r.biff>=2&&r.biff<=5?6:8,r);return[s,n]}function a9(e,t,r){var s=(e[e.l++]&96)>>5,n=e.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}var i=gE(e,a,r);return[s,n,i]}function i9(e,t,r){var s=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[s]}function o9(e,t,r){var s=(e[e.l++]&96)>>5,n=e.read_shift(2),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}return e.l+=a,[s,n]}function l9(e,t,r){var s=(e[e.l++]&96)>>5,n=ZM(e,t-1,r);return[s,n]}function c9(e,t,r){var s=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[s]}function mw(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function u9(e,t,r){e.l+=2;for(var s=e.read_shift(r&&r.biff==2?1:2),n=[],a=0;a<=s;++a)n.push(e.read_shift(r&&r.biff==2?1:2));return n}function d9(e,t,r){var s=e[e.l+1]&255?1:0;return e.l+=2,[s,e.read_shift(r&&r.biff==2?1:2)]}function f9(e,t,r){var s=e[e.l+1]&255?1:0;return e.l+=2,[s,e.read_shift(r&&r.biff==2?1:2)]}function h9(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function m9(e,t,r){var s=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[s]}function wE(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function p9(e){return e.read_shift(2),wE(e)}function x9(e){return e.read_shift(2),wE(e)}function g9(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var n=yE(e,0,r);return[s,n]}function v9(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var n=r9(e,0,r);return[s,n]}function y9(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var a=yE(e,0,r);return[s,n,a]}function w9(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(r&&r.biff<=3?1:2);return[S7[n],SE[n],s]}function b9(e,t,r){var s=e[e.l++],n=e.read_shift(1),a=r&&r.biff<=3?[s==88?-1:0,e.read_shift(1)]:_9(e);return[n,(a[0]===0?SE:_7)[a[1]]]}function _9(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function S9(e,t,r){e.l+=r&&r.biff==2?3:4}function k9(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var s=e.read_shift(2),n=e.read_shift(r&&r.biff==2?1:2);return[s,n]}function N9(e){return e.l++,Mn[e.read_shift(1)]}function E9(e){return e.l++,e.read_shift(2)}function j9(e){return e.l++,e.read_shift(1)!==0}function T9(e){return e.l++,Er(e)}function C9(e,t,r){return e.l++,Pc(e,t-1,r)}function A9(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Bt(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Mn[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Er(e);break;case 2:r[1]=xi(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function F9(e,t,r){for(var s=e.read_shift(r.biff==12?4:2),n=[],a=0;a!=s;++a)n.push((r.biff==12?pi:y0)(e));return n}function P9(e,t,r){var s=0,n=0;r.biff==12?(s=e.read_shift(4),n=e.read_shift(4)):(n=1+e.read_shift(1),s=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--s,--n==0&&(n=256));for(var a=0,i=[];a!=s&&(i[a]=[]);++a)for(var l=0;l!=n;++l)i[a][l]=A9(e,r.biff);return i}function R9(e,t,r){var s=e.read_shift(1)>>>5&3,n=!r||r.biff>=8?4:2,a=e.read_shift(n);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[s,0,a]}function I9(e,t,r){if(r.biff==5)return O9(e);var s=e.read_shift(1)>>>5&3,n=e.read_shift(2),a=e.read_shift(4);return[s,n,a]}function O9(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var s=e.read_shift(2);return e.l+=12,[t,r,s]}function D9(e,t,r){var s=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var n=e.read_shift(r&&r.biff==2?1:2);return[s,n]}function L9(e,t,r){var s=e.read_shift(1)>>>5&3,n=e.read_shift(r&&r.biff==2?1:2);return[s,n]}function M9(e,t,r){var s=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[s]}function B9(e,t,r){var s=(e[e.l++]&96)>>5,n=e.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return e.l+=a,[s,n]}var U9=Fr,z9=Fr,$9=Fr;function Ic(e,t,r){return e.l+=2,[t9(e)]}function tg(e){return e.l+=6,[]}var V9=Ic,W9=tg,q9=tg,H9=Ic;function bE(e){return e.l+=2,[Gt(e),e.read_shift(2)&1]}var G9=Ic,K9=bE,X9=tg,Q9=Ic,Y9=Ic,J9=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function Z9(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(4),n=e.read_shift(2),a=e.read_shift(2),i=J9[r>>2&31];return{ixti:t,coltype:r&3,rt:i,idx:s,c:n,C:a}}function e7(e){return e.l+=2,[e.read_shift(4)]}function t7(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function r7(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function s7(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function n7(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function a7(e){return e.l+=4,[0,0]}var pw={1:{n:"PtgExp",f:k9},2:{n:"PtgTbl",f:$9},3:{n:"PtgAdd",f:qt},4:{n:"PtgSub",f:qt},5:{n:"PtgMul",f:qt},6:{n:"PtgDiv",f:qt},7:{n:"PtgPower",f:qt},8:{n:"PtgConcat",f:qt},9:{n:"PtgLt",f:qt},10:{n:"PtgLe",f:qt},11:{n:"PtgEq",f:qt},12:{n:"PtgGe",f:qt},13:{n:"PtgGt",f:qt},14:{n:"PtgNe",f:qt},15:{n:"PtgIsect",f:qt},16:{n:"PtgUnion",f:qt},17:{n:"PtgRange",f:qt},18:{n:"PtgUplus",f:qt},19:{n:"PtgUminus",f:qt},20:{n:"PtgPercent",f:qt},21:{n:"PtgParen",f:qt},22:{n:"PtgMissArg",f:qt},23:{n:"PtgStr",f:C9},26:{n:"PtgSheet",f:t7},27:{n:"PtgEndSheet",f:r7},28:{n:"PtgErr",f:N9},29:{n:"PtgBool",f:j9},30:{n:"PtgInt",f:E9},31:{n:"PtgNum",f:T9},32:{n:"PtgArray",f:c9},33:{n:"PtgFunc",f:w9},34:{n:"PtgFuncVar",f:b9},35:{n:"PtgName",f:R9},36:{n:"PtgRef",f:g9},37:{n:"PtgArea",f:n9},38:{n:"PtgMemArea",f:D9},39:{n:"PtgMemErr",f:U9},40:{n:"PtgMemNoMem",f:z9},41:{n:"PtgMemFunc",f:L9},42:{n:"PtgRefErr",f:M9},43:{n:"PtgAreaErr",f:i9},44:{n:"PtgRefN",f:v9},45:{n:"PtgAreaN",f:l9},46:{n:"PtgMemAreaN",f:s7},47:{n:"PtgMemNoMemN",f:n7},57:{n:"PtgNameX",f:I9},58:{n:"PtgRef3d",f:y9},59:{n:"PtgArea3d",f:a9},60:{n:"PtgRefErr3d",f:B9},61:{n:"PtgAreaErr3d",f:o9},255:{}},i7={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},o7={1:{n:"PtgElfLel",f:bE},2:{n:"PtgElfRw",f:Q9},3:{n:"PtgElfCol",f:V9},6:{n:"PtgElfRwV",f:Y9},7:{n:"PtgElfColV",f:H9},10:{n:"PtgElfRadical",f:G9},11:{n:"PtgElfRadicalS",f:X9},13:{n:"PtgElfColS",f:W9},15:{n:"PtgElfColSV",f:q9},16:{n:"PtgElfRadicalLel",f:K9},25:{n:"PtgList",f:Z9},29:{n:"PtgSxName",f:e7},255:{}},l7={0:{n:"PtgAttrNoop",f:a7},1:{n:"PtgAttrSemi",f:m9},2:{n:"PtgAttrIf",f:f9},4:{n:"PtgAttrChoose",f:u9},8:{n:"PtgAttrGoto",f:d9},16:{n:"PtgAttrSum",f:S9},32:{n:"PtgAttrBaxcel",f:mw},33:{n:"PtgAttrBaxcel",f:mw},64:{n:"PtgAttrSpace",f:p9},65:{n:"PtgAttrSpaceSemi",f:x9},128:{n:"PtgAttrIfError",f:h9},255:{}};function Oc(e,t,r,s){if(s.biff<8)return Fr(e,t);for(var n=e.l+t,a=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=P9(e,0,s),a.push(r[i][1]);break;case"PtgMemArea":r[i][2]=F9(e,r[i][1],s),a.push(r[i][2]);break;case"PtgExp":s&&s.biff==12&&(r[i][1][1]=e.read_shift(4),a.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return t=n-e.l,t!==0&&a.push(Fr(e,t)),a}function Dc(e,t,r){for(var s=e.l+t,n,a,i=[];s!=e.l;)t=s-e.l,a=e[e.l],n=pw[a]||pw[i7[a]],(a===24||a===25)&&(n=(a===24?o7:l7)[e[e.l+1]]),!n||!n.f?Fr(e,t):i.push([n.n,n.f(e,t,r)]);return i}function c7(e){for(var t=[],r=0;r<e.length;++r){for(var s=e[r],n=[],a=0;a<s.length;++a){var i=s[a];if(i)switch(i[0]){case 2:n.push('"'+i[1].replace(/"/g,'""')+'"');break;default:n.push(i[1])}else n.push("")}t.push(n.join(","))}return t.join(";")}var u7={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function d7(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function _E(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var s=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!s)return"SH33TJSERR1";var n="";if(r.biff>8)switch(e[s[0]][0]){case 357:return n=s[1]==-1?"#REF":e.SheetNames[s[1]],s[1]==s[2]?n:n+":"+e.SheetNames[s[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[s[0]][0];case 355:default:return"SH33TJSSRC"+e[s[0]][0]}switch(e[s[0]][0][0]){case 1025:return n=s[1]==-1?"#REF":e.SheetNames[s[1]]||"SH33TJSERR3",s[1]==s[2]?n:n+":"+e.SheetNames[s[2]];case 14849:return e[s[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return e[s[0]][0][3]?(n=s[1]==-1?"#REF":e[s[0]][0][3][s[1]]||"SH33TJSERR4",s[1]==s[2]?n:n+":"+e[s[0]][0][3][s[2]]):"SH33TJSERR2"}}function xw(e,t,r){var s=_E(e,t,r);return s=="#REF"?s:d7(s,r)}function Sr(e,t,r,s,n){var a=n&&n.biff||8,i={s:{c:0,r:0}},l=[],c,u,d,f=0,h=0,m,x="";if(!e[0]||!e[0][0])return"";for(var p=-1,g="",w=0,v=e[0].length;w<v;++w){var y=e[0][w];switch(y[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=l.pop(),u=l.pop(),p>=0){switch(e[0][p][1][0]){case 0:g=Dt(" ",e[0][p][1][1]);break;case 1:g=Dt("\r",e[0][p][1][1]);break;default:if(g="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}u=u+g,p=-1}l.push(u+u7[y[0]]+c);break;case"PtgIsect":c=l.pop(),u=l.pop(),l.push(u+" "+c);break;case"PtgUnion":c=l.pop(),u=l.pop(),l.push(u+","+c);break;case"PtgRange":c=l.pop(),u=l.pop(),l.push(u+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=kl(y[1][1],i,n),l.push(Nl(d,a));break;case"PtgRefN":d=r?kl(y[1][1],r,n):y[1][1],l.push(Nl(d,a));break;case"PtgRef3d":f=y[1][1],d=kl(y[1][2],i,n),x=xw(s,f,n),l.push(x+"!"+Nl(d,a));break;case"PtgFunc":case"PtgFuncVar":var b=y[1][0],S=y[1][1];b||(b=0),b&=127;var _=b==0?[]:l.slice(-b);l.length-=b,S==="User"&&(S=_.shift()),l.push(S+"("+_.join(",")+")");break;case"PtgBool":l.push(y[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(y[1]);break;case"PtgNum":l.push(String(y[1]));break;case"PtgStr":l.push('"'+y[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(y[1]);break;case"PtgAreaN":m=q1(y[1][1],r?{s:r}:i,n),l.push(Ff(m,n));break;case"PtgArea":m=q1(y[1][1],i,n),l.push(Ff(m,n));break;case"PtgArea3d":f=y[1][1],m=y[1][2],x=xw(s,f,n),l.push(x+"!"+Ff(m,n));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=y[1][2];var k=(s.names||[])[h-1]||(s[0]||[])[h],E=k?k.Name:"SH33TJSNAME"+String(h);E&&E.slice(0,6)=="_xlfn."&&!n.xlfn&&(E=E.slice(6)),l.push(E);break;case"PtgNameX":var T=y[1][1];h=y[1][2];var M;if(n.biff<=5)T<0&&(T=-T),s[T]&&(M=s[T][h]);else{var q="";if(((s[T]||[])[0]||[])[0]==14849||(((s[T]||[])[0]||[])[0]==1025?s[T][h]&&s[T][h].itab>0&&(q=s.SheetNames[s[T][h].itab-1]+"!"):q=s.SheetNames[h-1]+"!"),s[T]&&s[T][h])q+=s[T][h].Name;else if(s[0]&&s[0][h])q+=s[0][h].Name;else{var D=(_E(s,T,n)||"").split(";;");D[h-1]?q=D[h-1]:q+="SH33TJSERRX"}l.push(q);break}M||(M={Name:"SH33TJSERRY"}),l.push(M.Name);break;case"PtgParen":var W="(",ee=")";if(p>=0){switch(g="",e[0][p][1][0]){case 2:W=Dt(" ",e[0][p][1][1])+W;break;case 3:W=Dt("\r",e[0][p][1][1])+W;break;case 4:ee=Dt(" ",e[0][p][1][1])+ee;break;case 5:ee=Dt("\r",e[0][p][1][1])+ee;break;default:if(n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}p=-1}l.push(W+l.pop()+ee);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":d={c:y[1][1],r:y[1][0]};var Y={c:r.c,r:r.r};if(s.sharedf[Ve(d)]){var G=s.sharedf[Ve(d)];l.push(Sr(G,i,Y,s,n))}else{var ce=!1;for(c=0;c!=s.arrayf.length;++c)if(u=s.arrayf[c],!(d.c<u[0].s.c||d.c>u[0].e.c)&&!(d.r<u[0].s.r||d.r>u[0].e.r)){l.push(Sr(u[1],i,Y,s,n)),ce=!0;break}ce||l.push(y[1])}break;case"PtgArray":l.push("{"+c7(y[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=w;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+y[1].idx+"[#"+y[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(y));default:throw new Error("Unrecognized Formula Token: "+String(y))}var Q=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(n.biff!=3&&p>=0&&Q.indexOf(e[0][w][0])==-1){y=e[0][p];var B=!0;switch(y[1][0]){case 4:B=!1;case 0:g=Dt(" ",y[1][1]);break;case 5:B=!1;case 1:g=Dt("\r",y[1][1]);break;default:if(g="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+y[1][0])}l.push((B?g:"")+l.pop()+(B?"":g)),p=-1}}if(l.length>1&&n.WTF)throw new Error("bad formula stack");return l[0]}function f7(e,t,r){var s=e.l+t,n=r.biff==2?1:2,a,i=e.read_shift(n);if(i==65535)return[[],Fr(e,t-2)];var l=Dc(e,i,r);return t!==i+n&&(a=Oc(e,t-i-n,l,r)),e.l=s,[l,a]}function h7(e,t,r){var s=e.l+t,n=r.biff==2?1:2,a,i=e.read_shift(n);if(i==65535)return[[],Fr(e,t-2)];var l=Dc(e,i,r);return t!==i+n&&(a=Oc(e,t-i-n,l,r)),e.l=s,[l,a]}function m7(e,t,r,s){var n=e.l+t,a=Dc(e,s,r),i;return n!==e.l&&(i=Oc(e,n-e.l,a,r)),[a,i]}function p7(e,t,r){var s=e.l+t,n,a=e.read_shift(2),i=Dc(e,a,r);return a==65535?[[],Fr(e,t-2)]:(t!==a+2&&(n=Oc(e,s-a-2,i,r)),[i,n])}function x7(e){var t;if(Sn(e,e.l+6)!==65535)return[Er(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function g7(e){if(e==null){var t=de(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return ai(e);return ai(0)}function Df(e,t,r){var s=e.l+t,n=mn(e);r.biff==2&&++e.l;var a=x7(e),i=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var l=h7(e,s-e.l,r);return{cell:n,val:a[0],formula:l,shared:i>>3&1,tt:a[1]}}function v7(e,t,r,s,n){var a=oi(t,r,n),i=g7(e.v),l=de(6),c=33;l.write_shift(2,c),l.write_shift(4,0);for(var u=de(e.bf.length),d=0;d<e.bf.length;++d)u[d]=e.bf[d];var f=ir([a,i,l,u]);return f}function w0(e,t,r){var s=e.read_shift(4),n=Dc(e,s,r),a=e.read_shift(4),i=a>0?Oc(e,a,n,r):null;return[n,i]}var y7=w0,b0=w0,w7=w0,b7=w0,_7={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},SE={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},S7={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function gw(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function k7(e){var t="of:="+e.replace(Zx,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Lf(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function N7(e){return e.replace(/\./,"!")}var jl={},io={},Tl=typeof Map<"u";function rg(e,t,r){var s=0,n=e.length;if(r){if(Tl?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var a=Tl?r.get(t):r[t];s<a.length;++s)if(e[a[s]].t===t)return e.Count++,a[s]}}else for(;s<n;++s)if(e[s].t===t)return e.Count++,s;return e[n]={t},e.Count++,e.Unique++,r&&(Tl?(r.has(t)||r.set(t,[]),r.get(t).push(n)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(n))),n}function _0(e,t){var r={min:e+1,max:e+1},s=-1;return t.MDW&&(Nr=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?s=mc(t.wpx):t.wch!=null&&(s=t.wch),s>-1?(r.width=Md(s),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function Qa(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Sa(e,t,r){var s=r.revssf[t.z!=null?t.z:"General"],n=60,a=e.length;if(s==null&&r.ssf){for(;n<392;++n)if(r.ssf[n]==null){En(t.z,n),r.ssf[n]=t.z,r.revssf[t.z]=s=n;break}}for(n=0;n!=a;++n)if(e[n].numFmtId===s)return n;return e[a]={numFmtId:s,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},a}function kE(e,t,r,s,n,a){try{s.cellNF&&(e.z=$e[t])}catch(l){if(s.WTF)throw l}if(!(e.t==="z"&&!s.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=wt(e.v)),(!s||s.cellText!==!1)&&e.t!=="z")try{if($e[t]==null&&En(_I[t]||"General",t),e.t==="e")e.w=e.w||Mn[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=oc(e.v);else if(e.t==="d"){var i=rr(e.v);(i|0)===i?e.w=i.toString(10):e.w=oc(i)}else{if(e.v===void 0)return"";e.w=si(e.v,io)}else e.t==="d"?e.w=Os(t,rr(e.v),io):e.w=Os(t,e.v,io)}catch(l){if(s.WTF)throw l}if(s.cellStyles&&r!=null)try{e.s=a.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Ld(n.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),s.WTF&&(e.s.fgColor.raw_rgb=n.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Ld(n.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),s.WTF&&(e.s.bgColor.raw_rgb=n.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(l){if(s.WTF&&a.Fills)throw l}}}function E7(e,t,r){if(e&&e["!ref"]){var s=at(e["!ref"]);if(s.e.c<s.s.c||s.e.r<s.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function j7(e,t){var r=at(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Ke(r))}var T7=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,C7=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,A7=/<(?:\w:)?hyperlink [^>]*>/mg,F7=/"(\w*:\w*)"/,P7=/<(?:\w:)?col\b[^>]*[\/]?>/g,R7=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,I7=/<(?:\w:)?pageMargins[^>]*\/>/g,NE=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,O7=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,D7=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function L7(e,t,r,s,n,a,i){if(!e)return e;s||(s={"!id":{}});var l=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",d="",f=e.match(C7);f?(u=e.slice(0,f.index),d=e.slice(f.index+f[0].length)):u=d=e;var h=u.match(NE);h?sg(h[0],l,n,r):(h=u.match(O7))&&B7(h[0],h[1]||"",l,n,r);var m=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(m>0){var x=u.slice(m,m+50).match(F7);x&&j7(l,x[1])}var p=u.match(D7);p&&p[1]&&J7(p[1],n);var g=[];if(t.cellStyles){var w=u.match(P7);w&&G7(g,w)}f&&tB(f[1],l,t,c,a,i);var v=d.match(R7);v&&(l["!autofilter"]=X7(v[0]));var y=[],b=d.match(T7);if(b)for(m=0;m!=b.length;++m)y[m]=at(b[m].slice(b[m].indexOf('"')+1));var S=d.match(A7);S&&W7(l,S,s);var _=d.match(I7);if(_&&(l["!margins"]=q7(qe(_[0]))),!l["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(l["!ref"]=Ke(c)),t.sheetRows>0&&l["!ref"]){var k=at(l["!ref"]);t.sheetRows<=+k.e.r&&(k.e.r=t.sheetRows-1,k.e.r>c.e.r&&(k.e.r=c.e.r),k.e.r<k.s.r&&(k.s.r=k.e.r),k.e.c>c.e.c&&(k.e.c=c.e.c),k.e.c<k.s.c&&(k.s.c=k.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Ke(k))}return g.length>0&&(l["!cols"]=g),y.length>0&&(l["!merges"]=y),l}function M7(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Ke(e[r])+'"/>';return t+"</mergeCells>"}function sg(e,t,r,s){var n=qe(e);r.Sheets[s]||(r.Sheets[s]={}),n.codeName&&(r.Sheets[s].CodeName=nt(ft(n.codeName)))}function B7(e,t,r,s,n){sg(e.slice(0,e.indexOf(">")),r,s,n)}function U7(e,t,r,s,n){var a=!1,i={},l=null;if(s.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}a=!0,i.codeName=ln(ut(c))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),l=(l||"")+ke("outlinePr",null,u)}!a&&!l||(n[n.length]=ke("sheetPr",l,i))}var z7=["objects","scenarios","selectLockedCells","selectUnlockedCells"],$7=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function V7(e){var t={sheet:1};return z7.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),$7.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=Qx(e.password).toString(16).toUpperCase()),ke("sheetProtection",null,t)}function W7(e,t,r){for(var s=Array.isArray(e),n=0;n!=t.length;++n){var a=qe(ft(t[n]),!0);if(!a.ref)return;var i=((r||{})["!id"]||[])[a.id];i?(a.Target=i.Target,a.location&&(a.Target+="#"+nt(a.location))):(a.Target="#"+nt(a.location),i={Target:a.Target,TargetMode:"Internal"}),a.Rel=i,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var l=at(a.ref),c=l.s.r;c<=l.e.r;++c)for(var u=l.s.c;u<=l.e.c;++u){var d=Ve({c:u,r:c});s?(e[c]||(e[c]=[]),e[c][u]||(e[c][u]={t:"z",v:void 0}),e[c][u].l=a):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=a)}}}function q7(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function H7(e){return Qa(e),ke("pageMargins",null,e)}function G7(e,t){for(var r=!1,s=0;s!=t.length;++s){var n=qe(t[s],!0);n.hidden&&(n.hidden=vt(n.hidden));var a=parseInt(n.min,10)-1,i=parseInt(n.max,10)-1;for(n.outlineLevel&&(n.level=+n.outlineLevel||0),delete n.min,delete n.max,n.width=+n.width,!r&&n.width&&(r=!0,Yx(n.width)),fa(n);a<=i;)e[a++]=bt(n)}}function K7(e,t){for(var r=["<cols>"],s,n=0;n!=t.length;++n)(s=t[n])&&(r[r.length]=ke("col",null,_0(n,s)));return r[r.length]="</cols>",r.join("")}function X7(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function Q7(e,t,r,s){var n=typeof e.ref=="string"?e.ref:Ke(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,i=Zr(n);i.s.r==i.e.r&&(i.e.r=Zr(t["!ref"]).e.r,n=Ke(i));for(var l=0;l<a.length;++l){var c=a[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==s){c.Ref="'"+r.SheetNames[s]+"'!"+n;break}}return l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:s,Ref:"'"+r.SheetNames[s]+"'!"+n}),ke("autoFilter",null,{ref:n})}var Y7=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function J7(e,t){t.Views||(t.Views=[{}]),(e.match(Y7)||[]).forEach(function(r,s){var n=qe(r);t.Views[s]||(t.Views[s]={}),+n.zoomScale&&(t.Views[s].zoom=+n.zoomScale),vt(n.rightToLeft)&&(t.Views[s].RTL=!0)})}function Z7(e,t,r,s){var n={workbookViewId:"0"};return(((s||{}).Workbook||{}).Views||[])[0]&&(n.rightToLeft=s.Workbook.Views[0].RTL?"1":"0"),ke("sheetViews",ke("sheetView",null,n),{})}function eB(e,t,r,s){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var n="",a=e.t,i=e.v;if(e.t!=="z")switch(e.t){case"b":n=e.v?"1":"0";break;case"n":n=""+e.v;break;case"e":n=Mn[e.v];break;case"d":s&&s.cellDates?n=wt(e.v,-1).toISOString():(e=bt(e),e.t="n",n=""+(e.v=rr(wt(e.v)))),typeof e.z>"u"&&(e.z=$e[14]);break;default:n=e.v;break}var l=pr("v",ut(n)),c={r:t},u=Sa(s.cellXfs,e,s);switch(u!==0&&(c.s=u),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(s&&s.bookSST){l=pr("v",""+rg(s.Strings,e.v,s.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=a&&(e.t=a,e.v=i),typeof e.f=="string"&&e.f){var d=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;l=ke("f",ut(e.f),d)+(e.v!=null?l:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),ke("c",l,c)}var tB=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,s=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,n=/ref=["']([^"']*)["']/,a=lc("v"),i=lc("f");return function(c,u,d,f,h,m){for(var x=0,p="",g=[],w=[],v=0,y=0,b=0,S="",_,k,E=0,T=0,M,q,D=0,W=0,ee=Array.isArray(m.CellXf),Y,G=[],ce=[],Q=Array.isArray(u),B=[],me={},fe=!1,A=!!d.sheetStubs,V=c.split(t),L=0,U=V.length;L!=U;++L){p=V[L].trim();var ne=p.length;if(ne!==0){var xe=0;e:for(x=0;x<ne;++x)switch(p[x]){case">":if(p[x-1]!="/"){++x;break e}if(d&&d.cellStyles){if(k=qe(p.slice(xe,x),!0),E=k.r!=null?parseInt(k.r,10):E+1,T=-1,d.sheetRows&&d.sheetRows<E)continue;me={},fe=!1,k.ht&&(fe=!0,me.hpt=parseFloat(k.ht),me.hpx=_o(me.hpt)),k.hidden=="1"&&(fe=!0,me.hidden=!0),k.outlineLevel!=null&&(fe=!0,me.level=+k.outlineLevel),fe&&(B[E-1]=me)}break;case"<":xe=x;break}if(xe>=x)break;if(k=qe(p.slice(xe,x),!0),E=k.r!=null?parseInt(k.r,10):E+1,T=-1,!(d.sheetRows&&d.sheetRows<E)){f.s.r>E-1&&(f.s.r=E-1),f.e.r<E-1&&(f.e.r=E-1),d&&d.cellStyles&&(me={},fe=!1,k.ht&&(fe=!0,me.hpt=parseFloat(k.ht),me.hpx=_o(me.hpt)),k.hidden=="1"&&(fe=!0,me.hidden=!0),k.outlineLevel!=null&&(fe=!0,me.level=+k.outlineLevel),fe&&(B[E-1]=me)),g=p.slice(x).split(e);for(var pe=0;pe!=g.length&&g[pe].trim().charAt(0)=="<";++pe);for(g=g.slice(pe),x=0;x!=g.length;++x)if(p=g[x].trim(),p.length!==0){if(w=p.match(r),v=x,y=0,b=0,p="<c "+(p.slice(0,1)=="<"?">":"")+p,w!=null&&w.length===2){for(v=0,S=w[1],y=0;y!=S.length&&!((b=S.charCodeAt(y)-64)<1||b>26);++y)v=26*v+b;--v,T=v}else++T;for(y=0;y!=p.length&&p.charCodeAt(y)!==62;++y);if(++y,k=qe(p.slice(0,y),!0),k.r||(k.r=Ve({r:E-1,c:T})),S=p.slice(y),_={t:""},(w=S.match(a))!=null&&w[1]!==""&&(_.v=nt(w[1])),d.cellFormula){if((w=S.match(i))!=null&&w[1]!==""){if(_.f=nt(ft(w[1])).replace(/\r\n/g,`
`),d.xlfn||(_.f=hw(_.f)),w[0].indexOf('t="array"')>-1)_.F=(S.match(n)||[])[1],_.F.indexOf(":")>-1&&G.push([at(_.F),_.F]);else if(w[0].indexOf('t="shared"')>-1){q=qe(w[0]);var oe=nt(ft(w[1]));d.xlfn||(oe=hw(oe)),ce[parseInt(q.si,10)]=[q,oe,k.r]}}else(w=S.match(/<f[^>]*\/>/))&&(q=qe(w[0]),ce[q.si]&&(_.f=YM(ce[q.si][1],ce[q.si][2],k.r)));var ue=Ft(k.r);for(y=0;y<G.length;++y)ue.r>=G[y][0].s.r&&ue.r<=G[y][0].e.r&&ue.c>=G[y][0].s.c&&ue.c<=G[y][0].e.c&&(_.F=G[y][1])}if(k.t==null&&_.v===void 0)if(_.f||_.F)_.v=0,_.t="n";else if(A)_.t="z";else continue;else _.t=k.t||"n";switch(f.s.c>T&&(f.s.c=T),f.e.c<T&&(f.e.c=T),_.t){case"n":if(_.v==""||_.v==null){if(!A)continue;_.t="z"}else _.v=parseFloat(_.v);break;case"s":if(typeof _.v>"u"){if(!A)continue;_.t="z"}else M=jl[parseInt(_.v,10)],_.v=M.t,_.r=M.r,d.cellHTML&&(_.h=M.h);break;case"str":_.t="s",_.v=_.v!=null?ft(_.v):"",d.cellHTML&&(_.h=Ox(_.v));break;case"inlineStr":w=S.match(s),_.t="s",w!=null&&(M=Xx(w[1]))?(_.v=M.t,d.cellHTML&&(_.h=M.h)):_.v="";break;case"b":_.v=vt(_.v);break;case"d":d.cellDates?_.v=wt(_.v,1):(_.v=rr(wt(_.v,1)),_.t="n");break;case"e":(!d||d.cellText!==!1)&&(_.w=_.v),_.v=jN[_.v];break}if(D=W=0,Y=null,ee&&k.s!==void 0&&(Y=m.CellXf[k.s],Y!=null&&(Y.numFmtId!=null&&(D=Y.numFmtId),d.cellStyles&&Y.fillId!=null&&(W=Y.fillId))),kE(_,D,W,d,h,m),d.cellDates&&ee&&_.t=="n"&&Io($e[D])&&(_.t="d",_.v=v0(_.v)),k.cm&&d.xlmeta){var we=(d.xlmeta.Cell||[])[+k.cm-1];we&&we.type=="XLDAPR"&&(_.D=!0)}if(Q){var P=Ft(k.r);u[P.r]||(u[P.r]=[]),u[P.r][P.c]=_}else u[k.r]=_}}}}B.length>0&&(u["!rows"]=B)}}();function rB(e,t,r,s){var n=[],a=[],i=at(e["!ref"]),l="",c,u="",d=[],f=0,h=0,m=e["!rows"],x=Array.isArray(e),p={r:u},g,w=-1;for(h=i.s.c;h<=i.e.c;++h)d[h]=At(h);for(f=i.s.r;f<=i.e.r;++f){for(a=[],u=$t(f),h=i.s.c;h<=i.e.c;++h){c=d[h]+u;var v=x?(e[f]||[])[h]:e[c];v!==void 0&&(l=eB(v,c,e,t))!=null&&a.push(l)}(a.length>0||m&&m[f])&&(p={r:u},m&&m[f]&&(g=m[f],g.hidden&&(p.hidden=1),w=-1,g.hpx?w=pc(g.hpx):g.hpt&&(w=g.hpt),w>-1&&(p.ht=w,p.customHeight=1),g.level&&(p.outlineLevel=g.level)),n[n.length]=ke("row",a.join(""),p))}if(m)for(;f<m.length;++f)m&&m[f]&&(p={r:f+1},g=m[f],g.hidden&&(p.hidden=1),w=-1,g.hpx?w=pc(g.hpx):g.hpt&&(w=g.hpt),w>-1&&(p.ht=w,p.customHeight=1),g.level&&(p.outlineLevel=g.level),n[n.length]=ke("row","",p));return n.join("")}function EE(e,t,r,s){var n=[Vt,ke("worksheet",null,{xmlns:di[0],"xmlns:r":er.r})],a=r.SheetNames[e],i=0,l="",c=r.Sheets[a];c==null&&(c={});var u=c["!ref"]||"A1",d=at(u);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),u=Ke(d)}s||(s={}),c["!comments"]=[];var f=[];U7(c,r,e,t,n),n[n.length]=ke("dimension",null,{ref:u}),n[n.length]=Z7(c,t,e,r),t.sheetFormat&&(n[n.length]=ke("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(n[n.length]=K7(c,c["!cols"])),n[i=n.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(l=rB(c,t),l.length>0&&(n[n.length]=l)),n.length>i+1&&(n[n.length]="</sheetData>",n[i]=n[i].replace("/>",">")),c["!protect"]&&(n[n.length]=V7(c["!protect"])),c["!autofilter"]!=null&&(n[n.length]=Q7(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(n[n.length]=M7(c["!merges"]));var h=-1,m,x=-1;return c["!links"].length>0&&(n[n.length]="<hyperlinks>",c["!links"].forEach(function(p){p[1].Target&&(m={ref:p[0]},p[1].Target.charAt(0)!="#"&&(x=ct(s,-1,ut(p[1].Target).replace(/#.*$/,""),Ye.HLINK),m["r:id"]="rId"+x),(h=p[1].Target.indexOf("#"))>-1&&(m.location=ut(p[1].Target.slice(h+1))),p[1].Tooltip&&(m.tooltip=ut(p[1].Tooltip)),n[n.length]=ke("hyperlink",null,m))}),n[n.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(n[n.length]=H7(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(n[n.length]=pr("ignoredErrors",ke("ignoredError",null,{numberStoredAsText:1,sqref:u}))),f.length>0&&(x=ct(s,-1,"../drawings/drawing"+(e+1)+".xml",Ye.DRAW),n[n.length]=ke("drawing",null,{"r:id":"rId"+x}),c["!drawing"]=f),c["!comments"].length>0&&(x=ct(s,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Ye.VML),n[n.length]=ke("legacyDrawing",null,{"r:id":"rId"+x}),c["!legacy"]=x),n.length>1&&(n[n.length]="</worksheet>",n[1]=n[1].replace("/>",">")),n.join("")}function sB(e,t){var r={},s=e.l+t;r.r=e.read_shift(4),e.l+=4;var n=e.read_shift(2);e.l+=1;var a=e.read_shift(1);return e.l=s,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=n/20),r}function nB(e,t,r){var s=de(145),n=(r["!rows"]||[])[e]||{};s.write_shift(4,e),s.write_shift(4,0);var a=320;n.hpx?a=pc(n.hpx)*20:n.hpt&&(a=n.hpt*20),s.write_shift(2,a),s.write_shift(1,0);var i=0;n.level&&(i|=n.level),n.hidden&&(i|=16),(n.hpx||n.hpt)&&(i|=32),s.write_shift(1,i),s.write_shift(1,0);var l=0,c=s.l;s.l+=4;for(var u={r:e,c:0},d=0;d<16;++d)if(!(t.s.c>d+1<<10||t.e.c<d<<10)){for(var f=-1,h=-1,m=d<<10;m<d+1<<10;++m){u.c=m;var x=Array.isArray(r)?(r[u.r]||[])[u.c]:r[Ve(u)];x&&(f<0&&(f=m),h=m)}f<0||(++l,s.write_shift(4,f),s.write_shift(4,h))}var p=s.l;return s.l=c,s.write_shift(4,l),s.l=p,s.length>s.l?s.slice(0,s.l):s}function aB(e,t,r,s){var n=nB(s,r,t);(n.length>17||(t["!rows"]||[])[s])&&ge(e,0,n)}var iB=pi,oB=Lo;function lB(){}function cB(e,t){var r={},s=e[e.l];return++e.l,r.above=!(s&64),r.left=!(s&128),e.l+=18,r.name=fO(e),r}function uB(e,t,r){r==null&&(r=de(84+4*e.length));var s=192;t&&(t.above&&(s&=-65),t.left&&(s&=-129)),r.write_shift(1,s);for(var n=1;n<3;++n)r.write_shift(1,0);return Id({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),_N(e,r),r.slice(0,r.l)}function dB(e){var t=Ds(e);return[t]}function fB(e,t,r){return r==null&&(r=de(8)),fi(t,r)}function hB(e){var t=hi(e);return[t]}function mB(e,t,r){return r==null&&(r=de(4)),mi(t,r)}function pB(e){var t=Ds(e),r=e.read_shift(1);return[t,r,"b"]}function xB(e,t,r){return r==null&&(r=de(9)),fi(t,r),r.write_shift(1,e.v?1:0),r}function gB(e){var t=hi(e),r=e.read_shift(1);return[t,r,"b"]}function vB(e,t,r){return r==null&&(r=de(5)),mi(t,r),r.write_shift(1,e.v?1:0),r}function yB(e){var t=Ds(e),r=e.read_shift(1);return[t,r,"e"]}function wB(e,t,r){return r==null&&(r=de(9)),fi(t,r),r.write_shift(1,e.v),r}function bB(e){var t=hi(e),r=e.read_shift(1);return[t,r,"e"]}function _B(e,t,r){return r==null&&(r=de(8)),mi(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function SB(e){var t=Ds(e),r=e.read_shift(4);return[t,r,"s"]}function kB(e,t,r){return r==null&&(r=de(12)),fi(t,r),r.write_shift(4,t.v),r}function NB(e){var t=hi(e),r=e.read_shift(4);return[t,r,"s"]}function EB(e,t,r){return r==null&&(r=de(8)),mi(t,r),r.write_shift(4,t.v),r}function jB(e){var t=Ds(e),r=Er(e);return[t,r,"n"]}function TB(e,t,r){return r==null&&(r=de(16)),fi(t,r),ai(e.v,r),r}function jE(e){var t=hi(e),r=Er(e);return[t,r,"n"]}function CB(e,t,r){return r==null&&(r=de(12)),mi(t,r),ai(e.v,r),r}function AB(e){var t=Ds(e),r=Wx(e);return[t,r,"n"]}function FB(e,t,r){return r==null&&(r=de(12)),fi(t,r),SN(e.v,r),r}function PB(e){var t=hi(e),r=Wx(e);return[t,r,"n"]}function RB(e,t,r){return r==null&&(r=de(8)),mi(t,r),SN(e.v,r),r}function IB(e){var t=Ds(e),r=zx(e);return[t,r,"is"]}function OB(e){var t=Ds(e),r=Cr(e);return[t,r,"str"]}function DB(e,t,r){return r==null&&(r=de(12+4*e.v.length)),fi(t,r),or(e.v,r),r.length>r.l?r.slice(0,r.l):r}function LB(e){var t=hi(e),r=Cr(e);return[t,r,"str"]}function MB(e,t,r){return r==null&&(r=de(8+4*e.v.length)),mi(t,r),or(e.v,r),r.length>r.l?r.slice(0,r.l):r}function BB(e,t,r){var s=e.l+t,n=Ds(e);n.r=r["!row"];var a=e.read_shift(1),i=[n,a,"b"];if(r.cellFormula){e.l+=2;var l=b0(e,s-e.l,r);i[3]=Sr(l,null,n,r.supbooks,r)}else e.l=s;return i}function UB(e,t,r){var s=e.l+t,n=Ds(e);n.r=r["!row"];var a=e.read_shift(1),i=[n,a,"e"];if(r.cellFormula){e.l+=2;var l=b0(e,s-e.l,r);i[3]=Sr(l,null,n,r.supbooks,r)}else e.l=s;return i}function zB(e,t,r){var s=e.l+t,n=Ds(e);n.r=r["!row"];var a=Er(e),i=[n,a,"n"];if(r.cellFormula){e.l+=2;var l=b0(e,s-e.l,r);i[3]=Sr(l,null,n,r.supbooks,r)}else e.l=s;return i}function $B(e,t,r){var s=e.l+t,n=Ds(e);n.r=r["!row"];var a=Cr(e),i=[n,a,"str"];if(r.cellFormula){e.l+=2;var l=b0(e,s-e.l,r);i[3]=Sr(l,null,n,r.supbooks,r)}else e.l=s;return i}var VB=pi,WB=Lo;function qB(e,t){return t==null&&(t=de(4)),t.write_shift(4,e),t}function HB(e,t){var r=e.l+t,s=pi(e),n=$x(e),a=Cr(e),i=Cr(e),l=Cr(e);e.l=r;var c={rfx:s,relId:n,loc:a,display:l};return i&&(c.Tooltip=i),c}function GB(e,t){var r=de(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Lo({s:Ft(e[0]),e:Ft(e[0])},r),Vx("rId"+t,r);var s=e[1].Target.indexOf("#"),n=s==-1?"":e[1].Target.slice(s+1);return or(n||"",r),or(e[1].Tooltip||"",r),or("",r),r.slice(0,r.l)}function KB(){}function XB(e,t,r){var s=e.l+t,n=kN(e),a=e.read_shift(1),i=[n];if(i[2]=a,r.cellFormula){var l=y7(e,s-e.l,r);i[1]=l}else e.l=s;return i}function QB(e,t,r){var s=e.l+t,n=pi(e),a=[n];if(r.cellFormula){var i=b7(e,s-e.l,r);a[1]=i,e.l=s}else e.l=s;return a}function YB(e,t,r){r==null&&(r=de(18));var s=_0(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(s.width||10)*256),r.write_shift(4,0);var n=0;return t.hidden&&(n|=1),typeof s.width=="number"&&(n|=2),t.level&&(n|=t.level<<8),r.write_shift(2,n),r}var TE=["left","right","top","bottom","header","footer"];function JB(e){var t={};return TE.forEach(function(r){t[r]=Er(e)}),t}function ZB(e,t){return t==null&&(t=de(6*8)),Qa(e),TE.forEach(function(r){ai(e[r],t)}),t}function eU(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function tU(e,t,r){r==null&&(r=de(30));var s=924;return(((t||{}).Views||[])[0]||{}).RTL&&(s|=32),r.write_shift(2,s),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function rU(e){var t=de(24);return t.write_shift(4,4),t.write_shift(4,1),Lo(e,t),t}function sU(e,t){return t==null&&(t=de(16*4+2)),t.write_shift(2,e.password?Qx(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function nU(){}function aU(){}function iU(e,t,r,s,n,a,i){if(!e)return e;var l=t||{};s||(s={"!id":{}});var c=l.dense?[]:{},u,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,h=!1,m,x,p,g,w,v,y,b,S,_=[];l.biff=12,l["!row"]=0;var k=0,E=!1,T=[],M={},q=l.supbooks||n.supbooks||[[]];if(q.sharedf=M,q.arrayf=T,q.SheetNames=n.SheetNames||n.Sheets.map(function(Q){return Q.name}),!l.supbooks&&(l.supbooks=q,n.Names))for(var D=0;D<n.Names.length;++D)q[0][D+1]=n.Names[D];var W=[],ee=[],Y=!1;xc[16]={n:"BrtShortReal",f:jE};var G;if(Ln(e,function(B,me,fe){if(!h)switch(fe){case 148:u=B;break;case 0:m=B,l.sheetRows&&l.sheetRows<=m.r&&(h=!0),b=$t(g=m.r),l["!row"]=m.r,(B.hidden||B.hpt||B.level!=null)&&(B.hpt&&(B.hpx=_o(B.hpt)),ee[B.r]=B);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(x={t:B[2]},B[2]){case"n":x.v=B[1];break;case"s":y=jl[B[1]],x.v=y.t,x.r=y.r;break;case"b":x.v=!!B[1];break;case"e":x.v=B[1],l.cellText!==!1&&(x.w=Mn[x.v]);break;case"str":x.t="s",x.v=B[1];break;case"is":x.t="s",x.v=B[1].t;break}if((p=i.CellXf[B[0].iStyleRef])&&kE(x,p.numFmtId,null,l,a,i),w=B[0].c==-1?w+1:B[0].c,l.dense?(c[g]||(c[g]=[]),c[g][w]=x):c[At(w)+b]=x,l.cellFormula){for(E=!1,k=0;k<T.length;++k){var A=T[k];m.r>=A[0].s.r&&m.r<=A[0].e.r&&w>=A[0].s.c&&w<=A[0].e.c&&(x.F=Ke(A[0]),E=!0)}!E&&B.length>3&&(x.f=B[3])}if(d.s.r>m.r&&(d.s.r=m.r),d.s.c>w&&(d.s.c=w),d.e.r<m.r&&(d.e.r=m.r),d.e.c<w&&(d.e.c=w),l.cellDates&&p&&x.t=="n"&&Io($e[p.numFmtId])){var V=$a(x.v);V&&(x.t="d",x.v=new Date(V.y,V.m-1,V.d,V.H,V.M,V.S,V.u))}G&&(G.type=="XLDAPR"&&(x.D=!0),G=void 0);break;case 1:case 12:if(!l.sheetStubs||f)break;x={t:"z",v:void 0},w=B[0].c==-1?w+1:B[0].c,l.dense?(c[g]||(c[g]=[]),c[g][w]=x):c[At(w)+b]=x,d.s.r>m.r&&(d.s.r=m.r),d.s.c>w&&(d.s.c=w),d.e.r<m.r&&(d.e.r=m.r),d.e.c<w&&(d.e.c=w),G&&(G.type=="XLDAPR"&&(x.D=!0),G=void 0);break;case 176:_.push(B);break;case 49:G=((l.xlmeta||{}).Cell||[])[B-1];break;case 494:var L=s["!id"][B.relId];for(L?(B.Target=L.Target,B.loc&&(B.Target+="#"+B.loc),B.Rel=L):B.relId==""&&(B.Target="#"+B.loc),g=B.rfx.s.r;g<=B.rfx.e.r;++g)for(w=B.rfx.s.c;w<=B.rfx.e.c;++w)l.dense?(c[g]||(c[g]=[]),c[g][w]||(c[g][w]={t:"z",v:void 0}),c[g][w].l=B):(v=Ve({c:w,r:g}),c[v]||(c[v]={t:"z",v:void 0}),c[v].l=B);break;case 426:if(!l.cellFormula)break;T.push(B),S=l.dense?c[g][w]:c[At(w)+b],S.f=Sr(B[1],d,{r:m.r,c:w},q,l),S.F=Ke(B[0]);break;case 427:if(!l.cellFormula)break;M[Ve(B[0].s)]=B[1],S=l.dense?c[g][w]:c[At(w)+b],S.f=Sr(B[1],d,{r:m.r,c:w},q,l);break;case 60:if(!l.cellStyles)break;for(;B.e>=B.s;)W[B.e--]={width:B.w/256,hidden:!!(B.flags&1),level:B.level},Y||(Y=!0,Yx(B.w/256)),fa(W[B.e+1]);break;case 161:c["!autofilter"]={ref:Ke(B)};break;case 476:c["!margins"]=B;break;case 147:n.Sheets[r]||(n.Sheets[r]={}),B.name&&(n.Sheets[r].CodeName=B.name),(B.above||B.left)&&(c["!outline"]={above:B.above,left:B.left});break;case 137:n.Views||(n.Views=[{}]),n.Views[0]||(n.Views[0]={}),B.RTL&&(n.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!me.T){if(!f||l.WTF)throw new Error("Unexpected record 0x"+fe.toString(16))}}},l),delete l.supbooks,delete l["!row"],!c["!ref"]&&(d.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(c["!ref"]=Ke(u||d)),l.sheetRows&&c["!ref"]){var ce=at(c["!ref"]);l.sheetRows<=+ce.e.r&&(ce.e.r=l.sheetRows-1,ce.e.r>d.e.r&&(ce.e.r=d.e.r),ce.e.r<ce.s.r&&(ce.s.r=ce.e.r),ce.e.c>d.e.c&&(ce.e.c=d.e.c),ce.e.c<ce.s.c&&(ce.s.c=ce.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Ke(ce))}return _.length>0&&(c["!merges"]=_),W.length>0&&(c["!cols"]=W),ee.length>0&&(c["!rows"]=ee),c}function oU(e,t,r,s,n,a,i){if(t.v===void 0)return!1;var l="";switch(t.t){case"b":l=t.v?"1":"0";break;case"d":t=bt(t),t.z=t.z||$e[14],t.v=rr(wt(t.v)),t.t="n";break;case"n":case"e":l=""+t.v;break;default:l=t.v;break}var c={r,c:s};switch(c.s=Sa(n.cellXfs,t,n),t.l&&a["!links"].push([Ve(c),t.l]),t.c&&a["!comments"].push([Ve(c),t.c]),t.t){case"s":case"str":return n.bookSST?(l=rg(n.Strings,t.v,n.revStrings),c.t="s",c.v=l,i?ge(e,18,EB(t,c)):ge(e,7,kB(t,c))):(c.t="str",i?ge(e,17,MB(t,c)):ge(e,6,DB(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?i?ge(e,13,RB(t,c)):ge(e,2,FB(t,c)):i?ge(e,16,CB(t,c)):ge(e,5,TB(t,c)),!0;case"b":return c.t="b",i?ge(e,15,vB(t,c)):ge(e,4,xB(t,c)),!0;case"e":return c.t="e",i?ge(e,14,_B(t,c)):ge(e,3,wB(t,c)),!0}return i?ge(e,12,mB(t,c)):ge(e,1,fB(t,c)),!0}function lU(e,t,r,s){var n=at(t["!ref"]||"A1"),a,i="",l=[];ge(e,145);var c=Array.isArray(t),u=n.e.r;t["!rows"]&&(u=Math.max(n.e.r,t["!rows"].length-1));for(var d=n.s.r;d<=u;++d){i=$t(d),aB(e,t,n,d);var f=!1;if(d<=n.e.r)for(var h=n.s.c;h<=n.e.c;++h){d===n.s.r&&(l[h]=At(h)),a=l[h]+i;var m=c?(t[d]||[])[h]:t[a];if(!m){f=!1;continue}f=oU(e,m,d,h,s,t,f)}}ge(e,146)}function cU(e,t){!t||!t["!merges"]||(ge(e,177,qB(t["!merges"].length)),t["!merges"].forEach(function(r){ge(e,176,WB(r))}),ge(e,178))}function uU(e,t){!t||!t["!cols"]||(ge(e,390),t["!cols"].forEach(function(r,s){r&&ge(e,60,YB(s,r))}),ge(e,391))}function dU(e,t){!t||!t["!ref"]||(ge(e,648),ge(e,649,rU(at(t["!ref"]))),ge(e,650))}function fU(e,t,r){t["!links"].forEach(function(s){if(s[1].Target){var n=ct(r,-1,s[1].Target.replace(/#.*$/,""),Ye.HLINK);ge(e,494,GB(s,n))}}),delete t["!links"]}function hU(e,t,r,s){if(t["!comments"].length>0){var n=ct(s,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Ye.VML);ge(e,551,Vx("rId"+n)),t["!legacy"]=n}}function mU(e,t,r,s){if(t["!autofilter"]){var n=t["!autofilter"],a=typeof n.ref=="string"?n.ref:Ke(n.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,l=Zr(a);l.s.r==l.e.r&&(l.e.r=Zr(t["!ref"]).e.r,a=Ke(l));for(var c=0;c<i.length;++c){var u=i[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==s){u.Ref="'"+r.SheetNames[s]+"'!"+a;break}}c==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:s,Ref:"'"+r.SheetNames[s]+"'!"+a}),ge(e,161,Lo(at(a))),ge(e,162)}}function pU(e,t,r){ge(e,133),ge(e,137,tU(t,r)),ge(e,138),ge(e,134)}function xU(e,t){t["!protect"]&&ge(e,535,sU(t["!protect"]))}function gU(e,t,r,s){var n=Jr(),a=r.SheetNames[e],i=r.Sheets[a]||{},l=a;try{r&&r.Workbook&&(l=r.Workbook.Sheets[e].CodeName||l)}catch{}var c=at(i["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return i["!links"]=[],i["!comments"]=[],ge(n,129),(r.vbaraw||i["!outline"])&&ge(n,147,uB(l,i["!outline"])),ge(n,148,oB(c)),pU(n,i,r.Workbook),uU(n,i),lU(n,i,e,t),xU(n,i),mU(n,i,r,e),cU(n,i),fU(n,i,s),i["!margins"]&&ge(n,476,ZB(i["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&dU(n,i),hU(n,i,e,s),ge(n,130),n.end()}function vU(e){var t=[],r=e.match(/^<c:numCache>/),s;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var i=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(t[+i[1]]=r?+i[2]:i[2])});var n=nt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){s=a.replace(/<.*?>/g,"")}),[t,n,s]}function yU(e,t,r,s,n,a){var i=a||{"!type":"chart"};if(!e)return a;var l=0,c=0,u="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var h=vU(f);d.s.r=d.s.c=0,d.e.c=l,u=At(l),h[0].forEach(function(m,x){i[u+$t(x)]={t:"n",v:m,z:h[1]},c=x}),d.e.r<c&&(d.e.r=c),++l}),l>0&&(i["!ref"]=Ke(d)),i}function wU(e,t,r,s,n){if(!e)return e;s||(s={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i,l=e.match(NE);return l&&sg(l[0],a,n,r),(i=e.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=i[1]),s["!id"][a["!rel"]]&&(a["!drawel"]=s["!id"][a["!rel"]]),a}function bU(e,t){e.l+=10;var r=Cr(e);return{name:r}}function _U(e,t,r,s,n){if(!e)return e;s||(s={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i=!1;return Ln(e,function(c,u,d){switch(d){case 550:a["!rel"]=c;break;case 651:n.Sheets[r]||(n.Sheets[r]={}),c.name&&(n.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!i||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},t),s["!id"][a["!rel"]]&&(a["!drawel"]=s["!id"][a["!rel"]]),a}var ng=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],SU=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],kU=[],NU=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function vw(e,t){for(var r=0;r!=e.length;++r)for(var s=e[r],n=0;n!=t.length;++n){var a=t[n];if(s[a[0]]==null)s[a[0]]=a[1];else switch(a[2]){case"bool":typeof s[a[0]]=="string"&&(s[a[0]]=vt(s[a[0]]));break;case"int":typeof s[a[0]]=="string"&&(s[a[0]]=parseInt(s[a[0]],10));break}}}function yw(e,t){for(var r=0;r!=t.length;++r){var s=t[r];if(e[s[0]]==null)e[s[0]]=s[1];else switch(s[2]){case"bool":typeof e[s[0]]=="string"&&(e[s[0]]=vt(e[s[0]]));break;case"int":typeof e[s[0]]=="string"&&(e[s[0]]=parseInt(e[s[0]],10));break}}}function CE(e){yw(e.WBProps,ng),yw(e.CalcPr,NU),vw(e.WBView,SU),vw(e.Sheets,kU),io.date1904=vt(e.WBProps.date1904)}function EU(e){return!e.Workbook||!e.Workbook.WBProps?"false":vt(e.Workbook.WBProps.date1904)?"true":"false"}var jU="][*?/\\".split("");function AE(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return jU.forEach(function(s){if(e.indexOf(s)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function TU(e,t,r){e.forEach(function(s,n){AE(s);for(var a=0;a<n;++a)if(s==e[a])throw new Error("Duplicate Sheet Name: "+s);if(r){var i=t&&t[n]&&t[n].CodeName||s;if(i.charCodeAt(0)==95&&i.length>22)throw new Error("Bad Code Name: Worksheet"+i)}})}function CU(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];TU(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)E7(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var AU=/<\w+:workbook/;function FU(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},s=!1,n="xmlns",a={},i=0;if(e.replace(Pr,function(c,u){var d=qe(c);switch(hn(d[0])){case"<?xml":break;case"<workbook":c.match(AU)&&(n="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=d[n];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":ng.forEach(function(f){if(d[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=vt(d[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(d[f[0]],10);break;default:r.WBProps[f[0]]=d[f[0]]}}),d.codeName&&(r.WBProps.CodeName=ft(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=nt(ft(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":s=!0;break;case"</definedNames>":s=!1;break;case"<definedName":a={},a.Name=ft(d.name),d.comment&&(a.Comment=d.comment),d.localSheetId&&(a.Sheet=+d.localSheetId),vt(d.hidden||"0")&&(a.Hidden=!0),i=u+c.length;break;case"</definedName>":a.Ref=nt(ft(e.slice(i,u))),r.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":s=!0;break;case"</AlternateContent>":s=!1;break;case"<revisionPtr":break;default:if(!s&&t.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return c}),di.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return CE(r),r}function FE(e){var t=[Vt];t[t.length]=ke("workbook",null,{xmlns:di[0],"xmlns:r":er.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,s={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(ng.forEach(function(l){e.Workbook.WBProps[l[0]]!=null&&e.Workbook.WBProps[l[0]]!=l[1]&&(s[l[0]]=e.Workbook.WBProps[l[0]])}),e.Workbook.WBProps.CodeName&&(s.codeName=e.Workbook.WBProps.CodeName,delete s.CodeName)),t[t.length]=ke("workbookPr",null,s);var n=e.Workbook&&e.Workbook.Sheets||[],a=0;if(n&&n[0]&&n[0].Hidden){for(t[t.length]="<bookViews>",a=0;a!=e.SheetNames.length&&!(!n[a]||!n[a].Hidden);++a);a==e.SheetNames.length&&(a=0),t[t.length]='<workbookView firstSheet="'+a+'" activeTab="'+a+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",a=0;a!=e.SheetNames.length;++a){var i={name:ut(e.SheetNames[a].slice(0,31))};if(i.sheetId=""+(a+1),i["r:id"]="rId"+(a+1),n[a])switch(n[a].Hidden){case 1:i.state="hidden";break;case 2:i.state="veryHidden";break}t[t.length]=ke("sheet",null,i)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(l){var c={name:l.Name};l.Comment&&(c.comment=l.Comment),l.Sheet!=null&&(c.localSheetId=""+l.Sheet),l.Hidden&&(c.hidden="1"),l.Ref&&(t[t.length]=ke("definedName",ut(l.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function PU(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=km(e),r.name=Cr(e),r}function RU(e,t){return t||(t=de(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Vx(e.strRelID,t),or(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function IU(e,t){var r={},s=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var n=t>8?Cr(e):"";return n.length>0&&(r.CodeName=n),r.autoCompressPictures=!!(s&65536),r.backupFile=!!(s&64),r.checkCompatibility=!!(s&4096),r.date1904=!!(s&1),r.filterPrivacy=!!(s&8),r.hidePivotFieldList=!!(s&1024),r.promptedSolutions=!!(s&16),r.publishItems=!!(s&2048),r.refreshAllConnections=!!(s&262144),r.saveExternalLinkValues=!!(s&128),r.showBorderUnselectedTables=!!(s&4),r.showInkAnnotation=!!(s&32),r.showObjects=["all","placeholders","none"][s>>13&3],r.showPivotChartFilter=!!(s&32768),r.updateLinks=["userSet","never","always"][s>>8&3],r}function OU(e,t){t||(t=de(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),_N(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function DU(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function LU(e,t,r){var s=e.l+t;e.l+=4,e.l+=1;var n=e.read_shift(4),a=hO(e),i=w7(e,0,r),l=$x(e);e.l=s;var c={Name:a,Ptg:i};return n<268435455&&(c.Sheet=n),l&&(c.Comment=l),c}function MU(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},s=[],n=!1;t||(t={}),t.biff=12;var a=[],i=[[]];return i.SheetNames=[],i.XTI=[],xc[16]={n:"BrtFRTArchID$",f:DU},Ln(e,function(c,u,d){switch(d){case 156:i.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(t.SID=c.Sheet),c.Ref=Sr(c.Ptg,null,null,i,t),delete t.SID,delete c.Ptg,a.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([d,c]):i[0]=[d,c],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(c),i.XTI=i.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:s.push(d),n=!0;break;case 36:s.pop(),n=!1;break;case 37:s.push(d),n=!0;break;case 38:s.pop(),n=!1;break;case 16:break;default:if(!u.T){if(!n||t.WTF&&s[s.length-1]!=37&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},t),CE(r),r.Names=a,r.supbooks=i,r}function BU(e,t){ge(e,143);for(var r=0;r!=t.SheetNames.length;++r){var s=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,n={Hidden:s,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};ge(e,156,RU(n))}ge(e,144)}function UU(e,t){t||(t=de(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return or("SheetJS",t),or(jd.version,t),or(jd.version,t),or("7262",t),t.length>t.l?t.slice(0,t.l):t}function zU(e,t){t||(t=de(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function $U(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,s=0,n=-1,a=-1;s<r.length;++s)!r[s]||!r[s].Hidden&&n==-1?n=s:r[s].Hidden==1&&a==-1&&(a=s);a>n||(ge(e,135),ge(e,158,zU(n)),ge(e,136))}}function VU(e,t){var r=Jr();return ge(r,131),ge(r,128,UU()),ge(r,153,OU(e.Workbook&&e.Workbook.WBProps||null)),$U(r,e),BU(r,e),ge(r,132),r.end()}function WU(e,t,r){return t.slice(-4)===".bin"?MU(e,r):FU(e,r)}function qU(e,t,r,s,n,a,i,l){return t.slice(-4)===".bin"?iU(e,s,r,n,a,i,l):L7(e,s,r,n,a,i,l)}function HU(e,t,r,s,n,a,i,l){return t.slice(-4)===".bin"?_U(e,s,r,n,a):wU(e,s,r,n,a)}function GU(e,t,r,s,n,a,i,l){return t.slice(-4)===".bin"?XM():QM()}function KU(e,t,r,s,n,a,i,l){return t.slice(-4)===".bin"?GM():KM()}function XU(e,t,r,s){return t.slice(-4)===".bin"?WL(e,r,s):PL(e,r,s)}function QU(e,t,r){return dE(e,r)}function YU(e,t,r){return t.slice(-4)===".bin"?Y8(e,r):K8(e,r)}function JU(e,t,r){return t.slice(-4)===".bin"?$M(e,r):RM(e,r)}function ZU(e,t,r){return t.slice(-4)===".bin"?AM(e):TM(e)}function ez(e,t,r,s){return r.slice(-4)===".bin"?FM(e,t,r,s):void 0}function tz(e,t,r){return t.slice(-4)===".bin"?NM(e,t,r):jM(e,t,r)}function rz(e,t,r){return(t.slice(-4)===".bin"?VU:FE)(e)}function sz(e,t,r,s,n){return(t.slice(-4)===".bin"?gU:EE)(e,r,s,n)}function nz(e,t,r){return(t.slice(-4)===".bin"?eM:cE)(e,r)}function az(e,t,r){return(t.slice(-4)===".bin"?eL:tE)(e,r)}function iz(e,t,r){return(t.slice(-4)===".bin"?VM:mE)(e)}function oz(e){return(e.slice(-4)===".bin"?EM:fE)()}var PE=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,RE=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Ms(e,t){var r=e.split(/\s+/),s=[];if(s[0]=r[0],r.length===1)return s;var n=e.match(PE),a,i,l,c;if(n)for(c=0;c!=n.length;++c)a=n[c].match(RE),(i=a[1].indexOf(":"))===-1?s[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?l="xmlns"+a[1].slice(6):l=a[1].slice(i+1),s[l]=a[2].slice(1,a[2].length-1));return s}function lz(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var s=e.match(PE),n,a,i,l;if(s)for(l=0;l!=s.length;++l)n=s[l].match(RE),(a=n[1].indexOf(":"))===-1?r[n[1]]=n[2].slice(1,n[2].length-1):(n[1].slice(0,6)==="xmlns:"?i="xmlns"+n[1].slice(6):i=n[1].slice(a+1),r[i]=n[2].slice(1,n[2].length-1));return r}var Cl;function cz(e,t){var r=Cl[e]||nt(e);return r==="General"?si(t):Os(r,t)}function uz(e,t,r,s){var n=s;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":n=vt(s);break;case"i2":case"int":n=parseInt(s,10);break;case"r4":case"float":n=parseFloat(s);break;case"date":case"dateTime.tz":n=wt(s);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[nt(t)]=n}function dz(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Mn[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=oc(e.v):e.w=si(e.v):e.w=cz(t||"General",e.v)}catch(a){if(r.WTF)throw a}try{var s=Cl[t]||t||"General";if(r.cellNF&&(e.z=s),r.cellDates&&e.t=="n"&&Io(s)){var n=$a(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}catch(a){if(r.WTF)throw a}}}function fz(e,t,r){if(r.cellStyles&&t.Interior){var s=t.Interior;s.Pattern&&(s.patternType=kL[s.Pattern]||s.Pattern)}e[t.ID]=t}function hz(e,t,r,s,n,a,i,l,c,u){var d="General",f=s.StyleID,h={};u=u||{};var m=[],x=0;for(f===void 0&&l&&(f=l.StyleID),f===void 0&&i&&(f=i.StyleID);a[f]!==void 0&&(a[f].nf&&(d=a[f].nf),a[f].Interior&&m.push(a[f].Interior),!!a[f].Parent);)f=a[f].Parent;switch(r.Type){case"Boolean":s.t="b",s.v=vt(e);break;case"String":s.t="s",s.r=D1(nt(e)),s.v=e.indexOf("<")>-1?nt(t||e).replace(/<.*?>/g,""):s.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),s.v=(wt(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),s.v!==s.v?s.v=nt(e):s.v<60&&(s.v=s.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":s.v===void 0&&(s.v=+e),s.t||(s.t="n");break;case"Error":s.t="e",s.v=jN[e],u.cellText!==!1&&(s.w=e);break;default:e==""&&t==""?s.t="z":(s.t="s",s.v=D1(t||e));break}if(dz(s,d,u),u.cellFormula!==!1)if(s.Formula){var p=nt(s.Formula);p.charCodeAt(0)==61&&(p=p.slice(1)),s.f=ao(p,n),delete s.Formula,s.ArrayRange=="RC"?s.F=ao("RC:RC",n):s.ArrayRange&&(s.F=ao(s.ArrayRange,n),c.push([at(s.F),s.F]))}else for(x=0;x<c.length;++x)n.r>=c[x][0].s.r&&n.r<=c[x][0].e.r&&n.c>=c[x][0].s.c&&n.c<=c[x][0].e.c&&(s.F=c[x][1]);u.cellStyles&&(m.forEach(function(g){!h.patternType&&g.patternType&&(h.patternType=g.patternType)}),s.s=h),s.StyleID!==void 0&&(s.ixfe=s.StyleID)}function mz(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Mf(e,t){var r=t||{};Oo();var s=nl(Dx(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(s=ft(s));var n=s.slice(0,1024).toLowerCase(),a=!1;if(n=n.replace(/".*?"/g,""),(n.indexOf(">")&1023)>Math.min(n.indexOf(",")&1023,n.indexOf(";")&1023)){var i=bt(r);return i.type="string",bo.to_workbook(s,i)}if(n.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Z){n.indexOf("<"+Z)>=0&&(a=!0)}),a)return Zz(s,r);Cl={"General Number":"General","General Date":$e[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":$e[15],"Short Date":$e[14],"Long Time":$e[19],"Medium Time":$e[18],"Short Time":$e[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:$e[2],Standard:$e[4],Percent:$e[10],Scientific:$e[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,c=[],u,d={},f=[],h=r.dense?[]:{},m="",x={},p={},g=Ms('<Data ss:Type="String">'),w=0,v=0,y=0,b={s:{r:2e6,c:2e6},e:{r:0,c:0}},S={},_={},k="",E=0,T=[],M={},q={},D=0,W=[],ee=[],Y={},G=[],ce,Q=!1,B=[],me=[],fe={},A=0,V=0,L={Sheets:[],WBProps:{date1904:!1}},U={};uc.lastIndex=0,s=s.replace(/<!--([\s\S]*?)-->/mg,"");for(var ne="";l=uc.exec(s);)switch(l[3]=(ne=l[3]).toLowerCase()){case"data":if(ne=="data"){if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break}if(c[c.length-1][1])break;l[1]==="/"?hz(s.slice(w,l.index),k,g,c[c.length-1][0]=="comment"?Y:x,{c:v,r:y},S,G[v],p,B,r):(k="",g=Ms(l[0]),w=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(ee.length>0&&(x.c=ee),(!r.sheetRows||r.sheetRows>y)&&x.v!==void 0&&(r.dense?(h[y]||(h[y]=[]),h[y][v]=x):h[At(v)+$t(y)]=x),x.HRef&&(x.l={Target:nt(x.HRef)},x.HRefScreenTip&&(x.l.Tooltip=x.HRefScreenTip),delete x.HRef,delete x.HRefScreenTip),(x.MergeAcross||x.MergeDown)&&(A=v+(parseInt(x.MergeAcross,10)|0),V=y+(parseInt(x.MergeDown,10)|0),T.push({s:{c:v,r:y},e:{c:A,r:V}})),!r.sheetStubs)x.MergeAcross?v=A+1:++v;else if(x.MergeAcross||x.MergeDown){for(var xe=v;xe<=A;++xe)for(var pe=y;pe<=V;++pe)(xe>v||pe>y)&&(r.dense?(h[pe]||(h[pe]=[]),h[pe][xe]={t:"z"}):h[At(xe)+$t(pe)]={t:"z"});v=A+1}else++v;else x=lz(l[0]),x.Index&&(v=+x.Index-1),v<b.s.c&&(b.s.c=v),v>b.e.c&&(b.e.c=v),l[0].slice(-2)==="/>"&&++v,ee=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(y<b.s.r&&(b.s.r=y),y>b.e.r&&(b.e.r=y),l[0].slice(-2)==="/>"&&(p=Ms(l[0]),p.Index&&(y=+p.Index-1)),v=0,++y):(p=Ms(l[0]),p.Index&&(y=+p.Index-1),fe={},(p.AutoFitHeight=="0"||p.Height)&&(fe.hpx=parseInt(p.Height,10),fe.hpt=pc(fe.hpx),me[y]=fe),p.Hidden=="1"&&(fe.hidden=!0,me[y]=fe));break;case"worksheet":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"));f.push(m),b.s.r<=b.e.r&&b.s.c<=b.e.c&&(h["!ref"]=Ke(b),r.sheetRows&&r.sheetRows<=b.e.r&&(h["!fullref"]=h["!ref"],b.e.r=r.sheetRows-1,h["!ref"]=Ke(b))),T.length&&(h["!merges"]=T),G.length>0&&(h["!cols"]=G),me.length>0&&(h["!rows"]=me),d[m]=h}else b={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=v=0,c.push([l[3],!1]),u=Ms(l[0]),m=nt(u.Name),h=r.dense?[]:{},T=[],B=[],me=[],U={name:m,Hidden:0},L.Sheets.push(U);break;case"table":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else{if(l[0].slice(-2)=="/>")break;c.push([l[3],!1]),G=[],Q=!1}break;case"style":l[1]==="/"?fz(S,_,r):_=Ms(l[0]);break;case"numberformat":_.nf=nt(Ms(l[0]).Format||"General"),Cl[_.nf]&&(_.nf=Cl[_.nf]);for(var oe=0;oe!=392&&$e[oe]!=_.nf;++oe);if(oe==392){for(oe=57;oe!=392;++oe)if($e[oe]==null){En(_.nf,oe);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(ce=Ms(l[0]),ce.Hidden&&(ce.hidden=!0,delete ce.Hidden),ce.Width&&(ce.wpx=parseInt(ce.Width,10)),!Q&&ce.wpx>10){Q=!0,Nr=oE;for(var ue=0;ue<G.length;++ue)G[ue]&&fa(G[ue])}Q&&fa(ce),G[ce.Index-1||G.length]=ce;for(var we=0;we<+ce.Span;++we)G[G.length]=bt(ce);break;case"namedrange":if(l[1]==="/")break;L.Names||(L.Names=[]);var P=qe(l[0]),Me={Name:P.Name,Ref:ao(P.RefersTo.slice(1),{r:0,c:0})};L.Sheets.length>0&&(Me.Sheet=L.Sheets.length-1),L.Names.push(Me);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?k+=s.slice(E,l.index):E=l.index+l[0].length;break;case"interior":if(!r.cellStyles)break;_.Interior=Ms(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?MO(M,ne,s.slice(D,l.index)):D=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else c.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"));mz(Y),ee.push(Y)}else c.push([l[3],!1]),u=Ms(l[0]),Y={a:u.Author};break;case"autofilter":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var je=Ms(l[0]);h["!autofilter"]={ref:ao(je.Range).replace(/\$/g,"")},c.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"null":break;default:if(c.length==0&&l[3]=="document"||c.length==0&&l[3]=="uof")return kw(s,r);var X=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:X=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:X=!1}break;case"excelworkbook":switch(l[3]){case"date1904":L.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:X=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:X=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(s.slice(D,l.index)){case"SheetHidden":U.Hidden=1;break;case"SheetVeryHidden":U.Hidden=2;break}else D=l.index+l[0].length;break;case"header":h["!margins"]||Qa(h["!margins"]={},"xlml"),isNaN(+qe(l[0]).Margin)||(h["!margins"].header=+qe(l[0]).Margin);break;case"footer":h["!margins"]||Qa(h["!margins"]={},"xlml"),isNaN(+qe(l[0]).Margin)||(h["!margins"].footer=+qe(l[0]).Margin);break;case"pagemargins":var z=qe(l[0]);h["!margins"]||Qa(h["!margins"]={},"xlml"),isNaN(+z.Top)||(h["!margins"].top=+z.Top),isNaN(+z.Left)||(h["!margins"].left=+z.Left),isNaN(+z.Right)||(h["!margins"].right=+z.Right),isNaN(+z.Bottom)||(h["!margins"].bottom=+z.Bottom);break;case"displayrighttoleft":L.Views||(L.Views=[]),L.Views[0]||(L.Views[0]={}),L.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:X=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:X=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:X=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:X=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:X=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:X=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:X=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:X=!1}break;case"smarttags":break;default:X=!1;break}if(X||l[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?uz(q,ne,W,s.slice(D,l.index)):(W=l,D=l.index+l[0].length);break}if(r.WTF)throw"Unrecognized tag: "+l[3]+"|"+c.join("|")}var H={};return!r.bookSheets&&!r.bookProps&&(H.Sheets=d),H.SheetNames=f,H.Workbook=L,H.SSF=bt($e),H.Props=M,H.Custprops=q,H}function Fm(e,t){switch(ig(t=t||{}),t.type||"base64"){case"base64":return Mf(fs(e),t);case"binary":case"buffer":case"file":return Mf(e,t);case"array":return Mf(ba(e),t)}}function pz(e,t){var r=[];return e.Props&&r.push(BO(e.Props,t)),e.Custprops&&r.push(UO(e.Props,e.Custprops)),r.join("")}function xz(){return""}function gz(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(s,n){var a=[];a.push(ke("NumberFormat",null,{"ss:Format":ut($e[s.numFmtId])}));var i={"ss:ID":"s"+(21+n)};r.push(ke("Style",a.join(""),i))}),ke("Styles",r.join(""))}function IE(e){return ke("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+eg(e.Ref,{r:0,c:0})})}function vz(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],s=0;s<t.length;++s){var n=t[s];n.Sheet==null&&(n.Name.match(/^_xlfn\./)||r.push(IE(n)))}return ke("Names",r.join(""))}function yz(e,t,r,s){if(!e||!((s||{}).Workbook||{}).Names)return"";for(var n=s.Workbook.Names,a=[],i=0;i<n.length;++i){var l=n[i];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||a.push(IE(l)))}return a.join("")}function wz(e,t,r,s){if(!e)return"";var n=[];if(e["!margins"]&&(n.push("<PageSetup>"),e["!margins"].header&&n.push(ke("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&n.push(ke("Footer",null,{"x:Margin":e["!margins"].footer})),n.push(ke("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),n.push("</PageSetup>")),s&&s.Workbook&&s.Workbook.Sheets&&s.Workbook.Sheets[r])if(s.Workbook.Sheets[r].Hidden)n.push(ke("Visible",s.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var a=0;a<r&&!(s.Workbook.Sheets[a]&&!s.Workbook.Sheets[a].Hidden);++a);a==r&&n.push("<Selected/>")}return((((s||{}).Workbook||{}).Views||[])[0]||{}).RTL&&n.push("<DisplayRightToLeft/>"),e["!protect"]&&(n.push(pr("ProtectContents","True")),e["!protect"].objects&&n.push(pr("ProtectObjects","True")),e["!protect"].scenarios&&n.push(pr("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?n.push(pr("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&n.push(pr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(i){e["!protect"][i[0]]&&n.push("<"+i[1]+"/>")})),n.length==0?"":ke("WorksheetOptions",n.join(""),{xmlns:ss.x})}function bz(e){return e.map(function(t){var r=$I(t.t||""),s=ke("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return ke("Comment",s,{"ss:Author":t.a})}).join("")}function _z(e,t,r,s,n,a,i){if(!e||e.v==null&&e.f==null)return"";var l={};if(e.f&&(l["ss:Formula"]="="+ut(eg(e.f,i))),e.F&&e.F.slice(0,t.length)==t){var c=Ft(e.F.slice(t.length+1));l["ss:ArrayRange"]="RC:R"+(c.r==i.r?"":"["+(c.r-i.r)+"]")+"C"+(c.c==i.c?"":"["+(c.c-i.c)+"]")}if(e.l&&e.l.Target&&(l["ss:HRef"]=ut(e.l.Target),e.l.Tooltip&&(l["x:HRefScreenTip"]=ut(e.l.Tooltip))),r["!merges"])for(var u=r["!merges"],d=0;d!=u.length;++d)u[d].s.c!=i.c||u[d].s.r!=i.r||(u[d].e.c>u[d].s.c&&(l["ss:MergeAcross"]=u[d].e.c-u[d].s.c),u[d].e.r>u[d].s.r&&(l["ss:MergeDown"]=u[d].e.r-u[d].s.r));var f="",h="";switch(e.t){case"z":if(!s.sheetStubs)return"";break;case"n":f="Number",h=String(e.v);break;case"b":f="Boolean",h=e.v?"1":"0";break;case"e":f="Error",h=Mn[e.v];break;case"d":f="DateTime",h=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||$e[14]);break;case"s":f="String",h=zI(e.v||"");break}var m=Sa(s.cellXfs,e,s);l["ss:StyleID"]="s"+(21+m),l["ss:Index"]=i.c+1;var x=e.v!=null?h:"",p=e.t=="z"?"":'<Data ss:Type="'+f+'">'+x+"</Data>";return(e.c||[]).length>0&&(p+=bz(e.c)),ke("Cell",p,l)}function Sz(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=_o(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function kz(e,t,r,s){if(!e["!ref"])return"";var n=at(e["!ref"]),a=e["!merges"]||[],i=0,l=[];e["!cols"]&&e["!cols"].forEach(function(g,w){fa(g);var v=!!g.width,y=_0(w,g),b={"ss:Index":w+1};v&&(b["ss:Width"]=hc(y.width)),g.hidden&&(b["ss:Hidden"]="1"),l.push(ke("Column",null,b))});for(var c=Array.isArray(e),u=n.s.r;u<=n.e.r;++u){for(var d=[Sz(u,(e["!rows"]||[])[u])],f=n.s.c;f<=n.e.c;++f){var h=!1;for(i=0;i!=a.length;++i)if(!(a[i].s.c>f)&&!(a[i].s.r>u)&&!(a[i].e.c<f)&&!(a[i].e.r<u)){(a[i].s.c!=f||a[i].s.r!=u)&&(h=!0);break}if(!h){var m={r:u,c:f},x=Ve(m),p=c?(e[u]||[])[f]:e[x];d.push(_z(p,x,e,t,r,s,m))}}d.push("</Row>"),d.length>2&&l.push(d.join(""))}return l.join("")}function Nz(e,t,r){var s=[],n=r.SheetNames[e],a=r.Sheets[n],i=a?yz(a,t,e,r):"";return i.length>0&&s.push("<Names>"+i+"</Names>"),i=a?kz(a,t,e,r):"",i.length>0&&s.push("<Table>"+i+"</Table>"),s.push(wz(a,t,e,r)),s.join("")}function Ez(e,t){t||(t={}),e.SSF||(e.SSF=bt($e)),e.SSF&&(Oo(),p0(e.SSF),t.revssf=g0(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Sa(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(pz(e,t)),r.push(xz()),r.push(""),r.push("");for(var s=0;s<e.SheetNames.length;++s)r.push(ke("Worksheet",Nz(s,t,e),{"ss:Name":ut(e.SheetNames[s])}));return r[2]=gz(e,t),r[3]=vz(e),Vt+ke("Workbook",r.join(""),{xmlns:ss.ss,"xmlns:o":ss.o,"xmlns:x":ss.x,"xmlns:ss":ss.ss,"xmlns:dt":ss.dt,"xmlns:html":ss.html})}function jz(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=vO(r),r.length-r.l<=4)return t;var s=r.read_shift(4);if(s==0||s>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(s=r.read_shift(4),s!==1907505652)||(t.UnicodeClipboardFormat=yO(r),s=r.read_shift(4),s==0||s>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var Tz=[60,1084,2066,2165,2175];function Cz(e,t,r,s,n){var a=s,i=[],l=r.slice(r.l,r.l+a);if(n&&n.enc&&n.enc.insitu&&l.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:n.enc.insitu(l)}i.push(l),r.l+=a;for(var c=Sn(r,r.l),u=Pm[c],d=0;u!=null&&Tz.indexOf(c)>-1;)a=Sn(r,r.l+2),d=r.l+4,c==2066?d+=4:(c==2165||c==2175)&&(d+=12),l=r.slice(d,r.l+4+a),i.push(l),r.l+=4+a,u=Pm[c=Sn(r,r.l)];var f=ir(i);mr(f,0);var h=0;f.lens=[];for(var m=0;m<i.length;++m)f.lens.push(h),h+=i[m].length;if(f.length<s)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+s;return t.f(f,f.length,n)}function rn(e,t,r){if(e.t!=="z"&&e.XF){var s=0;try{s=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=$e[s])}catch(a){if(t.WTF)throw a}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Mn[e.v]:s===0||s=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=oc(e.v):e.w=si(e.v):e.w=Os(s,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(a){if(t.WTF)throw a}if(t.cellDates&&s&&e.t=="n"&&Io($e[s]||String(s))){var n=$a(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}}function Eu(e,t,r){return{v:e,ixfe:t,t:r}}function Az(e,t){var r={opts:{}},s={},n=t.dense?[]:{},a={},i={},l=null,c=[],u="",d={},f,h="",m,x,p,g,w={},v=[],y,b,S=[],_=[],k={Sheets:[],WBProps:{date1904:!1},Views:[{}]},E={},T=function(Fe){return Fe<8?Ga[Fe]:Fe<64&&_[Fe-8]||Ga[Fe]},M=function(Fe,rt,sr){var xt=rt.XF.data;if(!(!xt||!xt.patternType||!sr||!sr.cellStyles)){rt.s={},rt.s.patternType=xt.patternType;var Vr;(Vr=fc(T(xt.icvFore)))&&(rt.s.fgColor={rgb:Vr}),(Vr=fc(T(xt.icvBack)))&&(rt.s.bgColor={rgb:Vr})}},q=function(Fe,rt,sr){if(!(fe>1)&&!(sr.sheetRows&&Fe.r>=sr.sheetRows)){if(sr.cellStyles&&rt.XF&&rt.XF.data&&M(Fe,rt,sr),delete rt.ixfe,delete rt.XF,f=Fe,h=Ve(Fe),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),Fe.r<i.s.r&&(i.s.r=Fe.r),Fe.c<i.s.c&&(i.s.c=Fe.c),Fe.r+1>i.e.r&&(i.e.r=Fe.r+1),Fe.c+1>i.e.c&&(i.e.c=Fe.c+1),sr.cellFormula&&rt.f){for(var xt=0;xt<v.length;++xt)if(!(v[xt][0].s.c>Fe.c||v[xt][0].s.r>Fe.r)&&!(v[xt][0].e.c<Fe.c||v[xt][0].e.r<Fe.r)){rt.F=Ke(v[xt][0]),(v[xt][0].s.c!=Fe.c||v[xt][0].s.r!=Fe.r)&&delete rt.f,rt.f&&(rt.f=""+Sr(v[xt][1],i,Fe,B,D));break}}sr.dense?(n[Fe.r]||(n[Fe.r]=[]),n[Fe.r][Fe.c]=rt):n[h]=rt}},D={enc:!1,sbcch:0,snames:[],sharedf:w,arrayf:v,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(D.password=t.password);var W,ee=[],Y=[],G=[],ce=[],Q=!1,B=[];B.SheetNames=D.snames,B.sharedf=D.sharedf,B.arrayf=D.arrayf,B.names=[],B.XTI=[];var me=0,fe=0,A=0,V=[],L=[],U;D.codepage=1200,Gs(1200);for(var ne=!1;e.l<e.length-1;){var xe=e.l,pe=e.read_shift(2);if(pe===0&&me===10)break;var oe=e.l===e.length?0:e.read_shift(2),ue=Pm[pe];if(ue&&ue.f){if(t.bookSheets&&me===133&&pe!==133)break;if(me=pe,ue.r===2||ue.r==12){var we=e.read_shift(2);if(oe-=2,!D.enc&&we!==pe&&((we&255)<<8|we>>8)!==pe)throw new Error("rt mismatch: "+we+"!="+pe);ue.r==12&&(e.l+=10,oe-=10)}var P={};if(pe===10?P=ue.f(e,oe,D):P=Cz(pe,ue,e,oe,D),fe==0&&[9,521,1033,2057].indexOf(me)===-1)continue;switch(pe){case 34:r.opts.Date1904=k.WBProps.date1904=P;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(D.enc||(e.l=0),D.enc=P,!t.password)throw new Error("File is password-protected");if(P.valid==null)throw new Error("Encryption scheme unsupported");if(!P.valid)throw new Error("Password is incorrect");break;case 92:D.lastuser=P;break;case 66:var Me=Number(P);switch(Me){case 21010:Me=1200;break;case 32768:Me=1e4;break;case 32769:Me=1252;break}Gs(D.codepage=Me),ne=!0;break;case 317:D.rrtabid=P;break;case 25:D.winlocked=P;break;case 439:r.opts.RefreshAll=P;break;case 12:r.opts.CalcCount=P;break;case 16:r.opts.CalcDelta=P;break;case 17:r.opts.CalcIter=P;break;case 13:r.opts.CalcMode=P;break;case 14:r.opts.CalcPrecision=P;break;case 95:r.opts.CalcSaveRecalc=P;break;case 15:D.CalcRefMode=P;break;case 2211:r.opts.FullCalc=P;break;case 129:P.fDialog&&(n["!type"]="dialog"),P.fBelow||((n["!outline"]||(n["!outline"]={})).above=!0),P.fRight||((n["!outline"]||(n["!outline"]={})).left=!0);break;case 224:S.push(P);break;case 430:B.push([P]),B[B.length-1].XTI=[];break;case 35:case 547:B[B.length-1].push(P);break;case 24:case 536:U={Name:P.Name,Ref:Sr(P.rgce,i,null,B,D)},P.itab>0&&(U.Sheet=P.itab-1),B.names.push(U),B[0]||(B[0]=[],B[0].XTI=[]),B[B.length-1].push(P),P.Name=="_xlnm._FilterDatabase"&&P.itab>0&&P.rgce&&P.rgce[0]&&P.rgce[0][0]&&P.rgce[0][0][0]=="PtgArea3d"&&(L[P.itab-1]={ref:Ke(P.rgce[0][0][1][2])});break;case 22:D.ExternCount=P;break;case 23:B.length==0&&(B[0]=[],B[0].XTI=[]),B[B.length-1].XTI=B[B.length-1].XTI.concat(P),B.XTI=B.XTI.concat(P);break;case 2196:if(D.biff<8)break;U!=null&&(U.Comment=P[1]);break;case 18:n["!protect"]=P;break;case 19:P!==0&&D.WTF&&console.error("Password verifier: "+P);break;case 133:a[P.pos]=P,D.snames.push(P.name);break;case 10:{if(--fe)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,n["!ref"]=Ke(i),t.sheetRows&&t.sheetRows<=i.e.r){var je=i.e.r;i.e.r=t.sheetRows-1,n["!fullref"]=n["!ref"],n["!ref"]=Ke(i),i.e.r=je}i.e.r++,i.e.c++}ee.length>0&&(n["!merges"]=ee),Y.length>0&&(n["!objects"]=Y),G.length>0&&(n["!cols"]=G),ce.length>0&&(n["!rows"]=ce),k.Sheets.push(E)}u===""?d=n:s[u]=n,n=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(D.biff===8&&(D.biff={9:2,521:3,1033:4}[pe]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[P.BIFFVer]||8),D.biffguess=P.BIFFVer==0,P.BIFFVer==0&&P.dt==4096&&(D.biff=5,ne=!0,Gs(D.codepage=28591)),D.biff==8&&P.BIFFVer==0&&P.dt==16&&(D.biff=2),fe++)break;if(n=t.dense?[]:{},D.biff<8&&!ne&&(ne=!0,Gs(D.codepage=t.codepage||1252)),D.biff<5||P.BIFFVer==0&&P.dt==4096){u===""&&(u="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var X={pos:e.l-oe,name:u};a[X.pos]=X,D.snames.push(u)}else u=(a[xe]||{name:""}).name;P.dt==32&&(n["!type"]="chart"),P.dt==64&&(n["!type"]="macro"),ee=[],Y=[],D.arrayf=v=[],G=[],ce=[],Q=!1,E={Hidden:(a[xe]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:n["!type"]=="chart"&&(t.dense?(n[P.r]||[])[P.c]:n[Ve({c:P.c,r:P.r})])&&++P.c,y={ixfe:P.ixfe,XF:S[P.ixfe]||{},v:P.val,t:"n"},A>0&&(y.z=V[y.ixfe>>8&63]),rn(y,t,r.opts.Date1904),q({c:P.c,r:P.r},y,t);break;case 5:case 517:y={ixfe:P.ixfe,XF:S[P.ixfe],v:P.val,t:P.t},A>0&&(y.z=V[y.ixfe>>8&63]),rn(y,t,r.opts.Date1904),q({c:P.c,r:P.r},y,t);break;case 638:y={ixfe:P.ixfe,XF:S[P.ixfe],v:P.rknum,t:"n"},A>0&&(y.z=V[y.ixfe>>8&63]),rn(y,t,r.opts.Date1904),q({c:P.c,r:P.r},y,t);break;case 189:for(var z=P.c;z<=P.C;++z){var H=P.rkrec[z-P.c][0];y={ixfe:H,XF:S[H],v:P.rkrec[z-P.c][1],t:"n"},A>0&&(y.z=V[y.ixfe>>8&63]),rn(y,t,r.opts.Date1904),q({c:z,r:P.r},y,t)}break;case 6:case 518:case 1030:{if(P.val=="String"){l=P;break}if(y=Eu(P.val,P.cell.ixfe,P.tt),y.XF=S[y.ixfe],t.cellFormula){var Z=P.formula;if(Z&&Z[0]&&Z[0][0]&&Z[0][0][0]=="PtgExp"){var J=Z[0][0][1][0],K=Z[0][0][1][1],le=Ve({r:J,c:K});w[le]?y.f=""+Sr(P.formula,i,P.cell,B,D):y.F=((t.dense?(n[J]||[])[K]:n[le])||{}).F}else y.f=""+Sr(P.formula,i,P.cell,B,D)}A>0&&(y.z=V[y.ixfe>>8&63]),rn(y,t,r.opts.Date1904),q(P.cell,y,t),l=P}break;case 7:case 519:if(l)l.val=P,y=Eu(P,l.cell.ixfe,"s"),y.XF=S[y.ixfe],t.cellFormula&&(y.f=""+Sr(l.formula,i,l.cell,B,D)),A>0&&(y.z=V[y.ixfe>>8&63]),rn(y,t,r.opts.Date1904),q(l.cell,y,t),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{v.push(P);var ye=Ve(P[0].s);if(m=t.dense?(n[P[0].s.r]||[])[P[0].s.c]:n[ye],t.cellFormula&&m){if(!l||!ye||!m)break;m.f=""+Sr(P[1],i,P[0],B,D),m.F=Ke(P[0])}}break;case 1212:{if(!t.cellFormula)break;if(h){if(!l)break;w[Ve(l.cell)]=P[0],m=t.dense?(n[l.cell.r]||[])[l.cell.c]:n[Ve(l.cell)],(m||{}).f=""+Sr(P[0],i,f,B,D)}}break;case 253:y=Eu(c[P.isst].t,P.ixfe,"s"),c[P.isst].h&&(y.h=c[P.isst].h),y.XF=S[y.ixfe],A>0&&(y.z=V[y.ixfe>>8&63]),rn(y,t,r.opts.Date1904),q({c:P.c,r:P.r},y,t);break;case 513:t.sheetStubs&&(y={ixfe:P.ixfe,XF:S[P.ixfe],t:"z"},A>0&&(y.z=V[y.ixfe>>8&63]),rn(y,t,r.opts.Date1904),q({c:P.c,r:P.r},y,t));break;case 190:if(t.sheetStubs)for(var Re=P.c;Re<=P.C;++Re){var Te=P.ixfe[Re-P.c];y={ixfe:Te,XF:S[Te],t:"z"},A>0&&(y.z=V[y.ixfe>>8&63]),rn(y,t,r.opts.Date1904),q({c:Re,r:P.r},y,t)}break;case 214:case 516:case 4:y=Eu(P.val,P.ixfe,"s"),y.XF=S[y.ixfe],A>0&&(y.z=V[y.ixfe>>8&63]),rn(y,t,r.opts.Date1904),q({c:P.c,r:P.r},y,t);break;case 0:case 512:fe===1&&(i=P);break;case 252:c=P;break;case 1054:if(D.biff==4){V[A++]=P[1];for(var Ue=0;Ue<A+163&&$e[Ue]!=P[1];++Ue);Ue>=163&&En(P[1],A+163)}else En(P[1],P[0]);break;case 30:{V[A++]=P;for(var it=0;it<A+163&&$e[it]!=P;++it);it>=163&&En(P,A+163)}break;case 229:ee=ee.concat(P);break;case 93:Y[P.cmo[0]]=D.lastobj=P;break;case 438:D.lastobj.TxO=P;break;case 127:D.lastobj.ImData=P;break;case 440:for(g=P[0].s.r;g<=P[0].e.r;++g)for(p=P[0].s.c;p<=P[0].e.c;++p)m=t.dense?(n[g]||[])[p]:n[Ve({c:p,r:g})],m&&(m.l=P[1]);break;case 2048:for(g=P[0].s.r;g<=P[0].e.r;++g)for(p=P[0].s.c;p<=P[0].e.c;++p)m=t.dense?(n[g]||[])[p]:n[Ve({c:p,r:g})],m&&m.l&&(m.l.Tooltip=P[1]);break;case 28:{if(D.biff<=5&&D.biff>=2)break;m=t.dense?(n[P[0].r]||[])[P[0].c]:n[Ve(P[0])];var pt=Y[P[2]];m||(t.dense?(n[P[0].r]||(n[P[0].r]=[]),m=n[P[0].r][P[0].c]={t:"z"}):m=n[Ve(P[0])]={t:"z"},i.e.r=Math.max(i.e.r,P[0].r),i.s.r=Math.min(i.s.r,P[0].r),i.e.c=Math.max(i.e.c,P[0].c),i.s.c=Math.min(i.s.c,P[0].c)),m.c||(m.c=[]),x={a:P[1],t:pt.TxO.t},m.c.push(x)}break;case 2173:gM(S[P.ixfe],P.ext);break;case 125:{if(!D.cellStyles)break;for(;P.e>=P.s;)G[P.e--]={width:P.w/256,level:P.level||0,hidden:!!(P.flags&1)},Q||(Q=!0,Yx(P.w/256)),fa(G[P.e+1])}break;case 520:{var tt={};P.level!=null&&(ce[P.r]=tt,tt.level=P.level),P.hidden&&(ce[P.r]=tt,tt.hidden=!0),P.hpt&&(ce[P.r]=tt,tt.hpt=P.hpt,tt.hpx=_o(P.hpt))}break;case 38:case 39:case 40:case 41:n["!margins"]||Qa(n["!margins"]={}),n["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[pe]]=P;break;case 161:n["!margins"]||Qa(n["!margins"]={}),n["!margins"].header=P.header,n["!margins"].footer=P.footer;break;case 574:P.RTL&&(k.Views[0].RTL=!0);break;case 146:_=P;break;case 2198:W=P;break;case 140:b=P;break;case 442:u?E.CodeName=P||E.name:k.WBProps.CodeName=P||"ThisWorkbook";break}}else ue||console.error("Missing Info for XLS Record 0x"+pe.toString(16)),e.l+=oe}return r.SheetNames=Mt(a).sort(function(Ce,Fe){return Number(Ce)-Number(Fe)}).map(function(Ce){return a[Ce].name}),t.bookSheets||(r.Sheets=s),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&L.forEach(function(Ce,Fe){r.Sheets[r.SheetNames[Fe]]["!autofilter"]=Ce}),r.Strings=c,r.SSF=bt($e),D.enc&&(r.Encryption=D.enc),W&&(r.Themes=W),r.Metadata={},b!==void 0&&(r.Metadata.Country=b),B.names.length>0&&(k.Names=B.names),r.Workbook=k,r}var Al={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Fz(e,t,r){var s=Be.find(e,"/!DocumentSummaryInformation");if(s&&s.size>0)try{var n=ew(s,Nm,Al.DSI);for(var a in n)t[a]=n[a]}catch(u){if(r.WTF)throw u}var i=Be.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var l=ew(i,Em,Al.SI);for(var c in l)t[c]==null&&(t[c]=l[c])}catch(u){if(r.WTF)throw u}t.HeadingPairs&&t.TitlesOfParts&&(RN(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function Pz(e,t){var r=[],s=[],n=[],a=0,i,l=A1(Nm,"n"),c=A1(Em,"n");if(e.Props)for(i=Mt(e.Props),a=0;a<i.length;++a)(Object.prototype.hasOwnProperty.call(l,i[a])?r:Object.prototype.hasOwnProperty.call(c,i[a])?s:n).push([i[a],e.Props[i[a]]]);if(e.Custprops)for(i=Mt(e.Custprops),a=0;a<i.length;++a)Object.prototype.hasOwnProperty.call(e.Props||{},i[a])||(Object.prototype.hasOwnProperty.call(l,i[a])?r:Object.prototype.hasOwnProperty.call(c,i[a])?s:n).push([i[a],e.Custprops[i[a]]]);var u=[];for(a=0;a<n.length;++a)UN.indexOf(n[a][0])>-1||PN.indexOf(n[a][0])>-1||n[a][1]!=null&&u.push(n[a]);s.length&&Be.utils.cfb_add(t,"/SummaryInformation",tw(s,Al.SI,c,Em)),(r.length||u.length)&&Be.utils.cfb_add(t,"/DocumentSummaryInformation",tw(r,Al.DSI,l,Nm,u.length?u:null,Al.UDI))}function OE(e,t){t||(t={}),ig(t),jx(),t.codepage&&Ex(t.codepage);var r,s;if(e.FullPaths){if(Be.find(e,"/encryption"))throw new Error("File is password-protected");r=Be.find(e,"!CompObj"),s=Be.find(e,"/Workbook")||Be.find(e,"/Book")}else{switch(t.type){case"base64":e=os(fs(e));break;case"binary":e=os(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}mr(e,0),s={content:e}}var n,a;if(r&&jz(r),t.bookProps&&!t.bookSheets)n={};else{var i=Qe?"buffer":"array";if(s&&s.content)n=Az(s.content,t);else if((a=Be.find(e,"PerfectOffice_MAIN"))&&a.content)n=Xa.to_workbook(a.content,(t.type=i,t));else if((a=Be.find(e,"NativeContent_MAIN"))&&a.content)n=Xa.to_workbook(a.content,(t.type=i,t));else throw(a=Be.find(e,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Be.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(n.vbaraw=qM(e))}var l={};return e.FullPaths&&Fz(e,l,t),n.Props=n.Custprops=l,t.bookFiles&&(n.cfb=e),n}function Rz(e,t){var r=t||{},s=Be.utils.cfb_new({root:"R"}),n="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":n="/Workbook",r.biff=8;break;case"biff5":n="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Be.utils.cfb_add(s,n,DE(e,r)),r.biff==8&&(e.Props||e.Custprops)&&Pz(e,s),r.biff==8&&e.vbaraw&&HM(s,Be.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),s}var xc={0:{f:sB},1:{f:dB},2:{f:AB},3:{f:yB},4:{f:pB},5:{f:jB},6:{f:OB},7:{f:SB},8:{f:$B},9:{f:zB},10:{f:BB},11:{f:UB},12:{f:hB},13:{f:PB},14:{f:bB},15:{f:gB},16:{f:jE},17:{f:LB},18:{f:NB},19:{f:zx},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:LU},40:{},42:{},43:{f:OL},44:{f:RL},45:{f:ML},46:{f:UL},47:{f:BL},48:{},49:{f:iO},50:{},51:{f:wM},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:YN},62:{f:IB},63:{f:CM},64:{f:nU},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Fr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:eU},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:cB},148:{f:iB,p:16},151:{f:KB},152:{},153:{f:IU},154:{},155:{},156:{f:PU},157:{},158:{},159:{T:1,f:Q8},160:{T:-1},161:{T:1,f:pi},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:VB},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:vM},336:{T:-1},337:{f:SM,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:km},357:{},358:{},359:{},360:{T:1},361:{},362:{f:QN},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:XB},427:{f:QB},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:JB},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:lB},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:HB},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:km},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:UM},633:{T:1},634:{T:-1},635:{T:1,f:MM},636:{T:-1},637:{f:uO},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:bU},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:aU},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Pm={6:{f:Df},10:{f:zn},12:{f:Gt},13:{f:Gt},14:{f:Bt},15:{f:Bt},16:{f:Er},17:{f:Bt},18:{f:Bt},19:{f:Gt},20:{f:ow},21:{f:ow},23:{f:QN},24:{f:cw},25:{f:Bt},26:{},27:{},28:{f:a8},29:{},34:{f:Bt},35:{f:lw},38:{f:Er},39:{f:Er},40:{f:Er},41:{f:Er},42:{f:Bt},43:{f:Bt},47:{f:gL},49:{f:PD},51:{f:Gt},60:{},61:{f:jD},64:{f:Bt},65:{f:FD},66:{f:Gt},77:{},80:{},81:{},82:{},85:{f:Gt},89:{},90:{},91:{},92:{f:xD},93:{f:l8},94:{},95:{f:Bt},96:{},97:{},99:{f:Bt},125:{f:YN},128:{f:GD},129:{f:vD},130:{f:Gt},131:{f:Bt},132:{f:Bt},133:{f:yD},134:{},140:{f:x8},141:{f:Gt},144:{},146:{f:y8},151:{},152:{},153:{},154:{},155:{},156:{f:Gt},157:{},158:{},160:{f:E8},161:{f:_8},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:VD},190:{f:WD},193:{f:zn},197:{},198:{},199:{},200:{},201:{},202:{f:Bt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Gt},220:{},221:{f:Bt},222:{},224:{f:HD},225:{f:pD},226:{f:zn},227:{},229:{f:i8},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:bD},253:{f:ID},255:{f:SD},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:zN},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Bt},353:{f:zn},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:JD},431:{f:Bt},432:{},433:{},434:{},437:{},438:{f:d8},439:{f:Bt},440:{f:f8},441:{},442:{f:Rc},443:{},444:{f:Gt},445:{},446:{},448:{f:zn},449:{f:ED,r:2},450:{f:zn},512:{f:nw},513:{f:N8},515:{f:QD},516:{f:DD},517:{f:iw},519:{f:j8},520:{f:kD},523:{},545:{f:uw},549:{f:sw},566:{},574:{f:CD},638:{f:$D},659:{},1048:{},1054:{f:MD},1084:{},1212:{f:r8},2048:{f:m8},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Su},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:zn},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:w8,r:12},2173:{f:xM,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Bt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:t8,r:12},2197:{},2198:{f:uM,r:12},2199:{},2200:{},2201:{},2202:{f:s8,r:12},2203:{f:zn},2204:{},2205:{},2206:{},2207:{},2211:{f:ND},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Gt},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:S8},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:v8},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:nw},1:{},2:{f:P8},3:{f:A8},4:{f:C8},5:{f:iw},7:{f:I8},8:{},9:{f:Su},11:{},22:{f:Gt},30:{f:UD},31:{},32:{},33:{f:uw},36:{},37:{f:sw},50:{f:O8},62:{},52:{},67:{},68:{f:Gt},69:{},86:{},126:{},127:{f:T8},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:D8},223:{},234:{},354:{},421:{},518:{f:Df},521:{f:Su},536:{f:cw},547:{f:lw},561:{},579:{},1030:{f:Df},1033:{f:Su},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ne(e,t,r,s){var n=t;if(!isNaN(n)){var a=s||(r||[]).length||0,i=e.next(4);i.write_shift(2,n),i.write_shift(2,a),a>0&&Mx(r)&&e.push(r)}}function Iz(e,t,r,s){var n=(r||[]).length||0;if(n<=8224)return Ne(e,t,r,n);var a=t;if(!isNaN(a)){for(var i=r.parts||[],l=0,c=0,u=0;u+(i[l]||8224)<=8224;)u+=i[l]||8224,l++;var d=e.next(4);for(d.write_shift(2,a),d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u;c<n;){for(d=e.next(4),d.write_shift(2,60),u=0;u+(i[l]||8224)<=8224;)u+=i[l]||8224,l++;d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u}}}function Lc(e,t,r){return e||(e=de(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function Oz(e,t,r,s){var n=de(9);return Lc(n,e,t),$N(r,s||"b",n),n}function Dz(e,t,r){var s=de(8+2*r.length);return Lc(s,e,t),s.write_shift(1,r.length),s.write_shift(r.length,r,"sbcs"),s.l<s.length?s.slice(0,s.l):s}function Lz(e,t,r,s){if(t.v!=null)switch(t.t){case"d":case"n":var n=t.t=="d"?rr(wt(t.v)):t.v;n==(n|0)&&n>=0&&n<65536?Ne(e,2,R8(r,s,n)):Ne(e,3,F8(r,s,n));return;case"b":case"e":Ne(e,5,Oz(r,s,t.v,t.t));return;case"s":case"str":Ne(e,4,Dz(r,s,(t.v||"").slice(0,255)));return}Ne(e,1,Lc(null,r,s))}function Mz(e,t,r,s){var n=Array.isArray(t),a=at(t["!ref"]||"A1"),i,l="",c=[];if(a.e.c>255||a.e.r>16383){if(s.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.c,16383),i=Ke(a)}for(var u=a.s.r;u<=a.e.r;++u){l=$t(u);for(var d=a.s.c;d<=a.e.c;++d){u===a.s.r&&(c[d]=At(d)),i=c[d]+l;var f=n?(t[u]||[])[d]:t[i];f&&Lz(e,f,u,d)}}}function Bz(e,t){for(var r=t||{},s=Jr(),n=0,a=0;a<e.SheetNames.length;++a)e.SheetNames[a]==r.sheet&&(n=a);if(n==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Ne(s,r.biff==4?1033:r.biff==3?521:9,Kx(e,16,r)),Mz(s,e.Sheets[e.SheetNames[n]],n,r),Ne(s,10),s.end()}function Uz(e,t,r){Ne(e,49,RD({sz:12,name:"Arial"},r))}function zz(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var n=s[0];n<=s[1];++n)t[n]!=null&&Ne(e,1054,BD(n,t[n],r))})}function $z(e,t){var r=de(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Ne(e,2151,r),r=de(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),GN(at(t["!ref"]||"A1"),r),r.write_shift(4,4),Ne(e,2152,r)}function Vz(e,t){for(var r=0;r<16;++r)Ne(e,224,aw({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(s){Ne(e,224,aw(s,0,t))})}function Wz(e,t){for(var r=0;r<t["!links"].length;++r){var s=t["!links"][r];Ne(e,440,h8(s)),s[1].Tooltip&&Ne(e,2048,p8(s))}delete t["!links"]}function qz(e,t){if(t){var r=0;t.forEach(function(s,n){++r<=256&&s&&Ne(e,125,b8(_0(n,s),n))})}}function Hz(e,t,r,s,n){var a=16+Sa(n.cellXfs,t,n);if(t.v==null&&!t.bf){Ne(e,513,oi(r,s,a));return}if(t.bf)Ne(e,6,v7(t,r,s,n,a));else switch(t.t){case"d":case"n":var i=t.t=="d"?rr(wt(t.v)):t.v;Ne(e,515,YD(r,s,i,a));break;case"b":case"e":Ne(e,517,XD(r,s,t.v,a,n,t.t));break;case"s":case"str":if(n.bookSST){var l=rg(n.Strings,t.v,n.revStrings);Ne(e,253,OD(r,s,l,a))}else Ne(e,516,LD(r,s,(t.v||"").slice(0,255),a,n));break;default:Ne(e,513,oi(r,s,a))}}function Gz(e,t,r){var s=Jr(),n=r.SheetNames[e],a=r.Sheets[n]||{},i=(r||{}).Workbook||{},l=(i.Sheets||[])[e]||{},c=Array.isArray(a),u=t.biff==8,d,f="",h=[],m=at(a["!ref"]||"A1"),x=u?65536:16384;if(m.e.c>255||m.e.r>=x){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");m.e.c=Math.min(m.e.c,255),m.e.r=Math.min(m.e.c,x-1)}Ne(s,2057,Kx(r,16,t)),Ne(s,13,ks(1)),Ne(s,12,ks(100)),Ne(s,15,Dr(!0)),Ne(s,17,Dr(!1)),Ne(s,16,ai(.001)),Ne(s,95,Dr(!0)),Ne(s,42,Dr(!1)),Ne(s,43,Dr(!1)),Ne(s,130,ks(1)),Ne(s,128,KD()),Ne(s,131,Dr(!1)),Ne(s,132,Dr(!1)),u&&qz(s,a["!cols"]),Ne(s,512,zD(m,t)),u&&(a["!links"]=[]);for(var p=m.s.r;p<=m.e.r;++p){f=$t(p);for(var g=m.s.c;g<=m.e.c;++g){p===m.s.r&&(h[g]=At(g)),d=h[g]+f;var w=c?(a[p]||[])[g]:a[d];w&&(Hz(s,w,p,g,t),u&&w.l&&a["!links"].push([d,w.l]))}}var v=l.CodeName||l.name||n;return u&&Ne(s,574,AD((i.Views||[])[0])),u&&(a["!merges"]||[]).length&&Ne(s,229,o8(a["!merges"])),u&&Wz(s,a),Ne(s,442,VN(v)),u&&$z(s,a),Ne(s,10),s.end()}function Kz(e,t,r){var s=Jr(),n=(e||{}).Workbook||{},a=n.Sheets||[],i=n.WBProps||{},l=r.biff==8,c=r.biff==5;if(Ne(s,2057,Kx(e,5,r)),r.bookType=="xla"&&Ne(s,135),Ne(s,225,l?ks(1200):null),Ne(s,193,XO(2)),c&&Ne(s,191),c&&Ne(s,192),Ne(s,226),Ne(s,92,gD("SheetJS",r)),Ne(s,66,ks(l?1200:1252)),l&&Ne(s,353,ks(0)),l&&Ne(s,448),Ne(s,317,k8(e.SheetNames.length)),l&&e.vbaraw&&Ne(s,211),l&&e.vbaraw){var u=i.CodeName||"ThisWorkbook";Ne(s,442,VN(u))}Ne(s,156,ks(17)),Ne(s,25,Dr(!1)),Ne(s,18,Dr(!1)),Ne(s,19,ks(0)),l&&Ne(s,431,Dr(!1)),l&&Ne(s,444,ks(0)),Ne(s,61,TD()),Ne(s,64,Dr(!1)),Ne(s,141,ks(0)),Ne(s,34,Dr(EU(e)=="true")),Ne(s,14,Dr(!0)),l&&Ne(s,439,Dr(!1)),Ne(s,218,ks(0)),Uz(s,e,r),zz(s,e.SSF,r),Vz(s,r),l&&Ne(s,352,Dr(!1));var d=s.end(),f=Jr();l&&Ne(f,140,g8()),l&&r.Strings&&Iz(f,252,_D(r.Strings)),Ne(f,10);var h=f.end(),m=Jr(),x=0,p=0;for(p=0;p<e.SheetNames.length;++p)x+=(l?12:11)+(l?2:1)*e.SheetNames[p].length;var g=d.length+x+h.length;for(p=0;p<e.SheetNames.length;++p){var w=a[p]||{};Ne(m,133,wD({pos:g,hs:w.Hidden||0,dt:0,name:e.SheetNames[p]},r)),g+=t[p].length}var v=m.end();if(x!=v.length)throw new Error("BS8 "+x+" != "+v.length);var y=[];return d.length&&y.push(d),v.length&&y.push(v),h.length&&y.push(h),ir(y)}function Xz(e,t){var r=t||{},s=[];e&&!e.SSF&&(e.SSF=bt($e)),e&&e.SSF&&(Oo(),p0(e.SSF),r.revssf=g0(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,og(r),r.cellXfs=[],Sa(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var n=0;n<e.SheetNames.length;++n)s[s.length]=Gz(n,r,e);return s.unshift(Kz(e,s,r)),ir(s)}function DE(e,t){for(var r=0;r<=e.SheetNames.length;++r){var s=e.Sheets[e.SheetNames[r]];if(!(!s||!s["!ref"])){var n=Zr(s["!ref"]);n.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var a=t||{};switch(a.biff||2){case 8:case 5:return Xz(e,t);case 4:case 3:case 2:return Bz(e,t)}throw new Error("invalid type "+a.bookType+" for BIFF")}function ww(e,t){var r=t||{},s=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var n=e.match(/<table/i);if(!n)throw new Error("Invalid HTML: could not find <table>");var a=e.match(/<\/table/i),i=n.index,l=a&&a.index||e.length,c=RI(e.slice(i,l),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,d=0,f=0,h=0,m={s:{r:1e7,c:1e7},e:{r:0,c:0}},x=[];for(i=0;i<c.length;++i){var p=c[i].trim(),g=p.slice(0,3).toLowerCase();if(g=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}d=0;continue}if(!(g!="<td"&&g!="<th")){var w=p.split(/<\/t[dh]>/i);for(l=0;l<w.length;++l){var v=w[l].trim();if(v.match(/<t[dh]/i)){for(var y=v,b=0;y.charAt(0)=="<"&&(b=y.indexOf(">"))>-1;)y=y.slice(b+1);for(var S=0;S<x.length;++S){var _=x[S];_.s.c==d&&_.s.r<u&&u<=_.e.r&&(d=_.e.c+1,S=-1)}var k=qe(v.slice(0,v.indexOf(">")));h=k.colspan?+k.colspan:1,((f=+k.rowspan)>1||h>1)&&x.push({s:{r:u,c:d},e:{r:u+(f||1)-1,c:d+h-1}});var E=k.t||k["data-t"]||"";if(!y.length){d+=h;continue}if(y=iN(y),m.s.r>u&&(m.s.r=u),m.e.r<u&&(m.e.r=u),m.s.c>d&&(m.s.c=d),m.e.c<d&&(m.e.c=d),!y.length){d+=h;continue}var T={t:"s",v:y};r.raw||!y.trim().length||E=="s"||(y==="TRUE"?T={t:"b",v:!0}:y==="FALSE"?T={t:"b",v:!1}:isNaN(Ys(y))?isNaN(wo(y).getDate())||(T={t:"d",v:wt(y)},r.cellDates||(T={t:"n",v:rr(T.v)}),T.z=r.dateNF||$e[14]):T={t:"n",v:Ys(y)}),r.dense?(s[u]||(s[u]=[]),s[u][d]=T):s[Ve({r:u,c:d})]=T,d+=h}}}}return s["!ref"]=Ke(m),x.length&&(s["!merges"]=x),s}function Qz(e,t,r,s){for(var n=e["!merges"]||[],a=[],i=t.s.c;i<=t.e.c;++i){for(var l=0,c=0,u=0;u<n.length;++u)if(!(n[u].s.r>r||n[u].s.c>i)&&!(n[u].e.r<r||n[u].e.c<i)){if(n[u].s.r<r||n[u].s.c<i){l=-1;break}l=n[u].e.r-n[u].s.r+1,c=n[u].e.c-n[u].s.c+1;break}if(!(l<0)){var d=Ve({r,c:i}),f=s.dense?(e[r]||[])[i]:e[d],h=f&&f.v!=null&&(f.h||Ox(f.w||(In(f),f.w)||""))||"",m={};l>1&&(m.rowspan=l),c>1&&(m.colspan=c),s.editable?h='<span contenteditable="true">'+h+"</span>":f&&(m["data-t"]=f&&f.t||"z",f.v!=null&&(m["data-v"]=f.v),f.z!=null&&(m["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+f.l.Target+'">'+h+"</a>")),m.id=(s.id||"sjs")+"-"+d,a.push(ke("td",h,m))}}var x="<tr>";return x+a.join("")+"</tr>"}var Yz='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Jz="</body></html>";function Zz(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return _a(ww(r[0],t),t);var s=ug();return r.forEach(function(n,a){dg(s,ww(n,t),"Sheet"+(a+1))}),s}function e$(e,t,r){var s=[];return s.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function LE(e,t){var r=t||{},s=r.header!=null?r.header:Yz,n=r.footer!=null?r.footer:Jz,a=[s],i=Zr(e["!ref"]);r.dense=Array.isArray(e),a.push(e$(e,i,r));for(var l=i.s.r;l<=i.e.r;++l)a.push(Qz(e,i,l,r));return a.push("</table>"+n),a.join("")}function ME(e,t,r){var s=r||{},n=0,a=0;if(s.origin!=null)if(typeof s.origin=="number")n=s.origin;else{var i=typeof s.origin=="string"?Ft(s.origin):s.origin;n=i.r,a=i.c}var l=t.getElementsByTagName("tr"),c=Math.min(s.sheetRows||1e7,l.length),u={s:{r:0,c:0},e:{r:n,c:a}};if(e["!ref"]){var d=Zr(e["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),n==-1&&(u.e.r=n=d.e.r+1)}var f=[],h=0,m=e["!rows"]||(e["!rows"]=[]),x=0,p=0,g=0,w=0,v=0,y=0;for(e["!cols"]||(e["!cols"]=[]);x<l.length&&p<c;++x){var b=l[x];if(bw(b)){if(s.display)continue;m[p]={hidden:!0}}var S=b.children;for(g=w=0;g<S.length;++g){var _=S[g];if(!(s.display&&bw(_))){var k=_.hasAttribute("data-v")?_.getAttribute("data-v"):_.hasAttribute("v")?_.getAttribute("v"):iN(_.innerHTML),E=_.getAttribute("data-z")||_.getAttribute("z");for(h=0;h<f.length;++h){var T=f[h];T.s.c==w+a&&T.s.r<p+n&&p+n<=T.e.r&&(w=T.e.c+1-a,h=-1)}y=+_.getAttribute("colspan")||1,((v=+_.getAttribute("rowspan")||1)>1||y>1)&&f.push({s:{r:p+n,c:w+a},e:{r:p+n+(v||1)-1,c:w+a+(y||1)-1}});var M={t:"s",v:k},q=_.getAttribute("data-t")||_.getAttribute("t")||"";k!=null&&(k.length==0?M.t=q||"z":s.raw||k.trim().length==0||q=="s"||(k==="TRUE"?M={t:"b",v:!0}:k==="FALSE"?M={t:"b",v:!1}:isNaN(Ys(k))?isNaN(wo(k).getDate())||(M={t:"d",v:wt(k)},s.cellDates||(M={t:"n",v:rr(M.v)}),M.z=s.dateNF||$e[14]):M={t:"n",v:Ys(k)})),M.z===void 0&&E!=null&&(M.z=E);var D="",W=_.getElementsByTagName("A");if(W&&W.length)for(var ee=0;ee<W.length&&!(W[ee].hasAttribute("href")&&(D=W[ee].getAttribute("href"),D.charAt(0)!="#"));++ee);D&&D.charAt(0)!="#"&&(M.l={Target:D}),s.dense?(e[p+n]||(e[p+n]=[]),e[p+n][w+a]=M):e[Ve({c:w+a,r:p+n})]=M,u.e.c<w+a&&(u.e.c=w+a),w+=y}}++p}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),u.e.r=Math.max(u.e.r,p-1+n),e["!ref"]=Ke(u),p>=c&&(e["!fullref"]=Ke((u.e.r=l.length-x+p-1+n,u))),e}function BE(e,t){var r=t||{},s=r.dense?[]:{};return ME(s,e,t)}function t$(e,t){return _a(BE(e,t),t)}function bw(e){var t="",r=r$(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function r$(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function s$(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(s,n){return Array(parseInt(n,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=nt(t.replace(/<[^>]*>/g,""));return[r]}var _w={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function UE(e,t){var r=t||{},s=Dx(e),n=[],a,i,l={name:""},c="",u=0,d,f,h={},m=[],x=r.dense?[]:{},p,g,w={value:""},v="",y=0,b=[],S=-1,_=-1,k={s:{r:1e6,c:1e7},e:{r:0,c:0}},E=0,T={},M=[],q={},D=0,W=0,ee=[],Y=1,G=1,ce=[],Q={Names:[]},B={},me=["",""],fe=[],A={},V="",L=0,U=!1,ne=!1,xe=0;for(uc.lastIndex=0,s=s.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");p=uc.exec(s);)switch(p[3]=p[3].replace(/_.*$/,"")){case"table":case"":p[1]==="/"?(k.e.c>=k.s.c&&k.e.r>=k.s.r?x["!ref"]=Ke(k):x["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=k.e.r&&(x["!fullref"]=x["!ref"],k.e.r=r.sheetRows-1,x["!ref"]=Ke(k)),M.length&&(x["!merges"]=M),ee.length&&(x["!rows"]=ee),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),m.push(d.name),h[d.name]=x,ne=!1):p[0].charAt(p[0].length-2)!=="/"&&(d=qe(p[0],!1),S=_=-1,k.s.r=k.s.c=1e7,k.e.r=k.e.c=0,x=r.dense?[]:{},M=[],ee=[],ne=!0);break;case"table-row-group":p[1]==="/"?--E:++E;break;case"table-row":case"":if(p[1]==="/"){S+=Y,Y=1;break}if(f=qe(p[0],!1),f.?S=f.-1:S==-1&&(S=0),Y=+f["number-rows-repeated"]||1,Y<10)for(xe=0;xe<Y;++xe)E>0&&(ee[S+xe]={level:E});_=-1;break;case"covered-table-cell":p[1]!=="/"&&++_,r.sheetStubs&&(r.dense?(x[S]||(x[S]=[]),x[S][_]={t:"z"}):x[Ve({r:S,c:_})]={t:"z"}),v="",b=[];break;case"table-cell":case"":if(p[0].charAt(p[0].length-2)==="/")++_,w=qe(p[0],!1),G=parseInt(w["number-columns-repeated"]||"1",10),g={t:"z",v:null},w.formula&&r.cellFormula!=!1&&(g.f=gw(nt(w.formula))),(w.||w["value-type"])=="string"&&(g.t="s",g.v=nt(w["string-value"]||""),r.dense?(x[S]||(x[S]=[]),x[S][_]=g):x[Ve({r:S,c:_})]=g),_+=G-1;else if(p[1]!=="/"){++_,v="",y=0,b=[],G=1;var pe=Y?S+Y-1:S;if(_>k.e.c&&(k.e.c=_),_<k.s.c&&(k.s.c=_),S<k.s.r&&(k.s.r=S),pe>k.e.r&&(k.e.r=pe),w=qe(p[0],!1),fe=[],A={},g={t:w.||w["value-type"],v:null},r.cellFormula)if(w.formula&&(w.formula=nt(w.formula)),w["number-matrix-columns-spanned"]&&w["number-matrix-rows-spanned"]&&(D=parseInt(w["number-matrix-rows-spanned"],10)||0,W=parseInt(w["number-matrix-columns-spanned"],10)||0,q={s:{r:S,c:_},e:{r:S+D-1,c:_+W-1}},g.F=Ke(q),ce.push([q,g.F])),w.formula)g.f=gw(w.formula);else for(xe=0;xe<ce.length;++xe)S>=ce[xe][0].s.r&&S<=ce[xe][0].e.r&&_>=ce[xe][0].s.c&&_<=ce[xe][0].e.c&&(g.F=ce[xe][1]);switch((w["number-columns-spanned"]||w["number-rows-spanned"])&&(D=parseInt(w["number-rows-spanned"],10)||0,W=parseInt(w["number-columns-spanned"],10)||0,q={s:{r:S,c:_},e:{r:S+D-1,c:_+W-1}},M.push(q)),w["number-columns-repeated"]&&(G=parseInt(w["number-columns-repeated"],10)),g.t){case"boolean":g.t="b",g.v=vt(w["boolean-value"]);break;case"float":g.t="n",g.v=parseFloat(w.value);break;case"percentage":g.t="n",g.v=parseFloat(w.value);break;case"currency":g.t="n",g.v=parseFloat(w.value);break;case"date":g.t="d",g.v=wt(w["date-value"]),r.cellDates||(g.t="n",g.v=rr(g.v)),g.z="m/d/yy";break;case"time":g.t="n",g.v=AI(w["time-value"])/86400,r.cellDates&&(g.t="d",g.v=v0(g.v)),g.z="HH:MM:SS";break;case"number":g.t="n",g.v=parseFloat(w.);break;default:if(g.t==="string"||g.t==="text"||!g.t)g.t="s",w["string-value"]!=null&&(v=nt(w["string-value"]),b=[]);else throw new Error("Unsupported value type "+g.t)}}else{if(U=!1,g.t==="s"&&(g.v=v||"",b.length&&(g.R=b),U=y==0),B.Target&&(g.l=B),fe.length>0&&(g.c=fe,fe=[]),v&&r.cellText!==!1&&(g.w=v),U&&(g.t="z",delete g.v),(!U||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=S))for(var oe=0;oe<Y;++oe){if(G=parseInt(w["number-columns-repeated"]||"1",10),r.dense)for(x[S+oe]||(x[S+oe]=[]),x[S+oe][_]=oe==0?g:bt(g);--G>0;)x[S+oe][_+G]=bt(g);else for(x[Ve({r:S+oe,c:_})]=g;--G>0;)x[Ve({r:S+oe,c:_+G})]=bt(g);k.e.c<=_&&(k.e.c=_)}G=parseInt(w["number-columns-repeated"]||"1",10),_+=G-1,G=0,g={},v="",b=[]}B={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(p[1]==="/"){if((a=n.pop())[0]!==p[3])throw"Bad state: "+a}else p[0].charAt(p[0].length-2)!=="/"&&n.push([p[3],!0]);break;case"annotation":if(p[1]==="/"){if((a=n.pop())[0]!==p[3])throw"Bad state: "+a;A.t=v,b.length&&(A.R=b),A.a=V,fe.push(A)}else p[0].charAt(p[0].length-2)!=="/"&&n.push([p[3],!1]);V="",L=0,v="",y=0,b=[];break;case"creator":p[1]==="/"?V=s.slice(L,p.index):L=p.index+p[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(p[1]==="/"){if((a=n.pop())[0]!==p[3])throw"Bad state: "+a}else p[0].charAt(p[0].length-2)!=="/"&&n.push([p[3],!1]);v="",y=0,b=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(p[1]==="/"){if(T[l.name]=c,(a=n.pop())[0]!==p[3])throw"Bad state: "+a}else p[0].charAt(p[0].length-2)!=="/"&&(c="",l=qe(p[0],!1),n.push([p[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(n[n.length-1][0]){case"time-style":case"date-style":i=qe(p[0],!1),c+=_w[p[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(n[n.length-1][0]){case"time-style":case"date-style":i=qe(p[0],!1),c+=_w[p[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(p[0].slice(-2)==="/>")break;if(p[1]==="/")switch(n[n.length-1][0]){case"number-style":case"date-style":case"time-style":c+=s.slice(u,p.index);break}else u=p.index+p[0].length;break;case"named-range":i=qe(p[0],!1),me=Lf(i["cell-range-address"]);var ue={Name:i.name,Ref:me[0]+"!"+me[1]};ne&&(ue.Sheet=m.length),Q.Names.push(ue);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(n[n.length-1][0])>-1)break;if(p[1]==="/"&&(!w||!w["string-value"])){var we=s$(s.slice(y,p.index));v=(v.length>0?v+`
`:"")+we[0]}else qe(p[0],!1),y=p.index+p[0].length;break;case"s":break;case"database-range":if(p[1]==="/")break;try{me=Lf(qe(p[0])["target-range-address"]),h[me[0]]["!autofilter"]={ref:me[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(p[1]!=="/"){if(B=qe(p[0],!1),!B.href)break;B.Target=nt(B.href),delete B.href,B.Target.charAt(0)=="#"&&B.Target.indexOf(".")>-1?(me=Lf(B.Target.slice(1)),B.Target="#"+me[0]+"!"+me[1]):B.Target.match(/^\.\.[\\\/]/)&&(B.Target=B.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(p[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(p)}}var P={Sheets:h,SheetNames:m,Workbook:Q};return r.bookSheets&&delete P.Sheets,P}function Sw(e,t){t=t||{},Ss(e,"META-INF/manifest.xml")&&AO(Ht(e,"META-INF/manifest.xml"),t);var r=ls(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var s=UE(ft(r),t);return Ss(e,"meta.xml")&&(s.Props=AN(Ht(e,"meta.xml"))),s}function kw(e,t){return UE(e,t)}var n$=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+cc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Vt+t}}(),Nw=function(){var e=function(a){return ut(a).replace(/  +/g,function(i){return'<text:s text:c="'+i.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,s=function(a,i,l){var c=[];c.push('      <table:table table:name="'+ut(i.SheetNames[l])+`" table:style-name="ta1">
`);var u=0,d=0,f=Zr(a["!ref"]||"A1"),h=a["!merges"]||[],m=0,x=Array.isArray(a);if(a["!cols"])for(d=0;d<=f.e.c;++d)c.push("        <table:table-column"+(a["!cols"][d]?' table:style-name="co'+a["!cols"][d].ods+'"':"")+`></table:table-column>
`);var p="",g=a["!rows"]||[];for(u=0;u<f.s.r;++u)p=g[u]?' table:style-name="ro'+g[u].ods+'"':"",c.push("        <table:table-row"+p+`></table:table-row>
`);for(;u<=f.e.r;++u){for(p=g[u]?' table:style-name="ro'+g[u].ods+'"':"",c.push("        <table:table-row"+p+`>
`),d=0;d<f.s.c;++d)c.push(t);for(;d<=f.e.c;++d){var w=!1,v={},y="";for(m=0;m!=h.length;++m)if(!(h[m].s.c>d)&&!(h[m].s.r>u)&&!(h[m].e.c<d)&&!(h[m].e.r<u)){(h[m].s.c!=d||h[m].s.r!=u)&&(w=!0),v["table:number-columns-spanned"]=h[m].e.c-h[m].s.c+1,v["table:number-rows-spanned"]=h[m].e.r-h[m].s.r+1;break}if(w){c.push(r);continue}var b=Ve({r:u,c:d}),S=x?(a[u]||[])[d]:a[b];if(S&&S.f&&(v["table:formula"]=ut(k7(S.f)),S.F&&S.F.slice(0,b.length)==b)){var _=Zr(S.F);v["table:number-matrix-columns-spanned"]=_.e.c-_.s.c+1,v["table:number-matrix-rows-spanned"]=_.e.r-_.s.r+1}if(!S){c.push(t);continue}switch(S.t){case"b":y=S.v?"TRUE":"FALSE",v["office:value-type"]="boolean",v["office:boolean-value"]=S.v?"true":"false";break;case"n":y=S.w||String(S.v||0),v["office:value-type"]="float",v["office:value"]=S.v||0;break;case"s":case"str":y=S.v==null?"":S.v,v["office:value-type"]="string";break;case"d":y=S.w||wt(S.v).toISOString(),v["office:value-type"]="date",v["office:date-value"]=wt(S.v).toISOString(),v["table:style-name"]="ce1";break;default:c.push(t);continue}var k=e(y);if(S.l&&S.l.Target){var E=S.l.Target;E=E.charAt(0)=="#"?"#"+N7(E.slice(1)):E,E.charAt(0)!="#"&&!E.match(/^\w+:/)&&(E="../"+E),k=ke("text:a",k,{"xlink:href":E.replace(/&/g,"&amp;")})}c.push("          "+ke("table:table-cell",ke("text:p",k,{}),v)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},n=function(a,i){a.push(` <office:automatic-styles>
`),a.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),a.push(`   <number:month number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:day number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:year/>
`),a.push(`  </number:date-style>
`);var l=0;i.SheetNames.map(function(u){return i.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var d=0;d<u["!cols"].length;++d)if(u["!cols"][d]){var f=u["!cols"][d];if(f.width==null&&f.wpx==null&&f.wch==null)continue;fa(f),f.ods=l;var h=u["!cols"][d].wpx+"px";a.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),a.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+h+`"/>
`),a.push(`  </style:style>
`),++l}}});var c=0;i.SheetNames.map(function(u){return i.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var d=0;d<u["!rows"].length;++d)if(u["!rows"][d]){u["!rows"][d].ods=c;var f=u["!rows"][d].hpx+"px";a.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),a.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),a.push(`  </style:style>
`),++c}}}),a.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),a.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),a.push(`  </style:style>
`),a.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),a.push(` </office:automatic-styles>
`)};return function(i,l){var c=[Vt],u=cc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=cc({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(c.push("<office:document"+u+d+`>
`),c.push(CN().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+u+`>
`),n(c,i),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var f=0;f!=i.SheetNames.length;++f)c.push(s(i.Sheets[i.SheetNames[f]],i,f));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),l.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function zE(e,t){if(t.bookType=="fods")return Nw(e,t);var r=Px(),s="",n=[],a=[];return s="mimetype",Xe(r,s,"application/vnd.oasis.opendocument.spreadsheet"),s="content.xml",Xe(r,s,Nw(e,t)),n.push([s,"text/xml"]),a.push([s,"ContentFile"]),s="styles.xml",Xe(r,s,n$(e,t)),n.push([s,"text/xml"]),a.push([s,"StylesFile"]),s="meta.xml",Xe(r,s,Vt+CN()),n.push([s,"text/xml"]),a.push([s,"MetadataFile"]),s="manifest.rdf",Xe(r,s,RO(a)),n.push([s,"application/rdf+xml"]),s="META-INF/manifest.xml",Xe(r,s,FO(n)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function li(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Rm(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):ft(ba(e))}function a$(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):os(ln(e))}function i$(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var s=0;s<t.length;++s)if(e[r+s]!=t[s])continue e;return!0}return!1}function ma(e){var t=e.reduce(function(n,a){return n+a.length},0),r=new Uint8Array(t),s=0;return e.forEach(function(n){r.set(n,s),s+=n.length}),r}function Ew(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function o$(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,s=e[t+14]&1,n=t+13;n>=t;--n)s=s*256+e[n];return(e[t+15]&128?-s:s)*Math.pow(10,r-6176)}function l$(e,t,r){var s=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,n=r/Math.pow(10,s-6176);e[t+15]|=s>>7,e[t+14]|=(s&127)<<1;for(var a=0;n>=1;++a,n/=256)e[t+a]=n&255;e[t+15]|=r>=0?0:128}function gc(e,t){var r=t?t[0]:0,s=e[r]&127;e:if(e[r++]>=128&&(s|=(e[r]&127)<<7,e[r++]<128||(s|=(e[r]&127)<<14,e[r++]<128)||(s|=(e[r]&127)<<21,e[r++]<128)||(s+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(s+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(s+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),s}function lt(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Lt(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function ot(e){for(var t=[],r=[0];r[0]<e.length;){var s=r[0],n=gc(e,r),a=n&7;n=Math.floor(n/8);var i=0,l;if(n==0)break;switch(a){case 0:{for(var c=r[0];e[r[0]++]>=128;);l=e.slice(c,r[0])}break;case 5:i=4,l=e.slice(r[0],r[0]+i),r[0]+=i;break;case 1:i=8,l=e.slice(r[0],r[0]+i),r[0]+=i;break;case 2:i=gc(e,r),l=e.slice(r[0],r[0]+i),r[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(n," at offset ").concat(s))}var u={data:l,type:a};t[n]==null?t[n]=[u]:t[n].push(u)}return t}function ur(e){var t=[];return e.forEach(function(r,s){r.forEach(function(n){n.data&&(t.push(lt(s*8+n.type)),n.type==2&&t.push(lt(n.data.length)),t.push(n.data))})}),ma(t)}function ag(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function ws(e){for(var t,r=[],s=[0];s[0]<e.length;){var n=gc(e,s),a=ot(e.slice(s[0],s[0]+n));s[0]+=n;var i={id:Lt(a[1][0].data),messages:[]};a[2].forEach(function(l){var c=ot(l.data),u=Lt(c[3][0].data);i.messages.push({meta:c,data:e.slice(s[0],s[0]+u)}),s[0]+=u}),(t=a[3])!=null&&t[0]&&(i.merge=Lt(a[3][0].data)>>>0>0),r.push(i)}return r}function Ni(e){var t=[];return e.forEach(function(r){var s=[];s[1]=[{data:lt(r.id),type:0}],s[2]=[],r.merge!=null&&(s[3]=[{data:lt(+!!r.merge),type:0}]);var n=[];r.messages.forEach(function(i){n.push(i.data),i.meta[3]=[{type:0,data:lt(i.data.length)}],s[2].push({data:ur(i.meta),type:2})});var a=ur(s);t.push(lt(a.length)),t.push(a),n.forEach(function(i){return t.push(i)})}),ma(t)}function c$(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],s=gc(t,r),n=[];r[0]<t.length;){var a=t[r[0]]&3;if(a==0){var i=t[r[0]++]>>2;if(i<60)++i;else{var l=i-59;i=t[r[0]],l>1&&(i|=t[r[0]+1]<<8),l>2&&(i|=t[r[0]+2]<<16),l>3&&(i|=t[r[0]+3]<<24),i>>>=0,i++,r[0]+=l}n.push(t.slice(r[0],r[0]+i)),r[0]+=i;continue}else{var c=0,u=0;if(a==1?(u=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,a==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),n=[ma(n)],c==0)throw new Error("Invalid offset 0");if(c>n[0].length)throw new Error("Invalid offset beyond length");if(u>=c)for(n.push(n[0].slice(-c)),u-=c;u>=n[n.length-1].length;)n.push(n[n.length-1]),u-=n[n.length-1].length;n.push(n[0].slice(-c,-c+u))}}var d=ma(n);if(d.length!=s)throw new Error("Unexpected length: ".concat(d.length," != ").concat(s));return d}function bs(e){for(var t=[],r=0;r<e.length;){var s=e[r++],n=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(c$(s,e.slice(r,r+n))),r+=n}if(r!==e.length)throw new Error("data is not a valid framed stream!");return ma(t)}function Ei(e){for(var t=[],r=0;r<e.length;){var s=Math.min(e.length-r,268435455),n=new Uint8Array(4);t.push(n);var a=lt(s),i=a.length;t.push(a),s<=60?(i++,t.push(new Uint8Array([s-1<<2]))):s<=256?(i+=2,t.push(new Uint8Array([240,s-1&255]))):s<=65536?(i+=3,t.push(new Uint8Array([244,s-1&255,s-1>>8&255]))):s<=16777216?(i+=4,t.push(new Uint8Array([248,s-1&255,s-1>>8&255,s-1>>16&255]))):s<=4294967296&&(i+=5,t.push(new Uint8Array([252,s-1&255,s-1>>8&255,s-1>>16&255,s-1>>>24&255]))),t.push(e.slice(r,r+s)),i+=s,n[0]=0,n[1]=i&255,n[2]=i>>8&255,n[3]=i>>16&255,r+=s}return ma(t)}function u$(e,t,r,s){var n=li(e),a=n.getUint32(4,!0),i=(s>1?12:8)+Ew(a&(s>1?3470:398))*4,l=-1,c=-1,u=NaN,d=new Date(2001,0,1);a&512&&(l=n.getUint32(i,!0),i+=4),i+=Ew(a&(s>1?12288:4096))*4,a&16&&(c=n.getUint32(i,!0),i+=4),a&32&&(u=n.getFloat64(i,!0),i+=8),a&64&&(d.setTime(d.getTime()+n.getFloat64(i,!0)*1e3),i+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:u};break;case 3:f={t:"s",v:t[c]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(l>-1)f={t:"s",v:r[l]};else if(c>-1)f={t:"s",v:t[c]};else if(!isNaN(u))f={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function d$(e,t,r){var s=li(e),n=s.getUint32(8,!0),a=12,i=-1,l=-1,c=NaN,u=NaN,d=new Date(2001,0,1);n&1&&(c=o$(e,a),a+=16),n&2&&(u=s.getFloat64(a,!0),a+=8),n&4&&(d.setTime(d.getTime()+s.getFloat64(a,!0)*1e3),a+=8),n&8&&(l=s.getUint32(a,!0),a+=4),n&16&&(i=s.getUint32(a,!0),a+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:t[l]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(i>-1)f={t:"s",v:r[i]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)))}return f}function Bf(e,t){var r=new Uint8Array(32),s=li(r),n=12,a=0;switch(r[0]=5,e.t){case"n":r[1]=2,l$(r,n,e.v),a|=1,n+=16;break;case"b":r[1]=6,s.setFloat64(n,e.v?1:0,!0),a|=2,n+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,s.setUint32(n,t.indexOf(e.v),!0),a|=8,n+=4;break;default:throw"unsupported cell type "+e.t}return s.setUint32(8,a,!0),r.slice(0,n)}function Uf(e,t){var r=new Uint8Array(32),s=li(r),n=12,a=0;switch(r[0]=3,e.t){case"n":r[2]=2,s.setFloat64(n,e.v,!0),a|=32,n+=8;break;case"b":r[2]=6,s.setFloat64(n,e.v?1:0,!0),a|=32,n+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,s.setUint32(n,t.indexOf(e.v),!0),a|=16,n+=4;break;default:throw"unsupported cell type "+e.t}return s.setUint32(4,a,!0),r.slice(0,n)}function f$(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return u$(e,t,r,e[0]);case 5:return d$(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function _r(e){var t=ot(e);return gc(t[1][0].data)}function jw(e,t){var r=ot(t.data),s=Lt(r[1][0].data),n=r[3],a=[];return(n||[]).forEach(function(i){var l=ot(i.data),c=Lt(l[1][0].data)>>>0;switch(s){case 1:a[c]=Rm(l[3][0].data);break;case 8:{var u=e[_r(l[9][0].data)][0],d=ot(u.data),f=e[_r(d[1][0].data)][0],h=Lt(f.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var m=ot(f.data);a[c]=m[3].map(function(x){return Rm(x.data)}).join("")}break}}),a}function h$(e,t){var r,s,n,a,i,l,c,u,d,f,h,m,x,p,g=ot(e),w=Lt(g[1][0].data)>>>0,v=Lt(g[2][0].data)>>>0,y=((s=(r=g[8])==null?void 0:r[0])==null?void 0:s.data)&&Lt(g[8][0].data)>0||!1,b,S;if((a=(n=g[7])==null?void 0:n[0])!=null&&a.data&&t!=0)b=(l=(i=g[7])==null?void 0:i[0])==null?void 0:l.data,S=(u=(c=g[6])==null?void 0:c[0])==null?void 0:u.data;else if((f=(d=g[4])==null?void 0:d[0])!=null&&f.data&&t!=1)b=(m=(h=g[4])==null?void 0:h[0])==null?void 0:m.data,S=(p=(x=g[3])==null?void 0:x[0])==null?void 0:p.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var _=y?4:1,k=li(b),E=[],T=0;T<b.length/2;++T){var M=k.getUint16(T*2,!0);M<65535&&E.push([T,M])}if(E.length!=v)throw"Expected ".concat(v," cells, found ").concat(E.length);var q=[];for(T=0;T<E.length-1;++T)q[E[T][0]]=S.subarray(E[T][1]*_,E[T+1][1]*_);return E.length>=1&&(q[E[E.length-1][0]]=S.subarray(E[E.length-1][1]*_)),{R:w,cells:q}}function m$(e,t){var r,s=ot(t.data),n=(r=s==null?void 0:s[7])!=null&&r[0]?Lt(s[7][0].data)>>>0>0?1:0:-1,a=ag(s[5],function(i){return h$(i,n)});return{nrows:Lt(s[4][0].data)>>>0,data:a.reduce(function(i,l){return i[l.R]||(i[l.R]=[]),l.cells.forEach(function(c,u){if(i[l.R][u])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(u));i[l.R][u]=c}),i},[])}}function p$(e,t,r){var s,n=ot(t.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(Lt(n[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(n[6][0].data));if(a.e.c=(Lt(n[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(n[7][0].data));r["!ref"]=Ke(a);var i=ot(n[4][0].data),l=jw(e,e[_r(i[4][0].data)][0]),c=(s=i[17])!=null&&s[0]?jw(e,e[_r(i[17][0].data)][0]):[],u=ot(i[3][0].data),d=0;u[1].forEach(function(f){var h=ot(f.data),m=e[_r(h[2][0].data)][0],x=Lt(m.meta[1][0].data);if(x!=6002)throw new Error("6001 unexpected reference to ".concat(x));var p=m$(e,m);p.data.forEach(function(g,w){g.forEach(function(v,y){var b=Ve({r:d+w,c:y}),S=f$(v,l,c);S&&(r[b]=S)})}),d+=p.nrows})}function x$(e,t){var r=ot(t.data),s={"!ref":"A1"},n=e[_r(r[2][0].data)],a=Lt(n[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return p$(e,n[0],s),s}function g$(e,t){var r,s=ot(t.data),n={name:(r=s[1])!=null&&r[0]?Rm(s[1][0].data):"",sheets:[]},a=ag(s[2],_r);return a.forEach(function(i){e[i].forEach(function(l){var c=Lt(l.meta[1][0].data);c==6e3&&n.sheets.push(x$(e,l))})}),n}function v$(e,t){var r=ug(),s=ot(t.data),n=ag(s[1],_r);if(n.forEach(function(a){e[a].forEach(function(i){var l=Lt(i.meta[1][0].data);if(l==2){var c=g$(e,i);c.sheets.forEach(function(u,d){dg(r,u,d==0?c.name:c.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function zf(e){var t,r,s,n,a={},i=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var u;try{u=bs(c.content)}catch(f){return console.log("?? "+c.content.length+" "+(f.message||f))}var d;try{d=ws(u)}catch(f){return console.log("## "+(f.message||f))}d.forEach(function(f){a[f.id]=f.messages,i.push(f.id)})}}),!i.length)throw new Error("File has no messages");var l=((n=(s=(r=(t=a==null?void 0:a[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:s[1])==null?void 0:n[0].data)&&Lt(a[1][0].meta[1][0].data)==1&&a[1][0];if(l||i.forEach(function(c){a[c].forEach(function(u){var d=Lt(u.meta[1][0].data)>>>0;if(d==1)if(!l)l=u;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return v$(a,l)}function y$(e,t,r){var s,n,a,i;if(!((s=e[6])!=null&&s[0])||!((n=e[7])!=null&&n[0]))throw"Mutation only works on post-BNC storages!";var l=((i=(a=e[8])==null?void 0:a[0])==null?void 0:i.data)&&Lt(e[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var c=0,u=li(e[7][0].data),d=0,f=[],h=li(e[4][0].data),m=0,x=[],p=0;p<t.length;++p){if(t[p]==null){u.setUint16(p*2,65535,!0),h.setUint16(p*2,65535);continue}u.setUint16(p*2,d,!0),h.setUint16(p*2,m,!0);var g,w;switch(typeof t[p]){case"string":g=Bf({t:"s",v:t[p]},r),w=Uf({t:"s",v:t[p]},r);break;case"number":g=Bf({t:"n",v:t[p]},r),w=Uf({t:"n",v:t[p]},r);break;case"boolean":g=Bf({t:"b",v:t[p]},r),w=Uf({t:"b",v:t[p]},r);break;default:throw new Error("Unsupported value "+t[p])}f.push(g),d+=g.length,x.push(w),m+=w.length,++c}for(e[2][0].data=lt(c);p<e[7][0].data.length/2;++p)u.setUint16(p*2,65535,!0),h.setUint16(p*2,65535,!0);return e[6][0].data=ma(f),e[3][0].data=ma(x),c}function w$(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var s=Zr(r["!ref"]);s.s.r=s.s.c=0;var n=!1;s.e.c>9&&(n=!0,s.e.c=9),s.e.r>49&&(n=!0,s.e.r=49),n&&console.error("The Numbers writer is currently limited to ".concat(Ke(s)));var a=Bd(r,{range:s,header:1}),i=["~Sh33tJ5~"];a.forEach(function(V){return V.forEach(function(L){typeof L=="string"&&i.push(L)})});var l={},c=[],u=Be.read(t.numbers,{type:"base64"});u.FileIndex.map(function(V,L){return[V,u.FullPaths[L]]}).forEach(function(V){var L=V[0],U=V[1];if(L.type==2&&L.name.match(/\.iwa/)){var ne=L.content,xe=bs(ne),pe=ws(xe);pe.forEach(function(oe){c.push(oe.id),l[oe.id]={deps:[],location:U,type:Lt(oe.messages[0].meta[1][0].data)}})}}),c.sort(function(V,L){return V-L});var d=c.filter(function(V){return V>1}).map(function(V){return[V,lt(V)]});u.FileIndex.map(function(V,L){return[V,u.FullPaths[L]]}).forEach(function(V){var L=V[0];if(V[1],!!L.name.match(/\.iwa/)){var U=ws(bs(L.content));U.forEach(function(ne){ne.messages.forEach(function(xe){d.forEach(function(pe){ne.messages.some(function(oe){return Lt(oe.meta[1][0].data)!=11006&&i$(oe.data,pe[1])})&&l[pe[0]].deps.push(ne.id)})})})}});for(var f=Be.find(u,l[1].location),h=ws(bs(f.content)),m,x=0;x<h.length;++x){var p=h[x];p.id==1&&(m=p)}var g=_r(ot(m.messages[0].data)[1][0].data);for(f=Be.find(u,l[g].location),h=ws(bs(f.content)),x=0;x<h.length;++x)p=h[x],p.id==g&&(m=p);for(g=_r(ot(m.messages[0].data)[2][0].data),f=Be.find(u,l[g].location),h=ws(bs(f.content)),x=0;x<h.length;++x)p=h[x],p.id==g&&(m=p);for(g=_r(ot(m.messages[0].data)[2][0].data),f=Be.find(u,l[g].location),h=ws(bs(f.content)),x=0;x<h.length;++x)p=h[x],p.id==g&&(m=p);var w=ot(m.messages[0].data);{w[6][0].data=lt(s.e.r+1),w[7][0].data=lt(s.e.c+1);var v=_r(w[46][0].data),y=Be.find(u,l[v].location),b=ws(bs(y.content));{for(var S=0;S<b.length&&b[S].id!=v;++S);if(b[S].id!=v)throw"Bad ColumnRowUIDMapArchive";var _=ot(b[S].messages[0].data);_[1]=[],_[2]=[],_[3]=[];for(var k=0;k<=s.e.c;++k){var E=[];E[1]=E[2]=[{type:0,data:lt(k+420690)}],_[1].push({type:2,data:ur(E)}),_[2].push({type:0,data:lt(k)}),_[3].push({type:0,data:lt(k)})}_[4]=[],_[5]=[],_[6]=[];for(var T=0;T<=s.e.r;++T)E=[],E[1]=E[2]=[{type:0,data:lt(T+726270)}],_[4].push({type:2,data:ur(E)}),_[5].push({type:0,data:lt(T)}),_[6].push({type:0,data:lt(T)});b[S].messages[0].data=ur(_)}y.content=Ei(Ni(b)),y.size=y.content.length,delete w[46];var M=ot(w[4][0].data);{M[7][0].data=lt(s.e.r+1);var q=ot(M[1][0].data),D=_r(q[2][0].data);y=Be.find(u,l[D].location),b=ws(bs(y.content));{if(b[0].id!=D)throw"Bad HeaderStorageBucket";var W=ot(b[0].messages[0].data);for(T=0;T<a.length;++T){var ee=ot(W[2][0].data);ee[1][0].data=lt(T),ee[4][0].data=lt(a[T].length),W[2][T]={type:W[2][0].type,data:ur(ee)}}b[0].messages[0].data=ur(W)}y.content=Ei(Ni(b)),y.size=y.content.length;var Y=_r(M[2][0].data);y=Be.find(u,l[Y].location),b=ws(bs(y.content));{if(b[0].id!=Y)throw"Bad HeaderStorageBucket";for(W=ot(b[0].messages[0].data),k=0;k<=s.e.c;++k)ee=ot(W[2][0].data),ee[1][0].data=lt(k),ee[4][0].data=lt(s.e.r+1),W[2][k]={type:W[2][0].type,data:ur(ee)};b[0].messages[0].data=ur(W)}y.content=Ei(Ni(b)),y.size=y.content.length;var G=_r(M[4][0].data);(function(){for(var V=Be.find(u,l[G].location),L=ws(bs(V.content)),U,ne=0;ne<L.length;++ne){var xe=L[ne];xe.id==G&&(U=xe)}var pe=ot(U.messages[0].data);{pe[3]=[];var oe=[];i.forEach(function(P,Me){oe[1]=[{type:0,data:lt(Me)}],oe[2]=[{type:0,data:lt(1)}],oe[3]=[{type:2,data:a$(P)}],pe[3].push({type:2,data:ur(oe)})})}U.messages[0].data=ur(pe);var ue=Ni(L),we=Ei(ue);V.content=we,V.size=V.content.length})();var ce=ot(M[3][0].data);{var Q=ce[1][0];delete ce[2];var B=ot(Q.data);{var me=_r(B[2][0].data);(function(){for(var V=Be.find(u,l[me].location),L=ws(bs(V.content)),U,ne=0;ne<L.length;++ne){var xe=L[ne];xe.id==me&&(U=xe)}var pe=ot(U.messages[0].data);{delete pe[6],delete ce[7];var oe=new Uint8Array(pe[5][0].data);pe[5]=[];for(var ue=0,we=0;we<=s.e.r;++we){var P=ot(oe);ue+=y$(P,a[we],i),P[1][0].data=lt(we),pe[5].push({data:ur(P),type:2})}pe[1]=[{type:0,data:lt(s.e.c+1)}],pe[2]=[{type:0,data:lt(s.e.r+1)}],pe[3]=[{type:0,data:lt(ue)}],pe[4]=[{type:0,data:lt(s.e.r+1)}]}U.messages[0].data=ur(pe);var Me=Ni(L),je=Ei(Me);V.content=je,V.size=V.content.length})()}Q.data=ur(B)}M[3][0].data=ur(ce)}w[4][0].data=ur(M)}m.messages[0].data=ur(w);var fe=Ni(h),A=Ei(fe);return f.content=A,f.size=f.content.length,u}function $E(e){return function(r){for(var s=0;s!=e.length;++s){var n=e[s];r[n[0]]===void 0&&(r[n[0]]=n[1]),n[2]==="n"&&(r[n[0]]=Number(r[n[0]]))}}}function ig(e){$E([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function og(e){$E([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function b$(e){return Ye.WS.indexOf(e)>-1?"sheet":e==Ye.CS?"chart":e==Ye.DS?"dialog":e==Ye.MS?"macro":e&&e.length?e:"sheet"}function _$(e,t){if(!e)return 0;try{e=t.map(function(s){return s.id||(s.id=s.strRelID),[s.name,e["!id"][s.id].Target,b$(e["!id"][s.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function S$(e,t,r,s,n,a,i,l,c,u,d,f){try{a[s]=El(ls(e,r,!0),t);var h=Ht(e,t),m;switch(l){case"sheet":m=qU(h,t,n,c,a[s],u,d,f);break;case"chart":if(m=HU(h,t,n,c,a[s],u,d,f),!m||!m["!drawel"])break;var x=il(m["!drawel"].Target,t),p=dc(x),g=PM(ls(e,x,!0),El(ls(e,p,!0),x)),w=il(g,x),v=dc(w);m=yU(ls(e,w,!0),w,c,El(ls(e,v,!0),w),u,m);break;case"macro":m=GU(h,t,n,c,a[s],u,d,f);break;case"dialog":m=KU(h,t,n,c,a[s],u,d,f);break;default:throw new Error("Unrecognized sheet type "+l)}i[s]=m;var y=[];a&&a[s]&&Mt(a[s]).forEach(function(b){var S="";if(a[s][b].Type==Ye.CMNT){S=il(a[s][b].Target,t);var _=JU(Ht(e,S,!0),S,c);if(!_||!_.length)return;fw(m,_,!1)}a[s][b].Type==Ye.TCMNT&&(S=il(a[s][b].Target,t),y=y.concat(IM(Ht(e,S,!0),c)))}),y&&y.length&&fw(m,y,!0,c.people||[])}catch(b){if(c.WTF)throw b}}function vs(e){return e.charAt(0)=="/"?e.slice(1):e}function k$(e,t){if(Oo(),t=t||{},ig(t),Ss(e,"META-INF/manifest.xml")||Ss(e,"objectdata.xml"))return Sw(e,t);if(Ss(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof zf<"u"){if(e.FileIndex)return zf(e);var r=Be.utils.cfb_new();return R1(e).forEach(function(ee){Xe(r,ee,OI(e,ee))}),zf(r)}throw new Error("Unsupported NUMBERS file")}if(!Ss(e,"[Content_Types].xml"))throw Ss(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Ss(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var s=R1(e),n=TO(ls(e,"[Content_Types].xml")),a=!1,i,l;if(n.workbooks.length===0&&(l="xl/workbook.xml",Ht(e,l,!0)&&n.workbooks.push(l)),n.workbooks.length===0){if(l="xl/workbook.bin",!Ht(e,l,!0))throw new Error("Could not find workbook");n.workbooks.push(l),a=!0}n.workbooks[0].slice(-3)=="bin"&&(a=!0);var c={},u={};if(!t.bookSheets&&!t.bookProps){if(jl=[],n.sst)try{jl=YU(Ht(e,vs(n.sst)),n.sst,t)}catch(ee){if(t.WTF)throw ee}t.cellStyles&&n.themes.length&&(c=QU(ls(e,n.themes[0].replace(/^\//,""),!0)||"",n.themes[0],t)),n.style&&(u=XU(Ht(e,vs(n.style)),n.style,c,t))}n.links.map(function(ee){try{var Y=El(ls(e,dc(vs(ee))),ee);return ez(Ht(e,vs(ee)),Y,ee,t)}catch{}});var d=WU(Ht(e,vs(n.workbooks[0])),n.workbooks[0],t),f={},h="";n.coreprops.length&&(h=Ht(e,vs(n.coreprops[0]),!0),h&&(f=AN(h)),n.extprops.length!==0&&(h=Ht(e,vs(n.extprops[0]),!0),h&&OO(h,f,t)));var m={};(!t.bookSheets||t.bookProps)&&n.custprops.length!==0&&(h=ls(e,vs(n.custprops[0]),!0),h&&(m=LO(h,t)));var x={};if((t.bookSheets||t.bookProps)&&(d.Sheets?i=d.Sheets.map(function(Y){return Y.name}):f.Worksheets&&f.SheetNames.length>0&&(i=f.SheetNames),t.bookProps&&(x.Props=f,x.Custprops=m),t.bookSheets&&typeof i<"u"&&(x.SheetNames=i),t.bookSheets?x.SheetNames:t.bookProps))return x;i={};var p={};t.bookDeps&&n.calcchain&&(p=ZU(Ht(e,vs(n.calcchain)),n.calcchain));var g=0,w={},v,y;{var b=d.Sheets;f.Worksheets=b.length,f.SheetNames=[];for(var S=0;S!=b.length;++S)f.SheetNames[S]=b[S].name}var _=a?"bin":"xml",k=n.workbooks[0].lastIndexOf("/"),E=(n.workbooks[0].slice(0,k+1)+"_rels/"+n.workbooks[0].slice(k+1)+".rels").replace(/^\//,"");Ss(e,E)||(E="xl/_rels/workbook."+_+".rels");var T=El(ls(e,E,!0),E.replace(/_rels.*/,"s5s"));(n.metadata||[]).length>=1&&(t.xlmeta=tz(Ht(e,vs(n.metadata[0])),n.metadata[0],t)),(n.people||[]).length>=1&&(t.people=DM(Ht(e,vs(n.people[0])),t)),T&&(T=_$(T,d.Sheets));var M=Ht(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(g=0;g!=f.Worksheets;++g){var q="sheet";if(T&&T[g]?(v="xl/"+T[g][1].replace(/[\/]?xl\//,""),Ss(e,v)||(v=T[g][1]),Ss(e,v)||(v=E.replace(/_rels\/.*$/,"")+T[g][1]),q=T[g][2]):(v="xl/worksheets/sheet"+(g+1-M)+"."+_,v=v.replace(/sheet0\./,"sheet.")),y=v.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(g!=t.sheets)continue e;break;case"string":if(f.SheetNames[g].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var D=!1,W=0;W!=t.sheets.length;++W)typeof t.sheets[W]=="number"&&t.sheets[W]==g&&(D=1),typeof t.sheets[W]=="string"&&t.sheets[W].toLowerCase()==f.SheetNames[g].toLowerCase()&&(D=1);if(!D)continue e}}S$(e,v,y,f.SheetNames[g],g,w,i,q,t,d,c,u)}return x={Directory:n,Workbook:d,Props:f,Custprops:m,Deps:p,Sheets:i,SheetNames:f.SheetNames,Strings:jl,Styles:u,Themes:c,SSF:bt($e)},t&&t.bookFiles&&(e.files?(x.keys=s,x.files=e.files):(x.keys=[],x.files={},e.FullPaths.forEach(function(ee,Y){ee=ee.replace(/^Root Entry[\/]/,""),x.keys.push(ee),x.files[ee]=e.FileIndex[Y]}))),t&&t.bookVBA&&(n.vba.length>0?x.vbaraw=Ht(e,vs(n.vba[0]),!0):n.defaults&&n.defaults.bin===WM&&(x.vbaraw=Ht(e,"xl/vbaProject.bin",!0))),x}function N$(e,t){var r=t||{},s="Workbook",n=Be.find(e,s);try{if(s="/!DataSpaces/Version",n=Be.find(e,s),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);if(tL(n.content),s="/!DataSpaces/DataSpaceMap",n=Be.find(e,s),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);var a=sL(n.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+s);if(s="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",n=Be.find(e,s),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);var i=nL(n.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+s);if(s="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",n=Be.find(e,s),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);iL(n.content)}catch{}if(s="/EncryptionInfo",n=Be.find(e,s),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);var l=oL(n.content);if(s="/EncryptedPackage",n=Be.find(e,s),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);if(l[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(l[1],n.content,r.password||"",r);if(l[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(l[1],n.content,r.password||"",r);throw new Error("File is password-protected")}function E$(e,t){return t.bookType=="ods"?zE(e,t):t.bookType=="numbers"?w$(e,t):t.bookType=="xlsb"?j$(e,t):T$(e,t)}function j$(e,t){Gi=1024,e&&!e.SSF&&(e.SSF=bt($e)),e&&e.SSF&&(Oo(),p0(e.SSF),t.revssf=g0(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Tl?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",s=pE.indexOf(t.bookType)>-1,n=Hx();og(t=t||{});var a=Px(),i="",l=0;if(t.cellXfs=[],Sa(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",Xe(a,i,FN(e.Props,t)),n.coreprops.push(i),ct(t.rels,2,i,Ye.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,Xe(a,i,IN(e.Props)),n.extprops.push(i),ct(t.rels,3,i,Ye.EXT_PROPS),e.Custprops!==e.Props&&Mt(e.Custprops||{}).length>0&&(i="docProps/custom.xml",Xe(a,i,ON(e.Custprops)),n.custprops.push(i),ct(t.rels,4,i,Ye.CUST_PROPS)),l=1;l<=e.SheetNames.length;++l){var d={"!id":{}},f=e.Sheets[e.SheetNames[l-1]],h=(f||{})["!type"]||"sheet";switch(h){case"chart":default:i="xl/worksheets/sheet"+l+"."+r,Xe(a,i,sz(l-1,i,t,e,d)),n.sheets.push(i),ct(t.wbrels,-1,"worksheets/sheet"+l+"."+r,Ye.WS[0])}if(f){var m=f["!comments"],x=!1,p="";m&&m.length>0&&(p="xl/comments"+l+"."+r,Xe(a,p,iz(m,p)),n.comments.push(p),ct(d,-1,"../comments"+l+"."+r,Ye.CMNT),x=!0),f["!legacy"]&&x&&Xe(a,"xl/drawings/vmlDrawing"+l+".vml",hE(l,f["!comments"])),delete f["!comments"],delete f["!legacy"]}d["!id"].rId1&&Xe(a,dc(i),no(d))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,Xe(a,i,az(t.Strings,i,t)),n.strs.push(i),ct(t.wbrels,-1,"sharedStrings."+r,Ye.SST)),i="xl/workbook."+r,Xe(a,i,rz(e,i)),n.workbooks.push(i),ct(t.rels,1,i,Ye.WB),i="xl/theme/theme1.xml",Xe(a,i,Jx(e.Themes,t)),n.themes.push(i),ct(t.wbrels,-1,"theme/theme1.xml",Ye.THEME),i="xl/styles."+r,Xe(a,i,nz(e,i,t)),n.styles.push(i),ct(t.wbrels,-1,"styles."+r,Ye.STY),e.vbaraw&&s&&(i="xl/vbaProject.bin",Xe(a,i,e.vbaraw),n.vba.push(i),ct(t.wbrels,-1,"vbaProject.bin",Ye.VBA)),i="xl/metadata."+r,Xe(a,i,oz(i)),n.metadata.push(i),ct(t.wbrels,-1,"metadata."+r,Ye.XLMETA),Xe(a,"[Content_Types].xml",TN(n,t)),Xe(a,"_rels/.rels",no(t.rels)),Xe(a,"xl/_rels/workbook."+r+".rels",no(t.wbrels)),delete t.revssf,delete t.ssf,a}function T$(e,t){Gi=1024,e&&!e.SSF&&(e.SSF=bt($e)),e&&e.SSF&&(Oo(),p0(e.SSF),t.revssf=g0(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Tl?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",s=pE.indexOf(t.bookType)>-1,n=Hx();og(t=t||{});var a=Px(),i="",l=0;if(t.cellXfs=[],Sa(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",Xe(a,i,FN(e.Props,t)),n.coreprops.push(i),ct(t.rels,2,i,Ye.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,Xe(a,i,IN(e.Props)),n.extprops.push(i),ct(t.rels,3,i,Ye.EXT_PROPS),e.Custprops!==e.Props&&Mt(e.Custprops||{}).length>0&&(i="docProps/custom.xml",Xe(a,i,ON(e.Custprops)),n.custprops.push(i),ct(t.rels,4,i,Ye.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,l=1;l<=e.SheetNames.length;++l){var f={"!id":{}},h=e.Sheets[e.SheetNames[l-1]],m=(h||{})["!type"]||"sheet";switch(m){case"chart":default:i="xl/worksheets/sheet"+l+"."+r,Xe(a,i,EE(l-1,t,e,f)),n.sheets.push(i),ct(t.wbrels,-1,"worksheets/sheet"+l+"."+r,Ye.WS[0])}if(h){var x=h["!comments"],p=!1,g="";if(x&&x.length>0){var w=!1;x.forEach(function(v){v[1].forEach(function(y){y.T==!0&&(w=!0)})}),w&&(g="xl/threadedComments/threadedComment"+l+"."+r,Xe(a,g,OM(x,d,t)),n.threadedcomments.push(g),ct(f,-1,"../threadedComments/threadedComment"+l+"."+r,Ye.TCMNT)),g="xl/comments"+l+"."+r,Xe(a,g,mE(x)),n.comments.push(g),ct(f,-1,"../comments"+l+"."+r,Ye.CMNT),p=!0}h["!legacy"]&&p&&Xe(a,"xl/drawings/vmlDrawing"+l+".vml",hE(l,h["!comments"])),delete h["!comments"],delete h["!legacy"]}f["!id"].rId1&&Xe(a,dc(i),no(f))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,Xe(a,i,tE(t.Strings,t)),n.strs.push(i),ct(t.wbrels,-1,"sharedStrings."+r,Ye.SST)),i="xl/workbook."+r,Xe(a,i,FE(e)),n.workbooks.push(i),ct(t.rels,1,i,Ye.WB),i="xl/theme/theme1.xml",Xe(a,i,Jx(e.Themes,t)),n.themes.push(i),ct(t.wbrels,-1,"theme/theme1.xml",Ye.THEME),i="xl/styles."+r,Xe(a,i,cE(e,t)),n.styles.push(i),ct(t.wbrels,-1,"styles."+r,Ye.STY),e.vbaraw&&s&&(i="xl/vbaProject.bin",Xe(a,i,e.vbaraw),n.vba.push(i),ct(t.wbrels,-1,"vbaProject.bin",Ye.VBA)),i="xl/metadata."+r,Xe(a,i,fE()),n.metadata.push(i),ct(t.wbrels,-1,"metadata."+r,Ye.XLMETA),d.length>1&&(i="xl/persons/person.xml",Xe(a,i,LM(d)),n.people.push(i),ct(t.wbrels,-1,"persons/person.xml",Ye.PEOPLE)),Xe(a,"[Content_Types].xml",TN(n,t)),Xe(a,"_rels/.rels",no(t.rels)),Xe(a,"xl/_rels/workbook."+r+".rels",no(t.wbrels)),delete t.revssf,delete t.ssf,a}function lg(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=fs(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function C$(e,t){return Be.find(e,"EncryptedPackage")?N$(e,t):OE(e,t)}function A$(e,t){var r,s=e,n=t||{};return n.type||(n.type=Qe&&Buffer.isBuffer(e)?"buffer":"base64"),r=sN(s,n),k$(r,n)}function VE(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Fm(e.slice(r),t);default:break e}return bo.to_workbook(e,t)}function F$(e,t){var r="",s=lg(e,t);switch(t.type){case"base64":r=fs(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=ni(e);break;default:throw new Error("Unrecognized type "+t.type)}return s[0]==239&&s[1]==187&&s[2]==191&&(r=ft(r)),t.type="binary",VE(r,t)}function P$(e,t){var r=e;return t.type=="base64"&&(r=fs(r)),r=ac.utils.decode(1200,r.slice(2),"str"),t.type="binary",VE(r,t)}function R$(e){return e.match(/[^\x00-\x7F]/)?ln(e):e}function $f(e,t,r,s){return s?(r.type="string",bo.to_workbook(e,r)):bo.to_workbook(t,r)}function Im(e,t){jx();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Im(new Uint8Array(e),(r=bt(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var s=e,n=[0,0,0,0],a=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),io={},r.dateNF&&(io.dateNF=r.dateNF),r.type||(r.type=Qe&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Qe?"buffer":"binary",s=jI(e),typeof Uint8Array<"u"&&!Qe&&(r.type="array")),r.type=="string"&&(a=!0,r.type="binary",r.codepage=65001,s=R$(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),l=new Uint8Array(i);if(l.foo="bar",!l.foo)return r=bt(r),r.type="array",Im(Tx(s),r)}switch((n=lg(s,r))[0]){case 208:if(n[1]===207&&n[2]===17&&n[3]===224&&n[4]===161&&n[5]===177&&n[6]===26&&n[7]===225)return C$(Be.read(s,r),r);break;case 9:if(n[1]<=8)return OE(s,r);break;case 60:return Fm(s,r);case 73:if(n[1]===73&&n[2]===42&&n[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(n[1]===68)return M8(s,r);break;case 84:if(n[1]===65&&n[2]===66&&n[3]===76)return ZN.to_workbook(s,r);break;case 80:return n[1]===75&&n[2]<9&&n[3]<9?A$(s,r):$f(e,s,r,a);case 239:return n[3]===60?Fm(s,r):$f(e,s,r,a);case 255:if(n[1]===254)return P$(s,r);if(n[1]===0&&n[2]===2&&n[3]===0)return Xa.to_workbook(s,r);break;case 0:if(n[1]===0&&(n[2]>=2&&n[3]===0||n[2]===0&&(n[3]===8||n[3]===9)))return Xa.to_workbook(s,r);break;case 3:case 131:case 139:case 140:return Am.to_workbook(s,r);case 123:if(n[1]===92&&n[2]===114&&n[3]===116)return iE.to_workbook(s,r);break;case 10:case 13:case 32:return F$(s,r);case 137:if(n[1]===80&&n[2]===78&&n[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return L8.indexOf(n[0])>-1&&n[2]<=12&&n[3]<=31?Am.to_workbook(s,r):$f(e,s,r,a)}function WE(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Ac(t.file,Be.write(e,{type:Qe?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Be.write(e,t)}function I$(e,t){var r=bt(t||{}),s=E$(e,r);return O$(s,r)}function O$(e,t){var r={},s=Qe?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=s;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=s;break;default:throw new Error("Unrecognized type "+t.type)}var n=e.FullPaths?Be.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof n=="string"){if(t.type=="binary"||t.type=="base64")return n;n=new Uint8Array(m0(n))}return t.password&&typeof encrypt_agile<"u"?WE(encrypt_agile(n,t.password),t):t.type==="file"?Ac(t.file,n):t.type=="string"?ft(n):n}function D$(e,t){var r=t||{},s=Rz(e,r);return WE(s,r)}function nn(e,t,r){r||(r="");var s=r+e;switch(t.type){case"base64":return ic(ln(s));case"binary":return ln(s);case"string":return e;case"file":return Ac(t.file,s,"utf8");case"buffer":return Qe?Dn(s,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(s):nn(s,{type:"binary"}).split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function L$(e,t){switch(t.type){case"base64":return ic(e);case"binary":return e;case"string":return e;case"file":return Ac(t.file,e,"binary");case"buffer":return Qe?Dn(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function ju(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",s=0;s<e.length;++s)r+=String.fromCharCode(e[s]);return t.type=="base64"?ic(r):t.type=="string"?ft(r):r;case"file":return Ac(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function qE(e,t){jx(),CU(e);var r=bt(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var s=qE(e,r);return r.type="array",m0(s)}var n=0;if(r.sheet&&(typeof r.sheet=="number"?n=r.sheet:n=e.SheetNames.indexOf(r.sheet),!e.SheetNames[n]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return nn(Ez(e,r),r);case"slk":case"sylk":return nn(JN.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"htm":case"html":return nn(LE(e.Sheets[e.SheetNames[n]],r),r);case"txt":return L$(GE(e.Sheets[e.SheetNames[n]],r),r);case"csv":return nn(cg(e.Sheets[e.SheetNames[n]],r),r,"\uFEFF");case"dif":return nn(ZN.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"dbf":return ju(Am.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"prn":return nn(bo.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"rtf":return nn(iE.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"eth":return nn(eE.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"fods":return nn(zE(e,r),r);case"wk1":return ju(Xa.sheet_to_wk1(e.Sheets[e.SheetNames[n]],r),r);case"wk3":return ju(Xa.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),ju(DE(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),D$(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return I$(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function M$(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function HE(e,t,r){var s={};return s.type="file",s.file=t,M$(s),qE(e,s)}function B$(e,t,r,s,n,a,i,l){var c=$t(r),u=l.defval,d=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),f=!0,h=n===1?[]:{};if(n!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!i||e[r])for(var m=t.s.c;m<=t.e.c;++m){var x=i?e[r][m]:e[s[m]+c];if(x===void 0||x.t===void 0){if(u===void 0)continue;a[m]!=null&&(h[a[m]]=u);continue}var p=x.v;switch(x.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(a[m]!=null){if(p==null)if(x.t=="e"&&p===null)h[a[m]]=null;else if(u!==void 0)h[a[m]]=u;else if(d&&p===null)h[a[m]]=null;else continue;else h[a[m]]=d&&(x.t!=="n"||x.t==="n"&&l.rawNumbers!==!1)?p:In(x,p,l);p!=null&&(f=!1)}}return{row:h,isempty:f}}function Bd(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},s=0,n=1,a=[],i=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},d=u.range!=null?u.range:e["!ref"];switch(u.header===1?s=1:u.header==="A"?s=2:Array.isArray(u.header)?s=3:u.header==null&&(s=0),typeof d){case"string":c=at(d);break;case"number":c=at(e["!ref"]),c.s.r=d;break;default:c=d}s>0&&(n=0);var f=$t(c.s.r),h=[],m=[],x=0,p=0,g=Array.isArray(e),w=c.s.r,v=0,y={};g&&!e[w]&&(e[w]=[]);var b=u.skipHidden&&e["!cols"]||[],S=u.skipHidden&&e["!rows"]||[];for(v=c.s.c;v<=c.e.c;++v)if(!(b[v]||{}).hidden)switch(h[v]=At(v),r=g?e[w][v]:e[h[v]+f],s){case 1:a[v]=v-c.s.c;break;case 2:a[v]=h[v];break;case 3:a[v]=u.header[v-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=i=In(r,null,u),p=y[i]||0,!p)y[i]=1;else{do l=i+"_"+p++;while(y[l]);y[i]=p,y[l]=1}a[v]=l}for(w=c.s.r+n;w<=c.e.r;++w)if(!(S[w]||{}).hidden){var _=B$(e,c,w,h,s,a,g,u);(_.isempty===!1||(s===1?u.blankrows!==!1:u.blankrows))&&(m[x++]=_.row)}return m.length=x,m}var Tw=/"/g;function U$(e,t,r,s,n,a,i,l){for(var c=!0,u=[],d="",f=$t(r),h=t.s.c;h<=t.e.c;++h)if(s[h]){var m=l.dense?(e[r]||[])[h]:e[s[h]+f];if(m==null)d="";else if(m.v!=null){c=!1,d=""+(l.rawNumbers&&m.t=="n"?m.v:In(m,null,l));for(var x=0,p=0;x!==d.length;++x)if((p=d.charCodeAt(x))===n||p===a||p===34||l.forceQuotes){d='"'+d.replace(Tw,'""')+'"';break}d=="ID"&&(d='"ID"')}else m.f!=null&&!m.F?(c=!1,d="="+m.f,d.indexOf(",")>=0&&(d='"'+d.replace(Tw,'""')+'"')):d="";u.push(d)}return l.blankrows===!1&&c?null:u.join(i)}function cg(e,t){var r=[],s=t??{};if(e==null||e["!ref"]==null)return"";var n=at(e["!ref"]),a=s.FS!==void 0?s.FS:",",i=a.charCodeAt(0),l=s.RS!==void 0?s.RS:`
`,c=l.charCodeAt(0),u=new RegExp((a=="|"?"\\|":a)+"+$"),d="",f=[];s.dense=Array.isArray(e);for(var h=s.skipHidden&&e["!cols"]||[],m=s.skipHidden&&e["!rows"]||[],x=n.s.c;x<=n.e.c;++x)(h[x]||{}).hidden||(f[x]=At(x));for(var p=0,g=n.s.r;g<=n.e.r;++g)(m[g]||{}).hidden||(d=U$(e,n,g,f,i,c,a,s),d!=null&&(s.strip&&(d=d.replace(u,"")),(d||s.blankrows!==!1)&&r.push((p++?l:"")+d)));return delete s.dense,r.join("")}function GE(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=cg(e,t);return r}function z$(e){var t="",r,s="";if(e==null||e["!ref"]==null)return[];var n=at(e["!ref"]),a="",i=[],l,c=[],u=Array.isArray(e);for(l=n.s.c;l<=n.e.c;++l)i[l]=At(l);for(var d=n.s.r;d<=n.e.r;++d)for(a=$t(d),l=n.s.c;l<=n.e.c;++l)if(t=i[l]+a,r=u?(e[d]||[])[l]:e[t],s="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;s=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)s=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)s=""+r.v;else if(r.t=="b")s=r.v?"TRUE":"FALSE";else if(r.w!==void 0)s="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?s="'"+r.v:s=""+r.v}}c[c.length]=t+"="+s}return c}function KE(e,t,r){var s=r||{},n=+!s.skipHeader,a=e||{},i=0,l=0;if(a&&s.origin!=null)if(typeof s.origin=="number")i=s.origin;else{var c=typeof s.origin=="string"?Ft(s.origin):s.origin;i=c.r,l=c.c}var u,d={s:{c:0,r:0},e:{c:l,r:i+t.length-1+n}};if(a["!ref"]){var f=at(a["!ref"]);d.e.c=Math.max(d.e.c,f.e.c),d.e.r=Math.max(d.e.r,f.e.r),i==-1&&(i=f.e.r+1,d.e.r=i+t.length-1+n)}else i==-1&&(i=0,d.e.r=t.length-1+n);var h=s.header||[],m=0;t.forEach(function(p,g){Mt(p).forEach(function(w){(m=h.indexOf(w))==-1&&(h[m=h.length]=w);var v=p[w],y="z",b="",S=Ve({c:l+m,r:i+g+n});u=vc(a,S),v&&typeof v=="object"&&!(v instanceof Date)?a[S]=v:(typeof v=="number"?y="n":typeof v=="boolean"?y="b":typeof v=="string"?y="s":v instanceof Date?(y="d",s.cellDates||(y="n",v=rr(v)),b=s.dateNF||$e[14]):v===null&&s.nullError&&(y="e",v=0),u?(u.t=y,u.v=v,delete u.w,delete u.R,b&&(u.z=b)):a[S]=u={t:y,v},b&&(u.z=b))})}),d.e.c=Math.max(d.e.c,l+h.length-1);var x=$t(i);if(n)for(m=0;m<h.length;++m)a[At(m+l)+x]={t:"s",v:h[m]};return a["!ref"]=Ke(d),a}function $$(e,t){return KE(null,e,t)}function vc(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var s=Ft(t);return e[s.r]||(e[s.r]=[]),e[s.r][s.c]||(e[s.r][s.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?vc(e,Ve(t)):vc(e,Ve({r:t,c:r||0}))}function V$(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function ug(){return{SheetNames:[],Sheets:{}}}function dg(e,t,r,s){var n=1;if(!r)for(;n<=65535&&e.SheetNames.indexOf(r="Sheet"+n)!=-1;++n,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(s&&e.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);n=a&&+a[2]||0;var i=a&&a[1]||r;for(++n;n<=65535&&e.SheetNames.indexOf(r=i+n)!=-1;++n);}if(AE(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function W$(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var s=V$(e,t);switch(e.Workbook.Sheets[s]||(e.Workbook.Sheets[s]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[s].Hidden=r}function q$(e,t){return e.z=t,e}function XE(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function H$(e,t,r){return XE(e,"#"+t,r)}function G$(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function K$(e,t,r,s){for(var n=typeof t!="string"?t:at(t),a=typeof t=="string"?t:Ke(t),i=n.s.r;i<=n.e.r;++i)for(var l=n.s.c;l<=n.e.c;++l){var c=vc(e,i,l);c.t="n",c.F=a,delete c.v,i==n.s.r&&l==n.s.c&&(c.f=r,s&&(c.D=!0))}return e}var hr={encode_col:At,encode_row:$t,encode_cell:Ve,encode_range:Ke,decode_col:Ux,decode_row:Bx,split_cell:aO,decode_cell:Ft,decode_range:Zr,format_cell:In,sheet_add_aoa:bN,sheet_add_json:KE,sheet_add_dom:ME,aoa_to_sheet:Do,json_to_sheet:$$,table_to_sheet:BE,table_to_book:t$,sheet_to_csv:cg,sheet_to_txt:GE,sheet_to_json:Bd,sheet_to_html:LE,sheet_to_formulae:z$,sheet_to_row_object_array:Bd,sheet_get_cell:vc,book_new:ug,book_append_sheet:dg,book_set_sheet_visibility:W$,cell_set_number_format:q$,cell_set_hyperlink:XE,cell_set_internal_link:H$,cell_add_comment:G$,sheet_set_array_formula:K$,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};async function X$(e,t){let r=ie.from("quotes").select("*").eq("project_id",e);const{data:s,error:n}=await r;if(n)throw new Error(`Failed to fetch quotes: ${n.message}`);if(!s||s.length===0)return Q$(e,t);const a=s,i=a.map(y=>y.id),{data:l,error:c}=await ie.from("quote_items").select("*").in("quote_id",i).eq("is_excluded",!1);if(c)throw new Error(`Failed to fetch quote items: ${c.message}`);const u=l||[],d=a.map(y=>({quoteId:y.id,supplierName:y.supplier_name})),f=Y$(a,u),h=J$(a,u),m=Z$(a,u),x=eV(a,u),p=tV(a,u),g=rV(u),w=sV(a),v=nV(a,u);return{projectId:e,quoteIds:t,quotesAnalyzed:a.length,analyzedAt:new Date().toISOString(),summary:{totalRedFlags:f.length,criticalIssues:f.filter(y=>y.severity==="critical").length,coverageScore:p,averageQualityScore:g,bestValueSupplier:w,mostCompleteSupplier:v},redFlags:f,coverageGaps:h,systemsDetected:m,supplierInsights:x,normalizedItems:d}}function Q$(e,t){return{projectId:e,quoteIds:t,quotesAnalyzed:0,analyzedAt:new Date().toISOString(),summary:{totalRedFlags:0,criticalIssues:0,coverageScore:0,averageQualityScore:0,bestValueSupplier:"N/A",mostCompleteSupplier:"N/A"},redFlags:[],coverageGaps:[],systemsDetected:[],supplierInsights:[],normalizedItems:[]}}function Y$(e,t){const r=[];for(const s of e){const n=t.filter(f=>f.quote_id===s.id),a=n.reduce((f,h)=>f+(h.total_price||0),0),i=s.quoted_total||s.total_amount||0,l=Math.abs(a-i),c=i>0?l/i*100:0;c>10&&r.push({id:`price-discrepancy-${s.id}`,quoteId:s.id,severity:c>20?"critical":"high",category:"Pricing",title:"Significant Price Discrepancy",description:`Quote total ($${i.toLocaleString()}) differs from line items sum ($${a.toLocaleString()}) by ${c.toFixed(1)}%`,recommendation:"Verify quoted total matches line items. Check for missing items or calculation errors."}),n.length===0&&r.push({id:`no-items-${s.id}`,quoteId:s.id,severity:"critical",category:"Completeness",title:"No Line Items",description:"Quote contains no line items",recommendation:"Ensure quote has been properly imported with all line items."});const u=n.filter(f=>!f.unit_price||f.unit_price===0);u.length>0&&r.push({id:`missing-prices-${s.id}`,quoteId:s.id,severity:u.length>n.length*.1?"high":"medium",category:"Pricing",title:"Items Missing Unit Prices",description:`${u.length} items have no unit price specified`,recommendation:"Request unit prices for all items to enable accurate comparison."});const d=n.filter(f=>f.confidence!==null&&f.confidence<.7);d.length>n.length*.2&&r.push({id:`low-confidence-${s.id}`,quoteId:s.id,severity:"medium",category:"Data Quality",title:"Poor Data Normalization Quality",description:`${Math.round(d.length/n.length*100)}% of items have low confidence scores`,recommendation:"Review and manually correct items with low confidence scores for better comparison accuracy."}),(!s.contingency_amount||s.contingency_amount===0)&&r.push({id:`no-contingency-${s.id}`,quoteId:s.id,severity:"low",category:"Commercial",title:"No Contingency Specified",description:"Quote does not include a contingency amount",recommendation:"Confirm if contingency is included in pricing or needs to be added separately."})}return r}function J$(e,t){const r=[];if(e.length<2)return r;const s=new Map;for(const n of t){const a=n.scope_category||"Uncategorized";s.has(a)||s.set(a,new Map);const i=s.get(a);i.has(n.quote_id)||i.set(n.quote_id,new Set),i.get(n.quote_id).add(n.description.toLowerCase().trim())}for(const[n,a]of s){const i=Array.from(a.keys());if(i.length<e.length){const l=e.filter(c=>!i.includes(c.id));r.push({id:`missing-category-${n}`,gapType:"Missing Category",title:`Category "${n}" not quoted by all suppliers`,description:`${l.length} supplier(s) did not quote this category`,missingIn:l.map(c=>c.supplier_name),presentIn:e.filter(c=>i.includes(c.id)).map(c=>c.supplier_name),estimatedImpact:0,recommendation:"Request quotes for this category from suppliers who did not include it."})}}return r}function Z$(e,t){const r=[],s=new Map;for(const n of t)if(n.system_label&&n.system_id){const a=`${n.quote_id}-${n.system_id}`;s.has(a)||s.set(a,{quoteId:n.quote_id,items:[]}),s.get(a).items.push(n)}for(const[n,{quoteId:a,items:i}]of s){const l=i.reduce((u,d)=>u+(d.total_price||0),0),c=i.reduce((u,d)=>u+(d.confidence||0),0)/i.length;r.push({id:n,quoteId:a,systemName:i[0].system_label,systemType:i[0].system_id.split("-")[0]||"Unknown",itemCount:i.length,totalValue:l,confidence:c})}return r.sort((n,a)=>a.totalValue-n.totalValue)}function eV(e,t){const r=[];for(const s of e){const n=t.filter(c=>c.quote_id===s.id);if(n.length===0)continue;n.reduce((c,u)=>c+(u.unit_price||0),0)/n.length,n.filter(c=>c.unit_price>0).length/n.length*100===100&&r.push({id:`complete-${s.id}`,supplierName:s.supplier_name,insightType:"Positive",title:"Complete Pricing",description:"All items have unit prices specified, enabling full comparison.",recommendation:"This supplier has provided comprehensive pricing information."});const i=new Set(n.map(c=>c.scope_category)).size;i>5&&r.push({id:`comprehensive-${s.id}`,supplierName:s.supplier_name,insightType:"Positive",title:"Comprehensive Quote",description:`Quote covers ${i} different scope categories.`,recommendation:"This supplier has provided broad coverage across multiple work areas."});const l=new Set(n.filter(c=>c.system_id).map(c=>c.system_id)).size;l>3&&r.push({id:`systems-${s.id}`,supplierName:s.supplier_name,insightType:"Positive",title:"Multiple Systems Identified",description:`${l} fire protection systems detected in quote.`,recommendation:"Items have been successfully mapped to fire protection systems."})}return r}function tV(e,t){if(e.length===0)return 0;const r=new Set(t.map(n=>n.scope_category||"Uncategorized"));let s=0;for(const n of e){const a=t.filter(c=>c.quote_id===n.id),l=new Set(a.map(c=>c.scope_category||"Uncategorized")).size/r.size*100;s+=l}return Math.round(s/e.length)}function rV(e){if(e.length===0)return 0;const t=e.filter(l=>l.unit_price>0).length,r=e.filter(l=>l.system_id).length,s=e.reduce((l,c)=>l+(c.confidence||0),0)/e.length,n=t/e.length*40,a=r/e.length*30,i=s*30;return Math.round(n+a+i)}function sV(e){return e.length===0?"N/A":e.reduce((r,s)=>s.total_amount<r.total_amount?s:r).supplier_name}function nV(e,t){if(e.length===0)return"N/A";let r=e[0],s=0;for(const n of e){const a=t.filter(l=>l.quote_id===n.id),i=a.length+a.filter(l=>l.unit_price>0).length*2+a.filter(l=>l.system_id).length;i>s&&(s=i,r=n)}return r.supplier_name}async function aV(e,t){return X$(e,t)}function iV({projectId:e,projectName:t,onNavigateBack:r,onNavigateNext:s}){const[n,a]=j.useState(null),[i,l]=j.useState(!0),[c,u]=j.useState(null);j.useEffect(()=>{d()},[e]);const d=async()=>{l(!0),u(null);try{const v=await aV(e);a(v)}catch(v){u(v instanceof Error?v.message:"Failed to analyze quotes"),console.error("Quote intelligence error:",v)}finally{l(!1)}},f=()=>{window.print()},h=()=>{window.print()},m=()=>{if(!n)return;const v=hr.book_new(),y=[["Quote Intelligence Report"],["Project:",t||"Unknown"],["Generated:",new Date(n.analyzedAt).toLocaleString()],[],["Summary"],["Quotes Analyzed:",n.quotesAnalyzed],["Total Red Flags:",n.summary.totalRedFlags],["Critical Issues:",n.summary.criticalIssues],["Coverage Score:",`${n.summary.coverageScore}%`],["Average Quality Score:",`${n.summary.averageQualityScore}%`],["Best Value Supplier:",n.summary.bestValueSupplier],["Most Complete Supplier:",n.summary.mostCompleteSupplier]],b=hr.aoa_to_sheet(y);hr.book_append_sheet(v,b,"Summary");const S=[["Severity","Category","Title","Description","Supplier","Recommendation"],...n.redFlags.map(D=>{const W=n.normalizedItems.find(ee=>ee.quoteId===D.quoteId);return[D.severity,D.category,D.title,D.description,(W==null?void 0:W.supplierName)||"Unknown",D.recommendation]})],_=hr.aoa_to_sheet(S);hr.book_append_sheet(v,_,"Red Flags");const k=[["System Name","System Type","Supplier","Item Count","Total Value","Confidence"],...n.systemsDetected.map(D=>{const W=n.normalizedItems.find(ee=>ee.quoteId===D.quoteId);return[D.systemName,D.systemType,(W==null?void 0:W.supplierName)||"Unknown",D.itemCount,`$${D.totalValue.toLocaleString()}`,`${(D.confidence*100).toFixed(1)}%`]})],E=hr.aoa_to_sheet(k);hr.book_append_sheet(v,E,"Systems Detected");const T=[["Supplier","Type","Title","Description","Recommendation"],...n.supplierInsights.map(D=>[D.supplierName,D.insightType,D.title,D.description,D.recommendation])],M=hr.aoa_to_sheet(T);hr.book_append_sheet(v,M,"Supplier Insights");const q=`${t}_QuoteIntelligence.xlsx`;HE(v,q)},x=v=>({critical:v.filter(y=>y.severity==="critical"),high:v.filter(y=>y.severity==="high"),medium:v.filter(y=>y.severity==="medium"),low:v.filter(y=>y.severity==="low")}),p=()=>{if(!n)return[];const v=new Map;n.normalizedItems.forEach(b=>{v.has(b.quoteId)||v.set(b.quoteId,{name:b.supplierName,qualityScore:0,coverageScore:0,redFlags:0})}),n.redFlags.forEach(b=>{const S=v.get(b.quoteId);S&&S.redFlags++});const y=Array.from(v.values());return y.forEach(b=>{b.qualityScore=Math.max(0,100-b.redFlags*10),b.coverageScore=n.summary.coverageScore}),y.sort((b,S)=>S.qualityScore-b.qualityScore)};if(i)return o.jsx("div",{className:"flex items-center justify-center h-64",children:o.jsxs("div",{className:"text-center",children:[o.jsx(js,{className:"animate-spin mx-auto mb-4 text-blue-600",size:40}),o.jsx("p",{className:"text-lg font-medium text-gray-900",children:"Analyzing Quotes..."})]})});if(c||!n)return o.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx(_n,{className:"text-red-600 flex-shrink-0",size:24}),o.jsxs("div",{children:[o.jsx("h3",{className:"font-semibold text-red-900 mb-1",children:"Analysis Error"}),o.jsx("p",{className:"text-sm text-red-800",children:c||"No analysis data available"}),o.jsx("button",{onClick:d,className:"mt-3 px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 text-sm",children:"Retry Analysis"})]})]})});const g=x(n.redFlags),w=p();return o.jsxs("div",{className:"space-y-8",children:[o.jsx(h0,{currentStep:"quoteintel",onNavigateBack:r,onNavigateNext:s}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 print:shadow-none",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Quote Intelligence"}),o.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Automated analysis of supplier quotes"})]}),o.jsxs("div",{className:"flex gap-2 print:hidden",children:[o.jsxs("button",{onClick:m,className:"flex items-center gap-2 px-3 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 transition-colors text-sm",children:[o.jsx(Co,{size:16}),"Export Excel"]}),o.jsxs("button",{onClick:h,className:"flex items-center gap-2 px-3 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 transition-colors text-sm",children:[o.jsx(kF,{size:16}),"Export PDF"]}),o.jsxs("button",{onClick:f,className:"flex items-center gap-2 px-3 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 transition-colors text-sm",children:[o.jsx(fx,{size:16}),"Print"]})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-6",children:[o.jsx("div",{className:"bg-white rounded-2xl border border-gray-200 p-5 hover:shadow-md transition-shadow",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Issues Found"}),o.jsx("div",{className:"text-3xl font-bold text-gray-900",children:n.summary.totalRedFlags})]}),o.jsx("div",{className:"w-12 h-12 bg-orange-50 rounded-xl flex items-center justify-center",children:o.jsx(_n,{className:"text-orange-600",size:24})})]})}),o.jsx("div",{className:"bg-white rounded-2xl border border-gray-200 p-5 hover:shadow-md transition-shadow",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Critical Risks"}),o.jsx("div",{className:"text-3xl font-bold text-gray-900",children:n.summary.criticalIssues})]}),o.jsx("div",{className:"w-12 h-12 bg-red-50 rounded-xl flex items-center justify-center",children:o.jsx(Je,{className:"text-red-600",size:24})})]})}),o.jsx("div",{className:"bg-white rounded-2xl border border-gray-200 p-5 hover:shadow-md transition-shadow",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Top Supplier"}),o.jsx("div",{className:"text-xl font-bold text-gray-900 truncate",children:n.summary.mostCompleteSupplier})]}),o.jsx("div",{className:"w-12 h-12 bg-blue-50 rounded-xl flex items-center justify-center",children:o.jsx(DF,{className:"text-blue-600",size:24})})]})})]})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 print:shadow-none",children:[o.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Supplier Comparison"}),w.length===0?o.jsx("p",{className:"text-gray-600 py-4",children:"No supplier data available."}):o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full",children:[o.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Supplier"}),o.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Quality Score"}),o.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Coverage Score"}),o.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Red Flags"})]})}),o.jsx("tbody",{className:"divide-y divide-gray-200",children:w.map((v,y)=>o.jsxs("tr",{className:"hover:bg-gray-50",children:[o.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:v.name}),o.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-2 max-w-[120px]",children:o.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${v.qualityScore}%`}})}),o.jsxs("span",{className:"font-medium",children:[v.qualityScore,"%"]})]})}),o.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-2 max-w-[120px]",children:o.jsx("div",{className:"bg-green-600 h-2 rounded-full",style:{width:`${v.coverageScore}%`}})}),o.jsxs("span",{className:"font-medium",children:[v.coverageScore,"%"]})]})}),o.jsx("td",{className:"px-4 py-3 text-sm",children:o.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${v.redFlags===0?"bg-green-100 text-green-800":v.redFlags<=2?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:v.redFlags})})]},y))})]})})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 print:shadow-none print:break-after-page",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[o.jsx(_n,{className:"text-red-600",size:24}),o.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Red Flags"})]}),n.redFlags.length===0?o.jsxs("div",{className:"text-center py-8",children:[o.jsx(Yt,{className:"mx-auto text-green-600 mb-3",size:48}),o.jsx("p",{className:"text-gray-900 font-medium",children:"No red flags detected"}),o.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"All quotes passed automated quality checks"})]}):o.jsxs("div",{className:"space-y-6",children:[g.critical.length>0&&o.jsxs("div",{children:[o.jsxs("h3",{className:"text-lg font-semibold text-red-900 mb-3 flex items-center gap-2",children:[o.jsx(Je,{size:20}),"Critical (",g.critical.length,")"]}),o.jsx("div",{className:"space-y-3",children:g.critical.map(v=>{const y=n.normalizedItems.find(b=>b.quoteId===v.quoteId);return o.jsxs("div",{className:"border border-red-300 rounded-lg p-4 bg-red-50",children:[o.jsx("div",{className:"flex items-start justify-between mb-2",children:o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[o.jsx("span",{className:"text-xs font-bold uppercase px-2 py-1 bg-red-600 text-white rounded",children:v.severity}),o.jsx("span",{className:"text-sm font-medium text-red-900",children:v.category})]}),o.jsx("h4",{className:"font-semibold text-gray-900",children:v.title}),o.jsx("p",{className:"text-sm text-gray-700 mt-1",children:(y==null?void 0:y.supplierName)||"Unknown Supplier"})]})}),o.jsx("p",{className:"text-sm text-gray-800 mb-2",children:v.description}),v.recommendation&&o.jsxs("div",{className:"mt-3 pt-3 border-t border-red-200",children:[o.jsx("p",{className:"text-sm font-medium text-gray-900 mb-1",children:"Recommendation:"}),o.jsx("p",{className:"text-sm text-gray-700",children:v.recommendation})]})]},v.id)})})]}),g.high.length>0&&o.jsxs("div",{children:[o.jsxs("h3",{className:"text-lg font-semibold text-orange-900 mb-3 flex items-center gap-2",children:[o.jsx(_n,{size:20}),"High (",g.high.length,")"]}),o.jsx("div",{className:"space-y-3",children:g.high.map(v=>{const y=n.normalizedItems.find(b=>b.quoteId===v.quoteId);return o.jsxs("div",{className:"border border-orange-300 rounded-lg p-4 bg-orange-50",children:[o.jsx("div",{className:"flex items-start justify-between mb-2",children:o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[o.jsx("span",{className:"text-xs font-bold uppercase px-2 py-1 bg-orange-600 text-white rounded",children:v.severity}),o.jsx("span",{className:"text-sm font-medium text-orange-900",children:v.category})]}),o.jsx("h4",{className:"font-semibold text-gray-900",children:v.title}),o.jsx("p",{className:"text-sm text-gray-700 mt-1",children:(y==null?void 0:y.supplierName)||"Unknown Supplier"})]})}),o.jsx("p",{className:"text-sm text-gray-800 mb-2",children:v.description}),v.recommendation&&o.jsxs("div",{className:"mt-3 pt-3 border-t border-orange-200",children:[o.jsx("p",{className:"text-sm font-medium text-gray-900 mb-1",children:"Recommendation:"}),o.jsx("p",{className:"text-sm text-gray-700",children:v.recommendation})]})]},v.id)})})]}),g.medium.length>0&&o.jsxs("div",{children:[o.jsxs("h3",{className:"text-lg font-semibold text-yellow-900 mb-3",children:["Medium (",g.medium.length,")"]}),o.jsx("div",{className:"space-y-2",children:g.medium.map(v=>{const y=n.normalizedItems.find(b=>b.quoteId===v.quoteId);return o.jsxs("div",{className:"border border-yellow-300 rounded-lg p-3 bg-yellow-50",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[o.jsx("span",{className:"text-xs font-bold uppercase px-2 py-0.5 bg-yellow-600 text-white rounded",children:v.severity}),o.jsx("span",{className:"text-sm font-semibold text-gray-900",children:v.title}),o.jsxs("span",{className:"text-sm text-gray-600",children:[" ",(y==null?void 0:y.supplierName)||"Unknown"]})]}),o.jsx("p",{className:"text-sm text-gray-700",children:v.description})]},v.id)})})]}),g.low.length>0&&o.jsxs("div",{children:[o.jsxs("h3",{className:"text-lg font-semibold text-blue-900 mb-3",children:["Low (",g.low.length,")"]}),o.jsx("div",{className:"space-y-2",children:g.low.map(v=>{const y=n.normalizedItems.find(b=>b.quoteId===v.quoteId);return o.jsxs("div",{className:"border border-blue-200 rounded-lg p-3 bg-blue-50",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[o.jsx("span",{className:"text-xs font-bold uppercase px-2 py-0.5 bg-blue-600 text-white rounded",children:v.severity}),o.jsx("span",{className:"text-sm font-semibold text-gray-900",children:v.title}),o.jsxs("span",{className:"text-sm text-gray-600",children:[" ",(y==null?void 0:y.supplierName)||"Unknown"]})]}),o.jsx("p",{className:"text-sm text-gray-700",children:v.description})]},v.id)})})]})]})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 print:shadow-none",children:[o.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Recommended Actions"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:border-blue-300 hover:shadow-md transition-all",children:[o.jsxs("div",{className:"flex items-start justify-between mb-3",children:[o.jsx("div",{className:"w-10 h-10 bg-blue-50 rounded-lg flex items-center justify-center",children:o.jsx(lm,{className:"text-blue-600",size:20})}),o.jsx(Wu,{className:"text-gray-400",size:18})]}),o.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Normalise Remaining Items"}),o.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Ensure all line items have standardized units and attributes for accurate comparison."}),o.jsx("button",{onClick:r,className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:"Go to Review & Clean "})]}),o.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:border-green-300 hover:shadow-md transition-all",children:[o.jsxs("div",{className:"flex items-start justify-between mb-3",children:[o.jsx("div",{className:"w-10 h-10 bg-green-50 rounded-lg flex items-center justify-center",children:o.jsx(Ao,{className:"text-green-600",size:20})}),o.jsx(Wu,{className:"text-gray-400",size:18})]}),o.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Map Unmapped Systems"}),o.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Complete system mapping to improve coverage analysis and reporting accuracy."}),o.jsx("button",{onClick:r,className:"text-sm text-green-600 hover:text-green-700 font-medium",children:"Go to Review & Clean "})]}),o.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:border-purple-300 hover:shadow-md transition-all",children:[o.jsxs("div",{className:"flex items-start justify-between mb-3",children:[o.jsx("div",{className:"w-10 h-10 bg-purple-50 rounded-lg flex items-center justify-center",children:o.jsx(c0,{className:"text-purple-600",size:20})}),o.jsx(Wu,{className:"text-gray-400",size:18})]}),o.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Review Problematic Rows"}),o.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Address flagged items to improve quote quality before generating reports."}),o.jsx("button",{onClick:r,className:"text-sm text-purple-600 hover:text-purple-700 font-medium",children:"Go to Review & Clean "})]})]})]}),n.coverageGaps&&n.coverageGaps.length>0&&o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 print:shadow-none print:break-after-page",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[o.jsx(lm,{className:"text-orange-600",size:24}),o.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Coverage Gaps"})]}),o.jsx("div",{className:"space-y-3",children:n.coverageGaps.map(v=>o.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50",children:[o.jsx("div",{className:"flex items-start justify-between mb-2",children:o.jsxs("div",{className:"flex-1",children:[o.jsx("div",{className:"flex items-center gap-2 mb-1",children:o.jsx("span",{className:"text-xs font-medium uppercase px-2 py-1 bg-gray-600 text-white rounded",children:v.gapType})}),o.jsx("h4",{className:"font-semibold text-gray-900",children:v.title})]})}),o.jsx("p",{className:"text-sm text-gray-700 mb-2",children:v.description}),v.recommendation&&o.jsxs("div",{className:"mt-2 pt-2 border-t border-gray-300",children:[o.jsx("p",{className:"text-sm font-medium text-gray-900 mb-1",children:"Recommendation:"}),o.jsx("p",{className:"text-sm text-gray-700",children:v.recommendation})]})]},v.id))})]})]})}function oV(e){return o.jsx(iV,{...e})}async function lV(e){return{}}async function cV(e,t){return null}function fg(e){return{loadSettings:async()=>{console.log("ModelRateProvider: loadSettings called for project",e)},getModelRate:t=>{const{data:r}={data:{rate:null,componentCount:null}};return r},getRate:async t=>cV(),getRates:async()=>lV()}}async function QE(e,t,r){console.log("compareAgainstModelHybrid: Processing",e.length,"lines"),console.log("compareAgainstModelHybrid: Mappings:",t.length),console.log("compareAgainstModelHybrid: Sample mapping:",t[0]);const s=[];let n=0,a=0;for(const i of e){const l=t.find(x=>x.quoteItemId===i.quoteItemId);if(!l){console.warn("compareAgainstModelHybrid: No mapping found for quote item:",i.quoteItemId),n++,s.push({quoteId:i.quoteId,quoteItemId:i.quoteItemId,supplier:i.supplier,systemId:"UNMAPPED",systemLabel:"Unmapped Items",section:i.section,service:i.service||i.serviceType,subclass:i.subclass,frr:i.frr,sizeBucket:i.size,quantity:i.quantity,unitRate:i.rate,total:i.total,modelRate:null,componentCount:null,variancePct:null,flag:"NA"});continue}if(!l.systemId){n<3&&console.warn("compareAgainstModelHybrid: Mapping has no systemId:",{quoteItemId:l.quoteItemId,systemId:l.systemId,systemLabel:l.systemLabel}),n++,s.push({quoteId:i.quoteId,quoteItemId:i.quoteItemId,supplier:i.supplier,systemId:"UNMAPPED",systemLabel:"Unmapped Items",section:i.section,service:i.service||i.serviceType,subclass:i.subclass,frr:i.frr,sizeBucket:i.size,quantity:i.quantity,unitRate:i.rate,total:i.total,modelRate:null,componentCount:null,variancePct:null,flag:"NA"});continue}a++;const c={systemId:l.systemId,section:i.section,service:i.service||i.serviceType,subclass:i.subclass,frr:i.frr,size:i.size},u=r(c),d=(u==null?void 0:u.rate)||null,f=(u==null?void 0:u.componentCount)||null;let h=null,m="NA";d!==null&&i.rate>0&&(h=(i.rate-d)/d*100,Math.abs(h)<=10?m="GREEN":Math.abs(h)<=25?m="AMBER":m="RED"),s.push({quoteId:i.quoteId,quoteItemId:i.quoteItemId,supplier:i.supplier,systemId:l.systemId,systemLabel:l.systemLabel||"",section:i.section,service:i.service||i.serviceType,subclass:i.subclass,frr:i.frr,sizeBucket:i.size,quantity:i.quantity,unitRate:i.rate,total:i.total,modelRate:d,componentCount:f,variancePct:h,flag:m})}return console.log("compareAgainstModelHybrid: Generated",s.length,"comparison rows"),console.log("compareAgainstModelHybrid: Mapped items:",a),console.log("compareAgainstModelHybrid: Unmapped items:",n),s.length>0&&console.log("compareAgainstModelHybrid: Sample comparison row:",s[0]),s}function uV(e){const[t,r]=j.useState([]),[s,n]=j.useState(!0),[a,i]=j.useState(null),l=async()=>{if(!e){n(!1);return}n(!0),i(null);try{const{data:c}=await ie.from("quotes").select("id, supplier_name").eq("project_id",e);if(!c||c.length===0){r([]),n(!1);return}const u=c.map(g=>g.id),{data:d,error:f}=await ie.from("quote_items").select("id, description, unit_price, system_id, quantity, quote_id").in("quote_id",u);if(f)throw f;if(!d||d.length===0){r([]),n(!1);return}const m=d.map(g=>{const w=c.find(v=>v.id===g.quote_id);return{...g,supplier_name:(w==null?void 0:w.supplier_name)||"Unknown"}}).filter(g=>kx(g)?!1:!g.system_id||g.system_id===""||g.system_id==="unknown"),x=new Map;m.forEach(g=>{const w=VR(g.description);w&&(x.has(w)||x.set(w,[]),x.get(w).push(g))});const p=[];x.forEach((g,w)=>{if(g.length<2)return;const v=[...new Set(g.map(E=>E.supplier_name))],y=g.map(E=>E.unit_price).filter(E=>E>0),b=y.length>0?Math.min(...y):0,S=y.length>0?Math.max(...y):0,_=g[0].description,k=WR(_);p.push({key:w,defaultName:k,exampleDescription:_,suppliers:v,count:g.length,rateMin:b,rateMax:S,itemIds:g.map(E=>E.id)})}),p.sort((g,w)=>w.count-g.count),r(p)}catch(c){console.error("Error loading suggested systems:",c),i(c instanceof Error?c.message:"Failed to load suggestions")}finally{n(!1)}};return j.useEffect(()=>{l()},[e]),{suggestions:t,loading:s,error:a,reload:l}}function dV(){return null}const fV=e=>{switch(e){case"GREEN":return"bg-green-100 text-green-900 border-green-300";case"AMBER":return"bg-amber-100 text-amber-900 border-amber-300";case"RED":return"bg-red-100 text-red-900 border-red-300";default:return"bg-gray-100 text-gray-600 border-gray-300"}};function Vf(e){return e.parse_status==="completed"&&e.items_count>0}function hV({projectId:e,onNavigateBack:t,onNavigateNext:r}){const[s,n]=j.useState([]),[a,i]=j.useState([]),[l,c]=j.useState([]),[u,d]=j.useState(!1),[f,h]=j.useState(!1),[m,x]=j.useState(new Set),[p,g]=j.useState(!1),[w,v]=j.useState(!1),{currentOrganisation:y}=wa(),b=(y==null?void 0:y.id)||"",{suggestions:S}=uV(e),[_,k]=j.useState([]),[E,T]=j.useState([]),[M,q]=j.useState(!1),[D,W]=j.useState(!1),[ee,Y]=j.useState(!0),[G,ce]=j.useState(null),[Q,B]=j.useState({}),[me,fe]=j.useState({sections:[],services:[],subclasses:[],frrs:[],sizeBuckets:[]});console.log("========== SCOPE MATRIX DEBUG =========="),console.log("ScopeMatrix render:",{projectId:e,comparisonDataLength:s.length,matrixRowsLength:a.length,suppliersCount:l.length,loading:u,hasFilters:Object.keys(Q).length>0}),j.useEffect(()=>{A()},[e]),j.useEffect(()=>{xe()},[s,Q]);const A=async()=>{Y(!0);try{const{data:X}=await ie.from("quotes").select("id, supplier_name, quote_reference, total_amount, items_count").eq("project_id",e).order("supplier_name");if(X){const z=await Promise.all(X.map(async H=>{var Ue;const{data:Z}=await ie.from("parsing_jobs").select("status, error_message, parsed_lines").eq("quote_id",H.id).order("created_at",{ascending:!1}).limit(1).maybeSingle(),{count:J}=await ie.from("quote_items").select("*",{count:"exact",head:!0}).eq("quote_id",H.id),{count:K}=await ie.from("quote_items").select("*",{count:"exact",head:!0}).eq("quote_id",H.id).not("system_id","is",null),le=J||0,ye=K||0,Re=((Ue=Z==null?void 0:Z.error_message)==null?void 0:Ue.includes("chunks failed"))||!1;let Te="completed";return Z&&(Z.status==="completed"&&le===0?Te="failed":Z.status==="completed"&&Re?Te="partial":Z.status==="failed"?Te="failed":Te=Z.status),{id:H.id,supplier_name:H.supplier_name,quote_reference:H.quote_reference,total_amount:H.total_amount,items_count:le,mapped_items_count:ye,parse_status:Te,has_failed_chunks:Re}}));console.log("=== LOADED QUOTES WITH STATUS ==="),z.forEach(H=>{console.log(`${H.supplier_name}:`,{items_count:H.items_count,mapped_items_count:H.mapped_items_count,parse_status:H.parse_status,has_failed_chunks:H.has_failed_chunks})}),console.log("================================="),k(z)}}catch(X){console.error("Error loading quotes:",X)}finally{Y(!1)}},V=async()=>{E.length!==0&&(console.log("=== SCOPE MATRIX GENERATION START ==="),console.log("Selected Quote IDs:",E),console.log("Project ID:",e),q(!0),await U(),W(!0),q(!1),console.log("=== SCOPE MATRIX GENERATION END ==="))},L=(X,z)=>{const H={},Z={},J={};for(const ye of X)H[ye.quote_id]=(H[ye.quote_id]||0)+1,ye.system_id&&(Z[ye.quote_id]=(Z[ye.quote_id]||0)+1,J[ye.system_id]||(J[ye.system_id]=new Set),J[ye.system_id].add(ye.quote_id));const K=Object.entries(J).filter(([,ye])=>ye.size>=2).map(([ye])=>ye);let le="success";return X.length===0?le="no_items":Object.values(Z).every(ye=>ye===0)?le="no_mapped_items":K.length===0&&(le="no_overlap"),{totalItems:X.length,itemsByQuote:H,itemsWithSystemByQuote:Z,overlappingSystemsCount:K.length,overlappingSystems:K,selectedQuoteIds:z,reason:le}},U=async()=>{var X,z;d(!0);try{const H=E.length>0?E:_.map(Ce=>Ce.id),{data:Z}=await ie.from("quotes").select("id, supplier_name").in("id",H).order("supplier_name");if(!Z||Z.length===0){d(!1);return}const J=Z.map(Ce=>Ce.id),{data:K}=await ie.from("quote_items").select("*").in("quote_id",J);if(!K){console.error("ScopeMatrix: No items data returned from database"),d(!1);return}const le=L(K,J);ce(le),console.log("=== SCOPE MATRIX DIAGNOSTICS ==="),console.log("Total Items:",le.totalItems),console.log("Items by Quote:",le.itemsByQuote),console.log("Items with System by Quote:",le.itemsWithSystemByQuote),console.log("Overlapping Systems Count:",le.overlappingSystemsCount),console.log("Overlapping Systems:",le.overlappingSystems),console.log("Reason:",le.reason),console.log("================================"),console.log("ScopeMatrix: Loading data for project",e),console.log("ScopeMatrix: Found",Z.length,"quotes and",K.length,"items");const ye=K.filter(Ce=>Ce.system_id);if(console.log("ScopeMatrix: Items with system_id:",ye.length),K.length>0){const Ce=K[0];console.log("ScopeMatrix: Sample item data:",{id:Ce.id,description:(X=Ce.description)==null?void 0:X.substring(0,50),system_id:Ce.system_id,system_label:Ce.system_label,service:Ce.service,subclass:Ce.subclass,frr:Ce.frr,size:Ce.size,quantity:Ce.quantity,unit_price:Ce.unit_price,canonical_unit:Ce.canonical_unit})}ye.length===0?(console.warn("ScopeMatrix: WARNING - No items have system_id mapped! Matrix will be empty."),console.warn("ScopeMatrix: Make sure you have completed Review & Clean > Smart Clean or mapping step.")):console.log("ScopeMatrix: Sample mapped item:",{system_id:ye[0].system_id,system_label:ye[0].system_label,description:(z=ye[0].description)==null?void 0:z.substring(0,50)});const Re=new Set(K.filter(Ce=>kx(Ce)).map(Ce=>Ce.id));x(Re);const Te=K.map(Ce=>{const Fe=Z.find(Vr=>Vr.id===Ce.quote_id),rt=Ce.service||Ce.mapped_service_type||Ce.serviceType,sr=Ce.mapped_system||Ce.systemType,xt=Ce.mapped_penetration||Ce.penetrationType;return{quoteId:Ce.quote_id,quoteItemId:Ce.id,supplier:(Fe==null?void 0:Fe.supplier_name)||"Unknown",originalDescription:Ce.description,quantity:Ce.quantity||1,rate:Ce.unit_price,total:Ce.total_price,section:Ce.section,service:rt,serviceType:rt,subclass:Ce.subclass,frr:Ce.frr,size:Ce.size,systemType:sr,penetrationType:xt}});console.log("ScopeMatrix: Normalised",Te.length,"lines"),console.log("ScopeMatrix: Sample item:",Te[0]);const Ue=K.map(Ce=>({quoteItemId:Ce.id,systemId:Ce.system_id,systemLabel:Ce.system_label}));console.log("ScopeMatrix: Created",Ue.length,"mappings"),console.log("ScopeMatrix: Sample mappings:",Ue.slice(0,3));const it=Ue.filter(Ce=>Ce.systemId);console.log("ScopeMatrix: Mappings with system_id:",it.length,"/",Ue.length),it.length>0?console.log("ScopeMatrix: Sample mapped item:",it[0]):(console.warn("ScopeMatrix: NO MAPPINGS FOUND! Items are not mapped to systems."),console.warn("ScopeMatrix: Sample unmapped item:",Ue[0]));const pt=fg(e);await pt.loadSettings(),console.log("ScopeMatrix: Model rate provider loaded");const tt=await QE(Te,Ue,Ce=>pt.getModelRate(Ce));if(console.log("ScopeMatrix: Generated",tt.length,"comparison rows"),tt.length>0){console.log("ScopeMatrix: Sample comparison:",tt[0]);const Ce=Array.from(new Set(tt.map(Fe=>Fe.supplier)));console.log("ScopeMatrix: Unique suppliers in comparisons:",Ce)}else console.error("ScopeMatrix: ERROR - compareAgainstModelHybrid returned 0 rows!"),console.log("ScopeMatrix: Check if items have system_id and if model rates are configured");n(tt),ne(tt),console.log("ScopeMatrix: comparisonData state set with",tt.length,"rows"),await ie.from("project_settings").upsert({project_id:e,scope_matrix_completed:!0,updated_at:new Date().toISOString()},{onConflict:"project_id"})}catch(H){console.error("ScopeMatrix: Error loading data:",H),console.error("ScopeMatrix: Error details:",{message:H instanceof Error?H.message:"Unknown error",stack:H instanceof Error?H.stack:void 0}),n([])}finally{d(!1)}},ne=X=>{const z=new Set,H=new Set,Z=new Set,J=new Set,K=new Set;X.forEach(le=>{le.section&&z.add(le.section),le.service&&H.add(le.service),le.subclass&&Z.add(le.subclass),le.frr&&J.add(le.frr),le.sizeBucket&&K.add(le.sizeBucket)}),fe({sections:Array.from(z).sort(),services:Array.from(H).sort(),subclasses:Array.from(Z).sort(),frrs:Array.from(J).sort(),sizeBuckets:Array.from(K).sort()})},xe=()=>{console.log("=== BUILD MATRIX START ==="),console.log("buildMatrix: Starting with",s.length,"comparison rows"),console.log("buildMatrix: Has generated:",D),console.log("buildMatrix: Active filters:",Q);let X=s;Q.section&&(X=X.filter(K=>K.section===Q.section)),Q.service&&(X=X.filter(K=>K.service===Q.service)),Q.subclass&&(X=X.filter(K=>K.subclass===Q.subclass)),Q.frr&&(X=X.filter(K=>K.frr===Q.frr)),Q.sizeBucket&&(X=X.filter(K=>K.sizeBucket===Q.sizeBucket)),console.log("buildMatrix: After filtering:",X.length,"rows");const z=Array.from(new Set(X.map(K=>K.supplier))).sort();c(z),console.log("buildMatrix: Found",z.length,"suppliers:",z);const H=new Map;X.forEach(K=>{const le=`${K.systemId}|${K.systemLabel}`;H.has(le)||H.set(le,{systemId:K.systemId,systemLabel:K.systemLabel,section:K.section,service:K.service,subclass:K.subclass,frr:K.frr,sizeBucket:K.sizeBucket,cells:{}});const ye=H.get(le);if(!ye.cells[K.supplier])ye.cells[K.supplier]={unitRate:K.unitRate,flag:K.flag,modelRate:K.modelRate,variancePct:K.variancePct,componentCount:1,quoteId:K.quoteId,quoteItemId:K.quoteItemId,totalQuantity:K.quantity||0,totalValue:K.total||0};else{const Re=ye.cells[K.supplier],Te=Re.totalValue||0,it=(Re.totalQuantity||0)+(K.quantity||0),pt=Te+(K.total||0);if(Re.totalQuantity=it,Re.totalValue=pt,Re.componentCount=(Re.componentCount||0)+1,Re.unitRate=it>0?pt/it:Re.unitRate,K.modelRate!==null&&Re.unitRate>0){const tt=(Re.unitRate-K.modelRate)/K.modelRate*100;Re.variancePct=tt,Math.abs(tt)<=10?Re.flag="GREEN":Math.abs(tt)<=25?Re.flag="AMBER":Re.flag="RED"}}});const Z=Array.from(H.values()).sort((K,le)=>K.systemId==="UNMAPPED"&&le.systemId!=="UNMAPPED"?1:le.systemId==="UNMAPPED"&&K.systemId!=="UNMAPPED"?-1:K.systemLabel.localeCompare(le.systemLabel));console.log("buildMatrix: Generated",Z.length,"matrix rows"),console.log("buildMatrix: Rows by systemId breakdown:");const J=new Map;X.forEach(K=>{J.set(K.systemId,(J.get(K.systemId)||0)+1)}),J.forEach((K,le)=>{console.log(`  - ${le}: ${K} items`)}),Z.length>0?(console.log("buildMatrix: Sample row:",Z[0]),console.log("buildMatrix: Sample row cells:",Object.keys(Z[0].cells))):(console.warn("buildMatrix: WARNING - No matrix rows generated!"),console.warn("buildMatrix: Diagnostics:",G),X.length>0&&(console.warn("buildMatrix: We have filtered data but no rows! This is the bug."),console.warn("buildMatrix: Sample filtered data:",X.slice(0,3)))),i(Z),console.log("=== BUILD MATRIX END ===")},pe=()=>{try{if(console.log("Export CSV clicked",{matrixRowsCount:a.length,suppliersCount:l.length}),a.length===0){alert("No data available to export. Please ensure quotes are imported and the matrix has been generated.");return}const X=["System ID","System Label","Section","Service","Subclass","FRR","Size Bucket"];l.forEach(le=>{X.push(`${le} - Unit Rate`),X.push(`${le} - Model Rate`),X.push(`${le} - Variance %`),X.push(`${le} - Flag`)});const z=a.map(le=>{const ye=[le.systemId,le.systemLabel,le.section||"",le.service||"",le.subclass||"",le.frr||"",le.sizeBucket||""];return l.forEach(Re=>{var Ue,it,pt;const Te=le.cells[Re];Te?(ye.push(((Ue=Te.unitRate)==null?void 0:Ue.toFixed(2))||""),ye.push(((it=Te.modelRate)==null?void 0:it.toFixed(2))||""),ye.push(((pt=Te.variancePct)==null?void 0:pt.toFixed(2))||""),ye.push(Te.flag)):ye.push("","","","")}),ye}),H=[X.join(","),...z.map(le=>le.map(ye=>`"${ye}"`).join(","))].join(`
`),Z=new Blob([H],{type:"text/csv;charset=utf-8;"}),J=URL.createObjectURL(Z),K=document.createElement("a");K.href=J,K.download=`scope-matrix-${e}-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(K),K.click(),document.body.removeChild(K),URL.revokeObjectURL(J),console.log("Export completed successfully")}catch(X){console.error("Error exporting CSV:",X),alert("Failed to export CSV. Check console for details.")}},oe=()=>{B({})},ue=Object.values(Q).some(X=>X),we=X=>{T(z=>z.includes(X)?z.filter(H=>H!==X):[...z,X])},P=()=>{const X=_.filter(Vf);E.length===X.length?T([]):T(X.map(z=>z.id))},Me=_.filter(Vf);console.log("=== SCOPE MATRIX QUOTE FILTERING ==="),console.log("Total available quotes:",_.length),console.log("Ready quotes:",Me.length),_.forEach(X=>{const z=Vf(X);console.log(`Quote "${X.supplier_name}":`,{isReady:z,parse_status:X.parse_status,items_count:X.items_count,mapped_items_count:X.mapped_items_count,has_failed_chunks:X.has_failed_chunks})}),console.log("====================================");const je=Me.length>0&&E.length===Me.length;return o.jsxs("div",{className:"min-h-screen",children:[o.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-6",children:[o.jsxs("div",{className:"mb-6",children:[o.jsxs("button",{onClick:t,className:"flex items-center gap-2 text-sm text-gray-600 hover:text-gray-900 mb-4 transition-colors",children:[o.jsx(Tc,{size:16}),"Back to Project Dashboard"]}),o.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Scope Matrix"}),o.jsx("p",{className:"text-base text-gray-600",children:"Compare supplier quotes and generate your scope matrix."})]}),o.jsxs("div",{className:"bg-white rounded-lg p-6 border border-gray-200 shadow-sm mb-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Supplier Quotes"}),Me.length>0&&o.jsxs("button",{onClick:P,className:"flex items-center gap-2 text-sm text-gray-600 hover:text-gray-900 font-medium",children:[je?o.jsx(Uy,{size:16}):o.jsx(Vy,{size:16}),je?"Deselect All":"Select All"]})]}),_.length>Me.length&&o.jsx("div",{className:"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg text-sm",children:o.jsxs("div",{className:"flex items-start gap-2",children:[o.jsx(vo,{size:16,className:"text-blue-600 flex-shrink-0 mt-0.5"}),o.jsxs("div",{className:"text-blue-800",children:[_.length-Me.length," quote(s) are not ready for comparison. Fix imports in ",o.jsx("a",{href:"#/import-quotes",className:"underline font-medium",children:"Import Quotes"})," or"," ",o.jsx("a",{href:"#/review-clean",className:"underline font-medium",children:"Review & Clean"}),"."]})]})}),ee?o.jsx("div",{className:"text-center py-8 text-gray-500 text-sm",children:"Loading quotes..."}):Me.length===0?o.jsxs("div",{className:"text-center py-12",children:[o.jsx(Je,{className:"mx-auto text-gray-400 mb-4",size:48}),o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No quotes ready for Scope Matrix"}),o.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"To compare suppliers, first import and clean at least one supplier quote."}),o.jsx("a",{href:"#/import-quotes",className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md font-medium transition-colors",children:"Go to Import Quotes"})]}):o.jsx("div",{className:"space-y-2",children:Me.map(X=>{var H;const z=E.includes(X.id);return o.jsxs("button",{onClick:()=>we(X.id),className:`w-full flex items-center gap-3 py-3 px-3 rounded-lg border transition-all text-left ${z?"border-gray-300 bg-gray-50":"border-gray-200 bg-white hover:bg-gray-50"}`,children:[o.jsx("div",{className:"flex-shrink-0",children:z?o.jsx(Uy,{className:"text-blue-600",size:18}):o.jsx(Vy,{className:"text-gray-400",size:18})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:"font-semibold text-gray-900 text-sm",children:X.supplier_name}),o.jsxs("div",{className:"text-xs text-gray-500 mt-0.5",children:[X.items_count," items ",X.mapped_items_count>0?o.jsxs("span",{className:"text-green-600 font-medium",children:[" ",X.mapped_items_count," mapped"]}):o.jsx("span",{className:"text-amber-600 font-medium",children:" 0 mapped (needs Review & Clean)"})," $",((H=X.total_amount)==null?void 0:H.toLocaleString())||"0",X.mapped_items_count>0?o.jsx("span",{className:"text-green-600 font-medium ml-2",children:" Ready"}):o.jsx("span",{className:"text-amber-600 font-medium ml-2",children:" Needs mapping"})]})]})]},X.id)})}),E.length>0&&o.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[o.jsx("div",{className:"text-sm text-gray-900 font-medium mb-1",children:E.length===1?"Select at least 2 suppliers to generate a scope matrix.":o.jsxs(o.Fragment,{children:["Comparing: ",Me.filter(X=>E.includes(X.id)).map(X=>X.supplier_name).join(" vs ")]})}),E.length>=2&&(()=>{const X=Me.filter(J=>E.includes(J.id)),z=X.every(J=>J.mapped_items_count>0),H=X.reduce((J,K)=>J+K.mapped_items_count,0),Z=X.reduce((J,K)=>J+K.items_count,0);return o.jsx("div",{className:`text-xs ${z?"text-green-600":"text-amber-600"}`,children:z?` All selected quotes are normalised and mapped (${H}/${Z} items)`:" Some quotes need mapping - Go to Review & Clean and run Smart Clean"})})()]}),o.jsx("div",{className:"flex items-end justify-end mt-6",children:o.jsxs("div",{className:"text-right",children:[o.jsx("button",{onClick:V,disabled:E.length<2||M,className:"px-6 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-md font-medium transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed text-sm",children:M?"Building Matrix...":"Generate Scope Matrix"}),o.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Only updated quotes will be reprocessed."})]})})]}),!D&&!u&&E.length===0&&o.jsxs("div",{className:"bg-white rounded-lg p-8 border border-gray-200 text-center",children:[o.jsx("p",{className:"text-gray-600 mb-1",children:"No scope matrix generated yet."}),o.jsx("p",{className:"text-sm text-gray-500",children:"Generate a matrix to continue."})]}),u&&o.jsx("div",{className:"bg-white rounded-lg p-8 border border-gray-200 text-center",children:o.jsx("div",{className:"text-gray-600",children:"Building scope matrix..."})}),D&&!u&&s.length===0&&(()=>{const X=G;let z="No comparison data available",H="Unable to generate scope matrix for the selected quotes.",Z="Go to Review & Clean",J="#/review-clean";return(X==null?void 0:X.reason)==="no_items"?(z="No processed items found",H="We couldn't find any processed line items for the selected suppliers. Make sure quotes have been imported and processing completed successfully.",Z="Check Import Status",J="#/import-quotes"):(X==null?void 0:X.reason)==="no_mapped_items"?(z="Items aren't mapped to systems",H="The selected suppliers have items, but none are mapped to systems. Map items to systems in Review & Clean so they can be compared.",Z="Go to Review & Clean",J="#/review-clean"):(X==null?void 0:X.reason)==="no_overlap"&&(z="No overlapping systems to compare",H="These suppliers don't share any systems, so there's nothing to compare. Try selecting different quotes or adjust system mapping in Review & Clean.",Z="Go to Review & Clean",J="#/review-clean"),o.jsx("div",{className:"bg-white rounded-xl p-12 border border-gray-200 shadow-sm",children:o.jsxs("div",{className:"text-center",children:[o.jsx(Je,{className:"mx-auto mb-4 text-amber-500",size:48}),o.jsx("p",{className:"text-gray-900 text-lg font-semibold mb-2",children:z}),o.jsx("p",{className:"text-gray-600 mb-6 max-w-2xl mx-auto",children:H}),X&&o.jsxs("div",{className:"text-left max-w-2xl mx-auto bg-gray-50 rounded-lg p-4 text-sm mb-6",children:[o.jsx("p",{className:"font-semibold text-gray-900 mb-3",children:"Diagnostics:"}),o.jsxs("div",{className:"space-y-2 text-gray-700",children:[o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{children:"Total items loaded:"}),o.jsx("span",{className:"font-medium",children:X.totalItems})]}),Object.entries(X.itemsByQuote).map(([K,le])=>{const ye=_.find(Te=>Te.id===K),Re=X.itemsWithSystemByQuote[K]||0;return o.jsxs("div",{className:"pl-4 border-l-2 border-gray-300",children:[o.jsx("div",{className:"font-medium text-gray-900",children:(ye==null?void 0:ye.supplier_name)||"Unknown"}),o.jsxs("div",{className:"text-xs text-gray-600",children:[le," items  ",Re," mapped to systems"]})]},K)}),o.jsxs("div",{className:"flex justify-between pt-2 border-t border-gray-300",children:[o.jsx("span",{children:"Overlapping systems:"}),o.jsx("span",{className:"font-medium",children:X.overlappingSystemsCount})]})]})]}),o.jsxs("div",{className:"flex items-center justify-center gap-3",children:[o.jsx("a",{href:J,className:"inline-flex items-center gap-2 px-6 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-md font-medium transition-colors",children:Z}),o.jsx("button",{onClick:()=>{console.clear(),console.log(""),console.log(" SCOPE MATRIX DETAILED DIAGNOSTICS"),console.log(""),console.log(""),console.log(" Full diagnostics object:",G),console.log(""),console.log(" Available quotes:",_),console.log(""),console.log(" Selected quote IDs:",E),console.log(""),console.log(" Comparison data length:",s.length),console.log(""),console.log(" Matrix rows length:",a.length),console.log(""),console.log(" Suppliers:",l),console.log(""),console.log(""),alert(` Console cleared and diagnostic details logged!

Press F12 or right-click > Inspect > Console to view the detailed information.`)},className:"px-4 py-2 text-sm text-gray-600 hover:text-gray-900 border border-gray-300 rounded-md hover:bg-gray-50 transition-colors",children:"Show Console Details"})]})]})})})(),D&&!u&&s.length>0&&o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsxs("button",{onClick:()=>h(!f),className:"flex items-center gap-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 transition-colors",children:[o.jsx(jS,{size:18}),"Filters",ue&&o.jsx("span",{className:"ml-1 px-2 py-0.5 bg-blue-600 text-white text-xs rounded-full",children:Object.values(Q).filter(X=>X).length})]}),ue&&o.jsxs("button",{onClick:oe,className:"flex items-center gap-2 px-3 py-2 text-sm text-gray-600 hover:text-gray-900",children:[o.jsx(ps,{size:16}),"Clear filters"]})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsxs("button",{onClick:()=>g(!0),disabled:S.length===0,className:"flex items-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed",children:[o.jsx(FF,{size:18}),"Suggested Systems",S.length>0&&o.jsx("span",{className:"ml-1 px-2 py-0.5 bg-purple-800 text-white text-xs rounded-full",children:S.length})]}),o.jsxs("button",{onClick:pe,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:[o.jsx(Co,{size:18}),"Export CSV"]})]})]}),f&&o.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Section"}),o.jsxs("select",{value:Q.section||"",onChange:X=>B({...Q,section:X.target.value||void 0}),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[o.jsx("option",{value:"",children:"All"}),me.sections.map(X=>o.jsx("option",{value:X,children:X},X))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Service"}),o.jsxs("select",{value:Q.service||"",onChange:X=>B({...Q,service:X.target.value||void 0}),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[o.jsx("option",{value:"",children:"All"}),me.services.map(X=>o.jsx("option",{value:X,children:X},X))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Subclass"}),o.jsxs("select",{value:Q.subclass||"",onChange:X=>B({...Q,subclass:X.target.value||void 0}),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[o.jsx("option",{value:"",children:"All"}),me.subclasses.map(X=>o.jsx("option",{value:X,children:X},X))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"FRR"}),o.jsxs("select",{value:Q.frr||"",onChange:X=>B({...Q,frr:X.target.value||void 0}),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[o.jsx("option",{value:"",children:"All"}),me.frrs.map(X=>o.jsx("option",{value:X,children:X},X))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Size Bucket"}),o.jsxs("select",{value:Q.sizeBucket||"",onChange:X=>B({...Q,sizeBucket:X.target.value||void 0}),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[o.jsx("option",{value:"",children:"All"}),me.sizeBuckets.map(X=>o.jsx("option",{value:X,children:X},X))]})]})]})}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-6",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Scope Matrix"}),o.jsxs("div",{className:"relative group",children:[o.jsx(vo,{size:18,className:"text-gray-400 hover:text-gray-600 cursor-help"}),o.jsxs("div",{className:"absolute left-1/2 -translate-x-1/2 bottom-full mb-2 hidden group-hover:block z-20 w-80 p-3 bg-gray-900 text-white text-sm rounded-lg shadow-lg",children:[o.jsx("div",{className:"font-semibold mb-1",children:"Scope Matrix"}),o.jsx("div",{className:"text-gray-200",children:"Compare supplier rates for each passive fire system and quickly see pricing differences and missing items."}),o.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 top-full w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-gray-900"})]})]})]}),o.jsxs("div",{className:"flex items-center gap-6 text-sm",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-4 h-4 bg-green-100 border-2 border-green-300 rounded"}),o.jsx("span",{className:"text-gray-600",children:"10%"})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-4 h-4 bg-amber-100 border-2 border-amber-300 rounded"}),o.jsx("span",{className:"text-gray-600",children:"20%"})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-4 h-4 bg-red-100 border-2 border-red-300 rounded"}),o.jsx("span",{className:"text-gray-600",children:">20%"})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-4 h-4 bg-gray-100 border-2 border-gray-300 rounded"}),o.jsx("span",{className:"text-gray-600",children:"N/A"})]})]})]}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full border-collapse text-sm",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"bg-gray-50",children:[o.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700 border border-gray-200 sticky left-0 bg-gray-50 z-10",children:"System"}),l.map(X=>o.jsx("th",{className:"px-3 py-2 text-center font-medium text-gray-700 border border-gray-200 min-w-[120px]",children:X},X))]})}),o.jsx("tbody",{children:a.map((X,z)=>o.jsxs("tr",{className:"hover:bg-gray-50",children:[o.jsx("td",{className:"px-3 py-2 text-sm font-medium text-gray-900 border border-gray-200 sticky left-0 bg-white z-10",children:o.jsxs("div",{className:"flex flex-col",children:[o.jsx("span",{className:"font-semibold",children:X.systemLabel}),X.systemId!==X.systemLabel&&o.jsx("span",{className:"text-xs text-gray-500",children:X.systemId})]})}),l.map(H=>{const Z=X.cells[H];if(!Z)return o.jsx("td",{className:"px-3 py-2 text-center border border-gray-200",children:o.jsx("span",{className:"text-gray-400",children:"-"})},H);const J=m.has(Z.quoteItemId);return o.jsx("td",{className:"px-3 py-2 border border-gray-200",children:o.jsxs("div",{className:"relative group",children:[o.jsxs("div",{className:`px-2 py-1.5 rounded text-center font-medium border-2 ${fV(Z.flag)} flex items-center justify-center gap-1`,children:[o.jsx("span",{children:Z.unitRate!==null?`$${Z.unitRate.toFixed(2)}`:"N/A"}),J&&o.jsx(Je,{size:14,className:"text-yellow-600"})]}),o.jsxs("div",{className:"absolute left-1/2 -translate-x-1/2 bottom-full mb-2 hidden group-hover:block z-20 w-48 p-3 bg-gray-900 text-white text-xs rounded-lg shadow-lg",children:[o.jsxs("div",{className:"space-y-1",children:[J&&o.jsxs("div",{className:"pb-2 mb-2 border-b border-gray-700 text-yellow-300 flex items-start gap-1",children:[o.jsx(Je,{size:14,className:"flex-shrink-0 mt-0.5"}),o.jsx("span",{children:"Quantity missing in source quote. Please review before finalising."})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-gray-300",children:"Unit Rate:"}),o.jsx("span",{className:"font-semibold",children:Z.unitRate!==null?`$${Z.unitRate.toFixed(2)}`:"N/A"})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-gray-300",children:"Model Rate:"}),o.jsx("span",{className:"font-semibold",children:Z.modelRate!==null?`$${Z.modelRate.toFixed(2)}`:"N/A"})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-gray-300",children:"Variance:"}),o.jsx("span",{className:"font-semibold",children:Z.variancePct!==null?`${Z.variancePct>0?"+":""}${Z.variancePct.toFixed(1)}%`:"N/A"})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-gray-300",children:"Components:"}),o.jsx("span",{className:"font-semibold",children:Z.componentCount||"N/A"})]})]}),o.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 top-full w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-gray-900"})]})]})},H)})]},z))})]})}),a.length===0&&o.jsx("div",{className:"text-center py-8 text-gray-500",children:"No data matches the selected filters."}),o.jsxs("div",{className:"mt-6 pt-4 border-t border-gray-200",children:[o.jsx("button",{onClick:()=>v(!w),className:"flex items-center gap-2 text-sm text-gray-600 hover:text-gray-900 transition-colors",children:w?o.jsxs(o.Fragment,{children:[o.jsx(vF,{size:16}),o.jsx("span",{children:"Less Info"})]}):o.jsxs(o.Fragment,{children:[o.jsx(ri,{size:16}),o.jsx("span",{children:"More Info"})]})}),w&&o.jsxs("div",{className:"mt-4 p-4 bg-gray-50 border border-gray-200 rounded-lg",children:[o.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-2",children:"How to Read This Matrix"}),o.jsx("p",{className:"text-sm text-gray-700 leading-relaxed",children:"This matrix compares each supplier's rates for the same passive fire systems so you can accurately assess scope and pricing differences. Every row is a system type, and each column shows how each supplier priced that system. Colour indicators highlight where prices vary, helping you quickly identify mismatches, missing items, and potential scope gaps."})]})]})]}),o.jsx(h0,{currentStep:4,totalSteps:6,onBack:t,onNext:r,backLabel:"Back: Quote Intelligence",nextLabel:"Next: Equalisation"})]})]}),p&&o.jsx(dV,{projectId:e,organisationId:b,onClose:()=>g(!1),onSystemCreated:()=>{U()}})]})}function mV(e,t){const r=new Map,s=[],n=new Map;e.forEach(l=>{n.has(l.systemId)||n.set(l.systemId,[]),n.get(l.systemId).push(l)});const a=Array.from(new Set(e.map(l=>l.supplier)));return a.forEach(l=>{r.set(l,{original:0,equalised:0,itemsAdded:0})}),e.forEach(l=>{const c=r.get(l.supplier),u=l.total||0;c.original+=u,c.equalised+=u}),n.forEach((l,c)=>{var f;const u=new Set(l.map(h=>h.supplier)),d=a.filter(h=>!u.has(h));if(d.length>0){let h=null,m="";if(t==="MODEL"&&((f=l[0])!=null&&f.modelRate))h=l[0].modelRate,m="MODEL";else if(t==="PEER_MEDIAN"){const x=l.map(p=>p.unitRate).filter(p=>p!==null&&p>0);x.length>0&&(x.sort((p,g)=>p-g),h=x[Math.floor(x.length/2)],m="PEER_MEDIAN")}if(h!==null){const x=l[0];d.forEach(p=>{const w=h*1,v=r.get(p);v.equalised+=w,v.itemsAdded+=1,s.push({supplierName:p,systemId:x.systemId,systemLabel:x.systemLabel,reason:"Missing scope item",source:m,rateUsed:h,quantity:1,total:w})})}}}),{supplierTotals:a.map(l=>{const c=r.get(l),u=c.equalised-c.original,d=c.original>0?u/c.original*100:0;return{supplierName:l,originalTotal:c.original,equalisedTotal:c.equalised,adjustment:u,adjustmentPct:d,itemsAdded:c.itemsAdded}}),equalisationLog:s,mode:t}}function pV({projectId:e,onNavigateBack:t,onNavigateNext:r}){const[s,n]=j.useState([]),[a,i]=j.useState(null),[l,c]=j.useState("MODEL"),[u,d]=j.useState(!0),[f,h]=j.useState(!1),m=j.useCallback(async()=>{d(!0);try{const{data:v}=await ie.from("quotes").select("id, supplier_name").eq("project_id",e).order("supplier_name");if(!v||v.length===0){d(!1);return}const y=v.map(T=>T.id),{data:b}=await ie.from("quote_items").select("*").in("quote_id",y);if(!b){d(!1);return}const S=b.map(T=>{const M=v.find(q=>q.id===T.quote_id);return{quoteId:T.quote_id,quoteItemId:T.id,supplier:(M==null?void 0:M.supplier_name)||"Unknown",originalDescription:T.description,quantity:T.quantity||1,rate:T.unit_price,total:T.total_price,section:T.section,service:T.service,subclass:T.subclass,frr:T.frr,size:T.size}}),_=b.map(T=>({quoteItemId:T.id,systemId:T.system_id,systemLabel:T.system_label})),k=fg(e);await k.loadSettings();const E=await QE(S,_,T=>k.getModelRate(T));n(E)}catch(v){console.error("Error loading data:",v)}finally{d(!1)}},[e]),x=j.useCallback(()=>{if(s.length===0){i(null);return}const v=mV(s,l),y=s.filter(S=>S.modelRate!==null).length,b=s.length;console.log("Equalisation calculated:",{mode:l,totalEqualisations:v.totalEqualisations,logEntries:v.equalisationLog.length,suppliers:v.supplierTotals.length,comparisonRowsCount:s.length,modelRatesAvailable:y,modelRatesCoverage:`${y}/${b} (${(y/b*100).toFixed(1)}%)`,sampleComparisonRows:s.slice(0,3).map(S=>({supplier:S.supplier,system:S.systemLabel,unitRate:S.unitRate,modelRate:S.modelRate,hasModelRate:S.modelRate!==null}))}),i(v)},[s,l]);j.useEffect(()=>{p()},[e]),j.useEffect(()=>{f&&m()},[m,f]),j.useEffect(()=>{x()},[x]);const p=async()=>{try{const{data:v}=await ie.from("project_settings").select("equalisation_mode").eq("project_id",e).maybeSingle();v!=null&&v.equalisation_mode&&c(v.equalisation_mode)}catch(v){console.error("Error loading equalisation mode:",v)}finally{h(!0)}},g=async v=>{c(v);try{const y=new Date().toISOString(),{error:b}=await ie.from("project_settings").upsert({project_id:e,equalisation_mode:v,last_equalisation_run:y,updated_at:y},{onConflict:"project_id"});b&&console.error("Error saving equalisation mode:",b)}catch(y){console.error("Error persisting equalisation mode:",y)}},w=()=>{try{if(console.log("Export Equalisation Log clicked",{hasResult:!!a,logCount:(a==null?void 0:a.equalisationLog.length)||0,mode:l}),!a){alert("No equalisation result available. Please run the equalisation analysis first.");return}if(a.equalisationLog.length===0){alert("No equalisation log entries to export.");return}const v=["Supplier","System ID","System Label","Reason","Source","Rate Used","Quantity","Total"],y=a.equalisationLog.map(E=>[E.supplierName,E.systemId,E.systemLabel,E.reason,E.source,E.rateUsed.toFixed(2),E.quantity.toString(),E.total.toFixed(2)]),b=[v.join(","),...y.map(E=>E.map(T=>`"${T}"`).join(","))].join(`
`),S=new Blob([b],{type:"text/csv;charset=utf-8;"}),_=URL.createObjectURL(S),k=document.createElement("a");k.href=_,k.download=`equalisation-log-${l.toLowerCase()}-${e}-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(k),k.click(),document.body.removeChild(k),URL.revokeObjectURL(_),console.log("Export completed successfully",{rowCount:y.length})}catch(v){console.error("Error exporting equalisation log:",v),alert("Failed to export equalisation log. Check console for details.")}};return u?o.jsx("div",{className:"flex items-center justify-center h-64",children:o.jsx("div",{className:"text-gray-500",children:"Loading equalisation analysis..."})}):s.length===0?o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center",children:[o.jsx("p",{className:"text-gray-500 text-lg",children:"No data available."}),o.jsx("p",{className:"text-gray-400 mt-2",children:"Import quotes and configure model rate settings to view equalisation."})]}):o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-6",children:[o.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Equalisation Analysis"}),o.jsxs("div",{className:"relative group",children:[o.jsxs("button",{onClick:w,disabled:!a||a.equalisationLog.length===0,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed",title:!a||a.equalisationLog.length===0?"No equalisation entries to export. This happens when all suppliers quote all systems.":"Export equalisation log to CSV",children:[o.jsx(Co,{size:18}),"Export Log",a&&a.equalisationLog.length===0&&o.jsx("span",{className:"ml-1 text-xs",children:"(0 entries)"})]}),a&&a.equalisationLog.length===0&&o.jsxs("div",{className:"absolute right-0 top-full mt-2 w-72 bg-amber-50 border border-amber-200 rounded-lg p-3 text-xs text-amber-800 opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none z-10",children:[o.jsx("strong",{children:"No scope gaps to equalise."}),o.jsx("br",{}),"All suppliers have quoted all systems. The export log only includes items that were equalised (filled in) using ",l==="MODEL"?"model rates":"peer median rates","."]})]})]}),o.jsxs("div",{className:"mb-6",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Equalisation Mode"}),o.jsxs("div",{className:"flex gap-4",children:[o.jsxs("label",{className:"flex items-center gap-3 px-4 py-3 border-2 rounded-lg cursor-pointer transition-all hover:bg-gray-50",children:[o.jsx("input",{type:"radio",name:"equalisationMode",value:"MODEL",checked:l==="MODEL",onChange:v=>g(v.target.value),className:"w-4 h-4 text-blue-600"}),o.jsxs("div",{children:[o.jsx("div",{className:"font-medium text-gray-900",children:"Model Rate"}),o.jsx("div",{className:"text-xs text-gray-600",children:"Use model rates for missing items"})]})]}),o.jsxs("label",{className:"flex items-center gap-3 px-4 py-3 border-2 rounded-lg cursor-pointer transition-all hover:bg-gray-50",children:[o.jsx("input",{type:"radio",name:"equalisationMode",value:"PEER_MEDIAN",checked:l==="PEER_MEDIAN",onChange:v=>g(v.target.value),className:"w-4 h-4 text-blue-600"}),o.jsxs("div",{children:[o.jsx("div",{className:"font-medium text-gray-900",children:"Peer Median"}),o.jsx("div",{className:"text-xs text-gray-600",children:"Use median of other suppliers' rates"})]})]})]})]}),o.jsxs("div",{className:"flex items-start gap-3 p-4 bg-blue-50 rounded-lg border border-blue-200 mb-6",children:[o.jsx(vo,{className:"text-blue-600 flex-shrink-0 mt-0.5",size:20}),o.jsxs("div",{className:"text-sm text-blue-900",children:[o.jsx("p",{className:"font-medium mb-1",children:"About Equalisation"}),o.jsxs("p",{children:["Equalisation fills in missing scope items for each supplier to enable fair comparison.",o.jsx("strong",{children:" MODEL"})," mode uses your configured model rates, while",o.jsx("strong",{children:" PEER_MEDIAN"})," uses the median rate from other suppliers for the same system."]})]})]}),s.length>0&&o.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg border border-gray-200",children:[o.jsx("h4",{className:"font-medium text-gray-900 mb-2 text-sm",children:"Data Status"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 text-sm",children:[o.jsxs("div",{children:[o.jsx("span",{className:"text-gray-600",children:"Total Items:"}),o.jsx("span",{className:"ml-2 font-semibold text-gray-900",children:s.length})]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-gray-600",children:"Model Rates Available:"}),o.jsx("span",{className:"ml-2 font-semibold text-gray-900",children:s.filter(v=>v.modelRate!==null).length}),o.jsxs("span",{className:"ml-1 text-xs text-gray-500",children:["(",(s.filter(v=>v.modelRate!==null).length/s.length*100).toFixed(0),"%)"]})]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-gray-600",children:"Systems:"}),o.jsx("span",{className:"ml-2 font-semibold text-gray-900",children:new Set(s.map(v=>v.systemLabel)).size})]})]}),s.filter(v=>v.modelRate!==null).length===0&&l==="MODEL"&&o.jsxs("div",{className:"mt-3 p-3 bg-amber-50 border border-amber-200 rounded text-sm text-amber-800",children:[o.jsx("strong",{children:"Warning:"})," No model rates are configured. MODEL mode equalisation will not work. Please configure model rates in Settings or use PEER_MEDIAN mode instead."]})]})]}),a&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[o.jsx(Ao,{size:20,className:"text-gray-700"}),o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Supplier Totals Comparison"})]}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full border-collapse text-sm",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"bg-gray-50",children:[o.jsx("th",{className:"px-4 py-3 text-left font-medium text-gray-700 border border-gray-200",children:"Supplier"}),o.jsx("th",{className:"px-4 py-3 text-right font-medium text-gray-700 border border-gray-200",children:"Original Total"}),o.jsx("th",{className:"px-4 py-3 text-right font-medium text-gray-700 border border-gray-200",children:"Equalised Total"}),o.jsx("th",{className:"px-4 py-3 text-right font-medium text-gray-700 border border-gray-200",children:"Adjustment"}),o.jsx("th",{className:"px-4 py-3 text-right font-medium text-gray-700 border border-gray-200",children:"Adjustment %"}),o.jsx("th",{className:"px-4 py-3 text-right font-medium text-gray-700 border border-gray-200",children:"Items Added"})]})}),o.jsx("tbody",{children:a.supplierTotals.map((v,y)=>o.jsxs("tr",{className:"hover:bg-gray-50",children:[o.jsx("td",{className:"px-4 py-3 font-medium text-gray-900 border border-gray-200",children:v.supplierName}),o.jsxs("td",{className:"px-4 py-3 text-right text-gray-900 border border-gray-200",children:["$",v.originalTotal.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),o.jsxs("td",{className:"px-4 py-3 text-right font-semibold text-gray-900 border border-gray-200",children:["$",v.equalisedTotal.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),o.jsxs("td",{className:`px-4 py-3 text-right font-medium border border-gray-200 ${v.adjustment>0?"text-red-700":v.adjustment<0?"text-green-700":"text-gray-600"}`,children:[v.adjustment>=0?"+":"","$",v.adjustment.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),o.jsxs("td",{className:`px-4 py-3 text-right font-medium border border-gray-200 ${v.adjustmentPct>0?"text-red-700":v.adjustmentPct<0?"text-green-700":"text-gray-600"}`,children:[v.adjustmentPct>=0?"+":"",v.adjustmentPct.toFixed(1),"%"]}),o.jsx("td",{className:"px-4 py-3 text-right text-gray-900 border border-gray-200",children:v.equalisationCount})]},y))})]})})]}),a.equalisationLog.length>0&&o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[o.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Equalisation Audit Log",o.jsxs("span",{className:"ml-2 text-sm font-normal text-gray-600",children:["(",a.totalEqualisations," entries)"]})]}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full border-collapse text-sm",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"bg-gray-50",children:[o.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700 border border-gray-200",children:"Supplier"}),o.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700 border border-gray-200",children:"System"}),o.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700 border border-gray-200",children:"Reason"}),o.jsx("th",{className:"px-3 py-2 text-center font-medium text-gray-700 border border-gray-200",children:"Source"}),o.jsx("th",{className:"px-3 py-2 text-right font-medium text-gray-700 border border-gray-200",children:"Rate Used"}),o.jsx("th",{className:"px-3 py-2 text-right font-medium text-gray-700 border border-gray-200",children:"Quantity"}),o.jsx("th",{className:"px-3 py-2 text-right font-medium text-gray-700 border border-gray-200",children:"Total"})]})}),o.jsx("tbody",{children:a.equalisationLog.map((v,y)=>o.jsxs("tr",{className:"hover:bg-gray-50",children:[o.jsx("td",{className:"px-3 py-2 text-gray-900 border border-gray-200",children:v.supplierName}),o.jsx("td",{className:"px-3 py-2 border border-gray-200",children:o.jsxs("div",{className:"flex flex-col",children:[o.jsx("span",{className:"font-medium text-gray-900",children:v.systemLabel}),v.systemId!==v.systemLabel&&o.jsx("span",{className:"text-xs text-gray-500",children:v.systemId})]})}),o.jsx("td",{className:"px-3 py-2 text-gray-700 border border-gray-200",children:v.reason}),o.jsx("td",{className:"px-3 py-2 text-center border border-gray-200",children:o.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${v.source==="MODEL"?"bg-blue-100 text-blue-800":"bg-purple-100 text-purple-800"}`,children:v.source})}),o.jsxs("td",{className:"px-3 py-2 text-right text-gray-900 border border-gray-200",children:["$",v.rateUsed.toFixed(2)]}),o.jsx("td",{className:"px-3 py-2 text-right text-gray-900 border border-gray-200",children:v.quantity}),o.jsxs("td",{className:"px-3 py-2 text-right font-medium text-gray-900 border border-gray-200",children:["$",v.total.toFixed(2)]})]},y))})]})})]}),a.equalisationLog.length===0&&o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center",children:[o.jsx("p",{className:"text-gray-500",children:"No equalisation adjustments needed."}),o.jsx("p",{className:"text-gray-400 mt-2",children:"All suppliers have quoted all systems."})]})]}),o.jsx(h0,{currentStep:5,totalSteps:6,onBack:t,onNext:r,backLabel:"Back: Scope Matrix",nextLabel:"Next: Award Report"})]})}function xV({disabled:e,onExport:t,loading:r}){const[s,n]=j.useState(!1),a=j.useRef(null);j.useEffect(()=>{const l=c=>{a.current&&!a.current.contains(c.target)&&n(!1)};return s&&document.addEventListener("mousedown",l),()=>{document.removeEventListener("mousedown",l)}},[s]);const i=l=>{n(!1),t(l)};return o.jsxs("div",{className:"relative",ref:a,children:[o.jsxs("button",{onClick:()=>!e&&!r&&n(!s),disabled:e||r,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md font-medium transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed",title:e?"Export is available after a preferred supplier has been selected.":"Export documents",children:[o.jsx(Co,{size:16}),r?"Exporting...":"Export",o.jsx(ri,{size:14,className:`transition-transform ${s?"rotate-180":""}`})]}),s&&!e&&!r&&o.jsxs("div",{className:"absolute right-0 mt-2 w-64 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-50",children:[o.jsxs("button",{onClick:()=>i("site"),className:"w-full text-left px-4 py-2.5 hover:bg-gray-50 transition-colors",children:[o.jsx("div",{className:"font-medium text-gray-900 text-sm",children:"Site Scope Pack"}),o.jsx("div",{className:"text-xs text-gray-500 mt-0.5",children:"No pricing or commercial terms"})]}),o.jsx("div",{className:"border-t border-gray-100 my-1"}),o.jsxs("button",{onClick:()=>i("commercial"),className:"w-full text-left px-4 py-2.5 hover:bg-gray-50 transition-colors",children:[o.jsx("div",{className:"font-medium text-gray-900 text-sm",children:"Commercial Handover Pack"}),o.jsx("div",{className:"text-xs text-gray-500 mt-0.5",children:"Full contract details with pricing"})]})]})]})}function gV({projectId:e,onNavigateBack:t}){const[r,s]=j.useState("summary"),[n,a]=j.useState(!0),[i,l]=j.useState(null),[c,u]=j.useState(null),[d,f]=j.useState(!1),{currentOrganisation:h}=wa();j.useEffect(()=>{m()},[e]);const m=async()=>{a(!0);try{const{data:w}=await ie.from("projects").select("id, name, client, updated_at").eq("id",e).maybeSingle();w&&l(w);const v=w==null?void 0:w.approved_quote_id;if(v){const{data:y}=await ie.from("quotes").select("supplier_name, total_amount, updated_at").eq("id",v).maybeSingle();y&&u({supplier_name:y.supplier_name,total_amount:y.total_amount||0,awarded_date:y.updated_at})}}catch(w){console.error("Error loading contract manager data:",w)}finally{a(!1)}},x=async w=>{var v;if(c){f(!0);try{const{data:{session:y}}=await ie.auth.getSession(),S=await fetch("https://cbankidsdfsvsgfygbzt.supabase.co/functions/v1/export_contract_manager",{method:"POST",headers:{Authorization:`Bearer ${(y==null?void 0:y.access_token)||"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNiYW5raWRzZGZzdnNnZnlnYnp0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMzMTk3NDgsImV4cCI6MjA3ODg5NTc0OH0.SXgc-9ZamplKeJm5_nl8J2-UzO7A0f8KbAnPZEmsiSo"}`,"Content-Type":"application/json"},body:JSON.stringify({projectId:e,mode:w})});if(!S.ok)throw new Error("Export failed");const _=await S.json(),k=new Date().toISOString().slice(0,16).replace(/[-:]/g,"").replace("T","_"),E=((v=i==null?void 0:i.name)==null?void 0:v.replace(/[^a-zA-Z0-9]/g,"_"))||"Project",T=w==="site"?`SiteScope_${E}_${k}.html`:`CommercialHandover_${E}_${k}.html`,M=new Blob([_.html],{type:"text/html"}),q=window.URL.createObjectURL(M),D=document.createElement("a");D.href=q,D.download=T,document.body.appendChild(D),D.click(),document.body.removeChild(D),window.URL.revokeObjectURL(q),alert(`${w==="site"?"Site Scope Pack":"Commercial Handover Pack"} generated successfully! Open the HTML file and use your browser's Print to PDF function.`)}catch(y){console.error("Export error:",y),alert("Could not generate export. Please try again or contact support.")}finally{f(!1)}}},p=[{id:"summary",label:"Contract Summary",icon:Tr},{id:"scope",label:"Scope & Systems",icon:Yt},{id:"inclusions",label:"Inclusions & Exclusions",icon:SF},{id:"allowances",label:"Allowances",icon:Tr},{id:"variations",label:"Variations Log",icon:Je}];if(n)return o.jsx("div",{className:"p-6 max-w-full",children:o.jsx("div",{className:"flex items-center justify-center h-64",children:o.jsx("div",{className:"text-gray-500",children:"Loading contract information..."})})});const g=!!c;return o.jsxs("div",{className:"p-6 max-w-full",children:[o.jsxs("div",{className:"mb-6",children:[o.jsxs("button",{onClick:t,className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 mb-4 text-sm",children:[o.jsx(Tc,{size:16}),"Back to Project Dashboard"]}),o.jsxs("div",{className:"flex items-start justify-between mb-4",children:[o.jsxs("div",{children:[o.jsxs("div",{className:"text-sm text-gray-500 mb-1",children:["Projects  ",(i==null?void 0:i.name)||"Unknown Project","  Contract Manager"]}),o.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:(i==null?void 0:i.name)||"Unknown Project"}),o.jsx("h2",{className:"text-xl text-gray-600 mt-1",children:"Contract Manager"})]}),o.jsxs("div",{className:"text-right text-sm",children:[o.jsx("div",{className:"text-gray-500",children:"Organisation"}),o.jsx("div",{className:"font-medium text-gray-900",children:(h==null?void 0:h.name)||"N/A"}),o.jsx("div",{className:"text-gray-500 mt-2",children:"Last Updated"}),o.jsx("div",{className:"font-medium text-gray-900",children:i!=null&&i.updated_at?new Date(i.updated_at).toLocaleDateString():"N/A"})]})]}),o.jsxs("div",{className:"flex items-center justify-between py-4 border-t border-b border-gray-200",children:[o.jsx("p",{className:"text-gray-600",children:"Manage your subcontract scope and handover information."}),o.jsx(xV,{disabled:!g,onExport:x,loading:d})]})]}),g?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"border-b border-gray-200 mb-6",children:o.jsx("div",{className:"flex gap-1",children:p.map(w=>{const v=w.icon;return o.jsxs("button",{onClick:()=>s(w.id),className:`flex items-center gap-2 px-4 py-3 font-medium transition-colors ${r===w.id?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-900"}`,children:[o.jsx(v,{size:16}),w.label]},w.id)})})}),o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[r==="summary"&&o.jsx(vV,{awardInfo:c,projectInfo:i}),r==="scope"&&o.jsx(yV,{projectId:e}),r==="inclusions"&&o.jsx(wV,{}),r==="allowances"&&o.jsx(bV,{}),r==="variations"&&o.jsx(_V,{})]})]}):o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-12 text-center",children:[o.jsx(Je,{className:"mx-auto text-gray-400 mb-4",size:48}),o.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"No award selected"}),o.jsx("p",{className:"text-gray-600 mb-6",children:"Select a preferred supplier in your Award Report before using Contract Manager."}),o.jsx("button",{onClick:()=>window.location.href="#/reports",className:"px-6 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-md font-medium transition-colors",children:"Go to Reports"})]})]})}function vV({awardInfo:e,projectInfo:t}){return o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Contract Summary"}),o.jsxs("div",{className:"grid grid-cols-2 gap-6 mb-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Subcontractor"}),o.jsx("div",{className:"text-base text-gray-900",children:(e==null?void 0:e.supplier_name)||"TBC"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Subcontract Sum"}),o.jsxs("div",{className:"text-base font-semibold text-gray-900",children:["$",e!=null&&e.total_amount?e.total_amount.toLocaleString():"0.00"]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Main Contractor"}),o.jsx("div",{className:"text-base text-gray-900",children:"TBC"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Client / End User"}),o.jsx("div",{className:"text-base text-gray-900",children:(t==null?void 0:t.client)||"TBC"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Payment Terms"}),o.jsx("div",{className:"text-base text-gray-900",children:"20th following month, 22 working days payment"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Retentions"}),o.jsx("div",{className:"text-base text-gray-900",children:"3% standard retention"})]}),o.jsxs("div",{className:"col-span-2",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Liquidated Damages (LDs)"}),o.jsx("div",{className:"text-base text-gray-900",children:"None specified"})]})]}),o.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 text-sm text-blue-800",children:[o.jsx(Je,{size:16,className:"inline mr-2"}),"These values will be refined as Contract Manager is integrated with your commercial data."]})]})}function yV({projectId:e}){return o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Scope & Systems"}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full",children:[o.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"System"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Rating"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Notes"})]})}),o.jsxs("tbody",{className:"divide-y divide-gray-200",children:[o.jsxs("tr",{children:[o.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:"Fire batts & mastic"}),o.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:"FRR 60/60/60"}),o.jsx("td",{className:"px-4 py-3 text-sm text-gray-500",children:"See scope matrix"})]}),o.jsxs("tr",{children:[o.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:"Intumescent paint to steel"}),o.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:"FRR 90/90/90"}),o.jsx("td",{className:"px-4 py-3 text-sm text-gray-500",children:"See scope matrix"})]})]})]})}),o.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 text-sm text-blue-800 mt-4",children:[o.jsx(Je,{size:16,className:"inline mr-2"}),"Scope & Systems will be automatically populated from the Scope Matrix in a future update."]})]})}function wV(){return o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Inclusions & Exclusions"}),o.jsxs("div",{className:"grid grid-cols-2 gap-8",children:[o.jsxs("div",{children:[o.jsx("h4",{className:"text-base font-semibold text-gray-900 mb-3",children:"Inclusions"}),o.jsxs("ul",{className:"space-y-2 text-sm text-gray-700",children:[o.jsxs("li",{className:"flex items-start gap-2",children:[o.jsx("span",{className:"text-green-600 mt-1",children:""}),o.jsx("span",{children:"All passive fire stopping to service penetrations as per fire engineering report and drawings."})]}),o.jsxs("li",{className:"flex items-start gap-2",children:[o.jsx("span",{className:"text-green-600 mt-1",children:""}),o.jsx("span",{children:"Intumescent coatings to structural steel members identified as requiring FRR."})]}),o.jsxs("li",{className:"flex items-start gap-2",children:[o.jsx("span",{className:"text-green-600 mt-1",children:""}),o.jsx("span",{children:"Supply of QA documentation including labels, photos, and PS3."})]}),o.jsxs("li",{className:"flex items-start gap-2",children:[o.jsx("span",{className:"text-green-600 mt-1",children:""}),o.jsx("span",{children:"All materials, labour, and equipment necessary to complete the works."})]}),o.jsxs("li",{className:"flex items-start gap-2",children:[o.jsx("span",{className:"text-green-600 mt-1",children:""}),o.jsx("span",{children:"Site-specific SWMS and induction for all personnel."})]})]})]}),o.jsxs("div",{children:[o.jsx("h4",{className:"text-base font-semibold text-gray-900 mb-3",children:"Exclusions"}),o.jsxs("ul",{className:"space-y-2 text-sm text-gray-700",children:[o.jsxs("li",{className:"flex items-start gap-2",children:[o.jsx("span",{className:"text-red-600 mt-1",children:""}),o.jsx("span",{children:"Remediation of pre-existing, non-compliant fire stopping."})]}),o.jsxs("li",{className:"flex items-start gap-2",children:[o.jsx("span",{className:"text-red-600 mt-1",children:""}),o.jsx("span",{children:"Temporary services penetrations."})]}),o.jsxs("li",{className:"flex items-start gap-2",children:[o.jsx("span",{className:"text-red-600 mt-1",children:""}),o.jsx("span",{children:"Access equipment and out-of-hours work unless specifically agreed."})]}),o.jsxs("li",{className:"flex items-start gap-2",children:[o.jsx("span",{className:"text-red-600 mt-1",children:""}),o.jsx("span",{children:"Works to penetrations not shown on drawings or schedules."})]}),o.jsxs("li",{className:"flex items-start gap-2",children:[o.jsx("span",{className:"text-red-600 mt-1",children:""}),o.jsx("span",{children:"Delays caused by incomplete services installations or lack of access."})]})]})]})]}),o.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 text-sm text-blue-800 mt-6",children:[o.jsx(Je,{size:16,className:"inline mr-2"}),"Inclusions and exclusions will later be editable and exported as part of the Handover Pack."]})]})}function bV(){return o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Allowances & Provisional Sums"}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full",children:[o.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Description"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Qty / Basis"}),o.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Rate"}),o.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Total"})]})}),o.jsxs("tbody",{className:"divide-y divide-gray-200",children:[o.jsxs("tr",{children:[o.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:"Remedial fire stopping allowance"}),o.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:"20 openings"}),o.jsx("td",{className:"px-4 py-3 text-sm text-gray-700 text-right",children:"$250.00"}),o.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900 text-right",children:"$5,000.00"})]}),o.jsxs("tr",{children:[o.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:"Access equipment allowance"}),o.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:"Lump sum"}),o.jsx("td",{className:"px-4 py-3 text-sm text-gray-700 text-right",children:"-"}),o.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900 text-right",children:"$8,500.00"})]}),o.jsxs("tr",{children:[o.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:"Provisional sum - additional works"}),o.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:"As directed"}),o.jsx("td",{className:"px-4 py-3 text-sm text-gray-700 text-right",children:"-"}),o.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900 text-right",children:"$10,000.00"})]}),o.jsxs("tr",{className:"bg-gray-50",children:[o.jsx("td",{colSpan:3,className:"px-4 py-3 text-sm font-semibold text-gray-900",children:"Total Allowances"}),o.jsx("td",{className:"px-4 py-3 text-sm font-bold text-gray-900 text-right",children:"$23,500.00"})]})]})]})}),o.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 text-sm text-blue-800 mt-4",children:[o.jsx(Je,{size:16,className:"inline mr-2"}),"Future versions will pull allowances from estimating data and allow editing."]})]})}function _V(){return o.jsxs("div",{className:"text-center py-12",children:[o.jsx(Je,{className:"mx-auto text-gray-400 mb-4",size:48}),o.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Variations Log"}),o.jsx("p",{className:"text-gray-600",children:"Track proposed and approved variations here in a future update."})]})}function SV({projects:e,onNavigate:t}){const[r,s]=j.useState(""),[n,a]=j.useState(null),[i,l]=j.useState(!1),[c,u]=j.useState(null),d=e.filter(_=>_.workflow_complete),f=d.filter(_=>_.name.toLowerCase().includes(r.toLowerCase())||_.client_reference.toLowerCase().includes(r.toLowerCase())),h=f.filter(_=>!_.has_report),m=f.filter(_=>_.has_report),x=()=>{n!=null&&n.report_id&&(t==null||t("award-report",n.report_id))},p=async(_=!1)=>{var k,E,T,M,q,D,W;if(n){l(!0),u(null);try{const G=await fetch("https://cbankidsdfsvsgfygbzt.supabase.co/functions/v1/compute_award_report",{method:"POST",headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNiYW5raWRzZGZzdnNnZnlnYnp0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMzMTk3NDgsImV4cCI6MjA3ODg5NTc0OH0.SXgc-9ZamplKeJm5_nl8J2-UzO7A0f8KbAnPZEmsiSo","Content-Type":"application/json"},body:JSON.stringify({projectId:n.id,force:_})});if(!G.ok){const fe=await G.text();throw new Error(`Server returned ${G.status}: ${fe}`)}const ce=await G.json();if(!ce||!ce.reportId)throw new Error("No report ID returned from server");const{data:Q}=await ie.from("award_reports").select("id, generated_at, result_json").eq("id",ce.reportId).single(),B=((T=(E=(k=Q==null?void 0:Q.result_json)==null?void 0:k.awardSummary)==null?void 0:E.suppliers)==null?void 0:T.length)||0,me=((W=(D=(q=(M=Q==null?void 0:Q.result_json)==null?void 0:M.awardSummary)==null?void 0:q.suppliers)==null?void 0:D[0])==null?void 0:W.coveragePercent)||0;a({...n,has_report:!0,report_id:ce.reportId,report_generated_at:Q==null?void 0:Q.generated_at,report_quotes_count:B,report_coverage_percent:Math.round(me)}),t==null||t("award-report",ce.reportId)}catch(ee){console.error("Error computing award report:",ee),u(ee.message||"Failed to compute award report")}finally{l(!1)}}},g=()=>{p(!1)},w=()=>{p(!0)},v=async()=>{var _,k,E,T,M,q,D;if(n!=null&&n.report_id)try{const{data:W}=await ie.from("award_reports").select("id, generated_at, result_json").eq("id",n.report_id).single();if(W){const ee=((E=(k=(_=W.result_json)==null?void 0:_.awardSummary)==null?void 0:k.suppliers)==null?void 0:E.length)||0,Y=((D=(q=(M=(T=W.result_json)==null?void 0:T.awardSummary)==null?void 0:M.suppliers)==null?void 0:q[0])==null?void 0:D.coveragePercent)||0;a({...n,report_generated_at:W.generated_at,report_quotes_count:ee,report_coverage_percent:Math.round(Y)})}}catch(W){console.error("Error refreshing project metadata:",W)}};j.useEffect(()=>{n!=null&&n.has_report&&n.report_id&&v()},[n==null?void 0:n.id]);const y=async()=>{if(n!=null&&n.report_id)try{const{data:_,error:k}=await ie.from("award_reports").select("result_json, generated_at").eq("id",n.report_id).single();if(k||!_){console.error("Error loading report:",k);return}const T=_.result_json.awardSummary,M=`
        <!DOCTYPE html>
        <html>
        <head>
          <meta charset="UTF-8">
          <title>Award Report - ${n.name}</title>
          <style>
            body { font-family: Arial, sans-serif; padding: 40px; line-height: 1.6; color: #333; }
            h1 { color: #1e40af; border-bottom: 3px solid #3b82f6; padding-bottom: 10px; margin-bottom: 30px; }
            h2 { color: #1e40af; margin-top: 30px; margin-bottom: 15px; border-bottom: 1px solid #e5e7eb; padding-bottom: 8px; }
            h3 { color: #374151; margin-top: 20px; }
            table { width: 100%; border-collapse: collapse; margin: 20px 0; }
            th, td { padding: 12px; text-align: left; border: 1px solid #d1d5db; }
            th { background-color: #3b82f6; color: white; font-weight: 600; }
            tr:nth-child(even) { background-color: #f9fafb; }
            .meta { color: #6b7280; font-size: 14px; margin-bottom: 30px; }
            .supplier-section { margin: 30px 0; padding: 20px; background: #f9fafb; border-radius: 8px; }
            .recommendation { background: #dbeafe; padding: 15px; border-left: 4px solid #3b82f6; margin: 20px 0; }
          </style>
        </head>
        <body>
          <h1>Award Recommendation Report</h1>
          <div class="meta">
            <p><strong>Project:</strong> ${n.name}</p>
            <p><strong>Client:</strong> ${n.client_reference}</p>
            <p><strong>Generated:</strong> ${new Date(_.generated_at).toLocaleString()}</p>
            <p><strong>Equalisation Mode:</strong> ${T.equalisationMode}</p>
          </div>

          <h2>Supplier Rankings</h2>
          <table>
            <thead>
              <tr>
                <th>Rank</th>
                <th>Supplier</th>
                <th>Adjusted Total</th>
                <th>Risk Score</th>
                <th>Coverage %</th>
                <th>Items Quoted</th>
              </tr>
            </thead>
            <tbody>
              ${T.suppliers.map((ee,Y)=>`
                <tr>
                  <td>${Y+1}</td>
                  <td>${ee.supplierName}</td>
                  <td>$${ee.adjustedTotal.toLocaleString()}</td>
                  <td>${ee.riskScore}</td>
                  <td>${ee.coveragePercent}%</td>
                  <td>${ee.itemsQuoted}</td>
                </tr>
              `).join("")}
            </tbody>
          </table>

          <h2>Recommendations</h2>
          ${T.recommendations.map(ee=>`
            <div class="recommendation">
              <h3>${ee.type.replace("_"," ")}</h3>
              <p><strong>Supplier:</strong> ${ee.supplier.supplierName}</p>
              <p><strong>Reason:</strong> ${ee.reason}</p>
            </div>
          `).join("")}
        </body>
        </html>
      `,q=new Blob([M],{type:"text/html"}),D=URL.createObjectURL(q),W=window.open(D,"_blank","width=1024,height=768");if(W)W.onload=()=>{setTimeout(()=>{W.print(),setTimeout(()=>{URL.revokeObjectURL(D)},1e3)},500)};else{const ee=document.createElement("a");ee.href=D,ee.download=`Award_Report_${n.name.replace(/[^a-z0-9]/gi,"_")}.html`,document.body.appendChild(ee),ee.click(),document.body.removeChild(ee),setTimeout(()=>URL.revokeObjectURL(D),1e3)}}catch(_){console.error("Error exporting PDF:",_)}},b=()=>{n&&(t==null||t("award-report"))},S=_=>new Date(_).toLocaleDateString("en-NZ",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"});return o.jsxs("div",{className:"h-full flex flex-col bg-gray-50",children:[o.jsx("div",{className:"bg-white border-b border-gray-200 px-6 py-4",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-10 h-10 bg-blue-500 rounded-lg flex items-center justify-center",children:o.jsx(Tr,{className:"w-6 h-6 text-white"})}),o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Reports Hub"}),o.jsx("p",{className:"text-sm text-gray-500",children:"Manage and generate award reports"})]})]})}),o.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[o.jsxs("div",{className:"w-96 bg-white border-r border-gray-200 flex flex-col",children:[o.jsx("div",{className:"p-4 border-b border-gray-200",children:o.jsxs("div",{className:"relative",children:[o.jsx(bd,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),o.jsx("input",{type:"text",placeholder:"Search projects...",value:r,onChange:_=>s(_.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),o.jsxs("div",{className:"flex-1 overflow-y-auto",children:[h.length>0&&o.jsxs("div",{className:"mb-6",children:[o.jsx("div",{className:"px-4 py-2 bg-amber-50 border-b border-amber-100",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Je,{className:"w-4 h-4 text-amber-600"}),o.jsxs("span",{className:"text-sm font-medium text-amber-900",children:["Needs Report (",h.length,")"]})]})}),o.jsx("div",{className:"divide-y divide-gray-100",children:h.map(_=>o.jsxs("button",{onClick:()=>a(_),className:`w-full text-left px-4 py-3 hover:bg-gray-50 transition-colors ${(n==null?void 0:n.id)===_.id?"bg-blue-50 border-l-4 border-blue-500":""}`,children:[o.jsx("div",{className:"font-medium text-gray-900 mb-1",children:_.name}),o.jsx("div",{className:"text-xs text-gray-500 mb-1",children:_.client_reference}),o.jsxs("div",{className:"text-xs text-gray-400",children:["Updated ",S(_.updated_at)]})]},_.id))})]}),m.length>0&&o.jsxs("div",{children:[o.jsx("div",{className:"px-4 py-2 bg-green-50 border-b border-green-100",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(nm,{className:"w-4 h-4 text-green-600"}),o.jsxs("span",{className:"text-sm font-medium text-green-900",children:["With Report (",m.length,")"]})]})}),o.jsx("div",{className:"divide-y divide-gray-100",children:m.map(_=>o.jsxs("button",{onClick:()=>a(_),className:`w-full text-left px-4 py-3 hover:bg-gray-50 transition-colors ${(n==null?void 0:n.id)===_.id?"bg-blue-50 border-l-4 border-blue-500":""}`,children:[o.jsx("div",{className:"font-medium text-gray-900 mb-1",children:_.name}),o.jsx("div",{className:"text-xs text-gray-500 mb-1",children:_.client_reference}),o.jsxs("div",{className:"text-xs text-gray-400",children:["Updated ",S(_.updated_at)]})]},_.id))})]}),d.length===0&&o.jsxs("div",{className:"flex flex-col items-center justify-center h-64 px-6 text-center",children:[o.jsx(Je,{className:"w-12 h-12 mb-3 text-amber-400"}),o.jsx("p",{className:"text-sm font-medium text-gray-900 mb-2",children:"No Report-Ready Projects"}),o.jsx("p",{className:"text-xs text-gray-500 max-w-xs",children:"Projects must complete all workflow steps (Import Quotes  Review & Clean  Scope Matrix) before they appear here."})]}),d.length>0&&f.length===0&&o.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-gray-400",children:[o.jsx(bd,{className:"w-12 h-12 mb-3"}),o.jsx("p",{className:"text-sm",children:"No projects match your search"})]})]})]}),o.jsx("div",{className:"flex-1 overflow-y-auto",children:n?o.jsxs("div",{className:"p-8",children:[o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6",children:[o.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-4",children:n.name}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{className:"flex items-center gap-3 text-gray-600",children:[o.jsx(go,{className:"w-5 h-5 text-gray-400"}),o.jsxs("div",{children:[o.jsx("div",{className:"text-xs text-gray-500 uppercase",children:"Client"}),o.jsx("div",{className:"font-medium",children:n.client_reference||"Not specified"})]})]}),o.jsxs("div",{className:"flex items-center gap-3 text-gray-600",children:[o.jsx(TF,{className:"w-5 h-5 text-gray-400"}),o.jsxs("div",{children:[o.jsx("div",{className:"text-xs text-gray-500 uppercase",children:"Reference"}),o.jsx("div",{className:"font-medium",children:n.client_reference||"N/A"})]})]})]})]}),n.has_report?o.jsxs(o.Fragment,{children:[c&&o.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:o.jsxs("div",{className:"flex items-center gap-2 text-red-800",children:[o.jsx(Je,{className:"w-5 h-5"}),o.jsx("span",{className:"font-medium",children:c})]})}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Report Actions"}),o.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4",children:o.jsxs("div",{className:"flex items-start gap-2",children:[o.jsx(Je,{className:"w-5 h-5 text-blue-600 mt-0.5 flex-shrink-0"}),o.jsx("p",{className:"text-sm text-blue-800",children:"This report is cached. Changes to quotes will show after you click Regenerate."})]})}),o.jsxs("div",{className:"flex flex-wrap gap-3",children:[o.jsx("button",{onClick:x,disabled:i,className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium",children:"View Report"}),o.jsx("button",{onClick:w,disabled:i,className:"flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium",children:i?o.jsxs(o.Fragment,{children:[o.jsx(js,{className:"w-4 h-4 animate-spin"}),"Regenerating..."]}):o.jsxs(o.Fragment,{children:[o.jsx(Kr,{className:"w-4 h-4"}),"Regenerate"]})}),o.jsxs("button",{onClick:y,disabled:i,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium",children:[o.jsx(fx,{className:"w-4 h-4"}),"Export PDF"]}),o.jsxs("button",{onClick:b,disabled:i,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium",children:[o.jsx(FS,{className:"w-4 h-4"}),"Export Excel"]})]})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Report Details"}),o.jsxs("div",{className:"grid grid-cols-3 gap-6",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:o.jsx(kS,{className:"w-5 h-5 text-blue-600"})}),o.jsxs("div",{children:[o.jsx("div",{className:"text-xs text-gray-500 uppercase",children:"Generated"}),o.jsx("div",{className:"font-medium text-gray-900",children:n.report_generated_at?S(n.report_generated_at):"N/A"})]})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:o.jsx(Tr,{className:"w-5 h-5 text-green-600"})}),o.jsxs("div",{children:[o.jsx("div",{className:"text-xs text-gray-500 uppercase",children:"Quotes Included"}),o.jsx("div",{className:"font-medium text-gray-900",children:n.report_quotes_count||0})]})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center",children:o.jsx(Ao,{className:"w-5 h-5 text-purple-600"})}),o.jsxs("div",{children:[o.jsx("div",{className:"text-xs text-gray-500 uppercase",children:"Coverage"}),o.jsx("div",{className:"font-medium text-gray-900",children:n.report_coverage_percent?`${n.report_coverage_percent}%`:"N/A"})]})]})]})]})]}):o.jsxs(o.Fragment,{children:[c&&o.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:o.jsxs("div",{className:"flex items-center gap-2 text-red-800",children:[o.jsx(Je,{className:"w-5 h-5"}),o.jsx("span",{className:"font-medium",children:c})]})}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center",children:[o.jsx("div",{className:"w-16 h-16 bg-amber-100 rounded-full flex items-center justify-center mx-auto mb-4",children:o.jsx(Je,{className:"w-8 h-8 text-amber-600"})}),o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Report Available"}),o.jsx("p",{className:"text-gray-500 mb-6",children:"Generate an award report to compare quotes and make award decisions."}),o.jsx("button",{onClick:g,disabled:i,className:"px-6 py-3 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium inline-flex items-center gap-2",children:i?o.jsxs(o.Fragment,{children:[o.jsx(js,{className:"w-5 h-5 animate-spin"}),"Generating Report..."]}):o.jsxs(o.Fragment,{children:[o.jsx(Tr,{className:"w-5 h-5"}),"Generate Award Report"]})})]})]})]}):o.jsx("div",{className:"flex items-center justify-center h-full",children:o.jsxs("div",{className:"text-center text-gray-400",children:[o.jsx(hx,{className:"w-16 h-16 mx-auto mb-4"}),o.jsx("p",{className:"text-lg",children:"Select a project to view details"})]})})})]})]})}function kV({projectId:e,reportId:t,onToast:r,onNavigate:s}){const[n,a]=j.useState([]),[i,l]=j.useState(null),[c,u]=j.useState(null),[d,f]=j.useState("MODEL"),[h,m]=j.useState(!0),[x,p]=j.useState([]),[g,w]=j.useState(null),[v,y]=j.useState(!1),[b,S]=j.useState(!1),[_,k]=j.useState("excel"),[E,T]=j.useState(null),[M,q]=j.useState(new Map),[D,W]=j.useState(!1),[ee,Y]=j.useState(!1),[G,ce]=j.useState(t||null),[Q,B]=j.useState(null),me=j.useRef(null),fe=j.useRef(null);j.useEffect(()=>{A(),t?ne(t):e?U():(m(!1),B("No project ID provided"))},[t,e]),j.useEffect(()=>{const J=K=>{fe.current&&!fe.current.contains(K.target)&&y(!1)};return document.addEventListener("mousedown",J),()=>document.removeEventListener("mousedown",J)},[]);const A=async()=>{try{const{data:J}=await ie.from("projects").select("id, name, client, approved_quote_id").order("last_accessed_at",{ascending:!1}).limit(10);if(J){p(J);const K=J.find(le=>le.id===e);w(K||null)}}catch(J){console.error("Error loading projects:",J)}},V=J=>{window.location.href=`?project=${J}`},L=()=>`05_Exports_Reports/VerifyPlus/${((g==null?void 0:g.name)||"Unknown-Project").replace(/[^a-zA-Z0-9-_]/g,"_")}/`,U=async()=>{var J;try{m(!0),B(null);const{data:K,error:le}=await ie.from("award_reports").select("*").eq("project_id",e).order("created_at",{ascending:!1}).limit(1).maybeSingle();if(le)throw new Error("Failed to load report");if(!K){B("No report found for this project. Generate one from the Reports Hub."),m(!1);return}K.result_json&&(a(K.result_json.comparisonData||[]),l(K.result_json.awardSummary||null),u(K.result_json.aiAnalysis||null),(J=K.params_json)!=null&&J.equalisationMode&&f(K.params_json.equalisationMode)),ce(K.id);const{data:ye}=await ie.from("quotes").select("id, supplier_name").eq("project_id",K.project_id);if(ye){const Re=new Map;ye.forEach(Te=>Re.set(Te.supplier_name,Te.id)),q(Re)}}catch(K){console.error("Error loading report:",K),B(K.message||"Failed to load report"),r==null||r(K.message||"Failed to load report","error")}finally{m(!1)}},ne=async J=>{var K;try{m(!0),B(null);const{data:le,error:ye}=await ie.from("award_reports").select("*").eq("id",J).maybeSingle();if(ye)throw new Error("Failed to load report");if(!le)throw new Error("Report not found");le.result_json&&(a(le.result_json.comparisonData||[]),l(le.result_json.awardSummary||null),u(le.result_json.aiAnalysis||null),(K=le.params_json)!=null&&K.equalisationMode&&f(le.params_json.equalisationMode)),ce(le.id);const{data:Re}=await ie.from("quotes").select("id, supplier_name").eq("project_id",le.project_id);if(Re){const Te=new Map;Re.forEach(Ue=>Te.set(Ue.supplier_name,Ue.id)),q(Te)}}catch(le){console.error("Error loading report:",le),B(le.message||"Failed to load report"),r==null||r(le.message||"Failed to load report","error")}finally{m(!1)}},xe=async()=>{try{m(!0),B(null),console.log("[Award Report] Regenerating report for project:",e);const J="https://cbankidsdfsvsgfygbzt.supabase.co/functions/v1/compute_award_report",K={Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNiYW5raWRzZGZzdnNnZnlnYnp0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMzMTk3NDgsImV4cCI6MjA3ODg5NTc0OH0.SXgc-9ZamplKeJm5_nl8J2-UzO7A0f8KbAnPZEmsiSo","Content-Type":"application/json"};console.log("[Award Report] Calling function:",J);const le=await fetch(J,{method:"POST",headers:K,body:JSON.stringify({projectId:e,force:!0})});if(console.log("[Award Report] Response status:",le.status),!le.ok){const Re=await le.text();throw console.error("[Award Report] Error response:",Re),new Error(`Server returned ${le.status}: ${Re}`)}const ye=await le.json();if(console.log("[Award Report] Response data:",ye),!ye||!ye.reportId)throw console.error("[Award Report] Invalid response:",ye),new Error((ye==null?void 0:ye.error)||(ye==null?void 0:ye.message)||"No report ID returned from server");ce(ye.reportId),await ne(ye.reportId),B(null),r==null||r("Report generated successfully","success")}catch(J){console.error("Error regenerating report:",J),B(J.message||"Failed to regenerate report"),r==null||r(J.message||"Failed to regenerate report","error")}finally{m(!1)}},pe=()=>{window.print()},oe=J=>{k(J),S(!0)},ue=()=>{S(!1),_==="excel"?we():P()},we=()=>{if(!i)return;const J=hr.book_new(),K=[["Award Summary Report"],["Generated:",new Date().toLocaleDateString()],["Equalisation Mode:",i.equalisationMode],["Total Systems:",i.totalSystems.toString()],[],["Supplier","Adjusted Total","Risk Score","Coverage %","Items Quoted","Notes"],...i.suppliers.map(Fe=>[Fe.supplierName,Fe.adjustedTotal,Fe.riskScore,Fe.coveragePercent,Fe.itemsQuoted,Fe.notes.join("; ")])],le=hr.aoa_to_sheet(K);hr.book_append_sheet(J,le,"Summary");const ye=[["Recommendations"],[],["Type","Supplier","Reason"],...i.recommendations.map(Fe=>[Fe.type.replace("_"," "),Fe.supplier.supplierName,Fe.reason])],Re=hr.aoa_to_sheet(ye);hr.book_append_sheet(J,Re,"Recommendations");const Te=["System ID","System Label"],Ue=i.suppliers.map(Fe=>Fe.supplierName);Te.push(...Ue);const it=new Map;n.forEach(Fe=>{const rt=`${Fe.systemId}|${Fe.systemLabel}`;it.has(rt)||it.set(rt,new Map),it.get(rt).set(Fe.supplier,Fe.unitRate)});const pt=[Te];it.forEach((Fe,rt)=>{const[sr,xt]=rt.split("|"),Vr=[sr,xt];Ue.forEach(ve=>{const Ge=Fe.get(ve);Vr.push(Ge!=null?Ge.toFixed(2):"")}),pt.push(Vr)});const tt=hr.aoa_to_sheet(pt);hr.book_append_sheet(J,tt,"Matrix");const Ce=`${e}_AwardReport.xlsx`;HE(J,Ce)},P=()=>{pe()},Me=async J=>{const K=M.get(J);if(!K){r==null||r("Quote not found","error");return}T(K);try{const{error:le}=await ie.from("projects").update({approved_quote_id:K,updated_at:new Date().toISOString()}).eq("id",e);if(le)throw new Error(le.message);const{error:ye}=await ie.from("quotes").update({status:"accepted",updated_at:new Date().toISOString()}).eq("id",K);if(ye)throw new Error(ye.message);r==null||r(`Approved ${J}`,"success"),g&&w({...g,approved_quote_id:K}),await A()}catch(le){console.error("Error approving quote:",le),r==null||r(le.message||"Failed to approve quote","error")}finally{T(null)}},je=()=>{if(!(g!=null&&g.approved_quote_id)){r==null||r("No approved quote selected","error");return}W(!0)},X=async J=>{W(!1),Y(!0);try{const ye=await fetch("https://cbankidsdfsvsgfygbzt.supabase.co/functions/v1/generate_base_tracker",{method:"POST",headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNiYW5raWRzZGZzdnNnZnlnYnp0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMzMTk3NDgsImV4cCI6MjA3ODg5NTc0OH0.SXgc-9ZamplKeJm5_nl8J2-UzO7A0f8KbAnPZEmsiSo","Content-Type":"application/json"},body:JSON.stringify({projectId:e,mode:J})}),Re=await ye.json();if(!ye.ok)throw new Error(Re.message||"Failed to generate base tracker");r==null||r(`Base Tracker created: ${Re.rowsInserted} lines`,"success"),s&&s("base-tracker")}catch(K){console.error("Error generating base tracker:",K),r==null||r(K.message||"Failed to generate base tracker","error")}finally{Y(!1)}};if(h)return o.jsx("div",{className:"flex items-center justify-center h-64",children:o.jsx("div",{className:"text-gray-500",children:"Loading award report..."})});if(Q)return o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center max-w-2xl mx-auto mt-12",children:[o.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:o.jsx(Tr,{className:"w-8 h-8 text-blue-600"})}),o.jsx("p",{className:"text-gray-900 text-lg font-semibold mb-2",children:"No Award Report Available"}),o.jsx("p",{className:"text-gray-600 mb-6",children:Q}),o.jsxs("button",{onClick:xe,disabled:h,className:"btn-primary disabled:opacity-50",children:[o.jsx(By,{className:"w-5 h-5"}),h?"Generating Report...":"Generate Award Report"]})]});if(!i||i.suppliers.length===0)return o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center",children:[o.jsx("p",{className:"text-gray-500 text-lg",children:"No data available."}),o.jsx("p",{className:"text-gray-400 mt-2",children:"No report data found. Please generate a report from the Reports Hub."})]});const z=i.recommendations.find(J=>J.type==="BEST_VALUE"),H=i.recommendations.find(J=>J.type==="LOWEST_RISK"),Z=i.recommendations.find(J=>J.type==="BALANCED");return o.jsxs("div",{id:"award-report-root","data-award-needs-project":"true",children:[o.jsx("style",{children:`
          @media print {
            body * {
              visibility: hidden;
            }
            #printable-report, #printable-report * {
              visibility: visible;
            }
            #printable-report {
              position: absolute;
              left: 0;
              top: 0;
              width: 100%;
            }
            .no-print {
              display: none !important;
            }
            .print-break {
              page-break-after: always;
            }
          }
        `}),o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"no-print flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Award Report"}),o.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Generated ",new Date(i.generatedAt).toLocaleString()]})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsxs("div",{className:"relative",ref:fe,children:[o.jsxs("button",{onClick:()=>y(!v),className:"flex items-center gap-2 px-3 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 transition-colors",children:[o.jsx(TS,{size:16}),o.jsx("span",{className:"text-sm",children:(g==null?void 0:g.name)||"Select Project"}),o.jsx(ri,{size:14,className:`transition-transform ${v?"rotate-180":""}`})]}),v&&o.jsx("div",{className:"absolute right-0 mt-2 w-64 bg-white rounded-lg shadow-lg border border-gray-200 z-50",children:o.jsx("div",{className:"p-2 max-h-80 overflow-y-auto",children:x.map(J=>o.jsxs("button",{onClick:()=>{y(!1),J.id!==e&&V(J.id)},className:`w-full text-left px-3 py-2 rounded-md text-sm hover:bg-gray-100 transition-colors ${J.id===e?"bg-blue-50 text-blue-900 font-medium":"text-gray-700"}`,children:[o.jsx("div",{className:"font-medium",children:J.name}),J.client&&o.jsx("div",{className:"text-xs text-gray-500",children:J.client})]},J.id))})})]}),o.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-blue-50 text-blue-800 rounded-md border border-blue-200",children:[o.jsx(Tr,{size:16}),o.jsxs("span",{className:"text-sm font-semibold",children:["Mode: ",d]})]}),o.jsx("button",{onClick:()=>f(d==="MODEL"?"PEER_MEDIAN":"MODEL"),className:"px-3 py-2 text-sm bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 transition-colors",children:"Toggle Mode"}),o.jsxs("button",{onClick:xe,disabled:h,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[o.jsx(Tr,{size:18}),h?"Regenerating...":"Regenerate"]}),o.jsxs("button",{onClick:()=>oe("pdf"),className:"flex items-center gap-2 px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors",children:[o.jsx(fx,{size:18}),"Export PDF"]}),o.jsxs("button",{onClick:()=>oe("excel"),className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors",children:[o.jsx(FS,{size:18}),"Export Excel"]}),o.jsxs("button",{onClick:je,disabled:!(g!=null&&g.approved_quote_id)||ee,"data-testid":"btn-generate-base-tracker",className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[o.jsx(wF,{size:18}),ee?"Creating...":"Create Base Tracker"]})]})]}),D&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 max-w-md w-full mx-4",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Create Base Tracker"}),o.jsx("p",{className:"text-sm text-gray-700 mb-6",children:"Choose how to generate the base tracker from the approved quote:"}),o.jsxs("div",{className:"space-y-3 mb-6",children:[o.jsxs("button",{onClick:()=>X("replace"),className:"w-full text-left p-4 border-2 border-gray-300 rounded-lg hover:border-blue-500 hover:bg-blue-50 transition-colors",children:[o.jsx("div",{className:"font-semibold text-gray-900 mb-1",children:"Replace"}),o.jsx("div",{className:"text-sm text-gray-600",children:"Delete all existing base tracker items and create new ones from the approved quote"})]}),o.jsxs("button",{onClick:()=>X("append"),className:"w-full text-left p-4 border-2 border-gray-300 rounded-lg hover:border-blue-500 hover:bg-blue-50 transition-colors",children:[o.jsx("div",{className:"font-semibold text-gray-900 mb-1",children:"Append"}),o.jsx("div",{className:"text-sm text-gray-600",children:"Keep existing base tracker items and add new ones from the approved quote"})]})]}),o.jsx("div",{className:"flex gap-3 justify-end",children:o.jsx("button",{onClick:()=>W(!1),className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 transition-colors",children:"Cancel"})})]})}),b&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 max-w-md w-full mx-4",children:[o.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Export ",_==="pdf"?"PDF":"Excel"," Report"]}),o.jsxs("div",{className:"mb-4",children:[o.jsxs("p",{className:"text-sm text-gray-700 mb-2",children:[o.jsx("strong",{children:"Filename:"})," ",e,"_AwardReport.",_==="pdf"?"pdf":"xlsx"]}),o.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-3",children:[o.jsx("p",{className:"text-xs font-semibold text-blue-900 mb-1",children:"Suggested Save Location:"}),o.jsx("p",{className:"text-sm text-blue-800 font-mono break-all",children:L()})]})]}),o.jsx("p",{className:"text-sm text-gray-600 mb-6",children:_==="pdf"?"The report will open in your browser's print dialog. Save as PDF from there.":"The Excel file will be downloaded to your default downloads folder."}),o.jsxs("div",{className:"flex gap-3 justify-end",children:[o.jsx("button",{onClick:()=>S(!1),className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 transition-colors",children:"Cancel"}),o.jsx("button",{onClick:ue,className:`px-4 py-2 text-white rounded-md transition-colors ${_==="pdf"?"bg-gray-600 hover:bg-gray-700":"bg-green-600 hover:bg-green-700"}`,children:"Continue"})]})]})}),o.jsx("div",{id:"printable-report",ref:me,children:o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-8",children:[o.jsxs("div",{className:"text-center mb-8 print:mb-6",children:[o.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Award Recommendation Report"}),o.jsx("p",{className:"text-gray-600",children:"Project Analysis & Supplier Evaluation"}),o.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:[new Date().toLocaleDateString()," | ",i.totalSystems," Systems | ",i.equalisationMode," Mode"]})]}),o.jsxs("div",{className:"grid grid-cols-3 gap-6 mb-8 print:mb-6",children:[o.jsxs("div",{className:"p-6 bg-gradient-to-br from-blue-50 to-blue-100 rounded-lg border-2 border-blue-300",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[o.jsx(By,{className:"text-blue-600",size:28}),o.jsx("h3",{className:"text-sm font-semibold text-blue-900 uppercase",children:"Best Value"})]}),z&&o.jsxs(o.Fragment,{children:[o.jsx("p",{className:"text-2xl font-bold text-blue-900",children:z.supplier.supplierName}),o.jsxs("p",{className:"text-lg text-blue-800 mt-1",children:["$",z.supplier.adjustedTotal.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),o.jsx("p",{className:"text-sm text-blue-700 mt-2",children:z.reason})]})]}),o.jsxs("div",{className:"p-6 bg-gradient-to-br from-green-50 to-green-100 rounded-lg border-2 border-green-300",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[o.jsx(c0,{className:"text-green-600",size:28}),o.jsx("h3",{className:"text-sm font-semibold text-green-900 uppercase",children:"Lowest Risk"})]}),H&&o.jsxs(o.Fragment,{children:[o.jsx("p",{className:"text-2xl font-bold text-green-900",children:H.supplier.supplierName}),o.jsxs("p",{className:"text-lg text-green-800 mt-1",children:["Risk Score: ",H.supplier.riskScore.toFixed(1)]}),o.jsx("p",{className:"text-sm text-green-700 mt-2",children:H.reason})]})]}),o.jsxs("div",{className:"p-6 bg-gradient-to-br from-purple-50 to-purple-100 rounded-lg border-2 border-purple-300",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[o.jsx(Ao,{className:"text-purple-600",size:28}),o.jsx("h3",{className:"text-sm font-semibold text-purple-900 uppercase",children:"Balanced"})]}),Z&&o.jsxs(o.Fragment,{children:[o.jsx("p",{className:"text-2xl font-bold text-purple-900",children:Z.supplier.supplierName}),o.jsxs("p",{className:"text-lg text-purple-800 mt-1",children:["$",Z.supplier.adjustedTotal.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),o.jsx("p",{className:"text-sm text-purple-700 mt-2",children:Z.reason})]})]})]}),c&&o.jsxs("div",{className:"mb-8 print:mb-6 bg-gradient-to-br from-amber-50 to-yellow-50 rounded-lg border-2 border-amber-200 p-6",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[o.jsx("div",{className:"p-2 bg-amber-100 rounded-lg",children:o.jsx("svg",{className:"w-6 h-6 text-amber-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})})}),o.jsx("h2",{className:"text-xl font-bold text-amber-900",children:"AI Analysis & Insights"})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[o.jsxs("div",{className:"bg-white rounded-lg p-4 border border-amber-200",children:[o.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Items Compared"}),o.jsx("div",{className:"text-2xl font-bold text-gray-900",children:c.totalItemsCompared||0})]}),o.jsxs("div",{className:"bg-white rounded-lg p-4 border border-amber-200",children:[o.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Matched Items"}),o.jsx("div",{className:"text-2xl font-bold text-green-600",children:c.matchedItems||0})]}),o.jsxs("div",{className:"bg-white rounded-lg p-4 border border-amber-200",children:[o.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Unmatched Items"}),o.jsx("div",{className:"text-2xl font-bold text-blue-600",children:c.unmatchedItems||0})]})]}),c.priceVariances&&o.jsxs("div",{className:"bg-white rounded-lg p-4 border border-amber-200 mb-3",children:[o.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Price Variances"}),o.jsx("p",{className:"text-sm text-gray-700",children:c.priceVariances})]}),c.scopeGaps&&o.jsxs("div",{className:"bg-white rounded-lg p-4 border border-amber-200 mb-3",children:[o.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Scope Gaps"}),o.jsx("p",{className:"text-sm text-gray-700",children:c.scopeGaps})]}),c.recommendations&&o.jsxs("div",{className:"bg-white rounded-lg p-4 border border-amber-200",children:[o.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"AI Recommendations"}),o.jsx("p",{className:"text-sm text-gray-700",children:c.recommendations})]})]}),o.jsxs("div",{className:"mb-8 print:mb-6",children:[o.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Executive Summary"}),o.jsxs("div",{className:"prose prose-sm max-w-none text-gray-700",children:[o.jsxs("p",{className:"mb-3",children:["Analysis of ",i.suppliers.length," supplier quotes covering ",i.totalSystems," passive fire protection systems. Equalisation performed using ",o.jsx("strong",{children:i.equalisationMode})," methodology to ensure fair comparison."]}),o.jsx("p",{children:"The evaluation considers both financial value and risk factors including price variance from model rates, scope coverage completeness, and data quality. Three recommendations are provided based on different prioritization strategies."})]})]}),o.jsxs("div",{className:"mb-8 print:mb-6",children:[o.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Supplier Comparison"}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full border-collapse text-sm",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"bg-gray-50",children:[o.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700 border border-gray-300",children:"Supplier"}),o.jsx("th",{className:"px-4 py-3 text-right font-semibold text-gray-700 border border-gray-300",children:"Adjusted Total"}),o.jsx("th",{className:"px-4 py-3 text-right font-semibold text-gray-700 border border-gray-300",children:"Risk Score"}),o.jsx("th",{className:"px-4 py-3 text-right font-semibold text-gray-700 border border-gray-300",children:"Coverage"}),o.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700 border border-gray-300",children:"Notes"}),o.jsx("th",{className:"px-4 py-3 text-center font-semibold text-gray-700 border border-gray-300 no-print",children:"Actions"})]})}),o.jsx("tbody",{children:i.suppliers.map((J,K)=>{const le=M.get(J.supplierName),ye=(g==null?void 0:g.approved_quote_id)===le,Re=E===le;return o.jsxs("tr",{className:"hover:bg-gray-50",children:[o.jsxs("td",{className:"px-4 py-3 font-semibold text-gray-900 border border-gray-300",children:[J.supplierName,ye&&o.jsx("span",{className:"ml-2 inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-green-100 text-green-800",children:"Approved"})]}),o.jsxs("td",{className:"px-4 py-3 text-right text-gray-900 border border-gray-300",children:["$",J.adjustedTotal.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),o.jsx("td",{className:`px-4 py-3 text-right font-semibold border border-gray-300 ${J.riskScore<=2?"text-green-700":J.riskScore<=5?"text-amber-700":"text-red-700"}`,children:J.riskScore.toFixed(1)}),o.jsxs("td",{className:"px-4 py-3 text-right text-gray-900 border border-gray-300",children:[J.coveragePercent.toFixed(0),"%",o.jsxs("span",{className:"text-xs text-gray-600 ml-1",children:["(",J.itemsQuoted,"/",J.totalItems,")"]})]}),o.jsx("td",{className:"px-4 py-3 text-gray-700 border border-gray-300",children:o.jsx("ul",{className:"text-xs space-y-0.5",children:J.notes.slice(0,3).map((Te,Ue)=>o.jsxs("li",{children:[" ",Te]},Ue))})}),o.jsx("td",{className:"px-4 py-3 border border-gray-300 no-print",children:o.jsx("div",{className:"flex items-center justify-center gap-2",children:ye?o.jsxs("div",{className:"flex items-center gap-1.5 text-green-600",children:[o.jsx(Yt,{size:20,className:"fill-green-600"}),o.jsx("span",{className:"text-sm font-medium",children:"Approved"})]}):o.jsxs("button",{onClick:()=>Me(J.supplierName),disabled:Re,"data-testid":"btn-approve-quote",className:"flex items-center gap-1.5 px-3 py-1.5 bg-blue-600 text-white text-xs font-medium rounded hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[o.jsx(Yt,{size:14}),Re?"Processing...":"Approve"]})})})]},K)})})]})})]}),n.length>0&&o.jsxs("div",{className:"mb-8 print:mb-6",children:[o.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Itemized Comparison"}),o.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Line-by-line comparison of all items across ",i.suppliers.length," suppliers"]}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full border-collapse text-xs",children:[o.jsxs("thead",{children:[o.jsxs("tr",{className:"bg-gray-50",children:[o.jsx("th",{className:"px-3 py-2 text-left font-semibold text-gray-700 border border-gray-300 sticky left-0 bg-gray-50 z-10",children:"Item Description"}),o.jsx("th",{className:"px-3 py-2 text-center font-semibold text-gray-700 border border-gray-300",children:"Qty"}),o.jsx("th",{className:"px-3 py-2 text-center font-semibold text-gray-700 border border-gray-300",children:"Unit"}),i.suppliers.map((J,K)=>o.jsx("th",{colSpan:2,className:"px-3 py-2 text-center font-semibold text-gray-700 border border-gray-300 bg-blue-50",children:J.supplierName},K))]}),o.jsxs("tr",{className:"bg-gray-50",children:[o.jsx("th",{className:"px-3 py-2 border border-gray-300 sticky left-0 bg-gray-50 z-10"}),o.jsx("th",{className:"px-3 py-2 border border-gray-300"}),o.jsx("th",{className:"px-3 py-2 border border-gray-300"}),i.suppliers.map((J,K)=>o.jsxs(o.Fragment,{children:[o.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-600 border border-gray-300 bg-blue-50",children:"Unit Rate"},`${K}-rate`),o.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-600 border border-gray-300 bg-blue-50",children:"Total"},`${K}-total`)]}))]})]}),o.jsx("tbody",{children:n.map((J,K)=>{const le=J.matchStatus==="unmatched";return o.jsxs("tr",{className:`hover:bg-gray-50 ${le?"bg-amber-50":""}`,children:[o.jsxs("td",{className:"px-3 py-2 text-gray-900 border border-gray-300 sticky left-0 bg-white z-10",children:[o.jsx("div",{className:"font-medium",children:J.description}),J.notes&&o.jsx("div",{className:"text-xs text-amber-600 mt-1",children:J.notes})]}),o.jsx("td",{className:"px-3 py-2 text-center text-gray-700 border border-gray-300",children:J.quantity}),o.jsx("td",{className:"px-3 py-2 text-center text-gray-700 border border-gray-300",children:J.unit}),i.suppliers.map((ye,Re)=>{const Te=J.suppliers[ye.supplierName],Ue=Te&&Te.unitPrice!==null;return o.jsxs(o.Fragment,{children:[o.jsx("td",{className:`px-3 py-2 text-right border border-gray-300 ${Ue?"":"bg-gray-100 text-gray-400"}`,children:Ue?`$${Te.unitPrice.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}`:"N/A"},`${Re}-rate`),o.jsx("td",{className:`px-3 py-2 text-right font-medium border border-gray-300 ${Ue?"":"bg-gray-100 text-gray-400"}`,children:Ue?`$${Te.total.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}`:"N/A"},`${Re}-total`)]})})]},K)})}),o.jsx("tfoot",{className:"bg-gray-50",children:o.jsxs("tr",{className:"font-bold",children:[o.jsx("td",{colSpan:3,className:"px-3 py-3 text-right text-gray-900 border border-gray-300",children:"Subtotals:"}),i.suppliers.map((J,K)=>o.jsxs(o.Fragment,{children:[o.jsx("td",{className:"border border-gray-300"},`${K}-spacer`),o.jsxs("td",{className:"px-3 py-3 text-right text-gray-900 border border-gray-300",children:["$",J.adjustedTotal.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]},`${K}-total`)]}))]})})]})})]}),o.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[o.jsx("h2",{className:"text-lg font-bold text-gray-900 mb-3",children:"Risk Scoring Methodology"}),o.jsxs("div",{className:"text-xs text-gray-600 space-y-1",children:[o.jsxs("p",{children:[" ",o.jsx("strong",{children:"+1 point"})," per RED variance cell (>20% from model rate)"]}),o.jsxs("p",{children:[" ",o.jsx("strong",{children:"+0.5 points"})," per AMBER variance cell (10-20% from model rate)"]}),o.jsxs("p",{children:[" ",o.jsx("strong",{children:"+1 point"})," per missing scope item requiring equalisation"]}),o.jsxs("p",{children:[" ",o.jsx("strong",{children:"+1 point"})," if >10% of items have low mapping confidence (<0.7)"]})]})]})]})})]})]})}function NV(e){const[t,r]=j.useState("hub"),[s,n]=j.useState(null),a=(l,c)=>{r(l)},i=()=>{r("hub"),n(null)};return t==="award-report"?o.jsx(kV,{projectId:e.projectId,reportId:s||void 0,onNavigate:i}):o.jsx(SV,{...e,onNavigate:l=>a(l)})}function EV({projectId:e}){return o.jsxs("div",{className:"p-8",children:[o.jsx(ua,{title:"Insights Dashboard",description:"AI-powered insights and analytics"}),o.jsx("div",{className:"mt-6 p-6 bg-white rounded-lg border border-gray-200",children:o.jsx("p",{className:"text-gray-600",children:"Insights Dashboard - Analytics and intelligence coming soon"})})]})}function YE(){const[e,t]=j.useState(!1),[r,s]=j.useState(null),[n,a]=j.useState(null),[i,l]=j.useState(null),[c,u]=j.useState(!1);j.useEffect(()=>{d()},[]);const d=async()=>{u(!0);try{const w=await fetch("https://cbankidsdfsvsgfygbzt.supabase.co/functions/v1/test_openai_connection",{method:"POST",headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNiYW5raWRzZGZzdnNnZnlnYnp0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMzMTk3NDgsImV4cCI6MjA3ODg5NTc0OH0.SXgc-9ZamplKeJm5_nl8J2-UzO7A0f8KbAnPZEmsiSo","Content-Type":"application/json"}});if(w.ok){const v=await w.json();l(v)}else l({ok:!1,error:"Failed to check OpenAI connection"})}catch{l({ok:!1,error:"Network error while checking OpenAI connection"})}finally{u(!1)}},f=async p=>{t(!0),a(null);try{const v=await fetch("https://cbankidsdfsvsgfygbzt.supabase.co/functions/v1/verify_installation",{method:"POST",headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNiYW5raWRzZGZzdnNnZnlnYnp0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMzMTk3NDgsImV4cCI6MjA3ODg5NTc0OH0.SXgc-9ZamplKeJm5_nl8J2-UzO7A0f8KbAnPZEmsiSo","Content-Type":"application/json"},body:JSON.stringify({autoFix:p})});if(!v.ok)throw new Error("Failed to run system check");const y=await v.json();s(y)}catch(g){a(g.message||"An error occurred while running the system check")}finally{t(!1)}},h=p=>{switch(p){case"pass":return o.jsx("span",{className:"text-2xl",children:""});case"fixed":return o.jsx("span",{className:"text-2xl",children:""});case"fail":return o.jsx("span",{className:"text-2xl",children:""})}},m=p=>{switch(p){case"pass":return"Pass";case"fixed":return"Fixed";case"fail":return"Fail"}},x=p=>new Date(p).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"});return o.jsxs("div",{className:"space-y-6 px-8 py-6",children:[o.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:o.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-6",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-3xl font-semibold brand-navy mb-2",children:"Verify+ System Audit"}),o.jsx("p",{className:"text-gray-600 text-base",children:"Comprehensive system health check and automatic issue resolution"})]}),o.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[o.jsx("button",{onClick:()=>f(!1),disabled:e,className:"flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:bg-gray-300 disabled:text-gray-500 disabled:cursor-not-allowed font-medium text-sm",children:e?o.jsxs(o.Fragment,{children:[o.jsx(Kr,{size:18,className:"animate-spin"}),"Running..."]}):o.jsxs(o.Fragment,{children:[o.jsx(qu,{size:18}),"Run Check"]})}),o.jsx("button",{onClick:()=>f(!0),disabled:e,className:"flex items-center justify-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed font-medium text-sm",children:e?o.jsxs(o.Fragment,{children:[o.jsx(Kr,{size:18,className:"animate-spin"}),"Running..."]}):o.jsxs(o.Fragment,{children:[o.jsx(gf,{size:18}),"Run & Auto-Fix"]})})]})]})}),o.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[o.jsxs("div",{className:"flex items-start justify-between mb-6",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-10 h-10 bg-blue-50 rounded-lg flex items-center justify-center flex-shrink-0",children:o.jsx(CF,{className:"text-blue-600",size:20})}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"OpenAI API Configuration"}),o.jsx("p",{className:"text-sm text-gray-600 mt-0.5",children:"Required for Verify+ Copilot functionality"})]})]}),o.jsxs("button",{onClick:d,disabled:c,className:"flex items-center gap-2 px-3 py-1.5 text-sm bg-white text-blue-700 rounded-full hover:bg-blue-50 transition-colors disabled:opacity-50 font-medium border border-blue-200",children:[o.jsx(Kr,{size:14,className:c?"animate-spin":""}),"Recheck"]})]}),c&&o.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[o.jsx(Kr,{size:16,className:"animate-spin"}),o.jsx("span",{className:"text-sm",children:"Checking OpenAI connection..."})]}),!c&&i&&o.jsx("div",{className:`rounded-lg p-4 ${i.ok?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"}`,children:o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 ${i.ok?"bg-green-100":"bg-red-100"}`,children:i.ok?o.jsx(nm,{className:"text-green-600",size:18}):o.jsx(Je,{className:"text-red-600",size:18})}),o.jsxs("div",{className:"flex-1",children:[o.jsx("h4",{className:`font-semibold text-sm mb-1 ${i.ok?"text-green-900":"text-red-900"}`,children:i.ok?"Connected":"Not Configured"}),o.jsx("p",{className:`text-xs mb-2 ${i.ok?"text-green-700":"text-red-700"}`,children:i.message||i.error||"Unknown status"}),i.ok&&o.jsxs("div",{className:"text-xs text-green-700 space-y-1 mt-2",children:[o.jsxs("div",{children:["Models available: ",o.jsx("span",{className:"font-semibold",children:i.modelCount})]}),o.jsxs("div",{children:["GPT-4 access: ",o.jsx("span",{className:"font-semibold",children:i.gpt4Available?"Yes":"No"})]})]}),!i.ok&&o.jsxs("div",{className:"mt-3 p-4 bg-white rounded-lg border border-red-200",children:[o.jsx("p",{className:"text-sm text-red-900 font-semibold mb-3",children:"Setup Instructions:"}),o.jsxs("ol",{className:"text-sm text-red-800 space-y-2 list-decimal list-inside",children:[o.jsx("li",{children:"Go to Supabase Dashboard"}),o.jsx("li",{children:"Navigate to Project Settings  Edge Functions  Secrets"}),o.jsxs("li",{children:["Add a new secret named ",o.jsx("code",{className:"bg-red-100 px-2 py-0.5 rounded font-mono text-xs",children:"OPENAI_API_KEY"})]}),o.jsx("li",{children:"Paste your OpenAI API key as the value"}),o.jsx("li",{children:'Click "Recheck" above to verify'})]})]})]})]})})]}),n&&o.jsx("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4",children:o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-full flex items-center justify-center flex-shrink-0",children:o.jsx(Je,{className:"text-red-600",size:18})}),o.jsxs("div",{children:[o.jsx("h3",{className:"font-semibold text-red-900 mb-1 text-sm",children:"Error"}),o.jsx("p",{className:"text-red-700 text-xs",children:n})]})]})}),r&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-5",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("div",{className:"text-xs font-semibold text-gray-600 mb-2 uppercase",children:"Passed"}),o.jsx("div",{className:"text-2xl font-bold text-green-600",children:r.passed})]}),o.jsx("div",{className:"w-12 h-12 bg-green-50 rounded-lg flex items-center justify-center",children:o.jsx(nm,{size:24,className:"text-green-600"})})]})}),o.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-5",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("div",{className:"text-xs font-semibold text-gray-600 mb-2 uppercase",children:"Failed"}),o.jsx("div",{className:"text-2xl font-bold text-red-600",children:r.failed})]}),o.jsx("div",{className:"w-12 h-12 bg-red-50 rounded-lg flex items-center justify-center",children:o.jsx(Je,{size:24,className:"text-red-600"})})]})}),o.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-5",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("div",{className:"text-xs font-semibold text-gray-600 mb-2 uppercase",children:"Fixed"}),o.jsx("div",{className:"text-2xl font-bold text-amber-600",children:r.fixed})]}),o.jsx("div",{className:"w-12 h-12 bg-amber-50 rounded-lg flex items-center justify-center",children:o.jsx(gf,{size:24,className:"text-amber-600"})})]})})]}),r.failed>0&&o.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-xl p-4",children:o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx("div",{className:"w-8 h-8 bg-amber-100 rounded-full flex items-center justify-center flex-shrink-0",children:o.jsx(Je,{className:"text-amber-600",size:18})}),o.jsxs("div",{children:[o.jsxs("h3",{className:"font-semibold text-amber-900 mb-1 text-sm",children:[r.failed," check",r.failed!==1?"s":""," failed"]}),o.jsx("p",{className:"text-amber-700 text-xs",children:"Run & Auto-Fix recommended to resolve these issues automatically"})]})]})}),o.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full",children:[o.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Area"}),o.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Name"}),o.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Status"}),o.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Detail"}),o.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Fix Hint"})]})}),o.jsx("tbody",{className:"divide-y divide-gray-200",children:r.checks.map((p,g)=>o.jsxs("tr",{className:`hover:bg-gray-50 transition-colors ${p.status==="fail"?"bg-red-50":""}`,children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:p.area}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:p.name}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxs("div",{className:"flex items-center gap-2",children:[h(p.status),o.jsx("span",{className:`text-sm font-medium ${p.status==="pass"?"text-green-700":p.status==="fixed"?"text-amber-700":"text-red-700"}`,children:m(p.status)})]})}),o.jsx("td",{className:"px-6 py-4 text-sm text-gray-700",children:p.detail}),o.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:p.fixHint||"-"})]},g))})]})})}),o.jsx("div",{className:"bg-gray-50 rounded-xl border border-gray-200 px-6 py-4",children:o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 text-sm",children:[o.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[o.jsx(o0,{size:16}),o.jsxs("span",{children:["Last check: ",x(r.timestamp)]})]}),o.jsx("div",{className:"text-gray-500 font-medium",children:"PassiveFire Verify+ v1.0.0"})]})})]}),!r&&!e&&!n&&o.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-12 text-center",children:o.jsxs("div",{className:"max-w-md mx-auto",children:[o.jsx("div",{className:"w-16 h-16 bg-blue-50 rounded-xl flex items-center justify-center mx-auto mb-4",children:o.jsx(qu,{size:32,className:"text-blue-600"})}),o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Ready to Check System Health"}),o.jsx("p",{className:"text-gray-600 text-sm mb-6 leading-relaxed",children:"Run a comprehensive system audit to verify your installation and identify any issues. Use Auto-Fix to automatically resolve common problems."}),o.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 justify-center",children:[o.jsxs("button",{onClick:()=>f(!1),className:"flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium text-sm",children:[o.jsx(qu,{size:18}),"Run Check"]}),o.jsxs("button",{onClick:()=>f(!0),className:"flex items-center justify-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors font-medium text-sm",children:[o.jsx(gf,{size:18}),"Run & Auto-Fix"]})]})]})})]})}function JE(){const[e,t]=j.useState([]),[r,s]=j.useState(!0),[n,a]=j.useState(new Set),[i,l]=j.useState("all"),c=async()=>{s(!0);try{let x=ie.from("copilot_audit").select("*").order("ts",{ascending:!1}).limit(100);i==="success"?x=x.eq("result_ok",!0):i==="failed"&&(x=x.eq("result_ok",!1));const{data:p,error:g}=await x;if(g){console.error("Error loading audit logs:",g);return}t(p||[])}finally{s(!1)}};j.useEffect(()=>{c()},[i]);const u=x=>{a(p=>{const g=new Set(p);return g.has(x)?g.delete(x):g.add(x),g})},d=x=>new Date(x).toLocaleString(),f=x=>x.includes("verify")?"bg-blue-50 text-blue-700 border-blue-200":x.includes("compute")?"bg-purple-50 text-purple-700 border-purple-200":x.includes("approve")?"bg-green-50 text-green-700 border-green-200":x.includes("generate")?"bg-amber-50 text-amber-700 border-amber-200":"bg-gray-100 text-gray-700 border-gray-200",h=x=>x==="owner"?"bg-red-50 text-red-700 border-red-200":x==="estimator"?"bg-orange-50 text-blue-700 border-orange-200":"bg-gray-100 text-gray-700 border-gray-200",m=e;return o.jsxs("div",{className:"space-y-6 p-6",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-3xl font-bold brand-navy mb-2",children:"Copilot Audit Logs"}),o.jsx("p",{className:"text-gray-600",children:"Last 100 Copilot actions for this project"})]}),o.jsxs("button",{onClick:c,disabled:r,className:"flex items-center justify-center gap-2 px-4 py-2 bg-blue-50 text-blue-700 rounded-lg hover:bg-blue-100 transition-colors disabled:opacity-50 font-medium border border-blue-100",children:[o.jsx(Kr,{size:18,className:r?"animate-spin":""}),o.jsx("span",{children:"Refresh"})]})]}),o.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4",children:o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[o.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[o.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Filter:"}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("button",{onClick:()=>l("all"),className:`px-4 py-2 rounded-full text-sm font-medium transition-colors ${i==="all"?"bg-brand-primary text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"All"}),o.jsx("button",{onClick:()=>l("success"),className:`px-4 py-2 rounded-full text-sm font-medium transition-colors ${i==="success"?"bg-green-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Success"}),o.jsx("button",{onClick:()=>l("failed"),className:`px-4 py-2 rounded-full text-sm font-medium transition-colors ${i==="failed"?"bg-red-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Failed"})]})]}),o.jsxs("div",{className:"text-sm text-gray-600 font-medium",children:["Showing ",m.length," log",m.length!==1?"s":""]})]})}),r?o.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-12 text-center",children:[o.jsx(Kr,{className:"animate-spin mx-auto mb-4 text-blue-600",size:48}),o.jsx("p",{className:"text-gray-600",children:"Loading audit logs..."})]}):m.length===0?o.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-12 text-center",children:o.jsx("p",{className:"text-gray-600",children:"No audit logs found"})}):o.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"bg-gray-50 border-b border-gray-200",children:[o.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(o0,{size:14}),o.jsx("span",{children:"Time"})]})}),o.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(hx,{size:14}),o.jsx("span",{children:"User"})]})}),o.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Role"}),o.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Tool"}),o.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Status"}),o.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Details"})]})}),o.jsx("tbody",{className:"divide-y divide-gray-200",children:m.map(x=>o.jsxs(ec.tr,{initial:{opacity:0},animate:{opacity:1},className:"hover:bg-gray-50 transition-colors",children:[o.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:d(x.ts)}),o.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:x.user_email}),o.jsx("td",{className:"px-6 py-4",children:o.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-medium border ${h(x.role)}`,children:x.role})}),o.jsx("td",{className:"px-6 py-4",children:o.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-medium border ${f(x.tool_name)}`,children:x.tool_name})}),o.jsx("td",{className:"px-6 py-4",children:x.result_ok?o.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 bg-green-50 text-green-700 rounded-full text-xs font-medium border border-green-200",children:[o.jsx(Yt,{size:14}),o.jsx("span",{children:"Success"})]}):o.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 bg-red-50 text-red-700 rounded-full text-xs font-medium border border-red-200",children:[o.jsx(to,{size:14}),o.jsx("span",{children:"Failed"})]})}),o.jsx("td",{className:"px-6 py-4",children:o.jsxs("button",{onClick:()=>u(x.id),className:"flex items-center gap-1 text-sm brand-primary hover:underline transition-colors font-medium",children:[n.has(x.id)?o.jsx(ri,{size:16}):o.jsx(i0,{size:16}),o.jsx("span",{children:"View"})]})})]},x.id))})]})}),Array.from(n).map(x=>{const p=m.find(g=>g.id===x);return p?o.jsxs(ec.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"border-t border-gray-200 bg-gray-50 p-6",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{children:[o.jsx("h4",{className:"text-xs font-semibold text-gray-700 uppercase mb-3",children:"Arguments"}),o.jsx("pre",{className:"text-xs text-gray-900 bg-white p-4 rounded-lg border border-gray-200 overflow-x-auto",children:JSON.stringify(p.args_json,null,2)})]}),o.jsxs("div",{children:[o.jsx("h4",{className:"text-xs font-semibold text-gray-700 uppercase mb-3",children:"Result"}),o.jsx("pre",{className:"text-xs text-gray-900 bg-white p-4 rounded-lg border border-gray-200 overflow-x-auto",children:JSON.stringify(p.result_json,null,2)})]})]}),p.error_message&&o.jsxs("div",{className:"mt-6",children:[o.jsx("h4",{className:"text-xs font-semibold text-red-700 uppercase mb-3",children:"Error Message"}),o.jsx("p",{className:"text-sm text-red-700 bg-red-50 p-4 rounded-lg border border-red-200",children:p.error_message})]})]},`details-${x}`):null})]})]})}async function jV(e,t){console.log("Snapshot creation not implemented")}async function TV(e){return[]}async function CV(e){console.log("Snapshot restore not implemented")}async function AV(e,t){return jV()}async function FV(e){return CV()}async function PV(e){return TV()}async function RV(e){console.log("Delete snapshot not implemented")}async function IV(e){console.log("Legacy data migration not implemented")}async function Cw(e){return!1}function OV(){return null}function DV(e){return e}const LV="https://verify-pdf-extractor.onrender.com";async function MV(){try{const e=await fetch(`${LV}/health`,{method:"GET"});if(!e.ok){const r=await e.text();throw new Error(`Health check failed: ${e.status} ${r}`)}return await e.json()}catch(e){throw console.error("PDF Extractor health check error:",e),new Error(e instanceof Error?`Health check failed: ${e.message}`:"Health check failed: Unknown error")}}function BV({projectId:e,onProjectDeleted:t,onNavigateToMatrix:r}){const[s,n]=j.useState("project"),[a,i]=j.useState(!1),[l,c]=j.useState(!1),[u,d]=j.useState(null),[f,h]=j.useState("api"),[m,x]=j.useState(""),[p,g]=j.useState([]),[w,v]=j.useState(!0),[y,b]=j.useState(!1),[S,_]=j.useState(!1),[k,E]=j.useState(!1),[T,M]=j.useState(!1),[q,D]=j.useState(!1),[W,ee]=j.useState(!1),[Y,G]=j.useState(""),[ce,Q]=j.useState(""),[B,me]=j.useState(!1),[fe,A]=j.useState([]),[V,L]=j.useState(!1),[U,ne]=j.useState(!1),[xe,pe]=j.useState(!1),[oe,ue]=j.useState(""),[we,P]=j.useState(""),[Me,je]=j.useState(""),[X,z]=j.useState(null),[H,Z]=j.useState(!1),J=fg(e);j.useEffect(()=>{K(),Fe(),le(),M(Cw())},[e]);const K=async()=>{v(!0);try{const ve=await J.loadSettings();ve&&(h(ve.model_rate_source),x(ve.api_base_url),ve.csv_data&&g(ve.csv_data))}catch(ve){console.error("Error loading settings:",ve)}v(!1)},le=async()=>{try{const{data:ve}=await ie.from("user_preferences").select("show_splash_on_load").eq("id","00000000-0000-0000-0000-000000000001").maybeSingle();ve&&(D(ve.show_splash_on_load),localStorage.setItem("showSplashOnLoad",String(ve.show_splash_on_load)))}catch(ve){console.error("Error loading user preferences:",ve)}},ye=async()=>{Z(!0),z(null);try{const ve=await MV();z(` Healthy - ${ve.status||"OK"}${ve.message?`: ${ve.message}`:""}`),d({type:"success",text:"PDF Extractor API is healthy and responding"})}catch(ve){const Ge=ve instanceof Error?ve.message:"Unknown error";z(` Failed - ${Ge}`),d({type:"error",text:`PDF Extractor health check failed: ${Ge}`})}finally{Z(!1)}},Re=async ve=>{try{const{error:Ge}=await ie.from("user_preferences").update({show_splash_on_load:ve}).eq("id","00000000-0000-0000-0000-000000000001");if(Ge)throw Ge;D(ve),localStorage.setItem("showSplashOnLoad",String(ve)),d({type:"success",text:`Splash screen will ${ve?"show":"not show"} on every load`})}catch(Ge){console.error("Error updating splash preference:",Ge),d({type:"error",text:"Failed to update splash screen preference"})}},Te=async()=>{i(!0),d(null);try{const{data:ve}=await ie.from("projects").select("*").eq("id",e).single(),{data:Ge}=await ie.from("quotes").select("*").eq("project_id",e),kt=(Ge==null?void 0:Ge.map(gi=>gi.id))||[],{data:Rr}=await ie.from("quote_items").select("*").in("quote_id",kt),{data:Wt}=await ie.from("scope_categories").select("*").eq("project_id",e),xs={version:"1.0",exported_at:new Date().toISOString(),project:ve,quotes:Ge||[],quote_items:Rr||[],scope_categories:Wt||[]},pn=new Blob([JSON.stringify(xs,null,2)],{type:"application/json"}),es=URL.createObjectURL(pn),et=document.createElement("a");et.href=es,et.download=`passivefire-project-${e}-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(et),et.click(),document.body.removeChild(et),URL.revokeObjectURL(es),d({type:"success",text:"Project data exported successfully!"})}catch(ve){console.error("Export error:",ve),d({type:"error",text:"Failed to export project data."})}finally{i(!1)}},Ue=async ve=>{var kt;const Ge=(kt=ve.target.files)==null?void 0:kt[0];if(Ge){c(!0),d(null);try{const Rr=await Ge.text(),Wt=JSON.parse(Rr);if(!Wt.quotes||!Wt.quote_items)throw new Error("Invalid file format");for(const xs of Wt.quotes){const{id:pn,project_id:es,created_at:et,updated_at:gi,...S0}=xs,{data:k0,error:Mc}=await ie.from("quotes").insert({...S0,project_id:e}).select().single();if(Mc)throw Mc;const N0=Wt.quote_items.filter(Mo=>Mo.quote_id===pn);for(const Mo of N0){const{id:hg,quote_id:mg,created_at:Bc,updated_at:pg,...E0}=Mo,{error:Uc}=await ie.from("quote_items").insert({...E0,quote_id:k0.id});if(Uc)throw Uc}}if(Wt.scope_categories&&Wt.scope_categories.length>0)for(const xs of Wt.scope_categories){const{id:pn,project_id:es,created_at:et,...gi}=xs;await ie.from("scope_categories").insert({...gi,project_id:e})}d({type:"success",text:`Imported ${Wt.quotes.length} quotes successfully!`}),ve.target.value=""}catch(Rr){console.error("Import error:",Rr),d({type:"error",text:"Failed to import project data. Please check the file format."})}finally{c(!1)}}},it=async()=>{var ve,Ge;if(confirm("This will check for legacy data in localStorage and migrate it to a new project. Continue?")){E(!0),d(null);try{if(!Cw()){d({type:"error",text:"No legacy data found to migrate."}),M(!1);return}const kt=await IV();kt.success&&kt.projectId?(d({type:"success",text:`Legacy data migrated successfully! ${((ve=kt.itemsMigrated)==null?void 0:ve.lines)||0} items from ${((Ge=kt.itemsMigrated)==null?void 0:Ge.suppliers)||0} suppliers. Reload the page to see the new project.`}),M(!1)):d({type:"error",text:kt.error||"Failed to migrate legacy data."})}catch(kt){console.error("Migration error:",kt),d({type:"error",text:"An error occurred during migration."})}finally{E(!1)}}},pt=async()=>{if(confirm("Are you sure you want to delete this project? This will remove all quotes and data. This action cannot be undone."))try{const{error:ve}=await ie.from("projects").delete().eq("id",e);if(ve)throw ve;t()}catch(ve){console.error("Delete error:",ve),d({type:"error",text:"Failed to delete project."})}},tt=async()=>{b(!0),d(null);try{await J.saveSettings({model_rate_source:f,api_base_url:m,csv_data:p.length>0?p:void 0})?(await ie.from("projects").update({updated_at:new Date().toISOString()}).eq("id",e),d({type:"success",text:"Settings saved successfully!"})):d({type:"error",text:"Failed to save settings."})}catch(ve){console.error("Save settings error:",ve),d({type:"error",text:"Failed to save settings."})}finally{b(!1)}},Ce=async ve=>{var kt;const Ge=(kt=ve.target.files)==null?void 0:kt[0];if(Ge){_(!0),d(null);try{const Rr=await Ge.arrayBuffer(),Wt=Im(Rr,{type:"array"}),xs=Wt.Sheets[Wt.SheetNames[0]],es=hr.sheet_to_json(xs).map(et=>({systemId:String(et.systemId||et.SystemId||et.system_id||"").trim(),sizeBucket:String(et.sizeBucket||et.SizeBucket||et.size_bucket||"").trim(),frr:String(et.frr||et.FRR||"").trim(),service:String(et.service||et.Service||"").trim(),subclass:String(et.subclass||et.Subclass||et.sub_class||"").trim(),componentCount:parseInt(et.componentCount||et.ComponentCount||et.component_count||"0"),modelRate:parseFloat(et.modelRate||et.ModelRate||et.model_rate||"0")})).filter(et=>et.systemId&&et.modelRate>0);if(es.length===0)throw new Error("No valid data found in CSV file");g(es),d({type:"success",text:`Loaded ${es.length} model rates from CSV.`}),ve.target.value=""}catch(Rr){console.error("CSV upload error:",Rr),d({type:"error",text:"Failed to parse CSV file. Please check the format."})}finally{_(!1)}}},Fe=async()=>{L(!0);const ve=await PV();A(ve),L(!1)},rt=async()=>{if(!oe||!we){d({type:"error",text:"Please provide snapshot key and name."});return}ne(!0),d(null);try{await AV(oe,e,{name:we,client:Me||"Unknown",created:new Date().toISOString().split("T")[0]})?(d({type:"success",text:`Snapshot "${oe}" saved successfully!`}),ue(""),P(""),je(""),await Fe()):d({type:"error",text:"Failed to save snapshot."})}catch(ve){console.error("Save snapshot error:",ve),d({type:"error",text:"Failed to save snapshot."})}finally{ne(!1)}},sr=async ve=>{if(confirm(`Restore snapshot "${ve}"? This will replace all current project data.`)){pe(!0),d(null);try{await FV(ve,e)?(d({type:"success",text:`Snapshot "${ve}" restored successfully! Refresh the page to see changes.`}),await K()):d({type:"error",text:"Failed to restore snapshot."})}catch(Ge){console.error("Restore snapshot error:",Ge),d({type:"error",text:"Failed to restore snapshot."})}finally{pe(!1)}}},xt=async ve=>{if(confirm(`Delete snapshot "${ve}"? This action cannot be undone.`)){d(null);try{await RV(ve)?(d({type:"success",text:`Snapshot "${ve}" deleted successfully!`}),await Fe()):d({type:"error",text:"Failed to delete snapshot."})}catch(Ge){console.error("Delete snapshot error:",Ge),d({type:"error",text:"Failed to delete snapshot."})}}},Vr=async()=>{var ve,Ge;if(!Y.trim()){alert("Please enter a template name");return}me(!0);try{const{data:kt}=await ie.auth.getSession(),Rr=(Ge=(ve=kt==null?void 0:kt.session)==null?void 0:ve.user)==null?void 0:Ge.id;if(!Rr){alert("You must be logged in to save templates");return}const{data:Wt}=await ie.from("projects").select("name").eq("id",e).maybeSingle(),xs=await J.loadSettings(),{data:pn}=await ie.from("project_settings").select("*").eq("project_id",e).maybeSingle(),{error:es}=await ie.from("project_templates").insert({name:Y.trim(),description:ce.trim(),trade:"Passive Fire",is_default:!1,created_by_user_id:Rr,project_settings:{...xs,...pn},analysis_settings:{},report_settings:{},compliance_settings:{}});if(es)throw es;d({type:"success",text:DV("saveProjectAsTemplate.toasts.success",{templateName:Y,projectName:(Wt==null?void 0:Wt.name)||"Project"})}),ee(!1),G(""),Q("")}catch(kt){console.error("Error saving template:",kt),alert("Failed to save template")}finally{me(!1)}};return o.jsxs("div",{className:"space-y-6",children:[o.jsx("div",{className:"bg-white rounded-lg shadow-sm border-b border-gray-200",children:o.jsxs("div",{className:"flex gap-1 p-2",children:[o.jsxs("button",{onClick:()=>n("project"),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-colors ${s==="project"?"bg-orange-50 text-brand-primary border border-brand-primary":"text-gray-600 hover:bg-gray-50"}`,children:[o.jsx(om,{size:18}),"Project Settings"]}),o.jsxs("button",{onClick:()=>n("systemcheck"),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-colors ${s==="systemcheck"?"bg-orange-50 text-brand-primary border border-brand-primary":"text-gray-600 hover:bg-gray-50"}`,children:[o.jsx(OF,{size:18}),"System Check"]}),o.jsxs("button",{onClick:()=>n("copilotaudit"),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-colors ${s==="copilotaudit"?"bg-orange-50 text-brand-primary border border-brand-primary":"text-gray-600 hover:bg-gray-50"}`,children:[o.jsx(c0,{size:18}),"Copilot Audit"]})]})}),u&&o.jsx("div",{className:`p-4 rounded-md ${u.type==="success"?"bg-green-50 text-green-800":"bg-red-50 text-red-800"}`,children:u.text}),s==="systemcheck"?o.jsx(YE,{}):s==="copilotaudit"?o.jsx(JE,{}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-6",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(om,{size:20,className:"text-gray-700"}),o.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Project Settings"})]}),o.jsxs("button",{onClick:()=>{const{data:ve}=ie.from("projects").select("name").eq("id",e).maybeSingle().then(({data:Ge})=>{G(`${(Ge==null?void 0:Ge.name)||"Project"} Template`)});ee(!0)},className:"flex items-center gap-2 px-4 py-2 text-blue-600 bg-blue-50 hover:bg-blue-100 rounded-lg transition-colors font-medium text-sm border border-blue-200",children:[o.jsx(xF,{size:16}),"saveProjectAsTemplate.buttonLabel"]})]}),o.jsx("h3",{className:"text-base font-semibold text-gray-900 mb-4",children:"Model Rate Provider"}),w?o.jsx("div",{className:"text-center py-8 text-gray-500",children:"Loading settings..."}):o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Model Rate Source"}),o.jsxs("div",{className:"flex gap-4",children:[o.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[o.jsx("input",{type:"radio",name:"modelRateSource",value:"api",checked:f==="api",onChange:ve=>h(ve.target.value),className:"w-4 h-4 text-blue-600"}),o.jsx(EF,{size:18,className:"text-gray-600"}),o.jsx("span",{className:"text-sm text-gray-700",children:"API"})]}),o.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[o.jsx("input",{type:"radio",name:"modelRateSource",value:"csv",checked:f==="csv",onChange:ve=>h(ve.target.value),className:"w-4 h-4 text-blue-600"}),o.jsx(Tr,{size:18,className:"text-gray-600"}),o.jsx("span",{className:"text-sm text-gray-700",children:"CSV"})]})]})]}),f==="api"&&o.jsxs("div",{children:[o.jsx("label",{htmlFor:"apiBaseUrl",className:"block text-sm font-medium text-gray-700 mb-2",children:"API Base URL"}),o.jsx("input",{id:"apiBaseUrl",type:"url",value:m,onChange:ve=>x(ve.target.value),placeholder:"https://gkdvcyocchnfwelrxvmz.supabase.co/functions/v1/rate-api",className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-gray-900"}),o.jsxs("div",{className:"mt-2 space-y-1",children:[o.jsx("p",{className:"text-xs text-gray-500",children:"Leave empty to use the default Verify+ Rate API"}),o.jsx("p",{className:"text-xs text-blue-600 font-mono",children:"Default: https://gkdvcyocchnfwelrxvmz.supabase.co/functions/v1/rate-api"}),o.jsxs("p",{className:"text-xs text-gray-500",children:["The API will be called as: POST ","{baseUrl}","/rate with system_label, size, frr, service, and subclass"]})]})]}),o.jsx(OV,{projectId:e}),o.jsxs("div",{className:"bg-gray-50 p-4 rounded-md border border-gray-200",children:[o.jsxs("p",{className:"text-sm text-gray-700 mb-2",children:[o.jsx("strong",{children:"Project ID:"})," ",o.jsx("code",{className:"text-xs bg-white px-2 py-1 rounded border border-gray-300",children:e})]}),o.jsx("p",{className:"text-xs text-gray-500",children:"Used for storage keys and data isolation"})]}),f==="csv"&&o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Upload ModelSolutions.csv"}),o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsxs("label",{className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors cursor-pointer",children:[o.jsx(cm,{size:18}),S?"Uploading...":"Upload CSV",o.jsx("input",{type:"file",accept:".csv,.xlsx,.xls",multiple:!1,onChange:Ce,disabled:S,className:"hidden"})]}),p.length>0&&o.jsxs("span",{className:"text-sm text-gray-600",children:[p.length," model rates loaded"]})]}),o.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"Required columns: systemId, sizeBucket, frr, service, subclass, componentCount, modelRate"}),p.length>0&&o.jsxs("div",{className:"mt-4 border border-gray-200 rounded-md overflow-hidden",children:[o.jsx("div",{className:"max-h-64 overflow-y-auto",children:o.jsxs("table",{className:"w-full text-xs",children:[o.jsx("thead",{className:"bg-gray-50 border-b border-gray-200 sticky top-0",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700",children:"System ID"}),o.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700",children:"Size Bucket"}),o.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700",children:"FRR"}),o.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700",children:"Service"}),o.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700",children:"Subclass"}),o.jsx("th",{className:"px-3 py-2 text-right font-medium text-gray-700",children:"Components"}),o.jsx("th",{className:"px-3 py-2 text-right font-medium text-gray-700",children:"Model Rate"})]})}),o.jsx("tbody",{className:"divide-y divide-gray-200",children:p.slice(0,10).map((ve,Ge)=>o.jsxs("tr",{className:"hover:bg-gray-50",children:[o.jsx("td",{className:"px-3 py-2 text-gray-900",children:ve.systemId}),o.jsx("td",{className:"px-3 py-2 text-gray-600",children:ve.sizeBucket}),o.jsx("td",{className:"px-3 py-2 text-gray-600",children:ve.frr}),o.jsx("td",{className:"px-3 py-2 text-gray-600",children:ve.service}),o.jsx("td",{className:"px-3 py-2 text-gray-600",children:ve.subclass}),o.jsx("td",{className:"px-3 py-2 text-right text-gray-900",children:ve.componentCount}),o.jsxs("td",{className:"px-3 py-2 text-right text-gray-900",children:["$",ve.modelRate.toFixed(2)]})]},Ge))})]})}),p.length>10&&o.jsxs("div",{className:"px-3 py-2 bg-gray-50 border-t border-gray-200 text-xs text-gray-500",children:["Showing 10 of ",p.length," rows"]})]})]}),o.jsx("div",{className:"flex items-center gap-3 pt-4 border-t border-gray-200",children:o.jsx("button",{onClick:tt,disabled:y||f==="csv"&&p.length===0,className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed",children:y?"Saving...":"Save Settings"})})]})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[o.jsx(u0,{className:"text-cyan-600",size:24}),o.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"User Experience"})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg border border-gray-200",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"Show Splash Screen on Every Load"}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Display the animated BurnRatePro splash screen each time the app loads"})]}),o.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[o.jsx("input",{type:"checkbox",checked:q,onChange:ve=>Re(ve.target.checked),className:"sr-only peer"}),o.jsx("div",{className:"w-11 h-6 bg-gray-300 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-cyan-300 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-cyan-600"})]})]}),o.jsx("div",{className:"text-xs text-gray-500 bg-blue-50 border border-blue-200 rounded-lg p-3",children:o.jsxs("p",{children:[o.jsx("strong",{children:"Tip:"})," Press ",o.jsx("kbd",{className:"px-2 py-1 bg-white border border-blue-300 rounded text-xs",children:"Shift"})," + ",o.jsx("kbd",{className:"px-2 py-1 bg-white border border-blue-300 rounded text-xs",children:"S"})," to replay the splash screen at any time"]})})]})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[o.jsxs("h2",{className:"text-xl font-semibold text-gray-900 mb-6 flex items-center gap-2",children:[o.jsx(My,{size:20,className:"text-gray-700"}),"PDF Extractor API"]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg border border-gray-200",children:[o.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-2",children:"External PDF Extraction Service"}),o.jsx("p",{className:"text-xs text-gray-600 mb-3",children:"This service automatically extracts structured data from supplier quote PDFs."}),o.jsxs("div",{className:"text-xs text-gray-500 space-y-1 mb-4",children:[o.jsxs("div",{children:[o.jsx("strong",{children:"Endpoint:"})," https://verify-pdf-extractor.onrender.com"]}),o.jsxs("div",{children:[o.jsx("strong",{children:"Status:"})," ",X||"Not checked"]})]}),o.jsx("button",{onClick:ye,disabled:H,className:"flex items-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed text-sm font-medium",children:H?o.jsxs(o.Fragment,{children:[o.jsx(Kr,{size:16,className:"animate-spin"}),"Checking..."]}):o.jsxs(o.Fragment,{children:[o.jsx(My,{size:16}),"Check Health"]})})]}),o.jsx("div",{className:"text-xs text-gray-500 bg-purple-50 border border-purple-200 rounded-lg p-3",children:o.jsxs("p",{children:[o.jsx("strong",{children:"Note:"})," The PDF extractor is called automatically when you upload a PDF in the Import Quotes screen. This health check verifies the service is online and responding."]})})]})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[o.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Project Data"}),o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"border-b border-gray-200 pb-6",children:[o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-3",children:"Export Data"}),o.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Export all project data including quotes, items, and categories to a JSON file."}),o.jsxs("button",{onClick:Te,disabled:a,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed",children:[o.jsx(Co,{size:18}),a?"Exporting...":"Export Project Data"]})]}),o.jsxs("div",{className:"border-b border-gray-200 pb-6",children:[o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-3",children:"Import Data"}),o.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Import quotes and items from a previously exported JSON file. This will add to existing data."}),o.jsxs("label",{className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors cursor-pointer inline-flex",children:[o.jsx(cm,{size:18}),l?"Importing...":"Import Project Data",o.jsx("input",{type:"file",accept:".json",multiple:!1,onChange:Ue,disabled:l,className:"hidden"})]})]}),T&&o.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[o.jsxs("h3",{className:"text-lg font-medium text-yellow-900 mb-3 flex items-center gap-2",children:[o.jsx(_n,{size:20,className:"text-yellow-600"}),"Legacy Data Migration"]}),o.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Legacy data detected in localStorage. Click below to migrate it to a new project in the database."}),o.jsxs("button",{onClick:it,disabled:k,className:"flex items-center gap-2 px-4 py-2 bg-yellow-600 text-white rounded-md hover:bg-yellow-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed",children:[o.jsx(Kr,{size:18,className:k?"animate-spin":""}),k?"Migrating...":"Re-run Migration"]})]}),o.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[o.jsx("h3",{className:"text-lg font-medium text-red-900 mb-3",children:"Danger Zone"}),o.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Permanently delete this project and all associated data. This action cannot be undone."}),o.jsxs("button",{onClick:pt,className:"flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors",children:[o.jsx(tc,{size:18}),"Delete Project"]})]})]})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[o.jsx(bF,{size:20,className:"text-gray-700"}),o.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Project Snapshots"})]}),o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"border-b border-gray-200 pb-6",children:[o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-3",children:"Save Current Project"}),o.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Create a snapshot of the current project state including all quotes, mappings, comparisons, and settings."}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"snapshotKey",className:"block text-sm font-medium text-gray-700 mb-2",children:"Snapshot Key *"}),o.jsx("input",{id:"snapshotKey",type:"text",value:oe,onChange:ve=>ue(ve.target.value),placeholder:"HowickLibrary_2025",className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-gray-900"})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"snapshotName",className:"block text-sm font-medium text-gray-700 mb-2",children:"Project Name *"}),o.jsx("input",{id:"snapshotName",type:"text",value:we,onChange:ve=>P(ve.target.value),placeholder:"Howick Library",className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-gray-900"})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"snapshotClient",className:"block text-sm font-medium text-gray-700 mb-2",children:"Client"}),o.jsx("input",{id:"snapshotClient",type:"text",value:Me,onChange:ve=>je(ve.target.value),placeholder:"Cassidy",className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-gray-900"})]})]}),o.jsxs("button",{onClick:rt,disabled:U||!oe||!we,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed",children:[o.jsx(im,{size:18}),U?"Saving Snapshot...":"Save Snapshot"]})]}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Saved Snapshots"}),o.jsxs("button",{onClick:Fe,disabled:V,className:"flex items-center gap-2 px-3 py-1 text-sm bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 transition-colors",children:[o.jsx(Kr,{size:16}),"Refresh"]})]}),V?o.jsx("div",{className:"text-center py-8 text-gray-500",children:"Loading snapshots..."}):fe.length===0?o.jsx("div",{className:"text-center py-8 text-gray-500 bg-gray-50 rounded-md border border-gray-200",children:"No snapshots saved yet."}):o.jsx("div",{className:"space-y-3",children:fe.map(ve=>o.jsx("div",{className:"p-4 bg-gray-50 rounded-md border border-gray-200 hover:border-blue-300 transition-colors",children:o.jsxs("div",{className:"flex items-start justify-between",children:[o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[o.jsx("h4",{className:"font-semibold text-gray-900",children:ve.projectMeta.name}),o.jsx("code",{className:"px-2 py-0.5 text-xs bg-white rounded border border-gray-300 text-gray-700",children:ve.projectKey})]}),o.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[o.jsxs("p",{children:[o.jsx("strong",{children:"Client:"})," ",ve.projectMeta.client," |",o.jsx("strong",{className:"ml-2",children:"Created:"})," ",ve.projectMeta.created]}),o.jsxs("p",{children:[o.jsx("strong",{children:"Suppliers:"})," ",ve.suppliers.length," |",o.jsx("strong",{className:"ml-2",children:"Items:"})," ",ve.normalisedLines.length," |",o.jsx("strong",{className:"ml-2",children:"Saved:"})," ",new Date(ve.snapshotDate||"").toLocaleDateString()]})]})]}),o.jsxs("div",{className:"flex gap-2 ml-4",children:[o.jsxs("button",{onClick:()=>sr(ve.projectKey),disabled:xe,className:"flex items-center gap-1 px-3 py-1 text-sm bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors disabled:bg-gray-400",children:[o.jsx(Kr,{size:14}),"Restore"]}),o.jsxs("button",{onClick:()=>xt(ve.projectKey),className:"flex items-center gap-1 px-3 py-1 text-sm bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors",children:[o.jsx(tc,{size:14}),"Delete"]})]})]})},ve.id))})]})]})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Account"}),o.jsx("div",{className:"space-y-4",children:o.jsxs("button",{onClick:async()=>{await ie.auth.signOut()},className:"flex items-center gap-2 px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors",children:[o.jsx(CS,{size:18}),"Logout"]})})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"About PassiveFire Verify+"}),o.jsxs("div",{className:"text-sm text-gray-600 space-y-2",children:[o.jsx("p",{children:"Version 1.0"}),o.jsx("p",{children:"PassiveFire Verify+ helps you manage and analyze quotes for passive fire protection projects. Import quotes, review items, compare suppliers, and generate award reports."})]})]})]}),W&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:o.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full",children:[o.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:o.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"saveProjectAsTemplate.modal.title"})}),o.jsxs("div",{className:"px-6 py-4 space-y-4",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["saveProjectAsTemplate.modal.fields.name.label"," ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",value:Y,onChange:ve=>G(ve.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white text-gray-900",placeholder:"saveProjectAsTemplate.modal.fields.name.placeholder"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"saveProjectAsTemplate.modal.fields.description.label"}),o.jsx("textarea",{value:ce,onChange:ve=>Q(ve.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"saveProjectAsTemplate.modal.fields.description.placeholder"})]}),o.jsx("div",{className:"text-sm text-gray-600 bg-blue-50 border border-blue-200 rounded-lg p-3",children:"saveProjectAsTemplate.modal.description"})]}),o.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex items-center justify-end gap-3",children:[o.jsx("button",{onClick:()=>{ee(!1),G(""),Q("")},className:"px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg transition-colors font-medium text-sm",children:"saveProjectAsTemplate.modal.buttons.cancel"}),o.jsx("button",{onClick:Vr,disabled:B||!Y.trim(),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium text-sm disabled:bg-gray-300 disabled:cursor-not-allowed",children:B?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Saving..."]}):o.jsxs(o.Fragment,{children:[o.jsx(im,{size:16}),"saveProjectAsTemplate.modal.buttons.confirm"]})})]})]})})]})}function UV({message:e,type:t,onClose:r,duration:s=5e3}){j.useEffect(()=>{if(s>0){const c=setTimeout(()=>{r()},s);return()=>clearTimeout(c)}},[s,r]);const n={success:Yt,error:to,info:vo,warning:Je},a={success:"bg-green-50 text-green-800 border-green-200",error:"bg-red-50 text-red-800 border-red-200",info:"bg-blue-50 text-blue-800 border-blue-200",warning:"bg-yellow-50 text-yellow-800 border-yellow-200"},i={success:"text-green-600",error:"text-red-600",info:"text-blue-600",warning:"text-yellow-600"},l=n[t];return o.jsxs("div",{className:`fixed top-4 right-4 z-50 flex items-start gap-3 min-w-80 max-w-md p-4 rounded-lg border shadow-lg ${a[t]} animate-slide-in`,children:[o.jsx(l,{size:20,className:`flex-shrink-0 mt-0.5 ${i[t]}`}),o.jsx("div",{className:"flex-1 text-sm font-medium",children:e}),o.jsx("button",{onClick:r,className:"flex-shrink-0 hover:opacity-70 transition-opacity",children:o.jsx(ps,{size:18})})]})}class zV{constructor(){T0(this,"listeners",new Set);T0(this,"messages",[])}subscribe(t){return this.listeners.add(t),()=>this.listeners.delete(t)}notify(){this.listeners.forEach(t=>t([...this.messages]))}show(t){const r={...t,id:Math.random().toString(36).substring(2,11),createdAt:Date.now(),duration:t.duration||5e3};this.messages.push(r),this.notify(),r.duration&&r.duration>0&&setTimeout(()=>{this.dismiss(r.id)},r.duration)}dismiss(t){this.messages=this.messages.filter(r=>r.id!==t),this.notify()}remove(t){this.dismiss(t)}clear(){this.messages=[],this.notify()}showAccessDenied(t){this.show({type:"warning",title:"Access denied",body:t||"You don't have permission to manage organisation members. If you need access, please contact your organisation admin.",duration:6e3})}}const Om=new zV;function $V(){const[e,t]=j.useState([]);j.useEffect(()=>Om.subscribe(i=>{t(i.map(l=>({id:l.id,type:l.type,title:l.title,body:l.body||"",duration:l.duration||5e3})))}),[]);const r=a=>{Om.remove(a)},s=a=>{switch(a){case"success":return o.jsx(Yt,{className:"text-green-500",size:20});case"error":return o.jsx(Je,{className:"text-red-500",size:20});case"warning":return o.jsx(Je,{className:"text-amber-500",size:20});case"info":return o.jsx(vo,{className:"text-blue-500",size:20});default:return o.jsx(vo,{className:"text-gray-500",size:20})}},n=a=>{switch(a){case"success":return"bg-green-50 border-green-200";case"error":return"bg-red-50 border-red-200";case"warning":return"bg-amber-50 border-amber-200";case"info":return"bg-blue-50 border-blue-200";default:return"bg-gray-50 border-gray-200"}};return o.jsx("div",{className:"fixed top-4 right-4 z-50 flex flex-col gap-2 pointer-events-none",children:o.jsx(tx,{children:e.map(a=>o.jsx(ec.div,{initial:{opacity:0,x:100,scale:.8},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:100,scale:.8},className:`min-w-80 max-w-md rounded-lg border shadow-lg p-4 pointer-events-auto ${n(a.type)}`,children:o.jsxs("div",{className:"flex items-start gap-3",children:[s(a.type),o.jsxs("div",{className:"flex-1 min-w-0",children:[a.title&&o.jsx("div",{className:"font-semibold text-gray-900 mb-1",children:a.title}),o.jsx("div",{className:"text-sm text-gray-700",children:a.body})]}),o.jsx("button",{onClick:()=>r(a.id),className:"text-gray-400 hover:text-gray-600 transition-colors",children:o.jsx(ps,{size:18})})]})},a.id))})})}function VV(){return o.jsx("footer",{className:"py-4 px-6 flex justify-center lg:justify-end",children:o.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-full border border-gray-200 bg-white/90 text-xs text-gray-500",children:[o.jsx("span",{className:"font-medium",children:"PassiveFire Verify+"}),o.jsx("span",{className:"text-gray-300",children:""}),o.jsx("span",{children:"v1.9"}),o.jsx("span",{className:"text-gray-300",children:""}),o.jsx("span",{children:" 2025 PassiveFire Verify+. All rights reserved."})]})})}function WV({isOpen:e,onClose:t,currentProjectId:r,allProjects:s,onNavigate:n}){const[a,i]=j.useState(""),[l,c]=j.useState([{role:"assistant",content:"Hi! I'm your AI Copilot. I can help you navigate the app, answer questions about your quotes, and provide insights. What can I help you with?"}]),u=()=>{if(!a.trim())return;c(h=>[...h,{role:"user",content:a}]);const d=a.toLowerCase();let f="I'm still learning! This is a placeholder response. In production, I would be powered by AI to provide intelligent assistance.";d.includes("quote")||d.includes("import")?(f="To import quotes, navigate to the Quotes tab and upload your PDF or Excel files. I can help you with parsing issues if you encounter any.",setTimeout(()=>n("quotes",r),2e3)):d.includes("report")||d.includes("award")?(f="The Award Report is generated in the Reports section. It uses AI to analyze all quotes and recommend the best supplier based on price, coverage, and risk.",setTimeout(()=>n("reports",r),2e3)):(d.includes("scope")||d.includes("matrix"))&&(f="The Scope Matrix shows a side-by-side comparison of all suppliers' pricing. It highlights variances and helps identify gaps in coverage.",setTimeout(()=>n("scope",r),2e3)),setTimeout(()=>{c(h=>[...h,{role:"assistant",content:f}])},500),i("")};return o.jsx(tx,{children:e&&o.jsxs(o.Fragment,{children:[o.jsx(ec.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-30 z-40",onClick:t}),o.jsxs(ec.div,{initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:{type:"spring",damping:25,stiffness:200},className:"fixed right-0 top-0 h-full w-96 bg-white shadow-2xl z-50 flex flex-col",children:[o.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-purple-600 to-blue-600 rounded-full flex items-center justify-center",children:o.jsx(u0,{size:18,className:"text-white"})}),o.jsx("h2",{className:"text-lg font-semibold",children:"AI Copilot"})]}),o.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:o.jsx(ps,{size:20})})]}),o.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:l.map((d,f)=>o.jsx("div",{className:`flex ${d.role==="user"?"justify-end":"justify-start"}`,children:o.jsx("div",{className:`max-w-[80%] rounded-lg p-3 ${d.role==="user"?"bg-blue-600 text-white":"bg-gray-100 text-gray-900"}`,children:d.content})},f))}),o.jsx("div",{className:"p-4 border-t border-gray-200",children:o.jsxs("div",{className:"flex gap-2",children:[o.jsx("input",{type:"text",value:a,onChange:d=>i(d.target.value),onKeyPress:d=>d.key==="Enter"&&u(),placeholder:"Ask me anything...",className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),o.jsx("button",{onClick:u,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:o.jsx(IF,{size:18})})]})})]})]})})}function qV(){const[e,t]=j.useState(""),[r,s]=j.useState(""),[n,a]=j.useState(!1),[i,l]=j.useState(""),[c,u]=j.useState(!1),d=async f=>{f.preventDefault(),l(""),a(!0);try{if(c){const{error:h}=await ie.auth.signUp({email:e,password:r});if(h)throw h;l("Check your email for the confirmation link")}else{const{error:h}=await ie.auth.signInWithPassword({email:e,password:r});if(h)throw h}}catch(h){l(h.message||"An error occurred")}finally{a(!1)}};return o.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",children:o.jsxs("div",{className:"max-w-md w-full bg-white rounded-2xl shadow-xl p-8",children:[o.jsxs("div",{className:"text-center mb-8",children:[o.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-blue-600 rounded-full mb-4",children:o.jsx(c0,{className:"text-white",size:32})}),o.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"PassiveFire Verify+"}),o.jsx("p",{className:"text-gray-600",children:c?"Create your account":"Sign in to your account"})]}),o.jsxs("form",{onSubmit:d,className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),o.jsxs("div",{className:"relative",children:[o.jsx(RF,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:20}),o.jsx("input",{type:"email",value:e,onChange:f=>t(f.target.value),required:!0,className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white text-gray-900",placeholder:"you@example.com"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),o.jsxs("div",{className:"relative",children:[o.jsx(PF,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:20}),o.jsx("input",{type:"password",value:r,onChange:f=>s(f.target.value),required:!0,className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white text-gray-900",placeholder:""})]})]}),i&&o.jsx("div",{className:`text-sm ${i.includes("email")?"text-green-600":"text-red-600"} bg-red-50 p-3 rounded-lg`,children:i}),o.jsx("button",{type:"submit",disabled:n,className:"w-full bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed font-medium",children:n?"Please wait...":c?"Sign Up":"Sign In"})]}),o.jsx("div",{className:"mt-6 text-center",children:o.jsx("button",{onClick:()=>u(!c),className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:c?"Already have an account? Sign in":"Don't have an account? Sign up"})})]})})}function Aw({onOrganisationSelected:e}){const{organisations:t,setCurrentOrganisation:r,loading:s,refreshOrganisations:n}=wa(),[a,i]=j.useState(!1),[l,c]=j.useState(""),[u,d]=j.useState(""),f=m=>{r(m),e()},h=async()=>{if(!l.trim()){d("Please enter an organisation name");return}d(""),i(!0);try{const{data:{user:m}}=await ie.auth.getUser();if(!m){d("Not authenticated"),i(!1);return}const{data:x,error:p}=await ie.from("organisations").insert({name:l.trim()}).select().single();if(p)throw p;await ie.from("organisation_members").insert({organisation_id:x.id,user_id:m.id,role:"admin"}),await n(),c(""),d(""),r(x),e()}catch(m){d(m.message||"Failed to create organisation")}finally{i(!1)}};return s?o.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:o.jsxs("div",{className:"text-center",children:[o.jsx(js,{className:"mx-auto mb-4 text-blue-600 animate-spin",size:48}),o.jsx("p",{className:"text-gray-600",children:"Loading organisations..."})]})}):o.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:o.jsxs("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-8",children:[o.jsxs("div",{className:"text-center mb-6",children:[o.jsx(go,{className:"mx-auto mb-4 text-blue-600",size:48}),o.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Select Organisation"}),o.jsx("p",{className:"text-gray-600",children:"Choose which organisation to work with"})]}),t.length>0?o.jsx("div",{className:"space-y-3",children:t.map(m=>o.jsx("button",{onClick:()=>f(m),className:"w-full p-4 border border-gray-200 rounded-lg hover:border-blue-500 hover:bg-blue-50 transition-colors text-left",children:o.jsx("div",{className:"font-semibold text-gray-900",children:m.name})},m.id))}):o.jsxs("div",{className:"text-center py-8",children:[o.jsx(Je,{className:"mx-auto mb-4 text-gray-400",size:48}),o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Organisations Found"}),o.jsx("p",{className:"text-gray-600 mb-6",children:"You are not a member of any organisation yet. Create one to get started."}),o.jsxs("div",{className:"space-y-3",children:[o.jsx("input",{type:"text",value:l,onChange:m=>c(m.target.value),onKeyPress:m=>m.key==="Enter"&&h(),placeholder:"Organisation name",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:a}),u&&o.jsx("div",{className:"text-red-600 text-sm",children:u}),o.jsx("button",{onClick:h,disabled:a,className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:a?o.jsxs(o.Fragment,{children:[o.jsx(js,{size:20,className:"animate-spin"}),"Creating..."]}):o.jsxs(o.Fragment,{children:[o.jsx(l0,{size:20}),"Create Organisation"]})})]})]})]})})}function HV(){const{currentOrganisation:e}=wa();return o.jsxs("div",{children:[o.jsx(ua,{title:"Organisation Settings",description:"Manage your organisation preferences"}),o.jsxs("div",{className:"mt-6 p-6 bg-white rounded-lg border border-gray-200",children:[o.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Current Organisation"}),o.jsx("p",{className:"text-gray-600",children:e==null?void 0:e.name})]})]})}function Fw(){return o.jsxs("div",{className:"p-8",children:[o.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Admin Dashboard"}),o.jsx("p",{className:"text-gray-600",children:"Platform administration"})]})}function GV(){const[e,t]=j.useState([]),[r,s]=j.useState([]),[n,a]=j.useState(!0),[i,l]=j.useState(""),[c,u]=j.useState("all");j.useEffect(()=>{d()},[]),j.useEffect(()=>{f()},[i,c,e]);const d=async()=>{try{const{data:x,error:p}=await ie.from("organisations").select("*").order("created_at",{ascending:!1});if(p)throw p;const g=await Promise.all((x||[]).map(async w=>{const{data:v}=await ie.from("organisation_members").select("user_id, role, status").eq("organisation_id",w.id),y=v==null?void 0:v.find(T=>T.role==="owner"),b=(v==null?void 0:v.filter(T=>T.status==="active"&&["owner","admin","member"].includes(T.role)).length)||0;let S="";if(y){const{data:T}=await ie.from("profiles").select("email, full_name").eq("id",y.user_id).maybeSingle();S=(T==null?void 0:T.email)||""}const{data:_}=await ie.from("subscriptions").select("plan_name").eq("organisation_id",w.id).maybeSingle(),{count:k}=await ie.from("projects").select("*",{count:"exact",head:!0}).eq("organisation_id",w.id),{data:E}=await ie.from("projects").select("updated_at").eq("organisation_id",w.id).order("updated_at",{ascending:!1}).limit(1).maybeSingle();return{...w,owner_email:S,plan_name:(_==null?void 0:_.plan_name)||"Trial",seats_used:b,project_count:k||0,last_active:(E==null?void 0:E.updated_at)||w.created_at}}));t(g)}catch(x){console.error("Error loading organisations:",x)}finally{a(!1)}},f=()=>{let x=e;if(c!=="all"&&(x=x.filter(p=>p.status===c)),i.trim()){const p=i.toLowerCase();x=x.filter(g=>g.name.toLowerCase().includes(p)||g.owner_email&&g.owner_email.toLowerCase().includes(p))}s(x)},h=x=>new Date(x).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"}),m=x=>{switch(x){case"trial":return"bg-amber-50 text-amber-700";case"suspended":return"bg-rose-50 text-rose-700";default:return"bg-emerald-50 text-emerald-700"}};return o.jsxs("div",{className:"px-6 py-6 max-w-7xl mx-auto",children:[o.jsxs("div",{className:"flex items-start justify-between mb-6",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-xl font-semibold text-slate-900",children:"Organisations"}),o.jsx("p",{className:"mt-1 text-sm text-slate-500",children:"Manage client organisations, seat limits, and subscription status."})]}),o.jsx("button",{onClick:()=>window.location.href="/admin/organisations/new",className:"inline-flex items-center rounded-lg bg-[#0A66C2] px-4 py-2 text-sm font-semibold text-white shadow hover:bg-[#0952A0] transition",children:"Create organisation"})]}),o.jsxs("div",{className:"mb-4 flex items-center gap-4",children:[o.jsxs("div",{className:"relative flex-1",children:[o.jsx(bd,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:16}),o.jsx("input",{type:"text",placeholder:"Search by organisation name or owner email",value:i,onChange:x=>l(x.target.value),className:"w-full rounded-lg border border-slate-300 bg-slate-50 pl-9 pr-3 py-2 text-sm text-slate-800 placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-[#0A66C2] focus:border-[#0A66C2]"})]}),o.jsxs("select",{value:c,onChange:x=>u(x.target.value),className:"rounded-lg border border-slate-300 bg-slate-50 px-3 py-2 text-sm text-slate-800 focus:outline-none focus:ring-2 focus:ring-[#0A66C2] focus:border-[#0A66C2]",children:[o.jsx("option",{value:"all",children:"All"}),o.jsx("option",{value:"active",children:"Active"}),o.jsx("option",{value:"trial",children:"Trial"}),o.jsx("option",{value:"suspended",children:"Suspended"})]})]}),o.jsx("div",{className:"rounded-xl border border-slate-200 bg-white shadow-[0_4px_14px_rgba(15,23,42,0.06)] overflow-hidden",children:n?o.jsx("div",{className:"text-center py-12 text-slate-500",children:"Loading organisations..."}):r.length===0?o.jsx("div",{className:"text-center py-12 text-slate-500",children:i||c!=="all"?"No organisations found":"No organisations yet"}):o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full table-auto text-left text-sm",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"border-b border-slate-100",children:[o.jsx("th",{className:"px-4 py-3 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Organisation"}),o.jsx("th",{className:"px-4 py-3 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Owner"}),o.jsx("th",{className:"px-4 py-3 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Plan"}),o.jsx("th",{className:"px-4 py-3 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Seats"}),o.jsx("th",{className:"px-4 py-3 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Projects"}),o.jsx("th",{className:"px-4 py-3 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Status"}),o.jsx("th",{className:"px-4 py-3 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Last active"}),o.jsx("th",{className:"px-4 py-3 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Actions"})]})}),o.jsx("tbody",{children:r.map(x=>o.jsxs("tr",{className:"border-b border-slate-100 hover:bg-slate-50 cursor-pointer",onClick:()=>window.location.href=`/admin/organisations/${x.id}`,children:[o.jsx("td",{className:"px-4 py-3 align-middle",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"font-medium text-slate-900",children:x.name}),x.status!=="active"&&o.jsx("span",{className:`inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium ${m(x.status)}`,children:x.status.charAt(0).toUpperCase()+x.status.slice(1)})]})}),o.jsx("td",{className:"px-4 py-3 align-middle text-sm text-slate-600",children:x.owner_email||""}),o.jsx("td",{className:"px-4 py-3 align-middle text-sm text-slate-800",children:x.plan_name}),o.jsx("td",{className:"px-4 py-3 align-middle text-sm text-slate-800",children:o.jsxs("span",{className:x.seats_used>x.seat_limit?"text-rose-600 font-medium":"",children:[x.seats_used," / ",x.seat_limit]})}),o.jsx("td",{className:"px-4 py-3 align-middle text-sm text-slate-800",children:x.project_count}),o.jsx("td",{className:"px-4 py-3 align-middle",children:o.jsx("span",{className:`inline-flex items-center rounded-full px-2 py-1 text-xs font-medium ${m(x.status)}`,children:x.status.charAt(0).toUpperCase()+x.status.slice(1)})}),o.jsx("td",{className:"px-4 py-3 align-middle text-sm text-slate-600",children:h(x.last_active)}),o.jsx("td",{className:"px-4 py-3 align-middle",children:o.jsx("button",{onClick:p=>{p.stopPropagation(),window.location.href=`/admin/organisations/${x.id}`},className:"text-xs font-medium text-[#0A66C2] hover:underline",children:"Open"})})]},x.id))})]})})})]})}function KV({organisationId:e}){const[t,r]=j.useState(null),[s,n]=j.useState(null),[a,i]=j.useState([]),[l,c]=j.useState([]),[u,d]=j.useState(!0),[f,h]=j.useState(!1),[m,x]=j.useState(!1),[p,g]=j.useState(""),[w,v]=j.useState(10),[y,b]=j.useState(null),[S,_]=j.useState(""),[k,E]=j.useState("");j.useEffect(()=>{T()},[e]);const T=async()=>{try{const{data:G,error:ce}=await ie.from("organisations").select("*").eq("id",e).single();if(ce)throw ce;r(G),v(G.seat_limit),E(new Date(G.created_at).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"}));const{data:Q}=await ie.from("subscriptions").select("*").eq("organisation_id",e).maybeSingle();n(Q),g((Q==null?void 0:Q.plan_name)||"Trial");const{data:B}=await ie.from("organisation_members").select("*").eq("organisation_id",e).order("activated_at",{ascending:!1,nullsFirst:!1}),me=await Promise.all((B||[]).map(async V=>{const{data:L}=await ie.from("profiles").select("email, full_name").eq("id",V.user_id).maybeSingle();return V.role==="owner"&&_((L==null?void 0:L.email)||"Unknown"),{...V,email:(L==null?void 0:L.email)||"Unknown",full_name:L==null?void 0:L.full_name}}));i(me);const{data:fe}=await ie.from("projects").select("*").eq("organisation_id",e).order("updated_at",{ascending:!1}),A=await Promise.all((fe||[]).map(async V=>{const{count:L}=await ie.from("quotes").select("*",{count:"exact",head:!0}).eq("project_id",V.id),{data:U}=await ie.from("profiles").select("email").eq("id",V.user_id).maybeSingle();return{...V,quote_count:L||0,owner_email:U==null?void 0:U.email}}));c(A)}catch(G){console.error("Error loading organisation:",G)}finally{d(!1)}},M=async()=>{if(t){h(!0);try{const{error:G}=await ie.from("organisations").update({seat_limit:w}).eq("id",e);if(G)throw G;if(s){const{error:ce}=await ie.from("subscriptions").update({plan_name:p,seat_limit:w}).eq("organisation_id",e);if(ce)throw ce}b({type:"success",message:"Changes saved successfully"}),x(!1),await T()}catch(G){b({type:"error",message:G.message||"Failed to save changes"})}finally{h(!1)}}},q=async()=>{if(confirm("Suspend this organisation? Members will lose access immediately."))try{const{error:G}=await ie.from("organisations").update({status:"suspended"}).eq("id",e);if(G)throw G;b({type:"success",message:"Organisation suspended"}),await T()}catch(G){b({type:"error",message:G.message||"Failed to suspend organisation"})}},D=async()=>{try{const{error:G}=await ie.from("organisations").update({status:"active"}).eq("id",e);if(G)throw G;b({type:"success",message:"Organisation activated"}),await T()}catch(G){b({type:"error",message:G.message||"Failed to activate organisation"})}},W=G=>new Date(G).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"}),ee=G=>{switch(G){case"trial":return"bg-amber-50 text-amber-700 border-amber-200";case"suspended":return"bg-rose-50 text-rose-700 border-rose-200";default:return"bg-emerald-50 text-emerald-700 border-emerald-200"}},Y=a.filter(G=>G.status==="active"&&["owner","admin","member"].includes(G.role)).length;return u?o.jsx("div",{className:"px-6 py-6 max-w-7xl mx-auto",children:o.jsx("div",{className:"text-center py-12 text-slate-500",children:"Loading organisation..."})}):t?o.jsxs("div",{className:"px-6 py-6 max-w-7xl mx-auto",children:[y&&o.jsxs("div",{className:`fixed top-4 right-4 z-50 rounded-lg px-4 py-3 shadow-lg flex items-center gap-3 ${y.type==="success"?"bg-emerald-50 text-emerald-800 border border-emerald-200":"bg-rose-50 text-rose-800 border border-rose-200"}`,children:[y.type==="error"&&o.jsx(Je,{size:18}),o.jsx("span",{className:"text-sm font-medium",children:y.message}),o.jsx("button",{onClick:()=>b(null),className:"ml-2",children:o.jsx(ps,{size:16})})]}),o.jsxs("button",{onClick:()=>window.location.href="/admin/organisations",className:"inline-flex items-center gap-2 text-sm text-slate-600 hover:text-slate-900 mb-4",children:[o.jsx(Tc,{size:16}),"Back to organisations"]}),o.jsxs("div",{className:"flex items-start justify-between mb-6",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-xl font-semibold text-slate-900",children:t.name}),o.jsxs("p",{className:"mt-1 text-sm text-slate-500",children:["Created ",k,"  Owner: ",S]})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("span",{className:`inline-flex items-center rounded-full border px-3 py-1 text-xs font-medium ${ee(t.status)}`,children:t.status.charAt(0).toUpperCase()+t.status.slice(1)}),t.status==="suspended"?o.jsx("button",{onClick:D,className:"inline-flex items-center rounded-lg bg-emerald-600 px-4 py-2 text-sm font-semibold text-white shadow hover:bg-emerald-700 transition",children:"Activate"}):o.jsx("button",{onClick:q,className:"inline-flex items-center rounded-lg bg-rose-600 px-4 py-2 text-sm font-semibold text-white shadow hover:bg-rose-700 transition",children:"Suspend"})]})]}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[o.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[o.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white shadow-[0_4px_14px_rgba(15,23,42,0.06)] p-4",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsx("h2",{className:"text-sm font-semibold text-slate-900",children:"Plan & seats"}),m?null:o.jsx("button",{onClick:()=>x(!0),className:"text-xs font-medium text-[#0A66C2] hover:underline",children:"Edit"})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Plan"}),o.jsxs("select",{value:p,onChange:G=>g(G.target.value),disabled:!m,className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-[#0A66C2] focus:border-[#0A66C2] disabled:bg-slate-50 disabled:text-slate-500",children:[o.jsx("option",{value:"Trial",children:"Trial (14 days)"}),o.jsx("option",{value:"Starter",children:"Starter"}),o.jsx("option",{value:"Pro",children:"Pro"}),o.jsx("option",{value:"Enterprise",children:"Enterprise"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Seat limit"}),o.jsx("input",{type:"number",value:w,onChange:G=>v(parseInt(G.target.value)||0),disabled:!m,className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-[#0A66C2] focus:border-[#0A66C2] disabled:bg-slate-50 disabled:text-slate-500"}),o.jsxs("p",{className:"mt-1 text-xs text-slate-500",children:["Currently using ",Y," seats. Owners, admins, and members use a seat. Viewers are free."]}),w<Y&&o.jsxs("p",{className:"mt-1 text-xs text-rose-600",children:["Warning: This organisation uses ",Y," seats. Reducing to ",w," will place them over their limit."]})]}),m&&o.jsxs("div",{className:"flex items-center gap-3 pt-2",children:[o.jsx("button",{onClick:M,disabled:f,className:"px-4 py-2 rounded-lg bg-[#0A66C2] text-sm font-semibold text-white hover:bg-[#0952A0] disabled:opacity-50 transition",children:f?"Saving...":"Save changes"}),o.jsx("button",{onClick:()=>{x(!1),v(t.seat_limit),g((s==null?void 0:s.plan_name)||"Trial")},className:"px-4 py-2 text-sm font-medium text-slate-700 hover:text-slate-900",children:"Cancel"})]})]})]}),o.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white shadow-[0_4px_14px_rgba(15,23,42,0.06)] p-4",children:[o.jsx("h2",{className:"text-sm font-semibold text-slate-900 mb-3",children:"Members"}),o.jsx("p",{className:"text-xs text-slate-500 mb-4",children:"Overview of all members in this organisation. Seat-consuming roles are highlighted."}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full table-auto text-left text-sm",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"border-b border-slate-100",children:[o.jsx("th",{className:"px-2 py-2 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Member"}),o.jsx("th",{className:"px-2 py-2 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Email"}),o.jsx("th",{className:"px-2 py-2 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Role"}),o.jsx("th",{className:"px-2 py-2 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Status"}),o.jsx("th",{className:"px-2 py-2 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Last active"})]})}),o.jsx("tbody",{children:a.map(G=>o.jsxs("tr",{className:"border-b border-slate-50",children:[o.jsx("td",{className:"px-2 py-2 text-sm text-slate-900",children:G.full_name||G.email.split("@")[0]}),o.jsx("td",{className:"px-2 py-2 text-sm text-slate-600",children:G.email}),o.jsx("td",{className:"px-2 py-2",children:o.jsx("span",{className:`inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium ${["owner","admin","member"].includes(G.role)?"bg-blue-50 text-blue-700":"bg-slate-50 text-slate-700"}`,children:G.role.charAt(0).toUpperCase()+G.role.slice(1)})}),o.jsx("td",{className:"px-2 py-2",children:o.jsx("span",{className:`inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium ${G.status==="active"?"bg-emerald-50 text-emerald-700":G.status==="invited"?"bg-slate-50 text-slate-700":"bg-rose-50 text-rose-700"}`,children:G.status.charAt(0).toUpperCase()+G.status.slice(1)})}),o.jsx("td",{className:"px-2 py-2 text-sm text-slate-600",children:G.activated_at?W(G.activated_at):"Never"})]},G.id))})]})})]}),o.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white shadow-[0_4px_14px_rgba(15,23,42,0.06)] p-4",children:[o.jsx("h2",{className:"text-sm font-semibold text-slate-900 mb-4",children:"Projects"}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full table-auto text-left text-sm",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"border-b border-slate-100",children:[o.jsx("th",{className:"px-2 py-2 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Project"}),o.jsx("th",{className:"px-2 py-2 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Status"}),o.jsx("th",{className:"px-2 py-2 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Last updated"}),o.jsx("th",{className:"px-2 py-2 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Quotes"}),o.jsx("th",{className:"px-2 py-2 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Owner"})]})}),o.jsx("tbody",{children:l.length===0?o.jsx("tr",{children:o.jsx("td",{colSpan:5,className:"px-2 py-4 text-center text-sm text-slate-500",children:"No projects yet"})}):l.map(G=>o.jsxs("tr",{className:"border-b border-slate-50",children:[o.jsx("td",{className:"px-2 py-2 font-medium text-sm text-slate-900",children:G.name}),o.jsx("td",{className:"px-2 py-2",children:o.jsx("span",{className:`inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium ${G.status==="active"?"bg-emerald-50 text-emerald-700":"bg-slate-50 text-slate-700"}`,children:G.status.charAt(0).toUpperCase()+G.status.slice(1)})}),o.jsx("td",{className:"px-2 py-2 text-sm text-slate-600",children:W(G.updated_at)}),o.jsx("td",{className:"px-2 py-2 text-sm text-slate-800",children:G.quote_count}),o.jsx("td",{className:"px-2 py-2 text-sm text-slate-600",children:G.owner_email||""})]},G.id))})]})})]})]}),o.jsx("div",{children:o.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white shadow-[0_4px_14px_rgba(15,23,42,0.06)] p-4",children:[o.jsx("h2",{className:"text-sm font-semibold text-slate-900 mb-3",children:"Quick actions"}),o.jsx("div",{className:"space-y-2",children:o.jsx("button",{onClick:()=>navigator.clipboard.writeText(e),className:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-slate-50 rounded-lg transition",children:"Copy organisation ID"})})]})})]})]}):o.jsx("div",{className:"px-6 py-6 max-w-7xl mx-auto",children:o.jsx("div",{className:"text-center py-12 text-slate-500",children:"Organisation not found"})})}function XV(){const[e,t]=j.useState(""),[r,s]=j.useState("Trial"),[n,a]=j.useState(5),[i,l]=j.useState(""),[c,u]=j.useState(""),[d,f]=j.useState(!1),[h,m]=j.useState(null),x=async()=>{if(!e||!i){m({type:"error",message:"Please fill in all required fields"});return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(i)){m({type:"error",message:"Please enter a valid email address"});return}f(!0);try{const{data:{user:p}}=await ie.auth.getUser(),{data:g,error:w}=await ie.from("organisations").insert({name:e,status:r==="Trial"?"trial":"active",seat_limit:n,created_by_user_id:p==null?void 0:p.id}).select().single();if(w)throw w;const{error:v}=await ie.from("subscriptions").insert({organisation_id:g.id,plan_name:r,seat_limit:n,billing_status:"active"});if(v)throw v;let y="";const{data:b}=await ie.from("profiles").select("id").eq("email",i).maybeSingle();if(b)y=b.id;else{const _=Math.random().toString(36).slice(-12),{data:k,error:E}=await ie.auth.admin.createUser({email:i,password:_,email_confirm:!1});if(E)throw E;y=k.user.id}const{error:S}=await ie.from("organisation_members").insert({organisation_id:g.id,user_id:y,role:"owner",status:"invited",invited_by_user_id:p==null?void 0:p.id});if(S)throw S;window.location.href=`/admin/organisations/${g.id}`}catch(p){console.error("Error creating organisation:",p),m({type:"error",message:p.message||"Failed to create organisation"}),f(!1)}};return o.jsxs("div",{className:"px-6 py-6 max-w-3xl mx-auto",children:[h&&o.jsxs("div",{className:`fixed top-4 right-4 z-50 rounded-lg px-4 py-3 shadow-lg flex items-center gap-3 ${h.type==="success"?"bg-emerald-50 text-emerald-800 border border-emerald-200":"bg-rose-50 text-rose-800 border border-rose-200"}`,children:[h.type==="error"&&o.jsx(Je,{size:18}),o.jsx("span",{className:"text-sm font-medium",children:h.message}),o.jsx("button",{onClick:()=>m(null),className:"ml-2",children:o.jsx(ps,{size:16})})]}),o.jsxs("button",{onClick:()=>window.location.href="/admin/organisations",className:"inline-flex items-center gap-2 text-sm text-slate-600 hover:text-slate-900 mb-6",children:[o.jsx(Tc,{size:16}),"Back to organisations"]}),o.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white shadow-[0_4px_14px_rgba(15,23,42,0.06)] p-6",children:[o.jsx("h1",{className:"text-xl font-semibold text-slate-900 mb-2",children:"Create organisation"}),o.jsx("p",{className:"text-sm text-slate-500 mb-6",children:"Set up a new organisation with a primary owner who will receive an invite email."}),o.jsxs("div",{className:"space-y-5",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Organisation name ",o.jsx("span",{className:"text-rose-600",children:"*"})]}),o.jsx("input",{type:"text",placeholder:"Optimal Fire",value:e,onChange:p=>t(p.target.value),className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-[#0A66C2] focus:border-[#0A66C2] bg-white text-gray-900"})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Plan ",o.jsx("span",{className:"text-rose-600",children:"*"})]}),o.jsxs("select",{value:r,onChange:p=>s(p.target.value),className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-[#0A66C2] focus:border-[#0A66C2]",children:[o.jsx("option",{value:"Trial",children:"Trial (14 days)"}),o.jsx("option",{value:"Starter",children:"Starter"}),o.jsx("option",{value:"Pro",children:"Pro"}),o.jsx("option",{value:"Enterprise",children:"Enterprise"})]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Seat limit ",o.jsx("span",{className:"text-rose-600",children:"*"})]}),o.jsx("input",{type:"number",value:n,onChange:p=>a(parseInt(p.target.value)||0),min:"1",className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-[#0A66C2] focus:border-[#0A66C2] bg-white text-gray-900"}),o.jsx("p",{className:"mt-1 text-xs text-slate-500",children:"Owners, admins, and members use a seat. Viewers are free."})]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Primary owner email ",o.jsx("span",{className:"text-rose-600",children:"*"})]}),o.jsx("input",{type:"email",placeholder:"owner@company.com",value:i,onChange:p=>l(p.target.value),className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-[#0A66C2] focus:border-[#0A66C2] bg-white text-gray-900"}),o.jsx("p",{className:"mt-1 text-xs text-slate-500",children:"We'll send an invite to this email. They'll become the Organisation Owner."})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Internal notes"}),o.jsx("textarea",{placeholder:"Optional admin-only notes about this organisation...",value:c,onChange:p=>u(p.target.value),rows:3,className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-[#0A66C2] focus:border-[#0A66C2] resize-none"})]})]}),o.jsxs("div",{className:"mt-6 flex items-center justify-end gap-3 pt-4 border-t border-slate-200",children:[o.jsx("button",{onClick:()=>window.location.href="/admin/organisations",className:"px-4 py-2 text-sm font-medium text-slate-700 hover:text-slate-900",disabled:d,children:"Cancel"}),o.jsx("button",{onClick:x,disabled:d||!e||!i,className:"px-4 py-2 rounded-lg bg-[#0A66C2] text-sm font-semibold text-white hover:bg-[#0952A0] disabled:opacity-50 disabled:cursor-not-allowed transition",children:d?"Creating...":"Create organisation"})]})]})]})}function QV({organisationId:e,organisationName:t,currentLicenses:r,subscriptionStatus:s,onClose:n,onUpdate:a}){const[i,l]=j.useState(r),[c,u]=j.useState(!1),[d,f]=j.useState(null),h=async v=>{u(!0),f(null);try{const y=await pR(e,v);l(y.licensedTrades),f({type:"success",text:y.message}),setTimeout(()=>a(),1e3)}catch(y){console.error("Failed to add license:",y),f({type:"error",text:"Failed to add trade license"})}finally{u(!1)}},m=async v=>{if(i.length===1){f({type:"error",text:"Cannot remove last trade license"});return}u(!0),f(null);try{const y=await xR(e,v);l(y.licensedTrades),f({type:"success",text:y.message}),setTimeout(()=>a(),1e3)}catch(y){console.error("Failed to remove license:",y),f({type:"error",text:"Failed to remove trade license"})}finally{u(!1)}},p=(()=>{const v=i.reduce((y,b)=>{const S=Hs.find(_=>_.value===b);return y+((S==null?void 0:S.price)||0)},0);return i.length===2?v*.85:i.length===3?v*.75:i.length>=4?v*.65:v})(),g=i.reduce((v,y)=>{const b=Hs.find(S=>S.value===y);return v+((b==null?void 0:b.price)||0)},0),w=g-p;return o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-3xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[o.jsxs("div",{className:"p-6 border-b border-gray-200 flex items-center justify-between sticky top-0 bg-white",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Manage Trade Licenses"}),o.jsx("p",{className:"text-gray-600 mt-1",children:t})]}),o.jsx("button",{onClick:n,className:"p-2 text-gray-400 hover:text-gray-600 transition-colors",children:o.jsx(ps,{size:24})})]}),d&&o.jsx("div",{className:`mx-6 mt-4 p-4 rounded-md ${d.type==="success"?"bg-green-50 text-green-800":"bg-red-50 text-red-800"}`,children:d.text}),o.jsxs("div",{className:"p-6 space-y-6",children:[s==="trial"&&o.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[o.jsx("div",{className:"font-semibold text-blue-900 mb-1",children:"Trial Mode"}),o.jsx("div",{className:"text-sm text-blue-800",children:"This client is on trial and can access all trades. Licenses will be enforced when they convert to paid."})]}),o.jsxs("div",{children:[o.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Current Licensed Trades"}),o.jsx("div",{className:"space-y-2",children:i.length===0?o.jsx("div",{className:"text-gray-500 text-sm",children:"No trade licenses active"}):i.map(v=>{const y=Hs.find(b=>b.value===v);return y?o.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:`w-3 h-3 rounded-full bg-${y.color}-500`}),o.jsxs("div",{children:[o.jsx("div",{className:"font-medium text-gray-900",children:y.label}),o.jsxs("div",{className:"text-sm text-gray-600",children:["$",y.price,"/month"]})]})]}),o.jsx("button",{onClick:()=>m(v),disabled:c||i.length===1,className:"p-2 text-red-600 hover:bg-red-50 rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:i.length===1?"Cannot remove last license":"Remove license",children:o.jsx(tc,{size:16})})]},v):null})})]}),o.jsxs("div",{children:[o.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Available Trades to Add"}),o.jsx("div",{className:"grid grid-cols-2 gap-3",children:Hs.filter(v=>!i.includes(v.value)).map(v=>o.jsxs("button",{onClick:()=>h(v.value),disabled:c,className:"flex items-center gap-3 p-4 border-2 border-gray-200 rounded-lg hover:border-blue-500 hover:bg-blue-50 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:[o.jsx("div",{className:`w-4 h-4 rounded-full bg-${v.color}-500`}),o.jsxs("div",{className:"text-left flex-1",children:[o.jsx("div",{className:"font-medium text-gray-900",children:v.label}),o.jsxs("div",{className:"text-sm text-gray-600",children:["$",v.price,"/month"]})]}),o.jsx(l0,{size:20,className:"text-gray-400"})]},v.value))}),Hs.filter(v=>!i.includes(v.value)).length===0&&o.jsxs("div",{className:"text-center p-8 bg-green-50 rounded-lg",children:[o.jsx(dx,{size:48,className:"mx-auto mb-2 text-green-600"}),o.jsx("div",{className:"font-semibold text-green-900",children:"All Trades Licensed!"}),o.jsx("div",{className:"text-sm text-green-700 mt-1",children:"This client has access to every trade"})]})]}),o.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-blue-100 border border-blue-200 rounded-lg p-6",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[o.jsx(ES,{className:"text-blue-600",size:24}),o.jsx("h3",{className:"font-bold text-blue-900",children:"Revenue Calculation"})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex justify-between text-sm",children:[o.jsxs("span",{className:"text-blue-800",children:["Base Price (",i.length," trades):"]}),o.jsxs("span",{className:"font-medium text-blue-900",children:["$",g,"/month"]})]}),i.length>=2&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex justify-between text-sm",children:[o.jsxs("span",{className:"text-blue-800",children:["Bundle Discount (",i.length===2&&"15%",i.length===3&&"25%",i.length>=4&&"35%","):"]}),o.jsxs("span",{className:"font-medium text-green-600",children:["-$",w.toFixed(0)]})]}),o.jsx("div",{className:"h-px bg-blue-300 my-2"})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"font-bold text-blue-900",children:"Monthly Revenue:"}),o.jsxs("span",{className:"text-2xl font-bold text-blue-900",children:["$",p.toFixed(0)]})]}),o.jsxs("div",{className:"text-xs text-blue-700 mt-2",children:[i.length===1&&"Add another trade for 15% bundle discount",i.length===2&&"Add one more trade for 25% bundle discount (10% more savings)",i.length===3&&"Add all trades for 35% bundle discount",i.length>=4&&"Maximum bundle discount applied!"]})]})]}),o.jsx("div",{className:"flex gap-3",children:o.jsx("button",{onClick:n,className:"flex-1 px-6 py-3 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 font-medium",children:"Close"})})]})]})})}function Pw(){const[e,t]=j.useState([]),[r,s]=j.useState(!0),[n,a]=j.useState("all"),[i,l]=j.useState(""),[c,u]=j.useState(null),[d,f]=j.useState(null);j.useEffect(()=>{h()},[]);const h=async()=>{s(!0);try{const b=await oR();t(b)}catch(b){console.error("Failed to load organisations:",b),u({type:"error",text:"Failed to load organisations"})}finally{s(!1)}},m=async(b,S)=>{try{await cR(b,S),u({type:"success",text:`Trial extended by ${S} days`}),await h()}catch(_){console.error("Failed to extend trial:",_),u({type:"error",text:"Failed to extend trial"})}},x=async(b,S)=>{try{await uR(b,S),u({type:"success",text:`Status updated to ${S}`}),await h()}catch(_){console.error("Failed to update status:",_),u({type:"error",text:"Failed to update status"})}},p=async b=>{try{await dR(b.id)}catch(S){console.error("Failed to impersonate:",S),u({type:"error",text:"Failed to enter client mode"})}},g=b=>{if(!b)return null;const S=new Date(b),_=new Date,k=S.getTime()-_.getTime();return Math.ceil(k/(1e3*60*60*24))},w=b=>{switch(b){case"trial":return"bg-blue-100 text-blue-800";case"active":return"bg-green-100 text-green-800";case"expired":return"bg-red-100 text-red-800";case"suspended":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},v=e.filter(b=>!(n!=="all"&&b.subscription_status!==n||i&&!b.name.toLowerCase().includes(i.toLowerCase()))),y={total:e.length,trial:e.filter(b=>b.subscription_status==="trial").length,active:e.filter(b=>b.subscription_status==="active").length,expired:e.filter(b=>b.subscription_status==="expired").length,totalQuotes:e.reduce((b,S)=>b+S.quote_count,0)};return r?o.jsx("div",{className:"flex items-center justify-center h-64",children:o.jsx("div",{className:"text-gray-500",children:"Loading clients..."})}):o.jsxs("div",{className:"space-y-6",children:[o.jsx(ua,{title:"Super Admin Dashboard",subtitle:"God-mode control over all clients and trades"}),c&&o.jsx("div",{className:`p-4 rounded-md ${c.type==="success"?"bg-green-50 text-green-800":"bg-red-50 text-red-800"}`,children:c.text}),o.jsxs("div",{className:"grid grid-cols-5 gap-4",children:[o.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(PS,{className:"text-gray-600",size:24}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm text-gray-600",children:"Total Clients"}),o.jsx("div",{className:"text-2xl font-bold text-gray-900",children:y.total})]})]})}),o.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-blue-200 p-4",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(o0,{className:"text-blue-600",size:24}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm text-blue-600",children:"On Trial"}),o.jsx("div",{className:"text-2xl font-bold text-blue-600",children:y.trial})]})]})}),o.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-green-200 p-4",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(Yt,{className:"text-green-600",size:24}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm text-green-600",children:"Active Paid"}),o.jsx("div",{className:"text-2xl font-bold text-green-600",children:y.active})]})]})}),o.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-red-200 p-4",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(to,{className:"text-red-600",size:24}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm text-red-600",children:"Expired"}),o.jsx("div",{className:"text-2xl font-bold text-red-600",children:y.expired})]})]})}),o.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(Tr,{className:"text-gray-600",size:24}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm text-gray-600",children:"Total Quotes"}),o.jsx("div",{className:"text-2xl font-bold text-gray-900",children:y.totalQuotes})]})]})})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[o.jsx("div",{className:"p-4 border-b border-gray-200",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex gap-2",children:[o.jsxs("button",{onClick:()=>a("all"),className:`px-4 py-2 rounded-md font-medium transition-colors ${n==="all"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["All (",y.total,")"]}),o.jsxs("button",{onClick:()=>a("trial"),className:`px-4 py-2 rounded-md font-medium transition-colors ${n==="trial"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["Trial (",y.trial,")"]}),o.jsxs("button",{onClick:()=>a("active"),className:`px-4 py-2 rounded-md font-medium transition-colors ${n==="active"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["Active (",y.active,")"]}),o.jsxs("button",{onClick:()=>a("expired"),className:`px-4 py-2 rounded-md font-medium transition-colors ${n==="expired"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["Expired (",y.expired,")"]})]}),o.jsxs("div",{className:"flex gap-3",children:[o.jsx("input",{type:"text",placeholder:"Search clients...",value:i,onChange:b=>l(b.target.value),className:"px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),o.jsxs("button",{onClick:()=>window.location.href="/admin/clients/new",className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 font-medium",children:[o.jsx(l0,{size:18}),"New Client"]})]})]})}),o.jsxs("div",{className:"overflow-x-auto",children:[o.jsxs("table",{className:"w-full",children:[o.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase",children:"Client"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase",children:"Licensed Trades"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase",children:"Status"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase",children:"Trial End"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase",children:"Quotes"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase",children:"Last Active"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase",children:"Actions"})]})}),o.jsx("tbody",{className:"divide-y divide-gray-200",children:v.map(b=>{const S=g(b.trial_end_date);return o.jsxs("tr",{className:"hover:bg-gray-50",children:[o.jsx("td",{className:"px-4 py-3",children:o.jsxs("div",{children:[o.jsx("div",{className:"font-medium text-gray-900",children:b.name}),o.jsx("div",{className:"text-sm text-gray-500",children:b.owner_email||"No owner"})]})}),o.jsxs("td",{className:"px-4 py-3",children:[o.jsx("div",{className:"flex flex-wrap gap-1",children:b.licensed_trades&&b.licensed_trades.length>0?b.licensed_trades.map(_=>{var k;return o.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-medium rounded bg-blue-100 text-blue-800",children:((k=Sx[_])==null?void 0:k.replace(" Verify+",""))||_},_)}):o.jsx("span",{className:"text-xs text-gray-400",children:"No trades"})}),o.jsx("button",{onClick:()=>f(b),className:"text-xs text-blue-600 hover:text-blue-800 mt-1",children:"Manage Licenses"})]}),o.jsx("td",{className:"px-4 py-3",children:o.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded ${w(b.subscription_status)}`,children:b.subscription_status})}),o.jsx("td",{className:"px-4 py-3",children:b.trial_end_date?o.jsxs("div",{children:[o.jsx("div",{className:"text-sm text-gray-900",children:new Date(b.trial_end_date).toLocaleDateString()}),S!==null&&o.jsx("div",{className:`text-xs ${S<0?"text-red-600":S<3?"text-orange-600":"text-gray-500"}`,children:S<0?`${Math.abs(S)} days ago`:`${S} days left`})]}):o.jsx("span",{className:"text-sm text-gray-400",children:"N/A"})}),o.jsx("td",{className:"px-4 py-3",children:o.jsx("span",{className:"text-sm font-medium text-gray-900",children:b.quote_count})}),o.jsx("td",{className:"px-4 py-3",children:b.last_active_at?o.jsx("span",{className:"text-sm text-gray-600",children:new Date(b.last_active_at).toLocaleDateString()}):o.jsx("span",{className:"text-sm text-gray-400",children:"Never"})}),o.jsx("td",{className:"px-4 py-3",children:o.jsxs("div",{className:"flex gap-2",children:[o.jsx("button",{onClick:()=>p(b),className:"p-1.5 text-blue-600 hover:bg-blue-50 rounded transition-colors",title:"Enter as Client",children:o.jsx(_F,{size:16})}),o.jsx("button",{onClick:()=>m(b.id,30),className:"p-1.5 text-green-600 hover:bg-green-50 rounded transition-colors",title:"Extend Trial +30 days",children:o.jsx(kS,{size:16})}),b.subscription_status==="trial"&&o.jsx("button",{onClick:()=>x(b.id,"active"),className:"p-1.5 text-green-600 hover:bg-green-50 rounded transition-colors",title:"Upgrade to Active",children:o.jsx(Ao,{size:16})})]})})]},b.id)})})]}),v.length===0&&o.jsx("div",{className:"p-12 text-center text-gray-500",children:"No clients found matching your filters"})]})]}),d&&o.jsx(QV,{organisationId:d.id,organisationName:d.name,currentLicenses:d.licensed_trades||[],subscriptionStatus:d.subscription_status,onClose:()=>f(null),onUpdate:()=>{h(),u({type:"success",text:"Trade licenses updated"})}})]})}function YV(){const[e,t]=j.useState({name:"",selectedTrades:["passive_fire"],trialDays:14,ownerEmail:""}),[r,s]=j.useState(!1),[n,a]=j.useState(null),[i,l]=j.useState(null),c=x=>{const p=x.reduce((g,w)=>{const v=Hs.find(y=>y.value===w);return g+((v==null?void 0:v.price)||0)},0);return x.length===2?p*.85:x.length===3?p*.75:x.length>=4?p*.65:p},u=x=>{if(e.selectedTrades.includes(x)){if(e.selectedTrades.length===1)return;t({...e,selectedTrades:e.selectedTrades.filter(p=>p!==x)})}else t({...e,selectedTrades:[...e.selectedTrades,x]})},d=async x=>{x.preventDefault(),s(!0),l(null);try{const{data:{session:p}}=await ie.auth.getSession();if(!(p!=null&&p.user.email))throw new Error("Not authenticated");const{data:g,error:w}=await ie.rpc("admin_create_client_organisation",{p_admin_email:p.user.email,p_org_name:e.name,p_trade_type:e.selectedTrades[0],p_trial_days:e.trialDays,p_owner_email:e.ownerEmail});if(w)throw w;const v=g.organisation_id,{error:y}=await ie.from("organisations").update({licensed_trades:e.selectedTrades}).eq("id",v);if(y)throw y;a({organisationId:v,message:g.message})}catch(p){console.error("Failed to create organisation:",p),l(p instanceof Error?p.message:"Failed to create client")}finally{s(!1)}},f=c(e.selectedTrades),h=e.selectedTrades.reduce((x,p)=>{const g=Hs.find(w=>w.value===p);return x+((g==null?void 0:g.price)||0)},0),m=h-f;return n?o.jsxs("div",{className:"space-y-6",children:[o.jsx(ua,{title:"Client Created Successfully",subtitle:"The new client organisation is ready"}),o.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-8 max-w-2xl mx-auto",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"mx-auto w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mb-4",children:o.jsx(Yt,{size:32,className:"text-green-600"})}),o.jsxs("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:[e.name," Created!"]}),o.jsx("p",{className:"text-gray-600 mb-6",children:n.message}),o.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 text-left space-y-2 mb-6",children:[o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-gray-600",children:"Organisation ID:"}),o.jsx("span",{className:"font-mono text-sm text-gray-900",children:n.organisationId})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-gray-600",children:"Owner Email:"}),o.jsx("span",{className:"font-medium text-gray-900",children:e.ownerEmail})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-gray-600",children:"Licensed Trades:"}),o.jsx("div",{className:"flex flex-wrap gap-1 justify-end",children:e.selectedTrades.map(x=>{var p;return o.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs font-medium rounded",children:(p=Sx[x])==null?void 0:p.replace(" Verify+","")},x)})})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-gray-600",children:"Monthly Revenue:"}),o.jsxs("span",{className:"text-lg font-bold text-green-600",children:["$",f.toFixed(0)]})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-gray-600",children:"Trial Length:"}),o.jsxs("span",{className:"font-medium text-gray-900",children:[e.trialDays," days"]})]})]}),o.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 text-left mb-6",children:[o.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"Next Steps:"}),o.jsxs("ol",{className:"list-decimal list-inside space-y-1 text-sm text-blue-800",children:[o.jsxs("li",{children:["Owner must sign up at the app using: ",o.jsx("strong",{children:e.ownerEmail})]}),o.jsx("li",{children:"They'll be automatically added to this organisation"}),o.jsxs("li",{children:["During trial: All ",e.selectedTrades.length," trades are accessible"]}),o.jsxs("li",{children:["After trial: Pay $",f.toFixed(0),"/month to keep licenses active"]})]})]}),o.jsxs("div",{className:"flex gap-3",children:[o.jsx("button",{onClick:()=>window.location.href="/admin/dashboard",className:"flex-1 px-6 py-3 bg-blue-600 text-white rounded-md hover:bg-blue-700 font-medium",children:"Back to Dashboard"}),o.jsx("button",{onClick:()=>{a(null),t({name:"",selectedTrades:["passive_fire"],trialDays:14,ownerEmail:""})},className:"flex-1 px-6 py-3 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 font-medium",children:"Create Another Client"})]})]})})]}):o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsx("button",{onClick:()=>window.location.href="/admin/dashboard",className:"p-2 text-gray-600 hover:bg-gray-100 rounded transition-colors",children:o.jsx(Tc,{size:20})}),o.jsx(ua,{title:"Create New Client",subtitle:"Set up a new organisation with multi-trade licensing in under 15 seconds"})]}),i&&o.jsx("div",{className:"bg-red-50 border border-red-200 text-red-800 rounded-lg p-4",children:i}),o.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 max-w-3xl",children:o.jsxs("form",{onSubmit:d,className:"space-y-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Company Name *"}),o.jsx("input",{type:"text",required:!0,value:e.name,onChange:x=>t({...e,name:x.target.value}),placeholder:"e.g., Acme Fire Protection Ltd",className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:["Licensed Trades * ",o.jsx("span",{className:"text-gray-500 font-normal",children:"(select all that apply)"})]}),o.jsx("div",{className:"grid grid-cols-2 gap-3",children:Hs.map(x=>{const p=e.selectedTrades.includes(x.value);return o.jsxs("button",{type:"button",onClick:()=>u(x.value),disabled:p&&e.selectedTrades.length===1,className:`p-4 border-2 rounded-lg text-left transition-all ${p?"border-blue-500 bg-blue-50 ring-2 ring-blue-200":"border-gray-200 hover:border-blue-300"} ${p&&e.selectedTrades.length===1?"opacity-50 cursor-not-allowed":""}`,children:[o.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[o.jsx("div",{className:`w-4 h-4 rounded-full ${x.color==="orange"?"bg-orange-500":x.color==="yellow"?"bg-yellow-500":x.color==="blue"?"bg-blue-500":"bg-green-500"}`}),o.jsx("div",{className:"font-medium text-gray-900",children:x.label}),p&&o.jsx(Yt,{size:16,className:"ml-auto text-blue-600"})]}),o.jsxs("div",{className:"text-sm text-gray-600",children:["$",x.price,"/month"]})]},x.value)})}),o.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"Client can access all selected trades during trial. After trial, they pay for what they keep."})]}),o.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-green-100 border border-green-200 rounded-lg p-5",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[o.jsx(ES,{className:"text-green-600",size:24}),o.jsx("h3",{className:"font-bold text-green-900",children:"Revenue Calculator"})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex justify-between text-sm",children:[o.jsxs("span",{className:"text-green-800",children:["Base Price (",e.selectedTrades.length," trades):"]}),o.jsxs("span",{className:"font-medium text-green-900",children:["$",h,"/month"]})]}),e.selectedTrades.length>=2&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex justify-between text-sm",children:[o.jsxs("span",{className:"text-green-800",children:["Bundle Discount (",e.selectedTrades.length===2&&"15%",e.selectedTrades.length===3&&"25%",e.selectedTrades.length>=4&&"35%","):"]}),o.jsxs("span",{className:"font-medium text-green-600",children:["-$",m.toFixed(0)]})]}),o.jsx("div",{className:"h-px bg-green-300 my-2"})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"font-bold text-green-900",children:"Monthly Revenue:"}),o.jsxs("span",{className:"text-2xl font-bold text-green-900",children:["$",f.toFixed(0)]})]}),o.jsxs("div",{className:"text-xs text-green-700 mt-2",children:[e.selectedTrades.length===1&&"Select another trade for 15% bundle discount",e.selectedTrades.length===2&&"Select one more trade for 25% bundle discount (10% more savings)",e.selectedTrades.length===3&&"Select all trades for 35% bundle discount",e.selectedTrades.length>=4&&"Maximum bundle discount applied!"]})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Trial Length *"}),o.jsx("div",{className:"grid grid-cols-4 gap-2",children:[7,14,30,60].map(x=>o.jsxs("button",{type:"button",onClick:()=>t({...e,trialDays:x}),className:`px-4 py-2 rounded-md font-medium transition-colors ${e.trialDays===x?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[x," days"]},x))})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Owner Email *"}),o.jsx("input",{type:"email",required:!0,value:e.ownerEmail,onChange:x=>t({...e,ownerEmail:x.target.value}),placeholder:"owner@company.com",className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),o.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"They'll need to sign up with this email to access the organisation"})]}),o.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[o.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"What happens next:"}),o.jsxs("ul",{className:"list-disc list-inside space-y-1 text-sm text-blue-800",children:[o.jsxs("li",{children:["Organisation created with ",e.selectedTrades.length," licensed trade",e.selectedTrades.length>1?"s":""]}),o.jsx("li",{children:"Default project set up for primary trade"}),o.jsxs("li",{children:["Owner can sign up and access all ",e.selectedTrades.length," trades during trial"]}),o.jsxs("li",{children:["After trial: $",f.toFixed(0),"/month to keep licenses active"]})]})]}),o.jsxs("div",{className:"flex gap-3 pt-4",children:[o.jsx("button",{type:"button",onClick:()=>window.location.href="/admin/dashboard",className:"flex-1 px-6 py-3 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 font-medium",children:"Cancel"}),o.jsx("button",{type:"submit",disabled:r,className:"flex-1 px-6 py-3 bg-green-600 text-white rounded-md hover:bg-green-700 font-medium disabled:bg-gray-400 disabled:cursor-not-allowed",children:r?"Creating...":`Create Client ($${f.toFixed(0)}/mo)`})]})]})})]})}function JV(){const[e,t]=j.useState([]),[r,s]=j.useState(!0),[n,a]=j.useState(""),[i,l]=j.useState("all"),[c,u]=j.useState("all"),[d,f]=j.useState([]);j.useEffect(()=>{h()},[]);const h=async()=>{s(!0);try{const[g,w]=await Promise.all([lR(),ie.from("organisations").select("id, name").order("name")]);t(g),f(w.data||[])}catch(g){console.error("Failed to load data:",g)}finally{s(!1)}},m=async g=>{try{const w=g.supplier_name?`${g.organisation_id}/${g.supplier_name.replace(/\s+/g,"_")}_${g.quote_id}.pdf`:`${g.organisation_id}/quote_${g.quote_id}.pdf`,{data:v,error:y}=await ie.storage.from("quotes").createSignedUrl(w,3600);if(y)throw y;v!=null&&v.signedUrl&&window.open(v.signedUrl,"_blank")}catch(w){console.error("Failed to download:",w),alert("Failed to download PDF. It may have been deleted or moved.")}},x=e.filter(g=>!(n&&!g.supplier_name.toLowerCase().includes(n.toLowerCase())&&!g.organisation_name.toLowerCase().includes(n.toLowerCase())||i!=="all"&&g.trade_type!==i||c!=="all"&&g.organisation_id!==c)),p={total:e.length,totalSize:e.reduce((g,w)=>g+(w.items_count||0),0),avgConfidence:e.length>0?(e.reduce((g,w)=>g+(w.avg_confidence||0),0)/e.length*100).toFixed(1):"0"};return r?o.jsx("div",{className:"flex items-center justify-center h-64",children:o.jsx("div",{className:"text-gray-500",children:"Loading PDF vault..."})}):o.jsxs("div",{className:"space-y-6",children:[o.jsx(ua,{title:"Global PDF Vault",subtitle:"Every PDF ever uploaded by any client, searchable and downloadable"}),o.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[o.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(Tr,{className:"text-gray-600",size:24}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm text-gray-600",children:"Total PDFs"}),o.jsx("div",{className:"text-2xl font-bold text-gray-900",children:p.total})]})]})}),o.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(Tr,{className:"text-gray-600",size:24}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm text-gray-600",children:"Total Line Items"}),o.jsx("div",{className:"text-2xl font-bold text-gray-900",children:p.totalSize.toLocaleString()})]})]})}),o.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(Tr,{className:"text-gray-600",size:24}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm text-gray-600",children:"Avg Confidence"}),o.jsxs("div",{className:"text-2xl font-bold text-gray-900",children:[p.avgConfidence,"%"]})]})]})})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[o.jsx("div",{className:"p-4 border-b border-gray-200",children:o.jsxs("div",{className:"flex gap-3",children:[o.jsxs("div",{className:"flex-1 relative",children:[o.jsx(bd,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:18}),o.jsx("input",{type:"text",placeholder:"Search by supplier or organisation...",value:n,onChange:g=>a(g.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),o.jsxs("select",{value:i,onChange:g=>l(g.target.value),className:"px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"all",children:"All Trades"}),o.jsx("option",{value:"passive_fire",children:"PassiveFire"}),o.jsx("option",{value:"electrical",children:"Electrical"}),o.jsx("option",{value:"plumbing",children:"Plumbing"}),o.jsx("option",{value:"mechanical",children:"Mechanical"})]}),o.jsxs("select",{value:c,onChange:g=>u(g.target.value),className:"px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"all",children:"All Organisations"}),d.map(g=>o.jsx("option",{value:g.id,children:g.name},g.id))]})]})}),o.jsxs("div",{className:"overflow-x-auto",children:[o.jsxs("table",{className:"w-full",children:[o.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase",children:"Supplier"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase",children:"Organisation"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase",children:"Project"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase",children:"Items"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase",children:"Total"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase",children:"Confidence"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase",children:"Uploaded"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase",children:"Actions"})]})}),o.jsx("tbody",{className:"divide-y divide-gray-200",children:x.map(g=>o.jsxs("tr",{className:"hover:bg-gray-50",children:[o.jsx("td",{className:"px-4 py-3",children:o.jsxs("div",{children:[o.jsx("div",{className:"font-medium text-gray-900",children:g.supplier_name}),g.quote_reference&&o.jsx("div",{className:"text-sm text-gray-500",children:g.quote_reference})]})}),o.jsxs("td",{className:"px-4 py-3",children:[o.jsx("div",{className:"text-sm text-gray-900",children:g.organisation_name}),o.jsxs("div",{className:"text-xs text-gray-500",children:[g.trade_type==="passive_fire"&&"PassiveFire",g.trade_type==="electrical"&&"Electrical",g.trade_type==="plumbing"&&"Plumbing"]})]}),o.jsx("td",{className:"px-4 py-3",children:o.jsx("div",{className:"text-sm text-gray-700",children:g.project_name})}),o.jsx("td",{className:"px-4 py-3",children:o.jsx("span",{className:"text-sm font-medium text-gray-900",children:g.items_count})}),o.jsx("td",{className:"px-4 py-3",children:o.jsxs("span",{className:"text-sm font-medium text-gray-900",children:["$",g.total_amount.toLocaleString()]})}),o.jsx("td",{className:"px-4 py-3",children:g.avg_confidence?o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-2 w-16",children:o.jsx("div",{className:`h-2 rounded-full ${g.avg_confidence<.5?"bg-red-600":g.avg_confidence<.75?"bg-yellow-600":"bg-green-600"}`,style:{width:`${g.avg_confidence*100}%`}})}),o.jsxs("span",{className:"text-xs text-gray-600",children:[(g.avg_confidence*100).toFixed(0),"%"]})]}):o.jsx("span",{className:"text-sm text-gray-400",children:"N/A"})}),o.jsx("td",{className:"px-4 py-3",children:o.jsxs("div",{children:[o.jsx("div",{className:"text-sm text-gray-900",children:new Date(g.created_at).toLocaleDateString()}),o.jsx("div",{className:"text-xs text-gray-500",children:g.uploaded_by_email||"Unknown"})]})}),o.jsx("td",{className:"px-4 py-3",children:o.jsx("div",{className:"flex gap-2",children:o.jsx("button",{onClick:()=>m(g),className:"p-1.5 text-blue-600 hover:bg-blue-50 rounded transition-colors",title:"Download PDF",children:o.jsx(Co,{size:16})})})})]},g.quote_id))})]}),x.length===0&&o.jsx("div",{className:"p-12 text-center text-gray-500",children:"No PDFs found matching your filters"})]})]})]})}function Rw(){const[e,t]=j.useState("dashboard"),[r,s]=j.useState(null),[n,a]=j.useState(""),[i,l]=j.useState(!1);j.useEffect(()=>{c()},[]);const c=async()=>{const{data:{session:f}}=await ie.auth.getSession();f!=null&&f.user.email&&(a(f.user.email),l(Lk(f.user.email)))};j.useEffect(()=>{const f=window.location.pathname;if(f==="/admin"||f==="/admin/")t(i?"super-dashboard":"dashboard");else if(f==="/admin/dashboard")t("super-dashboard");else if(f==="/admin/clients/new")t("create-client");else if(f==="/admin/pdfs")t("pdf-vault");else if(f==="/admin/organisations")t("organisations");else if(f==="/admin/organisations/new")t("create-organisation");else if(f.startsWith("/admin/organisations/")){const h=f.split("/").pop();h&&(s(h),t("organisation-detail"))}},[i]);const u=async()=>{await ie.auth.signOut(),window.location.href="/"},d=()=>{switch(e){case"super-dashboard":return o.jsx(Pw,{});case"create-client":return o.jsx(YV,{});case"pdf-vault":return o.jsx(JV,{});case"dashboard":return o.jsx(Fw,{});case"organisations":return o.jsx(GV,{});case"organisation-detail":return r?o.jsx(KV,{organisationId:r}):null;case"create-organisation":return o.jsx(XV,{});default:return i?o.jsx(Pw,{}):o.jsx(Fw,{})}};return o.jsxs("div",{className:"min-h-screen bg-slate-50 flex",children:[o.jsxs("div",{className:"w-64 bg-white border-r border-slate-200 flex flex-col",children:[o.jsx("div",{className:"p-6 border-b border-slate-200",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-blue-500 to-blue-600 flex items-center justify-center",children:o.jsx(go,{className:"text-white",size:20})}),o.jsxs("div",{children:[o.jsx("div",{className:"font-semibold text-slate-900",children:"Admin Console"}),o.jsx("div",{className:"text-xs text-slate-500",children:"Master Admin"})]})]})}),o.jsxs("nav",{className:"flex-1 p-4 space-y-1",children:[i&&o.jsxs(o.Fragment,{children:[o.jsxs("button",{onClick:()=>window.location.href="/admin/dashboard",className:`w-full flex items-center gap-3 px-4 py-2 rounded-lg text-sm font-medium transition ${e==="super-dashboard"?"bg-blue-50 text-blue-700":"text-slate-700 hover:bg-slate-50"}`,children:[o.jsx(PS,{size:18}),"Clients & Trials"]}),o.jsxs("button",{onClick:()=>window.location.href="/admin/pdfs",className:`w-full flex items-center gap-3 px-4 py-2 rounded-lg text-sm font-medium transition ${e==="pdf-vault"?"bg-blue-50 text-blue-700":"text-slate-700 hover:bg-slate-50"}`,children:[o.jsx(Tr,{size:18}),"PDF Vault"]}),o.jsx("div",{className:"h-px bg-slate-200 my-2"})]}),o.jsxs("button",{onClick:()=>window.location.href="/admin",className:`w-full flex items-center gap-3 px-4 py-2 rounded-lg text-sm font-medium transition ${e==="dashboard"?"bg-blue-50 text-blue-700":"text-slate-700 hover:bg-slate-50"}`,children:[o.jsx(am,{size:18}),"Dashboard"]}),o.jsxs("button",{onClick:()=>window.location.href="/admin/organisations",className:`w-full flex items-center gap-3 px-4 py-2 rounded-lg text-sm font-medium transition ${e==="organisations"||e==="organisation-detail"||e==="create-organisation"?"bg-blue-50 text-blue-700":"text-slate-700 hover:bg-slate-50"}`,children:[o.jsx(go,{size:18}),"Organisations"]})]}),o.jsxs("div",{className:"p-4 border-t border-slate-200 space-y-2",children:[o.jsxs("button",{onClick:()=>window.location.href="/",className:"w-full flex items-center gap-3 px-4 py-2 rounded-lg text-sm font-medium text-slate-700 hover:bg-slate-50 transition",children:[o.jsx(am,{size:18}),"Main App"]}),o.jsxs("button",{onClick:u,className:"w-full flex items-center gap-3 px-4 py-2 rounded-lg text-sm font-medium text-rose-600 hover:bg-rose-50 transition",children:[o.jsx(CS,{size:18}),"Logout"]})]})]}),o.jsx("div",{className:"flex-1 overflow-auto",children:d()})]})}const ZE=j.createContext(null);function ZV({children:e}){const[t,r]=j.useState(!1),[s,n]=j.useState(!0);j.useEffect(()=>{a()},[]);const a=async()=>{try{const{data:{user:i}}=await ie.auth.getUser();if(!i){r(!1),n(!1);return}const{data:l}=await ie.from("platform_admins").select("is_active").eq("user_id",i.id).eq("is_active",!0).maybeSingle();r(!!l)}catch(i){console.error("Error checking admin status:",i),r(!1)}finally{n(!1)}};return o.jsx(ZE.Provider,{value:{isMasterAdmin:t,loading:s},children:e})}function eW(){const e=j.useContext(ZE);if(!e)throw new Error("useAdmin must be used within AdminProvider");return e}function tW(){const[e,t]=j.useState(null),[r,s]=j.useState(!0),[n,a]=j.useState("dashboard"),[i,l]=j.useState(null),[c,u]=j.useState(null),[d,f]=j.useState([]),[h,m]=j.useState(!0),[x,p]=j.useState(null),[g,w]=j.useState(!1),[v,y]=j.useState(null),{currentOrganisation:b,organisations:S,loading:_,setCurrentOrganisation:k}=wa(),{isMasterAdmin:E,loading:T}=eW();j.useEffect(()=>{const fe=setTimeout(()=>{r&&(console.warn("Auth loading timeout - forcing completion"),s(!1))},5e3);ie.auth.getSession().then(({data:{session:V}})=>{t(V),s(!1),clearTimeout(fe)}).catch(V=>{console.error("Error loading session:",V),s(!1),clearTimeout(fe)});const{data:{subscription:A}}=ie.auth.onAuthStateChange((V,L)=>{(async()=>t(L))()});return()=>{A.unsubscribe(),clearTimeout(fe)}},[]),j.useEffect(()=>{!r&&e&&q()},[r,e]),j.useEffect(()=>{b&&(q(),M())},[b]);const M=async()=>{if(b)try{const{data:fe,error:A}=await ie.from("organisations").select("licensed_trades, subscription_status").eq("id",b.id).single();!A&&fe&&y({licensed_trades:fe.licensed_trades||[],subscription_status:fe.subscription_status||"trial"})}catch(fe){console.error("Failed to load org licensing:",fe)}};j.useEffect(()=>{i&&ee(i)},[i]),j.useEffect(()=>{d.length===0&&b&&Y()},[b]);const q=async()=>{m(!0),await Y();const fe=localStorage.getItem("passivefire_current_project_id");if(fe&&b){const{data:A}=await ie.from("projects").select("id, name, client, reference").eq("id",fe).eq("organisation_id",b.id).maybeSingle();A?(l(A.id),u(A)):(localStorage.removeItem("passivefire_current_project_id"),l(null),u(null))}m(!1)},D=async fe=>{l(fe),localStorage.setItem("passivefire_current_project_id",fe),await ie.from("projects").update({last_accessed_at:new Date().toISOString()}).eq("id",fe),await ee(fe)},W=async(fe,A,V)=>{if(!b||!(e!=null&&e.user))return p({message:"Must be logged in to create a project",type:"error"}),null;try{const{data:L,error:U}=await ie.from("projects").insert({organisation_id:b.id,name:fe,client:A||null,reference:V||null,status:"active",created_by_user_id:e.user.id,user_id:e.user.id}).select().single();if(U)throw U;return await Y(),p({message:`Project "${fe}" created successfully`,type:"success"}),await D(L.id),L.id}catch(L){return console.error("Error creating project:",L),p({message:"Failed to create project",type:"error"}),null}},ee=async fe=>{const{data:A}=await ie.from("projects").select("id, name, client, reference").eq("id",fe).maybeSingle();A&&u(A)},Y=async()=>{if(!b)return;const{data:fe,error:A}=await ie.from("projects").select("id, name, client, reference, updated_at, approved_quote_id").eq("organisation_id",b.id).order("updated_at",{ascending:!1});if(A){console.error("Error loading projects:",A);return}if(fe){const V=await Promise.all(fe.map(async L=>{var je,X,z,H,Z,J,K;const{data:U}=await ie.from("quotes").select("id, status").eq("project_id",L.id),ne=U&&U.length>0,xe=U&&U.every(le=>le.status==="processed"||le.status==="ready"),{data:pe}=await ie.from("quote_items").select("id, system_id, quote_id").in("quote_id",(U==null?void 0:U.map(le=>le.id))||[]),oe=pe&&pe.some(le=>le.system_id),ue=ne&&xe&&oe,{data:we}=await ie.from("award_reports").select("id, generated_at, status, result_json").eq("project_id",L.id).eq("status","ready").order("generated_at",{ascending:!1}).limit(1).maybeSingle(),P=((z=(X=(je=we==null?void 0:we.result_json)==null?void 0:je.awardSummary)==null?void 0:X.suppliers)==null?void 0:z.length)||0,Me=((K=(J=(Z=(H=we==null?void 0:we.result_json)==null?void 0:H.awardSummary)==null?void 0:Z.suppliers)==null?void 0:J[0])==null?void 0:K.coveragePercent)||0;return{id:L.id,name:L.name,client_reference:L.client||L.reference||"No client",updated_at:L.updated_at,has_report:!!we,report_id:we==null?void 0:we.id,report_generated_at:we==null?void 0:we.generated_at,report_quotes_count:P,report_coverage_percent:Math.round(Me),workflow_complete:ue}}));f(V)}},G=fe=>i?!0:(p({message:"Select or create a project first.",type:"error"}),!1),ce=(fe,A)=>{const V=A||i;switch(V&&l(V),fe){case"dashboard":a("dashboard");break;case"quotes":a("quotes");break;case"review":a("review");break;case"quoteintel":a("quoteintel");break;case"scope":a("scope");break;case"reports":case"award":a("reports");break;case"contract":case"basetracker":a("contract");break;case"insights":a("insights");break;case"settings":a("settings");break;default:a("dashboard")}},Q=()=>{switch(n){case"dashboard":return o.jsx(tn,{projectId:i,projectName:c==null?void 0:c.name,allProjects:d,onProjectSelect:D,onCreateProject:W,onNavigateToQuotes:()=>{G()&&a("quotes")},onNavigateToMatrix:()=>{G()&&a("scope")},onNavigateToReports:()=>{G()&&a("reports")}});case"quotes":return i?o.jsx(FR,{projectId:i,onQuotesImported:()=>{},onNavigateToDashboard:()=>a("dashboard"),onNavigateToNext:()=>a("review")}):o.jsx(tn,{projectId:null,projectName:void 0,allProjects:d,onProjectSelect:D,onCreateProject:W,onNavigateToQuotes:()=>{G()&&a("quotes")},onNavigateToMatrix:()=>{G()&&a("scope")},onNavigateToReports:()=>{G()&&a("reports")}});case"review":return i?o.jsx(KR,{projectId:i,onNavigateBack:()=>a("quotes"),onNavigateNext:()=>a("quoteintel")}):o.jsx(tn,{projectId:null,projectName:void 0,allProjects:d,onProjectSelect:D,onCreateProject:W,onNavigateToQuotes:()=>{G()&&a("quotes")},onNavigateToMatrix:()=>{G()&&a("scope")},onNavigateToReports:()=>{G()&&a("reports")}});case"quoteintel":return i?o.jsx(oV,{projectId:i,onNavigateBack:()=>a("review"),onNavigateNext:()=>a("scope")}):o.jsx(tn,{projectId:null,projectName:void 0,allProjects:d,onProjectSelect:D,onCreateProject:W,onNavigateToQuotes:()=>{G()&&a("quotes")},onNavigateToMatrix:()=>{G()&&a("scope")},onNavigateToReports:()=>{G()&&a("reports")}});case"scope":return i?o.jsx(hV,{projectId:i,onNavigateBack:()=>a("quoteintel"),onNavigateNext:()=>a("equalisation")}):o.jsx(tn,{projectId:null,projectName:void 0,allProjects:d,onProjectSelect:D,onCreateProject:W,onNavigateToQuotes:()=>{G()&&a("quotes")},onNavigateToMatrix:()=>{G()&&a("scope")},onNavigateToReports:()=>{G()&&a("reports")}});case"equalisation":return i?o.jsx(pV,{projectId:i,onNavigateBack:()=>a("scope"),onNavigateNext:()=>a("reports")}):o.jsx(tn,{projectId:null,projectName:void 0,allProjects:d,onProjectSelect:D,onCreateProject:W,onNavigateToQuotes:()=>{G()&&a("quotes")},onNavigateToMatrix:()=>{G()&&a("scope")},onNavigateToReports:()=>{G()&&a("reports")}});case"contract":return i?o.jsx(gV,{projectId:i}):o.jsx(tn,{projectId:null,projectName:void 0,allProjects:d,onProjectSelect:D,onCreateProject:W,onNavigateToQuotes:()=>{G()&&a("quotes")},onNavigateToMatrix:()=>{G()&&a("scope")},onNavigateToReports:()=>{G()&&a("reports")}});case"reports":return i?o.jsx(NV,{projectId:i,projects:d,onNavigateBackToScope:()=>a("scope"),onNavigateBackToDashboard:()=>a("dashboard")}):o.jsx(tn,{projectId:null,projectName:void 0,allProjects:d,onProjectSelect:D,onCreateProject:W,onNavigateToQuotes:()=>{G()&&a("quotes")},onNavigateToMatrix:()=>{G()&&a("scope")},onNavigateToReports:()=>{G()&&a("reports")}});case"insights":return i?o.jsx(EV,{projectId:i}):o.jsx(tn,{projectId:null,projectName:void 0,allProjects:d,onProjectSelect:D,onCreateProject:W,onNavigateToQuotes:()=>{G()&&a("quotes")},onNavigateToMatrix:()=>{G()&&a("scope")},onNavigateToReports:()=>{G()&&a("reports")}});case"systemcheck":return o.jsx(YE,{});case"copilotaudit":return o.jsx(JE,{});case"settings":return i?o.jsx(BV,{projectId:i,onProjectDeleted:()=>l(null)}):o.jsxs("div",{className:"p-8",children:[o.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Settings"}),o.jsx("p",{className:"text-gray-600 mb-4",children:"Select a project to configure project-specific settings, or manage organisation settings below."}),o.jsx(HV,{})]});default:return o.jsx(tn,{projectId:i,projectName:c==null?void 0:c.name,allProjects:d,onProjectSelect:D,onCreateProject:W,onNavigateToQuotes:()=>{G()&&a("quotes")},onNavigateToMatrix:()=>{G()&&a("scope")},onNavigateToReports:()=>{G()&&a("reports")}})}};if(r||_||T)return o.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),o.jsx("p",{className:"text-gray-600",children:"Loading..."})]})});if(!e)return o.jsx(qV,{});if(window.location.pathname.startsWith("/admin"))return E?o.jsx(Rw,{}):(Om.show({type:"warning",title:"Access denied",body:"The Admin Console is only accessible to platform administrators.",duration:5e3}),setTimeout(()=>{window.location.href="/"},1e3),null);if(!b&&S.length>0)return o.jsx(Aw,{onOrganisationSelected:()=>{}});if(!b)return E?o.jsx(Rw,{}):o.jsx(Aw,{onOrganisationSelected:()=>{}});if(h)return o.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),o.jsx("p",{className:"text-gray-600",children:"Loading..."})]})});const B=mR(),me=B?b:null;return o.jsxs("div",{className:"min-h-screen bg-gray-50 flex overflow-x-hidden",children:[o.jsx(wR,{activeTab:n,onTabChange:a}),o.jsxs("div",{className:"flex-1 flex flex-col max-w-full overflow-x-hidden",children:[B&&me&&o.jsxs("div",{className:"bg-red-600 text-white px-6 py-3 flex items-center justify-between shadow-lg",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(_n,{size:20}),o.jsxs("div",{children:[o.jsx("div",{className:"font-bold",children:"ADMIN MODE - Impersonating Client"}),o.jsxs("div",{className:"text-sm text-red-100",children:["Viewing as: ",me.name]})]})]}),o.jsxs("button",{onClick:()=>fR(),className:"flex items-center gap-2 px-4 py-2 bg-red-700 hover:bg-red-800 rounded-md font-medium transition-colors",children:[o.jsx(ps,{size:16}),"Exit Admin Mode"]})]}),!B&&v&&v.licensed_trades&&o.jsx(gR,{currentTrades:v.licensed_trades,subscriptionStatus:v.subscription_status}),o.jsx(bR,{currentProjectId:i||void 0,currentProjectName:c==null?void 0:c.name,onProjectChange:D,onBackToDashboard:()=>{l(null),u(null),a("dashboard")},notificationCount:0,onNavigateToAccount:()=>a("settings"),onNavigateToBilling:()=>a("settings"),onSwitchOrganisation:()=>{k(null),l(null),u(null),f([]),a("dashboard")}}),o.jsx("main",{className:"flex-1 overflow-auto",children:Q()}),o.jsx(VV,{})]}),o.jsx(tx,{children:x&&o.jsx(UV,{message:x.message,type:x.type,onClose:()=>p(null)})}),o.jsx($V,{}),o.jsx("button",{onClick:()=>w(!0),className:"fixed bottom-6 right-6 w-14 h-14 bg-gradient-to-r from-purple-600 to-blue-600 text-white rounded-full shadow-lg hover:shadow-xl transition-all duration-200 flex items-center justify-center z-40 hover:scale-110",title:"Ask AI Copilot",children:o.jsx(u0,{size:24})}),o.jsx(WV,{isOpen:g,onClose:()=>w(!1),currentProjectId:i||void 0,allProjects:d.map(fe=>({id:fe.id,name:fe.name})),onNavigate:ce})]})}function rW(){return o.jsx(ZV,{children:o.jsx(vR,{children:o.jsx(tW,{})})})}class sW extends j.Component{constructor(t){super(t),this.state={hasError:!1,error:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,r){console.error("Error caught by boundary:",t,r)}render(){var t,r;return this.state.hasError?o.jsxs("div",{style:{padding:"40px",fontFamily:"system-ui, -apple-system, sans-serif",maxWidth:"800px",margin:"0 auto"},children:[o.jsx("h1",{style:{color:"#dc2626",marginBottom:"16px"},children:"Application Error"}),o.jsx("div",{style:{background:"#fee2e2",border:"1px solid #fecaca",borderRadius:"8px",padding:"16px",marginBottom:"16px"},children:o.jsx("p",{style:{margin:0,fontFamily:"monospace",fontSize:"14px"},children:((t=this.state.error)==null?void 0:t.message)||"Unknown error"})}),o.jsxs("details",{style:{marginTop:"16px"},children:[o.jsx("summary",{style:{cursor:"pointer",marginBottom:"8px"},children:"Stack Trace"}),o.jsx("pre",{style:{background:"#f3f4f6",padding:"12px",borderRadius:"4px",overflow:"auto",fontSize:"12px"},children:(r=this.state.error)==null?void 0:r.stack})]}),o.jsx("button",{onClick:()=>window.location.reload(),style:{marginTop:"24px",padding:"8px 16px",background:"#3b82f6",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"14px"},children:"Reload Page"})]}):this.props.children}}Wf.createRoot(document.getElementById("root")).render(o.jsx(wj.StrictMode,{children:o.jsx(sW,{children:o.jsx(rW,{})})}));
