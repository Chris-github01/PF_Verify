var HT=Object.defineProperty;var qT=(e,t,r)=>t in e?HT(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var S0=(e,t,r)=>qT(e,typeof t!="symbol"?t+"":t,r);function GT(e,t){for(var r=0;r<t.length;r++){const s=t[r];if(typeof s!="string"&&!Array.isArray(s)){for(const n in s)if(n!=="default"&&!(n in e)){const a=Object.getOwnPropertyDescriptor(s,n);a&&Object.defineProperty(e,n,a.get?a:{enumerable:!0,get:()=>s[n]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function r(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(n){if(n.ep)return;n.ep=!0;const a=r(n);fetch(n.href,a)}})();function KT(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function XT(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function s(){return this instanceof s?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(s){var n=Object.getOwnPropertyDescriptor(e,s);Object.defineProperty(r,s,n.get?n:{enumerable:!0,get:function(){return e[s]}})}),r}var Nw={exports:{}},Md={},jw={exports:{}},Xe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mc=Symbol.for("react.element"),YT=Symbol.for("react.portal"),JT=Symbol.for("react.fragment"),QT=Symbol.for("react.strict_mode"),ZT=Symbol.for("react.profiler"),eN=Symbol.for("react.provider"),tN=Symbol.for("react.context"),rN=Symbol.for("react.forward_ref"),sN=Symbol.for("react.suspense"),nN=Symbol.for("react.memo"),aN=Symbol.for("react.lazy"),dg=Symbol.iterator;function iN(e){return e===null||typeof e!="object"?null:(e=dg&&e[dg]||e["@@iterator"],typeof e=="function"?e:null)}var Cw={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Aw=Object.assign,Fw={};function yo(e,t,r){this.props=e,this.context=t,this.refs=Fw,this.updater=r||Cw}yo.prototype.isReactComponent={};yo.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};yo.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Pw(){}Pw.prototype=yo.prototype;function Cp(e,t,r){this.props=e,this.context=t,this.refs=Fw,this.updater=r||Cw}var Ap=Cp.prototype=new Pw;Ap.constructor=Cp;Aw(Ap,yo.prototype);Ap.isPureReactComponent=!0;var fg=Array.isArray,Rw=Object.prototype.hasOwnProperty,Fp={current:null},Ow={key:!0,ref:!0,__self:!0,__source:!0};function Iw(e,t,r){var s,n={},a=null,i=null;if(t!=null)for(s in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(a=""+t.key),t)Rw.call(t,s)&&!Ow.hasOwnProperty(s)&&(n[s]=t[s]);var o=arguments.length-2;if(o===1)n.children=r;else if(1<o){for(var c=Array(o),u=0;u<o;u++)c[u]=arguments[u+2];n.children=c}if(e&&e.defaultProps)for(s in o=e.defaultProps,o)n[s]===void 0&&(n[s]=o[s]);return{$$typeof:mc,type:e,key:a,ref:i,props:n,_owner:Fp.current}}function oN(e,t){return{$$typeof:mc,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Pp(e){return typeof e=="object"&&e!==null&&e.$$typeof===mc}function lN(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var hg=/\/+/g;function k0(e,t){return typeof e=="object"&&e!==null&&e.key!=null?lN(""+e.key):t.toString(36)}function Eu(e,t,r,s,n){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(a){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case mc:case YT:i=!0}}if(i)return i=e,n=n(i),e=s===""?"."+k0(i,0):s,fg(n)?(r="",e!=null&&(r=e.replace(hg,"$&/")+"/"),Eu(n,t,r,"",function(u){return u})):n!=null&&(Pp(n)&&(n=oN(n,r+(!n.key||i&&i.key===n.key?"":(""+n.key).replace(hg,"$&/")+"/")+e)),t.push(n)),1;if(i=0,s=s===""?".":s+":",fg(e))for(var o=0;o<e.length;o++){a=e[o];var c=s+k0(a,o);i+=Eu(a,t,r,c,n)}else if(c=iN(e),typeof c=="function")for(e=c.call(e),o=0;!(a=e.next()).done;)a=a.value,c=s+k0(a,o++),i+=Eu(a,t,r,c,n);else if(a==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function Lc(e,t,r){if(e==null)return e;var s=[],n=0;return Eu(e,s,"","",function(a){return t.call(r,a,n++)}),s}function cN(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Mr={current:null},Tu={transition:null},uN={ReactCurrentDispatcher:Mr,ReactCurrentBatchConfig:Tu,ReactCurrentOwner:Fp};function Dw(){throw Error("act(...) is not supported in production builds of React.")}Xe.Children={map:Lc,forEach:function(e,t,r){Lc(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Lc(e,function(){t++}),t},toArray:function(e){return Lc(e,function(t){return t})||[]},only:function(e){if(!Pp(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Xe.Component=yo;Xe.Fragment=JT;Xe.Profiler=ZT;Xe.PureComponent=Cp;Xe.StrictMode=QT;Xe.Suspense=sN;Xe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=uN;Xe.act=Dw;Xe.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var s=Aw({},e.props),n=e.key,a=e.ref,i=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,i=Fp.current),t.key!==void 0&&(n=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(c in t)Rw.call(t,c)&&!Ow.hasOwnProperty(c)&&(s[c]=t[c]===void 0&&o!==void 0?o[c]:t[c])}var c=arguments.length-2;if(c===1)s.children=r;else if(1<c){o=Array(c);for(var u=0;u<c;u++)o[u]=arguments[u+2];s.children=o}return{$$typeof:mc,type:e.type,key:n,ref:a,props:s,_owner:i}};Xe.createContext=function(e){return e={$$typeof:tN,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:eN,_context:e},e.Consumer=e};Xe.createElement=Iw;Xe.createFactory=function(e){var t=Iw.bind(null,e);return t.type=e,t};Xe.createRef=function(){return{current:null}};Xe.forwardRef=function(e){return{$$typeof:rN,render:e}};Xe.isValidElement=Pp;Xe.lazy=function(e){return{$$typeof:aN,_payload:{_status:-1,_result:e},_init:cN}};Xe.memo=function(e,t){return{$$typeof:nN,type:e,compare:t===void 0?null:t}};Xe.startTransition=function(e){var t=Tu.transition;Tu.transition={};try{e()}finally{Tu.transition=t}};Xe.unstable_act=Dw;Xe.useCallback=function(e,t){return Mr.current.useCallback(e,t)};Xe.useContext=function(e){return Mr.current.useContext(e)};Xe.useDebugValue=function(){};Xe.useDeferredValue=function(e){return Mr.current.useDeferredValue(e)};Xe.useEffect=function(e,t){return Mr.current.useEffect(e,t)};Xe.useId=function(){return Mr.current.useId()};Xe.useImperativeHandle=function(e,t,r){return Mr.current.useImperativeHandle(e,t,r)};Xe.useInsertionEffect=function(e,t){return Mr.current.useInsertionEffect(e,t)};Xe.useLayoutEffect=function(e,t){return Mr.current.useLayoutEffect(e,t)};Xe.useMemo=function(e,t){return Mr.current.useMemo(e,t)};Xe.useReducer=function(e,t,r){return Mr.current.useReducer(e,t,r)};Xe.useRef=function(e){return Mr.current.useRef(e)};Xe.useState=function(e){return Mr.current.useState(e)};Xe.useSyncExternalStore=function(e,t,r){return Mr.current.useSyncExternalStore(e,t,r)};Xe.useTransition=function(){return Mr.current.useTransition()};Xe.version="18.3.1";jw.exports=Xe;var F=jw.exports;const dN=KT(F);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fN=F,hN=Symbol.for("react.element"),pN=Symbol.for("react.fragment"),mN=Object.prototype.hasOwnProperty,xN=fN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,gN={key:!0,ref:!0,__self:!0,__source:!0};function Lw(e,t,r){var s,n={},a=null,i=null;r!==void 0&&(a=""+r),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(i=t.ref);for(s in t)mN.call(t,s)&&!gN.hasOwnProperty(s)&&(n[s]=t[s]);if(e&&e.defaultProps)for(s in t=e.defaultProps,t)n[s]===void 0&&(n[s]=t[s]);return{$$typeof:hN,type:e,key:a,ref:i,props:n,_owner:xN.current}}Md.Fragment=pN;Md.jsx=Lw;Md.jsxs=Lw;Nw.exports=Md;var l=Nw.exports,Mf={},Mw={exports:{}},us={},Bw={exports:{}},Uw={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(G,D){var K=G.length;G.push(D);e:for(;0<K;){var oe=K-1>>>1,N=G[oe];if(0<n(N,D))G[oe]=D,G[K]=N,K=oe;else break e}}function r(G){return G.length===0?null:G[0]}function s(G){if(G.length===0)return null;var D=G[0],K=G.pop();if(K!==D){G[0]=K;e:for(var oe=0,N=G.length,W=N>>>1;oe<W;){var I=2*(oe+1)-1,B=G[I],ee=I+1,le=G[ee];if(0>n(B,K))ee<N&&0>n(le,B)?(G[oe]=le,G[ee]=K,oe=ee):(G[oe]=B,G[I]=K,oe=I);else if(ee<N&&0>n(le,K))G[oe]=le,G[ee]=K,oe=ee;else break e}}return D}function n(G,D){var K=G.sortIndex-D.sortIndex;return K!==0?K:G.id-D.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var i=Date,o=i.now();e.unstable_now=function(){return i.now()-o}}var c=[],u=[],d=1,f=null,h=3,m=!1,p=!1,x=!1,v=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function g(G){for(var D=r(u);D!==null;){if(D.callback===null)s(u);else if(D.startTime<=G)s(u),D.sortIndex=D.expirationTime,t(c,D);else break;D=r(u)}}function _(G){if(x=!1,g(G),!p)if(r(c)!==null)p=!0,M(b);else{var D=r(u);D!==null&&J(_,D.startTime-G)}}function b(G,D){p=!1,x&&(x=!1,y(T),T=-1),m=!0;var K=h;try{for(g(D),f=r(c);f!==null&&(!(f.expirationTime>D)||G&&!H());){var oe=f.callback;if(typeof oe=="function"){f.callback=null,h=f.priorityLevel;var N=oe(f.expirationTime<=D);D=e.unstable_now(),typeof N=="function"?f.callback=N:f===r(c)&&s(c),g(D)}else s(c);f=r(c)}if(f!==null)var W=!0;else{var I=r(u);I!==null&&J(_,I.startTime-D),W=!1}return W}finally{f=null,h=K,m=!1}}var k=!1,S=null,T=-1,j=5,U=-1;function H(){return!(e.unstable_now()-U<j)}function z(){if(S!==null){var G=e.unstable_now();U=G;var D=!0;try{D=S(!0,G)}finally{D?q():(k=!1,S=null)}}else k=!1}var q;if(typeof w=="function")q=function(){w(z)};else if(typeof MessageChannel<"u"){var re=new MessageChannel,X=re.port2;re.port1.onmessage=z,q=function(){X.postMessage(null)}}else q=function(){v(z,0)};function M(G){S=G,k||(k=!0,q())}function J(G,D){T=v(function(){G(e.unstable_now())},D)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(G){G.callback=null},e.unstable_continueExecution=function(){p||m||(p=!0,M(b))},e.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):j=0<G?Math.floor(1e3/G):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(G){switch(h){case 1:case 2:case 3:var D=3;break;default:D=h}var K=h;h=D;try{return G()}finally{h=K}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(G,D){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var K=h;h=G;try{return D()}finally{h=K}},e.unstable_scheduleCallback=function(G,D,K){var oe=e.unstable_now();switch(typeof K=="object"&&K!==null?(K=K.delay,K=typeof K=="number"&&0<K?oe+K:oe):K=oe,G){case 1:var N=-1;break;case 2:N=250;break;case 5:N=1073741823;break;case 4:N=1e4;break;default:N=5e3}return N=K+N,G={id:d++,callback:D,priorityLevel:G,startTime:K,expirationTime:N,sortIndex:-1},K>oe?(G.sortIndex=K,t(u,G),r(c)===null&&G===r(u)&&(x?(y(T),T=-1):x=!0,J(_,K-oe))):(G.sortIndex=N,t(c,G),p||m||(p=!0,M(b))),G},e.unstable_shouldYield=H,e.unstable_wrapCallback=function(G){var D=h;return function(){var K=h;h=D;try{return G.apply(this,arguments)}finally{h=K}}}})(Uw);Bw.exports=Uw;var vN=Bw.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yN=F,ls=vN;function ge(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var $w=new Set,Tl={};function ni(e,t){ro(e,t),ro(e+"Capture",t)}function ro(e,t){for(Tl[e]=t,e=0;e<t.length;e++)$w.add(t[e])}var Tn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Bf=Object.prototype.hasOwnProperty,wN=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,pg={},mg={};function _N(e){return Bf.call(mg,e)?!0:Bf.call(pg,e)?!1:wN.test(e)?mg[e]=!0:(pg[e]=!0,!1)}function bN(e,t,r,s){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return s?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function SN(e,t,r,s){if(t===null||typeof t>"u"||bN(e,t,r,s))return!0;if(s)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Br(e,t,r,s,n,a,i){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=s,this.attributeNamespace=n,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=i}var fr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){fr[e]=new Br(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];fr[t]=new Br(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){fr[e]=new Br(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){fr[e]=new Br(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){fr[e]=new Br(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){fr[e]=new Br(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){fr[e]=new Br(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){fr[e]=new Br(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){fr[e]=new Br(e,5,!1,e.toLowerCase(),null,!1,!1)});var Rp=/[\-:]([a-z])/g;function Op(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Rp,Op);fr[t]=new Br(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Rp,Op);fr[t]=new Br(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Rp,Op);fr[t]=new Br(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){fr[e]=new Br(e,1,!1,e.toLowerCase(),null,!1,!1)});fr.xlinkHref=new Br("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){fr[e]=new Br(e,1,!1,e.toLowerCase(),null,!0,!0)});function Ip(e,t,r,s){var n=fr.hasOwnProperty(t)?fr[t]:null;(n!==null?n.type!==0:s||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(SN(t,r,n,s)&&(r=null),s||n===null?_N(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):n.mustUseProperty?e[n.propertyName]=r===null?n.type===3?!1:"":r:(t=n.attributeName,s=n.attributeNamespace,r===null?e.removeAttribute(t):(n=n.type,r=n===3||n===4&&r===!0?"":""+r,s?e.setAttributeNS(s,t,r):e.setAttribute(t,r))))}var Rn=yN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Mc=Symbol.for("react.element"),Ei=Symbol.for("react.portal"),Ti=Symbol.for("react.fragment"),Dp=Symbol.for("react.strict_mode"),Uf=Symbol.for("react.profiler"),Vw=Symbol.for("react.provider"),zw=Symbol.for("react.context"),Lp=Symbol.for("react.forward_ref"),$f=Symbol.for("react.suspense"),Vf=Symbol.for("react.suspense_list"),Mp=Symbol.for("react.memo"),$n=Symbol.for("react.lazy"),Ww=Symbol.for("react.offscreen"),xg=Symbol.iterator;function Lo(e){return e===null||typeof e!="object"?null:(e=xg&&e[xg]||e["@@iterator"],typeof e=="function"?e:null)}var At=Object.assign,E0;function Go(e){if(E0===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);E0=t&&t[1]||""}return`
`+E0+e}var T0=!1;function N0(e,t){if(!e||T0)return"";T0=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var s=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){s=u}e.call(t.prototype)}else{try{throw Error()}catch(u){s=u}e()}}catch(u){if(u&&s&&typeof u.stack=="string"){for(var n=u.stack.split(`
`),a=s.stack.split(`
`),i=n.length-1,o=a.length-1;1<=i&&0<=o&&n[i]!==a[o];)o--;for(;1<=i&&0<=o;i--,o--)if(n[i]!==a[o]){if(i!==1||o!==1)do if(i--,o--,0>o||n[i]!==a[o]){var c=`
`+n[i].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=i&&0<=o);break}}}finally{T0=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Go(e):""}function kN(e){switch(e.tag){case 5:return Go(e.type);case 16:return Go("Lazy");case 13:return Go("Suspense");case 19:return Go("SuspenseList");case 0:case 2:case 15:return e=N0(e.type,!1),e;case 11:return e=N0(e.type.render,!1),e;case 1:return e=N0(e.type,!0),e;default:return""}}function zf(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Ti:return"Fragment";case Ei:return"Portal";case Uf:return"Profiler";case Dp:return"StrictMode";case $f:return"Suspense";case Vf:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case zw:return(e.displayName||"Context")+".Consumer";case Vw:return(e._context.displayName||"Context")+".Provider";case Lp:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Mp:return t=e.displayName||null,t!==null?t:zf(e.type)||"Memo";case $n:t=e._payload,e=e._init;try{return zf(e(t))}catch{}}return null}function EN(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return zf(t);case 8:return t===Dp?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function na(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Hw(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function TN(e){var t=Hw(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),s=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var n=r.get,a=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return n.call(this)},set:function(i){s=""+i,a.call(this,i)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return s},setValue:function(i){s=""+i},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Bc(e){e._valueTracker||(e._valueTracker=TN(e))}function qw(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),s="";return e&&(s=Hw(e)?e.checked?"true":"false":e.value),e=s,e!==r?(t.setValue(e),!0):!1}function zu(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Wf(e,t){var r=t.checked;return At({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function gg(e,t){var r=t.defaultValue==null?"":t.defaultValue,s=t.checked!=null?t.checked:t.defaultChecked;r=na(t.value!=null?t.value:r),e._wrapperState={initialChecked:s,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Gw(e,t){t=t.checked,t!=null&&Ip(e,"checked",t,!1)}function Hf(e,t){Gw(e,t);var r=na(t.value),s=t.type;if(r!=null)s==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(s==="submit"||s==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?qf(e,t.type,r):t.hasOwnProperty("defaultValue")&&qf(e,t.type,na(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function vg(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var s=t.type;if(!(s!=="submit"&&s!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function qf(e,t,r){(t!=="number"||zu(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Ko=Array.isArray;function zi(e,t,r,s){if(e=e.options,t){t={};for(var n=0;n<r.length;n++)t["$"+r[n]]=!0;for(r=0;r<e.length;r++)n=t.hasOwnProperty("$"+e[r].value),e[r].selected!==n&&(e[r].selected=n),n&&s&&(e[r].defaultSelected=!0)}else{for(r=""+na(r),t=null,n=0;n<e.length;n++){if(e[n].value===r){e[n].selected=!0,s&&(e[n].defaultSelected=!0);return}t!==null||e[n].disabled||(t=e[n])}t!==null&&(t.selected=!0)}}function Gf(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(ge(91));return At({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function yg(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(ge(92));if(Ko(r)){if(1<r.length)throw Error(ge(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:na(r)}}function Kw(e,t){var r=na(t.value),s=na(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),s!=null&&(e.defaultValue=""+s)}function wg(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Xw(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Kf(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Xw(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Uc,Yw=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,s,n){MSApp.execUnsafeLocalFunction(function(){return e(t,r,s,n)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Uc=Uc||document.createElement("div"),Uc.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Uc.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Nl(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var rl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},NN=["Webkit","ms","Moz","O"];Object.keys(rl).forEach(function(e){NN.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),rl[t]=rl[e]})});function Jw(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||rl.hasOwnProperty(e)&&rl[e]?(""+t).trim():t+"px"}function Qw(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var s=r.indexOf("--")===0,n=Jw(r,t[r],s);r==="float"&&(r="cssFloat"),s?e.setProperty(r,n):e[r]=n}}var jN=At({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Xf(e,t){if(t){if(jN[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(ge(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(ge(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(ge(61))}if(t.style!=null&&typeof t.style!="object")throw Error(ge(62))}}function Yf(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Jf=null;function Bp(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Qf=null,Wi=null,Hi=null;function _g(e){if(e=vc(e)){if(typeof Qf!="function")throw Error(ge(280));var t=e.stateNode;t&&(t=zd(t),Qf(e.stateNode,e.type,t))}}function Zw(e){Wi?Hi?Hi.push(e):Hi=[e]:Wi=e}function e2(){if(Wi){var e=Wi,t=Hi;if(Hi=Wi=null,_g(e),t)for(e=0;e<t.length;e++)_g(t[e])}}function t2(e,t){return e(t)}function r2(){}var j0=!1;function s2(e,t,r){if(j0)return e(t,r);j0=!0;try{return t2(e,t,r)}finally{j0=!1,(Wi!==null||Hi!==null)&&(r2(),e2())}}function jl(e,t){var r=e.stateNode;if(r===null)return null;var s=zd(r);if(s===null)return null;r=s[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(e=e.type,s=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!s;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(ge(231,t,typeof r));return r}var Zf=!1;if(Tn)try{var Mo={};Object.defineProperty(Mo,"passive",{get:function(){Zf=!0}}),window.addEventListener("test",Mo,Mo),window.removeEventListener("test",Mo,Mo)}catch{Zf=!1}function CN(e,t,r,s,n,a,i,o,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(d){this.onError(d)}}var sl=!1,Wu=null,Hu=!1,eh=null,AN={onError:function(e){sl=!0,Wu=e}};function FN(e,t,r,s,n,a,i,o,c){sl=!1,Wu=null,CN.apply(AN,arguments)}function PN(e,t,r,s,n,a,i,o,c){if(FN.apply(this,arguments),sl){if(sl){var u=Wu;sl=!1,Wu=null}else throw Error(ge(198));Hu||(Hu=!0,eh=u)}}function ai(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function n2(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function bg(e){if(ai(e)!==e)throw Error(ge(188))}function RN(e){var t=e.alternate;if(!t){if(t=ai(e),t===null)throw Error(ge(188));return t!==e?null:e}for(var r=e,s=t;;){var n=r.return;if(n===null)break;var a=n.alternate;if(a===null){if(s=n.return,s!==null){r=s;continue}break}if(n.child===a.child){for(a=n.child;a;){if(a===r)return bg(n),e;if(a===s)return bg(n),t;a=a.sibling}throw Error(ge(188))}if(r.return!==s.return)r=n,s=a;else{for(var i=!1,o=n.child;o;){if(o===r){i=!0,r=n,s=a;break}if(o===s){i=!0,s=n,r=a;break}o=o.sibling}if(!i){for(o=a.child;o;){if(o===r){i=!0,r=a,s=n;break}if(o===s){i=!0,s=a,r=n;break}o=o.sibling}if(!i)throw Error(ge(189))}}if(r.alternate!==s)throw Error(ge(190))}if(r.tag!==3)throw Error(ge(188));return r.stateNode.current===r?e:t}function a2(e){return e=RN(e),e!==null?i2(e):null}function i2(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=i2(e);if(t!==null)return t;e=e.sibling}return null}var o2=ls.unstable_scheduleCallback,Sg=ls.unstable_cancelCallback,ON=ls.unstable_shouldYield,IN=ls.unstable_requestPaint,Mt=ls.unstable_now,DN=ls.unstable_getCurrentPriorityLevel,Up=ls.unstable_ImmediatePriority,l2=ls.unstable_UserBlockingPriority,qu=ls.unstable_NormalPriority,LN=ls.unstable_LowPriority,c2=ls.unstable_IdlePriority,Bd=null,nn=null;function MN(e){if(nn&&typeof nn.onCommitFiberRoot=="function")try{nn.onCommitFiberRoot(Bd,e,void 0,(e.current.flags&128)===128)}catch{}}var Hs=Math.clz32?Math.clz32:$N,BN=Math.log,UN=Math.LN2;function $N(e){return e>>>=0,e===0?32:31-(BN(e)/UN|0)|0}var $c=64,Vc=4194304;function Xo(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Gu(e,t){var r=e.pendingLanes;if(r===0)return 0;var s=0,n=e.suspendedLanes,a=e.pingedLanes,i=r&268435455;if(i!==0){var o=i&~n;o!==0?s=Xo(o):(a&=i,a!==0&&(s=Xo(a)))}else i=r&~n,i!==0?s=Xo(i):a!==0&&(s=Xo(a));if(s===0)return 0;if(t!==0&&t!==s&&!(t&n)&&(n=s&-s,a=t&-t,n>=a||n===16&&(a&4194240)!==0))return t;if(s&4&&(s|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=s;0<t;)r=31-Hs(t),n=1<<r,s|=e[r],t&=~n;return s}function VN(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function zN(e,t){for(var r=e.suspendedLanes,s=e.pingedLanes,n=e.expirationTimes,a=e.pendingLanes;0<a;){var i=31-Hs(a),o=1<<i,c=n[i];c===-1?(!(o&r)||o&s)&&(n[i]=VN(o,t)):c<=t&&(e.expiredLanes|=o),a&=~o}}function th(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function u2(){var e=$c;return $c<<=1,!($c&4194240)&&($c=64),e}function C0(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function xc(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Hs(t),e[t]=r}function WN(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var s=e.eventTimes;for(e=e.expirationTimes;0<r;){var n=31-Hs(r),a=1<<n;t[n]=0,s[n]=-1,e[n]=-1,r&=~a}}function $p(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var s=31-Hs(r),n=1<<s;n&t|e[s]&t&&(e[s]|=t),r&=~n}}var it=0;function d2(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var f2,Vp,h2,p2,m2,rh=!1,zc=[],Yn=null,Jn=null,Qn=null,Cl=new Map,Al=new Map,zn=[],HN="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function kg(e,t){switch(e){case"focusin":case"focusout":Yn=null;break;case"dragenter":case"dragleave":Jn=null;break;case"mouseover":case"mouseout":Qn=null;break;case"pointerover":case"pointerout":Cl.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Al.delete(t.pointerId)}}function Bo(e,t,r,s,n,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:r,eventSystemFlags:s,nativeEvent:a,targetContainers:[n]},t!==null&&(t=vc(t),t!==null&&Vp(t)),e):(e.eventSystemFlags|=s,t=e.targetContainers,n!==null&&t.indexOf(n)===-1&&t.push(n),e)}function qN(e,t,r,s,n){switch(t){case"focusin":return Yn=Bo(Yn,e,t,r,s,n),!0;case"dragenter":return Jn=Bo(Jn,e,t,r,s,n),!0;case"mouseover":return Qn=Bo(Qn,e,t,r,s,n),!0;case"pointerover":var a=n.pointerId;return Cl.set(a,Bo(Cl.get(a)||null,e,t,r,s,n)),!0;case"gotpointercapture":return a=n.pointerId,Al.set(a,Bo(Al.get(a)||null,e,t,r,s,n)),!0}return!1}function x2(e){var t=Pa(e.target);if(t!==null){var r=ai(t);if(r!==null){if(t=r.tag,t===13){if(t=n2(r),t!==null){e.blockedOn=t,m2(e.priority,function(){h2(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Nu(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=sh(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var s=new r.constructor(r.type,r);Jf=s,r.target.dispatchEvent(s),Jf=null}else return t=vc(r),t!==null&&Vp(t),e.blockedOn=r,!1;t.shift()}return!0}function Eg(e,t,r){Nu(e)&&r.delete(t)}function GN(){rh=!1,Yn!==null&&Nu(Yn)&&(Yn=null),Jn!==null&&Nu(Jn)&&(Jn=null),Qn!==null&&Nu(Qn)&&(Qn=null),Cl.forEach(Eg),Al.forEach(Eg)}function Uo(e,t){e.blockedOn===t&&(e.blockedOn=null,rh||(rh=!0,ls.unstable_scheduleCallback(ls.unstable_NormalPriority,GN)))}function Fl(e){function t(n){return Uo(n,e)}if(0<zc.length){Uo(zc[0],e);for(var r=1;r<zc.length;r++){var s=zc[r];s.blockedOn===e&&(s.blockedOn=null)}}for(Yn!==null&&Uo(Yn,e),Jn!==null&&Uo(Jn,e),Qn!==null&&Uo(Qn,e),Cl.forEach(t),Al.forEach(t),r=0;r<zn.length;r++)s=zn[r],s.blockedOn===e&&(s.blockedOn=null);for(;0<zn.length&&(r=zn[0],r.blockedOn===null);)x2(r),r.blockedOn===null&&zn.shift()}var qi=Rn.ReactCurrentBatchConfig,Ku=!0;function KN(e,t,r,s){var n=it,a=qi.transition;qi.transition=null;try{it=1,zp(e,t,r,s)}finally{it=n,qi.transition=a}}function XN(e,t,r,s){var n=it,a=qi.transition;qi.transition=null;try{it=4,zp(e,t,r,s)}finally{it=n,qi.transition=a}}function zp(e,t,r,s){if(Ku){var n=sh(e,t,r,s);if(n===null)B0(e,t,s,Xu,r),kg(e,s);else if(qN(n,e,t,r,s))s.stopPropagation();else if(kg(e,s),t&4&&-1<HN.indexOf(e)){for(;n!==null;){var a=vc(n);if(a!==null&&f2(a),a=sh(e,t,r,s),a===null&&B0(e,t,s,Xu,r),a===n)break;n=a}n!==null&&s.stopPropagation()}else B0(e,t,s,null,r)}}var Xu=null;function sh(e,t,r,s){if(Xu=null,e=Bp(s),e=Pa(e),e!==null)if(t=ai(e),t===null)e=null;else if(r=t.tag,r===13){if(e=n2(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Xu=e,null}function g2(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(DN()){case Up:return 1;case l2:return 4;case qu:case LN:return 16;case c2:return 536870912;default:return 16}default:return 16}}var qn=null,Wp=null,ju=null;function v2(){if(ju)return ju;var e,t=Wp,r=t.length,s,n="value"in qn?qn.value:qn.textContent,a=n.length;for(e=0;e<r&&t[e]===n[e];e++);var i=r-e;for(s=1;s<=i&&t[r-s]===n[a-s];s++);return ju=n.slice(e,1<s?1-s:void 0)}function Cu(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Wc(){return!0}function Tg(){return!1}function ds(e){function t(r,s,n,a,i){this._reactName=r,this._targetInst=n,this.type=s,this.nativeEvent=a,this.target=i,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(a):a[o]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?Wc:Tg,this.isPropagationStopped=Tg,this}return At(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Wc)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Wc)},persist:function(){},isPersistent:Wc}),t}var wo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Hp=ds(wo),gc=At({},wo,{view:0,detail:0}),YN=ds(gc),A0,F0,$o,Ud=At({},gc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:qp,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==$o&&($o&&e.type==="mousemove"?(A0=e.screenX-$o.screenX,F0=e.screenY-$o.screenY):F0=A0=0,$o=e),A0)},movementY:function(e){return"movementY"in e?e.movementY:F0}}),Ng=ds(Ud),JN=At({},Ud,{dataTransfer:0}),QN=ds(JN),ZN=At({},gc,{relatedTarget:0}),P0=ds(ZN),e4=At({},wo,{animationName:0,elapsedTime:0,pseudoElement:0}),t4=ds(e4),r4=At({},wo,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),s4=ds(r4),n4=At({},wo,{data:0}),jg=ds(n4),a4={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},i4={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},o4={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function l4(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=o4[e])?!!t[e]:!1}function qp(){return l4}var c4=At({},gc,{key:function(e){if(e.key){var t=a4[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Cu(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?i4[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:qp,charCode:function(e){return e.type==="keypress"?Cu(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Cu(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),u4=ds(c4),d4=At({},Ud,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Cg=ds(d4),f4=At({},gc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:qp}),h4=ds(f4),p4=At({},wo,{propertyName:0,elapsedTime:0,pseudoElement:0}),m4=ds(p4),x4=At({},Ud,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),g4=ds(x4),v4=[9,13,27,32],Gp=Tn&&"CompositionEvent"in window,nl=null;Tn&&"documentMode"in document&&(nl=document.documentMode);var y4=Tn&&"TextEvent"in window&&!nl,y2=Tn&&(!Gp||nl&&8<nl&&11>=nl),Ag=" ",Fg=!1;function w2(e,t){switch(e){case"keyup":return v4.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function _2(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Ni=!1;function w4(e,t){switch(e){case"compositionend":return _2(t);case"keypress":return t.which!==32?null:(Fg=!0,Ag);case"textInput":return e=t.data,e===Ag&&Fg?null:e;default:return null}}function _4(e,t){if(Ni)return e==="compositionend"||!Gp&&w2(e,t)?(e=v2(),ju=Wp=qn=null,Ni=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return y2&&t.locale!=="ko"?null:t.data;default:return null}}var b4={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Pg(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!b4[e.type]:t==="textarea"}function b2(e,t,r,s){Zw(s),t=Yu(t,"onChange"),0<t.length&&(r=new Hp("onChange","change",null,r,s),e.push({event:r,listeners:t}))}var al=null,Pl=null;function S4(e){R2(e,0)}function $d(e){var t=Ai(e);if(qw(t))return e}function k4(e,t){if(e==="change")return t}var S2=!1;if(Tn){var R0;if(Tn){var O0="oninput"in document;if(!O0){var Rg=document.createElement("div");Rg.setAttribute("oninput","return;"),O0=typeof Rg.oninput=="function"}R0=O0}else R0=!1;S2=R0&&(!document.documentMode||9<document.documentMode)}function Og(){al&&(al.detachEvent("onpropertychange",k2),Pl=al=null)}function k2(e){if(e.propertyName==="value"&&$d(Pl)){var t=[];b2(t,Pl,e,Bp(e)),s2(S4,t)}}function E4(e,t,r){e==="focusin"?(Og(),al=t,Pl=r,al.attachEvent("onpropertychange",k2)):e==="focusout"&&Og()}function T4(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return $d(Pl)}function N4(e,t){if(e==="click")return $d(t)}function j4(e,t){if(e==="input"||e==="change")return $d(t)}function C4(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Xs=typeof Object.is=="function"?Object.is:C4;function Rl(e,t){if(Xs(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),s=Object.keys(t);if(r.length!==s.length)return!1;for(s=0;s<r.length;s++){var n=r[s];if(!Bf.call(t,n)||!Xs(e[n],t[n]))return!1}return!0}function Ig(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Dg(e,t){var r=Ig(e);e=0;for(var s;r;){if(r.nodeType===3){if(s=e+r.textContent.length,e<=t&&s>=t)return{node:r,offset:t-e};e=s}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Ig(r)}}function E2(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?E2(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function T2(){for(var e=window,t=zu();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=zu(e.document)}return t}function Kp(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function A4(e){var t=T2(),r=e.focusedElem,s=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&E2(r.ownerDocument.documentElement,r)){if(s!==null&&Kp(r)){if(t=s.start,e=s.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var n=r.textContent.length,a=Math.min(s.start,n);s=s.end===void 0?a:Math.min(s.end,n),!e.extend&&a>s&&(n=s,s=a,a=n),n=Dg(r,a);var i=Dg(r,s);n&&i&&(e.rangeCount!==1||e.anchorNode!==n.node||e.anchorOffset!==n.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(t=t.createRange(),t.setStart(n.node,n.offset),e.removeAllRanges(),a>s?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var F4=Tn&&"documentMode"in document&&11>=document.documentMode,ji=null,nh=null,il=null,ah=!1;function Lg(e,t,r){var s=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;ah||ji==null||ji!==zu(s)||(s=ji,"selectionStart"in s&&Kp(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),il&&Rl(il,s)||(il=s,s=Yu(nh,"onSelect"),0<s.length&&(t=new Hp("onSelect","select",null,t,r),e.push({event:t,listeners:s}),t.target=ji)))}function Hc(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Ci={animationend:Hc("Animation","AnimationEnd"),animationiteration:Hc("Animation","AnimationIteration"),animationstart:Hc("Animation","AnimationStart"),transitionend:Hc("Transition","TransitionEnd")},I0={},N2={};Tn&&(N2=document.createElement("div").style,"AnimationEvent"in window||(delete Ci.animationend.animation,delete Ci.animationiteration.animation,delete Ci.animationstart.animation),"TransitionEvent"in window||delete Ci.transitionend.transition);function Vd(e){if(I0[e])return I0[e];if(!Ci[e])return e;var t=Ci[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in N2)return I0[e]=t[r];return e}var j2=Vd("animationend"),C2=Vd("animationiteration"),A2=Vd("animationstart"),F2=Vd("transitionend"),P2=new Map,Mg="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function fa(e,t){P2.set(e,t),ni(t,[e])}for(var D0=0;D0<Mg.length;D0++){var L0=Mg[D0],P4=L0.toLowerCase(),R4=L0[0].toUpperCase()+L0.slice(1);fa(P4,"on"+R4)}fa(j2,"onAnimationEnd");fa(C2,"onAnimationIteration");fa(A2,"onAnimationStart");fa("dblclick","onDoubleClick");fa("focusin","onFocus");fa("focusout","onBlur");fa(F2,"onTransitionEnd");ro("onMouseEnter",["mouseout","mouseover"]);ro("onMouseLeave",["mouseout","mouseover"]);ro("onPointerEnter",["pointerout","pointerover"]);ro("onPointerLeave",["pointerout","pointerover"]);ni("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ni("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ni("onBeforeInput",["compositionend","keypress","textInput","paste"]);ni("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ni("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ni("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Yo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),O4=new Set("cancel close invalid load scroll toggle".split(" ").concat(Yo));function Bg(e,t,r){var s=e.type||"unknown-event";e.currentTarget=r,PN(s,t,void 0,e),e.currentTarget=null}function R2(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var s=e[r],n=s.event;s=s.listeners;e:{var a=void 0;if(t)for(var i=s.length-1;0<=i;i--){var o=s[i],c=o.instance,u=o.currentTarget;if(o=o.listener,c!==a&&n.isPropagationStopped())break e;Bg(n,o,u),a=c}else for(i=0;i<s.length;i++){if(o=s[i],c=o.instance,u=o.currentTarget,o=o.listener,c!==a&&n.isPropagationStopped())break e;Bg(n,o,u),a=c}}}if(Hu)throw e=eh,Hu=!1,eh=null,e}function ut(e,t){var r=t[uh];r===void 0&&(r=t[uh]=new Set);var s=e+"__bubble";r.has(s)||(O2(t,e,2,!1),r.add(s))}function M0(e,t,r){var s=0;t&&(s|=4),O2(r,e,s,t)}var qc="_reactListening"+Math.random().toString(36).slice(2);function Ol(e){if(!e[qc]){e[qc]=!0,$w.forEach(function(r){r!=="selectionchange"&&(O4.has(r)||M0(r,!1,e),M0(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[qc]||(t[qc]=!0,M0("selectionchange",!1,t))}}function O2(e,t,r,s){switch(g2(t)){case 1:var n=KN;break;case 4:n=XN;break;default:n=zp}r=n.bind(null,t,r,e),n=void 0,!Zf||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(n=!0),s?n!==void 0?e.addEventListener(t,r,{capture:!0,passive:n}):e.addEventListener(t,r,!0):n!==void 0?e.addEventListener(t,r,{passive:n}):e.addEventListener(t,r,!1)}function B0(e,t,r,s,n){var a=s;if(!(t&1)&&!(t&2)&&s!==null)e:for(;;){if(s===null)return;var i=s.tag;if(i===3||i===4){var o=s.stateNode.containerInfo;if(o===n||o.nodeType===8&&o.parentNode===n)break;if(i===4)for(i=s.return;i!==null;){var c=i.tag;if((c===3||c===4)&&(c=i.stateNode.containerInfo,c===n||c.nodeType===8&&c.parentNode===n))return;i=i.return}for(;o!==null;){if(i=Pa(o),i===null)return;if(c=i.tag,c===5||c===6){s=a=i;continue e}o=o.parentNode}}s=s.return}s2(function(){var u=a,d=Bp(r),f=[];e:{var h=P2.get(e);if(h!==void 0){var m=Hp,p=e;switch(e){case"keypress":if(Cu(r)===0)break e;case"keydown":case"keyup":m=u4;break;case"focusin":p="focus",m=P0;break;case"focusout":p="blur",m=P0;break;case"beforeblur":case"afterblur":m=P0;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=Ng;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=QN;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=h4;break;case j2:case C2:case A2:m=t4;break;case F2:m=m4;break;case"scroll":m=YN;break;case"wheel":m=g4;break;case"copy":case"cut":case"paste":m=s4;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=Cg}var x=(t&4)!==0,v=!x&&e==="scroll",y=x?h!==null?h+"Capture":null:h;x=[];for(var w=u,g;w!==null;){g=w;var _=g.stateNode;if(g.tag===5&&_!==null&&(g=_,y!==null&&(_=jl(w,y),_!=null&&x.push(Il(w,_,g)))),v)break;w=w.return}0<x.length&&(h=new m(h,p,null,r,d),f.push({event:h,listeners:x}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",m=e==="mouseout"||e==="pointerout",h&&r!==Jf&&(p=r.relatedTarget||r.fromElement)&&(Pa(p)||p[Nn]))break e;if((m||h)&&(h=d.window===d?d:(h=d.ownerDocument)?h.defaultView||h.parentWindow:window,m?(p=r.relatedTarget||r.toElement,m=u,p=p?Pa(p):null,p!==null&&(v=ai(p),p!==v||p.tag!==5&&p.tag!==6)&&(p=null)):(m=null,p=u),m!==p)){if(x=Ng,_="onMouseLeave",y="onMouseEnter",w="mouse",(e==="pointerout"||e==="pointerover")&&(x=Cg,_="onPointerLeave",y="onPointerEnter",w="pointer"),v=m==null?h:Ai(m),g=p==null?h:Ai(p),h=new x(_,w+"leave",m,r,d),h.target=v,h.relatedTarget=g,_=null,Pa(d)===u&&(x=new x(y,w+"enter",p,r,d),x.target=g,x.relatedTarget=v,_=x),v=_,m&&p)t:{for(x=m,y=p,w=0,g=x;g;g=hi(g))w++;for(g=0,_=y;_;_=hi(_))g++;for(;0<w-g;)x=hi(x),w--;for(;0<g-w;)y=hi(y),g--;for(;w--;){if(x===y||y!==null&&x===y.alternate)break t;x=hi(x),y=hi(y)}x=null}else x=null;m!==null&&Ug(f,h,m,x,!1),p!==null&&v!==null&&Ug(f,v,p,x,!0)}}e:{if(h=u?Ai(u):window,m=h.nodeName&&h.nodeName.toLowerCase(),m==="select"||m==="input"&&h.type==="file")var b=k4;else if(Pg(h))if(S2)b=j4;else{b=T4;var k=E4}else(m=h.nodeName)&&m.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(b=N4);if(b&&(b=b(e,u))){b2(f,b,r,d);break e}k&&k(e,h,u),e==="focusout"&&(k=h._wrapperState)&&k.controlled&&h.type==="number"&&qf(h,"number",h.value)}switch(k=u?Ai(u):window,e){case"focusin":(Pg(k)||k.contentEditable==="true")&&(ji=k,nh=u,il=null);break;case"focusout":il=nh=ji=null;break;case"mousedown":ah=!0;break;case"contextmenu":case"mouseup":case"dragend":ah=!1,Lg(f,r,d);break;case"selectionchange":if(F4)break;case"keydown":case"keyup":Lg(f,r,d)}var S;if(Gp)e:{switch(e){case"compositionstart":var T="onCompositionStart";break e;case"compositionend":T="onCompositionEnd";break e;case"compositionupdate":T="onCompositionUpdate";break e}T=void 0}else Ni?w2(e,r)&&(T="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(T="onCompositionStart");T&&(y2&&r.locale!=="ko"&&(Ni||T!=="onCompositionStart"?T==="onCompositionEnd"&&Ni&&(S=v2()):(qn=d,Wp="value"in qn?qn.value:qn.textContent,Ni=!0)),k=Yu(u,T),0<k.length&&(T=new jg(T,e,null,r,d),f.push({event:T,listeners:k}),S?T.data=S:(S=_2(r),S!==null&&(T.data=S)))),(S=y4?w4(e,r):_4(e,r))&&(u=Yu(u,"onBeforeInput"),0<u.length&&(d=new jg("onBeforeInput","beforeinput",null,r,d),f.push({event:d,listeners:u}),d.data=S))}R2(f,t)})}function Il(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Yu(e,t){for(var r=t+"Capture",s=[];e!==null;){var n=e,a=n.stateNode;n.tag===5&&a!==null&&(n=a,a=jl(e,r),a!=null&&s.unshift(Il(e,a,n)),a=jl(e,t),a!=null&&s.push(Il(e,a,n))),e=e.return}return s}function hi(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Ug(e,t,r,s,n){for(var a=t._reactName,i=[];r!==null&&r!==s;){var o=r,c=o.alternate,u=o.stateNode;if(c!==null&&c===s)break;o.tag===5&&u!==null&&(o=u,n?(c=jl(r,a),c!=null&&i.unshift(Il(r,c,o))):n||(c=jl(r,a),c!=null&&i.push(Il(r,c,o)))),r=r.return}i.length!==0&&e.push({event:t,listeners:i})}var I4=/\r\n?/g,D4=/\u0000|\uFFFD/g;function $g(e){return(typeof e=="string"?e:""+e).replace(I4,`
`).replace(D4,"")}function Gc(e,t,r){if(t=$g(t),$g(e)!==t&&r)throw Error(ge(425))}function Ju(){}var ih=null,oh=null;function lh(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var ch=typeof setTimeout=="function"?setTimeout:void 0,L4=typeof clearTimeout=="function"?clearTimeout:void 0,Vg=typeof Promise=="function"?Promise:void 0,M4=typeof queueMicrotask=="function"?queueMicrotask:typeof Vg<"u"?function(e){return Vg.resolve(null).then(e).catch(B4)}:ch;function B4(e){setTimeout(function(){throw e})}function U0(e,t){var r=t,s=0;do{var n=r.nextSibling;if(e.removeChild(r),n&&n.nodeType===8)if(r=n.data,r==="/$"){if(s===0){e.removeChild(n),Fl(t);return}s--}else r!=="$"&&r!=="$?"&&r!=="$!"||s++;r=n}while(r);Fl(t)}function Zn(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function zg(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var _o=Math.random().toString(36).slice(2),rn="__reactFiber$"+_o,Dl="__reactProps$"+_o,Nn="__reactContainer$"+_o,uh="__reactEvents$"+_o,U4="__reactListeners$"+_o,$4="__reactHandles$"+_o;function Pa(e){var t=e[rn];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Nn]||r[rn]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=zg(e);e!==null;){if(r=e[rn])return r;e=zg(e)}return t}e=r,r=e.parentNode}return null}function vc(e){return e=e[rn]||e[Nn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Ai(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ge(33))}function zd(e){return e[Dl]||null}var dh=[],Fi=-1;function ha(e){return{current:e}}function ht(e){0>Fi||(e.current=dh[Fi],dh[Fi]=null,Fi--)}function ct(e,t){Fi++,dh[Fi]=e.current,e.current=t}var aa={},Er=ha(aa),Hr=ha(!1),Ga=aa;function so(e,t){var r=e.type.contextTypes;if(!r)return aa;var s=e.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===t)return s.__reactInternalMemoizedMaskedChildContext;var n={},a;for(a in r)n[a]=t[a];return s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=n),n}function qr(e){return e=e.childContextTypes,e!=null}function Qu(){ht(Hr),ht(Er)}function Wg(e,t,r){if(Er.current!==aa)throw Error(ge(168));ct(Er,t),ct(Hr,r)}function I2(e,t,r){var s=e.stateNode;if(t=t.childContextTypes,typeof s.getChildContext!="function")return r;s=s.getChildContext();for(var n in s)if(!(n in t))throw Error(ge(108,EN(e)||"Unknown",n));return At({},r,s)}function Zu(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||aa,Ga=Er.current,ct(Er,e),ct(Hr,Hr.current),!0}function Hg(e,t,r){var s=e.stateNode;if(!s)throw Error(ge(169));r?(e=I2(e,t,Ga),s.__reactInternalMemoizedMergedChildContext=e,ht(Hr),ht(Er),ct(Er,e)):ht(Hr),ct(Hr,r)}var gn=null,Wd=!1,$0=!1;function D2(e){gn===null?gn=[e]:gn.push(e)}function V4(e){Wd=!0,D2(e)}function pa(){if(!$0&&gn!==null){$0=!0;var e=0,t=it;try{var r=gn;for(it=1;e<r.length;e++){var s=r[e];do s=s(!0);while(s!==null)}gn=null,Wd=!1}catch(n){throw gn!==null&&(gn=gn.slice(e+1)),o2(Up,pa),n}finally{it=t,$0=!1}}return null}var Pi=[],Ri=0,ed=null,td=0,Ss=[],ks=0,Ka=null,vn=1,yn="";function ka(e,t){Pi[Ri++]=td,Pi[Ri++]=ed,ed=e,td=t}function L2(e,t,r){Ss[ks++]=vn,Ss[ks++]=yn,Ss[ks++]=Ka,Ka=e;var s=vn;e=yn;var n=32-Hs(s)-1;s&=~(1<<n),r+=1;var a=32-Hs(t)+n;if(30<a){var i=n-n%5;a=(s&(1<<i)-1).toString(32),s>>=i,n-=i,vn=1<<32-Hs(t)+n|r<<n|s,yn=a+e}else vn=1<<a|r<<n|s,yn=e}function Xp(e){e.return!==null&&(ka(e,1),L2(e,1,0))}function Yp(e){for(;e===ed;)ed=Pi[--Ri],Pi[Ri]=null,td=Pi[--Ri],Pi[Ri]=null;for(;e===Ka;)Ka=Ss[--ks],Ss[ks]=null,yn=Ss[--ks],Ss[ks]=null,vn=Ss[--ks],Ss[ks]=null}var os=null,as=null,gt=!1,$s=null;function M2(e,t){var r=Es(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function qg(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,os=e,as=Zn(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,os=e,as=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Ka!==null?{id:vn,overflow:yn}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Es(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,os=e,as=null,!0):!1;default:return!1}}function fh(e){return(e.mode&1)!==0&&(e.flags&128)===0}function hh(e){if(gt){var t=as;if(t){var r=t;if(!qg(e,t)){if(fh(e))throw Error(ge(418));t=Zn(r.nextSibling);var s=os;t&&qg(e,t)?M2(s,r):(e.flags=e.flags&-4097|2,gt=!1,os=e)}}else{if(fh(e))throw Error(ge(418));e.flags=e.flags&-4097|2,gt=!1,os=e}}}function Gg(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;os=e}function Kc(e){if(e!==os)return!1;if(!gt)return Gg(e),gt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!lh(e.type,e.memoizedProps)),t&&(t=as)){if(fh(e))throw B2(),Error(ge(418));for(;t;)M2(e,t),t=Zn(t.nextSibling)}if(Gg(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ge(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){as=Zn(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}as=null}}else as=os?Zn(e.stateNode.nextSibling):null;return!0}function B2(){for(var e=as;e;)e=Zn(e.nextSibling)}function no(){as=os=null,gt=!1}function Jp(e){$s===null?$s=[e]:$s.push(e)}var z4=Rn.ReactCurrentBatchConfig;function Vo(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(ge(309));var s=r.stateNode}if(!s)throw Error(ge(147,e));var n=s,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(i){var o=n.refs;i===null?delete o[a]:o[a]=i},t._stringRef=a,t)}if(typeof e!="string")throw Error(ge(284));if(!r._owner)throw Error(ge(290,e))}return e}function Xc(e,t){throw e=Object.prototype.toString.call(t),Error(ge(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Kg(e){var t=e._init;return t(e._payload)}function U2(e){function t(y,w){if(e){var g=y.deletions;g===null?(y.deletions=[w],y.flags|=16):g.push(w)}}function r(y,w){if(!e)return null;for(;w!==null;)t(y,w),w=w.sibling;return null}function s(y,w){for(y=new Map;w!==null;)w.key!==null?y.set(w.key,w):y.set(w.index,w),w=w.sibling;return y}function n(y,w){return y=sa(y,w),y.index=0,y.sibling=null,y}function a(y,w,g){return y.index=g,e?(g=y.alternate,g!==null?(g=g.index,g<w?(y.flags|=2,w):g):(y.flags|=2,w)):(y.flags|=1048576,w)}function i(y){return e&&y.alternate===null&&(y.flags|=2),y}function o(y,w,g,_){return w===null||w.tag!==6?(w=K0(g,y.mode,_),w.return=y,w):(w=n(w,g),w.return=y,w)}function c(y,w,g,_){var b=g.type;return b===Ti?d(y,w,g.props.children,_,g.key):w!==null&&(w.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===$n&&Kg(b)===w.type)?(_=n(w,g.props),_.ref=Vo(y,w,g),_.return=y,_):(_=Du(g.type,g.key,g.props,null,y.mode,_),_.ref=Vo(y,w,g),_.return=y,_)}function u(y,w,g,_){return w===null||w.tag!==4||w.stateNode.containerInfo!==g.containerInfo||w.stateNode.implementation!==g.implementation?(w=X0(g,y.mode,_),w.return=y,w):(w=n(w,g.children||[]),w.return=y,w)}function d(y,w,g,_,b){return w===null||w.tag!==7?(w=Ua(g,y.mode,_,b),w.return=y,w):(w=n(w,g),w.return=y,w)}function f(y,w,g){if(typeof w=="string"&&w!==""||typeof w=="number")return w=K0(""+w,y.mode,g),w.return=y,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Mc:return g=Du(w.type,w.key,w.props,null,y.mode,g),g.ref=Vo(y,null,w),g.return=y,g;case Ei:return w=X0(w,y.mode,g),w.return=y,w;case $n:var _=w._init;return f(y,_(w._payload),g)}if(Ko(w)||Lo(w))return w=Ua(w,y.mode,g,null),w.return=y,w;Xc(y,w)}return null}function h(y,w,g,_){var b=w!==null?w.key:null;if(typeof g=="string"&&g!==""||typeof g=="number")return b!==null?null:o(y,w,""+g,_);if(typeof g=="object"&&g!==null){switch(g.$$typeof){case Mc:return g.key===b?c(y,w,g,_):null;case Ei:return g.key===b?u(y,w,g,_):null;case $n:return b=g._init,h(y,w,b(g._payload),_)}if(Ko(g)||Lo(g))return b!==null?null:d(y,w,g,_,null);Xc(y,g)}return null}function m(y,w,g,_,b){if(typeof _=="string"&&_!==""||typeof _=="number")return y=y.get(g)||null,o(w,y,""+_,b);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Mc:return y=y.get(_.key===null?g:_.key)||null,c(w,y,_,b);case Ei:return y=y.get(_.key===null?g:_.key)||null,u(w,y,_,b);case $n:var k=_._init;return m(y,w,g,k(_._payload),b)}if(Ko(_)||Lo(_))return y=y.get(g)||null,d(w,y,_,b,null);Xc(w,_)}return null}function p(y,w,g,_){for(var b=null,k=null,S=w,T=w=0,j=null;S!==null&&T<g.length;T++){S.index>T?(j=S,S=null):j=S.sibling;var U=h(y,S,g[T],_);if(U===null){S===null&&(S=j);break}e&&S&&U.alternate===null&&t(y,S),w=a(U,w,T),k===null?b=U:k.sibling=U,k=U,S=j}if(T===g.length)return r(y,S),gt&&ka(y,T),b;if(S===null){for(;T<g.length;T++)S=f(y,g[T],_),S!==null&&(w=a(S,w,T),k===null?b=S:k.sibling=S,k=S);return gt&&ka(y,T),b}for(S=s(y,S);T<g.length;T++)j=m(S,y,T,g[T],_),j!==null&&(e&&j.alternate!==null&&S.delete(j.key===null?T:j.key),w=a(j,w,T),k===null?b=j:k.sibling=j,k=j);return e&&S.forEach(function(H){return t(y,H)}),gt&&ka(y,T),b}function x(y,w,g,_){var b=Lo(g);if(typeof b!="function")throw Error(ge(150));if(g=b.call(g),g==null)throw Error(ge(151));for(var k=b=null,S=w,T=w=0,j=null,U=g.next();S!==null&&!U.done;T++,U=g.next()){S.index>T?(j=S,S=null):j=S.sibling;var H=h(y,S,U.value,_);if(H===null){S===null&&(S=j);break}e&&S&&H.alternate===null&&t(y,S),w=a(H,w,T),k===null?b=H:k.sibling=H,k=H,S=j}if(U.done)return r(y,S),gt&&ka(y,T),b;if(S===null){for(;!U.done;T++,U=g.next())U=f(y,U.value,_),U!==null&&(w=a(U,w,T),k===null?b=U:k.sibling=U,k=U);return gt&&ka(y,T),b}for(S=s(y,S);!U.done;T++,U=g.next())U=m(S,y,T,U.value,_),U!==null&&(e&&U.alternate!==null&&S.delete(U.key===null?T:U.key),w=a(U,w,T),k===null?b=U:k.sibling=U,k=U);return e&&S.forEach(function(z){return t(y,z)}),gt&&ka(y,T),b}function v(y,w,g,_){if(typeof g=="object"&&g!==null&&g.type===Ti&&g.key===null&&(g=g.props.children),typeof g=="object"&&g!==null){switch(g.$$typeof){case Mc:e:{for(var b=g.key,k=w;k!==null;){if(k.key===b){if(b=g.type,b===Ti){if(k.tag===7){r(y,k.sibling),w=n(k,g.props.children),w.return=y,y=w;break e}}else if(k.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===$n&&Kg(b)===k.type){r(y,k.sibling),w=n(k,g.props),w.ref=Vo(y,k,g),w.return=y,y=w;break e}r(y,k);break}else t(y,k);k=k.sibling}g.type===Ti?(w=Ua(g.props.children,y.mode,_,g.key),w.return=y,y=w):(_=Du(g.type,g.key,g.props,null,y.mode,_),_.ref=Vo(y,w,g),_.return=y,y=_)}return i(y);case Ei:e:{for(k=g.key;w!==null;){if(w.key===k)if(w.tag===4&&w.stateNode.containerInfo===g.containerInfo&&w.stateNode.implementation===g.implementation){r(y,w.sibling),w=n(w,g.children||[]),w.return=y,y=w;break e}else{r(y,w);break}else t(y,w);w=w.sibling}w=X0(g,y.mode,_),w.return=y,y=w}return i(y);case $n:return k=g._init,v(y,w,k(g._payload),_)}if(Ko(g))return p(y,w,g,_);if(Lo(g))return x(y,w,g,_);Xc(y,g)}return typeof g=="string"&&g!==""||typeof g=="number"?(g=""+g,w!==null&&w.tag===6?(r(y,w.sibling),w=n(w,g),w.return=y,y=w):(r(y,w),w=K0(g,y.mode,_),w.return=y,y=w),i(y)):r(y,w)}return v}var ao=U2(!0),$2=U2(!1),rd=ha(null),sd=null,Oi=null,Qp=null;function Zp(){Qp=Oi=sd=null}function em(e){var t=rd.current;ht(rd),e._currentValue=t}function ph(e,t,r){for(;e!==null;){var s=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,s!==null&&(s.childLanes|=t)):s!==null&&(s.childLanes&t)!==t&&(s.childLanes|=t),e===r)break;e=e.return}}function Gi(e,t){sd=e,Qp=Oi=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(zr=!0),e.firstContext=null)}function As(e){var t=e._currentValue;if(Qp!==e)if(e={context:e,memoizedValue:t,next:null},Oi===null){if(sd===null)throw Error(ge(308));Oi=e,sd.dependencies={lanes:0,firstContext:e}}else Oi=Oi.next=e;return t}var Ra=null;function tm(e){Ra===null?Ra=[e]:Ra.push(e)}function V2(e,t,r,s){var n=t.interleaved;return n===null?(r.next=r,tm(t)):(r.next=n.next,n.next=r),t.interleaved=r,jn(e,s)}function jn(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Vn=!1;function rm(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function z2(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function bn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ea(e,t,r){var s=e.updateQueue;if(s===null)return null;if(s=s.shared,Qe&2){var n=s.pending;return n===null?t.next=t:(t.next=n.next,n.next=t),s.pending=t,jn(e,r)}return n=s.interleaved,n===null?(t.next=t,tm(s)):(t.next=n.next,n.next=t),s.interleaved=t,jn(e,r)}function Au(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var s=t.lanes;s&=e.pendingLanes,r|=s,t.lanes=r,$p(e,r)}}function Xg(e,t){var r=e.updateQueue,s=e.alternate;if(s!==null&&(s=s.updateQueue,r===s)){var n=null,a=null;if(r=r.firstBaseUpdate,r!==null){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};a===null?n=a=i:a=a.next=i,r=r.next}while(r!==null);a===null?n=a=t:a=a.next=t}else n=a=t;r={baseState:s.baseState,firstBaseUpdate:n,lastBaseUpdate:a,shared:s.shared,effects:s.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function nd(e,t,r,s){var n=e.updateQueue;Vn=!1;var a=n.firstBaseUpdate,i=n.lastBaseUpdate,o=n.shared.pending;if(o!==null){n.shared.pending=null;var c=o,u=c.next;c.next=null,i===null?a=u:i.next=u,i=c;var d=e.alternate;d!==null&&(d=d.updateQueue,o=d.lastBaseUpdate,o!==i&&(o===null?d.firstBaseUpdate=u:o.next=u,d.lastBaseUpdate=c))}if(a!==null){var f=n.baseState;i=0,d=u=c=null,o=a;do{var h=o.lane,m=o.eventTime;if((s&h)===h){d!==null&&(d=d.next={eventTime:m,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var p=e,x=o;switch(h=t,m=r,x.tag){case 1:if(p=x.payload,typeof p=="function"){f=p.call(m,f,h);break e}f=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=x.payload,h=typeof p=="function"?p.call(m,f,h):p,h==null)break e;f=At({},f,h);break e;case 2:Vn=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,h=n.effects,h===null?n.effects=[o]:h.push(o))}else m={eventTime:m,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},d===null?(u=d=m,c=f):d=d.next=m,i|=h;if(o=o.next,o===null){if(o=n.shared.pending,o===null)break;h=o,o=h.next,h.next=null,n.lastBaseUpdate=h,n.shared.pending=null}}while(!0);if(d===null&&(c=f),n.baseState=c,n.firstBaseUpdate=u,n.lastBaseUpdate=d,t=n.shared.interleaved,t!==null){n=t;do i|=n.lane,n=n.next;while(n!==t)}else a===null&&(n.shared.lanes=0);Ya|=i,e.lanes=i,e.memoizedState=f}}function Yg(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var s=e[t],n=s.callback;if(n!==null){if(s.callback=null,s=r,typeof n!="function")throw Error(ge(191,n));n.call(s)}}}var yc={},an=ha(yc),Ll=ha(yc),Ml=ha(yc);function Oa(e){if(e===yc)throw Error(ge(174));return e}function sm(e,t){switch(ct(Ml,t),ct(Ll,e),ct(an,yc),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Kf(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Kf(t,e)}ht(an),ct(an,t)}function io(){ht(an),ht(Ll),ht(Ml)}function W2(e){Oa(Ml.current);var t=Oa(an.current),r=Kf(t,e.type);t!==r&&(ct(Ll,e),ct(an,r))}function nm(e){Ll.current===e&&(ht(an),ht(Ll))}var Et=ha(0);function ad(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var V0=[];function am(){for(var e=0;e<V0.length;e++)V0[e]._workInProgressVersionPrimary=null;V0.length=0}var Fu=Rn.ReactCurrentDispatcher,z0=Rn.ReactCurrentBatchConfig,Xa=0,Ct=null,Yt=null,tr=null,id=!1,ol=!1,Bl=0,W4=0;function mr(){throw Error(ge(321))}function im(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Xs(e[r],t[r]))return!1;return!0}function om(e,t,r,s,n,a){if(Xa=a,Ct=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Fu.current=e===null||e.memoizedState===null?K4:X4,e=r(s,n),ol){a=0;do{if(ol=!1,Bl=0,25<=a)throw Error(ge(301));a+=1,tr=Yt=null,t.updateQueue=null,Fu.current=Y4,e=r(s,n)}while(ol)}if(Fu.current=od,t=Yt!==null&&Yt.next!==null,Xa=0,tr=Yt=Ct=null,id=!1,t)throw Error(ge(300));return e}function lm(){var e=Bl!==0;return Bl=0,e}function tn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return tr===null?Ct.memoizedState=tr=e:tr=tr.next=e,tr}function Fs(){if(Yt===null){var e=Ct.alternate;e=e!==null?e.memoizedState:null}else e=Yt.next;var t=tr===null?Ct.memoizedState:tr.next;if(t!==null)tr=t,Yt=e;else{if(e===null)throw Error(ge(310));Yt=e,e={memoizedState:Yt.memoizedState,baseState:Yt.baseState,baseQueue:Yt.baseQueue,queue:Yt.queue,next:null},tr===null?Ct.memoizedState=tr=e:tr=tr.next=e}return tr}function Ul(e,t){return typeof t=="function"?t(e):t}function W0(e){var t=Fs(),r=t.queue;if(r===null)throw Error(ge(311));r.lastRenderedReducer=e;var s=Yt,n=s.baseQueue,a=r.pending;if(a!==null){if(n!==null){var i=n.next;n.next=a.next,a.next=i}s.baseQueue=n=a,r.pending=null}if(n!==null){a=n.next,s=s.baseState;var o=i=null,c=null,u=a;do{var d=u.lane;if((Xa&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),s=u.hasEagerState?u.eagerState:e(s,u.action);else{var f={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(o=c=f,i=s):c=c.next=f,Ct.lanes|=d,Ya|=d}u=u.next}while(u!==null&&u!==a);c===null?i=s:c.next=o,Xs(s,t.memoizedState)||(zr=!0),t.memoizedState=s,t.baseState=i,t.baseQueue=c,r.lastRenderedState=s}if(e=r.interleaved,e!==null){n=e;do a=n.lane,Ct.lanes|=a,Ya|=a,n=n.next;while(n!==e)}else n===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function H0(e){var t=Fs(),r=t.queue;if(r===null)throw Error(ge(311));r.lastRenderedReducer=e;var s=r.dispatch,n=r.pending,a=t.memoizedState;if(n!==null){r.pending=null;var i=n=n.next;do a=e(a,i.action),i=i.next;while(i!==n);Xs(a,t.memoizedState)||(zr=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),r.lastRenderedState=a}return[a,s]}function H2(){}function q2(e,t){var r=Ct,s=Fs(),n=t(),a=!Xs(s.memoizedState,n);if(a&&(s.memoizedState=n,zr=!0),s=s.queue,cm(X2.bind(null,r,s,e),[e]),s.getSnapshot!==t||a||tr!==null&&tr.memoizedState.tag&1){if(r.flags|=2048,$l(9,K2.bind(null,r,s,n,t),void 0,null),nr===null)throw Error(ge(349));Xa&30||G2(r,t,n)}return n}function G2(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Ct.updateQueue,t===null?(t={lastEffect:null,stores:null},Ct.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function K2(e,t,r,s){t.value=r,t.getSnapshot=s,Y2(t)&&J2(e)}function X2(e,t,r){return r(function(){Y2(t)&&J2(e)})}function Y2(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Xs(e,r)}catch{return!0}}function J2(e){var t=jn(e,1);t!==null&&qs(t,e,1,-1)}function Jg(e){var t=tn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ul,lastRenderedState:e},t.queue=e,e=e.dispatch=G4.bind(null,Ct,e),[t.memoizedState,e]}function $l(e,t,r,s){return e={tag:e,create:t,destroy:r,deps:s,next:null},t=Ct.updateQueue,t===null?(t={lastEffect:null,stores:null},Ct.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(s=r.next,r.next=e,e.next=s,t.lastEffect=e)),e}function Q2(){return Fs().memoizedState}function Pu(e,t,r,s){var n=tn();Ct.flags|=e,n.memoizedState=$l(1|t,r,void 0,s===void 0?null:s)}function Hd(e,t,r,s){var n=Fs();s=s===void 0?null:s;var a=void 0;if(Yt!==null){var i=Yt.memoizedState;if(a=i.destroy,s!==null&&im(s,i.deps)){n.memoizedState=$l(t,r,a,s);return}}Ct.flags|=e,n.memoizedState=$l(1|t,r,a,s)}function Qg(e,t){return Pu(8390656,8,e,t)}function cm(e,t){return Hd(2048,8,e,t)}function Z2(e,t){return Hd(4,2,e,t)}function e_(e,t){return Hd(4,4,e,t)}function t_(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function r_(e,t,r){return r=r!=null?r.concat([e]):null,Hd(4,4,t_.bind(null,t,e),r)}function um(){}function s_(e,t){var r=Fs();t=t===void 0?null:t;var s=r.memoizedState;return s!==null&&t!==null&&im(t,s[1])?s[0]:(r.memoizedState=[e,t],e)}function n_(e,t){var r=Fs();t=t===void 0?null:t;var s=r.memoizedState;return s!==null&&t!==null&&im(t,s[1])?s[0]:(e=e(),r.memoizedState=[e,t],e)}function a_(e,t,r){return Xa&21?(Xs(r,t)||(r=u2(),Ct.lanes|=r,Ya|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,zr=!0),e.memoizedState=r)}function H4(e,t){var r=it;it=r!==0&&4>r?r:4,e(!0);var s=z0.transition;z0.transition={};try{e(!1),t()}finally{it=r,z0.transition=s}}function i_(){return Fs().memoizedState}function q4(e,t,r){var s=ra(e);if(r={lane:s,action:r,hasEagerState:!1,eagerState:null,next:null},o_(e))l_(t,r);else if(r=V2(e,t,r,s),r!==null){var n=Ir();qs(r,e,s,n),c_(r,t,s)}}function G4(e,t,r){var s=ra(e),n={lane:s,action:r,hasEagerState:!1,eagerState:null,next:null};if(o_(e))l_(t,n);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var i=t.lastRenderedState,o=a(i,r);if(n.hasEagerState=!0,n.eagerState=o,Xs(o,i)){var c=t.interleaved;c===null?(n.next=n,tm(t)):(n.next=c.next,c.next=n),t.interleaved=n;return}}catch{}finally{}r=V2(e,t,n,s),r!==null&&(n=Ir(),qs(r,e,s,n),c_(r,t,s))}}function o_(e){var t=e.alternate;return e===Ct||t!==null&&t===Ct}function l_(e,t){ol=id=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function c_(e,t,r){if(r&4194240){var s=t.lanes;s&=e.pendingLanes,r|=s,t.lanes=r,$p(e,r)}}var od={readContext:As,useCallback:mr,useContext:mr,useEffect:mr,useImperativeHandle:mr,useInsertionEffect:mr,useLayoutEffect:mr,useMemo:mr,useReducer:mr,useRef:mr,useState:mr,useDebugValue:mr,useDeferredValue:mr,useTransition:mr,useMutableSource:mr,useSyncExternalStore:mr,useId:mr,unstable_isNewReconciler:!1},K4={readContext:As,useCallback:function(e,t){return tn().memoizedState=[e,t===void 0?null:t],e},useContext:As,useEffect:Qg,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Pu(4194308,4,t_.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Pu(4194308,4,e,t)},useInsertionEffect:function(e,t){return Pu(4,2,e,t)},useMemo:function(e,t){var r=tn();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var s=tn();return t=r!==void 0?r(t):t,s.memoizedState=s.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},s.queue=e,e=e.dispatch=q4.bind(null,Ct,e),[s.memoizedState,e]},useRef:function(e){var t=tn();return e={current:e},t.memoizedState=e},useState:Jg,useDebugValue:um,useDeferredValue:function(e){return tn().memoizedState=e},useTransition:function(){var e=Jg(!1),t=e[0];return e=H4.bind(null,e[1]),tn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var s=Ct,n=tn();if(gt){if(r===void 0)throw Error(ge(407));r=r()}else{if(r=t(),nr===null)throw Error(ge(349));Xa&30||G2(s,t,r)}n.memoizedState=r;var a={value:r,getSnapshot:t};return n.queue=a,Qg(X2.bind(null,s,a,e),[e]),s.flags|=2048,$l(9,K2.bind(null,s,a,r,t),void 0,null),r},useId:function(){var e=tn(),t=nr.identifierPrefix;if(gt){var r=yn,s=vn;r=(s&~(1<<32-Hs(s)-1)).toString(32)+r,t=":"+t+"R"+r,r=Bl++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=W4++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},X4={readContext:As,useCallback:s_,useContext:As,useEffect:cm,useImperativeHandle:r_,useInsertionEffect:Z2,useLayoutEffect:e_,useMemo:n_,useReducer:W0,useRef:Q2,useState:function(){return W0(Ul)},useDebugValue:um,useDeferredValue:function(e){var t=Fs();return a_(t,Yt.memoizedState,e)},useTransition:function(){var e=W0(Ul)[0],t=Fs().memoizedState;return[e,t]},useMutableSource:H2,useSyncExternalStore:q2,useId:i_,unstable_isNewReconciler:!1},Y4={readContext:As,useCallback:s_,useContext:As,useEffect:cm,useImperativeHandle:r_,useInsertionEffect:Z2,useLayoutEffect:e_,useMemo:n_,useReducer:H0,useRef:Q2,useState:function(){return H0(Ul)},useDebugValue:um,useDeferredValue:function(e){var t=Fs();return Yt===null?t.memoizedState=e:a_(t,Yt.memoizedState,e)},useTransition:function(){var e=H0(Ul)[0],t=Fs().memoizedState;return[e,t]},useMutableSource:H2,useSyncExternalStore:q2,useId:i_,unstable_isNewReconciler:!1};function Ms(e,t){if(e&&e.defaultProps){t=At({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function mh(e,t,r,s){t=e.memoizedState,r=r(s,t),r=r==null?t:At({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var qd={isMounted:function(e){return(e=e._reactInternals)?ai(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var s=Ir(),n=ra(e),a=bn(s,n);a.payload=t,r!=null&&(a.callback=r),t=ea(e,a,n),t!==null&&(qs(t,e,n,s),Au(t,e,n))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var s=Ir(),n=ra(e),a=bn(s,n);a.tag=1,a.payload=t,r!=null&&(a.callback=r),t=ea(e,a,n),t!==null&&(qs(t,e,n,s),Au(t,e,n))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Ir(),s=ra(e),n=bn(r,s);n.tag=2,t!=null&&(n.callback=t),t=ea(e,n,s),t!==null&&(qs(t,e,s,r),Au(t,e,s))}};function Zg(e,t,r,s,n,a,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(s,a,i):t.prototype&&t.prototype.isPureReactComponent?!Rl(r,s)||!Rl(n,a):!0}function u_(e,t,r){var s=!1,n=aa,a=t.contextType;return typeof a=="object"&&a!==null?a=As(a):(n=qr(t)?Ga:Er.current,s=t.contextTypes,a=(s=s!=null)?so(e,n):aa),t=new t(r,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=qd,e.stateNode=t,t._reactInternals=e,s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=n,e.__reactInternalMemoizedMaskedChildContext=a),t}function e1(e,t,r,s){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,s),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,s),t.state!==e&&qd.enqueueReplaceState(t,t.state,null)}function xh(e,t,r,s){var n=e.stateNode;n.props=r,n.state=e.memoizedState,n.refs={},rm(e);var a=t.contextType;typeof a=="object"&&a!==null?n.context=As(a):(a=qr(t)?Ga:Er.current,n.context=so(e,a)),n.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(mh(e,t,a,r),n.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof n.getSnapshotBeforeUpdate=="function"||typeof n.UNSAFE_componentWillMount!="function"&&typeof n.componentWillMount!="function"||(t=n.state,typeof n.componentWillMount=="function"&&n.componentWillMount(),typeof n.UNSAFE_componentWillMount=="function"&&n.UNSAFE_componentWillMount(),t!==n.state&&qd.enqueueReplaceState(n,n.state,null),nd(e,r,n,s),n.state=e.memoizedState),typeof n.componentDidMount=="function"&&(e.flags|=4194308)}function oo(e,t){try{var r="",s=t;do r+=kN(s),s=s.return;while(s);var n=r}catch(a){n=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:n,digest:null}}function q0(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function gh(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var J4=typeof WeakMap=="function"?WeakMap:Map;function d_(e,t,r){r=bn(-1,r),r.tag=3,r.payload={element:null};var s=t.value;return r.callback=function(){cd||(cd=!0,Nh=s),gh(e,t)},r}function f_(e,t,r){r=bn(-1,r),r.tag=3;var s=e.type.getDerivedStateFromError;if(typeof s=="function"){var n=t.value;r.payload=function(){return s(n)},r.callback=function(){gh(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(r.callback=function(){gh(e,t),typeof s!="function"&&(ta===null?ta=new Set([this]):ta.add(this));var i=t.stack;this.componentDidCatch(t.value,{componentStack:i!==null?i:""})}),r}function t1(e,t,r){var s=e.pingCache;if(s===null){s=e.pingCache=new J4;var n=new Set;s.set(t,n)}else n=s.get(t),n===void 0&&(n=new Set,s.set(t,n));n.has(r)||(n.add(r),e=dj.bind(null,e,t,r),t.then(e,e))}function r1(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function s1(e,t,r,s,n){return e.mode&1?(e.flags|=65536,e.lanes=n,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=bn(-1,1),t.tag=2,ea(r,t,1))),r.lanes|=1),e)}var Q4=Rn.ReactCurrentOwner,zr=!1;function Ar(e,t,r,s){t.child=e===null?$2(t,null,r,s):ao(t,e.child,r,s)}function n1(e,t,r,s,n){r=r.render;var a=t.ref;return Gi(t,n),s=om(e,t,r,s,a,n),r=lm(),e!==null&&!zr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n,Cn(e,t,n)):(gt&&r&&Xp(t),t.flags|=1,Ar(e,t,s,n),t.child)}function a1(e,t,r,s,n){if(e===null){var a=r.type;return typeof a=="function"&&!vm(a)&&a.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=a,h_(e,t,a,s,n)):(e=Du(r.type,null,s,t,t.mode,n),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!(e.lanes&n)){var i=a.memoizedProps;if(r=r.compare,r=r!==null?r:Rl,r(i,s)&&e.ref===t.ref)return Cn(e,t,n)}return t.flags|=1,e=sa(a,s),e.ref=t.ref,e.return=t,t.child=e}function h_(e,t,r,s,n){if(e!==null){var a=e.memoizedProps;if(Rl(a,s)&&e.ref===t.ref)if(zr=!1,t.pendingProps=s=a,(e.lanes&n)!==0)e.flags&131072&&(zr=!0);else return t.lanes=e.lanes,Cn(e,t,n)}return vh(e,t,r,s,n)}function p_(e,t,r){var s=t.pendingProps,n=s.children,a=e!==null?e.memoizedState:null;if(s.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},ct(Di,Qr),Qr|=r;else{if(!(r&1073741824))return e=a!==null?a.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,ct(Di,Qr),Qr|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=a!==null?a.baseLanes:r,ct(Di,Qr),Qr|=s}else a!==null?(s=a.baseLanes|r,t.memoizedState=null):s=r,ct(Di,Qr),Qr|=s;return Ar(e,t,n,r),t.child}function m_(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function vh(e,t,r,s,n){var a=qr(r)?Ga:Er.current;return a=so(t,a),Gi(t,n),r=om(e,t,r,s,a,n),s=lm(),e!==null&&!zr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n,Cn(e,t,n)):(gt&&s&&Xp(t),t.flags|=1,Ar(e,t,r,n),t.child)}function i1(e,t,r,s,n){if(qr(r)){var a=!0;Zu(t)}else a=!1;if(Gi(t,n),t.stateNode===null)Ru(e,t),u_(t,r,s),xh(t,r,s,n),s=!0;else if(e===null){var i=t.stateNode,o=t.memoizedProps;i.props=o;var c=i.context,u=r.contextType;typeof u=="object"&&u!==null?u=As(u):(u=qr(r)?Ga:Er.current,u=so(t,u));var d=r.getDerivedStateFromProps,f=typeof d=="function"||typeof i.getSnapshotBeforeUpdate=="function";f||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==s||c!==u)&&e1(t,i,s,u),Vn=!1;var h=t.memoizedState;i.state=h,nd(t,s,i,n),c=t.memoizedState,o!==s||h!==c||Hr.current||Vn?(typeof d=="function"&&(mh(t,r,d,s),c=t.memoizedState),(o=Vn||Zg(t,r,o,s,h,c,u))?(f||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=s,t.memoizedState=c),i.props=s,i.state=c,i.context=u,s=o):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),s=!1)}else{i=t.stateNode,z2(e,t),o=t.memoizedProps,u=t.type===t.elementType?o:Ms(t.type,o),i.props=u,f=t.pendingProps,h=i.context,c=r.contextType,typeof c=="object"&&c!==null?c=As(c):(c=qr(r)?Ga:Er.current,c=so(t,c));var m=r.getDerivedStateFromProps;(d=typeof m=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==f||h!==c)&&e1(t,i,s,c),Vn=!1,h=t.memoizedState,i.state=h,nd(t,s,i,n);var p=t.memoizedState;o!==f||h!==p||Hr.current||Vn?(typeof m=="function"&&(mh(t,r,m,s),p=t.memoizedState),(u=Vn||Zg(t,r,u,s,h,p,c)||!1)?(d||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(s,p,c),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(s,p,c)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=s,t.memoizedState=p),i.props=s,i.state=p,i.context=c,s=u):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),s=!1)}return yh(e,t,r,s,a,n)}function yh(e,t,r,s,n,a){m_(e,t);var i=(t.flags&128)!==0;if(!s&&!i)return n&&Hg(t,r,!1),Cn(e,t,a);s=t.stateNode,Q4.current=t;var o=i&&typeof r.getDerivedStateFromError!="function"?null:s.render();return t.flags|=1,e!==null&&i?(t.child=ao(t,e.child,null,a),t.child=ao(t,null,o,a)):Ar(e,t,o,a),t.memoizedState=s.state,n&&Hg(t,r,!0),t.child}function x_(e){var t=e.stateNode;t.pendingContext?Wg(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Wg(e,t.context,!1),sm(e,t.containerInfo)}function o1(e,t,r,s,n){return no(),Jp(n),t.flags|=256,Ar(e,t,r,s),t.child}var wh={dehydrated:null,treeContext:null,retryLane:0};function _h(e){return{baseLanes:e,cachePool:null,transitions:null}}function g_(e,t,r){var s=t.pendingProps,n=Et.current,a=!1,i=(t.flags&128)!==0,o;if((o=i)||(o=e!==null&&e.memoizedState===null?!1:(n&2)!==0),o?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(n|=1),ct(Et,n&1),e===null)return hh(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(i=s.children,e=s.fallback,a?(s=t.mode,a=t.child,i={mode:"hidden",children:i},!(s&1)&&a!==null?(a.childLanes=0,a.pendingProps=i):a=Xd(i,s,0,null),e=Ua(e,s,r,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=_h(r),t.memoizedState=wh,e):dm(t,i));if(n=e.memoizedState,n!==null&&(o=n.dehydrated,o!==null))return Z4(e,t,i,s,o,n,r);if(a){a=s.fallback,i=t.mode,n=e.child,o=n.sibling;var c={mode:"hidden",children:s.children};return!(i&1)&&t.child!==n?(s=t.child,s.childLanes=0,s.pendingProps=c,t.deletions=null):(s=sa(n,c),s.subtreeFlags=n.subtreeFlags&14680064),o!==null?a=sa(o,a):(a=Ua(a,i,r,null),a.flags|=2),a.return=t,s.return=t,s.sibling=a,t.child=s,s=a,a=t.child,i=e.child.memoizedState,i=i===null?_h(r):{baseLanes:i.baseLanes|r,cachePool:null,transitions:i.transitions},a.memoizedState=i,a.childLanes=e.childLanes&~r,t.memoizedState=wh,s}return a=e.child,e=a.sibling,s=sa(a,{mode:"visible",children:s.children}),!(t.mode&1)&&(s.lanes=r),s.return=t,s.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=s,t.memoizedState=null,s}function dm(e,t){return t=Xd({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Yc(e,t,r,s){return s!==null&&Jp(s),ao(t,e.child,null,r),e=dm(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Z4(e,t,r,s,n,a,i){if(r)return t.flags&256?(t.flags&=-257,s=q0(Error(ge(422))),Yc(e,t,i,s)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=s.fallback,n=t.mode,s=Xd({mode:"visible",children:s.children},n,0,null),a=Ua(a,n,i,null),a.flags|=2,s.return=t,a.return=t,s.sibling=a,t.child=s,t.mode&1&&ao(t,e.child,null,i),t.child.memoizedState=_h(i),t.memoizedState=wh,a);if(!(t.mode&1))return Yc(e,t,i,null);if(n.data==="$!"){if(s=n.nextSibling&&n.nextSibling.dataset,s)var o=s.dgst;return s=o,a=Error(ge(419)),s=q0(a,s,void 0),Yc(e,t,i,s)}if(o=(i&e.childLanes)!==0,zr||o){if(s=nr,s!==null){switch(i&-i){case 4:n=2;break;case 16:n=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:n=32;break;case 536870912:n=268435456;break;default:n=0}n=n&(s.suspendedLanes|i)?0:n,n!==0&&n!==a.retryLane&&(a.retryLane=n,jn(e,n),qs(s,e,n,-1))}return gm(),s=q0(Error(ge(421))),Yc(e,t,i,s)}return n.data==="$?"?(t.flags|=128,t.child=e.child,t=fj.bind(null,e),n._reactRetry=t,null):(e=a.treeContext,as=Zn(n.nextSibling),os=t,gt=!0,$s=null,e!==null&&(Ss[ks++]=vn,Ss[ks++]=yn,Ss[ks++]=Ka,vn=e.id,yn=e.overflow,Ka=t),t=dm(t,s.children),t.flags|=4096,t)}function l1(e,t,r){e.lanes|=t;var s=e.alternate;s!==null&&(s.lanes|=t),ph(e.return,t,r)}function G0(e,t,r,s,n){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:s,tail:r,tailMode:n}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=s,a.tail=r,a.tailMode=n)}function v_(e,t,r){var s=t.pendingProps,n=s.revealOrder,a=s.tail;if(Ar(e,t,s.children,r),s=Et.current,s&2)s=s&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&l1(e,r,t);else if(e.tag===19)l1(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}s&=1}if(ct(Et,s),!(t.mode&1))t.memoizedState=null;else switch(n){case"forwards":for(r=t.child,n=null;r!==null;)e=r.alternate,e!==null&&ad(e)===null&&(n=r),r=r.sibling;r=n,r===null?(n=t.child,t.child=null):(n=r.sibling,r.sibling=null),G0(t,!1,n,r,a);break;case"backwards":for(r=null,n=t.child,t.child=null;n!==null;){if(e=n.alternate,e!==null&&ad(e)===null){t.child=n;break}e=n.sibling,n.sibling=r,r=n,n=e}G0(t,!0,r,null,a);break;case"together":G0(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ru(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Cn(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Ya|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(ge(153));if(t.child!==null){for(e=t.child,r=sa(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=sa(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function ej(e,t,r){switch(t.tag){case 3:x_(t),no();break;case 5:W2(t);break;case 1:qr(t.type)&&Zu(t);break;case 4:sm(t,t.stateNode.containerInfo);break;case 10:var s=t.type._context,n=t.memoizedProps.value;ct(rd,s._currentValue),s._currentValue=n;break;case 13:if(s=t.memoizedState,s!==null)return s.dehydrated!==null?(ct(Et,Et.current&1),t.flags|=128,null):r&t.child.childLanes?g_(e,t,r):(ct(Et,Et.current&1),e=Cn(e,t,r),e!==null?e.sibling:null);ct(Et,Et.current&1);break;case 19:if(s=(r&t.childLanes)!==0,e.flags&128){if(s)return v_(e,t,r);t.flags|=128}if(n=t.memoizedState,n!==null&&(n.rendering=null,n.tail=null,n.lastEffect=null),ct(Et,Et.current),s)break;return null;case 22:case 23:return t.lanes=0,p_(e,t,r)}return Cn(e,t,r)}var y_,bh,w_,__;y_=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};bh=function(){};w_=function(e,t,r,s){var n=e.memoizedProps;if(n!==s){e=t.stateNode,Oa(an.current);var a=null;switch(r){case"input":n=Wf(e,n),s=Wf(e,s),a=[];break;case"select":n=At({},n,{value:void 0}),s=At({},s,{value:void 0}),a=[];break;case"textarea":n=Gf(e,n),s=Gf(e,s),a=[];break;default:typeof n.onClick!="function"&&typeof s.onClick=="function"&&(e.onclick=Ju)}Xf(r,s);var i;r=null;for(u in n)if(!s.hasOwnProperty(u)&&n.hasOwnProperty(u)&&n[u]!=null)if(u==="style"){var o=n[u];for(i in o)o.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Tl.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in s){var c=s[u];if(o=n!=null?n[u]:void 0,s.hasOwnProperty(u)&&c!==o&&(c!=null||o!=null))if(u==="style")if(o){for(i in o)!o.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in c)c.hasOwnProperty(i)&&o[i]!==c[i]&&(r||(r={}),r[i]=c[i])}else r||(a||(a=[]),a.push(u,r)),r=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,o=o?o.__html:void 0,c!=null&&o!==c&&(a=a||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(a=a||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Tl.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&ut("scroll",e),a||o===c||(a=[])):(a=a||[]).push(u,c))}r&&(a=a||[]).push("style",r);var u=a;(t.updateQueue=u)&&(t.flags|=4)}};__=function(e,t,r,s){r!==s&&(t.flags|=4)};function zo(e,t){if(!gt)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var s=null;r!==null;)r.alternate!==null&&(s=r),r=r.sibling;s===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:s.sibling=null}}function xr(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,s=0;if(t)for(var n=e.child;n!==null;)r|=n.lanes|n.childLanes,s|=n.subtreeFlags&14680064,s|=n.flags&14680064,n.return=e,n=n.sibling;else for(n=e.child;n!==null;)r|=n.lanes|n.childLanes,s|=n.subtreeFlags,s|=n.flags,n.return=e,n=n.sibling;return e.subtreeFlags|=s,e.childLanes=r,t}function tj(e,t,r){var s=t.pendingProps;switch(Yp(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return xr(t),null;case 1:return qr(t.type)&&Qu(),xr(t),null;case 3:return s=t.stateNode,io(),ht(Hr),ht(Er),am(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(e===null||e.child===null)&&(Kc(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,$s!==null&&(Ah($s),$s=null))),bh(e,t),xr(t),null;case 5:nm(t);var n=Oa(Ml.current);if(r=t.type,e!==null&&t.stateNode!=null)w_(e,t,r,s,n),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!s){if(t.stateNode===null)throw Error(ge(166));return xr(t),null}if(e=Oa(an.current),Kc(t)){s=t.stateNode,r=t.type;var a=t.memoizedProps;switch(s[rn]=t,s[Dl]=a,e=(t.mode&1)!==0,r){case"dialog":ut("cancel",s),ut("close",s);break;case"iframe":case"object":case"embed":ut("load",s);break;case"video":case"audio":for(n=0;n<Yo.length;n++)ut(Yo[n],s);break;case"source":ut("error",s);break;case"img":case"image":case"link":ut("error",s),ut("load",s);break;case"details":ut("toggle",s);break;case"input":gg(s,a),ut("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!a.multiple},ut("invalid",s);break;case"textarea":yg(s,a),ut("invalid",s)}Xf(r,a),n=null;for(var i in a)if(a.hasOwnProperty(i)){var o=a[i];i==="children"?typeof o=="string"?s.textContent!==o&&(a.suppressHydrationWarning!==!0&&Gc(s.textContent,o,e),n=["children",o]):typeof o=="number"&&s.textContent!==""+o&&(a.suppressHydrationWarning!==!0&&Gc(s.textContent,o,e),n=["children",""+o]):Tl.hasOwnProperty(i)&&o!=null&&i==="onScroll"&&ut("scroll",s)}switch(r){case"input":Bc(s),vg(s,a,!0);break;case"textarea":Bc(s),wg(s);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(s.onclick=Ju)}s=n,t.updateQueue=s,s!==null&&(t.flags|=4)}else{i=n.nodeType===9?n:n.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Xw(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof s.is=="string"?e=i.createElement(r,{is:s.is}):(e=i.createElement(r),r==="select"&&(i=e,s.multiple?i.multiple=!0:s.size&&(i.size=s.size))):e=i.createElementNS(e,r),e[rn]=t,e[Dl]=s,y_(e,t,!1,!1),t.stateNode=e;e:{switch(i=Yf(r,s),r){case"dialog":ut("cancel",e),ut("close",e),n=s;break;case"iframe":case"object":case"embed":ut("load",e),n=s;break;case"video":case"audio":for(n=0;n<Yo.length;n++)ut(Yo[n],e);n=s;break;case"source":ut("error",e),n=s;break;case"img":case"image":case"link":ut("error",e),ut("load",e),n=s;break;case"details":ut("toggle",e),n=s;break;case"input":gg(e,s),n=Wf(e,s),ut("invalid",e);break;case"option":n=s;break;case"select":e._wrapperState={wasMultiple:!!s.multiple},n=At({},s,{value:void 0}),ut("invalid",e);break;case"textarea":yg(e,s),n=Gf(e,s),ut("invalid",e);break;default:n=s}Xf(r,n),o=n;for(a in o)if(o.hasOwnProperty(a)){var c=o[a];a==="style"?Qw(e,c):a==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&Yw(e,c)):a==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&Nl(e,c):typeof c=="number"&&Nl(e,""+c):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(Tl.hasOwnProperty(a)?c!=null&&a==="onScroll"&&ut("scroll",e):c!=null&&Ip(e,a,c,i))}switch(r){case"input":Bc(e),vg(e,s,!1);break;case"textarea":Bc(e),wg(e);break;case"option":s.value!=null&&e.setAttribute("value",""+na(s.value));break;case"select":e.multiple=!!s.multiple,a=s.value,a!=null?zi(e,!!s.multiple,a,!1):s.defaultValue!=null&&zi(e,!!s.multiple,s.defaultValue,!0);break;default:typeof n.onClick=="function"&&(e.onclick=Ju)}switch(r){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return xr(t),null;case 6:if(e&&t.stateNode!=null)__(e,t,e.memoizedProps,s);else{if(typeof s!="string"&&t.stateNode===null)throw Error(ge(166));if(r=Oa(Ml.current),Oa(an.current),Kc(t)){if(s=t.stateNode,r=t.memoizedProps,s[rn]=t,(a=s.nodeValue!==r)&&(e=os,e!==null))switch(e.tag){case 3:Gc(s.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Gc(s.nodeValue,r,(e.mode&1)!==0)}a&&(t.flags|=4)}else s=(r.nodeType===9?r:r.ownerDocument).createTextNode(s),s[rn]=t,t.stateNode=s}return xr(t),null;case 13:if(ht(Et),s=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(gt&&as!==null&&t.mode&1&&!(t.flags&128))B2(),no(),t.flags|=98560,a=!1;else if(a=Kc(t),s!==null&&s.dehydrated!==null){if(e===null){if(!a)throw Error(ge(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(ge(317));a[rn]=t}else no(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;xr(t),a=!1}else $s!==null&&(Ah($s),$s=null),a=!0;if(!a)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(s=s!==null,s!==(e!==null&&e.memoizedState!==null)&&s&&(t.child.flags|=8192,t.mode&1&&(e===null||Et.current&1?Qt===0&&(Qt=3):gm())),t.updateQueue!==null&&(t.flags|=4),xr(t),null);case 4:return io(),bh(e,t),e===null&&Ol(t.stateNode.containerInfo),xr(t),null;case 10:return em(t.type._context),xr(t),null;case 17:return qr(t.type)&&Qu(),xr(t),null;case 19:if(ht(Et),a=t.memoizedState,a===null)return xr(t),null;if(s=(t.flags&128)!==0,i=a.rendering,i===null)if(s)zo(a,!1);else{if(Qt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(i=ad(e),i!==null){for(t.flags|=128,zo(a,!1),s=i.updateQueue,s!==null&&(t.updateQueue=s,t.flags|=4),t.subtreeFlags=0,s=r,r=t.child;r!==null;)a=r,e=s,a.flags&=14680066,i=a.alternate,i===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=i.childLanes,a.lanes=i.lanes,a.child=i.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=i.memoizedProps,a.memoizedState=i.memoizedState,a.updateQueue=i.updateQueue,a.type=i.type,e=i.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return ct(Et,Et.current&1|2),t.child}e=e.sibling}a.tail!==null&&Mt()>lo&&(t.flags|=128,s=!0,zo(a,!1),t.lanes=4194304)}else{if(!s)if(e=ad(i),e!==null){if(t.flags|=128,s=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),zo(a,!0),a.tail===null&&a.tailMode==="hidden"&&!i.alternate&&!gt)return xr(t),null}else 2*Mt()-a.renderingStartTime>lo&&r!==1073741824&&(t.flags|=128,s=!0,zo(a,!1),t.lanes=4194304);a.isBackwards?(i.sibling=t.child,t.child=i):(r=a.last,r!==null?r.sibling=i:t.child=i,a.last=i)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=Mt(),t.sibling=null,r=Et.current,ct(Et,s?r&1|2:r&1),t):(xr(t),null);case 22:case 23:return xm(),s=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==s&&(t.flags|=8192),s&&t.mode&1?Qr&1073741824&&(xr(t),t.subtreeFlags&6&&(t.flags|=8192)):xr(t),null;case 24:return null;case 25:return null}throw Error(ge(156,t.tag))}function rj(e,t){switch(Yp(t),t.tag){case 1:return qr(t.type)&&Qu(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return io(),ht(Hr),ht(Er),am(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return nm(t),null;case 13:if(ht(Et),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(ge(340));no()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return ht(Et),null;case 4:return io(),null;case 10:return em(t.type._context),null;case 22:case 23:return xm(),null;case 24:return null;default:return null}}var Jc=!1,wr=!1,sj=typeof WeakSet=="function"?WeakSet:Set,je=null;function Ii(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(s){Pt(e,t,s)}else r.current=null}function Sh(e,t,r){try{r()}catch(s){Pt(e,t,s)}}var c1=!1;function nj(e,t){if(ih=Ku,e=T2(),Kp(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var s=r.getSelection&&r.getSelection();if(s&&s.rangeCount!==0){r=s.anchorNode;var n=s.anchorOffset,a=s.focusNode;s=s.focusOffset;try{r.nodeType,a.nodeType}catch{r=null;break e}var i=0,o=-1,c=-1,u=0,d=0,f=e,h=null;t:for(;;){for(var m;f!==r||n!==0&&f.nodeType!==3||(o=i+n),f!==a||s!==0&&f.nodeType!==3||(c=i+s),f.nodeType===3&&(i+=f.nodeValue.length),(m=f.firstChild)!==null;)h=f,f=m;for(;;){if(f===e)break t;if(h===r&&++u===n&&(o=i),h===a&&++d===s&&(c=i),(m=f.nextSibling)!==null)break;f=h,h=f.parentNode}f=m}r=o===-1||c===-1?null:{start:o,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(oh={focusedElem:e,selectionRange:r},Ku=!1,je=t;je!==null;)if(t=je,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,je=e;else for(;je!==null;){t=je;try{var p=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var x=p.memoizedProps,v=p.memoizedState,y=t.stateNode,w=y.getSnapshotBeforeUpdate(t.elementType===t.type?x:Ms(t.type,x),v);y.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var g=t.stateNode.containerInfo;g.nodeType===1?g.textContent="":g.nodeType===9&&g.documentElement&&g.removeChild(g.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ge(163))}}catch(_){Pt(t,t.return,_)}if(e=t.sibling,e!==null){e.return=t.return,je=e;break}je=t.return}return p=c1,c1=!1,p}function ll(e,t,r){var s=t.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var n=s=s.next;do{if((n.tag&e)===e){var a=n.destroy;n.destroy=void 0,a!==void 0&&Sh(t,r,a)}n=n.next}while(n!==s)}}function Gd(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var s=r.create;r.destroy=s()}r=r.next}while(r!==t)}}function kh(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function b_(e){var t=e.alternate;t!==null&&(e.alternate=null,b_(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[rn],delete t[Dl],delete t[uh],delete t[U4],delete t[$4])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function S_(e){return e.tag===5||e.tag===3||e.tag===4}function u1(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||S_(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Eh(e,t,r){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Ju));else if(s!==4&&(e=e.child,e!==null))for(Eh(e,t,r),e=e.sibling;e!==null;)Eh(e,t,r),e=e.sibling}function Th(e,t,r){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(s!==4&&(e=e.child,e!==null))for(Th(e,t,r),e=e.sibling;e!==null;)Th(e,t,r),e=e.sibling}var or=null,Us=!1;function Ln(e,t,r){for(r=r.child;r!==null;)k_(e,t,r),r=r.sibling}function k_(e,t,r){if(nn&&typeof nn.onCommitFiberUnmount=="function")try{nn.onCommitFiberUnmount(Bd,r)}catch{}switch(r.tag){case 5:wr||Ii(r,t);case 6:var s=or,n=Us;or=null,Ln(e,t,r),or=s,Us=n,or!==null&&(Us?(e=or,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):or.removeChild(r.stateNode));break;case 18:or!==null&&(Us?(e=or,r=r.stateNode,e.nodeType===8?U0(e.parentNode,r):e.nodeType===1&&U0(e,r),Fl(e)):U0(or,r.stateNode));break;case 4:s=or,n=Us,or=r.stateNode.containerInfo,Us=!0,Ln(e,t,r),or=s,Us=n;break;case 0:case 11:case 14:case 15:if(!wr&&(s=r.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){n=s=s.next;do{var a=n,i=a.destroy;a=a.tag,i!==void 0&&(a&2||a&4)&&Sh(r,t,i),n=n.next}while(n!==s)}Ln(e,t,r);break;case 1:if(!wr&&(Ii(r,t),s=r.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=r.memoizedProps,s.state=r.memoizedState,s.componentWillUnmount()}catch(o){Pt(r,t,o)}Ln(e,t,r);break;case 21:Ln(e,t,r);break;case 22:r.mode&1?(wr=(s=wr)||r.memoizedState!==null,Ln(e,t,r),wr=s):Ln(e,t,r);break;default:Ln(e,t,r)}}function d1(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new sj),t.forEach(function(s){var n=hj.bind(null,e,s);r.has(s)||(r.add(s),s.then(n,n))})}}function Os(e,t){var r=t.deletions;if(r!==null)for(var s=0;s<r.length;s++){var n=r[s];try{var a=e,i=t,o=i;e:for(;o!==null;){switch(o.tag){case 5:or=o.stateNode,Us=!1;break e;case 3:or=o.stateNode.containerInfo,Us=!0;break e;case 4:or=o.stateNode.containerInfo,Us=!0;break e}o=o.return}if(or===null)throw Error(ge(160));k_(a,i,n),or=null,Us=!1;var c=n.alternate;c!==null&&(c.return=null),n.return=null}catch(u){Pt(n,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)E_(t,e),t=t.sibling}function E_(e,t){var r=e.alternate,s=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Os(t,e),Js(e),s&4){try{ll(3,e,e.return),Gd(3,e)}catch(x){Pt(e,e.return,x)}try{ll(5,e,e.return)}catch(x){Pt(e,e.return,x)}}break;case 1:Os(t,e),Js(e),s&512&&r!==null&&Ii(r,r.return);break;case 5:if(Os(t,e),Js(e),s&512&&r!==null&&Ii(r,r.return),e.flags&32){var n=e.stateNode;try{Nl(n,"")}catch(x){Pt(e,e.return,x)}}if(s&4&&(n=e.stateNode,n!=null)){var a=e.memoizedProps,i=r!==null?r.memoizedProps:a,o=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{o==="input"&&a.type==="radio"&&a.name!=null&&Gw(n,a),Yf(o,i);var u=Yf(o,a);for(i=0;i<c.length;i+=2){var d=c[i],f=c[i+1];d==="style"?Qw(n,f):d==="dangerouslySetInnerHTML"?Yw(n,f):d==="children"?Nl(n,f):Ip(n,d,f,u)}switch(o){case"input":Hf(n,a);break;case"textarea":Kw(n,a);break;case"select":var h=n._wrapperState.wasMultiple;n._wrapperState.wasMultiple=!!a.multiple;var m=a.value;m!=null?zi(n,!!a.multiple,m,!1):h!==!!a.multiple&&(a.defaultValue!=null?zi(n,!!a.multiple,a.defaultValue,!0):zi(n,!!a.multiple,a.multiple?[]:"",!1))}n[Dl]=a}catch(x){Pt(e,e.return,x)}}break;case 6:if(Os(t,e),Js(e),s&4){if(e.stateNode===null)throw Error(ge(162));n=e.stateNode,a=e.memoizedProps;try{n.nodeValue=a}catch(x){Pt(e,e.return,x)}}break;case 3:if(Os(t,e),Js(e),s&4&&r!==null&&r.memoizedState.isDehydrated)try{Fl(t.containerInfo)}catch(x){Pt(e,e.return,x)}break;case 4:Os(t,e),Js(e);break;case 13:Os(t,e),Js(e),n=e.child,n.flags&8192&&(a=n.memoizedState!==null,n.stateNode.isHidden=a,!a||n.alternate!==null&&n.alternate.memoizedState!==null||(pm=Mt())),s&4&&d1(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(wr=(u=wr)||d,Os(t,e),wr=u):Os(t,e),Js(e),s&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!d&&e.mode&1)for(je=e,d=e.child;d!==null;){for(f=je=d;je!==null;){switch(h=je,m=h.child,h.tag){case 0:case 11:case 14:case 15:ll(4,h,h.return);break;case 1:Ii(h,h.return);var p=h.stateNode;if(typeof p.componentWillUnmount=="function"){s=h,r=h.return;try{t=s,p.props=t.memoizedProps,p.state=t.memoizedState,p.componentWillUnmount()}catch(x){Pt(s,r,x)}}break;case 5:Ii(h,h.return);break;case 22:if(h.memoizedState!==null){h1(f);continue}}m!==null?(m.return=h,je=m):h1(f)}d=d.sibling}e:for(d=null,f=e;;){if(f.tag===5){if(d===null){d=f;try{n=f.stateNode,u?(a=n.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(o=f.stateNode,c=f.memoizedProps.style,i=c!=null&&c.hasOwnProperty("display")?c.display:null,o.style.display=Jw("display",i))}catch(x){Pt(e,e.return,x)}}}else if(f.tag===6){if(d===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(x){Pt(e,e.return,x)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Os(t,e),Js(e),s&4&&d1(e);break;case 21:break;default:Os(t,e),Js(e)}}function Js(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(S_(r)){var s=r;break e}r=r.return}throw Error(ge(160))}switch(s.tag){case 5:var n=s.stateNode;s.flags&32&&(Nl(n,""),s.flags&=-33);var a=u1(e);Th(e,a,n);break;case 3:case 4:var i=s.stateNode.containerInfo,o=u1(e);Eh(e,o,i);break;default:throw Error(ge(161))}}catch(c){Pt(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function aj(e,t,r){je=e,T_(e)}function T_(e,t,r){for(var s=(e.mode&1)!==0;je!==null;){var n=je,a=n.child;if(n.tag===22&&s){var i=n.memoizedState!==null||Jc;if(!i){var o=n.alternate,c=o!==null&&o.memoizedState!==null||wr;o=Jc;var u=wr;if(Jc=i,(wr=c)&&!u)for(je=n;je!==null;)i=je,c=i.child,i.tag===22&&i.memoizedState!==null?p1(n):c!==null?(c.return=i,je=c):p1(n);for(;a!==null;)je=a,T_(a),a=a.sibling;je=n,Jc=o,wr=u}f1(e)}else n.subtreeFlags&8772&&a!==null?(a.return=n,je=a):f1(e)}}function f1(e){for(;je!==null;){var t=je;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:wr||Gd(5,t);break;case 1:var s=t.stateNode;if(t.flags&4&&!wr)if(r===null)s.componentDidMount();else{var n=t.elementType===t.type?r.memoizedProps:Ms(t.type,r.memoizedProps);s.componentDidUpdate(n,r.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&Yg(t,a,s);break;case 3:var i=t.updateQueue;if(i!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}Yg(t,i,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var f=d.dehydrated;f!==null&&Fl(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ge(163))}wr||t.flags&512&&kh(t)}catch(h){Pt(t,t.return,h)}}if(t===e){je=null;break}if(r=t.sibling,r!==null){r.return=t.return,je=r;break}je=t.return}}function h1(e){for(;je!==null;){var t=je;if(t===e){je=null;break}var r=t.sibling;if(r!==null){r.return=t.return,je=r;break}je=t.return}}function p1(e){for(;je!==null;){var t=je;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Gd(4,t)}catch(c){Pt(t,r,c)}break;case 1:var s=t.stateNode;if(typeof s.componentDidMount=="function"){var n=t.return;try{s.componentDidMount()}catch(c){Pt(t,n,c)}}var a=t.return;try{kh(t)}catch(c){Pt(t,a,c)}break;case 5:var i=t.return;try{kh(t)}catch(c){Pt(t,i,c)}}}catch(c){Pt(t,t.return,c)}if(t===e){je=null;break}var o=t.sibling;if(o!==null){o.return=t.return,je=o;break}je=t.return}}var ij=Math.ceil,ld=Rn.ReactCurrentDispatcher,fm=Rn.ReactCurrentOwner,Ns=Rn.ReactCurrentBatchConfig,Qe=0,nr=null,Gt=null,dr=0,Qr=0,Di=ha(0),Qt=0,Vl=null,Ya=0,Kd=0,hm=0,cl=null,Vr=null,pm=0,lo=1/0,mn=null,cd=!1,Nh=null,ta=null,Qc=!1,Gn=null,ud=0,ul=0,jh=null,Ou=-1,Iu=0;function Ir(){return Qe&6?Mt():Ou!==-1?Ou:Ou=Mt()}function ra(e){return e.mode&1?Qe&2&&dr!==0?dr&-dr:z4.transition!==null?(Iu===0&&(Iu=u2()),Iu):(e=it,e!==0||(e=window.event,e=e===void 0?16:g2(e.type)),e):1}function qs(e,t,r,s){if(50<ul)throw ul=0,jh=null,Error(ge(185));xc(e,r,s),(!(Qe&2)||e!==nr)&&(e===nr&&(!(Qe&2)&&(Kd|=r),Qt===4&&Wn(e,dr)),Gr(e,s),r===1&&Qe===0&&!(t.mode&1)&&(lo=Mt()+500,Wd&&pa()))}function Gr(e,t){var r=e.callbackNode;zN(e,t);var s=Gu(e,e===nr?dr:0);if(s===0)r!==null&&Sg(r),e.callbackNode=null,e.callbackPriority=0;else if(t=s&-s,e.callbackPriority!==t){if(r!=null&&Sg(r),t===1)e.tag===0?V4(m1.bind(null,e)):D2(m1.bind(null,e)),M4(function(){!(Qe&6)&&pa()}),r=null;else{switch(d2(s)){case 1:r=Up;break;case 4:r=l2;break;case 16:r=qu;break;case 536870912:r=c2;break;default:r=qu}r=O_(r,N_.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function N_(e,t){if(Ou=-1,Iu=0,Qe&6)throw Error(ge(327));var r=e.callbackNode;if(Ki()&&e.callbackNode!==r)return null;var s=Gu(e,e===nr?dr:0);if(s===0)return null;if(s&30||s&e.expiredLanes||t)t=dd(e,s);else{t=s;var n=Qe;Qe|=2;var a=C_();(nr!==e||dr!==t)&&(mn=null,lo=Mt()+500,Ba(e,t));do try{cj();break}catch(o){j_(e,o)}while(!0);Zp(),ld.current=a,Qe=n,Gt!==null?t=0:(nr=null,dr=0,t=Qt)}if(t!==0){if(t===2&&(n=th(e),n!==0&&(s=n,t=Ch(e,n))),t===1)throw r=Vl,Ba(e,0),Wn(e,s),Gr(e,Mt()),r;if(t===6)Wn(e,s);else{if(n=e.current.alternate,!(s&30)&&!oj(n)&&(t=dd(e,s),t===2&&(a=th(e),a!==0&&(s=a,t=Ch(e,a))),t===1))throw r=Vl,Ba(e,0),Wn(e,s),Gr(e,Mt()),r;switch(e.finishedWork=n,e.finishedLanes=s,t){case 0:case 1:throw Error(ge(345));case 2:Ea(e,Vr,mn);break;case 3:if(Wn(e,s),(s&130023424)===s&&(t=pm+500-Mt(),10<t)){if(Gu(e,0)!==0)break;if(n=e.suspendedLanes,(n&s)!==s){Ir(),e.pingedLanes|=e.suspendedLanes&n;break}e.timeoutHandle=ch(Ea.bind(null,e,Vr,mn),t);break}Ea(e,Vr,mn);break;case 4:if(Wn(e,s),(s&4194240)===s)break;for(t=e.eventTimes,n=-1;0<s;){var i=31-Hs(s);a=1<<i,i=t[i],i>n&&(n=i),s&=~a}if(s=n,s=Mt()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*ij(s/1960))-s,10<s){e.timeoutHandle=ch(Ea.bind(null,e,Vr,mn),s);break}Ea(e,Vr,mn);break;case 5:Ea(e,Vr,mn);break;default:throw Error(ge(329))}}}return Gr(e,Mt()),e.callbackNode===r?N_.bind(null,e):null}function Ch(e,t){var r=cl;return e.current.memoizedState.isDehydrated&&(Ba(e,t).flags|=256),e=dd(e,t),e!==2&&(t=Vr,Vr=r,t!==null&&Ah(t)),e}function Ah(e){Vr===null?Vr=e:Vr.push.apply(Vr,e)}function oj(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var s=0;s<r.length;s++){var n=r[s],a=n.getSnapshot;n=n.value;try{if(!Xs(a(),n))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Wn(e,t){for(t&=~hm,t&=~Kd,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Hs(t),s=1<<r;e[r]=-1,t&=~s}}function m1(e){if(Qe&6)throw Error(ge(327));Ki();var t=Gu(e,0);if(!(t&1))return Gr(e,Mt()),null;var r=dd(e,t);if(e.tag!==0&&r===2){var s=th(e);s!==0&&(t=s,r=Ch(e,s))}if(r===1)throw r=Vl,Ba(e,0),Wn(e,t),Gr(e,Mt()),r;if(r===6)throw Error(ge(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ea(e,Vr,mn),Gr(e,Mt()),null}function mm(e,t){var r=Qe;Qe|=1;try{return e(t)}finally{Qe=r,Qe===0&&(lo=Mt()+500,Wd&&pa())}}function Ja(e){Gn!==null&&Gn.tag===0&&!(Qe&6)&&Ki();var t=Qe;Qe|=1;var r=Ns.transition,s=it;try{if(Ns.transition=null,it=1,e)return e()}finally{it=s,Ns.transition=r,Qe=t,!(Qe&6)&&pa()}}function xm(){Qr=Di.current,ht(Di)}function Ba(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,L4(r)),Gt!==null)for(r=Gt.return;r!==null;){var s=r;switch(Yp(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&Qu();break;case 3:io(),ht(Hr),ht(Er),am();break;case 5:nm(s);break;case 4:io();break;case 13:ht(Et);break;case 19:ht(Et);break;case 10:em(s.type._context);break;case 22:case 23:xm()}r=r.return}if(nr=e,Gt=e=sa(e.current,null),dr=Qr=t,Qt=0,Vl=null,hm=Kd=Ya=0,Vr=cl=null,Ra!==null){for(t=0;t<Ra.length;t++)if(r=Ra[t],s=r.interleaved,s!==null){r.interleaved=null;var n=s.next,a=r.pending;if(a!==null){var i=a.next;a.next=n,s.next=i}r.pending=s}Ra=null}return e}function j_(e,t){do{var r=Gt;try{if(Zp(),Fu.current=od,id){for(var s=Ct.memoizedState;s!==null;){var n=s.queue;n!==null&&(n.pending=null),s=s.next}id=!1}if(Xa=0,tr=Yt=Ct=null,ol=!1,Bl=0,fm.current=null,r===null||r.return===null){Qt=1,Vl=t,Gt=null;break}e:{var a=e,i=r.return,o=r,c=t;if(t=dr,o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=o,f=d.tag;if(!(d.mode&1)&&(f===0||f===11||f===15)){var h=d.alternate;h?(d.updateQueue=h.updateQueue,d.memoizedState=h.memoizedState,d.lanes=h.lanes):(d.updateQueue=null,d.memoizedState=null)}var m=r1(i);if(m!==null){m.flags&=-257,s1(m,i,o,a,t),m.mode&1&&t1(a,u,t),t=m,c=u;var p=t.updateQueue;if(p===null){var x=new Set;x.add(c),t.updateQueue=x}else p.add(c);break e}else{if(!(t&1)){t1(a,u,t),gm();break e}c=Error(ge(426))}}else if(gt&&o.mode&1){var v=r1(i);if(v!==null){!(v.flags&65536)&&(v.flags|=256),s1(v,i,o,a,t),Jp(oo(c,o));break e}}a=c=oo(c,o),Qt!==4&&(Qt=2),cl===null?cl=[a]:cl.push(a),a=i;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var y=d_(a,c,t);Xg(a,y);break e;case 1:o=c;var w=a.type,g=a.stateNode;if(!(a.flags&128)&&(typeof w.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(ta===null||!ta.has(g)))){a.flags|=65536,t&=-t,a.lanes|=t;var _=f_(a,o,t);Xg(a,_);break e}}a=a.return}while(a!==null)}F_(r)}catch(b){t=b,Gt===r&&r!==null&&(Gt=r=r.return);continue}break}while(!0)}function C_(){var e=ld.current;return ld.current=od,e===null?od:e}function gm(){(Qt===0||Qt===3||Qt===2)&&(Qt=4),nr===null||!(Ya&268435455)&&!(Kd&268435455)||Wn(nr,dr)}function dd(e,t){var r=Qe;Qe|=2;var s=C_();(nr!==e||dr!==t)&&(mn=null,Ba(e,t));do try{lj();break}catch(n){j_(e,n)}while(!0);if(Zp(),Qe=r,ld.current=s,Gt!==null)throw Error(ge(261));return nr=null,dr=0,Qt}function lj(){for(;Gt!==null;)A_(Gt)}function cj(){for(;Gt!==null&&!ON();)A_(Gt)}function A_(e){var t=R_(e.alternate,e,Qr);e.memoizedProps=e.pendingProps,t===null?F_(e):Gt=t,fm.current=null}function F_(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=rj(r,t),r!==null){r.flags&=32767,Gt=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Qt=6,Gt=null;return}}else if(r=tj(r,t,Qr),r!==null){Gt=r;return}if(t=t.sibling,t!==null){Gt=t;return}Gt=t=e}while(t!==null);Qt===0&&(Qt=5)}function Ea(e,t,r){var s=it,n=Ns.transition;try{Ns.transition=null,it=1,uj(e,t,r,s)}finally{Ns.transition=n,it=s}return null}function uj(e,t,r,s){do Ki();while(Gn!==null);if(Qe&6)throw Error(ge(327));r=e.finishedWork;var n=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(ge(177));e.callbackNode=null,e.callbackPriority=0;var a=r.lanes|r.childLanes;if(WN(e,a),e===nr&&(Gt=nr=null,dr=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Qc||(Qc=!0,O_(qu,function(){return Ki(),null})),a=(r.flags&15990)!==0,r.subtreeFlags&15990||a){a=Ns.transition,Ns.transition=null;var i=it;it=1;var o=Qe;Qe|=4,fm.current=null,nj(e,r),E_(r,e),A4(oh),Ku=!!ih,oh=ih=null,e.current=r,aj(r),IN(),Qe=o,it=i,Ns.transition=a}else e.current=r;if(Qc&&(Qc=!1,Gn=e,ud=n),a=e.pendingLanes,a===0&&(ta=null),MN(r.stateNode),Gr(e,Mt()),t!==null)for(s=e.onRecoverableError,r=0;r<t.length;r++)n=t[r],s(n.value,{componentStack:n.stack,digest:n.digest});if(cd)throw cd=!1,e=Nh,Nh=null,e;return ud&1&&e.tag!==0&&Ki(),a=e.pendingLanes,a&1?e===jh?ul++:(ul=0,jh=e):ul=0,pa(),null}function Ki(){if(Gn!==null){var e=d2(ud),t=Ns.transition,r=it;try{if(Ns.transition=null,it=16>e?16:e,Gn===null)var s=!1;else{if(e=Gn,Gn=null,ud=0,Qe&6)throw Error(ge(331));var n=Qe;for(Qe|=4,je=e.current;je!==null;){var a=je,i=a.child;if(je.flags&16){var o=a.deletions;if(o!==null){for(var c=0;c<o.length;c++){var u=o[c];for(je=u;je!==null;){var d=je;switch(d.tag){case 0:case 11:case 15:ll(8,d,a)}var f=d.child;if(f!==null)f.return=d,je=f;else for(;je!==null;){d=je;var h=d.sibling,m=d.return;if(b_(d),d===u){je=null;break}if(h!==null){h.return=m,je=h;break}je=m}}}var p=a.alternate;if(p!==null){var x=p.child;if(x!==null){p.child=null;do{var v=x.sibling;x.sibling=null,x=v}while(x!==null)}}je=a}}if(a.subtreeFlags&2064&&i!==null)i.return=a,je=i;else e:for(;je!==null;){if(a=je,a.flags&2048)switch(a.tag){case 0:case 11:case 15:ll(9,a,a.return)}var y=a.sibling;if(y!==null){y.return=a.return,je=y;break e}je=a.return}}var w=e.current;for(je=w;je!==null;){i=je;var g=i.child;if(i.subtreeFlags&2064&&g!==null)g.return=i,je=g;else e:for(i=w;je!==null;){if(o=je,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Gd(9,o)}}catch(b){Pt(o,o.return,b)}if(o===i){je=null;break e}var _=o.sibling;if(_!==null){_.return=o.return,je=_;break e}je=o.return}}if(Qe=n,pa(),nn&&typeof nn.onPostCommitFiberRoot=="function")try{nn.onPostCommitFiberRoot(Bd,e)}catch{}s=!0}return s}finally{it=r,Ns.transition=t}}return!1}function x1(e,t,r){t=oo(r,t),t=d_(e,t,1),e=ea(e,t,1),t=Ir(),e!==null&&(xc(e,1,t),Gr(e,t))}function Pt(e,t,r){if(e.tag===3)x1(e,e,r);else for(;t!==null;){if(t.tag===3){x1(t,e,r);break}else if(t.tag===1){var s=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(ta===null||!ta.has(s))){e=oo(r,e),e=f_(t,e,1),t=ea(t,e,1),e=Ir(),t!==null&&(xc(t,1,e),Gr(t,e));break}}t=t.return}}function dj(e,t,r){var s=e.pingCache;s!==null&&s.delete(t),t=Ir(),e.pingedLanes|=e.suspendedLanes&r,nr===e&&(dr&r)===r&&(Qt===4||Qt===3&&(dr&130023424)===dr&&500>Mt()-pm?Ba(e,0):hm|=r),Gr(e,t)}function P_(e,t){t===0&&(e.mode&1?(t=Vc,Vc<<=1,!(Vc&130023424)&&(Vc=4194304)):t=1);var r=Ir();e=jn(e,t),e!==null&&(xc(e,t,r),Gr(e,r))}function fj(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),P_(e,r)}function hj(e,t){var r=0;switch(e.tag){case 13:var s=e.stateNode,n=e.memoizedState;n!==null&&(r=n.retryLane);break;case 19:s=e.stateNode;break;default:throw Error(ge(314))}s!==null&&s.delete(t),P_(e,r)}var R_;R_=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Hr.current)zr=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return zr=!1,ej(e,t,r);zr=!!(e.flags&131072)}else zr=!1,gt&&t.flags&1048576&&L2(t,td,t.index);switch(t.lanes=0,t.tag){case 2:var s=t.type;Ru(e,t),e=t.pendingProps;var n=so(t,Er.current);Gi(t,r),n=om(null,t,s,e,n,r);var a=lm();return t.flags|=1,typeof n=="object"&&n!==null&&typeof n.render=="function"&&n.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,qr(s)?(a=!0,Zu(t)):a=!1,t.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,rm(t),n.updater=qd,t.stateNode=n,n._reactInternals=t,xh(t,s,e,r),t=yh(null,t,s,!0,a,r)):(t.tag=0,gt&&a&&Xp(t),Ar(null,t,n,r),t=t.child),t;case 16:s=t.elementType;e:{switch(Ru(e,t),e=t.pendingProps,n=s._init,s=n(s._payload),t.type=s,n=t.tag=mj(s),e=Ms(s,e),n){case 0:t=vh(null,t,s,e,r);break e;case 1:t=i1(null,t,s,e,r);break e;case 11:t=n1(null,t,s,e,r);break e;case 14:t=a1(null,t,s,Ms(s.type,e),r);break e}throw Error(ge(306,s,""))}return t;case 0:return s=t.type,n=t.pendingProps,n=t.elementType===s?n:Ms(s,n),vh(e,t,s,n,r);case 1:return s=t.type,n=t.pendingProps,n=t.elementType===s?n:Ms(s,n),i1(e,t,s,n,r);case 3:e:{if(x_(t),e===null)throw Error(ge(387));s=t.pendingProps,a=t.memoizedState,n=a.element,z2(e,t),nd(t,s,null,r);var i=t.memoizedState;if(s=i.element,a.isDehydrated)if(a={element:s,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){n=oo(Error(ge(423)),t),t=o1(e,t,s,r,n);break e}else if(s!==n){n=oo(Error(ge(424)),t),t=o1(e,t,s,r,n);break e}else for(as=Zn(t.stateNode.containerInfo.firstChild),os=t,gt=!0,$s=null,r=$2(t,null,s,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(no(),s===n){t=Cn(e,t,r);break e}Ar(e,t,s,r)}t=t.child}return t;case 5:return W2(t),e===null&&hh(t),s=t.type,n=t.pendingProps,a=e!==null?e.memoizedProps:null,i=n.children,lh(s,n)?i=null:a!==null&&lh(s,a)&&(t.flags|=32),m_(e,t),Ar(e,t,i,r),t.child;case 6:return e===null&&hh(t),null;case 13:return g_(e,t,r);case 4:return sm(t,t.stateNode.containerInfo),s=t.pendingProps,e===null?t.child=ao(t,null,s,r):Ar(e,t,s,r),t.child;case 11:return s=t.type,n=t.pendingProps,n=t.elementType===s?n:Ms(s,n),n1(e,t,s,n,r);case 7:return Ar(e,t,t.pendingProps,r),t.child;case 8:return Ar(e,t,t.pendingProps.children,r),t.child;case 12:return Ar(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(s=t.type._context,n=t.pendingProps,a=t.memoizedProps,i=n.value,ct(rd,s._currentValue),s._currentValue=i,a!==null)if(Xs(a.value,i)){if(a.children===n.children&&!Hr.current){t=Cn(e,t,r);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var o=a.dependencies;if(o!==null){i=a.child;for(var c=o.firstContext;c!==null;){if(c.context===s){if(a.tag===1){c=bn(-1,r&-r),c.tag=2;var u=a.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}a.lanes|=r,c=a.alternate,c!==null&&(c.lanes|=r),ph(a.return,r,t),o.lanes|=r;break}c=c.next}}else if(a.tag===10)i=a.type===t.type?null:a.child;else if(a.tag===18){if(i=a.return,i===null)throw Error(ge(341));i.lanes|=r,o=i.alternate,o!==null&&(o.lanes|=r),ph(i,r,t),i=a.sibling}else i=a.child;if(i!==null)i.return=a;else for(i=a;i!==null;){if(i===t){i=null;break}if(a=i.sibling,a!==null){a.return=i.return,i=a;break}i=i.return}a=i}Ar(e,t,n.children,r),t=t.child}return t;case 9:return n=t.type,s=t.pendingProps.children,Gi(t,r),n=As(n),s=s(n),t.flags|=1,Ar(e,t,s,r),t.child;case 14:return s=t.type,n=Ms(s,t.pendingProps),n=Ms(s.type,n),a1(e,t,s,n,r);case 15:return h_(e,t,t.type,t.pendingProps,r);case 17:return s=t.type,n=t.pendingProps,n=t.elementType===s?n:Ms(s,n),Ru(e,t),t.tag=1,qr(s)?(e=!0,Zu(t)):e=!1,Gi(t,r),u_(t,s,n),xh(t,s,n,r),yh(null,t,s,!0,e,r);case 19:return v_(e,t,r);case 22:return p_(e,t,r)}throw Error(ge(156,t.tag))};function O_(e,t){return o2(e,t)}function pj(e,t,r,s){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Es(e,t,r,s){return new pj(e,t,r,s)}function vm(e){return e=e.prototype,!(!e||!e.isReactComponent)}function mj(e){if(typeof e=="function")return vm(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Lp)return 11;if(e===Mp)return 14}return 2}function sa(e,t){var r=e.alternate;return r===null?(r=Es(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Du(e,t,r,s,n,a){var i=2;if(s=e,typeof e=="function")vm(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case Ti:return Ua(r.children,n,a,t);case Dp:i=8,n|=8;break;case Uf:return e=Es(12,r,t,n|2),e.elementType=Uf,e.lanes=a,e;case $f:return e=Es(13,r,t,n),e.elementType=$f,e.lanes=a,e;case Vf:return e=Es(19,r,t,n),e.elementType=Vf,e.lanes=a,e;case Ww:return Xd(r,n,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Vw:i=10;break e;case zw:i=9;break e;case Lp:i=11;break e;case Mp:i=14;break e;case $n:i=16,s=null;break e}throw Error(ge(130,e==null?e:typeof e,""))}return t=Es(i,r,t,n),t.elementType=e,t.type=s,t.lanes=a,t}function Ua(e,t,r,s){return e=Es(7,e,s,t),e.lanes=r,e}function Xd(e,t,r,s){return e=Es(22,e,s,t),e.elementType=Ww,e.lanes=r,e.stateNode={isHidden:!1},e}function K0(e,t,r){return e=Es(6,e,null,t),e.lanes=r,e}function X0(e,t,r){return t=Es(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function xj(e,t,r,s,n){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=C0(0),this.expirationTimes=C0(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=C0(0),this.identifierPrefix=s,this.onRecoverableError=n,this.mutableSourceEagerHydrationData=null}function ym(e,t,r,s,n,a,i,o,c){return e=new xj(e,t,r,o,c),t===1?(t=1,a===!0&&(t|=8)):t=0,a=Es(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:s,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},rm(a),e}function gj(e,t,r){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ei,key:s==null?null:""+s,children:e,containerInfo:t,implementation:r}}function I_(e){if(!e)return aa;e=e._reactInternals;e:{if(ai(e)!==e||e.tag!==1)throw Error(ge(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(qr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(ge(171))}if(e.tag===1){var r=e.type;if(qr(r))return I2(e,r,t)}return t}function D_(e,t,r,s,n,a,i,o,c){return e=ym(r,s,!0,e,n,a,i,o,c),e.context=I_(null),r=e.current,s=Ir(),n=ra(r),a=bn(s,n),a.callback=t??null,ea(r,a,n),e.current.lanes=n,xc(e,n,s),Gr(e,s),e}function Yd(e,t,r,s){var n=t.current,a=Ir(),i=ra(n);return r=I_(r),t.context===null?t.context=r:t.pendingContext=r,t=bn(a,i),t.payload={element:e},s=s===void 0?null:s,s!==null&&(t.callback=s),e=ea(n,t,i),e!==null&&(qs(e,n,i,a),Au(e,n,i)),i}function fd(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function g1(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function wm(e,t){g1(e,t),(e=e.alternate)&&g1(e,t)}function vj(){return null}var L_=typeof reportError=="function"?reportError:function(e){console.error(e)};function _m(e){this._internalRoot=e}Jd.prototype.render=_m.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(ge(409));Yd(e,t,null,null)};Jd.prototype.unmount=_m.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Ja(function(){Yd(null,e,null,null)}),t[Nn]=null}};function Jd(e){this._internalRoot=e}Jd.prototype.unstable_scheduleHydration=function(e){if(e){var t=p2();e={blockedOn:null,target:e,priority:t};for(var r=0;r<zn.length&&t!==0&&t<zn[r].priority;r++);zn.splice(r,0,e),r===0&&x2(e)}};function bm(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Qd(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function v1(){}function yj(e,t,r,s,n){if(n){if(typeof s=="function"){var a=s;s=function(){var u=fd(i);a.call(u)}}var i=D_(t,s,e,0,null,!1,!1,"",v1);return e._reactRootContainer=i,e[Nn]=i.current,Ol(e.nodeType===8?e.parentNode:e),Ja(),i}for(;n=e.lastChild;)e.removeChild(n);if(typeof s=="function"){var o=s;s=function(){var u=fd(c);o.call(u)}}var c=ym(e,0,!1,null,null,!1,!1,"",v1);return e._reactRootContainer=c,e[Nn]=c.current,Ol(e.nodeType===8?e.parentNode:e),Ja(function(){Yd(t,c,r,s)}),c}function Zd(e,t,r,s,n){var a=r._reactRootContainer;if(a){var i=a;if(typeof n=="function"){var o=n;n=function(){var c=fd(i);o.call(c)}}Yd(t,i,e,n)}else i=yj(r,t,e,n,s);return fd(i)}f2=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Xo(t.pendingLanes);r!==0&&($p(t,r|1),Gr(t,Mt()),!(Qe&6)&&(lo=Mt()+500,pa()))}break;case 13:Ja(function(){var s=jn(e,1);if(s!==null){var n=Ir();qs(s,e,1,n)}}),wm(e,1)}};Vp=function(e){if(e.tag===13){var t=jn(e,134217728);if(t!==null){var r=Ir();qs(t,e,134217728,r)}wm(e,134217728)}};h2=function(e){if(e.tag===13){var t=ra(e),r=jn(e,t);if(r!==null){var s=Ir();qs(r,e,t,s)}wm(e,t)}};p2=function(){return it};m2=function(e,t){var r=it;try{return it=e,t()}finally{it=r}};Qf=function(e,t,r){switch(t){case"input":if(Hf(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var s=r[t];if(s!==e&&s.form===e.form){var n=zd(s);if(!n)throw Error(ge(90));qw(s),Hf(s,n)}}}break;case"textarea":Kw(e,r);break;case"select":t=r.value,t!=null&&zi(e,!!r.multiple,t,!1)}};t2=mm;r2=Ja;var wj={usingClientEntryPoint:!1,Events:[vc,Ai,zd,Zw,e2,mm]},Wo={findFiberByHostInstance:Pa,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},_j={bundleType:Wo.bundleType,version:Wo.version,rendererPackageName:Wo.rendererPackageName,rendererConfig:Wo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Rn.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=a2(e),e===null?null:e.stateNode},findFiberByHostInstance:Wo.findFiberByHostInstance||vj,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Zc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Zc.isDisabled&&Zc.supportsFiber)try{Bd=Zc.inject(_j),nn=Zc}catch{}}us.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=wj;us.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!bm(t))throw Error(ge(200));return gj(e,t,null,r)};us.createRoot=function(e,t){if(!bm(e))throw Error(ge(299));var r=!1,s="",n=L_;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(n=t.onRecoverableError)),t=ym(e,1,!1,null,null,r,!1,s,n),e[Nn]=t.current,Ol(e.nodeType===8?e.parentNode:e),new _m(t)};us.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(ge(188)):(e=Object.keys(e).join(","),Error(ge(268,e)));return e=a2(t),e=e===null?null:e.stateNode,e};us.flushSync=function(e){return Ja(e)};us.hydrate=function(e,t,r){if(!Qd(t))throw Error(ge(200));return Zd(null,e,t,!0,r)};us.hydrateRoot=function(e,t,r){if(!bm(e))throw Error(ge(405));var s=r!=null&&r.hydratedSources||null,n=!1,a="",i=L_;if(r!=null&&(r.unstable_strictMode===!0&&(n=!0),r.identifierPrefix!==void 0&&(a=r.identifierPrefix),r.onRecoverableError!==void 0&&(i=r.onRecoverableError)),t=D_(t,null,e,1,r??null,n,!1,a,i),e[Nn]=t.current,Ol(e),s)for(e=0;e<s.length;e++)r=s[e],n=r._getVersion,n=n(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,n]:t.mutableSourceEagerHydrationData.push(r,n);return new Jd(t)};us.render=function(e,t,r){if(!Qd(t))throw Error(ge(200));return Zd(null,e,t,!1,r)};us.unmountComponentAtNode=function(e){if(!Qd(e))throw Error(ge(40));return e._reactRootContainer?(Ja(function(){Zd(null,null,e,!1,function(){e._reactRootContainer=null,e[Nn]=null})}),!0):!1};us.unstable_batchedUpdates=mm;us.unstable_renderSubtreeIntoContainer=function(e,t,r,s){if(!Qd(r))throw Error(ge(200));if(e==null||e._reactInternals===void 0)throw Error(ge(38));return Zd(e,t,r,!1,s)};us.version="18.3.1-next-f1338f8080-20240426";function M_(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(M_)}catch(e){console.error(e)}}M_(),Mw.exports=us;var bj=Mw.exports,y1=bj;Mf.createRoot=y1.createRoot,Mf.hydrateRoot=y1.hydrateRoot;const Sm=F.createContext({});function km(e){const t=F.useRef(null);return t.current===null&&(t.current=e()),t.current}const Em=typeof window<"u",B_=Em?F.useLayoutEffect:F.useEffect,e0=F.createContext(null);function Tm(e,t){e.indexOf(t)===-1&&e.push(t)}function Nm(e,t){const r=e.indexOf(t);r>-1&&e.splice(r,1)}const An=(e,t,r)=>r>t?t:r<e?e:r;let jm=()=>{};const Fn={},U_=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e);function $_(e){return typeof e=="object"&&e!==null}const V_=e=>/^0[^.\s]+$/u.test(e);function Cm(e){let t;return()=>(t===void 0&&(t=e()),t)}const js=e=>e,Sj=(e,t)=>r=>t(e(r)),wc=(...e)=>e.reduce(Sj),zl=(e,t,r)=>{const s=t-e;return s===0?1:(r-e)/s};class Am{constructor(){this.subscriptions=[]}add(t){return Tm(this.subscriptions,t),()=>Nm(this.subscriptions,t)}notify(t,r,s){const n=this.subscriptions.length;if(n)if(n===1)this.subscriptions[0](t,r,s);else for(let a=0;a<n;a++){const i=this.subscriptions[a];i&&i(t,r,s)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const on=e=>e*1e3,Ts=e=>e/1e3;function z_(e,t){return t?e*(1e3/t):0}const W_=(e,t,r)=>(((1-3*r+3*t)*e+(3*r-6*t))*e+3*t)*e,kj=1e-7,Ej=12;function Tj(e,t,r,s,n){let a,i,o=0;do i=t+(r-t)/2,a=W_(i,s,n)-e,a>0?r=i:t=i;while(Math.abs(a)>kj&&++o<Ej);return i}function _c(e,t,r,s){if(e===t&&r===s)return js;const n=a=>Tj(a,0,1,e,r);return a=>a===0||a===1?a:W_(n(a),t,s)}const H_=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,q_=e=>t=>1-e(1-t),G_=_c(.33,1.53,.69,.99),Fm=q_(G_),K_=H_(Fm),X_=e=>(e*=2)<1?.5*Fm(e):.5*(2-Math.pow(2,-10*(e-1))),Pm=e=>1-Math.sin(Math.acos(e)),Y_=q_(Pm),J_=H_(Pm),Nj=_c(.42,0,1,1),jj=_c(0,0,.58,1),Q_=_c(.42,0,.58,1),Cj=e=>Array.isArray(e)&&typeof e[0]!="number",Z_=e=>Array.isArray(e)&&typeof e[0]=="number",Aj={linear:js,easeIn:Nj,easeInOut:Q_,easeOut:jj,circIn:Pm,circInOut:J_,circOut:Y_,backIn:Fm,backInOut:K_,backOut:G_,anticipate:X_},Fj=e=>typeof e=="string",w1=e=>{if(Z_(e)){jm(e.length===4);const[t,r,s,n]=e;return _c(t,r,s,n)}else if(Fj(e))return Aj[e];return e},eu=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function Pj(e,t){let r=new Set,s=new Set,n=!1,a=!1;const i=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1};function c(d){i.has(d)&&(u.schedule(d),e()),d(o)}const u={schedule:(d,f=!1,h=!1)=>{const p=h&&n?r:s;return f&&i.add(d),p.has(d)||p.add(d),d},cancel:d=>{s.delete(d),i.delete(d)},process:d=>{if(o=d,n){a=!0;return}n=!0,[r,s]=[s,r],r.forEach(c),r.clear(),n=!1,a&&(a=!1,u.process(d))}};return u}const Rj=40;function eb(e,t){let r=!1,s=!0;const n={delta:0,timestamp:0,isProcessing:!1},a=()=>r=!0,i=eu.reduce((g,_)=>(g[_]=Pj(a),g),{}),{setup:o,read:c,resolveKeyframes:u,preUpdate:d,update:f,preRender:h,render:m,postRender:p}=i,x=()=>{const g=Fn.useManualTiming?n.timestamp:performance.now();r=!1,Fn.useManualTiming||(n.delta=s?1e3/60:Math.max(Math.min(g-n.timestamp,Rj),1)),n.timestamp=g,n.isProcessing=!0,o.process(n),c.process(n),u.process(n),d.process(n),f.process(n),h.process(n),m.process(n),p.process(n),n.isProcessing=!1,r&&t&&(s=!1,e(x))},v=()=>{r=!0,s=!0,n.isProcessing||e(x)};return{schedule:eu.reduce((g,_)=>{const b=i[_];return g[_]=(k,S=!1,T=!1)=>(r||v(),b.schedule(k,S,T)),g},{}),cancel:g=>{for(let _=0;_<eu.length;_++)i[eu[_]].cancel(g)},state:n,steps:i}}const{schedule:yt,cancel:ia,state:lr,steps:Y0}=eb(typeof requestAnimationFrame<"u"?requestAnimationFrame:js,!0);let Lu;function Oj(){Lu=void 0}const Wr={now:()=>(Lu===void 0&&Wr.set(lr.isProcessing||Fn.useManualTiming?lr.timestamp:performance.now()),Lu),set:e=>{Lu=e,queueMicrotask(Oj)}},tb=e=>t=>typeof t=="string"&&t.startsWith(e),Rm=tb("--"),Ij=tb("var(--"),Om=e=>Ij(e)?Dj.test(e.split("/*")[0].trim()):!1,Dj=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,bo={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},Wl={...bo,transform:e=>An(0,1,e)},tu={...bo,default:1},dl=e=>Math.round(e*1e5)/1e5,Im=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function Lj(e){return e==null}const Mj=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,Dm=(e,t)=>r=>!!(typeof r=="string"&&Mj.test(r)&&r.startsWith(e)||t&&!Lj(r)&&Object.prototype.hasOwnProperty.call(r,t)),rb=(e,t,r)=>s=>{if(typeof s!="string")return s;const[n,a,i,o]=s.match(Im);return{[e]:parseFloat(n),[t]:parseFloat(a),[r]:parseFloat(i),alpha:o!==void 0?parseFloat(o):1}},Bj=e=>An(0,255,e),J0={...bo,transform:e=>Math.round(Bj(e))},Ia={test:Dm("rgb","red"),parse:rb("red","green","blue"),transform:({red:e,green:t,blue:r,alpha:s=1})=>"rgba("+J0.transform(e)+", "+J0.transform(t)+", "+J0.transform(r)+", "+dl(Wl.transform(s))+")"};function Uj(e){let t="",r="",s="",n="";return e.length>5?(t=e.substring(1,3),r=e.substring(3,5),s=e.substring(5,7),n=e.substring(7,9)):(t=e.substring(1,2),r=e.substring(2,3),s=e.substring(3,4),n=e.substring(4,5),t+=t,r+=r,s+=s,n+=n),{red:parseInt(t,16),green:parseInt(r,16),blue:parseInt(s,16),alpha:n?parseInt(n,16)/255:1}}const Fh={test:Dm("#"),parse:Uj,transform:Ia.transform},bc=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),Un=bc("deg"),ln=bc("%"),Be=bc("px"),$j=bc("vh"),Vj=bc("vw"),_1={...ln,parse:e=>ln.parse(e)/100,transform:e=>ln.transform(e*100)},Li={test:Dm("hsl","hue"),parse:rb("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:r,alpha:s=1})=>"hsla("+Math.round(e)+", "+ln.transform(dl(t))+", "+ln.transform(dl(r))+", "+dl(Wl.transform(s))+")"},qt={test:e=>Ia.test(e)||Fh.test(e)||Li.test(e),parse:e=>Ia.test(e)?Ia.parse(e):Li.test(e)?Li.parse(e):Fh.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?Ia.transform(e):Li.transform(e),getAnimatableNone:e=>{const t=qt.parse(e);return t.alpha=0,qt.transform(t)}},zj=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function Wj(e){var t,r;return isNaN(e)&&typeof e=="string"&&(((t=e.match(Im))==null?void 0:t.length)||0)+(((r=e.match(zj))==null?void 0:r.length)||0)>0}const sb="number",nb="color",Hj="var",qj="var(",b1="${}",Gj=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Hl(e){const t=e.toString(),r=[],s={color:[],number:[],var:[]},n=[];let a=0;const o=t.replace(Gj,c=>(qt.test(c)?(s.color.push(a),n.push(nb),r.push(qt.parse(c))):c.startsWith(qj)?(s.var.push(a),n.push(Hj),r.push(c)):(s.number.push(a),n.push(sb),r.push(parseFloat(c))),++a,b1)).split(b1);return{values:r,split:o,indexes:s,types:n}}function ab(e){return Hl(e).values}function ib(e){const{split:t,types:r}=Hl(e),s=t.length;return n=>{let a="";for(let i=0;i<s;i++)if(a+=t[i],n[i]!==void 0){const o=r[i];o===sb?a+=dl(n[i]):o===nb?a+=qt.transform(n[i]):a+=n[i]}return a}}const Kj=e=>typeof e=="number"?0:qt.test(e)?qt.getAnimatableNone(e):e;function Xj(e){const t=ab(e);return ib(e)(t.map(Kj))}const oa={test:Wj,parse:ab,createTransformer:ib,getAnimatableNone:Xj};function Q0(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+(t-e)*6*r:r<1/2?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function Yj({hue:e,saturation:t,lightness:r,alpha:s}){e/=360,t/=100,r/=100;let n=0,a=0,i=0;if(!t)n=a=i=r;else{const o=r<.5?r*(1+t):r+t-r*t,c=2*r-o;n=Q0(c,o,e+1/3),a=Q0(c,o,e),i=Q0(c,o,e-1/3)}return{red:Math.round(n*255),green:Math.round(a*255),blue:Math.round(i*255),alpha:s}}function hd(e,t){return r=>r>0?t:e}const Tt=(e,t,r)=>e+(t-e)*r,Z0=(e,t,r)=>{const s=e*e,n=r*(t*t-s)+s;return n<0?0:Math.sqrt(n)},Jj=[Fh,Ia,Li],Qj=e=>Jj.find(t=>t.test(e));function S1(e){const t=Qj(e);if(!t)return!1;let r=t.parse(e);return t===Li&&(r=Yj(r)),r}const k1=(e,t)=>{const r=S1(e),s=S1(t);if(!r||!s)return hd(e,t);const n={...r};return a=>(n.red=Z0(r.red,s.red,a),n.green=Z0(r.green,s.green,a),n.blue=Z0(r.blue,s.blue,a),n.alpha=Tt(r.alpha,s.alpha,a),Ia.transform(n))},Ph=new Set(["none","hidden"]);function Zj(e,t){return Ph.has(e)?r=>r<=0?e:t:r=>r>=1?t:e}function eC(e,t){return r=>Tt(e,t,r)}function Lm(e){return typeof e=="number"?eC:typeof e=="string"?Om(e)?hd:qt.test(e)?k1:sC:Array.isArray(e)?ob:typeof e=="object"?qt.test(e)?k1:tC:hd}function ob(e,t){const r=[...e],s=r.length,n=e.map((a,i)=>Lm(a)(a,t[i]));return a=>{for(let i=0;i<s;i++)r[i]=n[i](a);return r}}function tC(e,t){const r={...e,...t},s={};for(const n in r)e[n]!==void 0&&t[n]!==void 0&&(s[n]=Lm(e[n])(e[n],t[n]));return n=>{for(const a in s)r[a]=s[a](n);return r}}function rC(e,t){const r=[],s={color:0,var:0,number:0};for(let n=0;n<t.values.length;n++){const a=t.types[n],i=e.indexes[a][s[a]],o=e.values[i]??0;r[n]=o,s[a]++}return r}const sC=(e,t)=>{const r=oa.createTransformer(t),s=Hl(e),n=Hl(t);return s.indexes.var.length===n.indexes.var.length&&s.indexes.color.length===n.indexes.color.length&&s.indexes.number.length>=n.indexes.number.length?Ph.has(e)&&!n.values.length||Ph.has(t)&&!s.values.length?Zj(e,t):wc(ob(rC(s,n),n.values),r):hd(e,t)};function lb(e,t,r){return typeof e=="number"&&typeof t=="number"&&typeof r=="number"?Tt(e,t,r):Lm(e)(e,t)}const nC=e=>{const t=({timestamp:r})=>e(r);return{start:(r=!0)=>yt.update(t,r),stop:()=>ia(t),now:()=>lr.isProcessing?lr.timestamp:Wr.now()}},cb=(e,t,r=10)=>{let s="";const n=Math.max(Math.round(t/r),2);for(let a=0;a<n;a++)s+=Math.round(e(a/(n-1))*1e4)/1e4+", ";return`linear(${s.substring(0,s.length-2)})`},pd=2e4;function Mm(e){let t=0;const r=50;let s=e.next(t);for(;!s.done&&t<pd;)t+=r,s=e.next(t);return t>=pd?1/0:t}function aC(e,t=100,r){const s=r({...e,keyframes:[0,t]}),n=Math.min(Mm(s),pd);return{type:"keyframes",ease:a=>s.next(n*a).value/t,duration:Ts(n)}}const iC=5;function ub(e,t,r){const s=Math.max(t-iC,0);return z_(r-e(s),t-s)}const Ft={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},ef=.001;function oC({duration:e=Ft.duration,bounce:t=Ft.bounce,velocity:r=Ft.velocity,mass:s=Ft.mass}){let n,a,i=1-t;i=An(Ft.minDamping,Ft.maxDamping,i),e=An(Ft.minDuration,Ft.maxDuration,Ts(e)),i<1?(n=u=>{const d=u*i,f=d*e,h=d-r,m=Rh(u,i),p=Math.exp(-f);return ef-h/m*p},a=u=>{const f=u*i*e,h=f*r+r,m=Math.pow(i,2)*Math.pow(u,2)*e,p=Math.exp(-f),x=Rh(Math.pow(u,2),i);return(-n(u)+ef>0?-1:1)*((h-m)*p)/x}):(n=u=>{const d=Math.exp(-u*e),f=(u-r)*e+1;return-ef+d*f},a=u=>{const d=Math.exp(-u*e),f=(r-u)*(e*e);return d*f});const o=5/e,c=cC(n,a,o);if(e=on(e),isNaN(c))return{stiffness:Ft.stiffness,damping:Ft.damping,duration:e};{const u=Math.pow(c,2)*s;return{stiffness:u,damping:i*2*Math.sqrt(s*u),duration:e}}}const lC=12;function cC(e,t,r){let s=r;for(let n=1;n<lC;n++)s=s-e(s)/t(s);return s}function Rh(e,t){return e*Math.sqrt(1-t*t)}const uC=["duration","bounce"],dC=["stiffness","damping","mass"];function E1(e,t){return t.some(r=>e[r]!==void 0)}function fC(e){let t={velocity:Ft.velocity,stiffness:Ft.stiffness,damping:Ft.damping,mass:Ft.mass,isResolvedFromDuration:!1,...e};if(!E1(e,dC)&&E1(e,uC))if(e.visualDuration){const r=e.visualDuration,s=2*Math.PI/(r*1.2),n=s*s,a=2*An(.05,1,1-(e.bounce||0))*Math.sqrt(n);t={...t,mass:Ft.mass,stiffness:n,damping:a}}else{const r=oC(e);t={...t,...r,mass:Ft.mass},t.isResolvedFromDuration=!0}return t}function md(e=Ft.visualDuration,t=Ft.bounce){const r=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:s,restDelta:n}=r;const a=r.keyframes[0],i=r.keyframes[r.keyframes.length-1],o={done:!1,value:a},{stiffness:c,damping:u,mass:d,duration:f,velocity:h,isResolvedFromDuration:m}=fC({...r,velocity:-Ts(r.velocity||0)}),p=h||0,x=u/(2*Math.sqrt(c*d)),v=i-a,y=Ts(Math.sqrt(c/d)),w=Math.abs(v)<5;s||(s=w?Ft.restSpeed.granular:Ft.restSpeed.default),n||(n=w?Ft.restDelta.granular:Ft.restDelta.default);let g;if(x<1){const b=Rh(y,x);g=k=>{const S=Math.exp(-x*y*k);return i-S*((p+x*y*v)/b*Math.sin(b*k)+v*Math.cos(b*k))}}else if(x===1)g=b=>i-Math.exp(-y*b)*(v+(p+y*v)*b);else{const b=y*Math.sqrt(x*x-1);g=k=>{const S=Math.exp(-x*y*k),T=Math.min(b*k,300);return i-S*((p+x*y*v)*Math.sinh(T)+b*v*Math.cosh(T))/b}}const _={calculatedDuration:m&&f||null,next:b=>{const k=g(b);if(m)o.done=b>=f;else{let S=b===0?p:0;x<1&&(S=b===0?on(p):ub(g,b,k));const T=Math.abs(S)<=s,j=Math.abs(i-k)<=n;o.done=T&&j}return o.value=o.done?i:k,o},toString:()=>{const b=Math.min(Mm(_),pd),k=cb(S=>_.next(b*S).value,b,30);return b+"ms "+k},toTransition:()=>{}};return _}md.applyToOptions=e=>{const t=aC(e,100,md);return e.ease=t.ease,e.duration=on(t.duration),e.type="keyframes",e};function Oh({keyframes:e,velocity:t=0,power:r=.8,timeConstant:s=325,bounceDamping:n=10,bounceStiffness:a=500,modifyTarget:i,min:o,max:c,restDelta:u=.5,restSpeed:d}){const f=e[0],h={done:!1,value:f},m=T=>o!==void 0&&T<o||c!==void 0&&T>c,p=T=>o===void 0?c:c===void 0||Math.abs(o-T)<Math.abs(c-T)?o:c;let x=r*t;const v=f+x,y=i===void 0?v:i(v);y!==v&&(x=y-f);const w=T=>-x*Math.exp(-T/s),g=T=>y+w(T),_=T=>{const j=w(T),U=g(T);h.done=Math.abs(j)<=u,h.value=h.done?y:U};let b,k;const S=T=>{m(h.value)&&(b=T,k=md({keyframes:[h.value,p(h.value)],velocity:ub(g,T,h.value),damping:n,stiffness:a,restDelta:u,restSpeed:d}))};return S(0),{calculatedDuration:null,next:T=>{let j=!1;return!k&&b===void 0&&(j=!0,_(T),S(T)),b!==void 0&&T>=b?k.next(T-b):(!j&&_(T),h)}}}function hC(e,t,r){const s=[],n=r||Fn.mix||lb,a=e.length-1;for(let i=0;i<a;i++){let o=n(e[i],e[i+1]);if(t){const c=Array.isArray(t)?t[i]||js:t;o=wc(c,o)}s.push(o)}return s}function pC(e,t,{clamp:r=!0,ease:s,mixer:n}={}){const a=e.length;if(jm(a===t.length),a===1)return()=>t[0];if(a===2&&t[0]===t[1])return()=>t[1];const i=e[0]===e[1];e[0]>e[a-1]&&(e=[...e].reverse(),t=[...t].reverse());const o=hC(t,s,n),c=o.length,u=d=>{if(i&&d<e[0])return t[0];let f=0;if(c>1)for(;f<e.length-2&&!(d<e[f+1]);f++);const h=zl(e[f],e[f+1],d);return o[f](h)};return r?d=>u(An(e[0],e[a-1],d)):u}function mC(e,t){const r=e[e.length-1];for(let s=1;s<=t;s++){const n=zl(0,t,s);e.push(Tt(r,1,n))}}function xC(e){const t=[0];return mC(t,e.length-1),t}function gC(e,t){return e.map(r=>r*t)}function vC(e,t){return e.map(()=>t||Q_).splice(0,e.length-1)}function fl({duration:e=300,keyframes:t,times:r,ease:s="easeInOut"}){const n=Cj(s)?s.map(w1):w1(s),a={done:!1,value:t[0]},i=gC(r&&r.length===t.length?r:xC(t),e),o=pC(i,t,{ease:Array.isArray(n)?n:vC(t,n)});return{calculatedDuration:e,next:c=>(a.value=o(c),a.done=c>=e,a)}}const yC=e=>e!==null;function Bm(e,{repeat:t,repeatType:r="loop"},s,n=1){const a=e.filter(yC),o=n<0||t&&r!=="loop"&&t%2===1?0:a.length-1;return!o||s===void 0?a[o]:s}const wC={decay:Oh,inertia:Oh,tween:fl,keyframes:fl,spring:md};function db(e){typeof e.type=="string"&&(e.type=wC[e.type])}class Um{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(t=>{this.resolve=t})}notifyFinished(){this.resolve()}then(t,r){return this.finished.then(t,r)}}const _C=e=>e/100;class $m extends Um{constructor(t){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var s,n;const{motionValue:r}=this.options;r&&r.updatedAt!==Wr.now()&&this.tick(Wr.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),(n=(s=this.options).onStop)==null||n.call(s))},this.options=t,this.initAnimation(),this.play(),t.autoplay===!1&&this.pause()}initAnimation(){const{options:t}=this;db(t);const{type:r=fl,repeat:s=0,repeatDelay:n=0,repeatType:a,velocity:i=0}=t;let{keyframes:o}=t;const c=r||fl;c!==fl&&typeof o[0]!="number"&&(this.mixKeyframes=wc(_C,lb(o[0],o[1])),o=[0,100]);const u=c({...t,keyframes:o});a==="mirror"&&(this.mirroredGenerator=c({...t,keyframes:[...o].reverse(),velocity:-i})),u.calculatedDuration===null&&(u.calculatedDuration=Mm(u));const{calculatedDuration:d}=u;this.calculatedDuration=d,this.resolvedDuration=d+n,this.totalDuration=this.resolvedDuration*(s+1)-n,this.generator=u}updateTime(t){const r=Math.round(t-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=r}tick(t,r=!1){const{generator:s,totalDuration:n,mixKeyframes:a,mirroredGenerator:i,resolvedDuration:o,calculatedDuration:c}=this;if(this.startTime===null)return s.next(0);const{delay:u=0,keyframes:d,repeat:f,repeatType:h,repeatDelay:m,type:p,onUpdate:x,finalKeyframe:v}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-n/this.speed,this.startTime)),r?this.currentTime=t:this.updateTime(t);const y=this.currentTime-u*(this.playbackSpeed>=0?1:-1),w=this.playbackSpeed>=0?y<0:y>n;this.currentTime=Math.max(y,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=n);let g=this.currentTime,_=s;if(f){const T=Math.min(this.currentTime,n)/o;let j=Math.floor(T),U=T%1;!U&&T>=1&&(U=1),U===1&&j--,j=Math.min(j,f+1),!!(j%2)&&(h==="reverse"?(U=1-U,m&&(U-=m/o)):h==="mirror"&&(_=i)),g=An(0,1,U)*o}const b=w?{done:!1,value:d[0]}:_.next(g);a&&(b.value=a(b.value));let{done:k}=b;!w&&c!==null&&(k=this.playbackSpeed>=0?this.currentTime>=n:this.currentTime<=0);const S=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&k);return S&&p!==Oh&&(b.value=Bm(d,this.options,v,this.speed)),x&&x(b.value),S&&this.finish(),b}then(t,r){return this.finished.then(t,r)}get duration(){return Ts(this.calculatedDuration)}get iterationDuration(){const{delay:t=0}=this.options||{};return this.duration+Ts(t)}get time(){return Ts(this.currentTime)}set time(t){var r;t=on(t),this.currentTime=t,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.playbackSpeed),(r=this.driver)==null||r.start(!1)}get speed(){return this.playbackSpeed}set speed(t){this.updateTime(Wr.now());const r=this.playbackSpeed!==t;this.playbackSpeed=t,r&&(this.time=Ts(this.currentTime))}play(){var n,a;if(this.isStopped)return;const{driver:t=nC,startTime:r}=this.options;this.driver||(this.driver=t(i=>this.tick(i))),(a=(n=this.options).onPlay)==null||a.call(n);const s=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=s):this.holdTime!==null?this.startTime=s-this.holdTime:this.startTime||(this.startTime=r??s),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(Wr.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){var t,r;this.notifyFinished(),this.teardown(),this.state="finished",(r=(t=this.options).onComplete)==null||r.call(t)}cancel(){var t,r;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),(r=(t=this.options).onCancel)==null||r.call(t)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}attachTimeline(t){var r;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),(r=this.driver)==null||r.stop(),t.observe(this)}}function bC(e){for(let t=1;t<e.length;t++)e[t]??(e[t]=e[t-1])}const Da=e=>e*180/Math.PI,Ih=e=>{const t=Da(Math.atan2(e[1],e[0]));return Dh(t)},SC={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:Ih,rotateZ:Ih,skewX:e=>Da(Math.atan(e[1])),skewY:e=>Da(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},Dh=e=>(e=e%360,e<0&&(e+=360),e),T1=Ih,N1=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),j1=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),kC={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:N1,scaleY:j1,scale:e=>(N1(e)+j1(e))/2,rotateX:e=>Dh(Da(Math.atan2(e[6],e[5]))),rotateY:e=>Dh(Da(Math.atan2(-e[2],e[0]))),rotateZ:T1,rotate:T1,skewX:e=>Da(Math.atan(e[4])),skewY:e=>Da(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function Lh(e){return e.includes("scale")?1:0}function Mh(e,t){if(!e||e==="none")return Lh(t);const r=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let s,n;if(r)s=kC,n=r;else{const o=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);s=SC,n=o}if(!n)return Lh(t);const a=s[t],i=n[1].split(",").map(TC);return typeof a=="function"?a(i):i[a]}const EC=(e,t)=>{const{transform:r="none"}=getComputedStyle(e);return Mh(r,t)};function TC(e){return parseFloat(e.trim())}const So=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],ko=new Set(So),C1=e=>e===bo||e===Be,NC=new Set(["x","y","z"]),jC=So.filter(e=>!NC.has(e));function CC(e){const t=[];return jC.forEach(r=>{const s=e.getValue(r);s!==void 0&&(t.push([r,s.get()]),s.set(r.startsWith("scale")?1:0))}),t}const $a={width:({x:e},{paddingLeft:t="0",paddingRight:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),height:({y:e},{paddingTop:t="0",paddingBottom:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:(e,{transform:t})=>Mh(t,"x"),y:(e,{transform:t})=>Mh(t,"y")};$a.translateX=$a.x;$a.translateY=$a.y;const Va=new Set;let Bh=!1,Uh=!1,$h=!1;function fb(){if(Uh){const e=Array.from(Va).filter(s=>s.needsMeasurement),t=new Set(e.map(s=>s.element)),r=new Map;t.forEach(s=>{const n=CC(s);n.length&&(r.set(s,n),s.render())}),e.forEach(s=>s.measureInitialState()),t.forEach(s=>{s.render();const n=r.get(s);n&&n.forEach(([a,i])=>{var o;(o=s.getValue(a))==null||o.set(i)})}),e.forEach(s=>s.measureEndState()),e.forEach(s=>{s.suspendedScrollY!==void 0&&window.scrollTo(0,s.suspendedScrollY)})}Uh=!1,Bh=!1,Va.forEach(e=>e.complete($h)),Va.clear()}function hb(){Va.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(Uh=!0)})}function AC(){$h=!0,hb(),fb(),$h=!1}class Vm{constructor(t,r,s,n,a,i=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...t],this.onComplete=r,this.name=s,this.motionValue=n,this.element=a,this.isAsync=i}scheduleResolve(){this.state="scheduled",this.isAsync?(Va.add(this),Bh||(Bh=!0,yt.read(hb),yt.resolveKeyframes(fb))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:r,element:s,motionValue:n}=this;if(t[0]===null){const a=n==null?void 0:n.get(),i=t[t.length-1];if(a!==void 0)t[0]=a;else if(s&&r){const o=s.readValue(r,i);o!=null&&(t[0]=o)}t[0]===void 0&&(t[0]=i),n&&a===void 0&&n.set(t[0])}bC(t)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(t=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,t),Va.delete(this)}cancel(){this.state==="scheduled"&&(Va.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const FC=e=>e.startsWith("--");function PC(e,t,r){FC(t)?e.style.setProperty(t,r):e.style[t]=r}const RC=Cm(()=>window.ScrollTimeline!==void 0),OC={};function IC(e,t){const r=Cm(e);return()=>OC[t]??r()}const pb=IC(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),Jo=([e,t,r,s])=>`cubic-bezier(${e}, ${t}, ${r}, ${s})`,A1={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Jo([0,.65,.55,1]),circOut:Jo([.55,0,1,.45]),backIn:Jo([.31,.01,.66,-.59]),backOut:Jo([.33,1.53,.69,.99])};function mb(e,t){if(e)return typeof e=="function"?pb()?cb(e,t):"ease-out":Z_(e)?Jo(e):Array.isArray(e)?e.map(r=>mb(r,t)||A1.easeOut):A1[e]}function DC(e,t,r,{delay:s=0,duration:n=300,repeat:a=0,repeatType:i="loop",ease:o="easeOut",times:c}={},u=void 0){const d={[t]:r};c&&(d.offset=c);const f=mb(o,n);Array.isArray(f)&&(d.easing=f);const h={delay:s,duration:n,easing:Array.isArray(f)?"linear":f,fill:"both",iterations:a+1,direction:i==="reverse"?"alternate":"normal"};return u&&(h.pseudoElement=u),e.animate(d,h)}function xb(e){return typeof e=="function"&&"applyToOptions"in e}function LC({type:e,...t}){return xb(e)&&pb()?e.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}class MC extends Um{constructor(t){if(super(),this.finishedTime=null,this.isStopped=!1,!t)return;const{element:r,name:s,keyframes:n,pseudoElement:a,allowFlatten:i=!1,finalKeyframe:o,onComplete:c}=t;this.isPseudoElement=!!a,this.allowFlatten=i,this.options=t,jm(typeof t.type!="string");const u=LC(t);this.animation=DC(r,s,n,u,a),u.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!a){const d=Bm(n,this.options,o,this.speed);this.updateMotionValue?this.updateMotionValue(d):PC(r,s,d),this.animation.cancel()}c==null||c(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var t,r;(r=(t=this.animation).finish)==null||r.call(t)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:t}=this;t==="idle"||t==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var t,r;this.isPseudoElement||(r=(t=this.animation).commitStyles)==null||r.call(t)}get duration(){var r,s;const t=((s=(r=this.animation.effect)==null?void 0:r.getComputedTiming)==null?void 0:s.call(r).duration)||0;return Ts(Number(t))}get iterationDuration(){const{delay:t=0}=this.options||{};return this.duration+Ts(t)}get time(){return Ts(Number(this.animation.currentTime)||0)}set time(t){this.finishedTime=null,this.animation.currentTime=on(t)}get speed(){return this.animation.playbackRate}set speed(t){t<0&&(this.finishedTime=null),this.animation.playbackRate=t}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(t){this.animation.startTime=t}attachTimeline({timeline:t,observe:r}){var s;return this.allowFlatten&&((s=this.animation.effect)==null||s.updateTiming({easing:"linear"})),this.animation.onfinish=null,t&&RC()?(this.animation.timeline=t,js):r(this)}}const gb={anticipate:X_,backInOut:K_,circInOut:J_};function BC(e){return e in gb}function UC(e){typeof e.ease=="string"&&BC(e.ease)&&(e.ease=gb[e.ease])}const F1=10;class $C extends MC{constructor(t){UC(t),db(t),super(t),t.startTime&&(this.startTime=t.startTime),this.options=t}updateMotionValue(t){const{motionValue:r,onUpdate:s,onComplete:n,element:a,...i}=this.options;if(!r)return;if(t!==void 0){r.set(t);return}const o=new $m({...i,autoplay:!1}),c=on(this.finishedTime??this.time);r.setWithVelocity(o.sample(c-F1).value,o.sample(c).value,F1),o.stop()}}const P1=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(oa.test(e)||e==="0")&&!e.startsWith("url("));function VC(e){const t=e[0];if(e.length===1)return!0;for(let r=0;r<e.length;r++)if(e[r]!==t)return!0}function zC(e,t,r,s){const n=e[0];if(n===null)return!1;if(t==="display"||t==="visibility")return!0;const a=e[e.length-1],i=P1(n,t),o=P1(a,t);return!i||!o?!1:VC(e)||(r==="spring"||xb(r))&&s}function Vh(e){e.duration=0,e.type="keyframes"}const WC=new Set(["opacity","clipPath","filter","transform"]),HC=Cm(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function qC(e){var d;const{motionValue:t,name:r,repeatDelay:s,repeatType:n,damping:a,type:i}=e;if(!(((d=t==null?void 0:t.owner)==null?void 0:d.current)instanceof HTMLElement))return!1;const{onUpdate:c,transformTemplate:u}=t.owner.getProps();return HC()&&r&&WC.has(r)&&(r!=="transform"||!u)&&!c&&!s&&n!=="mirror"&&a!==0&&i!=="inertia"}const GC=40;class KC extends Um{constructor({autoplay:t=!0,delay:r=0,type:s="keyframes",repeat:n=0,repeatDelay:a=0,repeatType:i="loop",keyframes:o,name:c,motionValue:u,element:d,...f}){var p;super(),this.stop=()=>{var x,v;this._animation&&(this._animation.stop(),(x=this.stopTimeline)==null||x.call(this)),(v=this.keyframeResolver)==null||v.cancel()},this.createdAt=Wr.now();const h={autoplay:t,delay:r,type:s,repeat:n,repeatDelay:a,repeatType:i,name:c,motionValue:u,element:d,...f},m=(d==null?void 0:d.KeyframeResolver)||Vm;this.keyframeResolver=new m(o,(x,v,y)=>this.onKeyframesResolved(x,v,h,!y),c,u,d),(p=this.keyframeResolver)==null||p.scheduleResolve()}onKeyframesResolved(t,r,s,n){this.keyframeResolver=void 0;const{name:a,type:i,velocity:o,delay:c,isHandoff:u,onUpdate:d}=s;this.resolvedAt=Wr.now(),zC(t,a,i,o)||((Fn.instantAnimations||!c)&&(d==null||d(Bm(t,s,r))),t[0]=t[t.length-1],Vh(s),s.repeat=0);const h={startTime:n?this.resolvedAt?this.resolvedAt-this.createdAt>GC?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:r,...s,keyframes:t},m=!u&&qC(h)?new $C({...h,element:h.motionValue.owner.current}):new $m(h);m.finished.then(()=>this.notifyFinished()).catch(js),this.pendingTimeline&&(this.stopTimeline=m.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=m}get finished(){return this._animation?this.animation.finished:this._finished}then(t,r){return this.finished.finally(t).then(()=>{})}get animation(){var t;return this._animation||((t=this.keyframeResolver)==null||t.resume(),AC()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(t){this.animation.time=t}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(t){this.animation.speed=t}get startTime(){return this.animation.startTime}attachTimeline(t){return this._animation?this.stopTimeline=this.animation.attachTimeline(t):this.pendingTimeline=t,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var t;this._animation&&this.animation.cancel(),(t=this.keyframeResolver)==null||t.cancel()}}const XC=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function YC(e){const t=XC.exec(e);if(!t)return[,];const[,r,s,n]=t;return[`--${r??s}`,n]}function vb(e,t,r=1){const[s,n]=YC(e);if(!s)return;const a=window.getComputedStyle(t).getPropertyValue(s);if(a){const i=a.trim();return U_(i)?parseFloat(i):i}return Om(n)?vb(n,t,r+1):n}function zm(e,t){return(e==null?void 0:e[t])??(e==null?void 0:e.default)??e}const yb=new Set(["width","height","top","left","right","bottom",...So]),JC={test:e=>e==="auto",parse:e=>e},wb=e=>t=>t.test(e),_b=[bo,Be,ln,Un,Vj,$j,JC],R1=e=>_b.find(wb(e));function QC(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||V_(e):!0}const ZC=new Set(["brightness","contrast","saturate","opacity"]);function e3(e){const[t,r]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[s]=r.match(Im)||[];if(!s)return e;const n=r.replace(s,"");let a=ZC.has(t)?1:0;return s!==r&&(a*=100),t+"("+a+n+")"}const t3=/\b([a-z-]*)\(.*?\)/gu,zh={...oa,getAnimatableNone:e=>{const t=e.match(t3);return t?t.map(e3).join(" "):e}},O1={...bo,transform:Math.round},r3={rotate:Un,rotateX:Un,rotateY:Un,rotateZ:Un,scale:tu,scaleX:tu,scaleY:tu,scaleZ:tu,skew:Un,skewX:Un,skewY:Un,distance:Be,translateX:Be,translateY:Be,translateZ:Be,x:Be,y:Be,z:Be,perspective:Be,transformPerspective:Be,opacity:Wl,originX:_1,originY:_1,originZ:Be},Wm={borderWidth:Be,borderTopWidth:Be,borderRightWidth:Be,borderBottomWidth:Be,borderLeftWidth:Be,borderRadius:Be,radius:Be,borderTopLeftRadius:Be,borderTopRightRadius:Be,borderBottomRightRadius:Be,borderBottomLeftRadius:Be,width:Be,maxWidth:Be,height:Be,maxHeight:Be,top:Be,right:Be,bottom:Be,left:Be,padding:Be,paddingTop:Be,paddingRight:Be,paddingBottom:Be,paddingLeft:Be,margin:Be,marginTop:Be,marginRight:Be,marginBottom:Be,marginLeft:Be,backgroundPositionX:Be,backgroundPositionY:Be,...r3,zIndex:O1,fillOpacity:Wl,strokeOpacity:Wl,numOctaves:O1},s3={...Wm,color:qt,backgroundColor:qt,outlineColor:qt,fill:qt,stroke:qt,borderColor:qt,borderTopColor:qt,borderRightColor:qt,borderBottomColor:qt,borderLeftColor:qt,filter:zh,WebkitFilter:zh},bb=e=>s3[e];function Sb(e,t){let r=bb(e);return r!==zh&&(r=oa),r.getAnimatableNone?r.getAnimatableNone(t):void 0}const n3=new Set(["auto","none","0"]);function a3(e,t,r){let s=0,n;for(;s<e.length&&!n;){const a=e[s];typeof a=="string"&&!n3.has(a)&&Hl(a).values.length&&(n=e[s]),s++}if(n&&r)for(const a of t)e[a]=Sb(r,n)}class i3 extends Vm{constructor(t,r,s,n,a){super(t,r,s,n,a,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:r,name:s}=this;if(!r||!r.current)return;super.readKeyframes();for(let c=0;c<t.length;c++){let u=t[c];if(typeof u=="string"&&(u=u.trim(),Om(u))){const d=vb(u,r.current);d!==void 0&&(t[c]=d),c===t.length-1&&(this.finalKeyframe=u)}}if(this.resolveNoneKeyframes(),!yb.has(s)||t.length!==2)return;const[n,a]=t,i=R1(n),o=R1(a);if(i!==o)if(C1(i)&&C1(o))for(let c=0;c<t.length;c++){const u=t[c];typeof u=="string"&&(t[c]=parseFloat(u))}else $a[s]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:r}=this,s=[];for(let n=0;n<t.length;n++)(t[n]===null||QC(t[n]))&&s.push(n);s.length&&a3(t,s,r)}measureInitialState(){const{element:t,unresolvedKeyframes:r,name:s}=this;if(!t||!t.current)return;s==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=$a[s](t.measureViewportBox(),window.getComputedStyle(t.current)),r[0]=this.measuredOrigin;const n=r[r.length-1];n!==void 0&&t.getValue(s,n).jump(n,!1)}measureEndState(){var o;const{element:t,name:r,unresolvedKeyframes:s}=this;if(!t||!t.current)return;const n=t.getValue(r);n&&n.jump(this.measuredOrigin,!1);const a=s.length-1,i=s[a];s[a]=$a[r](t.measureViewportBox(),window.getComputedStyle(t.current)),i!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=i),(o=this.removedTransforms)!=null&&o.length&&this.removedTransforms.forEach(([c,u])=>{t.getValue(c).set(u)}),this.resolveNoneKeyframes()}}function o3(e,t,r){if(e instanceof EventTarget)return[e];if(typeof e=="string"){let s=document;const n=(r==null?void 0:r[e])??s.querySelectorAll(e);return n?Array.from(n):[]}return Array.from(e)}const kb=(e,t)=>t&&typeof e=="number"?t.transform(e):e;function Eb(e){return $_(e)&&"offsetHeight"in e}const I1=30,l3=e=>!isNaN(parseFloat(e));class c3{constructor(t,r={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=s=>{var a;const n=Wr.now();if(this.updatedAt!==n&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(s),this.current!==this.prev&&((a=this.events.change)==null||a.notify(this.current),this.dependents))for(const i of this.dependents)i.dirty()},this.hasAnimated=!1,this.setCurrent(t),this.owner=r.owner}setCurrent(t){this.current=t,this.updatedAt=Wr.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=l3(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,r){this.events[t]||(this.events[t]=new Am);const s=this.events[t].add(r);return t==="change"?()=>{s(),yt.read(()=>{this.events.change.getSize()||this.stop()})}:s}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,r){this.passiveEffect=t,this.stopPassiveEffect=r}set(t){this.passiveEffect?this.passiveEffect(t,this.updateAndNotify):this.updateAndNotify(t)}setWithVelocity(t,r,s){this.set(r),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-s}jump(t,r=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,r&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var t;(t=this.events.change)==null||t.notify(this.current)}addDependent(t){this.dependents||(this.dependents=new Set),this.dependents.add(t)}removeDependent(t){this.dependents&&this.dependents.delete(t)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=Wr.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>I1)return 0;const r=Math.min(this.updatedAt-this.prevUpdatedAt,I1);return z_(parseFloat(this.current)-parseFloat(this.prevFrameValue),r)}start(t){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=t(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var t,r;(t=this.dependents)==null||t.clear(),(r=this.events.destroy)==null||r.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function co(e,t){return new c3(e,t)}const{schedule:Hm}=eb(queueMicrotask,!1),Ls={x:!1,y:!1};function Tb(){return Ls.x||Ls.y}function u3(e){return e==="x"||e==="y"?Ls[e]?null:(Ls[e]=!0,()=>{Ls[e]=!1}):Ls.x||Ls.y?null:(Ls.x=Ls.y=!0,()=>{Ls.x=Ls.y=!1})}function Nb(e,t){const r=o3(e),s=new AbortController,n={passive:!0,...t,signal:s.signal};return[r,n,()=>s.abort()]}function D1(e){return!(e.pointerType==="touch"||Tb())}function d3(e,t,r={}){const[s,n,a]=Nb(e,r),i=o=>{if(!D1(o))return;const{target:c}=o,u=t(c,o);if(typeof u!="function"||!c)return;const d=f=>{D1(f)&&(u(f),c.removeEventListener("pointerleave",d))};c.addEventListener("pointerleave",d,n)};return s.forEach(o=>{o.addEventListener("pointerenter",i,n)}),a}const jb=(e,t)=>t?e===t?!0:jb(e,t.parentElement):!1,qm=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1,f3=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function h3(e){return f3.has(e.tagName)||e.tabIndex!==-1}const Mu=new WeakSet;function L1(e){return t=>{t.key==="Enter"&&e(t)}}function tf(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const p3=(e,t)=>{const r=e.currentTarget;if(!r)return;const s=L1(()=>{if(Mu.has(r))return;tf(r,"down");const n=L1(()=>{tf(r,"up")}),a=()=>tf(r,"cancel");r.addEventListener("keyup",n,t),r.addEventListener("blur",a,t)});r.addEventListener("keydown",s,t),r.addEventListener("blur",()=>r.removeEventListener("keydown",s),t)};function M1(e){return qm(e)&&!Tb()}function m3(e,t,r={}){const[s,n,a]=Nb(e,r),i=o=>{const c=o.currentTarget;if(!M1(o))return;Mu.add(c);const u=t(c,o),d=(m,p)=>{window.removeEventListener("pointerup",f),window.removeEventListener("pointercancel",h),Mu.has(c)&&Mu.delete(c),M1(m)&&typeof u=="function"&&u(m,{success:p})},f=m=>{d(m,c===window||c===document||r.useGlobalTarget||jb(c,m.target))},h=m=>{d(m,!1)};window.addEventListener("pointerup",f,n),window.addEventListener("pointercancel",h,n)};return s.forEach(o=>{(r.useGlobalTarget?window:o).addEventListener("pointerdown",i,n),Eb(o)&&(o.addEventListener("focus",u=>p3(u,n)),!h3(o)&&!o.hasAttribute("tabindex")&&(o.tabIndex=0))}),a}function Cb(e){return $_(e)&&"ownerSVGElement"in e}function x3(e){return Cb(e)&&e.tagName==="svg"}const Sr=e=>!!(e&&e.getVelocity),g3=[..._b,qt,oa],v3=e=>g3.find(wb(e)),Gm=F.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});function B1(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function y3(...e){return t=>{let r=!1;const s=e.map(n=>{const a=B1(n,t);return!r&&typeof a=="function"&&(r=!0),a});if(r)return()=>{for(let n=0;n<s.length;n++){const a=s[n];typeof a=="function"?a():B1(e[n],null)}}}}function w3(...e){return F.useCallback(y3(...e),e)}class _3 extends F.Component{getSnapshotBeforeUpdate(t){const r=this.props.childRef.current;if(r&&t.isPresent&&!this.props.isPresent){const s=r.offsetParent,n=Eb(s)&&s.offsetWidth||0,a=this.props.sizeRef.current;a.height=r.offsetHeight||0,a.width=r.offsetWidth||0,a.top=r.offsetTop,a.left=r.offsetLeft,a.right=n-a.width-a.left}return null}componentDidUpdate(){}render(){return this.props.children}}function b3({children:e,isPresent:t,anchorX:r,root:s}){const n=F.useId(),a=F.useRef(null),i=F.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:o}=F.useContext(Gm),c=w3(a,e==null?void 0:e.ref);return F.useInsertionEffect(()=>{const{width:u,height:d,top:f,left:h,right:m}=i.current;if(t||!a.current||!u||!d)return;const p=r==="left"?`left: ${h}`:`right: ${m}`;a.current.dataset.motionPopId=n;const x=document.createElement("style");o&&(x.nonce=o);const v=s??document.head;return v.appendChild(x),x.sheet&&x.sheet.insertRule(`
          [data-motion-pop-id="${n}"] {
            position: absolute !important;
            width: ${u}px !important;
            height: ${d}px !important;
            ${p}px !important;
            top: ${f}px !important;
          }
        `),()=>{v.contains(x)&&v.removeChild(x)}},[t]),l.jsx(_3,{isPresent:t,childRef:a,sizeRef:i,children:F.cloneElement(e,{ref:c})})}const S3=({children:e,initial:t,isPresent:r,onExitComplete:s,custom:n,presenceAffectsLayout:a,mode:i,anchorX:o,root:c})=>{const u=km(k3),d=F.useId();let f=!0,h=F.useMemo(()=>(f=!1,{id:d,initial:t,isPresent:r,custom:n,onExitComplete:m=>{u.set(m,!0);for(const p of u.values())if(!p)return;s&&s()},register:m=>(u.set(m,!1),()=>u.delete(m))}),[r,u,s]);return a&&f&&(h={...h}),F.useMemo(()=>{u.forEach((m,p)=>u.set(p,!1))},[r]),F.useEffect(()=>{!r&&!u.size&&s&&s()},[r]),i==="popLayout"&&(e=l.jsx(b3,{isPresent:r,anchorX:o,root:c,children:e})),l.jsx(e0.Provider,{value:h,children:e})};function k3(){return new Map}function Ab(e=!0){const t=F.useContext(e0);if(t===null)return[!0,null];const{isPresent:r,onExitComplete:s,register:n}=t,a=F.useId();F.useEffect(()=>{if(e)return n(a)},[e]);const i=F.useCallback(()=>e&&s&&s(a),[a,s,e]);return!r&&s?[!1,i]:[!0]}const ru=e=>e.key||"";function U1(e){const t=[];return F.Children.forEach(e,r=>{F.isValidElement(r)&&t.push(r)}),t}const Km=({children:e,custom:t,initial:r=!0,onExitComplete:s,presenceAffectsLayout:n=!0,mode:a="sync",propagate:i=!1,anchorX:o="left",root:c})=>{const[u,d]=Ab(i),f=F.useMemo(()=>U1(e),[e]),h=i&&!u?[]:f.map(ru),m=F.useRef(!0),p=F.useRef(f),x=km(()=>new Map),[v,y]=F.useState(f),[w,g]=F.useState(f);B_(()=>{m.current=!1,p.current=f;for(let k=0;k<w.length;k++){const S=ru(w[k]);h.includes(S)?x.delete(S):x.get(S)!==!0&&x.set(S,!1)}},[w,h.length,h.join("-")]);const _=[];if(f!==v){let k=[...f];for(let S=0;S<w.length;S++){const T=w[S],j=ru(T);h.includes(j)||(k.splice(S,0,T),_.push(T))}return a==="wait"&&_.length&&(k=_),g(U1(k)),y(f),null}const{forceRender:b}=F.useContext(Sm);return l.jsx(l.Fragment,{children:w.map(k=>{const S=ru(k),T=i&&!u?!1:f===w||h.includes(S),j=()=>{if(x.has(S))x.set(S,!0);else return;let U=!0;x.forEach(H=>{H||(U=!1)}),U&&(b==null||b(),g(p.current),i&&(d==null||d()),s&&s())};return l.jsx(S3,{isPresent:T,initial:!m.current||r?void 0:!1,custom:t,presenceAffectsLayout:n,mode:a,root:c,onExitComplete:T?void 0:j,anchorX:o,children:k},S)})})},Fb=F.createContext({strict:!1}),$1={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},uo={};for(const e in $1)uo[e]={isEnabled:t=>$1[e].some(r=>!!t[r])};function E3(e){for(const t in e)uo[t]={...uo[t],...e[t]}}const T3=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function xd(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||T3.has(e)}let Pb=e=>!xd(e);function N3(e){typeof e=="function"&&(Pb=t=>t.startsWith("on")?!xd(t):e(t))}try{N3(require("@emotion/is-prop-valid").default)}catch{}function j3(e,t,r){const s={};for(const n in e)n==="values"&&typeof e.values=="object"||(Pb(n)||r===!0&&xd(n)||!t&&!xd(n)||e.draggable&&n.startsWith("onDrag"))&&(s[n]=e[n]);return s}const t0=F.createContext({});function r0(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}function ql(e){return typeof e=="string"||Array.isArray(e)}const Xm=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Ym=["initial",...Xm];function s0(e){return r0(e.animate)||Ym.some(t=>ql(e[t]))}function Rb(e){return!!(s0(e)||e.variants)}function C3(e,t){if(s0(e)){const{initial:r,animate:s}=e;return{initial:r===!1||ql(r)?r:void 0,animate:ql(s)?s:void 0}}return e.inherit!==!1?t:{}}function A3(e){const{initial:t,animate:r}=C3(e,F.useContext(t0));return F.useMemo(()=>({initial:t,animate:r}),[V1(t),V1(r)])}function V1(e){return Array.isArray(e)?e.join(" "):e}const Gl={};function F3(e){for(const t in e)Gl[t]=e[t],Rm(t)&&(Gl[t].isCSSVariable=!0)}function Ob(e,{layout:t,layoutId:r}){return ko.has(e)||e.startsWith("origin")||(t||r!==void 0)&&(!!Gl[e]||e==="opacity")}const P3={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},R3=So.length;function O3(e,t,r){let s="",n=!0;for(let a=0;a<R3;a++){const i=So[a],o=e[i];if(o===void 0)continue;let c=!0;if(typeof o=="number"?c=o===(i.startsWith("scale")?1:0):c=parseFloat(o)===0,!c||r){const u=kb(o,Wm[i]);if(!c){n=!1;const d=P3[i]||i;s+=`${d}(${u}) `}r&&(t[i]=u)}}return s=s.trim(),r?s=r(t,n?"":s):n&&(s="none"),s}function Jm(e,t,r){const{style:s,vars:n,transformOrigin:a}=e;let i=!1,o=!1;for(const c in t){const u=t[c];if(ko.has(c)){i=!0;continue}else if(Rm(c)){n[c]=u;continue}else{const d=kb(u,Wm[c]);c.startsWith("origin")?(o=!0,a[c]=d):s[c]=d}}if(t.transform||(i||r?s.transform=O3(t,e.transform,r):s.transform&&(s.transform="none")),o){const{originX:c="50%",originY:u="50%",originZ:d=0}=a;s.transformOrigin=`${c} ${u} ${d}`}}const Qm=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function Ib(e,t,r){for(const s in t)!Sr(t[s])&&!Ob(s,r)&&(e[s]=t[s])}function I3({transformTemplate:e},t){return F.useMemo(()=>{const r=Qm();return Jm(r,t,e),Object.assign({},r.vars,r.style)},[t])}function D3(e,t){const r=e.style||{},s={};return Ib(s,r,e),Object.assign(s,I3(e,t)),s}function L3(e,t){const r={},s=D3(e,t);return e.drag&&e.dragListener!==!1&&(r.draggable=!1,s.userSelect=s.WebkitUserSelect=s.WebkitTouchCallout="none",s.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(r.tabIndex=0),r.style=s,r}const M3={offset:"stroke-dashoffset",array:"stroke-dasharray"},B3={offset:"strokeDashoffset",array:"strokeDasharray"};function U3(e,t,r=1,s=0,n=!0){e.pathLength=1;const a=n?M3:B3;e[a.offset]=Be.transform(-s);const i=Be.transform(t),o=Be.transform(r);e[a.array]=`${i} ${o}`}function Db(e,{attrX:t,attrY:r,attrScale:s,pathLength:n,pathSpacing:a=1,pathOffset:i=0,...o},c,u,d){if(Jm(e,o,u),c){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:f,style:h}=e;f.transform&&(h.transform=f.transform,delete f.transform),(h.transform||f.transformOrigin)&&(h.transformOrigin=f.transformOrigin??"50% 50%",delete f.transformOrigin),h.transform&&(h.transformBox=(d==null?void 0:d.transformBox)??"fill-box",delete f.transformBox),t!==void 0&&(f.x=t),r!==void 0&&(f.y=r),s!==void 0&&(f.scale=s),n!==void 0&&U3(f,n,a,i,!1)}const Lb=()=>({...Qm(),attrs:{}}),Mb=e=>typeof e=="string"&&e.toLowerCase()==="svg";function $3(e,t,r,s){const n=F.useMemo(()=>{const a=Lb();return Db(a,t,Mb(s),e.transformTemplate,e.style),{...a.attrs,style:{...a.style}}},[t]);if(e.style){const a={};Ib(a,e.style,e),n.style={...a,...n.style}}return n}const V3=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function Zm(e){return typeof e!="string"||e.includes("-")?!1:!!(V3.indexOf(e)>-1||/[A-Z]/u.test(e))}function z3(e,t,r,{latestValues:s},n,a=!1){const o=(Zm(e)?$3:L3)(t,s,n,e),c=j3(t,typeof e=="string",a),u=e!==F.Fragment?{...c,...o,ref:r}:{},{children:d}=t,f=F.useMemo(()=>Sr(d)?d.get():d,[d]);return F.createElement(e,{...u,children:f})}function z1(e){const t=[{},{}];return e==null||e.values.forEach((r,s)=>{t[0][s]=r.get(),t[1][s]=r.getVelocity()}),t}function ex(e,t,r,s){if(typeof t=="function"){const[n,a]=z1(s);t=t(r!==void 0?r:e.custom,n,a)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[n,a]=z1(s);t=t(r!==void 0?r:e.custom,n,a)}return t}function Bu(e){return Sr(e)?e.get():e}function W3({scrapeMotionValuesFromProps:e,createRenderState:t},r,s,n){return{latestValues:H3(r,s,n,e),renderState:t()}}function H3(e,t,r,s){const n={},a=s(e,{});for(const h in a)n[h]=Bu(a[h]);let{initial:i,animate:o}=e;const c=s0(e),u=Rb(e);t&&u&&!c&&e.inherit!==!1&&(i===void 0&&(i=t.initial),o===void 0&&(o=t.animate));let d=r?r.initial===!1:!1;d=d||i===!1;const f=d?o:i;if(f&&typeof f!="boolean"&&!r0(f)){const h=Array.isArray(f)?f:[f];for(let m=0;m<h.length;m++){const p=ex(e,h[m]);if(p){const{transitionEnd:x,transition:v,...y}=p;for(const w in y){let g=y[w];if(Array.isArray(g)){const _=d?g.length-1:0;g=g[_]}g!==null&&(n[w]=g)}for(const w in x)n[w]=x[w]}}}return n}const Bb=e=>(t,r)=>{const s=F.useContext(t0),n=F.useContext(e0),a=()=>W3(e,t,s,n);return r?a():km(a)};function tx(e,t,r){var a;const{style:s}=e,n={};for(const i in s)(Sr(s[i])||t.style&&Sr(t.style[i])||Ob(i,e)||((a=r==null?void 0:r.getValue(i))==null?void 0:a.liveStyle)!==void 0)&&(n[i]=s[i]);return n}const q3=Bb({scrapeMotionValuesFromProps:tx,createRenderState:Qm});function Ub(e,t,r){const s=tx(e,t,r);for(const n in e)if(Sr(e[n])||Sr(t[n])){const a=So.indexOf(n)!==-1?"attr"+n.charAt(0).toUpperCase()+n.substring(1):n;s[a]=e[n]}return s}const G3=Bb({scrapeMotionValuesFromProps:Ub,createRenderState:Lb}),K3=Symbol.for("motionComponentSymbol");function Mi(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function X3(e,t,r){return F.useCallback(s=>{s&&e.onMount&&e.onMount(s),t&&(s?t.mount(s):t.unmount()),r&&(typeof r=="function"?r(s):Mi(r)&&(r.current=s))},[t])}const rx=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),Y3="framerAppearId",$b="data-"+rx(Y3),Vb=F.createContext({});function J3(e,t,r,s,n){var x,v;const{visualElement:a}=F.useContext(t0),i=F.useContext(Fb),o=F.useContext(e0),c=F.useContext(Gm).reducedMotion,u=F.useRef(null);s=s||i.renderer,!u.current&&s&&(u.current=s(e,{visualState:t,parent:a,props:r,presenceContext:o,blockInitialAnimation:o?o.initial===!1:!1,reducedMotionConfig:c}));const d=u.current,f=F.useContext(Vb);d&&!d.projection&&n&&(d.type==="html"||d.type==="svg")&&Q3(u.current,r,n,f);const h=F.useRef(!1);F.useInsertionEffect(()=>{d&&h.current&&d.update(r,o)});const m=r[$b],p=F.useRef(!!m&&!((x=window.MotionHandoffIsComplete)!=null&&x.call(window,m))&&((v=window.MotionHasOptimisedAnimation)==null?void 0:v.call(window,m)));return B_(()=>{d&&(h.current=!0,window.MotionIsMounted=!0,d.updateFeatures(),d.scheduleRenderMicrotask(),p.current&&d.animationState&&d.animationState.animateChanges())}),F.useEffect(()=>{d&&(!p.current&&d.animationState&&d.animationState.animateChanges(),p.current&&(queueMicrotask(()=>{var y;(y=window.MotionHandoffMarkAsComplete)==null||y.call(window,m)}),p.current=!1),d.enteringChildren=void 0)}),d}function Q3(e,t,r,s){const{layoutId:n,layout:a,drag:i,dragConstraints:o,layoutScroll:c,layoutRoot:u,layoutCrossfade:d}=t;e.projection=new r(e.latestValues,t["data-framer-portal-id"]?void 0:zb(e.parent)),e.projection.setOptions({layoutId:n,layout:a,alwaysMeasureLayout:!!i||o&&Mi(o),visualElement:e,animationType:typeof a=="string"?a:"both",initialPromotionConfig:s,crossfade:d,layoutScroll:c,layoutRoot:u})}function zb(e){if(e)return e.options.allowProjection!==!1?e.projection:zb(e.parent)}function rf(e,{forwardMotionProps:t=!1}={},r,s){r&&E3(r);const n=Zm(e)?G3:q3;function a(o,c){let u;const d={...F.useContext(Gm),...o,layoutId:Z3(o)},{isStatic:f}=d,h=A3(o),m=n(o,f);if(!f&&Em){eA();const p=tA(d);u=p.MeasureLayout,h.visualElement=J3(e,m,d,s,p.ProjectionNode)}return l.jsxs(t0.Provider,{value:h,children:[u&&h.visualElement?l.jsx(u,{visualElement:h.visualElement,...d}):null,z3(e,o,X3(m,h.visualElement,c),m,f,t)]})}a.displayName=`motion.${typeof e=="string"?e:`create(${e.displayName??e.name??""})`}`;const i=F.forwardRef(a);return i[K3]=e,i}function Z3({layoutId:e}){const t=F.useContext(Sm).id;return t&&e!==void 0?t+"-"+e:e}function eA(e,t){F.useContext(Fb).strict}function tA(e){const{drag:t,layout:r}=uo;if(!t&&!r)return{};const s={...t,...r};return{MeasureLayout:t!=null&&t.isEnabled(e)||r!=null&&r.isEnabled(e)?s.MeasureLayout:void 0,ProjectionNode:s.ProjectionNode}}function rA(e,t){if(typeof Proxy>"u")return rf;const r=new Map,s=(a,i)=>rf(a,i,e,t),n=(a,i)=>s(a,i);return new Proxy(n,{get:(a,i)=>i==="create"?s:(r.has(i)||r.set(i,rf(i,void 0,e,t)),r.get(i))})}function Wb({top:e,left:t,right:r,bottom:s}){return{x:{min:t,max:r},y:{min:e,max:s}}}function sA({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function nA(e,t){if(!t)return e;const r=t({x:e.left,y:e.top}),s=t({x:e.right,y:e.bottom});return{top:r.y,left:r.x,bottom:s.y,right:s.x}}function sf(e){return e===void 0||e===1}function Wh({scale:e,scaleX:t,scaleY:r}){return!sf(e)||!sf(t)||!sf(r)}function Ta(e){return Wh(e)||Hb(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function Hb(e){return W1(e.x)||W1(e.y)}function W1(e){return e&&e!=="0%"}function gd(e,t,r){const s=e-r,n=t*s;return r+n}function H1(e,t,r,s,n){return n!==void 0&&(e=gd(e,n,s)),gd(e,r,s)+t}function Hh(e,t=0,r=1,s,n){e.min=H1(e.min,t,r,s,n),e.max=H1(e.max,t,r,s,n)}function qb(e,{x:t,y:r}){Hh(e.x,t.translate,t.scale,t.originPoint),Hh(e.y,r.translate,r.scale,r.originPoint)}const q1=.999999999999,G1=1.0000000000001;function aA(e,t,r,s=!1){const n=r.length;if(!n)return;t.x=t.y=1;let a,i;for(let o=0;o<n;o++){a=r[o],i=a.projectionDelta;const{visualElement:c}=a.options;c&&c.props.style&&c.props.style.display==="contents"||(s&&a.options.layoutScroll&&a.scroll&&a!==a.root&&Ui(e,{x:-a.scroll.offset.x,y:-a.scroll.offset.y}),i&&(t.x*=i.x.scale,t.y*=i.y.scale,qb(e,i)),s&&Ta(a.latestValues)&&Ui(e,a.latestValues))}t.x<G1&&t.x>q1&&(t.x=1),t.y<G1&&t.y>q1&&(t.y=1)}function Bi(e,t){e.min=e.min+t,e.max=e.max+t}function K1(e,t,r,s,n=.5){const a=Tt(e.min,e.max,n);Hh(e,t,r,a,s)}function Ui(e,t){K1(e.x,t.x,t.scaleX,t.scale,t.originX),K1(e.y,t.y,t.scaleY,t.scale,t.originY)}function Gb(e,t){return Wb(nA(e.getBoundingClientRect(),t))}function iA(e,t,r){const s=Gb(e,r),{scroll:n}=t;return n&&(Bi(s.x,n.offset.x),Bi(s.y,n.offset.y)),s}const X1=()=>({translate:0,scale:1,origin:0,originPoint:0}),$i=()=>({x:X1(),y:X1()}),Y1=()=>({min:0,max:0}),Lt=()=>({x:Y1(),y:Y1()}),qh={current:null},Kb={current:!1};function oA(){if(Kb.current=!0,!!Em)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>qh.current=e.matches;e.addEventListener("change",t),t()}else qh.current=!1}const lA=new WeakMap;function cA(e,t,r){for(const s in t){const n=t[s],a=r[s];if(Sr(n))e.addValue(s,n);else if(Sr(a))e.addValue(s,co(n,{owner:e}));else if(a!==n)if(e.hasValue(s)){const i=e.getValue(s);i.liveStyle===!0?i.jump(n):i.hasAnimated||i.set(n)}else{const i=e.getStaticValue(s);e.addValue(s,co(i!==void 0?i:n,{owner:e}))}}for(const s in r)t[s]===void 0&&e.removeValue(s);return t}const J1=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class uA{scrapeMotionValuesFromProps(t,r,s){return{}}constructor({parent:t,props:r,presenceContext:s,reducedMotionConfig:n,blockInitialAnimation:a,visualState:i},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=Vm,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const h=Wr.now();this.renderScheduledAt<h&&(this.renderScheduledAt=h,yt.render(this.render,!1,!0))};const{latestValues:c,renderState:u}=i;this.latestValues=c,this.baseTarget={...c},this.initialValues=r.initial?{...c}:{},this.renderState=u,this.parent=t,this.props=r,this.presenceContext=s,this.depth=t?t.depth+1:0,this.reducedMotionConfig=n,this.options=o,this.blockInitialAnimation=!!a,this.isControllingVariants=s0(r),this.isVariantNode=Rb(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:d,...f}=this.scrapeMotionValuesFromProps(r,{},this);for(const h in f){const m=f[h];c[h]!==void 0&&Sr(m)&&m.set(c[h])}}mount(t){var r;this.current=t,lA.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((s,n)=>this.bindToMotionValue(n,s)),Kb.current||oA(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:qh.current,(r=this.parent)==null||r.addChild(this),this.update(this.props,this.presenceContext)}unmount(){var t;this.projection&&this.projection.unmount(),ia(this.notifyUpdate),ia(this.render),this.valueSubscriptions.forEach(r=>r()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),(t=this.parent)==null||t.removeChild(this);for(const r in this.events)this.events[r].clear();for(const r in this.features){const s=this.features[r];s&&(s.unmount(),s.isMounted=!1)}this.current=null}addChild(t){this.children.add(t),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(t)}removeChild(t){this.children.delete(t),this.enteringChildren&&this.enteringChildren.delete(t)}bindToMotionValue(t,r){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const s=ko.has(t);s&&this.onBindTransform&&this.onBindTransform();const n=r.on("change",i=>{this.latestValues[t]=i,this.props.onUpdate&&yt.preRender(this.notifyUpdate),s&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,t,r)),this.valueSubscriptions.set(t,()=>{n(),a&&a(),r.owner&&r.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in uo){const r=uo[t];if(!r)continue;const{isEnabled:s,Feature:n}=r;if(!this.features[t]&&n&&s(this.props)&&(this.features[t]=new n(this)),this.features[t]){const a=this.features[t];a.isMounted?a.update():(a.mount(),a.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Lt()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,r){this.latestValues[t]=r}update(t,r){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let s=0;s<J1.length;s++){const n=J1[s];this.propEventSubscriptions[n]&&(this.propEventSubscriptions[n](),delete this.propEventSubscriptions[n]);const a="on"+n,i=t[a];i&&(this.propEventSubscriptions[n]=this.on(n,i))}this.prevMotionValues=cA(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(t),()=>r.variantChildren.delete(t)}addValue(t,r){const s=this.values.get(t);r!==s&&(s&&this.removeValue(t),this.bindToMotionValue(t,r),this.values.set(t,r),this.latestValues[t]=r.get())}removeValue(t){this.values.delete(t);const r=this.valueSubscriptions.get(t);r&&(r(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,r){if(this.props.values&&this.props.values[t])return this.props.values[t];let s=this.values.get(t);return s===void 0&&r!==void 0&&(s=co(r===null?void 0:r,{owner:this}),this.addValue(t,s)),s}readValue(t,r){let s=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:this.getBaseTargetFromProps(this.props,t)??this.readValueFromInstance(this.current,t,this.options);return s!=null&&(typeof s=="string"&&(U_(s)||V_(s))?s=parseFloat(s):!v3(s)&&oa.test(r)&&(s=Sb(t,r)),this.setBaseTarget(t,Sr(s)?s.get():s)),Sr(s)?s.get():s}setBaseTarget(t,r){this.baseTarget[t]=r}getBaseTarget(t){var a;const{initial:r}=this.props;let s;if(typeof r=="string"||typeof r=="object"){const i=ex(this.props,r,(a=this.presenceContext)==null?void 0:a.custom);i&&(s=i[t])}if(r&&s!==void 0)return s;const n=this.getBaseTargetFromProps(this.props,t);return n!==void 0&&!Sr(n)?n:this.initialValues[t]!==void 0&&s===void 0?void 0:this.baseTarget[t]}on(t,r){return this.events[t]||(this.events[t]=new Am),this.events[t].add(r)}notify(t,...r){this.events[t]&&this.events[t].notify(...r)}scheduleRenderMicrotask(){Hm.render(this.render)}}class Xb extends uA{constructor(){super(...arguments),this.KeyframeResolver=i3}sortInstanceNodePosition(t,r){return t.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(t,r){return t.style?t.style[r]:void 0}removeValueFromRenderState(t,{vars:r,style:s}){delete r[t],delete s[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;Sr(t)&&(this.childSubscription=t.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}}function Yb(e,{style:t,vars:r},s,n){const a=e.style;let i;for(i in t)a[i]=t[i];n==null||n.applyProjectionStyles(a,s);for(i in r)a.setProperty(i,r[i])}function dA(e){return window.getComputedStyle(e)}class fA extends Xb{constructor(){super(...arguments),this.type="html",this.renderInstance=Yb}readValueFromInstance(t,r){var s;if(ko.has(r))return(s=this.projection)!=null&&s.isProjecting?Lh(r):EC(t,r);{const n=dA(t),a=(Rm(r)?n.getPropertyValue(r):n[r])||0;return typeof a=="string"?a.trim():a}}measureInstanceViewportBox(t,{transformPagePoint:r}){return Gb(t,r)}build(t,r,s){Jm(t,r,s.transformTemplate)}scrapeMotionValuesFromProps(t,r,s){return tx(t,r,s)}}const Jb=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function hA(e,t,r,s){Yb(e,t,void 0,s);for(const n in t.attrs)e.setAttribute(Jb.has(n)?n:rx(n),t.attrs[n])}class pA extends Xb{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Lt}getBaseTargetFromProps(t,r){return t[r]}readValueFromInstance(t,r){if(ko.has(r)){const s=bb(r);return s&&s.default||0}return r=Jb.has(r)?r:rx(r),t.getAttribute(r)}scrapeMotionValuesFromProps(t,r,s){return Ub(t,r,s)}build(t,r,s){Db(t,r,this.isSVGTag,s.transformTemplate,s.style)}renderInstance(t,r,s,n){hA(t,r,s,n)}mount(t){this.isSVGTag=Mb(t.tagName),super.mount(t)}}const mA=(e,t)=>Zm(e)?new pA(t):new fA(t,{allowProjection:e!==F.Fragment});function Xi(e,t,r){const s=e.getProps();return ex(s,t,r!==void 0?r:s.custom,e)}const Gh=e=>Array.isArray(e);function xA(e,t,r){e.hasValue(t)?e.getValue(t).set(r):e.addValue(t,co(r))}function gA(e){return Gh(e)?e[e.length-1]||0:e}function vA(e,t){const r=Xi(e,t);let{transitionEnd:s={},transition:n={},...a}=r||{};a={...a,...s};for(const i in a){const o=gA(a[i]);xA(e,i,o)}}function yA(e){return!!(Sr(e)&&e.add)}function Kh(e,t){const r=e.getValue("willChange");if(yA(r))return r.add(t);if(!r&&Fn.WillChange){const s=new Fn.WillChange("auto");e.addValue("willChange",s),s.add(t)}}function Qb(e){return e.props[$b]}const wA=e=>e!==null;function _A(e,{repeat:t,repeatType:r="loop"},s){const n=e.filter(wA),a=t&&r!=="loop"&&t%2===1?0:n.length-1;return n[a]}const bA={type:"spring",stiffness:500,damping:25,restSpeed:10},SA=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),kA={type:"keyframes",duration:.8},EA={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},TA=(e,{keyframes:t})=>t.length>2?kA:ko.has(e)?e.startsWith("scale")?SA(t[1]):bA:EA;function NA({when:e,delay:t,delayChildren:r,staggerChildren:s,staggerDirection:n,repeat:a,repeatType:i,repeatDelay:o,from:c,elapsed:u,...d}){return!!Object.keys(d).length}const sx=(e,t,r,s={},n,a)=>i=>{const o=zm(s,e)||{},c=o.delay||s.delay||0;let{elapsed:u=0}=s;u=u-on(c);const d={keyframes:Array.isArray(r)?r:[null,r],ease:"easeOut",velocity:t.getVelocity(),...o,delay:-u,onUpdate:h=>{t.set(h),o.onUpdate&&o.onUpdate(h)},onComplete:()=>{i(),o.onComplete&&o.onComplete()},name:e,motionValue:t,element:a?void 0:n};NA(o)||Object.assign(d,TA(e,d)),d.duration&&(d.duration=on(d.duration)),d.repeatDelay&&(d.repeatDelay=on(d.repeatDelay)),d.from!==void 0&&(d.keyframes[0]=d.from);let f=!1;if((d.type===!1||d.duration===0&&!d.repeatDelay)&&(Vh(d),d.delay===0&&(f=!0)),(Fn.instantAnimations||Fn.skipAnimations)&&(f=!0,Vh(d),d.delay=0),d.allowFlatten=!o.type&&!o.ease,f&&!a&&t.get()!==void 0){const h=_A(d.keyframes,o);if(h!==void 0){yt.update(()=>{d.onUpdate(h),d.onComplete()});return}}return o.isSync?new $m(d):new KC(d)};function jA({protectedKeys:e,needsAnimating:t},r){const s=e.hasOwnProperty(r)&&t[r]!==!0;return t[r]=!1,s}function Zb(e,t,{delay:r=0,transitionOverride:s,type:n}={}){let{transition:a=e.getDefaultTransition(),transitionEnd:i,...o}=t;s&&(a=s);const c=[],u=n&&e.animationState&&e.animationState.getState()[n];for(const d in o){const f=e.getValue(d,e.latestValues[d]??null),h=o[d];if(h===void 0||u&&jA(u,d))continue;const m={delay:r,...zm(a||{},d)},p=f.get();if(p!==void 0&&!f.isAnimating&&!Array.isArray(h)&&h===p&&!m.velocity)continue;let x=!1;if(window.MotionHandoffAnimation){const y=Qb(e);if(y){const w=window.MotionHandoffAnimation(y,d,yt);w!==null&&(m.startTime=w,x=!0)}}Kh(e,d),f.start(sx(d,f,h,e.shouldReduceMotion&&yb.has(d)?{type:!1}:m,e,x));const v=f.animation;v&&c.push(v)}return i&&Promise.all(c).then(()=>{yt.update(()=>{i&&vA(e,i)})}),c}function eS(e,t,r,s=0,n=1){const a=Array.from(e).sort((u,d)=>u.sortNodePosition(d)).indexOf(t),i=e.size,o=(i-1)*s;return typeof r=="function"?r(a,i):n===1?a*s:o-a*s}function Xh(e,t,r={}){var c;const s=Xi(e,t,r.type==="exit"?(c=e.presenceContext)==null?void 0:c.custom:void 0);let{transition:n=e.getDefaultTransition()||{}}=s||{};r.transitionOverride&&(n=r.transitionOverride);const a=s?()=>Promise.all(Zb(e,s,r)):()=>Promise.resolve(),i=e.variantChildren&&e.variantChildren.size?(u=0)=>{const{delayChildren:d=0,staggerChildren:f,staggerDirection:h}=n;return CA(e,t,u,d,f,h,r)}:()=>Promise.resolve(),{when:o}=n;if(o){const[u,d]=o==="beforeChildren"?[a,i]:[i,a];return u().then(()=>d())}else return Promise.all([a(),i(r.delay)])}function CA(e,t,r=0,s=0,n=0,a=1,i){const o=[];for(const c of e.variantChildren)c.notify("AnimationStart",t),o.push(Xh(c,t,{...i,delay:r+(typeof s=="function"?0:s)+eS(e.variantChildren,c,s,n,a)}).then(()=>c.notify("AnimationComplete",t)));return Promise.all(o)}function AA(e,t,r={}){e.notify("AnimationStart",t);let s;if(Array.isArray(t)){const n=t.map(a=>Xh(e,a,r));s=Promise.all(n)}else if(typeof t=="string")s=Xh(e,t,r);else{const n=typeof t=="function"?Xi(e,t,r.custom):t;s=Promise.all(Zb(e,n,r))}return s.then(()=>{e.notify("AnimationComplete",t)})}function tS(e,t){if(!Array.isArray(t))return!1;const r=t.length;if(r!==e.length)return!1;for(let s=0;s<r;s++)if(t[s]!==e[s])return!1;return!0}const FA=Ym.length;function rS(e){if(!e)return;if(!e.isControllingVariants){const r=e.parent?rS(e.parent)||{}:{};return e.props.initial!==void 0&&(r.initial=e.props.initial),r}const t={};for(let r=0;r<FA;r++){const s=Ym[r],n=e.props[s];(ql(n)||n===!1)&&(t[s]=n)}return t}const PA=[...Xm].reverse(),RA=Xm.length;function OA(e){return t=>Promise.all(t.map(({animation:r,options:s})=>AA(e,r,s)))}function IA(e){let t=OA(e),r=Q1(),s=!0;const n=c=>(u,d)=>{var h;const f=Xi(e,d,c==="exit"?(h=e.presenceContext)==null?void 0:h.custom:void 0);if(f){const{transition:m,transitionEnd:p,...x}=f;u={...u,...x,...p}}return u};function a(c){t=c(e)}function i(c){const{props:u}=e,d=rS(e.parent)||{},f=[],h=new Set;let m={},p=1/0;for(let v=0;v<RA;v++){const y=PA[v],w=r[y],g=u[y]!==void 0?u[y]:d[y],_=ql(g),b=y===c?w.isActive:null;b===!1&&(p=v);let k=g===d[y]&&g!==u[y]&&_;if(k&&s&&e.manuallyAnimateOnMount&&(k=!1),w.protectedKeys={...m},!w.isActive&&b===null||!g&&!w.prevProp||r0(g)||typeof g=="boolean")continue;const S=DA(w.prevProp,g);let T=S||y===c&&w.isActive&&!k&&_||v>p&&_,j=!1;const U=Array.isArray(g)?g:[g];let H=U.reduce(n(y),{});b===!1&&(H={});const{prevResolvedValues:z={}}=w,q={...z,...H},re=J=>{T=!0,h.has(J)&&(j=!0,h.delete(J)),w.needsAnimating[J]=!0;const G=e.getValue(J);G&&(G.liveStyle=!1)};for(const J in q){const G=H[J],D=z[J];if(m.hasOwnProperty(J))continue;let K=!1;Gh(G)&&Gh(D)?K=!tS(G,D):K=G!==D,K?G!=null?re(J):h.add(J):G!==void 0&&h.has(J)?re(J):w.protectedKeys[J]=!0}w.prevProp=g,w.prevResolvedValues=H,w.isActive&&(m={...m,...H}),s&&e.blockInitialAnimation&&(T=!1);const X=k&&S;T&&(!X||j)&&f.push(...U.map(J=>{const G={type:y};if(typeof J=="string"&&s&&!X&&e.manuallyAnimateOnMount&&e.parent){const{parent:D}=e,K=Xi(D,J);if(D.enteringChildren&&K){const{delayChildren:oe}=K.transition||{};G.delay=eS(D.enteringChildren,e,oe)}}return{animation:J,options:G}}))}if(h.size){const v={};if(typeof u.initial!="boolean"){const y=Xi(e,Array.isArray(u.initial)?u.initial[0]:u.initial);y&&y.transition&&(v.transition=y.transition)}h.forEach(y=>{const w=e.getBaseTarget(y),g=e.getValue(y);g&&(g.liveStyle=!0),v[y]=w??null}),f.push({animation:v})}let x=!!f.length;return s&&(u.initial===!1||u.initial===u.animate)&&!e.manuallyAnimateOnMount&&(x=!1),s=!1,x?t(f):Promise.resolve()}function o(c,u){var f;if(r[c].isActive===u)return Promise.resolve();(f=e.variantChildren)==null||f.forEach(h=>{var m;return(m=h.animationState)==null?void 0:m.setActive(c,u)}),r[c].isActive=u;const d=i(c);for(const h in r)r[h].protectedKeys={};return d}return{animateChanges:i,setActive:o,setAnimateFunction:a,getState:()=>r,reset:()=>{r=Q1()}}}function DA(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!tS(t,e):!1}function _a(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function Q1(){return{animate:_a(!0),whileInView:_a(),whileHover:_a(),whileTap:_a(),whileDrag:_a(),whileFocus:_a(),exit:_a()}}class ma{constructor(t){this.isMounted=!1,this.node=t}update(){}}class LA extends ma{constructor(t){super(t),t.animationState||(t.animationState=IA(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();r0(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:r}=this.node.prevProps||{};t!==r&&this.updateAnimationControlsSubscription()}unmount(){var t;this.node.animationState.reset(),(t=this.unmountControls)==null||t.call(this)}}let MA=0;class BA extends ma{constructor(){super(...arguments),this.id=MA++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:r}=this.node.presenceContext,{isPresent:s}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===s)return;const n=this.node.animationState.setActive("exit",!t);r&&!t&&n.then(()=>{r(this.id)})}mount(){const{register:t,onExitComplete:r}=this.node.presenceContext||{};r&&r(this.id),t&&(this.unmount=t(this.id))}unmount(){}}const UA={animation:{Feature:LA},exit:{Feature:BA}};function Kl(e,t,r,s={passive:!0}){return e.addEventListener(t,r,s),()=>e.removeEventListener(t,r)}function Sc(e){return{point:{x:e.pageX,y:e.pageY}}}const $A=e=>t=>qm(t)&&e(t,Sc(t));function hl(e,t,r,s){return Kl(e,t,$A(r),s)}const sS=1e-4,VA=1-sS,zA=1+sS,nS=.01,WA=0-nS,HA=0+nS;function Or(e){return e.max-e.min}function qA(e,t,r){return Math.abs(e-t)<=r}function Z1(e,t,r,s=.5){e.origin=s,e.originPoint=Tt(t.min,t.max,e.origin),e.scale=Or(r)/Or(t),e.translate=Tt(r.min,r.max,e.origin)-e.originPoint,(e.scale>=VA&&e.scale<=zA||isNaN(e.scale))&&(e.scale=1),(e.translate>=WA&&e.translate<=HA||isNaN(e.translate))&&(e.translate=0)}function pl(e,t,r,s){Z1(e.x,t.x,r.x,s?s.originX:void 0),Z1(e.y,t.y,r.y,s?s.originY:void 0)}function ev(e,t,r){e.min=r.min+t.min,e.max=e.min+Or(t)}function GA(e,t,r){ev(e.x,t.x,r.x),ev(e.y,t.y,r.y)}function tv(e,t,r){e.min=t.min-r.min,e.max=e.min+Or(t)}function ml(e,t,r){tv(e.x,t.x,r.x),tv(e.y,t.y,r.y)}function ys(e){return[e("x"),e("y")]}const aS=({current:e})=>e?e.ownerDocument.defaultView:null,rv=(e,t)=>Math.abs(e-t);function KA(e,t){const r=rv(e.x,t.x),s=rv(e.y,t.y);return Math.sqrt(r**2+s**2)}class iS{constructor(t,r,{transformPagePoint:s,contextWindow:n=window,dragSnapToOrigin:a=!1,distanceThreshold:i=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const h=af(this.lastMoveEventInfo,this.history),m=this.startEvent!==null,p=KA(h.offset,{x:0,y:0})>=this.distanceThreshold;if(!m&&!p)return;const{point:x}=h,{timestamp:v}=lr;this.history.push({...x,timestamp:v});const{onStart:y,onMove:w}=this.handlers;m||(y&&y(this.lastMoveEvent,h),this.startEvent=this.lastMoveEvent),w&&w(this.lastMoveEvent,h)},this.handlePointerMove=(h,m)=>{this.lastMoveEvent=h,this.lastMoveEventInfo=nf(m,this.transformPagePoint),yt.update(this.updatePoint,!0)},this.handlePointerUp=(h,m)=>{this.end();const{onEnd:p,onSessionEnd:x,resumeAnimation:v}=this.handlers;if(this.dragSnapToOrigin&&v&&v(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const y=af(h.type==="pointercancel"?this.lastMoveEventInfo:nf(m,this.transformPagePoint),this.history);this.startEvent&&p&&p(h,y),x&&x(h,y)},!qm(t))return;this.dragSnapToOrigin=a,this.handlers=r,this.transformPagePoint=s,this.distanceThreshold=i,this.contextWindow=n||window;const o=Sc(t),c=nf(o,this.transformPagePoint),{point:u}=c,{timestamp:d}=lr;this.history=[{...u,timestamp:d}];const{onSessionStart:f}=r;f&&f(t,af(c,this.history)),this.removeListeners=wc(hl(this.contextWindow,"pointermove",this.handlePointerMove),hl(this.contextWindow,"pointerup",this.handlePointerUp),hl(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),ia(this.updatePoint)}}function nf(e,t){return t?{point:t(e.point)}:e}function sv(e,t){return{x:e.x-t.x,y:e.y-t.y}}function af({point:e},t){return{point:e,delta:sv(e,oS(t)),offset:sv(e,XA(t)),velocity:YA(t,.1)}}function XA(e){return e[0]}function oS(e){return e[e.length-1]}function YA(e,t){if(e.length<2)return{x:0,y:0};let r=e.length-1,s=null;const n=oS(e);for(;r>=0&&(s=e[r],!(n.timestamp-s.timestamp>on(t)));)r--;if(!s)return{x:0,y:0};const a=Ts(n.timestamp-s.timestamp);if(a===0)return{x:0,y:0};const i={x:(n.x-s.x)/a,y:(n.y-s.y)/a};return i.x===1/0&&(i.x=0),i.y===1/0&&(i.y=0),i}function JA(e,{min:t,max:r},s){return t!==void 0&&e<t?e=s?Tt(t,e,s.min):Math.max(e,t):r!==void 0&&e>r&&(e=s?Tt(r,e,s.max):Math.min(e,r)),e}function nv(e,t,r){return{min:t!==void 0?e.min+t:void 0,max:r!==void 0?e.max+r-(e.max-e.min):void 0}}function QA(e,{top:t,left:r,bottom:s,right:n}){return{x:nv(e.x,r,n),y:nv(e.y,t,s)}}function av(e,t){let r=t.min-e.min,s=t.max-e.max;return t.max-t.min<e.max-e.min&&([r,s]=[s,r]),{min:r,max:s}}function ZA(e,t){return{x:av(e.x,t.x),y:av(e.y,t.y)}}function e6(e,t){let r=.5;const s=Or(e),n=Or(t);return n>s?r=zl(t.min,t.max-s,e.min):s>n&&(r=zl(e.min,e.max-n,t.min)),An(0,1,r)}function t6(e,t){const r={};return t.min!==void 0&&(r.min=t.min-e.min),t.max!==void 0&&(r.max=t.max-e.min),r}const Yh=.35;function r6(e=Yh){return e===!1?e=0:e===!0&&(e=Yh),{x:iv(e,"left","right"),y:iv(e,"top","bottom")}}function iv(e,t,r){return{min:ov(e,t),max:ov(e,r)}}function ov(e,t){return typeof e=="number"?e:e[t]||0}const s6=new WeakMap;class n6{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Lt(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=t}start(t,{snapToCursor:r=!1,distanceThreshold:s}={}){const{presenceContext:n}=this.visualElement;if(n&&n.isPresent===!1)return;const a=f=>{const{dragSnapToOrigin:h}=this.getProps();h?this.pauseAnimation():this.stopAnimation(),r&&this.snapToCursor(Sc(f).point)},i=(f,h)=>{const{drag:m,dragPropagation:p,onDragStart:x}=this.getProps();if(m&&!p&&(this.openDragLock&&this.openDragLock(),this.openDragLock=u3(m),!this.openDragLock))return;this.latestPointerEvent=f,this.latestPanInfo=h,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),ys(y=>{let w=this.getAxisMotionValue(y).get()||0;if(ln.test(w)){const{projection:g}=this.visualElement;if(g&&g.layout){const _=g.layout.layoutBox[y];_&&(w=Or(_)*(parseFloat(w)/100))}}this.originPoint[y]=w}),x&&yt.postRender(()=>x(f,h)),Kh(this.visualElement,"transform");const{animationState:v}=this.visualElement;v&&v.setActive("whileDrag",!0)},o=(f,h)=>{this.latestPointerEvent=f,this.latestPanInfo=h;const{dragPropagation:m,dragDirectionLock:p,onDirectionLock:x,onDrag:v}=this.getProps();if(!m&&!this.openDragLock)return;const{offset:y}=h;if(p&&this.currentDirection===null){this.currentDirection=a6(y),this.currentDirection!==null&&x&&x(this.currentDirection);return}this.updateAxis("x",h.point,y),this.updateAxis("y",h.point,y),this.visualElement.render(),v&&v(f,h)},c=(f,h)=>{this.latestPointerEvent=f,this.latestPanInfo=h,this.stop(f,h),this.latestPointerEvent=null,this.latestPanInfo=null},u=()=>ys(f=>{var h;return this.getAnimationState(f)==="paused"&&((h=this.getAxisMotionValue(f).animation)==null?void 0:h.play())}),{dragSnapToOrigin:d}=this.getProps();this.panSession=new iS(t,{onSessionStart:a,onStart:i,onMove:o,onSessionEnd:c,resumeAnimation:u},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:d,distanceThreshold:s,contextWindow:aS(this.visualElement)})}stop(t,r){const s=t||this.latestPointerEvent,n=r||this.latestPanInfo,a=this.isDragging;if(this.cancel(),!a||!n||!s)return;const{velocity:i}=n;this.startAnimation(i);const{onDragEnd:o}=this.getProps();o&&yt.postRender(()=>o(s,n))}cancel(){this.isDragging=!1;const{projection:t,animationState:r}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:s}=this.getProps();!s&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(t,r,s){const{drag:n}=this.getProps();if(!s||!su(t,n,this.currentDirection))return;const a=this.getAxisMotionValue(t);let i=this.originPoint[t]+s[t];this.constraints&&this.constraints[t]&&(i=JA(i,this.constraints[t],this.elastic[t])),a.set(i)}resolveConstraints(){var a;const{dragConstraints:t,dragElastic:r}=this.getProps(),s=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(a=this.visualElement.projection)==null?void 0:a.layout,n=this.constraints;t&&Mi(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&s?this.constraints=QA(s.layoutBox,t):this.constraints=!1,this.elastic=r6(r),n!==this.constraints&&s&&this.constraints&&!this.hasMutatedConstraints&&ys(i=>{this.constraints!==!1&&this.getAxisMotionValue(i)&&(this.constraints[i]=t6(s.layoutBox[i],this.constraints[i]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:r}=this.getProps();if(!t||!Mi(t))return!1;const s=t.current,{projection:n}=this.visualElement;if(!n||!n.layout)return!1;const a=iA(s,n.root,this.visualElement.getTransformPagePoint());let i=ZA(n.layout.layoutBox,a);if(r){const o=r(sA(i));this.hasMutatedConstraints=!!o,o&&(i=Wb(o))}return i}startAnimation(t){const{drag:r,dragMomentum:s,dragElastic:n,dragTransition:a,dragSnapToOrigin:i,onDragTransitionEnd:o}=this.getProps(),c=this.constraints||{},u=ys(d=>{if(!su(d,r,this.currentDirection))return;let f=c&&c[d]||{};i&&(f={min:0,max:0});const h=n?200:1e6,m=n?40:1e7,p={type:"inertia",velocity:s?t[d]:0,bounceStiffness:h,bounceDamping:m,timeConstant:750,restDelta:1,restSpeed:10,...a,...f};return this.startAxisValueAnimation(d,p)});return Promise.all(u).then(o)}startAxisValueAnimation(t,r){const s=this.getAxisMotionValue(t);return Kh(this.visualElement,t),s.start(sx(t,s,0,r,this.visualElement,!1))}stopAnimation(){ys(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){ys(t=>{var r;return(r=this.getAxisMotionValue(t).animation)==null?void 0:r.pause()})}getAnimationState(t){var r;return(r=this.getAxisMotionValue(t).animation)==null?void 0:r.state}getAxisMotionValue(t){const r=`_drag${t.toUpperCase()}`,s=this.visualElement.getProps(),n=s[r];return n||this.visualElement.getValue(t,(s.initial?s.initial[t]:void 0)||0)}snapToCursor(t){ys(r=>{const{drag:s}=this.getProps();if(!su(r,s,this.currentDirection))return;const{projection:n}=this.visualElement,a=this.getAxisMotionValue(r);if(n&&n.layout){const{min:i,max:o}=n.layout.layoutBox[r];a.set(t[r]-Tt(i,o,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:r}=this.getProps(),{projection:s}=this.visualElement;if(!Mi(r)||!s||!this.constraints)return;this.stopAnimation();const n={x:0,y:0};ys(i=>{const o=this.getAxisMotionValue(i);if(o&&this.constraints!==!1){const c=o.get();n[i]=e6({min:c,max:c},this.constraints[i])}});const{transformTemplate:a}=this.visualElement.getProps();this.visualElement.current.style.transform=a?a({},""):"none",s.root&&s.root.updateScroll(),s.updateLayout(),this.resolveConstraints(),ys(i=>{if(!su(i,t,null))return;const o=this.getAxisMotionValue(i),{min:c,max:u}=this.constraints[i];o.set(Tt(c,u,n[i]))})}addListeners(){if(!this.visualElement.current)return;s6.set(this.visualElement,this);const t=this.visualElement.current,r=hl(t,"pointerdown",c=>{const{drag:u,dragListener:d=!0}=this.getProps();u&&d&&this.start(c)}),s=()=>{const{dragConstraints:c}=this.getProps();Mi(c)&&c.current&&(this.constraints=this.resolveRefConstraints())},{projection:n}=this.visualElement,a=n.addEventListener("measure",s);n&&!n.layout&&(n.root&&n.root.updateScroll(),n.updateLayout()),yt.read(s);const i=Kl(window,"resize",()=>this.scalePositionWithinConstraints()),o=n.addEventListener("didUpdate",({delta:c,hasLayoutChanged:u})=>{this.isDragging&&u&&(ys(d=>{const f=this.getAxisMotionValue(d);f&&(this.originPoint[d]+=c[d].translate,f.set(f.get()+c[d].translate))}),this.visualElement.render())});return()=>{i(),r(),a(),o&&o()}}getProps(){const t=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:s=!1,dragPropagation:n=!1,dragConstraints:a=!1,dragElastic:i=Yh,dragMomentum:o=!0}=t;return{...t,drag:r,dragDirectionLock:s,dragPropagation:n,dragConstraints:a,dragElastic:i,dragMomentum:o}}}function su(e,t,r){return(t===!0||t===e)&&(r===null||r===e)}function a6(e,t=10){let r=null;return Math.abs(e.y)>t?r="y":Math.abs(e.x)>t&&(r="x"),r}class i6 extends ma{constructor(t){super(t),this.removeGroupControls=js,this.removeListeners=js,this.controls=new n6(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||js}unmount(){this.removeGroupControls(),this.removeListeners()}}const lv=e=>(t,r)=>{e&&yt.postRender(()=>e(t,r))};class o6 extends ma{constructor(){super(...arguments),this.removePointerDownListener=js}onPointerDown(t){this.session=new iS(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:aS(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:r,onPan:s,onPanEnd:n}=this.node.getProps();return{onSessionStart:lv(t),onStart:lv(r),onMove:s,onEnd:(a,i)=>{delete this.session,n&&yt.postRender(()=>n(a,i))}}}mount(){this.removePointerDownListener=hl(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const Uu={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function cv(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const Ho={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(Be.test(e))e=parseFloat(e);else return e;const r=cv(e,t.target.x),s=cv(e,t.target.y);return`${r}% ${s}%`}},l6={correct:(e,{treeScale:t,projectionDelta:r})=>{const s=e,n=oa.parse(e);if(n.length>5)return s;const a=oa.createTransformer(e),i=typeof n[0]!="number"?1:0,o=r.x.scale*t.x,c=r.y.scale*t.y;n[0+i]/=o,n[1+i]/=c;const u=Tt(o,c,.5);return typeof n[2+i]=="number"&&(n[2+i]/=u),typeof n[3+i]=="number"&&(n[3+i]/=u),a(n)}};let of=!1;class c6 extends F.Component{componentDidMount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:s,layoutId:n}=this.props,{projection:a}=t;F3(u6),a&&(r.group&&r.group.add(a),s&&s.register&&n&&s.register(a),of&&a.root.didUpdate(),a.addEventListener("animationComplete",()=>{this.safeToRemove()}),a.setOptions({...a.options,onExitComplete:()=>this.safeToRemove()})),Uu.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:r,visualElement:s,drag:n,isPresent:a}=this.props,{projection:i}=s;return i&&(i.isPresent=a,of=!0,n||t.layoutDependency!==r||r===void 0||t.isPresent!==a?i.willUpdate():this.safeToRemove(),t.isPresent!==a&&(a?i.promote():i.relegate()||yt.postRender(()=>{const o=i.getStack();(!o||!o.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),Hm.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:s}=this.props,{projection:n}=t;of=!0,n&&(n.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(n),s&&s.deregister&&s.deregister(n))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function lS(e){const[t,r]=Ab(),s=F.useContext(Sm);return l.jsx(c6,{...e,layoutGroup:s,switchLayoutGroup:F.useContext(Vb),isPresent:t,safeToRemove:r})}const u6={borderRadius:{...Ho,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Ho,borderTopRightRadius:Ho,borderBottomLeftRadius:Ho,borderBottomRightRadius:Ho,boxShadow:l6};function d6(e,t,r){const s=Sr(e)?e:co(e);return s.start(sx("",s,t,r)),s.animation}const f6=(e,t)=>e.depth-t.depth;class h6{constructor(){this.children=[],this.isDirty=!1}add(t){Tm(this.children,t),this.isDirty=!0}remove(t){Nm(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(f6),this.isDirty=!1,this.children.forEach(t)}}function p6(e,t){const r=Wr.now(),s=({timestamp:n})=>{const a=n-r;a>=t&&(ia(s),e(a-t))};return yt.setup(s,!0),()=>ia(s)}const cS=["TopLeft","TopRight","BottomLeft","BottomRight"],m6=cS.length,uv=e=>typeof e=="string"?parseFloat(e):e,dv=e=>typeof e=="number"||Be.test(e);function x6(e,t,r,s,n,a){n?(e.opacity=Tt(0,r.opacity??1,g6(s)),e.opacityExit=Tt(t.opacity??1,0,v6(s))):a&&(e.opacity=Tt(t.opacity??1,r.opacity??1,s));for(let i=0;i<m6;i++){const o=`border${cS[i]}Radius`;let c=fv(t,o),u=fv(r,o);if(c===void 0&&u===void 0)continue;c||(c=0),u||(u=0),c===0||u===0||dv(c)===dv(u)?(e[o]=Math.max(Tt(uv(c),uv(u),s),0),(ln.test(u)||ln.test(c))&&(e[o]+="%")):e[o]=u}(t.rotate||r.rotate)&&(e.rotate=Tt(t.rotate||0,r.rotate||0,s))}function fv(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const g6=uS(0,.5,Y_),v6=uS(.5,.95,js);function uS(e,t,r){return s=>s<e?0:s>t?1:r(zl(e,t,s))}function hv(e,t){e.min=t.min,e.max=t.max}function ps(e,t){hv(e.x,t.x),hv(e.y,t.y)}function pv(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function mv(e,t,r,s,n){return e-=t,e=gd(e,1/r,s),n!==void 0&&(e=gd(e,1/n,s)),e}function y6(e,t=0,r=1,s=.5,n,a=e,i=e){if(ln.test(t)&&(t=parseFloat(t),t=Tt(i.min,i.max,t/100)-i.min),typeof t!="number")return;let o=Tt(a.min,a.max,s);e===a&&(o-=t),e.min=mv(e.min,t,r,o,n),e.max=mv(e.max,t,r,o,n)}function xv(e,t,[r,s,n],a,i){y6(e,t[r],t[s],t[n],t.scale,a,i)}const w6=["x","scaleX","originX"],_6=["y","scaleY","originY"];function gv(e,t,r,s){xv(e.x,t,w6,r?r.x:void 0,s?s.x:void 0),xv(e.y,t,_6,r?r.y:void 0,s?s.y:void 0)}function vv(e){return e.translate===0&&e.scale===1}function dS(e){return vv(e.x)&&vv(e.y)}function yv(e,t){return e.min===t.min&&e.max===t.max}function b6(e,t){return yv(e.x,t.x)&&yv(e.y,t.y)}function wv(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function fS(e,t){return wv(e.x,t.x)&&wv(e.y,t.y)}function _v(e){return Or(e.x)/Or(e.y)}function bv(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class S6{constructor(){this.members=[]}add(t){Tm(this.members,t),t.scheduleRender()}remove(t){if(Nm(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(t){const r=this.members.findIndex(n=>t===n);if(r===0)return!1;let s;for(let n=r;n>=0;n--){const a=this.members[n];if(a.isPresent!==!1){s=a;break}}return s?(this.promote(s),!0):!1}promote(t,r){const s=this.lead;if(t!==s&&(this.prevLead=s,this.lead=t,t.show(),s)){s.instance&&s.scheduleRender(),t.scheduleRender(),t.resumeFrom=s,r&&(t.resumeFrom.preserveOpacity=!0),s.snapshot&&(t.snapshot=s.snapshot,t.snapshot.latestValues=s.animationValues||s.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:n}=t.options;n===!1&&s.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:r,resumingFrom:s}=t;r.onExitComplete&&r.onExitComplete(),s&&s.options.onExitComplete&&s.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function k6(e,t,r){let s="";const n=e.x.translate/t.x,a=e.y.translate/t.y,i=(r==null?void 0:r.z)||0;if((n||a||i)&&(s=`translate3d(${n}px, ${a}px, ${i}px) `),(t.x!==1||t.y!==1)&&(s+=`scale(${1/t.x}, ${1/t.y}) `),r){const{transformPerspective:u,rotate:d,rotateX:f,rotateY:h,skewX:m,skewY:p}=r;u&&(s=`perspective(${u}px) ${s}`),d&&(s+=`rotate(${d}deg) `),f&&(s+=`rotateX(${f}deg) `),h&&(s+=`rotateY(${h}deg) `),m&&(s+=`skewX(${m}deg) `),p&&(s+=`skewY(${p}deg) `)}const o=e.x.scale*t.x,c=e.y.scale*t.y;return(o!==1||c!==1)&&(s+=`scale(${o}, ${c})`),s||"none"}const lf=["","X","Y","Z"],E6=1e3;let T6=0;function cf(e,t,r,s){const{latestValues:n}=t;n[e]&&(r[e]=n[e],t.setStaticValue(e,0),s&&(s[e]=0))}function hS(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const r=Qb(t);if(window.MotionHasOptimisedAnimation(r,"transform")){const{layout:n,layoutId:a}=e.options;window.MotionCancelOptimisedAnimation(r,"transform",yt,!(n||a))}const{parent:s}=e;s&&!s.hasCheckedOptimisedAppear&&hS(s)}function pS({attachResizeListener:e,defaultParent:t,measureScroll:r,checkIsScrollRoot:s,resetTransform:n}){return class{constructor(i={},o=t==null?void 0:t()){this.id=T6++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(C6),this.nodes.forEach(R6),this.nodes.forEach(O6),this.nodes.forEach(A6)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=i,this.root=o?o.root||o:this,this.path=o?[...o.path,o]:[],this.parent=o,this.depth=o?o.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new h6)}addEventListener(i,o){return this.eventHandlers.has(i)||this.eventHandlers.set(i,new Am),this.eventHandlers.get(i).add(o)}notifyListeners(i,...o){const c=this.eventHandlers.get(i);c&&c.notify(...o)}hasListeners(i){return this.eventHandlers.has(i)}mount(i){if(this.instance)return;this.isSVG=Cb(i)&&!x3(i),this.instance=i;const{layoutId:o,layout:c,visualElement:u}=this.options;if(u&&!u.current&&u.mount(i),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(c||o)&&(this.isLayoutDirty=!0),e){let d,f=0;const h=()=>this.root.updateBlockedByResize=!1;yt.read(()=>{f=window.innerWidth}),e(i,()=>{const m=window.innerWidth;m!==f&&(f=m,this.root.updateBlockedByResize=!0,d&&d(),d=p6(h,250),Uu.hasAnimatedSinceResize&&(Uu.hasAnimatedSinceResize=!1,this.nodes.forEach(Ev)))})}o&&this.root.registerSharedNode(o,this),this.options.animate!==!1&&u&&(o||c)&&this.addEventListener("didUpdate",({delta:d,hasLayoutChanged:f,hasRelativeLayoutChanged:h,layout:m})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const p=this.options.transition||u.getDefaultTransition()||B6,{onLayoutAnimationStart:x,onLayoutAnimationComplete:v}=u.getProps(),y=!this.targetLayout||!fS(this.targetLayout,m),w=!f&&h;if(this.options.layoutRoot||this.resumeFrom||w||f&&(y||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const g={...zm(p,"layout"),onPlay:x,onComplete:v};(u.shouldReduceMotion||this.options.layoutRoot)&&(g.delay=0,g.type=!1),this.startAnimation(g),this.setAnimationOrigin(d,w)}else f||Ev(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=m})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const i=this.getStack();i&&i.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),ia(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(I6),this.animationId++)}getTransformTemplate(){const{visualElement:i}=this.options;return i&&i.getProps().transformTemplate}willUpdate(i=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&hS(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let d=0;d<this.path.length;d++){const f=this.path[d];f.shouldResetTransform=!0,f.updateScroll("snapshot"),f.options.layoutRoot&&f.willUpdate(!1)}const{layoutId:o,layout:c}=this.options;if(o===void 0&&!c)return;const u=this.getTransformTemplate();this.prevTransformTemplateValue=u?u(this.latestValues,""):void 0,this.updateSnapshot(),i&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(Sv);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(kv);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(P6),this.nodes.forEach(N6),this.nodes.forEach(j6)):this.nodes.forEach(kv),this.clearAllSnapshots();const o=Wr.now();lr.delta=An(0,1e3/60,o-lr.timestamp),lr.timestamp=o,lr.isProcessing=!0,Y0.update.process(lr),Y0.preRender.process(lr),Y0.render.process(lr),lr.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,Hm.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(F6),this.sharedNodes.forEach(D6)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,yt.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){yt.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!Or(this.snapshot.measuredBox.x)&&!Or(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const i=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Lt(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:o}=this.options;o&&o.notify("LayoutMeasure",this.layout.layoutBox,i?i.layoutBox:void 0)}updateScroll(i="measure"){let o=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===i&&(o=!1),o&&this.instance){const c=s(this.instance);this.scroll={animationId:this.root.animationId,phase:i,isRoot:c,offset:r(this.instance),wasRoot:this.scroll?this.scroll.isRoot:c}}}resetTransform(){if(!n)return;const i=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,o=this.projectionDelta&&!dS(this.projectionDelta),c=this.getTransformTemplate(),u=c?c(this.latestValues,""):void 0,d=u!==this.prevTransformTemplateValue;i&&this.instance&&(o||Ta(this.latestValues)||d)&&(n(this.instance,u),this.shouldResetTransform=!1,this.scheduleRender())}measure(i=!0){const o=this.measurePageBox();let c=this.removeElementScroll(o);return i&&(c=this.removeTransform(c)),U6(c),{animationId:this.root.animationId,measuredBox:o,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){var u;const{visualElement:i}=this.options;if(!i)return Lt();const o=i.measureViewportBox();if(!(((u=this.scroll)==null?void 0:u.wasRoot)||this.path.some($6))){const{scroll:d}=this.root;d&&(Bi(o.x,d.offset.x),Bi(o.y,d.offset.y))}return o}removeElementScroll(i){var c;const o=Lt();if(ps(o,i),(c=this.scroll)!=null&&c.wasRoot)return o;for(let u=0;u<this.path.length;u++){const d=this.path[u],{scroll:f,options:h}=d;d!==this.root&&f&&h.layoutScroll&&(f.wasRoot&&ps(o,i),Bi(o.x,f.offset.x),Bi(o.y,f.offset.y))}return o}applyTransform(i,o=!1){const c=Lt();ps(c,i);for(let u=0;u<this.path.length;u++){const d=this.path[u];!o&&d.options.layoutScroll&&d.scroll&&d!==d.root&&Ui(c,{x:-d.scroll.offset.x,y:-d.scroll.offset.y}),Ta(d.latestValues)&&Ui(c,d.latestValues)}return Ta(this.latestValues)&&Ui(c,this.latestValues),c}removeTransform(i){const o=Lt();ps(o,i);for(let c=0;c<this.path.length;c++){const u=this.path[c];if(!u.instance||!Ta(u.latestValues))continue;Wh(u.latestValues)&&u.updateSnapshot();const d=Lt(),f=u.measurePageBox();ps(d,f),gv(o,u.latestValues,u.snapshot?u.snapshot.layoutBox:void 0,d)}return Ta(this.latestValues)&&gv(o,this.latestValues),o}setTargetDelta(i){this.targetDelta=i,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(i){this.options={...this.options,...i,crossfade:i.crossfade!==void 0?i.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==lr.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(i=!1){var h;const o=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=o.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=o.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=o.isSharedProjectionDirty);const c=!!this.resumingFrom||this!==o;if(!(i||c&&this.isSharedProjectionDirty||this.isProjectionDirty||(h=this.parent)!=null&&h.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:d,layoutId:f}=this.options;if(!(!this.layout||!(d||f))){if(this.resolvedRelativeTargetAt=lr.timestamp,!this.targetDelta&&!this.relativeTarget){const m=this.getClosestProjectingParent();m&&m.layout&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Lt(),this.relativeTargetOrigin=Lt(),ml(this.relativeTargetOrigin,this.layout.layoutBox,m.layout.layoutBox),ps(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=Lt(),this.targetWithTransforms=Lt()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),GA(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):ps(this.target,this.layout.layoutBox),qb(this.target,this.targetDelta)):ps(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const m=this.getClosestProjectingParent();m&&!!m.resumingFrom==!!this.resumingFrom&&!m.options.layoutScroll&&m.target&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Lt(),this.relativeTargetOrigin=Lt(),ml(this.relativeTargetOrigin,this.target,m.target),ps(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||Wh(this.parent.latestValues)||Hb(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var p;const i=this.getLead(),o=!!this.resumingFrom||this!==i;let c=!0;if((this.isProjectionDirty||(p=this.parent)!=null&&p.isProjectionDirty)&&(c=!1),o&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),this.resolvedRelativeTargetAt===lr.timestamp&&(c=!1),c)return;const{layout:u,layoutId:d}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(u||d))return;ps(this.layoutCorrected,this.layout.layoutBox);const f=this.treeScale.x,h=this.treeScale.y;aA(this.layoutCorrected,this.treeScale,this.path,o),i.layout&&!i.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(i.target=i.layout.layoutBox,i.targetWithTransforms=Lt());const{target:m}=i;if(!m){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(pv(this.prevProjectionDelta.x,this.projectionDelta.x),pv(this.prevProjectionDelta.y,this.projectionDelta.y)),pl(this.projectionDelta,this.layoutCorrected,m,this.latestValues),(this.treeScale.x!==f||this.treeScale.y!==h||!bv(this.projectionDelta.x,this.prevProjectionDelta.x)||!bv(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",m))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(i=!0){var o;if((o=this.options.visualElement)==null||o.scheduleRender(),i){const c=this.getStack();c&&c.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=$i(),this.projectionDelta=$i(),this.projectionDeltaWithTransform=$i()}setAnimationOrigin(i,o=!1){const c=this.snapshot,u=c?c.latestValues:{},d={...this.latestValues},f=$i();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!o;const h=Lt(),m=c?c.source:void 0,p=this.layout?this.layout.source:void 0,x=m!==p,v=this.getStack(),y=!v||v.members.length<=1,w=!!(x&&!y&&this.options.crossfade===!0&&!this.path.some(M6));this.animationProgress=0;let g;this.mixTargetDelta=_=>{const b=_/1e3;Tv(f.x,i.x,b),Tv(f.y,i.y,b),this.setTargetDelta(f),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(ml(h,this.layout.layoutBox,this.relativeParent.layout.layoutBox),L6(this.relativeTarget,this.relativeTargetOrigin,h,b),g&&b6(this.relativeTarget,g)&&(this.isProjectionDirty=!1),g||(g=Lt()),ps(g,this.relativeTarget)),x&&(this.animationValues=d,x6(d,u,this.latestValues,b,w,y)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=b},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(i){var o,c,u;this.notifyListeners("animationStart"),(o=this.currentAnimation)==null||o.stop(),(u=(c=this.resumingFrom)==null?void 0:c.currentAnimation)==null||u.stop(),this.pendingAnimation&&(ia(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=yt.update(()=>{Uu.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=co(0)),this.currentAnimation=d6(this.motionValue,[0,1e3],{...i,velocity:0,isSync:!0,onUpdate:d=>{this.mixTargetDelta(d),i.onUpdate&&i.onUpdate(d)},onStop:()=>{},onComplete:()=>{i.onComplete&&i.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const i=this.getStack();i&&i.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(E6),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const i=this.getLead();let{targetWithTransforms:o,target:c,layout:u,latestValues:d}=i;if(!(!o||!c||!u)){if(this!==i&&this.layout&&u&&mS(this.options.animationType,this.layout.layoutBox,u.layoutBox)){c=this.target||Lt();const f=Or(this.layout.layoutBox.x);c.x.min=i.target.x.min,c.x.max=c.x.min+f;const h=Or(this.layout.layoutBox.y);c.y.min=i.target.y.min,c.y.max=c.y.min+h}ps(o,c),Ui(o,d),pl(this.projectionDeltaWithTransform,this.layoutCorrected,o,d)}}registerSharedNode(i,o){this.sharedNodes.has(i)||this.sharedNodes.set(i,new S6),this.sharedNodes.get(i).add(o);const u=o.options.initialPromotionConfig;o.promote({transition:u?u.transition:void 0,preserveFollowOpacity:u&&u.shouldPreserveFollowOpacity?u.shouldPreserveFollowOpacity(o):void 0})}isLead(){const i=this.getStack();return i?i.lead===this:!0}getLead(){var o;const{layoutId:i}=this.options;return i?((o=this.getStack())==null?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:i}=this.options;return i?(o=this.getStack())==null?void 0:o.prevLead:void 0}getStack(){const{layoutId:i}=this.options;if(i)return this.root.sharedNodes.get(i)}promote({needsReset:i,transition:o,preserveFollowOpacity:c}={}){const u=this.getStack();u&&u.promote(this,c),i&&(this.projectionDelta=void 0,this.needsReset=!0),o&&this.setOptions({transition:o})}relegate(){const i=this.getStack();return i?i.relegate(this):!1}resetSkewAndRotation(){const{visualElement:i}=this.options;if(!i)return;let o=!1;const{latestValues:c}=i;if((c.z||c.rotate||c.rotateX||c.rotateY||c.rotateZ||c.skewX||c.skewY)&&(o=!0),!o)return;const u={};c.z&&cf("z",i,u,this.animationValues);for(let d=0;d<lf.length;d++)cf(`rotate${lf[d]}`,i,u,this.animationValues),cf(`skew${lf[d]}`,i,u,this.animationValues);i.render();for(const d in u)i.setStaticValue(d,u[d]),this.animationValues&&(this.animationValues[d]=u[d]);i.scheduleRender()}applyProjectionStyles(i,o){if(!this.instance||this.isSVG)return;if(!this.isVisible){i.visibility="hidden";return}const c=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,i.visibility="",i.opacity="",i.pointerEvents=Bu(o==null?void 0:o.pointerEvents)||"",i.transform=c?c(this.latestValues,""):"none";return}const u=this.getLead();if(!this.projectionDelta||!this.layout||!u.target){this.options.layoutId&&(i.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,i.pointerEvents=Bu(o==null?void 0:o.pointerEvents)||""),this.hasProjected&&!Ta(this.latestValues)&&(i.transform=c?c({},""):"none",this.hasProjected=!1);return}i.visibility="";const d=u.animationValues||u.latestValues;this.applyTransformsToTarget();let f=k6(this.projectionDeltaWithTransform,this.treeScale,d);c&&(f=c(d,f)),i.transform=f;const{x:h,y:m}=this.projectionDelta;i.transformOrigin=`${h.origin*100}% ${m.origin*100}% 0`,u.animationValues?i.opacity=u===this?d.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:d.opacityExit:i.opacity=u===this?d.opacity!==void 0?d.opacity:"":d.opacityExit!==void 0?d.opacityExit:0;for(const p in Gl){if(d[p]===void 0)continue;const{correct:x,applyTo:v,isCSSVariable:y}=Gl[p],w=f==="none"?d[p]:x(d[p],u);if(v){const g=v.length;for(let _=0;_<g;_++)i[v[_]]=w}else y?this.options.visualElement.renderState.vars[p]=w:i[p]=w}this.options.layoutId&&(i.pointerEvents=u===this?Bu(o==null?void 0:o.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(i=>{var o;return(o=i.currentAnimation)==null?void 0:o.stop()}),this.root.nodes.forEach(Sv),this.root.sharedNodes.clear()}}}function N6(e){e.updateLayout()}function j6(e){var r;const t=((r=e.resumeFrom)==null?void 0:r.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&t&&e.hasListeners("didUpdate")){const{layoutBox:s,measuredBox:n}=e.layout,{animationType:a}=e.options,i=t.source!==e.layout.source;a==="size"?ys(f=>{const h=i?t.measuredBox[f]:t.layoutBox[f],m=Or(h);h.min=s[f].min,h.max=h.min+m}):mS(a,t.layoutBox,s)&&ys(f=>{const h=i?t.measuredBox[f]:t.layoutBox[f],m=Or(s[f]);h.max=h.min+m,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[f].max=e.relativeTarget[f].min+m)});const o=$i();pl(o,s,t.layoutBox);const c=$i();i?pl(c,e.applyTransform(n,!0),t.measuredBox):pl(c,s,t.layoutBox);const u=!dS(o);let d=!1;if(!e.resumeFrom){const f=e.getClosestProjectingParent();if(f&&!f.resumeFrom){const{snapshot:h,layout:m}=f;if(h&&m){const p=Lt();ml(p,t.layoutBox,h.layoutBox);const x=Lt();ml(x,s,m.layoutBox),fS(p,x)||(d=!0),f.options.layoutRoot&&(e.relativeTarget=x,e.relativeTargetOrigin=p,e.relativeParent=f)}}}e.notifyListeners("didUpdate",{layout:s,snapshot:t,delta:c,layoutDelta:o,hasLayoutChanged:u,hasRelativeLayoutChanged:d})}else if(e.isLead()){const{onExitComplete:s}=e.options;s&&s()}e.options.transition=void 0}function C6(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function A6(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function F6(e){e.clearSnapshot()}function Sv(e){e.clearMeasurements()}function kv(e){e.isLayoutDirty=!1}function P6(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function Ev(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function R6(e){e.resolveTargetDelta()}function O6(e){e.calcProjection()}function I6(e){e.resetSkewAndRotation()}function D6(e){e.removeLeadSnapshot()}function Tv(e,t,r){e.translate=Tt(t.translate,0,r),e.scale=Tt(t.scale,1,r),e.origin=t.origin,e.originPoint=t.originPoint}function Nv(e,t,r,s){e.min=Tt(t.min,r.min,s),e.max=Tt(t.max,r.max,s)}function L6(e,t,r,s){Nv(e.x,t.x,r.x,s),Nv(e.y,t.y,r.y,s)}function M6(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const B6={duration:.45,ease:[.4,0,.1,1]},jv=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),Cv=jv("applewebkit/")&&!jv("chrome/")?Math.round:js;function Av(e){e.min=Cv(e.min),e.max=Cv(e.max)}function U6(e){Av(e.x),Av(e.y)}function mS(e,t,r){return e==="position"||e==="preserve-aspect"&&!qA(_v(t),_v(r),.2)}function $6(e){var t;return e!==e.root&&((t=e.scroll)==null?void 0:t.wasRoot)}const V6=pS({attachResizeListener:(e,t)=>Kl(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),uf={current:void 0},xS=pS({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!uf.current){const e=new V6({});e.mount(window),e.setOptions({layoutScroll:!0}),uf.current=e}return uf.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),z6={pan:{Feature:o6},drag:{Feature:i6,ProjectionNode:xS,MeasureLayout:lS}};function Fv(e,t,r){const{props:s}=e;e.animationState&&s.whileHover&&e.animationState.setActive("whileHover",r==="Start");const n="onHover"+r,a=s[n];a&&yt.postRender(()=>a(t,Sc(t)))}class W6 extends ma{mount(){const{current:t}=this.node;t&&(this.unmount=d3(t,(r,s)=>(Fv(this.node,s,"Start"),n=>Fv(this.node,n,"End"))))}unmount(){}}class H6 extends ma{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=wc(Kl(this.node.current,"focus",()=>this.onFocus()),Kl(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function Pv(e,t,r){const{props:s}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&s.whileTap&&e.animationState.setActive("whileTap",r==="Start");const n="onTap"+(r==="End"?"":r),a=s[n];a&&yt.postRender(()=>a(t,Sc(t)))}class q6 extends ma{mount(){const{current:t}=this.node;t&&(this.unmount=m3(t,(r,s)=>(Pv(this.node,s,"Start"),(n,{success:a})=>Pv(this.node,n,a?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const Jh=new WeakMap,df=new WeakMap,G6=e=>{const t=Jh.get(e.target);t&&t(e)},K6=e=>{e.forEach(G6)};function X6({root:e,...t}){const r=e||document;df.has(r)||df.set(r,{});const s=df.get(r),n=JSON.stringify(t);return s[n]||(s[n]=new IntersectionObserver(K6,{root:e,...t})),s[n]}function Y6(e,t,r){const s=X6(t);return Jh.set(e,r),s.observe(e),()=>{Jh.delete(e),s.unobserve(e)}}const J6={some:0,all:1};class Q6 extends ma{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:r,margin:s,amount:n="some",once:a}=t,i={root:r?r.current:void 0,rootMargin:s,threshold:typeof n=="number"?n:J6[n]},o=c=>{const{isIntersecting:u}=c;if(this.isInView===u||(this.isInView=u,a&&!u&&this.hasEnteredView))return;u&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",u);const{onViewportEnter:d,onViewportLeave:f}=this.node.getProps(),h=u?d:f;h&&h(c)};return Y6(this.node.current,i,o)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:r}=this.node;["amount","margin","root"].some(Z6(t,r))&&this.startObserver()}unmount(){}}function Z6({viewport:e={}},{viewport:t={}}={}){return r=>e[r]!==t[r]}const eF={inView:{Feature:Q6},tap:{Feature:q6},focus:{Feature:H6},hover:{Feature:W6}},tF={layout:{ProjectionNode:xS,MeasureLayout:lS}},rF={...UA,...eF,...z6,...tF},fo=rA(rF,mA);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var sF={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nF=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Te=(e,t)=>{const r=F.forwardRef(({color:s="currentColor",size:n=24,strokeWidth:a=2,absoluteStrokeWidth:i,className:o="",children:c,...u},d)=>F.createElement("svg",{ref:d,...sF,width:n,height:n,stroke:s,strokeWidth:i?Number(a)*24/Number(n):a,className:["lucide",`lucide-${nF(e)}`,o].join(" "),...u},[...t.map(([f,h])=>F.createElement(f,h)),...Array.isArray(c)?c:[c]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rv=Te("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vt=Te("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yi=Te("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gS=Te("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ov=Te("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aF=Te("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iF=Te("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oF=Te("BookDashed",[["path",{d:"M20 22h-2",key:"1rpnb6"}],["path",{d:"M20 15v2h-2",key:"fph276"}],["path",{d:"M4 19.5V15",key:"6gr39e"}],["path",{d:"M20 8v3",key:"deu0bs"}],["path",{d:"M18 2h2v2",key:"180o53"}],["path",{d:"M4 11V9",key:"v3xsx8"}],["path",{d:"M12 2h2",key:"cvn524"}],["path",{d:"M12 22h2",key:"kn7ki6"}],["path",{d:"M12 17h2",key:"13u4lk"}],["path",{d:"M8 22H6.5a2.5 2.5 0 0 1 0-5H8",key:"fiseg2"}],["path",{d:"M4 5v-.5A2.5 2.5 0 0 1 6.5 2H8",key:"wywhs9"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vS=Te("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xl=Te("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lF=Te("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qh=Te("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vs=Te("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yS=Te("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ho=Te("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nx=Te("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n0=Te("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cF=Te("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uF=Te("ClipboardCheck",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dF=Te("Clipboard",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ax=Te("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fF=Te("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hF=Te("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nu=Te("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const po=Te("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pF=Te("FileDown",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mF=Te("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dr=Te("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iv=Te("FileUp",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"m15 15-3-3-3 3",key:"15xj92"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wS=Te("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xF=Te("Flame",[["path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z",key:"96xj49"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _S=Te("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gF=Te("FormInput",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["path",{d:"M12 12h.01",key:"1mp3jc"}],["path",{d:"M17 12h.01",key:"1m0b6t"}],["path",{d:"M7 12h.01",key:"eqddd0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vF=Te("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yF=Te("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wF=Te("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vd=Te("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _F=Te("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zh=Te("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bF=Te("Library",[["path",{d:"m16 6 4 14",key:"ji33uf"}],["path",{d:"M12 6v14",key:"1n7gus"}],["path",{d:"M8 8v12",key:"1gg7y9"}],["path",{d:"M4 4v16",key:"6qkkli"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SF=Te("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wn=Te("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kF=Te("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bS=Te("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EF=Te("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SS=Te("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ff=Te("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $u=Te("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ix=Te("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const is=Te("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ep=Te("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tp=Te("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TF=Te("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yd=Te("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NF=Te("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a0=Te("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kc=Te("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jF=Te("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kS=Te("Table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ES=Te("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yl=Te("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ox=Te("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jl=Te("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lx=Te("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CF=Te("Wand2",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72Z",key:"1bcowg"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hf=Te("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cx=Te("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cn=Te("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AF=Te("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);function Vu(e){return e}var rp=function(e,t){return rp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,s){r.__proto__=s}||function(r,s){for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(r[n]=s[n])},rp(e,t)};function TS(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");rp(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var wd=function(){return wd=Object.assign||function(t){for(var r,s=1,n=arguments.length;s<n;s++){r=arguments[s];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a])}return t},wd.apply(this,arguments)};function Eo(e,t){var r={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(r[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(e);n<s.length;n++)t.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(e,s[n])&&(r[s[n]]=e[s[n]]);return r}function NS(e,t,r,s){var n=arguments.length,a=n<3?t:s===null?s=Object.getOwnPropertyDescriptor(t,r):s,i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(e,t,r,s);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(a=(n<3?i(a):n>3?i(t,r,a):i(t,r))||a);return n>3&&a&&Object.defineProperty(t,r,a),a}function jS(e,t){return function(r,s){t(r,s,e)}}function CS(e,t,r,s,n,a){function i(y){if(y!==void 0&&typeof y!="function")throw new TypeError("Function expected");return y}for(var o=s.kind,c=o==="getter"?"get":o==="setter"?"set":"value",u=!t&&e?s.static?e:e.prototype:null,d=t||(u?Object.getOwnPropertyDescriptor(u,s.name):{}),f,h=!1,m=r.length-1;m>=0;m--){var p={};for(var x in s)p[x]=x==="access"?{}:s[x];for(var x in s.access)p.access[x]=s.access[x];p.addInitializer=function(y){if(h)throw new TypeError("Cannot add initializers after decoration has completed");a.push(i(y||null))};var v=(0,r[m])(o==="accessor"?{get:d.get,set:d.set}:d[c],p);if(o==="accessor"){if(v===void 0)continue;if(v===null||typeof v!="object")throw new TypeError("Object expected");(f=i(v.get))&&(d.get=f),(f=i(v.set))&&(d.set=f),(f=i(v.init))&&n.unshift(f)}else(f=i(v))&&(o==="field"?n.unshift(f):d[c]=f)}u&&Object.defineProperty(u,s.name,d),h=!0}function AS(e,t,r){for(var s=arguments.length>2,n=0;n<t.length;n++)r=s?t[n].call(e,r):t[n].call(e);return s?r:void 0}function FS(e){return typeof e=="symbol"?e:"".concat(e)}function PS(e,t,r){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function RS(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function Fe(e,t,r,s){function n(a){return a instanceof r?a:new r(function(i){i(a)})}return new(r||(r=Promise))(function(a,i){function o(d){try{u(s.next(d))}catch(f){i(f)}}function c(d){try{u(s.throw(d))}catch(f){i(f)}}function u(d){d.done?a(d.value):n(d.value).then(o,c)}u((s=s.apply(e,t||[])).next())})}function OS(e,t){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},s,n,a,i=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return i.next=o(0),i.throw=o(1),i.return=o(2),typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function o(u){return function(d){return c([u,d])}}function c(u){if(s)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(r=0)),r;)try{if(s=1,n&&(a=u[0]&2?n.return:u[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,u[1])).done)return a;switch(n=0,a&&(u=[u[0]&2,a.value]),u[0]){case 0:case 1:a=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,n=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!a||u[1]>a[0]&&u[1]<a[3])){r.label=u[1];break}if(u[0]===6&&r.label<a[1]){r.label=a[1],a=u;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(u);break}a[2]&&r.ops.pop(),r.trys.pop();continue}u=t.call(e,r)}catch(d){u=[6,d],n=0}finally{s=a=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}var i0=Object.create?function(e,t,r,s){s===void 0&&(s=r);var n=Object.getOwnPropertyDescriptor(t,r);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,s,n)}:function(e,t,r,s){s===void 0&&(s=r),e[s]=t[r]};function IS(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&i0(t,e,r)}function _d(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],s=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&s>=e.length&&(e=void 0),{value:e&&e[s++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function ux(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var s=r.call(e),n,a=[],i;try{for(;(t===void 0||t-- >0)&&!(n=s.next()).done;)a.push(n.value)}catch(o){i={error:o}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return a}function DS(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(ux(arguments[t]));return e}function LS(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var s=Array(e),n=0,t=0;t<r;t++)for(var a=arguments[t],i=0,o=a.length;i<o;i++,n++)s[n]=a[i];return s}function MS(e,t,r){if(r||arguments.length===2)for(var s=0,n=t.length,a;s<n;s++)(a||!(s in t))&&(a||(a=Array.prototype.slice.call(t,0,s)),a[s]=t[s]);return e.concat(a||Array.prototype.slice.call(t))}function mo(e){return this instanceof mo?(this.v=e,this):new mo(e)}function BS(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=r.apply(e,t||[]),n,a=[];return n=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",i),n[Symbol.asyncIterator]=function(){return this},n;function i(m){return function(p){return Promise.resolve(p).then(m,f)}}function o(m,p){s[m]&&(n[m]=function(x){return new Promise(function(v,y){a.push([m,x,v,y])>1||c(m,x)})},p&&(n[m]=p(n[m])))}function c(m,p){try{u(s[m](p))}catch(x){h(a[0][3],x)}}function u(m){m.value instanceof mo?Promise.resolve(m.value.v).then(d,f):h(a[0][2],m)}function d(m){c("next",m)}function f(m){c("throw",m)}function h(m,p){m(p),a.shift(),a.length&&c(a[0][0],a[0][1])}}function US(e){var t,r;return t={},s("next"),s("throw",function(n){throw n}),s("return"),t[Symbol.iterator]=function(){return this},t;function s(n,a){t[n]=e[n]?function(i){return(r=!r)?{value:mo(e[n](i)),done:!1}:a?a(i):i}:a}}function $S(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof _d=="function"?_d(e):e[Symbol.iterator](),r={},s("next"),s("throw"),s("return"),r[Symbol.asyncIterator]=function(){return this},r);function s(a){r[a]=e[a]&&function(i){return new Promise(function(o,c){i=e[a](i),n(o,c,i.done,i.value)})}}function n(a,i,o,c){Promise.resolve(c).then(function(u){a({value:u,done:o})},i)}}function VS(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var FF=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t},sp=function(e){return sp=Object.getOwnPropertyNames||function(t){var r=[];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(r[r.length]=s);return r},sp(e)};function zS(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r=sp(e),s=0;s<r.length;s++)r[s]!=="default"&&i0(t,e,r[s]);return FF(t,e),t}function WS(e){return e&&e.__esModule?e:{default:e}}function HS(e,t,r,s){if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?s:r==="a"?s.call(e):s?s.value:t.get(e)}function qS(e,t,r,s,n){if(s==="m")throw new TypeError("Private method is not writable");if(s==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return s==="a"?n.call(e,r):n?n.value=r:t.set(e,r),r}function GS(e,t){if(t===null||typeof t!="object"&&typeof t!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof e=="function"?t===e:e.has(t)}function KS(e,t,r){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var s,n;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");s=t[Symbol.asyncDispose]}if(s===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");s=t[Symbol.dispose],r&&(n=s)}if(typeof s!="function")throw new TypeError("Object not disposable.");n&&(s=function(){try{n.call(this)}catch(a){return Promise.reject(a)}}),e.stack.push({value:t,dispose:s,async:r})}else r&&e.stack.push({async:!0});return t}var PF=typeof SuppressedError=="function"?SuppressedError:function(e,t,r){var s=new Error(r);return s.name="SuppressedError",s.error=e,s.suppressed=t,s};function XS(e){function t(a){e.error=e.hasError?new PF(a,e.error,"An error was suppressed during disposal."):a,e.hasError=!0}var r,s=0;function n(){for(;r=e.stack.pop();)try{if(!r.async&&s===1)return s=0,e.stack.push(r),Promise.resolve().then(n);if(r.dispose){var a=r.dispose.call(r.value);if(r.async)return s|=2,Promise.resolve(a).then(n,function(i){return t(i),n()})}else s|=1}catch(i){t(i)}if(s===1)return e.hasError?Promise.reject(e.error):Promise.resolve();if(e.hasError)throw e.error}return n()}function YS(e,t){return typeof e=="string"&&/^\.\.?\//.test(e)?e.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(r,s,n,a,i){return s?t?".jsx":".js":n&&(!a||!i)?r:n+a+"."+i.toLowerCase()+"js"}):e}const RF={__extends:TS,__assign:wd,__rest:Eo,__decorate:NS,__param:jS,__esDecorate:CS,__runInitializers:AS,__propKey:FS,__setFunctionName:PS,__metadata:RS,__awaiter:Fe,__generator:OS,__createBinding:i0,__exportStar:IS,__values:_d,__read:ux,__spread:DS,__spreadArrays:LS,__spreadArray:MS,__await:mo,__asyncGenerator:BS,__asyncDelegator:US,__asyncValues:$S,__makeTemplateObject:VS,__importStar:zS,__importDefault:WS,__classPrivateFieldGet:HS,__classPrivateFieldSet:qS,__classPrivateFieldIn:GS,__addDisposableResource:KS,__disposeResources:XS,__rewriteRelativeImportExtension:YS},OF=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:KS,get __assign(){return wd},__asyncDelegator:US,__asyncGenerator:BS,__asyncValues:$S,__await:mo,__awaiter:Fe,__classPrivateFieldGet:HS,__classPrivateFieldIn:GS,__classPrivateFieldSet:qS,__createBinding:i0,__decorate:NS,__disposeResources:XS,__esDecorate:CS,__exportStar:IS,__extends:TS,__generator:OS,__importDefault:WS,__importStar:zS,__makeTemplateObject:VS,__metadata:RS,__param:jS,__propKey:FS,__read:ux,__rest:Eo,__rewriteRelativeImportExtension:YS,__runInitializers:AS,__setFunctionName:PS,__spread:DS,__spreadArray:MS,__spreadArrays:LS,__values:_d,default:RF},Symbol.toStringTag,{value:"Module"})),IF=e=>e?(...t)=>e(...t):(...t)=>fetch(...t);class dx extends Error{constructor(t,r="FunctionsError",s){super(t),this.name=r,this.context=s}}class DF extends dx{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class Dv extends dx{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class Lv extends dx{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var np;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(np||(np={}));class LF{constructor(t,{headers:r={},customFetch:s,region:n=np.Any}={}){this.url=t,this.headers=r,this.region=n,this.fetch=IF(s)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return Fe(this,arguments,void 0,function*(r,s={}){var n;let a,i;try{const{headers:o,method:c,body:u,signal:d,timeout:f}=s;let h={},{region:m}=s;m||(m=this.region);const p=new URL(`${this.url}/${r}`);m&&m!=="any"&&(h["x-region"]=m,p.searchParams.set("forceFunctionRegion",m));let x;u&&(o&&!Object.prototype.hasOwnProperty.call(o,"Content-Type")||!o)?typeof Blob<"u"&&u instanceof Blob||u instanceof ArrayBuffer?(h["Content-Type"]="application/octet-stream",x=u):typeof u=="string"?(h["Content-Type"]="text/plain",x=u):typeof FormData<"u"&&u instanceof FormData?x=u:(h["Content-Type"]="application/json",x=JSON.stringify(u)):x=u;let v=d;f&&(i=new AbortController,a=setTimeout(()=>i.abort(),f),d?(v=i.signal,d.addEventListener("abort",()=>i.abort())):v=i.signal);const y=yield this.fetch(p.toString(),{method:c||"POST",headers:Object.assign(Object.assign(Object.assign({},h),this.headers),o),body:x,signal:v}).catch(b=>{throw new DF(b)}),w=y.headers.get("x-relay-error");if(w&&w==="true")throw new Dv(y);if(!y.ok)throw new Lv(y);let g=((n=y.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),_;return g==="application/json"?_=yield y.json():g==="application/octet-stream"||g==="application/pdf"?_=yield y.blob():g==="text/event-stream"?_=y:g==="multipart/form-data"?_=yield y.formData():_=yield y.text(),{data:_,error:null,response:y}}catch(o){return{data:null,error:o,response:o instanceof Lv||o instanceof Dv?o.context:void 0}}finally{a&&clearTimeout(a)}})}}var Rr={};const To=XT(OF);var au={},iu={},ou={},lu={},cu={},uu={},Mv;function JS(){if(Mv)return uu;Mv=1,Object.defineProperty(uu,"__esModule",{value:!0});class e extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}}return uu.default=e,uu}var Bv;function QS(){if(Bv)return cu;Bv=1,Object.defineProperty(cu,"__esModule",{value:!0});const t=To.__importDefault(JS());class r{constructor(n){var a,i;this.shouldThrowOnError=!1,this.method=n.method,this.url=n.url,this.headers=new Headers(n.headers),this.schema=n.schema,this.body=n.body,this.shouldThrowOnError=(a=n.shouldThrowOnError)!==null&&a!==void 0?a:!1,this.signal=n.signal,this.isMaybeSingle=(i=n.isMaybeSingle)!==null&&i!==void 0?i:!1,n.fetch?this.fetch=n.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(n,a){return this.headers=new Headers(this.headers),this.headers.set(n,a),this}then(n,a){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const i=this.fetch;let o=i(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async c=>{var u,d,f,h;let m=null,p=null,x=null,v=c.status,y=c.statusText;if(c.ok){if(this.method!=="HEAD"){const b=await c.text();b===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((u=this.headers.get("Accept"))===null||u===void 0)&&u.includes("application/vnd.pgrst.plan+text"))?p=b:p=JSON.parse(b))}const g=(d=this.headers.get("Prefer"))===null||d===void 0?void 0:d.match(/count=(exact|planned|estimated)/),_=(f=c.headers.get("content-range"))===null||f===void 0?void 0:f.split("/");g&&_&&_.length>1&&(x=parseInt(_[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(p)&&(p.length>1?(m={code:"PGRST116",details:`Results contain ${p.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},p=null,x=null,v=406,y="Not Acceptable"):p.length===1?p=p[0]:p=null)}else{const g=await c.text();try{m=JSON.parse(g),Array.isArray(m)&&c.status===404&&(p=[],m=null,v=200,y="OK")}catch{c.status===404&&g===""?(v=204,y="No Content"):m={message:g}}if(m&&this.isMaybeSingle&&(!((h=m==null?void 0:m.details)===null||h===void 0)&&h.includes("0 rows"))&&(m=null,v=200,y="OK"),m&&this.shouldThrowOnError)throw new t.default(m)}return{error:m,data:p,count:x,status:v,statusText:y}});return this.shouldThrowOnError||(o=o.catch(c=>{var u,d,f,h,m,p;let x="";const v=c==null?void 0:c.cause;if(v){const y=(u=v==null?void 0:v.message)!==null&&u!==void 0?u:"",w=(d=v==null?void 0:v.code)!==null&&d!==void 0?d:"";x=`${(f=c==null?void 0:c.name)!==null&&f!==void 0?f:"FetchError"}: ${c==null?void 0:c.message}`,x+=`

Caused by: ${(h=v==null?void 0:v.name)!==null&&h!==void 0?h:"Error"}: ${y}`,w&&(x+=` (${w})`),v!=null&&v.stack&&(x+=`
${v.stack}`)}else x=(m=c==null?void 0:c.stack)!==null&&m!==void 0?m:"";return{error:{message:`${(p=c==null?void 0:c.name)!==null&&p!==void 0?p:"FetchError"}: ${c==null?void 0:c.message}`,details:x,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),o.then(n,a)}returns(){return this}overrideTypes(){return this}}return cu.default=r,cu}var Uv;function ZS(){if(Uv)return lu;Uv=1,Object.defineProperty(lu,"__esModule",{value:!0});const t=To.__importDefault(QS());class r extends t.default{select(n){let a=!1;const i=(n??"*").split("").map(o=>/\s/.test(o)&&!a?"":(o==='"'&&(a=!a),o)).join("");return this.url.searchParams.set("select",i),this.headers.append("Prefer","return=representation"),this}order(n,{ascending:a=!0,nullsFirst:i,foreignTable:o,referencedTable:c=o}={}){const u=c?`${c}.order`:"order",d=this.url.searchParams.get(u);return this.url.searchParams.set(u,`${d?`${d},`:""}${n}.${a?"asc":"desc"}${i===void 0?"":i?".nullsfirst":".nullslast"}`),this}limit(n,{foreignTable:a,referencedTable:i=a}={}){const o=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(o,`${n}`),this}range(n,a,{foreignTable:i,referencedTable:o=i}={}){const c=typeof o>"u"?"offset":`${o}.offset`,u=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(c,`${n}`),this.url.searchParams.set(u,`${a-n+1}`),this}abortSignal(n){return this.signal=n,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:n=!1,verbose:a=!1,settings:i=!1,buffers:o=!1,wal:c=!1,format:u="text"}={}){var d;const f=[n?"analyze":null,a?"verbose":null,i?"settings":null,o?"buffers":null,c?"wal":null].filter(Boolean).join("|"),h=(d=this.headers.get("Accept"))!==null&&d!==void 0?d:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${u}; for="${h}"; options=${f};`),u==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(n){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${n}`),this}}return lu.default=r,lu}var $v;function fx(){if($v)return ou;$v=1,Object.defineProperty(ou,"__esModule",{value:!0});const t=To.__importDefault(ZS()),r=new RegExp("[,()]");class s extends t.default{eq(a,i){return this.url.searchParams.append(a,`eq.${i}`),this}neq(a,i){return this.url.searchParams.append(a,`neq.${i}`),this}gt(a,i){return this.url.searchParams.append(a,`gt.${i}`),this}gte(a,i){return this.url.searchParams.append(a,`gte.${i}`),this}lt(a,i){return this.url.searchParams.append(a,`lt.${i}`),this}lte(a,i){return this.url.searchParams.append(a,`lte.${i}`),this}like(a,i){return this.url.searchParams.append(a,`like.${i}`),this}likeAllOf(a,i){return this.url.searchParams.append(a,`like(all).{${i.join(",")}}`),this}likeAnyOf(a,i){return this.url.searchParams.append(a,`like(any).{${i.join(",")}}`),this}ilike(a,i){return this.url.searchParams.append(a,`ilike.${i}`),this}ilikeAllOf(a,i){return this.url.searchParams.append(a,`ilike(all).{${i.join(",")}}`),this}ilikeAnyOf(a,i){return this.url.searchParams.append(a,`ilike(any).{${i.join(",")}}`),this}is(a,i){return this.url.searchParams.append(a,`is.${i}`),this}in(a,i){const o=Array.from(new Set(i)).map(c=>typeof c=="string"&&r.test(c)?`"${c}"`:`${c}`).join(",");return this.url.searchParams.append(a,`in.(${o})`),this}contains(a,i){return typeof i=="string"?this.url.searchParams.append(a,`cs.${i}`):Array.isArray(i)?this.url.searchParams.append(a,`cs.{${i.join(",")}}`):this.url.searchParams.append(a,`cs.${JSON.stringify(i)}`),this}containedBy(a,i){return typeof i=="string"?this.url.searchParams.append(a,`cd.${i}`):Array.isArray(i)?this.url.searchParams.append(a,`cd.{${i.join(",")}}`):this.url.searchParams.append(a,`cd.${JSON.stringify(i)}`),this}rangeGt(a,i){return this.url.searchParams.append(a,`sr.${i}`),this}rangeGte(a,i){return this.url.searchParams.append(a,`nxl.${i}`),this}rangeLt(a,i){return this.url.searchParams.append(a,`sl.${i}`),this}rangeLte(a,i){return this.url.searchParams.append(a,`nxr.${i}`),this}rangeAdjacent(a,i){return this.url.searchParams.append(a,`adj.${i}`),this}overlaps(a,i){return typeof i=="string"?this.url.searchParams.append(a,`ov.${i}`):this.url.searchParams.append(a,`ov.{${i.join(",")}}`),this}textSearch(a,i,{config:o,type:c}={}){let u="";c==="plain"?u="pl":c==="phrase"?u="ph":c==="websearch"&&(u="w");const d=o===void 0?"":`(${o})`;return this.url.searchParams.append(a,`${u}fts${d}.${i}`),this}match(a){return Object.entries(a).forEach(([i,o])=>{this.url.searchParams.append(i,`eq.${o}`)}),this}not(a,i,o){return this.url.searchParams.append(a,`not.${i}.${o}`),this}or(a,{foreignTable:i,referencedTable:o=i}={}){const c=o?`${o}.or`:"or";return this.url.searchParams.append(c,`(${a})`),this}filter(a,i,o){return this.url.searchParams.append(a,`${i}.${o}`),this}}return ou.default=s,ou}var Vv;function ek(){if(Vv)return iu;Vv=1,Object.defineProperty(iu,"__esModule",{value:!0});const t=To.__importDefault(fx());class r{constructor(n,{headers:a={},schema:i,fetch:o}){this.url=n,this.headers=new Headers(a),this.schema=i,this.fetch=o}select(n,a){const{head:i=!1,count:o}=a??{},c=i?"HEAD":"GET";let u=!1;const d=(n??"*").split("").map(f=>/\s/.test(f)&&!u?"":(f==='"'&&(u=!u),f)).join("");return this.url.searchParams.set("select",d),o&&this.headers.append("Prefer",`count=${o}`),new t.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(n,{count:a,defaultToNull:i=!0}={}){var o;const c="POST";if(a&&this.headers.append("Prefer",`count=${a}`),i||this.headers.append("Prefer","missing=default"),Array.isArray(n)){const u=n.reduce((d,f)=>d.concat(Object.keys(f)),[]);if(u.length>0){const d=[...new Set(u)].map(f=>`"${f}"`);this.url.searchParams.set("columns",d.join(","))}}return new t.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}upsert(n,{onConflict:a,ignoreDuplicates:i=!1,count:o,defaultToNull:c=!0}={}){var u;const d="POST";if(this.headers.append("Prefer",`resolution=${i?"ignore":"merge"}-duplicates`),a!==void 0&&this.url.searchParams.set("on_conflict",a),o&&this.headers.append("Prefer",`count=${o}`),c||this.headers.append("Prefer","missing=default"),Array.isArray(n)){const f=n.reduce((h,m)=>h.concat(Object.keys(m)),[]);if(f.length>0){const h=[...new Set(f)].map(m=>`"${m}"`);this.url.searchParams.set("columns",h.join(","))}}return new t.default({method:d,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:(u=this.fetch)!==null&&u!==void 0?u:fetch})}update(n,{count:a}={}){var i;const o="PATCH";return a&&this.headers.append("Prefer",`count=${a}`),new t.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}delete({count:n}={}){var a;const i="DELETE";return n&&this.headers.append("Prefer",`count=${n}`),new t.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}}return iu.default=r,iu}var zv;function MF(){if(zv)return au;zv=1,Object.defineProperty(au,"__esModule",{value:!0});const e=To,t=e.__importDefault(ek()),r=e.__importDefault(fx());class s{constructor(a,{headers:i={},schema:o,fetch:c}={}){this.url=a,this.headers=new Headers(i),this.schemaName=o,this.fetch=c}from(a){const i=new URL(`${this.url}/${a}`);return new t.default(i,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(a){return new s(this.url,{headers:this.headers,schema:a,fetch:this.fetch})}rpc(a,i={},{head:o=!1,get:c=!1,count:u}={}){var d;let f;const h=new URL(`${this.url}/rpc/${a}`);let m;o||c?(f=o?"HEAD":"GET",Object.entries(i).filter(([x,v])=>v!==void 0).map(([x,v])=>[x,Array.isArray(v)?`{${v.join(",")}}`:`${v}`]).forEach(([x,v])=>{h.searchParams.append(x,v)})):(f="POST",m=i);const p=new Headers(this.headers);return u&&p.set("Prefer",`count=${u}`),new r.default({method:f,url:h,headers:p,schema:this.schemaName,body:m,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}}return au.default=s,au}Object.defineProperty(Rr,"__esModule",{value:!0});var tk=Rr.PostgrestError=dk=Rr.PostgrestBuilder=ck=Rr.PostgrestTransformBuilder=ok=Rr.PostgrestFilterBuilder=ak=Rr.PostgrestQueryBuilder=sk=Rr.PostgrestClient=void 0;const No=To,rk=No.__importDefault(MF());var sk=Rr.PostgrestClient=rk.default;const nk=No.__importDefault(ek());var ak=Rr.PostgrestQueryBuilder=nk.default;const ik=No.__importDefault(fx());var ok=Rr.PostgrestFilterBuilder=ik.default;const lk=No.__importDefault(ZS());var ck=Rr.PostgrestTransformBuilder=lk.default;const uk=No.__importDefault(QS());var dk=Rr.PostgrestBuilder=uk.default;const fk=No.__importDefault(JS());tk=Rr.PostgrestError=fk.default;var hk=Rr.default={PostgrestClient:rk.default,PostgrestQueryBuilder:nk.default,PostgrestFilterBuilder:ik.default,PostgrestTransformBuilder:lk.default,PostgrestBuilder:uk.default,PostgrestError:fk.default};const BF=GT({__proto__:null,get PostgrestBuilder(){return dk},get PostgrestClient(){return sk},get PostgrestError(){return tk},get PostgrestFilterBuilder(){return ok},get PostgrestQueryBuilder(){return ak},get PostgrestTransformBuilder(){return ck},default:hk},[Rr]),{PostgrestClient:UF,PostgrestQueryBuilder:Az,PostgrestFilterBuilder:Fz,PostgrestTransformBuilder:Pz,PostgrestBuilder:Rz,PostgrestError:Oz}=hk||BF;class $F{constructor(){}static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const s=r.node,n=parseInt(s.replace(/^v/,"").split(".")[0]);return n>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${n} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${n} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const s=this.getWebSocketConstructor();return new s(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const VF="2.83.0",zF=`realtime-js/${VF}`,pk="1.0.0",WF="2.0.0",Wv=pk,ap=1e4,HF=1e3,qF=100;var ja;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(ja||(ja={}));var Xt;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Xt||(Xt={}));var bs;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(bs||(bs={}));var ip;(function(e){e.websocket="websocket"})(ip||(ip={}));var Ca;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Ca||(Ca={}));class GF{constructor(){this.HEADER_LENGTH=1,this.META_LENGTH=4,this.USER_BROADCAST_PUSH_META_LENGTH=5,this.KINDS={push:0,reply:1,broadcast:2,userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST="broadcast"}encode(t,r){if(this._isArrayBuffer(t.payload))return r(this._binaryEncodePush(t));if(t.event===this.BROADCAST&&!(t.payload instanceof ArrayBuffer)&&typeof t.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(t));let s=[t.join_ref,t.ref,t.topic,t.event,t.payload];return r(JSON.stringify(s))}_binaryEncodePush(t){var r,s;const{event:n,topic:a,payload:i}=t,o=(r=t.ref)!==null&&r!==void 0?r:"",c=(s=t.join_ref)!==null&&s!==void 0?s:"",u=this.META_LENGTH+c.length+o.length+a.length+n.length,d=new ArrayBuffer(this.HEADER_LENGTH+u);let f=new DataView(d),h=0;f.setUint8(h++,this.KINDS.push),f.setUint8(h++,c.length),f.setUint8(h++,o.length),f.setUint8(h++,a.length),f.setUint8(h++,n.length),Array.from(c,p=>f.setUint8(h++,p.charCodeAt(0))),Array.from(o,p=>f.setUint8(h++,p.charCodeAt(0))),Array.from(a,p=>f.setUint8(h++,p.charCodeAt(0))),Array.from(n,p=>f.setUint8(h++,p.charCodeAt(0)));var m=new Uint8Array(d.byteLength+i.byteLength);return m.set(new Uint8Array(d),0),m.set(new Uint8Array(i),d.byteLength),m.buffer}_binaryEncodeUserBroadcastPush(t){var r;return this._isArrayBuffer((r=t.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(t):this._encodeJsonUserBroadcastPush(t)}_encodeBinaryUserBroadcastPush(t){var r,s,n,a;const i=t.topic,o=(r=t.ref)!==null&&r!==void 0?r:"",c=(s=t.join_ref)!==null&&s!==void 0?s:"",u=t.payload.event,d=(a=(n=t.payload)===null||n===void 0?void 0:n.payload)!==null&&a!==void 0?a:new ArrayBuffer(0),f=this.USER_BROADCAST_PUSH_META_LENGTH+c.length+o.length+i.length+u.length,h=new ArrayBuffer(this.HEADER_LENGTH+f);let m=new DataView(h),p=0;m.setUint8(p++,this.KINDS.userBroadcastPush),m.setUint8(p++,c.length),m.setUint8(p++,o.length),m.setUint8(p++,i.length),m.setUint8(p++,u.length),m.setUint8(p++,this.BINARY_ENCODING),Array.from(c,v=>m.setUint8(p++,v.charCodeAt(0))),Array.from(o,v=>m.setUint8(p++,v.charCodeAt(0))),Array.from(i,v=>m.setUint8(p++,v.charCodeAt(0))),Array.from(u,v=>m.setUint8(p++,v.charCodeAt(0)));var x=new Uint8Array(h.byteLength+d.byteLength);return x.set(new Uint8Array(h),0),x.set(new Uint8Array(d),h.byteLength),x.buffer}_encodeJsonUserBroadcastPush(t){var r,s,n,a;const i=t.topic,o=(r=t.ref)!==null&&r!==void 0?r:"",c=(s=t.join_ref)!==null&&s!==void 0?s:"",u=t.payload.event,d=(a=(n=t.payload)===null||n===void 0?void 0:n.payload)!==null&&a!==void 0?a:{},h=new TextEncoder().encode(JSON.stringify(d)).buffer,m=this.USER_BROADCAST_PUSH_META_LENGTH+c.length+o.length+i.length+u.length,p=new ArrayBuffer(this.HEADER_LENGTH+m);let x=new DataView(p),v=0;x.setUint8(v++,this.KINDS.userBroadcastPush),x.setUint8(v++,c.length),x.setUint8(v++,o.length),x.setUint8(v++,i.length),x.setUint8(v++,u.length),x.setUint8(v++,this.JSON_ENCODING),Array.from(c,w=>x.setUint8(v++,w.charCodeAt(0))),Array.from(o,w=>x.setUint8(v++,w.charCodeAt(0))),Array.from(i,w=>x.setUint8(v++,w.charCodeAt(0))),Array.from(u,w=>x.setUint8(v++,w.charCodeAt(0)));var y=new Uint8Array(p.byteLength+h.byteLength);return y.set(new Uint8Array(p),0),y.set(new Uint8Array(h),p.byteLength),y.buffer}decode(t,r){if(this._isArrayBuffer(t)){let s=this._binaryDecode(t);return r(s)}if(typeof t=="string"){const s=JSON.parse(t),[n,a,i,o,c]=s;return r({join_ref:n,ref:a,topic:i,event:o,payload:c})}return r({})}_binaryDecode(t){const r=new DataView(t),s=r.getUint8(0),n=new TextDecoder;switch(s){case this.KINDS.push:return this._decodePush(t,r,n);case this.KINDS.reply:return this._decodeReply(t,r,n);case this.KINDS.broadcast:return this._decodeBroadcast(t,r,n);case this.KINDS.userBroadcast:return this._decodeUserBroadcast(t,r,n)}}_decodePush(t,r,s){const n=r.getUint8(1),a=r.getUint8(2),i=r.getUint8(3);let o=this.HEADER_LENGTH+this.META_LENGTH-1;const c=s.decode(t.slice(o,o+n));o=o+n;const u=s.decode(t.slice(o,o+a));o=o+a;const d=s.decode(t.slice(o,o+i));o=o+i;const f=JSON.parse(s.decode(t.slice(o,t.byteLength)));return{join_ref:c,ref:null,topic:u,event:d,payload:f}}_decodeReply(t,r,s){const n=r.getUint8(1),a=r.getUint8(2),i=r.getUint8(3),o=r.getUint8(4);let c=this.HEADER_LENGTH+this.META_LENGTH;const u=s.decode(t.slice(c,c+n));c=c+n;const d=s.decode(t.slice(c,c+a));c=c+a;const f=s.decode(t.slice(c,c+i));c=c+i;const h=s.decode(t.slice(c,c+o));c=c+o;const m=JSON.parse(s.decode(t.slice(c,t.byteLength))),p={status:h,response:m};return{join_ref:u,ref:d,topic:f,event:bs.reply,payload:p}}_decodeBroadcast(t,r,s){const n=r.getUint8(1),a=r.getUint8(2);let i=this.HEADER_LENGTH+2;const o=s.decode(t.slice(i,i+n));i=i+n;const c=s.decode(t.slice(i,i+a));i=i+a;const u=JSON.parse(s.decode(t.slice(i,t.byteLength)));return{join_ref:null,ref:null,topic:o,event:c,payload:u}}_decodeUserBroadcast(t,r,s){const n=r.getUint8(1),a=r.getUint8(2),i=r.getUint8(3),o=r.getUint8(4);let c=this.HEADER_LENGTH+4;const u=s.decode(t.slice(c,c+n));c=c+n;const d=s.decode(t.slice(c,c+a));c=c+a;const f=s.decode(t.slice(c,c+i));c=c+i;const h=t.slice(c,t.byteLength),m=o===this.JSON_ENCODING?JSON.parse(s.decode(h)):h,p={type:this.BROADCAST,event:d,payload:m};return i>0&&(p.meta=JSON.parse(f)),{join_ref:null,ref:null,topic:u,event:this.BROADCAST,payload:p}}_isArrayBuffer(t){var r;return t instanceof ArrayBuffer||((r=t==null?void 0:t.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}}class mk{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var lt;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(lt||(lt={}));const Hv=(e,t,r={})=>{var s;const n=(s=r.skipTypes)!==null&&s!==void 0?s:[];return t?Object.keys(t).reduce((a,i)=>(a[i]=KF(i,e,t,n),a),{}):{}},KF=(e,t,r,s)=>{const n=t.find(o=>o.name===e),a=n==null?void 0:n.type,i=r[e];return a&&!s.includes(a)?xk(a,i):op(i)},xk=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return QF(t,r)}switch(e){case lt.bool:return XF(t);case lt.float4:case lt.float8:case lt.int2:case lt.int4:case lt.int8:case lt.numeric:case lt.oid:return YF(t);case lt.json:case lt.jsonb:return JF(t);case lt.timestamp:return ZF(t);case lt.abstime:case lt.date:case lt.daterange:case lt.int4range:case lt.int8range:case lt.money:case lt.reltime:case lt.text:case lt.time:case lt.timestamptz:case lt.timetz:case lt.tsrange:case lt.tstzrange:return op(t);default:return op(t)}},op=e=>e,XF=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},YF=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},JF=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},QF=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,s=e[r];if(e[0]==="{"&&s==="}"){let a;const i=e.slice(1,r);try{a=JSON.parse("["+i+"]")}catch{a=i?i.split(","):[]}return a.map(o=>xk(t,o))}return e},ZF=e=>typeof e=="string"?e.replace(" ","T"):e,gk=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class pf{constructor(t,r,s={},n=ap){this.channel=t,this.event=r,this.payload=s,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var s;return this._hasReceived(t)&&r((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(s=>s.status===t).forEach(s=>s.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var qv;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(qv||(qv={}));class xl{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},n=>{const{onJoin:a,onLeave:i,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=xl.syncState(this.state,n,a,i),this.pendingDiffs.forEach(c=>{this.state=xl.syncDiff(this.state,c,a,i)}),this.pendingDiffs=[],o()}),this.channel._on(s.diff,{},n=>{const{onJoin:a,onLeave:i,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=xl.syncDiff(this.state,n,a,i),o())}),this.onJoin((n,a,i)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:a,newPresences:i})}),this.onLeave((n,a,i)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:a,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,s,n){const a=this.cloneDeep(t),i=this.transformState(r),o={},c={};return this.map(a,(u,d)=>{i[u]||(c[u]=d)}),this.map(i,(u,d)=>{const f=a[u];if(f){const h=d.map(v=>v.presence_ref),m=f.map(v=>v.presence_ref),p=d.filter(v=>m.indexOf(v.presence_ref)<0),x=f.filter(v=>h.indexOf(v.presence_ref)<0);p.length>0&&(o[u]=p),x.length>0&&(c[u]=x)}else o[u]=d}),this.syncDiff(a,{joins:o,leaves:c},s,n)}static syncDiff(t,r,s,n){const{joins:a,leaves:i}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return s||(s=()=>{}),n||(n=()=>{}),this.map(a,(o,c)=>{var u;const d=(u=t[o])!==null&&u!==void 0?u:[];if(t[o]=this.cloneDeep(c),d.length>0){const f=t[o].map(m=>m.presence_ref),h=d.filter(m=>f.indexOf(m.presence_ref)<0);t[o].unshift(...h)}s(o,d,c)}),this.map(i,(o,c)=>{let u=t[o];if(!u)return;const d=c.map(f=>f.presence_ref);u=u.filter(f=>d.indexOf(f.presence_ref)<0),t[o]=u,n(o,u,c),u.length===0&&delete t[o]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(s=>r(s,t[s]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,s)=>{const n=t[s];return"metas"in n?r[s]=n.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):r[s]=n,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Gv;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(Gv||(Gv={}));var gl;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(gl||(gl={}));var xn;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(xn||(xn={}));class hx{constructor(t,r={config:{}},s){var n,a;if(this.topic=t,this.params=r,this.socket=s,this.bindings={},this.state=Xt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new pf(this,bs.join,this.params,this.timeout),this.rejoinTimer=new mk(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Xt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Xt.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=Xt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Xt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=Xt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(bs.reply,{},(i,o)=>{this._trigger(this._replyEventName(o),i)}),this.presence=new xl(this),this.broadcastEndpointURL=gk(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((a=(n=this.params.config)===null||n===void 0?void 0:n.broadcast)===null||a===void 0)&&a.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var s,n,a;if(this.socket.isConnected()||this.socket.connect(),this.state==Xt.closed){const{config:{broadcast:i,presence:o,private:c}}=this.params,u=(n=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(m=>m.filter))!==null&&n!==void 0?n:[],d=!!this.bindings[gl.PRESENCE]&&this.bindings[gl.PRESENCE].length>0||((a=this.params.config.presence)===null||a===void 0?void 0:a.enabled)===!0,f={},h={broadcast:i,presence:Object.assign(Object.assign({},o),{enabled:d}),postgres_changes:u,private:c};this.socket.accessTokenValue&&(f.access_token=this.socket.accessTokenValue),this._onError(m=>t==null?void 0:t(xn.CHANNEL_ERROR,m)),this._onClose(()=>t==null?void 0:t(xn.CLOSED)),this.updateJoinPayload(Object.assign({config:h},f)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:m})=>{var p;if(this.socket.setAuth(),m===void 0){t==null||t(xn.SUBSCRIBED);return}else{const x=this.bindings.postgres_changes,v=(p=x==null?void 0:x.length)!==null&&p!==void 0?p:0,y=[];for(let w=0;w<v;w++){const g=x[w],{filter:{event:_,schema:b,table:k,filter:S}}=g,T=m&&m[w];if(T&&T.event===_&&T.schema===b&&T.table===k&&T.filter===S)y.push(Object.assign(Object.assign({},g),{id:T.id}));else{this.unsubscribe(),this.state=Xt.errored,t==null||t(xn.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=y,t&&t(xn.SUBSCRIBED);return}}).receive("error",m=>{this.state=Xt.errored,t==null||t(xn.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(m).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(xn.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,s){return this.state===Xt.joined&&t===gl.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,r,s)}async httpSend(t,r,s={}){var n;const a=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(r==null)return Promise.reject("Payload is required for httpSend()");const i={method:"POST",headers:{Authorization:a,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:r,private:this.private}]})},o=await this._fetchWithTimeout(this.broadcastEndpointURL,i,(n=s.timeout)!==null&&n!==void 0?n:this.timeout);if(o.status===202)return{success:!0};let c=o.statusText;try{const u=await o.json();c=u.error||u.message||c}catch{}return Promise.reject(new Error(c))}async send(t,r={}){var s,n;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:a,payload:i}=t,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:i,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(s=r.timeout)!==null&&s!==void 0?s:this.timeout);return await((n=u.body)===null||n===void 0?void 0:n.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(a=>{var i,o,c;const u=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((c=(o=(i=this.params)===null||i===void 0?void 0:i.config)===null||o===void 0?void 0:o.broadcast)===null||c===void 0)&&c.ack)&&a("ok"),u.receive("ok",()=>a("ok")),u.receive("error",()=>a("error")),u.receive("timeout",()=>a("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Xt.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(bs.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(n=>{s=new pf(this,bs.leave,{},t),s.receive("ok",()=>{r(),n("ok")}).receive("timeout",()=>{r(),n("timed out")}).receive("error",()=>{n("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s==null||s.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Xt.closed,this.bindings={}}async _fetchWithTimeout(t,r,s){const n=new AbortController,a=setTimeout(()=>n.abort(),s),i=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:n.signal}));return clearTimeout(a),i}_push(t,r,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new pf(this,t,r,s);return this._canPush()?n.send():this._addToPushBuffer(n),n}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>qF){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,s){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,s){var n,a;const i=t.toLocaleLowerCase(),{close:o,error:c,leave:u,join:d}=bs;if(s&&[o,c,u,d].indexOf(i)>=0&&s!==this._joinRef())return;let h=this._onMessage(i,r,s);if(r&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(m=>{var p,x,v;return((p=m.filter)===null||p===void 0?void 0:p.event)==="*"||((v=(x=m.filter)===null||x===void 0?void 0:x.event)===null||v===void 0?void 0:v.toLocaleLowerCase())===i}).map(m=>m.callback(h,s)):(a=this.bindings[i])===null||a===void 0||a.filter(m=>{var p,x,v,y,w,g;if(["broadcast","presence","postgres_changes"].includes(i))if("id"in m){const _=m.id,b=(p=m.filter)===null||p===void 0?void 0:p.event;return _&&((x=r.ids)===null||x===void 0?void 0:x.includes(_))&&(b==="*"||(b==null?void 0:b.toLocaleLowerCase())===((v=r.data)===null||v===void 0?void 0:v.type.toLocaleLowerCase()))}else{const _=(w=(y=m==null?void 0:m.filter)===null||y===void 0?void 0:y.event)===null||w===void 0?void 0:w.toLocaleLowerCase();return _==="*"||_===((g=r==null?void 0:r.event)===null||g===void 0?void 0:g.toLocaleLowerCase())}else return m.type.toLocaleLowerCase()===i}).map(m=>{if(typeof h=="object"&&"ids"in h){const p=h.data,{schema:x,table:v,commit_timestamp:y,type:w,errors:g}=p;h=Object.assign(Object.assign({},{schema:x,table:v,commit_timestamp:y,eventType:w,new:{},old:{},errors:g}),this._getPayloadRecords(p))}m.callback(h,s)})}_isClosed(){return this.state===Xt.closed}_isJoined(){return this.state===Xt.joined}_isJoining(){return this.state===Xt.joining}_isLeaving(){return this.state===Xt.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,s){const n=t.toLocaleLowerCase(),a={type:n,filter:r,callback:s};return this.bindings[n]?this.bindings[n].push(a):this.bindings[n]=[a],this}_off(t,r){const s=t.toLocaleLowerCase();return this.bindings[s]&&(this.bindings[s]=this.bindings[s].filter(n=>{var a;return!(((a=n.type)===null||a===void 0?void 0:a.toLocaleLowerCase())===s&&hx.isEqual(n.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const s in t)if(t[s]!==r[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(bs.close,{},t)}_onError(t){this._on(bs.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Xt.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=Hv(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=Hv(t.columns,t.old_record)),r}}const mf=()=>{},du={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},eP=[1e3,2e3,5e3,1e4],tP=1e4,rP=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class sP{constructor(t,r){var s;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=ap,this.transport=null,this.heartbeatIntervalMs=du.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=mf,this.ref=0,this.reconnectTimer=null,this.vsn=Wv,this.logger=mf,this.conn=null,this.sendBuffer=[],this.serializer=new GF,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=n=>n?(...a)=>n(...a):(...a)=>fetch(...a),!(!((s=r==null?void 0:r.params)===null||s===void 0)&&s.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${ip.websocket}`,this.httpEndpoint=gk(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=$F.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const s=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(s),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(t?this.conn.close(t,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,s){this.logger(t,r,s)}connectionState(){switch(this.conn&&this.conn.readyState){case ja.connecting:return Ca.Connecting;case ja.open:return Ca.Open;case ja.closing:return Ca.Closing;default:return Ca.Closed}}isConnected(){return this.connectionState()===Ca.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const s=`realtime:${t}`,n=this.getChannels().find(a=>a.topic===s);if(n)return n;{const a=new hx(`realtime:${t}`,r,this);return this.channels.push(a),a}}push(t){const{topic:r,event:s,payload:n,ref:a}=t,i=()=>{this.encode(t,o=>{var c;(c=this.conn)===null||c===void 0||c.send(o)})};this.log("push",`${r} ${s} (${a})`,n),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(HF,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},du.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(s=>s.topic===t&&(s._isJoined()||s._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(u){this.log("error","error in heartbeat callback",u)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:s,event:n,payload:a,ref:i}=r,o=i?`(${i})`:"",c=a.status||"";this.log("receive",`${c} ${s} ${n} ${o}`.trim(),a),this.channels.filter(u=>u._isMember(s)).forEach(u=>u._trigger(n,a,i)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){if(this.conn){if(this.conn.readyState===ja.open||this.conn.readyState===ja.connecting)try{this.conn.close()}catch(t){this.log("error","Error closing connection",t)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(bs.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const s=t.match(/\?/)?"&":"?",n=new URLSearchParams(r);return`${t}${s}${n}`}_workerObjectUrl(t){let r;if(t)r=t;else{const s=new Blob([rP],{type:"application/javascript"});r=URL.createObjectURL(s)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r;t?r=t:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(s=>{const n={access_token:r,version:zF};r&&s.updateJoinPayload(n),s.joinedOnce&&s._isJoined()&&s._push(bs.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(s=>{try{s(r)}catch(n){this.log("error",`error in ${t} callback`,n)}})}catch(s){this.log("error",`error triggering ${t} callbacks`,s)}}_setupReconnectionTimer(){this.reconnectTimer=new mk(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},du.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,s,n,a,i,o,c,u,d,f,h,m;switch(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(s=t==null?void 0:t.timeout)!==null&&s!==void 0?s:ap,this.heartbeatIntervalMs=(n=t==null?void 0:t.heartbeatIntervalMs)!==null&&n!==void 0?n:du.HEARTBEAT_INTERVAL,this.worker=(a=t==null?void 0:t.worker)!==null&&a!==void 0?a:!1,this.accessToken=(i=t==null?void 0:t.accessToken)!==null&&i!==void 0?i:null,this.heartbeatCallback=(o=t==null?void 0:t.heartbeatCallback)!==null&&o!==void 0?o:mf,this.vsn=(c=t==null?void 0:t.vsn)!==null&&c!==void 0?c:Wv,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(u=t==null?void 0:t.reconnectAfterMs)!==null&&u!==void 0?u:p=>eP[p-1]||tP,this.vsn){case pk:this.encode=(d=t==null?void 0:t.encode)!==null&&d!==void 0?d:(p,x)=>x(JSON.stringify(p)),this.decode=(f=t==null?void 0:t.decode)!==null&&f!==void 0?f:(p,x)=>x(JSON.parse(p));break;case WF:this.encode=(h=t==null?void 0:t.encode)!==null&&h!==void 0?h:this.serializer.encode.bind(this.serializer),this.decode=(m=t==null?void 0:t.decode)!==null&&m!==void 0?m:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}class px extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function kt(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class nP extends px{constructor(t,r,s){super(t),this.name="StorageApiError",this.status=r,this.statusCode=s}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class lp extends px{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}const mx=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),aP=()=>Response,cp=e=>{if(Array.isArray(e))return e.map(r=>cp(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,s])=>{const n=r.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""));t[n]=cp(s)}),t},iP=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},xf=e=>{var t;return e.msg||e.message||e.error_description||(typeof e.error=="string"?e.error:(t=e.error)===null||t===void 0?void 0:t.message)||JSON.stringify(e)},oP=(e,t,r)=>Fe(void 0,void 0,void 0,function*(){const s=yield aP();e instanceof s&&!(r!=null&&r.noResolveJson)?e.json().then(n=>{const a=e.status||500,i=(n==null?void 0:n.statusCode)||a+"";t(new nP(xf(n),a,i))}).catch(n=>{t(new lp(xf(n),n))}):t(new lp(xf(e),e))}),lP=(e,t,r,s)=>{const n={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||!s?n:(iP(s)?(n.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),n.body=JSON.stringify(s)):n.body=s,t!=null&&t.duplex&&(n.duplex=t.duplex),Object.assign(Object.assign({},n),r))};function Ec(e,t,r,s,n,a){return Fe(this,void 0,void 0,function*(){return new Promise((i,o)=>{e(r,lP(t,s,n,a)).then(c=>{if(!c.ok)throw c;return s!=null&&s.noResolveJson?c:c.json()}).then(c=>i(c)).catch(c=>oP(c,o,s))})})}function Ql(e,t,r,s){return Fe(this,void 0,void 0,function*(){return Ec(e,"GET",t,r,s)})}function Bs(e,t,r,s,n){return Fe(this,void 0,void 0,function*(){return Ec(e,"POST",t,s,n,r)})}function up(e,t,r,s,n){return Fe(this,void 0,void 0,function*(){return Ec(e,"PUT",t,s,n,r)})}function cP(e,t,r,s){return Fe(this,void 0,void 0,function*(){return Ec(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),s)})}function xx(e,t,r,s,n){return Fe(this,void 0,void 0,function*(){return Ec(e,"DELETE",t,s,n,r)})}class uP{constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r}then(t,r){return this.execute().then(t,r)}execute(){return Fe(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(kt(t))return{data:null,error:t};throw t}})}}var vk;class dP{constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r,this[vk]="BlobDownloadBuilder",this.promise=null}asStream(){return new uP(this.downloadFn,this.shouldThrowOnError)}then(t,r){return this.getPromise().then(t,r)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return Fe(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(kt(t))return{data:null,error:t};throw t}})}}vk=Symbol.toStringTag;const fP={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Kv={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class hP{constructor(t,r={},s,n){this.shouldThrowOnError=!1,this.url=t,this.headers=r,this.bucketId=s,this.fetch=mx(n)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(t,r,s,n){return Fe(this,void 0,void 0,function*(){try{let a;const i=Object.assign(Object.assign({},Kv),n);let o=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(i.upsert)});const c=i.metadata;typeof Blob<"u"&&s instanceof Blob?(a=new FormData,a.append("cacheControl",i.cacheControl),c&&a.append("metadata",this.encodeMetadata(c)),a.append("",s)):typeof FormData<"u"&&s instanceof FormData?(a=s,a.has("cacheControl")||a.append("cacheControl",i.cacheControl),c&&!a.has("metadata")&&a.append("metadata",this.encodeMetadata(c))):(a=s,o["cache-control"]=`max-age=${i.cacheControl}`,o["content-type"]=i.contentType,c&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(c))),(typeof ReadableStream<"u"&&a instanceof ReadableStream||a&&typeof a=="object"&&"pipe"in a&&typeof a.pipe=="function")&&!i.duplex&&(i.duplex="half")),n!=null&&n.headers&&(o=Object.assign(Object.assign({},o),n.headers));const u=this._removeEmptyFolders(r),d=this._getFinalPath(u),f=yield(t=="PUT"?up:Bs)(this.fetch,`${this.url}/object/${d}`,a,Object.assign({headers:o},i!=null&&i.duplex?{duplex:i.duplex}:{}));return{data:{path:u,id:f.Id,fullPath:f.Key},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(kt(a))return{data:null,error:a};throw a}})}upload(t,r,s){return Fe(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,s)})}uploadToSignedUrl(t,r,s,n){return Fe(this,void 0,void 0,function*(){const a=this._removeEmptyFolders(t),i=this._getFinalPath(a),o=new URL(this.url+`/object/upload/sign/${i}`);o.searchParams.set("token",r);try{let c;const u=Object.assign({upsert:Kv.upsert},n),d=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&s instanceof Blob?(c=new FormData,c.append("cacheControl",u.cacheControl),c.append("",s)):typeof FormData<"u"&&s instanceof FormData?(c=s,c.append("cacheControl",u.cacheControl)):(c=s,d["cache-control"]=`max-age=${u.cacheControl}`,d["content-type"]=u.contentType);const f=yield up(this.fetch,o.toString(),c,{headers:d});return{data:{path:a,fullPath:f.Key},error:null}}catch(c){if(this.shouldThrowOnError)throw c;if(kt(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(t,r){return Fe(this,void 0,void 0,function*(){try{let s=this._getFinalPath(t);const n=Object.assign({},this.headers);r!=null&&r.upsert&&(n["x-upsert"]="true");const a=yield Bs(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:n}),i=new URL(this.url+a.url),o=i.searchParams.get("token");if(!o)throw new px("No token returned by API");return{data:{signedUrl:i.toString(),path:t,token:o},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(kt(s))return{data:null,error:s};throw s}})}update(t,r,s){return Fe(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,s)})}move(t,r,s){return Fe(this,void 0,void 0,function*(){try{return{data:yield Bs(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(kt(n))return{data:null,error:n};throw n}})}copy(t,r,s){return Fe(this,void 0,void 0,function*(){try{return{data:{path:(yield Bs(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers})).Key},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(kt(n))return{data:null,error:n};throw n}})}createSignedUrl(t,r,s){return Fe(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t),a=yield Bs(this.fetch,`${this.url}/object/sign/${n}`,Object.assign({expiresIn:r},s!=null&&s.transform?{transform:s.transform}:{}),{headers:this.headers});const i=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return a={signedUrl:encodeURI(`${this.url}${a.signedURL}${i}`)},{data:a,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(kt(n))return{data:null,error:n};throw n}})}createSignedUrls(t,r,s){return Fe(this,void 0,void 0,function*(){try{const n=yield Bs(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),a=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return{data:n.map(i=>Object.assign(Object.assign({},i),{signedUrl:i.signedURL?encodeURI(`${this.url}${i.signedURL}${a}`):null})),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(kt(n))return{data:null,error:n};throw n}})}download(t,r){const n=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",a=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),i=a?`?${a}`:"",o=this._getFinalPath(t),c=()=>Ql(this.fetch,`${this.url}/${n}/${o}${i}`,{headers:this.headers,noResolveJson:!0});return new dP(c,this.shouldThrowOnError)}info(t){return Fe(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const s=yield Ql(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:cp(s),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(kt(s))return{data:null,error:s};throw s}})}exists(t){return Fe(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield cP(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(kt(s)&&s instanceof lp){const n=s.originalError;if([400,404].includes(n==null?void 0:n.status))return{data:!1,error:s}}throw s}})}getPublicUrl(t,r){const s=this._getFinalPath(t),n=[],a=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";a!==""&&n.push(a);const o=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});c!==""&&n.push(c);let u=n.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${s}${u}`)}}}remove(t){return Fe(this,void 0,void 0,function*(){try{return{data:yield xx(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(kt(r))return{data:null,error:r};throw r}})}list(t,r,s){return Fe(this,void 0,void 0,function*(){try{const n=Object.assign(Object.assign(Object.assign({},fP),r),{prefix:t||""});return{data:yield Bs(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},s),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(kt(n))return{data:null,error:n};throw n}})}listV2(t,r){return Fe(this,void 0,void 0,function*(){try{const s=Object.assign({},t);return{data:yield Bs(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,s,{headers:this.headers},r),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(kt(s))return{data:null,error:s};throw s}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const yk="2.83.0",wk={"X-Client-Info":`storage-js/${yk}`};class pP{constructor(t,r={},s,n){this.shouldThrowOnError=!1;const a=new URL(t);n!=null&&n.useNewHostname&&/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase.")),this.url=a.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},wk),r),this.fetch=mx(s)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(t){return Fe(this,void 0,void 0,function*(){try{const r=this.listBucketOptionsToQueryString(t);return{data:yield Ql(this.fetch,`${this.url}/bucket${r}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(kt(r))return{data:null,error:r};throw r}})}getBucket(t){return Fe(this,void 0,void 0,function*(){try{return{data:yield Ql(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(kt(r))return{data:null,error:r};throw r}})}createBucket(t){return Fe(this,arguments,void 0,function*(r,s={public:!1}){try{return{data:yield Bs(this.fetch,`${this.url}/bucket`,{id:r,name:r,type:s.type,public:s.public,file_size_limit:s.fileSizeLimit,allowed_mime_types:s.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(kt(n))return{data:null,error:n};throw n}})}updateBucket(t,r){return Fe(this,void 0,void 0,function*(){try{return{data:yield up(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(kt(s))return{data:null,error:s};throw s}})}emptyBucket(t){return Fe(this,void 0,void 0,function*(){try{return{data:yield Bs(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(kt(r))return{data:null,error:r};throw r}})}deleteBucket(t){return Fe(this,void 0,void 0,function*(){try{return{data:yield xx(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(kt(r))return{data:null,error:r};throw r}})}listBucketOptionsToQueryString(t){const r={};return t&&("limit"in t&&(r.limit=String(t.limit)),"offset"in t&&(r.offset=String(t.offset)),t.search&&(r.search=t.search),t.sortColumn&&(r.sortColumn=t.sortColumn),t.sortOrder&&(r.sortOrder=t.sortOrder)),Object.keys(r).length>0?"?"+new URLSearchParams(r).toString():""}}class mP{constructor(t,r={},s){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},wk),r),this.fetch=mx(s)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return Fe(this,void 0,void 0,function*(){try{return{data:yield Bs(this.fetch,`${this.url}/bucket`,{name:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(kt(r))return{data:null,error:r};throw r}})}listBuckets(t){return Fe(this,void 0,void 0,function*(){try{const r=new URLSearchParams;(t==null?void 0:t.limit)!==void 0&&r.set("limit",t.limit.toString()),(t==null?void 0:t.offset)!==void 0&&r.set("offset",t.offset.toString()),t!=null&&t.sortColumn&&r.set("sortColumn",t.sortColumn),t!=null&&t.sortOrder&&r.set("sortOrder",t.sortOrder),t!=null&&t.search&&r.set("search",t.search);const s=r.toString(),n=s?`${this.url}/bucket?${s}`:`${this.url}/bucket`;return{data:yield Ql(this.fetch,n,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(kt(r))return{data:null,error:r};throw r}})}deleteBucket(t){return Fe(this,void 0,void 0,function*(){try{return{data:yield xx(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(kt(r))return{data:null,error:r};throw r}})}}const gx={"X-Client-Info":`storage-js/${yk}`,"Content-Type":"application/json"};class _k extends Error{constructor(t){super(t),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function ts(e){return typeof e=="object"&&e!==null&&"__isStorageVectorsError"in e}class gf extends _k{constructor(t,r,s){super(t),this.name="StorageVectorsApiError",this.status=r,this.statusCode=s}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class xP extends _k{constructor(t,r){super(t),this.name="StorageVectorsUnknownError",this.originalError=r}}var Xv;(function(e){e.InternalError="InternalError",e.S3VectorConflictException="S3VectorConflictException",e.S3VectorNotFoundException="S3VectorNotFoundException",e.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",e.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",e.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(Xv||(Xv={}));const vx=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),gP=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},Yv=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),vP=(e,t,r)=>Fe(void 0,void 0,void 0,function*(){if(e&&typeof e=="object"&&"status"in e&&"ok"in e&&typeof e.status=="number"&&!(r!=null&&r.noResolveJson)){const n=e.status||500,a=e;if(typeof a.json=="function")a.json().then(i=>{const o=(i==null?void 0:i.statusCode)||(i==null?void 0:i.code)||n+"";t(new gf(Yv(i),n,o))}).catch(()=>{const i=n+"",o=a.statusText||`HTTP ${n} error`;t(new gf(o,n,i))});else{const i=n+"",o=a.statusText||`HTTP ${n} error`;t(new gf(o,n,i))}}else t(new xP(Yv(e),e))}),yP=(e,t,r,s)=>{const n={method:e,headers:(t==null?void 0:t.headers)||{}};return s?(gP(s)?(n.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),n.body=JSON.stringify(s)):n.body=s,Object.assign(Object.assign({},n),r)):n};function wP(e,t,r,s,n,a){return Fe(this,void 0,void 0,function*(){return new Promise((i,o)=>{e(r,yP(t,s,n,a)).then(c=>{if(!c.ok)throw c;if(s!=null&&s.noResolveJson)return c;const u=c.headers.get("content-type");return!u||!u.includes("application/json")?{}:c.json()}).then(c=>i(c)).catch(c=>vP(c,o,s))})})}function rs(e,t,r,s,n){return Fe(this,void 0,void 0,function*(){return wP(e,"POST",t,s,n,r)})}class _P{constructor(t,r={},s){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},gx),r),this.fetch=vx(s)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(t){return Fe(this,void 0,void 0,function*(){try{return{data:(yield rs(this.fetch,`${this.url}/CreateIndex`,t,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ts(r))return{data:null,error:r};throw r}})}getIndex(t,r){return Fe(this,void 0,void 0,function*(){try{return{data:yield rs(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:t,indexName:r},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ts(s))return{data:null,error:s};throw s}})}listIndexes(t){return Fe(this,void 0,void 0,function*(){try{return{data:yield rs(this.fetch,`${this.url}/ListIndexes`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ts(r))return{data:null,error:r};throw r}})}deleteIndex(t,r){return Fe(this,void 0,void 0,function*(){try{return{data:(yield rs(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:t,indexName:r},{headers:this.headers}))||{},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ts(s))return{data:null,error:s};throw s}})}}class bP{constructor(t,r={},s){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},gx),r),this.fetch=vx(s)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(t){return Fe(this,void 0,void 0,function*(){try{if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield rs(this.fetch,`${this.url}/PutVectors`,t,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ts(r))return{data:null,error:r};throw r}})}getVectors(t){return Fe(this,void 0,void 0,function*(){try{return{data:yield rs(this.fetch,`${this.url}/GetVectors`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ts(r))return{data:null,error:r};throw r}})}listVectors(t){return Fe(this,void 0,void 0,function*(){try{if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return{data:yield rs(this.fetch,`${this.url}/ListVectors`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ts(r))return{data:null,error:r};throw r}})}queryVectors(t){return Fe(this,void 0,void 0,function*(){try{return{data:yield rs(this.fetch,`${this.url}/QueryVectors`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ts(r))return{data:null,error:r};throw r}})}deleteVectors(t){return Fe(this,void 0,void 0,function*(){try{if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield rs(this.fetch,`${this.url}/DeleteVectors`,t,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ts(r))return{data:null,error:r};throw r}})}}class SP{constructor(t,r={},s){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},gx),r),this.fetch=vx(s)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return Fe(this,void 0,void 0,function*(){try{return{data:(yield rs(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ts(r))return{data:null,error:r};throw r}})}getBucket(t){return Fe(this,void 0,void 0,function*(){try{return{data:yield rs(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ts(r))return{data:null,error:r};throw r}})}listBuckets(){return Fe(this,arguments,void 0,function*(t={}){try{return{data:yield rs(this.fetch,`${this.url}/ListVectorBuckets`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ts(r))return{data:null,error:r};throw r}})}deleteBucket(t){return Fe(this,void 0,void 0,function*(){try{return{data:(yield rs(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ts(r))return{data:null,error:r};throw r}})}}class kP extends SP{constructor(t,r={}){super(t,r.headers||{},r.fetch)}from(t){return new EP(this.url,this.headers,t,this.fetch)}}class EP extends _P{constructor(t,r,s,n){super(t,r,n),this.vectorBucketName=s}createIndex(t){const r=Object.create(null,{createIndex:{get:()=>super.createIndex}});return Fe(this,void 0,void 0,function*(){return r.createIndex.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const t=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return Fe(this,arguments,void 0,function*(r={}){return t.listIndexes.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName}))})}getIndex(t){const r=Object.create(null,{getIndex:{get:()=>super.getIndex}});return Fe(this,void 0,void 0,function*(){return r.getIndex.call(this,this.vectorBucketName,t)})}deleteIndex(t){const r=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return Fe(this,void 0,void 0,function*(){return r.deleteIndex.call(this,this.vectorBucketName,t)})}index(t){return new TP(this.url,this.headers,this.vectorBucketName,t,this.fetch)}}class TP extends bP{constructor(t,r,s,n,a){super(t,r,a),this.vectorBucketName=s,this.indexName=n}putVectors(t){const r=Object.create(null,{putVectors:{get:()=>super.putVectors}});return Fe(this,void 0,void 0,function*(){return r.putVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(t){const r=Object.create(null,{getVectors:{get:()=>super.getVectors}});return Fe(this,void 0,void 0,function*(){return r.getVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const t=Object.create(null,{listVectors:{get:()=>super.listVectors}});return Fe(this,arguments,void 0,function*(r={}){return t.listVectors.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(t){const r=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return Fe(this,void 0,void 0,function*(){return r.queryVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(t){const r=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return Fe(this,void 0,void 0,function*(){return r.deleteVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class NP extends pP{constructor(t,r={},s,n){super(t,r,s,n)}from(t){return new hP(this.url,this.headers,t,this.fetch)}get vectors(){return new kP(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new mP(this.url+"/iceberg",this.headers,this.fetch)}}const jP="2.83.0";let Qo="";typeof Deno<"u"?Qo="deno":typeof document<"u"?Qo="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Qo="react-native":Qo="node";const CP={"X-Client-Info":`supabase-js-${Qo}/${jP}`},AP={headers:CP},FP={schema:"public"},PP={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},RP={},OP=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),IP=()=>Headers,DP=(e,t,r)=>{const s=OP(r),n=IP();return async(a,i)=>{var o;const c=(o=await t())!==null&&o!==void 0?o:e;let u=new n(i==null?void 0:i.headers);return u.has("apikey")||u.set("apikey",e),u.has("Authorization")||u.set("Authorization",`Bearer ${c}`),s(a,Object.assign(Object.assign({},i),{headers:u}))}};function LP(e){return e.endsWith("/")?e:e+"/"}function MP(e,t){var r,s;const{db:n,auth:a,realtime:i,global:o}=e,{db:c,auth:u,realtime:d,global:f}=t,h={db:Object.assign(Object.assign({},c),n),auth:Object.assign(Object.assign({},u),a),realtime:Object.assign(Object.assign({},d),i),storage:{},global:Object.assign(Object.assign(Object.assign({},f),o),{headers:Object.assign(Object.assign({},(r=f==null?void 0:f.headers)!==null&&r!==void 0?r:{}),(s=o==null?void 0:o.headers)!==null&&s!==void 0?s:{})}),accessToken:async()=>""};return e.accessToken?h.accessToken=e.accessToken:delete h.accessToken,h}function BP(e){const t=e==null?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(LP(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const bk="2.83.0",bi=30*1e3,dp=3,vf=dp*bi,UP="http://localhost:9999",$P="supabase.auth.token",VP={"X-Client-Info":`gotrue-js/${bk}`},fp="X-Supabase-Api-Version",Sk={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},zP=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,WP=10*60*1e3;class Zl extends Error{constructor(t,r,s){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=s}}function Pe(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class HP extends Zl{constructor(t,r,s){super(t,r,s),this.name="AuthApiError",this.status=r,this.code=s}}function qP(e){return Pe(e)&&e.name==="AuthApiError"}class Aa extends Zl{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class xa extends Zl{constructor(t,r,s,n){super(t,s,n),this.name=r,this.status=s}}class Jr extends xa{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function GP(e){return Pe(e)&&e.name==="AuthSessionMissingError"}class pi extends xa{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class fu extends xa{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class hu extends xa{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function KP(e){return Pe(e)&&e.name==="AuthImplicitGrantRedirectError"}class Jv extends xa{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class hp extends xa{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function yf(e){return Pe(e)&&e.name==="AuthRetryableFetchError"}class Qv extends xa{constructor(t,r,s){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=s}}class pp extends xa{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const bd="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Zv=` 	
\r=`.split(""),XP=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<Zv.length;t+=1)e[Zv[t].charCodeAt(0)]=-2;for(let t=0;t<bd.length;t+=1)e[bd[t].charCodeAt(0)]=t;return e})();function ey(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const s=t.queue>>t.queuedBits-6&63;r(bd[s]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const s=t.queue>>t.queuedBits-6&63;r(bd[s]),t.queuedBits-=6}}function kk(e,t,r){const s=XP[e];if(s>-1)for(t.queue=t.queue<<6|s,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function ty(e){const t=[],r=i=>{t.push(String.fromCodePoint(i))},s={utf8seq:0,codepoint:0},n={queue:0,queuedBits:0},a=i=>{QP(i,s,r)};for(let i=0;i<e.length;i+=1)kk(e.charCodeAt(i),n,a);return t.join("")}function YP(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function JP(e,t){for(let r=0;r<e.length;r+=1){let s=e.charCodeAt(r);if(s>55295&&s<=56319){const n=(s-55296)*1024&65535;s=(e.charCodeAt(r+1)-56320&65535|n)+65536,r+=1}YP(s,t)}}function QP(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let s=1;s<6;s+=1)if(!(e>>7-s&1)){t.utf8seq=s;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function Ji(e){const t=[],r={queue:0,queuedBits:0},s=n=>{t.push(n)};for(let n=0;n<e.length;n+=1)kk(e.charCodeAt(n),r,s);return new Uint8Array(t)}function ZP(e){const t=[];return JP(e,r=>t.push(r)),new Uint8Array(t)}function La(e){const t=[],r={queue:0,queuedBits:0},s=n=>{t.push(n)};return e.forEach(n=>ey(n,r,s)),ey(null,r,s),t.join("")}function e5(e){return Math.round(Date.now()/1e3)+e}function t5(){return Symbol("auth-callback")}const ar=()=>typeof window<"u"&&typeof document<"u",ba={tested:!1,writable:!1},Ek=()=>{if(!ar())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(ba.tested)return ba.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),ba.tested=!0,ba.writable=!0}catch{ba.tested=!0,ba.writable=!1}return ba.writable};function r5(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((n,a)=>{t[a]=n})}catch{}return r.searchParams.forEach((s,n)=>{t[n]=s}),t}const Tk=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),s5=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",Si=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},Sa=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Mn=async(e,t)=>{await e.removeItem(t)};class o0{constructor(){this.promise=new o0.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}o0.promiseConstructor=Promise;function wf(e){const t=e.split(".");if(t.length!==3)throw new pp("Invalid JWT structure");for(let s=0;s<t.length;s++)if(!zP.test(t[s]))throw new pp("JWT not in base64url format");return{header:JSON.parse(ty(t[0])),payload:JSON.parse(ty(t[1])),signature:Ji(t[2]),raw:{header:t[0],payload:t[1]}}}async function n5(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function a5(e,t){return new Promise((s,n)=>{(async()=>{for(let a=0;a<1/0;a++)try{const i=await e(a);if(!t(a,null,i)){s(i);return}}catch(i){if(!t(a,i)){n(i);return}}})()})}function i5(e){return("0"+e.toString(16)).substr(-2)}function o5(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=r.length;let n="";for(let a=0;a<56;a++)n+=r.charAt(Math.floor(Math.random()*s));return n}return crypto.getRandomValues(t),Array.from(t,i5).join("")}async function l5(e){const r=new TextEncoder().encode(e),s=await crypto.subtle.digest("SHA-256",r),n=new Uint8Array(s);return Array.from(n).map(a=>String.fromCharCode(a)).join("")}async function c5(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await l5(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function mi(e,t,r=!1){const s=o5();let n=s;r&&(n+="/PASSWORD_RECOVERY"),await Si(e,`${t}-code-verifier`,n);const a=await c5(s);return[a,s===a?"plain":"s256"]}const u5=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function d5(e){const t=e.headers.get(fp);if(!t||!t.match(u5))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function f5(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function h5(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const p5=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function xi(e){if(!p5.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function _f(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const s=r.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function m5(e,t){return new Proxy(e,{get:(r,s,n)=>{if(s==="__isInsecureUserWarningProxy")return!0;if(typeof s=="symbol"){const a=s.toString();if(a==="Symbol(Symbol.toPrimitive)"||a==="Symbol(Symbol.toStringTag)"||a==="Symbol(util.inspect.custom)"||a==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,s,n)}return!t.value&&typeof s=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(r,s,n)}})}function ry(e){return JSON.parse(JSON.stringify(e))}const Na=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),x5=[502,503,504];async function sy(e){var t;if(!s5(e))throw new hp(Na(e),0);if(x5.includes(e.status))throw new hp(Na(e),e.status);let r;try{r=await e.json()}catch(a){throw new Aa(Na(a),a)}let s;const n=d5(e);if(n&&n.getTime()>=Sk["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?s=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(s=r.error_code),s){if(s==="weak_password")throw new Qv(Na(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(s==="session_not_found")throw new Jr}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((a,i)=>a&&typeof i=="string",!0))throw new Qv(Na(r),e.status,r.weak_password.reasons);throw new HP(Na(r),e.status||500,s)}const g5=(e,t,r,s)=>{const n={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),n.body=JSON.stringify(s),Object.assign(Object.assign({},n),r))};async function Ie(e,t,r,s){var n;const a=Object.assign({},s==null?void 0:s.headers);a[fp]||(a[fp]=Sk["2024-01-01"].name),s!=null&&s.jwt&&(a.Authorization=`Bearer ${s.jwt}`);const i=(n=s==null?void 0:s.query)!==null&&n!==void 0?n:{};s!=null&&s.redirectTo&&(i.redirect_to=s.redirectTo);const o=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",c=await v5(e,t,r+o,{headers:a,noResolveJson:s==null?void 0:s.noResolveJson},{},s==null?void 0:s.body);return s!=null&&s.xform?s==null?void 0:s.xform(c):{data:Object.assign({},c),error:null}}async function v5(e,t,r,s,n,a){const i=g5(t,s,n,a);let o;try{o=await e(r,Object.assign({},i))}catch(c){throw console.error(c),new hp(Na(c),0)}if(o.ok||await sy(o),s!=null&&s.noResolveJson)return o;try{return await o.json()}catch(c){await sy(c)}}function Ds(e){var t;let r=null;_5(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=e5(e.expires_in)));const s=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:s},error:null}}function ny(e){const t=Ds(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,s)=>r&&typeof s=="string",!0)&&(t.data.weak_password=e.weak_password),t}function Hn(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function y5(e){return{data:e,error:null}}function w5(e){const{action_link:t,email_otp:r,hashed_token:s,redirect_to:n,verification_type:a}=e,i=Eo(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:t,email_otp:r,hashed_token:s,redirect_to:n,verification_type:a},c=Object.assign({},i);return{data:{properties:o,user:c},error:null}}function ay(e){return e}function _5(e){return e.access_token&&e.refresh_token&&e.expires_in}const bf=["global","local","others"];class b5{constructor({url:t="",headers:r={},fetch:s}){this.url=t,this.headers=r,this.fetch=Tk(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=bf[0]){if(bf.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${bf.join(", ")}`);try{return await Ie(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(s){if(Pe(s))return{data:null,error:s};throw s}}async inviteUserByEmail(t,r={}){try{return await Ie(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Hn})}catch(s){if(Pe(s))return{data:{user:null},error:s};throw s}}async generateLink(t){try{const{options:r}=t,s=Eo(t,["options"]),n=Object.assign(Object.assign({},s),r);return"newEmail"in s&&(n.new_email=s==null?void 0:s.newEmail,delete n.newEmail),await Ie(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:w5,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(Pe(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await Ie(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Hn})}catch(r){if(Pe(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,s,n,a,i,o,c;try{const u={nextPage:null,lastPage:0,total:0},d=await Ie(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:"",per_page:(a=(n=t==null?void 0:t.perPage)===null||n===void 0?void 0:n.toString())!==null&&a!==void 0?a:""},xform:ay});if(d.error)throw d.error;const f=await d.json(),h=(i=d.headers.get("x-total-count"))!==null&&i!==void 0?i:0,m=(c=(o=d.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&c!==void 0?c:[];return m.length>0&&(m.forEach(p=>{const x=parseInt(p.split(";")[0].split("=")[1].substring(0,1)),v=JSON.parse(p.split(";")[1].split("=")[1]);u[`${v}Page`]=x}),u.total=parseInt(h)),{data:Object.assign(Object.assign({},f),u),error:null}}catch(u){if(Pe(u))return{data:{users:[]},error:u};throw u}}async getUserById(t){xi(t);try{return await Ie(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Hn})}catch(r){if(Pe(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){xi(t);try{return await Ie(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:Hn})}catch(s){if(Pe(s))return{data:{user:null},error:s};throw s}}async deleteUser(t,r=!1){xi(t);try{return await Ie(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:Hn})}catch(s){if(Pe(s))return{data:{user:null},error:s};throw s}}async _listFactors(t){xi(t.userId);try{const{data:r,error:s}=await Ie(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:r,error:s}}catch(r){if(Pe(r))return{data:null,error:r};throw r}}async _deleteFactor(t){xi(t.userId),xi(t.id);try{return{data:await Ie(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Pe(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,s,n,a,i,o,c;try{const u={nextPage:null,lastPage:0,total:0},d=await Ie(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:"",per_page:(a=(n=t==null?void 0:t.perPage)===null||n===void 0?void 0:n.toString())!==null&&a!==void 0?a:""},xform:ay});if(d.error)throw d.error;const f=await d.json(),h=(i=d.headers.get("x-total-count"))!==null&&i!==void 0?i:0,m=(c=(o=d.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&c!==void 0?c:[];return m.length>0&&(m.forEach(p=>{const x=parseInt(p.split(";")[0].split("=")[1].substring(0,1)),v=JSON.parse(p.split(";")[1].split("=")[1]);u[`${v}Page`]=x}),u.total=parseInt(h)),{data:Object.assign(Object.assign({},f),u),error:null}}catch(u){if(Pe(u))return{data:{clients:[]},error:u};throw u}}async _createOAuthClient(t){try{return await Ie(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Pe(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await Ie(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Pe(r))return{data:null,error:r};throw r}}async _updateOAuthClient(t,r){try{return await Ie(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:r,headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(Pe(s))return{data:null,error:s};throw s}}async _deleteOAuthClient(t){try{return await Ie(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Pe(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await Ie(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Pe(r))return{data:null,error:r};throw r}}}function iy(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const gi={debug:!!(globalThis&&Ek()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Nk extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class S5 extends Nk{}async function k5(e,t,r){gi.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const s=new globalThis.AbortController;return t>0&&setTimeout(()=>{s.abort(),gi.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async n=>{if(n){gi.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,n.name);try{return await r()}finally{gi.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,n.name)}}else{if(t===0)throw gi.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new S5(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(gi.debug)try{const a=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function E5(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function jk(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function T5(e){return parseInt(e,16)}function N5(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,s=>s.toString(16).padStart(2,"0")).join("")}function j5(e){var t;const{chainId:r,domain:s,expirationTime:n,issuedAt:a=new Date,nonce:i,notBefore:o,requestId:c,resources:u,scheme:d,uri:f,version:h}=e;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!s)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(i&&i.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${i}`);if(!f)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(h!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${h}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const m=jk(e.address),p=d?`${d}://${s}`:s,x=e.statement?`${e.statement}
`:"",v=`${p} wants you to sign in with your Ethereum account:
${m}

${x}`;let y=`URI: ${f}
Version: ${h}
Chain ID: ${r}${i?`
Nonce: ${i}`:""}
Issued At: ${a.toISOString()}`;if(n&&(y+=`
Expiration Time: ${n.toISOString()}`),o&&(y+=`
Not Before: ${o.toISOString()}`),c&&(y+=`
Request ID: ${c}`),u){let w=`
Resources:`;for(const g of u){if(!g||typeof g!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${g}`);w+=`
- ${g}`}y+=w}return`${v}
${y}`}class Ht extends Error{constructor({message:t,code:r,cause:s,name:n}){var a;super(t,{cause:s}),this.__isWebAuthnError=!0,this.name=(a=n??(s instanceof Error?s.name:void 0))!==null&&a!==void 0?a:"Unknown Error",this.code=r}}class Sd extends Ht{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function C5({error:e,options:t}){var r,s,n;const{publicKey:a}=t;if(!a)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Ht({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((r=a.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new Ht({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((s=a.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new Ht({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((n=a.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new Ht({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new Ht({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new Ht({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return a.pubKeyCredParams.filter(o=>o.type==="public-key").length===0?new Ht({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new Ht({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const i=window.location.hostname;if(Ck(i)){if(a.rp.id!==i)return new Ht({message:`The RP ID "${a.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Ht({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(a.user.id.byteLength<1||a.user.id.byteLength>64)return new Ht({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new Ht({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Ht({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function A5({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Ht({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new Ht({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const s=window.location.hostname;if(Ck(s)){if(r.rpId!==s)return new Ht({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Ht({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new Ht({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Ht({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}class F5{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const P5=new F5;function R5(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:s}=e,n=Eo(e,["challenge","user","excludeCredentials"]),a=Ji(t).buffer,i=Object.assign(Object.assign({},r),{id:Ji(r.id).buffer}),o=Object.assign(Object.assign({},n),{challenge:a,user:i});if(s&&s.length>0){o.excludeCredentials=new Array(s.length);for(let c=0;c<s.length;c++){const u=s[c];o.excludeCredentials[c]=Object.assign(Object.assign({},u),{id:Ji(u.id).buffer,type:u.type||"public-key",transports:u.transports})}}return o}function O5(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,s=Eo(e,["challenge","allowCredentials"]),n=Ji(t).buffer,a=Object.assign(Object.assign({},s),{challenge:n});if(r&&r.length>0){a.allowCredentials=new Array(r.length);for(let i=0;i<r.length;i++){const o=r[i];a.allowCredentials[i]=Object.assign(Object.assign({},o),{id:Ji(o.id).buffer,type:o.type||"public-key",transports:o.transports})}}return a}function I5(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:La(new Uint8Array(e.response.attestationObject)),clientDataJSON:La(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function D5(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e,s=e.getClientExtensionResults(),n=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:La(new Uint8Array(n.authenticatorData)),clientDataJSON:La(new Uint8Array(n.clientDataJSON)),signature:La(new Uint8Array(n.signature)),userHandle:n.userHandle?La(new Uint8Array(n.userHandle)):void 0},type:"public-key",clientExtensionResults:s,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function Ck(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function oy(){var e,t;return!!(ar()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.get)=="function")}async function L5(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Sd("Browser returned unexpected credential type",t)}:{data:null,error:new Sd("Empty credential response",t)}}catch(t){return{data:null,error:C5({error:t,options:e})}}}async function M5(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Sd("Browser returned unexpected credential type",t)}:{data:null,error:new Sd("Empty credential response",t)}}catch(t){return{data:null,error:A5({error:t,options:e})}}}const B5={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},U5={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function kd(...e){const t=n=>n!==null&&typeof n=="object"&&!Array.isArray(n),r=n=>n instanceof ArrayBuffer||ArrayBuffer.isView(n),s={};for(const n of e)if(n)for(const a in n){const i=n[a];if(i!==void 0)if(Array.isArray(i))s[a]=i;else if(r(i))s[a]=i;else if(t(i)){const o=s[a];t(o)?s[a]=kd(o,i):s[a]=kd(i)}else s[a]=i}return s}function $5(e,t){return kd(B5,e,t||{})}function V5(e,t){return kd(U5,e,t||{})}class z5{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:s,signal:n},a){try{const{data:i,error:o}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!i)return{data:null,error:o};const c=n??P5.createNewAbortSignal();if(i.webauthn.type==="create"){const{user:u}=i.webauthn.credential_options.publicKey;u.name||(u.name=`${u.id}:${s}`),u.displayName||(u.displayName=u.name)}switch(i.webauthn.type){case"create":{const u=$5(i.webauthn.credential_options.publicKey,a==null?void 0:a.create),{data:d,error:f}=await L5({publicKey:u,signal:c});return d?{data:{factorId:t,challengeId:i.id,webauthn:{type:i.webauthn.type,credential_response:d}},error:null}:{data:null,error:f}}case"request":{const u=V5(i.webauthn.credential_options.publicKey,a==null?void 0:a.request),{data:d,error:f}=await M5(Object.assign(Object.assign({},i.webauthn.credential_options),{publicKey:u,signal:c}));return d?{data:{factorId:t,challengeId:i.id,webauthn:{type:i.webauthn.type,credential_response:d}},error:null}:{data:null,error:f}}}}catch(i){return Pe(i)?{data:null,error:i}:{data:null,error:new Aa("Unexpected error in challenge",i)}}}async _verify({challengeId:t,factorId:r,webauthn:s}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:s})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:n}={}},a){if(!r)return{data:null,error:new Zl("rpId is required for WebAuthn authentication")};try{if(!oy())return{data:null,error:new Aa("Browser does not support WebAuthn",null)};const{data:i,error:o}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:s},signal:n},{request:a});if(!i)return{data:null,error:o};const{webauthn:c}=i;return this._verify({factorId:t,challengeId:i.challengeId,webauthn:{type:c.type,rpId:r,rpOrigins:s,credential_response:c.credential_response}})}catch(i){return Pe(i)?{data:null,error:i}:{data:null,error:new Aa("Unexpected error in authenticate",i)}}}async _register({friendlyName:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:n}={}},a){if(!r)return{data:null,error:new Zl("rpId is required for WebAuthn registration")};try{if(!oy())return{data:null,error:new Aa("Browser does not support WebAuthn",null)};const{data:i,error:o}=await this._enroll({friendlyName:t});if(!i)return await this.client.mfa.listFactors().then(d=>{var f;return(f=d.data)===null||f===void 0?void 0:f.all.find(h=>h.factor_type==="webauthn"&&h.friendly_name===t&&h.status!=="unverified")}).then(d=>d?this.client.mfa.unenroll({factorId:d==null?void 0:d.id}):void 0),{data:null,error:o};const{data:c,error:u}=await this._challenge({factorId:i.id,friendlyName:i.friendly_name,webauthn:{rpId:r,rpOrigins:s},signal:n},{create:a});return c?this._verify({factorId:i.id,challengeId:c.challengeId,webauthn:{rpId:r,rpOrigins:s,type:c.webauthn.type,credential_response:c.webauthn.credential_response}}):{data:null,error:u}}catch(i){return Pe(i)?{data:null,error:i}:{data:null,error:new Aa("Unexpected error in register",i)}}}}E5();const W5={url:UP,storageKey:$P,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:VP,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function ly(e,t,r){return await r()}const vi={};class ec{get jwks(){var t,r;return(r=(t=vi[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){vi[this.storageKey]=Object.assign(Object.assign({},vi[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=vi[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){vi[this.storageKey]=Object.assign(Object.assign({},vi[this.storageKey]),{cachedAt:t})}constructor(t){var r,s,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const a=Object.assign(Object.assign({},W5),t);if(this.storageKey=a.storageKey,this.instanceID=(r=ec.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,ec.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.instanceID>0&&ar()){const i=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(i),this.logDebugMessages&&console.trace(i)}if(this.persistSession=a.persistSession,this.autoRefreshToken=a.autoRefreshToken,this.admin=new b5({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=Tk(a.fetch),this.lock=a.lock||ly,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,this.throwOnError=a.throwOnError,a.lock?this.lock=a.lock:ar()&&(!((s=globalThis==null?void 0:globalThis.navigator)===null||s===void 0)&&s.locks)?this.lock=k5:this.lock=ly,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new z5(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:Ek()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=iy(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=iy(this.memoryStorage)),ar()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${bk}) ${new Date().toISOString()}`}_debug(...t){return this.logDebugMessages&&this.logger(this._logPrefix(),...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let r={},s="none";if(ar()&&(r=r5(window.location.href),this._isImplicitGrantCallback(r)?s="implicit":await this._isPKCECallback(r)&&(s="pkce")),ar()&&this.detectSessionInUrl&&s!=="none"){const{data:n,error:a}=await this._getSessionFromURL(r,s);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),KP(a)){const c=(t=a.details)===null||t===void 0?void 0:t.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:a}}return await this._removeSession(),{error:a}}const{session:i,redirectType:o}=n;return this._debug("#_initialize()","detected session in URL",i,"redirect type",o),await this._saveSession(i),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Pe(r)?this._returnResult({error:r}):this._returnResult({error:new Aa("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,s,n;try{const a=await Ie(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(n=t==null?void 0:t.options)===null||n===void 0?void 0:n.captchaToken}},xform:Ds}),{data:i,error:o}=a;if(o||!i)return this._returnResult({data:{user:null,session:null},error:o});const c=i.session,u=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:u,session:c},error:null})}catch(a){if(Pe(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signUp(t){var r,s,n;try{let a;if("email"in t){const{email:d,password:f,options:h}=t;let m=null,p=null;this.flowType==="pkce"&&([m,p]=await mi(this.storage,this.storageKey)),a=await Ie(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h==null?void 0:h.emailRedirectTo,body:{email:d,password:f,data:(r=h==null?void 0:h.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:m,code_challenge_method:p},xform:Ds})}else if("phone"in t){const{phone:d,password:f,options:h}=t;a=await Ie(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:f,data:(s=h==null?void 0:h.data)!==null&&s!==void 0?s:{},channel:(n=h==null?void 0:h.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:Ds})}else throw new fu("You must provide either an email or phone number and a password");const{data:i,error:o}=a;if(o||!i)return this._returnResult({data:{user:null,session:null},error:o});const c=i.session,u=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:u,session:c},error:null})}catch(a){if(Pe(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithPassword(t){try{let r;if("email"in t){const{email:a,password:i,options:o}=t;r=await Ie(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:a,password:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:ny})}else if("phone"in t){const{phone:a,password:i,options:o}=t;r=await Ie(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:a,password:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:ny})}else throw new fu("You must provide either an email or phone number and a password");const{data:s,error:n}=r;if(n)return this._returnResult({data:{user:null,session:null},error:n});if(!s||!s.session||!s.user){const a=new pi;return this._returnResult({data:{user:null,session:null},error:a})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:n})}catch(r){if(Pe(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(t){var r,s,n,a;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(s=t.options)===null||s===void 0?void 0:s.scopes,queryParams:(n=t.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(a=t.options)===null||a===void 0?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,s,n,a,i,o,c,u,d,f,h;let m,p;if("message"in t)m=t.message,p=t.signature;else{const{chain:x,wallet:v,statement:y,options:w}=t;let g;if(ar())if(typeof v=="object")g=v;else{const j=window;if("ethereum"in j&&typeof j.ethereum=="object"&&"request"in j.ethereum&&typeof j.ethereum.request=="function")g=j.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof v!="object"||!(w!=null&&w.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");g=v}const _=new URL((r=w==null?void 0:w.url)!==null&&r!==void 0?r:window.location.href),b=await g.request({method:"eth_requestAccounts"}).then(j=>j).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!b||b.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const k=jk(b[0]);let S=(s=w==null?void 0:w.signInWithEthereum)===null||s===void 0?void 0:s.chainId;if(!S){const j=await g.request({method:"eth_chainId"});S=T5(j)}const T={domain:_.host,address:k,statement:y,uri:_.href,version:"1",chainId:S,nonce:(n=w==null?void 0:w.signInWithEthereum)===null||n===void 0?void 0:n.nonce,issuedAt:(i=(a=w==null?void 0:w.signInWithEthereum)===null||a===void 0?void 0:a.issuedAt)!==null&&i!==void 0?i:new Date,expirationTime:(o=w==null?void 0:w.signInWithEthereum)===null||o===void 0?void 0:o.expirationTime,notBefore:(c=w==null?void 0:w.signInWithEthereum)===null||c===void 0?void 0:c.notBefore,requestId:(u=w==null?void 0:w.signInWithEthereum)===null||u===void 0?void 0:u.requestId,resources:(d=w==null?void 0:w.signInWithEthereum)===null||d===void 0?void 0:d.resources};m=j5(T),p=await g.request({method:"personal_sign",params:[N5(m),k]})}try{const{data:x,error:v}=await Ie(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:m,signature:p},!((f=t.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(h=t.options)===null||h===void 0?void 0:h.captchaToken}}:null),xform:Ds});if(v)throw v;if(!x||!x.session||!x.user){const y=new pi;return this._returnResult({data:{user:null,session:null},error:y})}return x.session&&(await this._saveSession(x.session),await this._notifyAllSubscribers("SIGNED_IN",x.session)),this._returnResult({data:Object.assign({},x),error:v})}catch(x){if(Pe(x))return this._returnResult({data:{user:null,session:null},error:x});throw x}}async signInWithSolana(t){var r,s,n,a,i,o,c,u,d,f,h,m;let p,x;if("message"in t)p=t.message,x=t.signature;else{const{chain:v,wallet:y,statement:w,options:g}=t;let _;if(ar())if(typeof y=="object")_=y;else{const k=window;if("solana"in k&&typeof k.solana=="object"&&("signIn"in k.solana&&typeof k.solana.signIn=="function"||"signMessage"in k.solana&&typeof k.solana.signMessage=="function"))_=k.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof y!="object"||!(g!=null&&g.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");_=y}const b=new URL((r=g==null?void 0:g.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in _&&_.signIn){const k=await _.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},g==null?void 0:g.signInWithSolana),{version:"1",domain:b.host,uri:b.href}),w?{statement:w}:null));let S;if(Array.isArray(k)&&k[0]&&typeof k[0]=="object")S=k[0];else if(k&&typeof k=="object"&&"signedMessage"in k&&"signature"in k)S=k;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in S&&"signature"in S&&(typeof S.signedMessage=="string"||S.signedMessage instanceof Uint8Array)&&S.signature instanceof Uint8Array)p=typeof S.signedMessage=="string"?S.signedMessage:new TextDecoder().decode(S.signedMessage),x=S.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in _)||typeof _.signMessage!="function"||!("publicKey"in _)||typeof _!="object"||!_.publicKey||!("toBase58"in _.publicKey)||typeof _.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");p=[`${b.host} wants you to sign in with your Solana account:`,_.publicKey.toBase58(),...w?["",w,""]:[""],"Version: 1",`URI: ${b.href}`,`Issued At: ${(n=(s=g==null?void 0:g.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&n!==void 0?n:new Date().toISOString()}`,...!((a=g==null?void 0:g.signInWithSolana)===null||a===void 0)&&a.notBefore?[`Not Before: ${g.signInWithSolana.notBefore}`]:[],...!((i=g==null?void 0:g.signInWithSolana)===null||i===void 0)&&i.expirationTime?[`Expiration Time: ${g.signInWithSolana.expirationTime}`]:[],...!((o=g==null?void 0:g.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${g.signInWithSolana.chainId}`]:[],...!((c=g==null?void 0:g.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${g.signInWithSolana.nonce}`]:[],...!((u=g==null?void 0:g.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${g.signInWithSolana.requestId}`]:[],...!((f=(d=g==null?void 0:g.signInWithSolana)===null||d===void 0?void 0:d.resources)===null||f===void 0)&&f.length?["Resources",...g.signInWithSolana.resources.map(S=>`- ${S}`)]:[]].join(`
`);const k=await _.signMessage(new TextEncoder().encode(p),"utf8");if(!k||!(k instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");x=k}}try{const{data:v,error:y}=await Ie(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:p,signature:La(x)},!((h=t.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(m=t.options)===null||m===void 0?void 0:m.captchaToken}}:null),xform:Ds});if(y)throw y;if(!v||!v.session||!v.user){const w=new pi;return this._returnResult({data:{user:null,session:null},error:w})}return v.session&&(await this._saveSession(v.session),await this._notifyAllSubscribers("SIGNED_IN",v.session)),this._returnResult({data:Object.assign({},v),error:y})}catch(v){if(Pe(v))return this._returnResult({data:{user:null,session:null},error:v});throw v}}async _exchangeCodeForSession(t){const r=await Sa(this.storage,`${this.storageKey}-code-verifier`),[s,n]=(r??"").split("/");try{const{data:a,error:i}=await Ie(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:s},xform:Ds});if(await Mn(this.storage,`${this.storageKey}-code-verifier`),i)throw i;if(!a||!a.session||!a.user){const o=new pi;return this._returnResult({data:{user:null,session:null,redirectType:null},error:o})}return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),this._returnResult({data:Object.assign(Object.assign({},a),{redirectType:n??null}),error:i})}catch(a){if(Pe(a))return this._returnResult({data:{user:null,session:null,redirectType:null},error:a});throw a}}async signInWithIdToken(t){try{const{options:r,provider:s,token:n,access_token:a,nonce:i}=t,o=await Ie(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:n,access_token:a,nonce:i,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:Ds}),{data:c,error:u}=o;if(u)return this._returnResult({data:{user:null,session:null},error:u});if(!c||!c.session||!c.user){const d=new pi;return this._returnResult({data:{user:null,session:null},error:d})}return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),this._returnResult({data:c,error:u})}catch(r){if(Pe(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(t){var r,s,n,a,i;try{if("email"in t){const{email:o,options:c}=t;let u=null,d=null;this.flowType==="pkce"&&([u,d]=await mi(this.storage,this.storageKey));const{error:f}=await Ie(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(r=c==null?void 0:c.data)!==null&&r!==void 0?r:{},create_user:(s=c==null?void 0:c.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:u,code_challenge_method:d},redirectTo:c==null?void 0:c.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:f})}if("phone"in t){const{phone:o,options:c}=t,{data:u,error:d}=await Ie(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(n=c==null?void 0:c.data)!==null&&n!==void 0?n:{},create_user:(a=c==null?void 0:c.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(i=c==null?void 0:c.channel)!==null&&i!==void 0?i:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:d})}throw new fu("You must provide either an email or phone number.")}catch(o){if(Pe(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async verifyOtp(t){var r,s;try{let n,a;"options"in t&&(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo,a=(s=t.options)===null||s===void 0?void 0:s.captchaToken);const{data:i,error:o}=await Ie(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:a}}),redirectTo:n,xform:Ds});if(o)throw o;if(!i)throw new Error("An error occurred on token verification.");const c=i.session,u=i.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),this._returnResult({data:{user:u,session:c},error:null})}catch(n){if(Pe(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithSSO(t){var r,s,n,a,i;try{let o=null,c=null;this.flowType==="pkce"&&([o,c]=await mi(this.storage,this.storageKey));const u=await Ie(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(s=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&s!==void 0?s:void 0}),!((n=t==null?void 0:t.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:o,code_challenge_method:c}),headers:this.headers,xform:y5});return!((a=u.data)===null||a===void 0)&&a.url&&ar()&&!(!((i=t.options)===null||i===void 0)&&i.skipBrowserRedirect)&&window.location.assign(u.data.url),this._returnResult(u)}catch(o){if(Pe(o))return this._returnResult({data:null,error:o});throw o}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:s}=t;if(s)throw s;if(!r)throw new Jr;const{error:n}=await Ie(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:n})})}catch(t){if(Pe(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:s,type:n,options:a}=t,{error:i}=await Ie(this.fetch,"POST",r,{headers:this.headers,body:{email:s,type:n,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},redirectTo:a==null?void 0:a.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:i})}else if("phone"in t){const{phone:s,type:n,options:a}=t,{data:i,error:o}=await Ie(this.fetch,"POST",r,{headers:this.headers,body:{phone:s,type:n,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:i==null?void 0:i.message_id},error:o})}throw new fu("You must provide either an email or phone number and a type")}catch(r){if(Pe(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await s,await r()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=r();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await Sa(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const s=t.expires_at?t.expires_at*1e3-Date.now()<vf:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",t.expires_at),!s){if(this.userStorage){const i=await Sa(this.userStorage,this.storageKey+"-user");i!=null&&i.user?t.user=i.user:t.user=_f()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const i={value:this.suppressGetSessionWarning};t.user=m5(t.user,i),i.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:n,error:a}=await this._callRefreshToken(t.refresh_token);return a?this._returnResult({data:{session:null},error:a}):this._returnResult({data:{session:n},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await Ie(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Hn}):await this._useSession(async r=>{var s,n,a;const{data:i,error:o}=r;if(o)throw o;return!(!((s=i.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Jr}:await Ie(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0,xform:Hn})})}catch(r){if(Pe(r))return GP(r)&&(await this._removeSession(),await Mn(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async s=>{const{data:n,error:a}=s;if(a)throw a;if(!n.session)throw new Jr;const i=n.session;let o=null,c=null;this.flowType==="pkce"&&t.email!=null&&([o,c]=await mi(this.storage,this.storageKey));const{data:u,error:d}=await Ie(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:o,code_challenge_method:c}),jwt:i.access_token,xform:Hn});if(d)throw d;return i.user=u.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),this._returnResult({data:{user:i.user},error:null})})}catch(s){if(Pe(s))return this._returnResult({data:{user:null},error:s});throw s}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Jr;const r=Date.now()/1e3;let s=r,n=!0,a=null;const{payload:i}=wf(t.access_token);if(i.exp&&(s=i.exp,n=s<=r),n){const{data:o,error:c}=await this._callRefreshToken(t.refresh_token);if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!o)return{data:{user:null,session:null},error:null};a=o}else{const{data:o,error:c}=await this._getUser(t.access_token);if(c)throw c;a={access_token:t.access_token,refresh_token:t.refresh_token,user:o.user,token_type:"bearer",expires_in:s-r,expires_at:s},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return this._returnResult({data:{user:a.user,session:a},error:null})}catch(r){if(Pe(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var s;if(!t){const{data:i,error:o}=r;if(o)throw o;t=(s=i.session)!==null&&s!==void 0?s:void 0}if(!(t!=null&&t.refresh_token))throw new Jr;const{data:n,error:a}=await this._callRefreshToken(t.refresh_token);return a?this._returnResult({data:{user:null,session:null},error:a}):n?this._returnResult({data:{user:n.user,session:n},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(Pe(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(t,r){try{if(!ar())throw new hu("No browser detected.");if(t.error||t.error_description||t.error_code)throw new hu(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Jv("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new hu("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new Jv("No code detected.");const{data:w,error:g}=await this._exchangeCodeForSession(t.code);if(g)throw g;const _=new URL(window.location.href);return _.searchParams.delete("code"),window.history.replaceState(window.history.state,"",_.toString()),{data:{session:w.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:n,access_token:a,refresh_token:i,expires_in:o,expires_at:c,token_type:u}=t;if(!a||!o||!i||!u)throw new hu("No session defined in URL");const d=Math.round(Date.now()/1e3),f=parseInt(o);let h=d+f;c&&(h=parseInt(c));const m=h-d;m*1e3<=bi&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${m}s, should have been closer to ${f}s`);const p=h-f;d-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,h,d):d-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",p,h,d);const{data:x,error:v}=await this._getUser(a);if(v)throw v;const y={provider_token:s,provider_refresh_token:n,access_token:a,expires_in:f,expires_at:h,refresh_token:i,token_type:u,user:x.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:y,redirectType:t.type},error:null})}catch(s){if(Pe(s))return this._returnResult({data:{session:null,redirectType:null},error:s});throw s}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await Sa(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var s;const{data:n,error:a}=r;if(a)return this._returnResult({error:a});const i=(s=n.session)===null||s===void 0?void 0:s.access_token;if(i){const{error:o}=await this.admin.signOut(i,t);if(o&&!(qP(o)&&(o.status===404||o.status===401||o.status===403)))return this._returnResult({error:o})}return t!=="others"&&(await this._removeSession(),await Mn(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const r=t5(),s={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:s}}}async _emitInitialSession(t){return await this._useSession(async r=>{var s,n;try{const{data:{session:a},error:i}=r;if(i)throw i;await((s=this.stateChangeEmitters.get(t))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",t,"session",a)}catch(a){await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",a),console.error(a)}})}async resetPasswordForEmail(t,r={}){let s=null,n=null;this.flowType==="pkce"&&([s,n]=await mi(this.storage,this.storageKey,!0));try{return await Ie(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:s,code_challenge_method:n,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(a){if(Pe(a))return this._returnResult({data:null,error:a});throw a}}async getUserIdentities(){var t;try{const{data:r,error:s}=await this.getUser();if(s)throw s;return this._returnResult({data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(r){if(Pe(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:s,error:n}=await this._useSession(async a=>{var i,o,c,u,d;const{data:f,error:h}=a;if(h)throw h;const m=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(i=t.options)===null||i===void 0?void 0:i.redirectTo,scopes:(o=t.options)===null||o===void 0?void 0:o.scopes,queryParams:(c=t.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await Ie(this.fetch,"GET",m,{headers:this.headers,jwt:(d=(u=f.session)===null||u===void 0?void 0:u.access_token)!==null&&d!==void 0?d:void 0})});if(n)throw n;return ar()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(s==null?void 0:s.url),this._returnResult({data:{provider:t.provider,url:s==null?void 0:s.url},error:null})}catch(s){if(Pe(s))return this._returnResult({data:{provider:t.provider,url:null},error:s});throw s}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var s;try{const{error:n,data:{session:a}}=r;if(n)throw n;const{options:i,provider:o,token:c,access_token:u,nonce:d}=t,f=await Ie(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(s=a==null?void 0:a.access_token)!==null&&s!==void 0?s:void 0,body:{provider:o,id_token:c,access_token:u,nonce:d,link_identity:!0,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},xform:Ds}),{data:h,error:m}=f;return m?this._returnResult({data:{user:null,session:null},error:m}):!h||!h.session||!h.user?this._returnResult({data:{user:null,session:null},error:new pi}):(h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("USER_UPDATED",h.session)),this._returnResult({data:h,error:m}))}catch(n){if(Pe(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var s,n;const{data:a,error:i}=r;if(i)throw i;return await Ie(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(n=(s=a.session)===null||s===void 0?void 0:s.access_token)!==null&&n!==void 0?n:void 0})})}catch(r){if(Pe(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const s=Date.now();return await a5(async n=>(n>0&&await n5(200*Math.pow(2,n-1)),this._debug(r,"refreshing attempt",n),await Ie(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Ds})),(n,a)=>{const i=200*Math.pow(2,n);return a&&yf(a)&&Date.now()+i-s<bi})}catch(s){if(this._debug(r,"error",s),Pe(s))return this._returnResult({data:{session:null,user:null},error:s});throw s}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const s=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",s),ar()&&!r.skipBrowserRedirect&&window.location.assign(s),{data:{provider:t,url:s},error:null}}async _recoverAndRefresh(){var t,r;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const n=await Sa(this.storage,this.storageKey);if(n&&this.userStorage){let i=await Sa(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!i&&(i={user:n.user},await Si(this.userStorage,this.storageKey+"-user",i)),n.user=(t=i==null?void 0:i.user)!==null&&t!==void 0?t:_f()}else if(n&&!n.user&&!n.user){const i=await Sa(this.storage,this.storageKey+"-user");i&&(i!=null&&i.user)?(n.user=i.user,await Mn(this.storage,this.storageKey+"-user"),await Si(this.storage,this.storageKey,n)):n.user=_f()}if(this._debug(s,"session from storage",n),!this._isValidSession(n)){this._debug(s,"session is not valid"),n!==null&&await this._removeSession();return}const a=((r=n.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<vf;if(this._debug(s,`session has${a?"":" not"} expired with margin of ${vf}s`),a){if(this.autoRefreshToken&&n.refresh_token){const{error:i}=await this._callRefreshToken(n.refresh_token);i&&(console.error(i),yf(i)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else if(n.user&&n.user.__isUserNotAvailableProxy===!0)try{const{data:i,error:o}=await this._getUser(n.access_token);!o&&(i!=null&&i.user)?(n.user=i.user,await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(i){console.error("Error getting user data:",i),this._debug(s,"error getting user data, skipping SIGNED_IN notification",i)}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(s,"error",n),console.error(n);return}finally{this._debug(s,"end")}}async _callRefreshToken(t){var r,s;if(!t)throw new Jr;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new o0;const{data:a,error:i}=await this._refreshAccessToken(t);if(i)throw i;if(!a.session)throw new Jr;await this._saveSession(a.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const o={data:a.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(a){if(this._debug(n,"error",a),Pe(a)){const i={data:null,error:a};return yf(a)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(i),i}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(a),a}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(t,r,s=!0){const n=`#_notifyAllSubscribers(${t})`;this._debug(n,"begin",r,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:t,session:r});const a=[],i=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(t,r)}catch(c){a.push(c)}});if(await Promise.all(i),a.length>0){for(let o=0;o<a.length;o+=1)console.error(a[o]);throw a[0]}}finally{this._debug(n,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const r=Object.assign({},t),s=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!s&&r.user&&await Si(this.userStorage,this.storageKey+"-user",{user:r.user});const n=Object.assign({},r);delete n.user;const a=ry(n);await Si(this.storage,this.storageKey,a)}else{const n=ry(r);await Si(this.storage,this.storageKey,n)}}async _removeSession(){this._debug("#_removeSession()"),await Mn(this.storage,this.storageKey),await Mn(this.storage,this.storageKey+"-code-verifier"),await Mn(this.storage,this.storageKey+"-user"),this.userStorage&&await Mn(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&ar()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),bi);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:s}}=r;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((s.expires_at*1e3-t)/bi);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${bi}ms, refresh threshold is ${dp} ticks`),n<=dp&&await this._callRefreshToken(s.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof Nk)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!ar()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,s){const n=[`provider=${encodeURIComponent(r)}`];if(s!=null&&s.redirectTo&&n.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s!=null&&s.scopes&&n.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[a,i]=await mi(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(i)}`});n.push(o.toString())}if(s!=null&&s.queryParams){const a=new URLSearchParams(s.queryParams);n.push(a.toString())}return s!=null&&s.skipBrowserRedirect&&n.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${t}?${n.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var s;const{data:n,error:a}=r;return a?this._returnResult({data:null,error:a}):await Ie(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token})})}catch(r){if(Pe(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(t){try{return await this._useSession(async r=>{var s,n;const{data:a,error:i}=r;if(i)return this._returnResult({data:null,error:i});const o=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:c,error:u}=await Ie(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(s=a==null?void 0:a.session)===null||s===void 0?void 0:s.access_token});return u?this._returnResult({data:null,error:u}):(t.factorType==="totp"&&c.type==="totp"&&(!((n=c==null?void 0:c.totp)===null||n===void 0)&&n.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),this._returnResult({data:c,error:null}))})}catch(r){if(Pe(r))return this._returnResult({data:null,error:r});throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var s;const{data:n,error:a}=r;if(a)return this._returnResult({data:null,error:a});const i=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?I5(t.webauthn.credential_response):D5(t.webauthn.credential_response)})}:{code:t.code}),{data:o,error:c}=await Ie(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:i,headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token});return c?this._returnResult({data:null,error:c}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),this._returnResult({data:o,error:c}))})}catch(r){if(Pe(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var s;const{data:n,error:a}=r;if(a)return this._returnResult({data:null,error:a});const i=await Ie(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token});if(i.error)return i;const{data:o}=i;if(o.type!=="webauthn")return{data:o,error:null};switch(o.webauthn.type){case"create":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:R5(o.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:O5(o.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(Pe(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(t){const{data:r,error:s}=await this._challenge({factorId:t.factorId});return s?this._returnResult({data:null,error:s}):await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:s}=await this.getUser();if(s)return{data:null,error:s};const n={all:[],phone:[],totp:[],webauthn:[]};for(const a of(t=r==null?void 0:r.factors)!==null&&t!==void 0?t:[])n.all.push(a),a.status==="verified"&&n[a.factor_type].push(a);return{data:n,error:null}}async _getAuthenticatorAssuranceLevel(){var t,r;const{data:{session:s},error:n}=await this.getSession();if(n)return this._returnResult({data:null,error:n});if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=wf(s.access_token);let i=null;a.aal&&(i=a.aal);let o=i;((r=(t=s.user.factors)===null||t===void 0?void 0:t.filter(d=>d.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(o="aal2");const u=a.amr||[];return{data:{currentLevel:i,nextLevel:o,currentAuthenticationMethods:u},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async r=>{const{data:{session:s},error:n}=r;return n?this._returnResult({data:null,error:n}):s?await Ie(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:s.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new Jr})})}catch(r){if(Pe(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(t,r){try{return await this._useSession(async s=>{const{data:{session:n},error:a}=s;if(a)return this._returnResult({data:null,error:a});if(!n)return this._returnResult({data:null,error:new Jr});const i=await Ie(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:n.access_token,body:{action:"approve"},xform:o=>({data:o,error:null})});return i.data&&i.data.redirect_url&&ar()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(i.data.redirect_url),i})}catch(s){if(Pe(s))return this._returnResult({data:null,error:s});throw s}}async _denyAuthorization(t,r){try{return await this._useSession(async s=>{const{data:{session:n},error:a}=s;if(a)return this._returnResult({data:null,error:a});if(!n)return this._returnResult({data:null,error:new Jr});const i=await Ie(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:n.access_token,body:{action:"deny"},xform:o=>({data:o,error:null})});return i.data&&i.data.redirect_url&&ar()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(i.data.redirect_url),i})}catch(s){if(Pe(s))return this._returnResult({data:null,error:s});throw s}}async _listOAuthGrants(){try{return await this._useSession(async t=>{const{data:{session:r},error:s}=t;return s?this._returnResult({data:null,error:s}):r?await Ie(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:n=>({data:n,error:null})}):this._returnResult({data:null,error:new Jr})})}catch(t){if(Pe(t))return this._returnResult({data:null,error:t});throw t}}async _revokeOAuthGrant(t){try{return await this._useSession(async r=>{const{data:{session:s},error:n}=r;return n?this._returnResult({data:null,error:n}):s?await Ie(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:s.access_token,query:{client_id:t.clientId},xform:()=>({data:{},error:null})}):this._returnResult({data:null,error:new Jr})})}catch(r){if(Pe(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(t,r={keys:[]}){let s=r.keys.find(o=>o.kid===t);if(s)return s;const n=Date.now();if(s=this.jwks.keys.find(o=>o.kid===t),s&&this.jwks_cached_at+WP>n)return s;const{data:a,error:i}=await Ie(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;return!a.keys||a.keys.length===0||(this.jwks=a,this.jwks_cached_at=n,s=a.keys.find(o=>o.kid===t),!s)?null:s}async getClaims(t,r={}){try{let s=t;if(!s){const{data:m,error:p}=await this.getSession();if(p||!m.session)return this._returnResult({data:null,error:p});s=m.session.access_token}const{header:n,payload:a,signature:i,raw:{header:o,payload:c}}=wf(s);r!=null&&r.allowExpired||f5(a.exp);const u=!n.alg||n.alg.startsWith("HS")||!n.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(n.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!u){const{error:m}=await this.getUser(s);if(m)throw m;return{data:{claims:a,header:n,signature:i},error:null}}const d=h5(n.alg),f=await crypto.subtle.importKey("jwk",u,d,!0,["verify"]);if(!await crypto.subtle.verify(d,f,i,ZP(`${o}.${c}`)))throw new pp("Invalid JWT signature");return{data:{claims:a,header:n,signature:i},error:null}}catch(s){if(Pe(s))return this._returnResult({data:null,error:s});throw s}}}ec.nextInstanceID={};const H5=ec;class q5 extends H5{constructor(t){super(t)}}class G5{constructor(t,r,s){var n,a,i;this.supabaseUrl=t,this.supabaseKey=r;const o=BP(t);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",o),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",o),this.storageUrl=new URL("storage/v1",o),this.functionsUrl=new URL("functions/v1",o);const c=`sb-${o.hostname.split(".")[0]}-auth-token`,u={db:FP,realtime:RP,auth:Object.assign(Object.assign({},PP),{storageKey:c}),global:AP},d=MP(s??{},u);this.storageKey=(n=d.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(a=d.global.headers)!==null&&a!==void 0?a:{},d.accessToken?(this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(f,h)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(h)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((i=d.auth)!==null&&i!==void 0?i:{},this.headers,d.global.fetch),this.fetch=DP(r,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.accessToken&&this.accessToken().then(f=>this.realtime.setAuth(f)).catch(f=>console.warn("Failed to set initial Realtime auth token:",f)),this.rest=new UF(new URL("rest/v1",o).href,{headers:this.headers,schema:d.db.schema,fetch:this.fetch}),this.storage=new NP(this.storageUrl.href,this.headers,this.fetch,s==null?void 0:s.storage),d.accessToken||this._listenForAuthEvents()}get functions(){return new LF(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},s={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,r,s)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var t,r;if(this.accessToken)return await this.accessToken();const{data:s}=await this.auth.getSession();return(r=(t=s.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:s,storage:n,userStorage:a,storageKey:i,flowType:o,lock:c,debug:u,throwOnError:d},f,h){const m={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new q5({url:this.authUrl.href,headers:Object.assign(Object.assign({},m),f),storageKey:i,autoRefreshToken:t,persistSession:r,detectSessionInUrl:s,storage:n,userStorage:a,flowType:o,lock:c,debug:u,throwOnError:d,fetch:h,hasCustomAuthorizationHeader:Object.keys(this.headers).some(p=>p.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new sP(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,s)=>{this._handleTokenChanged(r,"CLIENT",s==null?void 0:s.access_token)})}_handleTokenChanged(t,r,s){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==s?(this.changedAccessToken=s,this.realtime.setAuth(s)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const K5=(e,t,r)=>new G5(e,t,r);function X5(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}X5()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Y5="https://cbankidsdfsvsgfygbzt.supabase.co",J5="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNiYW5raWRzZGZzdnNnZnlnYnp0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMzMTk3NDgsImV4cCI6MjA3ODg5NTc0OH0.SXgc-9ZamplKeJm5_nl8J2-UzO7A0f8KbAnPZEmsiSo",pe=K5(Y5,J5,{auth:{persistSession:!0,autoRefreshToken:!0}}),Ak=F.createContext(void 0);function Q5({children:e}){const[t,r]=F.useState(null),[s,n]=F.useState([]),[a,i]=F.useState(!0);F.useEffect(()=>{o()},[]);const o=async()=>{i(!0);const{data:{user:f}}=await pe.auth.getUser();if(!f){i(!1);return}const{data:h}=await pe.from("organisation_members").select("organisation_id, organisations(*)").eq("user_id",f.id);if(h){const m=h.map(x=>x.organisations).filter(Boolean);n(m);const p=localStorage.getItem("passivefire_current_organisation_id");if(p){const x=m.find(v=>v.id===p);x?r(x):m.length>0&&(r(m[0]),localStorage.setItem("passivefire_current_organisation_id",m[0].id))}else m.length>0&&(r(m[0]),localStorage.setItem("passivefire_current_organisation_id",m[0].id))}i(!1)},c=async()=>{await o()},u=f=>{r(f),f?localStorage.setItem("passivefire_current_organisation_id",f.id):localStorage.removeItem("passivefire_current_organisation_id")},d=f=>!0;return l.jsx(Ak.Provider,{value:{currentOrganisation:t,organisations:s,loading:a,setCurrentOrganisation:u,refreshOrganisations:c,hasPermission:d},children:e})}function jo(){const e=F.useContext(Ak);if(e===void 0)throw new Error("useOrganisation must be used within an OrganisationProvider");return e}const Z5=[{id:"dashboard",label:"Project Dashboard",icon:Zh},{id:"quotes",label:"Import Quotes",icon:Dr},{id:"review",label:"Review & Clean",icon:uF},{id:"quoteintel",label:"Quote Intelligence",icon:kc},{id:"scope",label:"Scope Matrix",icon:yF},{id:"reports",label:"Reports",icon:aF},{id:"contract",label:"Contract Manager",icon:vS},{id:"library",label:"sidebar.library",icon:bF},{id:"settings",label:"Settings",icon:yd,requiresManagePermission:!0}];function eR({activeTab:e,onTabChange:t}){const[r,s]=F.useState(!1),{hasPermission:n}=jo();return l.jsxs("div",{className:`${r?"w-20":"w-64"} bg-white border-r border-gray-200 flex flex-col transition-all duration-200 relative`,children:[l.jsx("div",{className:"p-6 border-b border-gray-200",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-10 h-10 bg-brand-primary rounded-lg flex items-center justify-center flex-shrink-0",children:l.jsx(xF,{className:"w-6 h-6 text-white"})}),!r&&l.jsxs("div",{children:[l.jsx("h1",{className:"text-base font-bold brand-navy leading-tight",children:"PassiveFire"}),l.jsx("p",{className:"text-xs text-gray-600",children:"Verify+"})]})]})}),l.jsx("nav",{className:"flex-1 p-4 space-y-1",children:Z5.map(a=>{if(a.requiresManagePermission&&!n("manage"))return null;const i=a.icon,o=e===a.id;return l.jsxs("button",{onClick:()=>t(a.id),className:`
                w-full flex items-center gap-3 px-4 py-3 rounded-lg text-sm font-medium transition-all
                ${o?"bg-orange-50 brand-primary border-l-3 border-brand-primary":"text-gray-700 hover:bg-gray-50"}
                ${r?"justify-center":""}
              `,title:r?a.label:void 0,children:[l.jsx(i,{size:20,className:"flex-shrink-0"}),!r&&l.jsx("span",{children:a.label})]},a.id)})}),l.jsx("button",{onClick:()=>s(!r),className:"absolute -right-3 top-20 w-6 h-6 bg-white border border-gray-200 rounded-full flex items-center justify-center hover:bg-gray-50 transition-colors shadow-sm",children:r?l.jsx(n0,{size:14}):l.jsx(nx,{size:14})})]})}function tR({currentProjectId:e,currentProjectName:t,onProjectChange:r,onBackToDashboard:s,notificationCount:n=0,onNavigateToAccount:a,onSwitchOrganisation:i}){const[o,c]=F.useState([]),[u,d]=F.useState(!1),[f,h]=F.useState(!1),[m,p]=F.useState(""),{currentOrganisation:x}=jo();F.useEffect(()=>{v(),y()},[x]);const v=async()=>{if(!x)return;const{data:g}=await pe.from("projects").select("id, name, client, reference").eq("organisation_id",x.id).order("updated_at",{ascending:!1});g&&c(g)},y=async()=>{const{data:g}=await pe.auth.getUser();g.user&&p(g.user.email||"")},w=async()=>{await pe.auth.signOut(),window.location.href="/"};return l.jsx("header",{className:"bg-white border-b border-gray-200 px-6 py-4",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"PassiveFire Verify+"}),x&&l.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[l.jsx(Xl,{size:16}),l.jsx("span",{children:x.name})]}),e&&l.jsxs("div",{className:"relative",children:[l.jsxs("button",{onClick:()=>d(!u),className:"flex items-center gap-2 px-3 py-2 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:[l.jsx("span",{className:"font-medium",children:t||"Select Project"}),l.jsx(ho,{size:16})]}),u&&l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>d(!1)}),l.jsx("div",{className:"absolute top-full left-0 mt-2 w-64 bg-white rounded-lg shadow-lg border border-gray-200 z-20 max-h-96 overflow-y-auto",children:l.jsxs("div",{className:"p-2",children:[l.jsx("button",{onClick:()=>{s(),d(!1)},className:"w-full text-left px-3 py-2 hover:bg-gray-100 rounded-lg text-sm font-medium text-blue-600",children:"All Projects"}),l.jsx("div",{className:"border-t border-gray-200 my-2"}),o.map(g=>l.jsxs("button",{onClick:()=>{r(g.id),d(!1)},className:`w-full text-left px-3 py-2 hover:bg-gray-100 rounded-lg text-sm ${g.id===e?"bg-blue-50 text-blue-600":""}`,children:[l.jsx("div",{className:"font-medium",children:g.name}),g.client&&l.jsx("div",{className:"text-xs text-gray-500",children:g.client})]},g.id))]})})]})]})]}),l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsxs("button",{className:"relative p-2 hover:bg-gray-100 rounded-lg transition-colors",children:[l.jsx(iF,{size:20}),n>0&&l.jsx("span",{className:"absolute top-1 right-1 w-4 h-4 bg-red-500 text-white text-xs rounded-full flex items-center justify-center",children:n})]}),l.jsxs("div",{className:"relative",children:[l.jsxs("button",{onClick:()=>h(!f),className:"flex items-center gap-2 p-2 hover:bg-gray-100 rounded-lg transition-colors",children:[l.jsx(lx,{size:20}),l.jsx(ho,{size:16})]}),f&&l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>h(!1)}),l.jsxs("div",{className:"absolute top-full right-0 mt-2 w-64 bg-white rounded-lg shadow-lg border border-gray-200 z-20",children:[l.jsxs("div",{className:"p-4 border-b border-gray-200",children:[l.jsx("div",{className:"text-sm font-medium text-gray-900",children:m}),x&&l.jsx("div",{className:"text-xs text-gray-500 mt-1",children:x.name})]}),l.jsxs("div",{className:"p-2",children:[l.jsx("button",{onClick:()=>{a(),h(!1)},className:"w-full text-left px-3 py-2 hover:bg-gray-100 rounded-lg text-sm",children:"Account Settings"}),l.jsx("button",{onClick:()=>{i(),h(!1)},className:"w-full text-left px-3 py-2 hover:bg-gray-100 rounded-lg text-sm",children:"Switch Organisation"}),l.jsx("div",{className:"border-t border-gray-200 my-2"}),l.jsx("button",{onClick:w,className:"w-full text-left px-3 py-2 hover:bg-gray-100 rounded-lg text-sm text-red-600",children:"Sign Out"})]})]})]})]})]})]})})}function l0({title:e,subtitle:t,metadata:r}){return l.jsxs("div",{className:"flex items-start justify-between mb-6",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-1",children:e}),l.jsx("p",{className:"text-sm text-gray-600",children:t})]}),r&&r.length>0&&l.jsx("div",{className:"flex items-center gap-2",children:r.map((s,n)=>l.jsxs("div",{className:"px-3 py-1.5 rounded-full bg-gray-100 border border-gray-200 text-xs",children:[l.jsxs("span",{className:"text-gray-600",children:[s.label,":"]})," ",l.jsx("span",{className:"font-medium text-gray-900",children:s.value})]},n))})]})}function pn({projectId:e,projectName:t,allProjects:r,onProjectSelect:s,onCreateProject:n,onNavigateToQuotes:a}){const[i,o]=F.useState(!1),[c,u]=F.useState(""),[d,f]=F.useState(""),[h,m]=F.useState(""),[p,x]=F.useState(!1),v=()=>{o(!0)},y=()=>{o(!1),u(""),f(""),m("")},w=async g=>{if(g.preventDefault(),!c.trim())return;x(!0);const _=await n(c,d,h);x(!1),_&&y()};return l.jsxs("div",{className:"p-8",children:[l.jsx(l0,{title:e?t||"Project Dashboard":"All Projects",description:e?"Manage your quote analysis workflow":"Select or create a project"}),e?l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mt-6",children:l.jsxs("button",{onClick:a,className:"p-6 bg-white border border-gray-200 rounded-lg hover:shadow-lg transition-shadow",children:[l.jsx("div",{className:"text-2xl font-bold text-blue-600 mb-2",children:"Import Quotes"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Upload and parse supplier quotes"})]})}):l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mt-6",children:[l.jsxs("button",{onClick:v,className:"p-6 border-2 border-dashed border-gray-300 rounded-lg hover:border-blue-500 hover:bg-blue-50 transition-colors",children:[l.jsx($u,{className:"mx-auto mb-2 text-gray-400",size:32}),l.jsx("div",{className:"font-medium",children:"Create New Project"})]}),r.map(g=>l.jsxs("button",{onClick:()=>s(g.id),className:"p-6 border border-gray-200 rounded-lg hover:border-blue-500 hover:shadow-md transition-all text-left",children:[l.jsx(_S,{className:"mb-2 text-blue-600",size:24}),l.jsx("div",{className:"font-semibold text-gray-900 mb-1",children:g.name}),l.jsx("div",{className:"text-sm text-gray-500",children:g.client_reference})]},g.id))]}),i&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 w-full max-w-md",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Create New Project"}),l.jsx("button",{onClick:y,className:"text-gray-400 hover:text-gray-600 transition-colors",children:l.jsx(cn,{size:24})})]}),l.jsxs("form",{onSubmit:w,children:[l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsxs("label",{htmlFor:"projectName",className:"block text-sm font-medium text-gray-700 mb-1",children:["Project Name ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("input",{id:"projectName",type:"text",value:c,onChange:g=>u(g.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter project name",required:!0,autoFocus:!0})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"projectClient",className:"block text-sm font-medium text-gray-700 mb-1",children:"Client Name"}),l.jsx("input",{id:"projectClient",type:"text",value:d,onChange:g=>f(g.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter client name"})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"projectReference",className:"block text-sm font-medium text-gray-700 mb-1",children:"Project Reference"}),l.jsx("input",{id:"projectReference",type:"text",value:h,onChange:g=>m(g.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter project reference"})]})]}),l.jsxs("div",{className:"flex gap-3 mt-6",children:[l.jsx("button",{type:"button",onClick:y,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",disabled:p,children:"Cancel"}),l.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed",disabled:p||!c.trim(),children:p?"Creating...":"Create Project"})]})]})]})})]})]})}async function rR(e){return console.log("PDF Parser not fully implemented",e.name),{pages:[],text:"",metadata:{}}}async function sR(e){return console.log("Excel Parser not fully implemented",e.name),{sheets:[],data:[]}}async function nR(e){return console.log("CSV Parser not fully implemented",e.name),{data:[]}}function aR({value:e,onChange:t,error:r}){return l.jsxs("div",{className:"w-full",children:[l.jsx("input",{type:"text",value:e,onChange:s=>t(s.target.value),placeholder:"Supplier name...",className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 ${r?"border-red-500":"border-gray-300"}`}),r&&l.jsx("p",{className:"text-sm text-red-500 mt-1",children:r})]})}const iR=[{name:"Electrical Services",enabled:!0,count:0},{name:"Fire Protection Services",enabled:!0,count:0},{name:"Hydraulics Services",enabled:!0,count:0},{name:"Mechanical Services",enabled:!0,count:0},{name:"Structural Penetrations",enabled:!0,count:0},{name:"Passive Fire (General)",enabled:!0,count:0},{name:"Optional Extras",enabled:!1,count:0},{name:"Excluded",enabled:!1,count:0},{name:"Summary Blocks",enabled:!1,count:0},{name:"Admin / Notes / T&Cs",enabled:!1,count:0}];function oR({projectId:e,lines:t,summaryBlocks:r,supplierName:s,onSupplierNameChange:n,onLineUpdate:a,onSave:i,onCancel:o,isSaving:c=!1,demoMode:u=!1}){console.log("[ImportPreviewNew] Rendering with",t.length,"lines"),console.log("[ImportPreviewNew] Supplier name:",s);const[d,f]=F.useState(()=>{const q=new Set(t.map(re=>re.section));return console.log("[ImportPreviewNew] All unique sections in lines:",Array.from(q)),console.log("[ImportPreviewNew] Lines sample:",t.slice(0,5).map(re=>({section:re.section,desc:re.description.substring(0,50)}))),iR.map(re=>{const X=t.filter(M=>M.section===re.name).length;return console.log(`[ImportPreviewNew] Section "${re.name}": ${X} items`),{...re,count:X}})}),[h,m]=F.useState(!1),[p,x]=F.useState(null),[v,y]=F.useState({}),[w,g]=F.useState(!0),_=F.useMemo(()=>{let q=t.filter(re=>{const X=d.find(M=>M.name===re.section);return(X==null?void 0:X.enabled)??!1});return h&&(q=q.filter(re=>re.flags.length>0)),q.sort((re,X)=>re.flags.length>0&&X.flags.length===0?-1:re.flags.length===0&&X.flags.length>0?1:0)},[t,d,h]),b=F.useMemo(()=>{const q=t.filter(J=>J.flags.length===0).length,re=t.filter(J=>J.flags.length>0).length,X=t.filter(J=>!J.unit||!J.size||!J.qty).length,M=_.reduce((J,G)=>J+(G.total||0),0);return{detectedLines:q,flaggedLines:re,gapLines:X,selectedCount:_.length,selectedSum:M}},[t,_]),k=q=>{f(re=>re.map(X=>X.name===q?{...X,enabled:!X.enabled}:X))},S=()=>{f(q=>q.map(re=>({...re,enabled:!0})))},T=()=>{f(q=>q.map(re=>({...re,enabled:!1})))},j=q=>{x(q.id),y({...q})},U=()=>{p&&v&&(a(p,v),x(null),y({}))},H=()=>{x(null),y({})},z=()=>{i(_)};return l.jsxs("div",{className:"flex gap-6 h-[calc(100vh-12rem)]",children:[l.jsxs("div",{className:"w-64 flex-shrink-0 bg-white rounded-lg shadow-sm border border-gray-200 p-4 overflow-y-auto",children:[l.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-4",children:"Include in schedule"}),l.jsx("div",{className:"space-y-2",children:d.map(q=>l.jsxs("label",{className:"flex items-center justify-between p-2 hover:bg-gray-50 rounded cursor-pointer group",children:[l.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[l.jsx("input",{type:"checkbox",checked:q.enabled,onChange:()=>k(q.name),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500 flex-shrink-0"}),l.jsx("span",{className:"text-xs text-gray-700 truncate",title:q.name,children:q.name})]}),l.jsx("span",{className:"text-xs font-medium text-gray-500 ml-2 flex-shrink-0",children:q.count})]},q.name))})]}),l.jsxs("div",{className:"flex-1 flex flex-col min-w-0 gap-4",children:[l.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:[l.jsx("div",{className:"flex items-center justify-between mb-4",children:l.jsx("div",{className:"flex-1 max-w-md",children:l.jsx(aR,{projectId:e,value:s,onChange:n,error:!s.trim()&&_.length>0?"Supplier name is required":void 0})})}),l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-green-50 border border-green-200 rounded-md",children:[l.jsx(Vs,{size:16,className:"text-green-600"}),l.jsxs("span",{className:"text-sm font-medium text-green-900",children:[b.detectedLines," Detected"]})]}),l.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-amber-50 border border-amber-200 rounded-md",children:[l.jsx(vt,{size:16,className:"text-amber-600"}),l.jsxs("span",{className:"text-sm font-medium text-amber-900",children:[b.flaggedLines," Flagged"]})]}),l.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-blue-50 border border-blue-200 rounded-md",children:[l.jsx(wS,{size:16,className:"text-blue-600"}),l.jsxs("span",{className:"text-sm font-medium text-blue-900",children:[b.gapLines," Gaps"]})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{onClick:S,className:"px-3 py-1.5 text-xs font-medium text-blue-600 hover:bg-blue-50 rounded-md transition-colors",children:"Select All"}),l.jsx("button",{onClick:T,className:"px-3 py-1.5 text-xs font-medium text-gray-600 hover:bg-gray-50 rounded-md transition-colors",children:"Select None"}),l.jsx("button",{onClick:()=>m(!h),className:`px-3 py-1.5 text-xs font-medium rounded-md transition-colors ${h?"bg-amber-100 text-amber-900":"text-gray-600 hover:bg-gray-50"}`,children:"Show Flagged Only"})]})]})]}),l.jsx("div",{className:"flex-1 bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden flex flex-col",children:l.jsx("div",{className:"flex-1 overflow-auto",children:l.jsxs("table",{className:"w-full",children:[l.jsx("thead",{className:"bg-gray-50 border-b border-gray-200 sticky top-0",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Section"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Description"}),l.jsx("th",{className:"px-3 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Qty"}),l.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Unit"}),l.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Rate"}),l.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Total"}),l.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Flags"}),l.jsx("th",{className:"px-3 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),l.jsx("tbody",{className:"divide-y divide-gray-200",children:_.map(q=>l.jsx("tr",{className:`${q.flags.length>0?"bg-amber-50":""} ${p===q.id?"bg-blue-50":""}`,children:p===q.id?l.jsxs(l.Fragment,{children:[l.jsx("td",{className:"px-3 py-2",children:l.jsx("input",{type:"text",value:v.section||"",onChange:re=>y({...v,section:re.target.value}),className:"w-full px-2 py-1 border border-gray-300 rounded text-xs"})}),l.jsx("td",{className:"px-4 py-2",children:l.jsx("input",{type:"text",value:v.description||"",onChange:re=>y({...v,description:re.target.value}),className:"w-full px-2 py-1 border border-gray-300 rounded text-xs"})}),l.jsx("td",{className:"px-3 py-2",children:l.jsx("input",{type:"number",value:v.qty||"",onChange:re=>y({...v,qty:parseFloat(re.target.value)||void 0}),className:"w-16 px-2 py-1 border border-gray-300 rounded text-xs text-right"})}),l.jsx("td",{className:"px-3 py-2",children:l.jsx("input",{type:"text",value:v.unit||"",onChange:re=>y({...v,unit:re.target.value}),className:"w-16 px-2 py-1 border border-gray-300 rounded text-xs"})}),l.jsx("td",{className:"px-4 py-2",children:l.jsx("input",{type:"number",value:v.rate||"",onChange:re=>y({...v,rate:parseFloat(re.target.value)||void 0}),className:"w-20 px-2 py-1 border border-gray-300 rounded text-xs text-right"})}),l.jsx("td",{className:"px-4 py-2",children:l.jsx("input",{type:"number",value:v.total||"",onChange:re=>y({...v,total:parseFloat(re.target.value)||void 0}),className:"w-20 px-2 py-1 border border-gray-300 rounded text-xs text-right"})}),l.jsx("td",{className:"px-3 py-2"}),l.jsx("td",{className:"px-3 py-2",children:l.jsxs("div",{className:"flex items-center justify-center gap-1",children:[l.jsx("button",{onClick:U,className:"p-1 text-green-600 hover:bg-green-50 rounded",title:"Save",children:l.jsx(ep,{size:14})}),l.jsx("button",{onClick:H,className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"Cancel",children:l.jsx(cn,{size:14})})]})})]}):l.jsxs(l.Fragment,{children:[l.jsx("td",{className:"px-3 py-2 text-xs text-gray-600",children:q.section}),l.jsx("td",{className:"px-4 py-2 text-xs text-gray-900",children:q.description}),l.jsx("td",{className:"px-3 py-2 text-xs text-gray-900 text-right",children:q.qty||"-"}),l.jsx("td",{className:"px-3 py-2 text-xs text-gray-600",children:q.unit||"-"}),l.jsx("td",{className:"px-4 py-2 text-xs text-gray-900 text-right",children:q.rate?`$${q.rate.toFixed(2)}`:"-"}),l.jsx("td",{className:"px-4 py-2 text-xs text-gray-900 text-right font-medium",children:q.total?`$${q.total.toFixed(2)}`:"-"}),l.jsx("td",{className:"px-3 py-2",children:l.jsx("div",{className:"flex flex-wrap gap-1",children:q.flags.map((re,X)=>l.jsx("span",{className:"px-1.5 py-0.5 text-[10px] font-medium bg-amber-100 text-amber-800 rounded",children:re},X))})}),l.jsx("td",{className:"px-3 py-2",children:l.jsx("button",{onClick:()=>j(q),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",title:"Edit",children:l.jsx(SS,{size:14})})})]})},q.id))})]})})}),l.jsxs("div",{className:"flex items-center justify-between bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:[l.jsxs("div",{className:"flex items-center gap-6",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-xs text-gray-500",children:"Selected Lines"}),l.jsx("p",{className:"text-lg font-bold text-gray-900",children:b.selectedCount})]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-xs text-gray-500",children:"Selected Sum"}),l.jsxs("p",{className:"text-lg font-bold text-green-600",children:["$",b.selectedSum.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("button",{onClick:o,className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 transition-colors",children:"Cancel"}),l.jsxs("button",{onClick:z,disabled:!s.trim()||_.length===0||c||u,className:"flex items-center gap-2 px-8 py-3 bg-gradient-to-r from-green-600 to-green-500 text-white text-lg font-bold rounded-lg hover:from-green-700 hover:to-green-600 shadow-lg hover:shadow-xl transition-all disabled:bg-gray-400 disabled:cursor-not-allowed transform hover:scale-105",children:[l.jsx(yS,{size:20}),c?"Saving...":u?"Demo Mode":"Proceed with Mapping"]})]})]})]}),r.length>0&&l.jsxs("div",{className:"w-64 flex-shrink-0 bg-white rounded-lg shadow-sm border border-gray-200 p-4 overflow-y-auto",children:[l.jsxs("button",{onClick:()=>g(!w),className:"flex items-center justify-between w-full mb-3",children:[l.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Quote Summary"}),w?l.jsx(ho,{size:16}):l.jsx(n0,{size:16})]}),w&&l.jsx("div",{className:"space-y-2",children:r.map((q,re)=>l.jsxs("div",{className:`flex justify-between items-center py-2 px-3 rounded ${q.type==="grand_total"?"bg-blue-50 border border-blue-200":"bg-gray-50"}`,children:[l.jsx("span",{className:`text-xs ${q.type==="grand_total"?"font-semibold text-gray-900":"text-gray-600"}`,children:q.label}),l.jsxs("span",{className:`text-xs font-medium ${q.type==="grand_total"?"text-blue-900":"text-gray-900"}`,children:["$",q.value.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]},re))})]})]})}function lR({projectId:e,onJobCompleted:t}){const[r,s]=F.useState([]),[n,a]=F.useState(!0),[i,o]=F.useState(new Set);F.useEffect(()=>{c();const p=pe.channel("parsing_jobs_changes").on("postgres_changes",{event:"*",schema:"public",table:"parsing_jobs",filter:`project_id=eq.${e}`},v=>{if(v.eventType==="INSERT")s(y=>[v.new,...y]);else if(v.eventType==="UPDATE"){const y=v.new;s(w=>w.map(g=>g.id===y.id?y:g)),y.status==="completed"&&y.quote_id&&(t==null||t(y.id,y.quote_id))}else v.eventType==="DELETE"&&s(y=>y.filter(w=>w.id!==v.old.id))}).subscribe(),x=setInterval(()=>{r.some(y=>y.status==="pending"||y.status==="processing")&&c()},3e3);return()=>{p.unsubscribe(),clearInterval(x)}},[e,r]);const c=async()=>{try{const{data:p,error:x}=await pe.from("parsing_jobs").select("*").eq("project_id",e).order("created_at",{ascending:!1}).limit(10);!x&&p&&s(p)}catch(p){console.error("Error loading parsing jobs:",p)}finally{a(!1)}},u=p=>{if(p.status!=="processing")return!1;const x=new Date(p.updated_at);return(new Date().getTime()-x.getTime())/1e3/60>3},d=async p=>{o(x=>new Set(x).add(p));try{const y=await fetch("https://cbankidsdfsvsgfygbzt.supabase.co/functions/v1/resume_parsing_job",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNiYW5raWRzZGZzdnNnZnlnYnp0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMzMTk3NDgsImV4cCI6MjA3ODg5NTc0OH0.SXgc-9ZamplKeJm5_nl8J2-UzO7A0f8KbAnPZEmsiSo"},body:JSON.stringify({jobId:p})}),w=await y.json();if(!y.ok)throw new Error(w.error||"Failed to resume job");w.success&&w.quoteId?(t==null||t(p,w.quoteId),alert(w.message||`Successfully recovered ${w.recoveredItems} items`)):alert(w.message||"Job was too incomplete to recover"),await c()}catch(x){console.error("Error resuming job:",x),alert(`Failed to resume job: ${x instanceof Error?x.message:"Unknown error"}`)}finally{o(x=>{const v=new Set(x);return v.delete(p),v})}},f=p=>{switch(p){case"pending":return l.jsx(ax,{className:"w-5 h-5 text-gray-400"});case"processing":return l.jsx(wn,{className:"w-5 h-5 text-blue-500 animate-spin"});case"completed":return l.jsx(Vs,{className:"w-5 h-5 text-green-500"});case"failed":return l.jsx(cx,{className:"w-5 h-5 text-red-500"});default:return null}},h=p=>{switch(p){case"pending":return"Waiting to start";case"processing":return"Processing";case"completed":return"Completed";case"failed":return"Failed";default:return p}},m=p=>{switch(p){case"pending":return"bg-gray-100 text-gray-700";case"processing":return"bg-blue-100 text-blue-700";case"completed":return"bg-green-100 text-green-700";case"failed":return"bg-red-100 text-red-700";default:return"bg-gray-100 text-gray-700"}};return n?l.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:l.jsxs("div",{className:"flex items-center justify-center",children:[l.jsx(wn,{className:"w-5 h-5 text-gray-400 animate-spin"}),l.jsx("span",{className:"ml-2 text-sm text-gray-600",children:"Loading jobs..."})]})}):r.length===0?null:l.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4 mb-4",children:[l.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Background Parsing Jobs"}),l.jsx("div",{className:"space-y-2",children:r.map(p=>l.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[l.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[f(p.status),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:p.supplier_name}),l.jsx("span",{className:`px-2 py-0.5 text-xs font-medium rounded-full ${m(p.status)}`,children:h(p.status)})]}),l.jsx("p",{className:"text-xs text-gray-500 truncate",children:p.file_name}),p.error_message&&l.jsx("p",{className:`text-xs mt-1 ${p.status==="completed"?"text-orange-600":"text-red-600"}`,children:p.error_message})]})]}),(p.status==="processing"||p.status==="pending")&&l.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[l.jsx("div",{className:"w-32 bg-gray-200 rounded-full h-2",children:l.jsx("div",{className:"bg-blue-500 h-2 rounded-full transition-all duration-300",style:{width:`${p.progress}%`}})}),l.jsxs("span",{className:"text-xs text-gray-600 w-10 text-right",children:[p.progress,"%"]}),u(p)&&l.jsxs("button",{onClick:()=>d(p.id),disabled:i.has(p.id),className:"flex items-center gap-1 px-2 py-1 text-xs font-medium text-orange-700 bg-orange-100 hover:bg-orange-200 rounded disabled:opacity-50 disabled:cursor-not-allowed",title:"This job appears stuck. Click to recover and complete with partial data.",children:[i.has(p.id)?l.jsx(wn,{className:"w-3 h-3 animate-spin"}):l.jsx(is,{className:"w-3 h-3"}),l.jsx("span",{children:"Resume"})]})]}),p.status==="completed"&&p.parsed_lines&&l.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[l.jsxs("span",{className:"text-xs text-gray-600",children:[p.parsed_lines.length," items"]}),p.error_message&&p.error_message.includes("chunks failed")&&l.jsxs("button",{onClick:()=>d(p.id),disabled:i.has(p.id),className:"flex items-center gap-1 px-2 py-1 text-xs font-medium text-orange-700 bg-orange-100 hover:bg-orange-200 rounded disabled:opacity-50 disabled:cursor-not-allowed",title:"Some chunks failed. Click to retry and potentially recover more items.",children:[i.has(p.id)?l.jsx(wn,{className:"w-3 h-3 animate-spin"}):l.jsx(is,{className:"w-3 h-3"}),l.jsx("span",{children:"Retry Failed"})]})]})]},p.id))})]})}function cR(e){return console.log("Quote Adapter not fully implemented"),e}function uR({projectId:e,onQuotesImported:t,onNavigateToDashboard:r}){const[s,n]=F.useState([]),[a,i]=F.useState(!1),[o,c]=F.useState(!0),[u,d]=F.useState([]),[f,h]=F.useState([]),[m,p]=F.useState([]),[x,v]=F.useState(""),[y,w]=F.useState(!1),[g,_]=F.useState(null),[b,k]=F.useState(!1),[S,T]=F.useState(null),[j,U]=F.useState(0),[H,z]=F.useState(!0),[q,re]=F.useState(null),X=F.useRef(null);F.useEffect(()=>{e?M():z(!1)},[e]);const M=async()=>{if(e){z(!0);try{const{data:se}=await pe.from("projects").select("id, name, client, updated_at").eq("id",e).maybeSingle();if(se){T(se);const{data:ne,error:V}=await pe.from("quotes").select("supplier_name").eq("project_id",e);if(!V&&ne){const C=new Set(ne.map(he=>he.supplier_name));U(C.size)}}}catch(se){console.error("Error loading project info:",se)}finally{z(!1)}}},J=[".pdf",".xlsx",".xls",".csv","application/pdf","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","text/csv"],G=se=>{se.preventDefault(),k(!0)},D=()=>{k(!1)},K=async se=>{se.preventDefault(),k(!1);const ne=Array.from(se.dataTransfer.files);await N(ne)},oe=async se=>{const ne=se.target.files;ne&&ne.length>0&&await N(Array.from(ne))},N=async se=>{const ne=se.filter(C=>{var ve;const he="."+((ve=C.name.split(".").pop())==null?void 0:ve.toLowerCase());return J.includes(he)||J.includes(C.type)});if(ne.length===0){_({type:"error",text:"No valid files selected. Please upload PDF, Excel, or CSV files."});return}n(ne);const V=ne.find(C=>C.name.toLowerCase().endsWith(".pdf"));_(V?{type:"success",text:`PDF file attached: ${V.name}. Enter supplier name and click "Parse Quote" to process with external extractor.`}:{type:"success",text:'File attached. Enter supplier name and click "Parse Quote" to continue.'})},W=async se=>{if(!e||!x.trim()){_({type:"error",text:"Please provide a supplier name."});return}i(!0),_(null);try{const{data:{session:ne}}=await pe.auth.getSession();if(!ne)throw new Error("No active session");for(const V of se){if(V.name.toLowerCase().endsWith(".pdf")){console.log(`PDF detected: ${V.name}, trying external extractor first...`);const de=new FormData;de.append("file",V),de.append("projectId",e),de.append("supplierName",x.trim());const Ee="https://cbankidsdfsvsgfygbzt.supabase.co/functions/v1/parse_quote_with_extractor",Oe={Authorization:`Bearer ${ne.access_token}`};try{const Me=await fetch(Ee,{method:"POST",headers:Oe,body:de}),We=await Me.json();if(Me.ok&&We.success){console.log("Extractor  Import Quotes:",We),_({type:"success",text:`${V.name} successfully parsed using external extractor! Found ${We.itemsCount} items. Redirecting to review...`}),n([]),v(""),await M(),t(),setTimeout(()=>{r&&r()},1500);continue}else if(We.fallback_required)console.log("Extractor failed, falling back to background job...");else throw new Error(We.error||"Extractor failed")}catch(Me){console.error("External extractor error, falling back to background job:",Me),_({type:"info",text:`External extractor unavailable for ${V.name}, using background parser...`})}}const ve=new FormData;ve.append("file",V),ve.append("projectId",e),ve.append("supplierName",x.trim());const ke="https://cbankidsdfsvsgfygbzt.supabase.co/functions/v1/start_parsing_job",Ae={Authorization:`Bearer ${ne.access_token}`},me=await fetch(ke,{method:"POST",headers:Ae,body:ve});if(!me.ok){const de=await me.json();throw new Error(de.error||"Failed to start parsing job")}const Ke=await me.json();_({type:"success",text:`${V.name} is being parsed in the background. You can navigate away and it will continue processing.`})}n([]),v("")}catch(ne){console.error("Background parsing error:",ne),_({type:"error",text:ne.message||"Failed to start background parsing"})}finally{i(!1)}},I=async se=>{var ne;i(!0),_(null),d([]);try{const V=[];for(const C of se){const he=(ne=C.name.split(".").pop())==null?void 0:ne.toLowerCase();let ve=[];try{if(he==="pdf"?(_({type:"info",text:`Parsing PDF: ${C.name}...`}),ve=await rR(C)):he==="xlsx"||he==="xls"?(_({type:"info",text:`Parsing Excel: ${C.name}...`}),ve=await sR(C)):he==="csv"&&(_({type:"info",text:`Parsing CSV: ${C.name}...`}),ve=await nR(C)),ve.length>0){const ke=crypto.randomUUID();ve.forEach(Ae=>{Ae.supplierId=ke,Ae.supplierName=x.trim()}),V.push(...ve)}}catch(ke){console.error(`Error parsing ${C.name}:`,ke),_({type:"error",text:`Failed to parse ${C.name}. The file format may not be supported or the content is unreadable.`})}}if(V.length>0){d(V);const C=cR(V);h(C),p([]),_({type:"success",text:`Successfully parsed ${V.length} line items from ${x}`})}else _({type:"error",text:"No data could be extracted from the files. Please check the file format and content."})}catch(V){console.error("Parsing error:",V),_({type:"error",text:"An error occurred while parsing the files."})}finally{i(!1)}},B=(se,ne)=>{h(V=>V.map(C=>C.id===se?{...C,...ne}:C))},ee=async()=>{if(!e||!x.trim()){_({type:"error",text:"Please provide a supplier name."});return}w(!0),_(null);try{const se=f.filter(ke=>ke.include!==!1);if(se.length===0){_({type:"error",text:"No items selected for import."}),w(!1);return}const{data:{session:ne}}=await pe.auth.getSession();if(!ne)throw new Error("No active session");let V=q;if(!V){const ke=`https://cbankidsdfsvsgfygbzt.supabase.co/functions/v1/upload_quote/projects/${e}/quotes/upload`,Ae={Authorization:`Bearer ${ne.access_token}`},me=new FormData;if(s&&s.length>0)me.append("file",s[0]);else{const Ee=new File([""],"quote.pdf",{type:"application/pdf"});me.append("file",Ee)}me.append("vendorName",x);const Ke=await fetch(ke,{method:"POST",headers:Ae,body:me});if(!Ke.ok){const Ee=await Ke.json();throw new Error(`Failed to create quote: ${Ee.error||Ke.statusText}`)}V=(await Ke.json()).quoteId,re(V)}const C=`https://cbankidsdfsvsgfygbzt.supabase.co/functions/v1/apply_selections/projects/${e}/selections/apply`,he={Authorization:`Bearer ${ne.access_token}`,"Content-Type":"application/json"},ve=await fetch(C,{method:"POST",headers:he,body:JSON.stringify({quoteId:V,items:se.map(ke=>({lineId:ke.id,mapKey:ke.normalised_key||"",description:ke.description,qty:ke.qty||0,unit:ke.unit||"",unitPrice:ke.unit_price||0,total:ke.total||0}))})});if(!ve.ok){const ke=await ve.json();throw new Error(`Failed to apply selections: ${ke.error||ve.statusText}`)}_({type:"success",text:`Successfully saved ${se.length} items!`}),n([]),d([]),h([]),p([]),v(""),re(null),await M(),t(),setTimeout(()=>{r&&r()},1500)}catch(se){console.error("Save error:",se),_({type:"error",text:se instanceof Error?se.message:"Failed to save selections"})}finally{w(!1)}},le=()=>{n([]),d([]),h([]),p([]),v(""),_(null)};if(H)return l.jsx("div",{className:"flex items-center justify-center min-h-96",children:l.jsx("div",{className:"text-gray-600",children:"Loading project information..."})});if(u.length>0)return l.jsxs("div",{className:"p-6 max-w-full",children:[l.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-5 mb-6",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-10 h-10 rounded-full bg-orange-50 flex items-center justify-center",children:l.jsx(Iv,{className:"text-brand-primary",size:20})}),l.jsxs("div",{children:[l.jsx("h2",{className:"text-lg font-bold text-gray-900",children:"Import Preview"}),l.jsx("p",{className:"text-sm text-gray-600",children:x||"No supplier name provided"})]})]}),l.jsx("button",{onClick:le,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",title:"Cancel and start over",children:l.jsx(cn,{size:20})})]})}),g&&l.jsx("div",{className:`p-4 rounded-xl mb-6 ${g.type==="success"?"bg-green-50 border border-green-200":g.type==="error"?"bg-red-50 border border-red-200":"bg-blue-50 border border-blue-200"}`,children:l.jsxs("div",{className:"flex items-start gap-2",children:[l.jsx(vt,{size:18,className:`mt-0.5 flex-shrink-0 ${g.type==="success"?"text-green-600":g.type==="error"?"text-red-600":"text-blue-600"}`}),l.jsx("span",{className:g.type==="success"?"text-green-800":g.type==="error"?"text-red-800":"text-blue-800",children:g.text})]})}),l.jsx(oR,{projectId:e||"",lines:f,summaryBlocks:m,supplierName:x,onSupplierNameChange:v,onLineUpdate:B,onSave:ee,onCancel:le,isSaving:y,demoMode:!1})]});if(!e||!S)return l.jsx("div",{className:"flex items-center justify-center min-h-96",children:l.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-8 text-center max-w-md",children:[l.jsx(vt,{className:"mx-auto mb-4 text-yellow-500",size:48}),l.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:"No Project Selected"}),l.jsx("p",{className:"text-gray-600 mb-6",children:"You need to select or create a project before importing quotes."}),l.jsx("button",{onClick:r,className:"btn-primary inline-flex items-center gap-2",children:"Go to Project Dashboard"})]})});const fe=[{label:"Project",value:S.name},{label:"Suppliers",value:j.toString()},{label:"Last Updated",value:new Date(S.updated_at).toLocaleDateString()}];return l.jsxs("div",{className:"p-6 max-w-full",children:[l.jsx(l0,{title:"Quotes",subtitle:"Import supplier quotes and prepare them for analysis.",metadata:fe}),e&&l.jsx(lR,{projectId:e,onJobCompleted:M}),g&&l.jsx("div",{className:`p-4 rounded-xl mb-6 ${g.type==="success"?"bg-green-50 border border-green-200":g.type==="error"?"bg-red-50 border border-red-200":"bg-blue-50 border border-blue-200"}`,children:l.jsxs("div",{className:"flex items-start gap-2",children:[g.type==="success"?l.jsx(Vs,{size:18,className:"mt-0.5 flex-shrink-0 text-green-600"}):l.jsx(vt,{size:18,className:"mt-0.5 flex-shrink-0 text-blue-600"}),l.jsx("span",{className:g.type==="success"?"text-green-800":g.type==="error"?"text-red-800":"text-blue-800",children:g.text})]})}),l.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 mb-6",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[l.jsx("div",{className:"w-10 h-10 rounded-full bg-orange-50 flex items-center justify-center",children:l.jsx(Jl,{className:"text-brand-primary",size:20})}),l.jsxs("div",{children:[l.jsx("h2",{className:"text-lg font-bold text-gray-900",children:"Import Quotes"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Upload PDF, Excel, or CSV files from suppliers."})]})]}),l.jsxs("div",{className:"mb-6",children:[l.jsx("label",{htmlFor:"supplier-name-input",className:"block text-sm font-medium text-gray-700 mb-2",children:"Supplier Name"}),l.jsx("input",{id:"supplier-name-input",type:"text",value:x,onChange:se=>v(se.target.value),placeholder:"Enter supplier name...",className:"w-full max-w-md px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#0A66C2] focus:border-[#0A66C2] transition"}),l.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"This name will be displayed throughout the analysis instead of the file name"})]}),l.jsx("div",{onDragOver:G,onDragLeave:D,onDrop:K,className:`rounded-xl p-12 text-center transition-all border-2 border-dashed ${b?"border-brand-primary bg-orange-50":s.length>0?"border-green-300 bg-green-50":"border-gray-300 bg-gray-50 hover:border-gray-400"}`,children:s.length>0?l.jsxs("div",{children:[l.jsx(Vs,{className:"mx-auto mb-4 text-green-600",size:48}),l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"File Attached"}),l.jsx("p",{className:"text-sm text-gray-600 mb-4",children:s[0].name}),l.jsxs("div",{className:"flex items-center justify-center gap-3",children:[l.jsx("button",{onClick:()=>{n([]),_(null)},className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors text-sm font-medium",children:"Remove File"}),l.jsxs("button",{onClick:()=>{if(!x.trim()){_({type:"error",text:"Please enter a supplier name first."});return}o?W(s):I(s)},disabled:a||!x.trim(),className:"btn-primary disabled:opacity-50 disabled:cursor-not-allowed inline-flex items-center gap-2",children:[a&&l.jsx(wn,{className:"animate-spin",size:18}),a?"Starting Parse...":"Parse Quote (Background)"]})]})]}):l.jsxs(l.Fragment,{children:[l.jsx(Iv,{className:`mx-auto mb-4 ${b?"text-brand-primary":"text-gray-400"}`,size:48}),l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:b?"Drop file here":"Drag and drop file here"}),l.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"or click to browse"}),l.jsx("input",{ref:X,type:"file",accept:".pdf,.xlsx,.xls,.csv",multiple:!1,onChange:oe,className:"hidden"}),l.jsx("button",{onClick:()=>{var se;return(se=X.current)==null?void 0:se.click()},disabled:a,className:"btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:"Attach File"}),l.jsx("p",{className:"text-xs text-gray-500 mt-4",children:"Supported formats: PDF, Excel (.xlsx, .xls), CSV"})]})})]}),a&&l.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-xl mb-6 p-4",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(wn,{className:"animate-spin text-blue-600 flex-shrink-0",size:20}),l.jsxs("div",{children:[l.jsx("div",{className:"font-medium text-blue-900",children:"Processing Quote..."}),l.jsx("div",{className:"text-sm text-blue-700 mt-0.5",children:"Extracting and analyzing quote data. This may take a minute for complex documents."})]})]})}),l.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[l.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Import Engine Features"}),l.jsxs("ul",{className:"text-sm text-gray-600 space-y-2",children:[l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx(Vs,{size:16,className:"text-green-600 mt-0.5 flex-shrink-0"}),l.jsx("span",{children:"Automatic table detection for most supplier quote formats"})]}),l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx(Vs,{size:16,className:"text-green-600 mt-0.5 flex-shrink-0"}),l.jsx("span",{children:"Fallback text parsing when tables can't be detected"})]}),l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx(Vs,{size:16,className:"text-green-600 mt-0.5 flex-shrink-0"}),l.jsx("span",{children:"Support for multiple files per supplier"})]})]})]})]})}function dR(e){return l.jsx(uR,{...e})}const fR=[{normalized:"ea",displayName:"Each",aliases:[/^ea$/i,/^each$/i,/^nr$/i,/^no\.?$/i,/^number$/i,/^per$/i,/^item$/i,/^unit$/i,/^pce$/i,/^piece$/i]},{normalized:"m",displayName:"Square Meters",aliases:[/^m$/i,/^m2$/i,/^sqm$/i,/^sq\.?\s*m$/i,/^square\s*m(eter)?s?$/i,/^msq$/i]},{normalized:"m",displayName:"Linear Meters",aliases:[/^m$/i,/^lm$/i,/^lin\.?\s*m$/i,/^linear\s*m(eter)?s?$/i,/^metre?s?$/i,/^meter?s?$/i,/^mtrs?$/i,/^per\s*m(etre)?$/i,/^running\s*m(etre)?$/i]},{normalized:"L",displayName:"Liters",aliases:[/^l$/i,/^litre?s?$/i]},{normalized:"m",displayName:"Cubic Meters",aliases:[/^m$/i,/^m3$/i,/^cum$/i,/^cu\.?\s*m$/i,/^cubic\s*m(eter)?s?$/i]},{normalized:"hr",displayName:"Hours",aliases:[/^hr$/i,/^hrs?$/i,/^hour?s?$/i]},{normalized:"kg",displayName:"Kilograms",aliases:[/^kg$/i,/^kgs?$/i,/^kilogram?s?$/i]},{normalized:"t",displayName:"Tons",aliases:[/^t$/i,/^ton?s?$/i,/^tonne?s?$/i]},{normalized:"sum",displayName:"Sum",aliases:[/^sum$/i,/^p\.?s\.?$/i,/^prov\.?\s*sum$/i]}];function cy(e){if(!e)return{original:"",normalized:"ea",displayName:"Each",confidence:.5};const t=e.trim();if(t.length===0)return{original:e,normalized:"ea",displayName:"Each",confidence:.5};for(const r of fR)for(const s of r.aliases)if(s.test(t))return{original:e,normalized:r.normalized,displayName:r.displayName,confidence:1};return{original:e,normalized:t.toLowerCase(),displayName:t,confidence:.3}}function Sf(e){if(typeof e=="number")return e;if(typeof e=="string"){const t=parseFloat(e.replace(/[^0-9.-]/g,""));return isNaN(t)?null:t}return null}function hR(e,t){return e&&t&&e!==0?t/e:null}function pR(e,t){return e&&t?e*t:null}function uy(e){return console.log("Attribute Extractor not fully implemented"),{}}function dy(e){let t=0;return e.qty&&e.rate&&(t+=40),e.unit&&(t+=20),e.description&&e.description.length>10&&(t+=20),e.system_id&&(t+=20),Math.min(t,100)}function mR(e){return e>=80?"text-green-600":e>=60?"text-amber-600":"text-red-600"}function xR(e){return e>=80?"High":e>=60?"Medium":"Low"}async function gR(e){return console.log("System matcher not fully implemented"),null}async function vR(e){return gR()}const yR=[{id:"PE_50_PEN",label:"50mm Penetration Seal",service:"penetration",size_min:0,size_max:75},{id:"PE_150_PEN",label:"150mm Penetration Seal",service:"penetration",size_min:76,size_max:200},{id:"LJ_25_PERIMETER",label:"25mm Linear Joint",service:"joint",size_min:0,size_max:50}];function wR(){return yR.reduce((e,t)=>(e[t.id]=t.label,e),{})}function Fk({currentStep:e,totalSteps:t=5,onBack:r,onNext:s,backLabel:n,nextLabel:a,disabledNext:i=!1}){return l.jsx("div",{className:"border-t border-gray-200 bg-white px-8 py-4",children:l.jsxs("div",{className:"flex items-center justify-between max-w-7xl mx-auto",children:[l.jsx("div",{className:"flex-1",children:r&&l.jsxs("button",{onClick:r,className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:[l.jsx(nx,{size:16}),n||"Back"]})}),l.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:["Step ",e+1," of ",t]}),l.jsx("div",{className:"flex-1 flex justify-end",children:s&&l.jsxs("button",{onClick:s,disabled:i,className:`inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-white rounded-lg transition-colors ${i?"bg-gray-300 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:[a||"Next step",l.jsx(n0,{size:16})]})})]})})}function yx(e){return e.quantity===null||e.quantity===void 0||e.quantity===0}function _R(e){return e.toLowerCase().replace(/\s+/g," ").replace(/(\d+(\.\d+)?\s*mm)/g,"").replace(/fc\s*\d+/g,"").replace(/[-,]/g," ").trim()}function bR(e){return e.replace(/\s+/g," ").split(" ").slice(0,8).join(" ")}function SR({projectId:e,onNavigateBack:t,onNavigateNext:r}){const[s,n]=F.useState([]),[a,i]=F.useState(null),[o,c]=F.useState([]),[u,d]=F.useState(null),[f,h]=F.useState({}),[m,p]=F.useState(!0),[x,v]=F.useState(!1),[y,w]=F.useState(!1),[g,_]=F.useState(!1),[b,k]=F.useState(!1),[S,T]=F.useState(null),[j,U]=F.useState(null),[H,z]=F.useState(null),q=wR(),re=async()=>{await pe.from("projects").update({updated_at:new Date().toISOString()}).eq("id",e)},X=async()=>{try{await pe.from("project_settings").upsert({project_id:e,review_clean_completed:!0,updated_at:new Date().toISOString()},{onConflict:"project_id"})}catch(V){console.error("Error marking Review & Clean as complete:",V)}};F.useEffect(()=>{M()},[e]),F.useEffect(()=>{a&&J(a)},[a]);const M=async()=>{p(!0);const{data:V,error:C}=await pe.from("quotes").select("*").eq("project_id",e).order("import_date",{ascending:!1});!C&&V&&(n(V),V.length>0&&!a&&i(V[0].id)),p(!1)},J=async V=>{const{data:C,error:he}=await pe.from("quote_items").select("*").eq("quote_id",V).order("created_at",{ascending:!0});!he&&C&&c(C)},G=async()=>{if(a){v(!0),T({type:"info",text:"Normalising items..."});try{const V=o.map(he=>{const ve=Sf(he.quantity),ke=Sf(he.unit_price);let Ae=Sf(he.total_price);const me=hR(Ae,ve),Ke=pR(ve,ke),de=ke||me,Ee=Ae||Ke,Oe=cy(he.unit),Me=uy(he.description),{confidence:We,issues:Ye}=dy(he.description,ve,he.unit,Oe.canonical,de,Ee,Me.confidence);return{id:he.id,quantity:ve||he.quantity,unit_price:de||he.unit_price,total_price:Ee||he.total_price,canonical_unit:Oe.canonical||"",size:Me.size||"",frr:Me.frr||"",service:Me.service||"",subclass:Me.subclass||"",material:Me.material||"",confidence:We,issues:JSON.stringify(Ye)}});for(const he of V){const{id:ve,...ke}=he;await pe.from("quote_items").update(ke).eq("id",ve)}await re(),await J(a),await M();const C=V.filter(he=>he.confidence<.6).length;T({type:"success",text:`Normalisation complete! ${V.length} items processed. ${C} items need review.`})}catch(V){console.error("Normalisation error:",V),T({type:"error",text:"Failed to normalise items. Please try again."})}finally{v(!1)}}},D=async()=>{if(a){w(!0),T({type:"info",text:"Mapping items to systems..."});try{const V=o.map(ve=>{const ke=vR({description:ve.description,size:ve.size,frr:ve.frr,service:ve.service,subclass:ve.subclass,material:ve.material});return{id:ve.id,system_id:ke.systemId||"",system_label:ke.systemLabel||"",system_confidence:ke.confidence,system_needs_review:ke.needsReview,system_manual_override:!1,matched_factors:JSON.stringify(ke.matchedFactors),missed_factors:JSON.stringify(ke.missedFactors)}});for(const ve of V){const{id:ke,...Ae}=ve;await pe.from("quote_items").update(Ae).eq("id",ke)}await re(),await J(a),await X();const C=V.filter(ve=>ve.system_needs_review).length,he=V.filter(ve=>ve.system_id).length;T({type:"success",text:`Mapping complete! ${he}/${V.length} items mapped. ${C} need review.`})}catch(V){console.error("Mapping error:",V),T({type:"error",text:"Failed to map items to systems. Please try again."})}finally{w(!1)}}},K=async()=>{if(!(!a||x||y||g)){_(!0),T({type:"info",text:"Step 1/2: Normalising items..."});try{let V=!0;try{await G()}catch(he){console.error("Normalise step failed:",he),T({type:"error",text:"Normalise failed  please try again."}),V=!1}if(!V)return;T({type:"info",text:"Step 2/2: Mapping items to systems..."});let C=!0;try{await D()}catch(he){console.error("Mapping step failed:",he),T({type:"error",text:"System mapping failed  please review items."}),C=!1}if(!C)return;T({type:"success",text:"Smart Clean complete! All items normalised and mapped."})}catch(V){console.error("Smart Clean error:",V),T({type:"error",text:"Smart Clean failed. Please try individual steps."})}finally{_(!1)}}},oe=async()=>{if(!(x||y||g||b)&&s.length!==0){k(!0);try{for(let V=0;V<s.length;V++){const C=s[V];T({type:"info",text:`Processing quote ${V+1}/${s.length}: ${C.supplier_name}`}),i(C.id),await J(C.id);try{await K()}catch(he){console.error(`Processing failed for quote ${C.supplier_name}:`,he)}}T({type:"success",text:"All quotes processed successfully."})}catch(V){console.error("Process All Quotes error:",V),T({type:"error",text:"Failed to process all quotes. Some quotes may have been processed."})}finally{k(!1)}}},N=async(V,C)=>{const he=q.find(ke=>ke.id===C);if(!he)return;const{error:ve}=await pe.from("quote_items").update({system_id:C,system_label:he.label,system_manual_override:!0,system_needs_review:!1}).eq("id",V);!ve&&a&&(await re(),J(a))},W=V=>{d(V.id),h({description:V.description,quantity:V.quantity,unit:V.unit,unit_price:V.unit_price,canonical_unit:V.canonical_unit,size:V.size,frr:V.frr,service:V.service,subclass:V.subclass,material:V.material})},I=()=>{d(null),h({})},B=async V=>{const C=(f.quantity||0)*(f.unit_price||0),he=cy(f.unit);uy(f.description||"");const{confidence:ve,issues:ke}=dy(f.description,f.quantity,f.unit,f.canonical_unit||he.canonical,f.unit_price),{error:Ae}=await pe.from("quote_items").update({...f,total_price:C,canonical_unit:f.canonical_unit||he.canonical||"",confidence:ve,issues:JSON.stringify(ke)}).eq("id",V);Ae||(await re(),d(null),h({}),J(a),M())},ee=async(V,C)=>{const{error:he}=await pe.from("quote_items").update({is_excluded:!C}).eq("id",V);!he&&a&&(await re(),J(a))},le=async V=>{if(!confirm("Are you sure you want to delete this item?"))return;const{error:C}=await pe.from("quote_items").delete().eq("id",V);!C&&a&&(await re(),J(a),M())},fe=async V=>{if(!confirm("Are you sure you want to delete this entire quote?"))return;const{error:C}=await pe.from("quotes").delete().eq("id",V);C||(a===V&&(i(null),c([])),M())},se=V=>{if(V===void 0||V===0)return l.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-medium rounded-full bg-gray-100 text-gray-600",children:"Not analysed"});const C=mR(V),he=xR(V),ve={green:"bg-green-100 text-green-800",amber:"bg-yellow-100 text-yellow-800",red:"bg-red-100 text-red-800"};return l.jsxs("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${ve[C]}`,children:[he," (",Math.round(V*100),"%)"]})},ne=V=>{if(!V)return[];if(typeof V=="string")try{return JSON.parse(V)}catch{return[]}return Array.isArray(V)?V:[]};return m?l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsx("div",{className:"text-gray-500",children:"Loading quotes..."})}):s.length===0?l.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center",children:[l.jsx("p",{className:"text-gray-500 text-lg",children:"No quotes imported yet."}),l.jsx("p",{className:"text-gray-400 mt-2",children:"Go to Import Quotes to add your first quote."})]}):l.jsxs("div",{className:"space-y-6",children:[S&&l.jsx("div",{className:`p-4 rounded-md ${S.type==="success"?"bg-green-50 text-green-800":S.type==="error"?"bg-red-50 text-red-800":"bg-blue-50 text-blue-800"}`,children:l.jsxs("div",{className:"flex items-start gap-2",children:[l.jsx(vt,{size:18,className:"mt-0.5 flex-shrink-0"}),l.jsx("span",{children:S.text})]})}),l.jsxs("div",{className:"grid grid-cols-12 gap-6",children:[l.jsx("div",{className:"col-span-3",children:l.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[l.jsx("div",{className:"p-4 border-b border-gray-200",children:l.jsx("h3",{className:"font-semibold text-gray-900",children:"Quotes"})}),l.jsx("div",{className:"divide-y divide-gray-200",children:s.map(V=>l.jsx("div",{className:`p-4 cursor-pointer hover:bg-gray-50 transition-colors ${a===V.id?"bg-blue-50 border-l-4 border-blue-600":""}`,onClick:()=>i(V.id),children:l.jsxs("div",{className:"flex items-start justify-between",children:[l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("p",{className:"font-medium text-gray-900 truncate",children:V.supplier_name}),l.jsx("p",{className:"text-sm text-gray-500 truncate",children:V.quote_reference||"No ref"}),l.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[l.jsxs("span",{className:"text-sm font-medium text-gray-900",children:["$",V.total_amount.toLocaleString()]}),l.jsx("span",{className:`inline-flex px-2 py-0.5 text-xs font-medium rounded-full ${V.status==="pending"?"bg-yellow-100 text-yellow-800":V.status==="reviewed"?"bg-blue-100 text-blue-800":V.status==="accepted"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:V.status})]})]}),l.jsx("button",{onClick:C=>{C.stopPropagation(),fe(V.id)},className:"p-1 text-red-600 hover:bg-red-50 rounded",children:l.jsx(Yl,{size:16})})]})},V.id))})]})}),l.jsx("div",{className:"col-span-9",children:l.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[l.jsxs("div",{className:"p-4 border-b border-gray-200 flex items-center justify-between",children:[l.jsx("h3",{className:"font-semibold text-gray-900",children:"Quote Items"}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("button",{onClick:G,disabled:x||o.length===0,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed",children:[l.jsx(CF,{size:18}),x?"Normalising...":"Normalise All"]}),l.jsxs("button",{onClick:K,disabled:g||x||y||o.length===0,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed",title:"Runs Normalise All and Map Systems together in one step",children:[l.jsx(kc,{size:18}),g?"Smart Cleaning...":" Smart Clean"]}),l.jsxs("button",{onClick:D,disabled:y||o.length===0,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed",children:[l.jsx(ES,{size:18}),y?"Mapping...":"Map Systems"]}),l.jsx("div",{className:"border-l border-gray-300 h-8 mx-2"}),l.jsxs("button",{onClick:oe,disabled:b||x||y||g||s.length===0,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed",title:"Process all quotes sequentially with normalise, clean, and map",children:[l.jsx(AF,{size:18}),b?"Processing All...":"Process All Quotes"]})]})]}),l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full",children:[l.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Description"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Qty"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Unit"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Rate"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Total"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Attributes"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Suggest System"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Confidence"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),l.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),l.jsx("tbody",{className:"divide-y divide-gray-200",children:o.map(V=>{const C=ne(V.issues);return l.jsx("tr",{className:V.is_excluded?"bg-gray-50 opacity-60":"",children:u===V.id?l.jsxs(l.Fragment,{children:[l.jsx("td",{className:"px-4 py-3",children:l.jsx("input",{type:"text",value:f.description||"",onChange:he=>h({...f,description:he.target.value}),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm text-gray-900"})}),l.jsx("td",{className:"px-4 py-3",children:l.jsx("input",{type:"number",value:f.quantity||"",onChange:he=>h({...f,quantity:parseFloat(he.target.value)||0}),className:"w-20 px-2 py-1 border border-gray-300 rounded text-sm text-gray-900",step:"0.01"})}),l.jsx("td",{className:"px-4 py-3",children:l.jsx("input",{type:"text",value:f.unit||"",onChange:he=>h({...f,unit:he.target.value}),className:"w-20 px-2 py-1 border border-gray-300 rounded text-sm text-gray-900"})}),l.jsx("td",{className:"px-4 py-3",children:l.jsx("input",{type:"number",value:f.unit_price||"",onChange:he=>h({...f,unit_price:parseFloat(he.target.value)||0}),className:"w-24 px-2 py-1 border border-gray-300 rounded text-sm text-gray-900",step:"0.01"})}),l.jsxs("td",{className:"px-4 py-3 text-sm text-gray-900",children:["$",((f.quantity||0)*(f.unit_price||0)).toFixed(2)]}),l.jsx("td",{className:"px-4 py-3",children:l.jsxs("div",{className:"text-xs space-y-1",children:[f.canonical_unit&&l.jsxs("div",{children:["Unit: ",f.canonical_unit]}),f.service&&l.jsxs("div",{children:["Service: ",f.service]})]})}),l.jsx("td",{className:"px-4 py-3",children:l.jsx("span",{className:"text-sm text-gray-500",children:"Editing..."})}),l.jsx("td",{className:"px-4 py-3",children:l.jsx("span",{className:"text-sm text-gray-500",children:"Editing"})}),l.jsx("td",{className:"px-4 py-3",children:l.jsx("span",{className:"text-sm text-gray-500",children:"-"})}),l.jsx("td",{className:"px-4 py-3 text-right",children:l.jsxs("div",{className:"flex items-center justify-end gap-2",children:[l.jsx("button",{onClick:()=>B(V.id),className:"p-1 text-green-600 hover:bg-green-50 rounded",children:l.jsx(yS,{size:18})}),l.jsx("button",{onClick:I,className:"p-1 text-red-600 hover:bg-red-50 rounded",children:l.jsx(cn,{size:18})})]})})]}):l.jsxs(l.Fragment,{children:[l.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 max-w-xs",children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"truncate",title:V.description,children:V.description}),yx(V)&&l.jsx("span",{className:"inline-flex px-2 py-0.5 text-xs font-medium rounded-full bg-yellow-100 text-yellow-800 whitespace-nowrap",children:"Needs quantity"})]})}),l.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:V.quantity}),l.jsxs("td",{className:"px-4 py-3 text-sm",children:[l.jsx("div",{children:V.unit}),V.canonical_unit&&l.jsxs("div",{className:"text-xs text-blue-600 font-medium",children:[" ",V.canonical_unit]})]}),l.jsxs("td",{className:"px-4 py-3 text-sm text-gray-900",children:["$",V.unit_price.toFixed(2)]}),l.jsxs("td",{className:"px-4 py-3 text-sm text-gray-900",children:["$",V.total_price.toFixed(2)]}),l.jsx("td",{className:"px-4 py-3",children:l.jsxs("div",{className:"text-xs space-y-1",children:[V.size&&l.jsxs("div",{className:"text-gray-600",children:["Size: ",V.size]}),V.frr&&l.jsxs("div",{className:"text-gray-600",children:["FRR: ",V.frr]}),V.service&&l.jsxs("div",{className:"text-blue-600",children:["Service: ",V.service]}),V.subclass&&l.jsxs("div",{className:"text-gray-600",children:["Type: ",V.subclass]}),V.material&&l.jsxs("div",{className:"text-gray-600",children:["Material: ",V.material]})]})}),l.jsx("td",{className:"px-4 py-3",children:V.system_label?l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex items-start gap-2",children:[l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("div",{className:"text-xs font-medium text-gray-900 truncate",title:V.system_label,children:V.system_label}),l.jsx("div",{className:"text-xs text-gray-500",children:V.system_id}),V.system_manual_override&&l.jsx("div",{className:"text-xs text-blue-600 mt-0.5",children:"Manual override"})]}),V.system_confidence!==void 0&&l.jsxs("span",{className:`inline-flex px-1.5 py-0.5 text-xs font-medium rounded ${V.system_confidence>=.7?"bg-green-100 text-green-800":V.system_confidence>=.5?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:[Math.round(V.system_confidence*100),"%"]})]}),l.jsxs("select",{value:V.system_id||"",onChange:he=>N(V.id,he.target.value),className:"w-full text-xs border border-gray-300 rounded px-2 py-1 focus:ring-2 focus:ring-blue-500 focus:border-transparent text-gray-900",children:[l.jsx("option",{value:"",children:"-- Change System --"}),q.map(he=>l.jsx("option",{value:he.id,children:he.label},he.id))]}),(V.matched_factors||V.missed_factors)&&l.jsxs("button",{onClick:()=>z(H===V.id?null:V.id),className:"text-xs text-blue-600 hover:text-blue-800 flex items-center gap-1",children:[l.jsx(vt,{size:12}),"Match details"]}),H===V.id&&l.jsxs("div",{className:"mt-1 p-2 bg-gray-50 rounded text-xs",children:[V.matched_factors&&JSON.parse(V.matched_factors).length>0&&l.jsxs("div",{className:"mb-2",children:[l.jsx("div",{className:"font-medium text-green-700 mb-1",children:"Matched:"}),l.jsx("ul",{className:"list-disc list-inside text-green-600 space-y-0.5",children:JSON.parse(V.matched_factors).map((he,ve)=>l.jsx("li",{children:he},ve))})]}),V.missed_factors&&JSON.parse(V.missed_factors).length>0&&l.jsxs("div",{children:[l.jsx("div",{className:"font-medium text-red-700 mb-1",children:"Missed:"}),l.jsx("ul",{className:"list-disc list-inside text-red-600 space-y-0.5",children:JSON.parse(V.missed_factors).map((he,ve)=>l.jsx("li",{children:he},ve))})]})]})]}):l.jsx("div",{className:"text-xs text-gray-400",children:"Not mapped"})}),l.jsxs("td",{className:"px-4 py-3",children:[l.jsxs("div",{className:"space-y-1",children:[se(V.confidence),C.length>0&&l.jsxs("button",{onClick:()=>U(j===V.id?null:V.id),className:"text-xs text-red-600 hover:text-red-800 flex items-center gap-1",children:[l.jsx(vt,{size:12}),C.length," issue",C.length!==1?"s":""]})]}),j===V.id&&C.length>0&&l.jsx("div",{className:"mt-2 p-2 bg-red-50 rounded text-xs text-red-800",children:l.jsx("ul",{className:"list-disc list-inside space-y-1",children:C.map((he,ve)=>l.jsx("li",{children:he},ve))})})]}),l.jsx("td",{className:"px-4 py-3",children:l.jsx("button",{onClick:()=>ee(V.id,V.is_excluded),className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${V.is_excluded?"bg-red-100 text-red-800 hover:bg-red-200":"bg-green-100 text-green-800 hover:bg-green-200"}`,children:V.is_excluded?"Excluded":"Included"})}),l.jsx("td",{className:"px-4 py-3 text-right",children:l.jsxs("div",{className:"flex items-center justify-end gap-2",children:[l.jsx("button",{onClick:()=>W(V),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",children:l.jsx(SS,{size:16})}),l.jsx("button",{onClick:()=>le(V.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",children:l.jsx(Yl,{size:16})})]})})]})},V.id)})})]})})]})})]}),l.jsx(Fk,{currentStep:2,onBack:t,onNext:r,backLabel:"Back: Import Quotes",nextLabel:"Next: Quote Intelligence"})]})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Ed={};Ed.version="0.18.5";var Pk=1252,kR=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],wx={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},_x=function(e){kR.indexOf(e)!=-1&&(Pk=wx[0]=e)};function ER(){_x(1252)}var zs=function(e){_x(e)};function bx(){zs(1200),ER()}function fy(e){for(var t=[],r=0,s=e.length;r<s;++r)t[r]=e.charCodeAt(r);return t}function TR(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function Rk(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Zo=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?TR(e.slice(2)):t==254&&r==255?Rk(e.slice(2)):t==65279?e.slice(1):e},pu=function(t){return String.fromCharCode(t)},hy=function(t){return String.fromCharCode(t)},tc,Kn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function rc(e){for(var t="",r=0,s=0,n=0,a=0,i=0,o=0,c=0,u=0;u<e.length;)r=e.charCodeAt(u++),a=r>>2,s=e.charCodeAt(u++),i=(r&3)<<4|s>>4,n=e.charCodeAt(u++),o=(s&15)<<2|n>>6,c=n&63,isNaN(s)?o=c=64:isNaN(n)&&(c=64),t+=Kn.charAt(a)+Kn.charAt(i)+Kn.charAt(o)+Kn.charAt(c);return t}function cs(e){var t="",r=0,s=0,n=0,a=0,i=0,o=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)a=Kn.indexOf(e.charAt(u++)),i=Kn.indexOf(e.charAt(u++)),r=a<<2|i>>4,t+=String.fromCharCode(r),o=Kn.indexOf(e.charAt(u++)),s=(i&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(s)),c=Kn.indexOf(e.charAt(u++)),n=(o&3)<<6|c,c!==64&&(t+=String.fromCharCode(n));return t}var qe=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),On=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function la(e){return qe?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function py(e){return qe?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var ss=function(t){return qe?On(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function c0(e){if(typeof ArrayBuffer>"u")return ss(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),s=0;s!=e.length;++s)r[s]=e.charCodeAt(s)&255;return t}function ga(e){if(Array.isArray(e))return e.map(function(s){return String.fromCharCode(s)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function NR(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function Sx(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Sx(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var rr=qe?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:On(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var s=new Uint8Array(r),n=0;for(t=0,r=0;t<e.length;r+=n,++t)if(n=e[t].length,e[t]instanceof Uint8Array)s.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";s.set(new Uint8Array(e[t]),r)}return s}return[].concat.apply([],e.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function jR(e){for(var t=[],r=0,s=e.length+250,n=la(e.length+255),a=0;a<e.length;++a){var i=e.charCodeAt(a);if(i<128)n[r++]=i;else if(i<2048)n[r++]=192|i>>6&31,n[r++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var o=e.charCodeAt(++a)&1023;n[r++]=240|i>>8&7,n[r++]=128|i>>2&63,n[r++]=128|o>>6&15|(i&3)<<4,n[r++]=128|o&63}else n[r++]=224|i>>12&15,n[r++]=128|i>>6&63,n[r++]=128|i&63;r>s&&(t.push(n.slice(0,r)),r=0,n=la(65535),s=65530)}return t.push(n.slice(0,r)),rr(t)}var Lr=/\u0000/g,el=/[\u0001-\u0006]/g;function Qi(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Ws(e,t){var r=""+e;return r.length>=t?r:Rt("0",t-r.length)+r}function kx(e,t){var r=""+e;return r.length>=t?r:Rt(" ",t-r.length)+r}function Td(e,t){var r=""+e;return r.length>=t?r:r+Rt(" ",t-r.length)}function CR(e,t){var r=""+Math.round(e);return r.length>=t?r:Rt("0",t-r.length)+r}function AR(e,t){var r=""+e;return r.length>=t?r:Rt("0",t-r.length)+r}var my=Math.pow(2,32);function yi(e,t){if(e>my||e<-my)return CR(e,t);var r=Math.round(e);return AR(r,t)}function Nd(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var xy=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],kf=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function FR(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var De={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},gy={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},PR={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function jd(e,t,r){for(var s=e<0?-1:1,n=e*s,a=0,i=1,o=0,c=1,u=0,d=0,f=Math.floor(n);u<t&&(f=Math.floor(n),o=f*i+a,d=f*u+c,!(n-f<5e-8));)n=1/(n-f),a=i,i=o,c=u,u=d;if(d>t&&(u>t?(d=c,o=a):(d=u,o=i)),!r)return[0,s*o,d];var h=Math.floor(s*o/d);return[h,s*o-h*d,d]}function Ma(e,t,r){if(e>2958465||e<0)return null;var s=e|0,n=Math.floor(86400*(e-s)),a=0,i=[],o={D:s,T:n,u:86400*(e-s)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(s+=1462),o.u>.9999&&(o.u=0,++n==86400&&(o.T=n=0,++s,++o.D)),s===60)i=r?[1317,10,29]:[1900,2,29],a=3;else if(s===0)i=r?[1317,8,29]:[1900,1,0],a=6;else{s>60&&--s;var c=new Date(1900,0,1);c.setDate(c.getDate()+s-1),i=[c.getFullYear(),c.getMonth()+1,c.getDate()],a=c.getDay(),s<60&&(a=(a+6)%7),r&&(a=MR(c,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=n%60,n=Math.floor(n/60),o.M=n%60,n=Math.floor(n/60),o.H=n,o.q=a,o}var Ok=new Date(1899,11,31,0,0,0),RR=Ok.getTime(),OR=new Date(1900,2,1,0,0,0);function Ik(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=OR&&(r+=24*60*60*1e3),(r-(RR+(e.getTimezoneOffset()-Ok.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Ex(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function IR(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function DR(e){var t=e<0?12:11,r=Ex(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function LR(e){var t=Ex(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function sc(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=DR(e):t===10?r=e.toFixed(10).substr(0,12):r=LR(e),Ex(IR(r.toUpperCase()))}function Qa(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):sc(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Ps(14,Ik(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function MR(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function BR(e,t,r,s){var n="",a=0,i=0,o=r.y,c,u=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:c=o%100,u=2;break;default:c=o%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,u=t.length;break;case 3:return kf[r.m-1][1];case 5:return kf[r.m-1][0];default:return kf[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,u=t.length;break;case 3:return xy[r.q][0];default:return xy[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Ws(r.S,t.length):(s>=2?i=s===3?1e3:100:i=s===1?10:1,a=Math.round(i*(r.S+r.u)),a>=60*i&&(a=0),t==="s"?a===0?"0":""+a/i:(n=Ws(a,2+s),t==="ss"?n.substr(0,2):"."+n.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:c=o,u=1;break}var d=u>0?Ws(c,u):"";return d}function Xn(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,s=e.substr(0,r);r!=e.length;r+=t)s+=(s.length>0?",":"")+e.substr(r,t);return s}var Dk=/%/g;function UR(e,t,r){var s=t.replace(Dk,""),n=t.length-s.length;return Sn(e,s,r*Math.pow(10,2*n))+Rt("%",n)}function $R(e,t,r){for(var s=t.length-1;t.charCodeAt(s-1)===44;)--s;return Sn(e,t.substr(0,s),r/Math.pow(10,3*(t.length-s)))}function Lk(e,t){var r,s=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Lk(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%n;if(a<0&&(a+=n),r=(t/Math.pow(10,a)).toPrecision(s+1+(n+a)%n),r.indexOf("e")===-1){var i=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,n)+"."+r.substr(2+n),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,u,d){return c+u+d.substr(0,(n+a)%n)+"."+d.substr(a)+"E"})}else r=t.toExponential(s);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var Mk=/# (\?+)( ?)\/( ?)(\d+)/;function VR(e,t,r){var s=parseInt(e[4],10),n=Math.round(t*s),a=Math.floor(n/s),i=n-a*s,o=s;return r+(a===0?"":""+a)+" "+(i===0?Rt(" ",e[1].length+1+e[4].length):kx(i,e[1].length)+e[2]+"/"+e[3]+Ws(o,e[4].length))}function zR(e,t,r){return r+(t===0?"":""+t)+Rt(" ",e[1].length+2+e[4].length)}var Bk=/^#*0*\.([0#]+)/,Uk=/\).*[0#]/,$k=/\(###\) ###\\?-####/;function Fr(e){for(var t="",r,s=0;s!=e.length;++s)switch(r=e.charCodeAt(s)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function vy(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function yy(e,t){var r=e-Math.floor(e),s=Math.pow(10,t);return t<(""+Math.round(r*s)).length?0:Math.round(r*s)}function WR(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function HR(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function xs(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Uk)){var s=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?xs("n",s,r):"("+xs("n",s,-r)+")"}if(t.charCodeAt(t.length-1)===44)return $R(e,t,r);if(t.indexOf("%")!==-1)return UR(e,t,r);if(t.indexOf("E")!==-1)return Lk(t,r);if(t.charCodeAt(0)===36)return"$"+xs(e,t.substr(t.charAt(1)==" "?2:1),r);var n,a,i,o,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+yi(c,t.length);if(t.match(/^[#?]+$/))return n=yi(r,0),n==="0"&&(n=""),n.length>t.length?n:Fr(t.substr(0,t.length-n.length))+n;if(a=t.match(Mk))return VR(a,c,u);if(t.match(/^#+0+$/))return u+yi(c,t.length-t.indexOf("0"));if(a=t.match(Bk))return n=vy(r,a[1].length).replace(/^([^\.]+)$/,"$1."+Fr(a[1])).replace(/\.$/,"."+Fr(a[1])).replace(/\.(\d*)$/,function(p,x){return"."+x+Rt("0",Fr(a[1]).length-x.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return u+vy(c,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return u+Xn(yi(c,0));if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+xs(e,t,-r):Xn(""+(Math.floor(r)+WR(r,a[1].length)))+"."+Ws(yy(r,a[1].length),a[1].length);if(a=t.match(/^#,#*,#0/))return xs(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=Qi(xs(e,t.replace(/[\\-]/g,""),r)),i=0,Qi(Qi(t.replace(/\\/g,"")).replace(/[0#]/g,function(p){return i<n.length?n.charAt(i++):p==="0"?"0":""}));if(t.match($k))return n=xs(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var d="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=jd(c,Math.pow(10,i)-1,!1),n=""+u,d=Sn("n",a[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),n+=d+a[2]+"/"+a[3],d=Td(o[2],i),d.length<a[4].length&&(d=Fr(a[4].substr(a[4].length-d.length))+d),n+=d,n;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),o=jd(c,Math.pow(10,i)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?kx(o[1],i)+a[2]+"/"+a[3]+Td(o[2],i):Rt(" ",2*i+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return n=yi(r,0),t.length<=n.length?n:Fr(t.substr(0,t.length-n.length))+n;if(a=t.match(/^([#0?]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=n.indexOf(".");var f=t.indexOf(".")-i,h=t.length-n.length-f;return Fr(t.substr(0,f)+n+t.substr(t.length-h))}if(a=t.match(/^00,000\.([#0]*0)$/))return i=yy(r,a[1].length),r<0?"-"+xs(e,t,-r):Xn(HR(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?Ws(0,3-p.length):"")+p})+"."+Ws(i,a[1].length);switch(t){case"###,##0.00":return xs(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var m=Xn(yi(c,0));return m!=="0"?u+m:"";case"###,###.00":return xs(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return xs(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function qR(e,t,r){for(var s=t.length-1;t.charCodeAt(s-1)===44;)--s;return Sn(e,t.substr(0,s),r/Math.pow(10,3*(t.length-s)))}function GR(e,t,r){var s=t.replace(Dk,""),n=t.length-s.length;return Sn(e,s,r*Math.pow(10,2*n))+Rt("%",n)}function Vk(e,t){var r,s=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Vk(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%n;if(a<0&&(a+=n),r=(t/Math.pow(10,a)).toPrecision(s+1+(n+a)%n),!r.match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,u,d){return c+u+d.substr(0,(n+a)%n)+"."+d.substr(a)+"E"})}else r=t.toExponential(s);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Zs(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Uk)){var s=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Zs("n",s,r):"("+Zs("n",s,-r)+")"}if(t.charCodeAt(t.length-1)===44)return qR(e,t,r);if(t.indexOf("%")!==-1)return GR(e,t,r);if(t.indexOf("E")!==-1)return Vk(t,r);if(t.charCodeAt(0)===36)return"$"+Zs(e,t.substr(t.charAt(1)==" "?2:1),r);var n,a,i,o,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Ws(c,t.length);if(t.match(/^[#?]+$/))return n=""+r,r===0&&(n=""),n.length>t.length?n:Fr(t.substr(0,t.length-n.length))+n;if(a=t.match(Mk))return zR(a,c,u);if(t.match(/^#+0+$/))return u+Ws(c,t.length-t.indexOf("0"));if(a=t.match(Bk))return n=(""+r).replace(/^([^\.]+)$/,"$1."+Fr(a[1])).replace(/\.$/,"."+Fr(a[1])),n=n.replace(/\.(\d*)$/,function(p,x){return"."+x+Rt("0",Fr(a[1]).length-x.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return u+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return u+Xn(""+c);if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Zs(e,t,-r):Xn(""+r)+"."+Rt("0",a[1].length);if(a=t.match(/^#,#*,#0/))return Zs(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=Qi(Zs(e,t.replace(/[\\-]/g,""),r)),i=0,Qi(Qi(t.replace(/\\/g,"")).replace(/[0#]/g,function(p){return i<n.length?n.charAt(i++):p==="0"?"0":""}));if(t.match($k))return n=Zs(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var d="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=jd(c,Math.pow(10,i)-1,!1),n=""+u,d=Sn("n",a[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),n+=d+a[2]+"/"+a[3],d=Td(o[2],i),d.length<a[4].length&&(d=Fr(a[4].substr(a[4].length-d.length))+d),n+=d,n;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),o=jd(c,Math.pow(10,i)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?kx(o[1],i)+a[2]+"/"+a[3]+Td(o[2],i):Rt(" ",2*i+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return n=""+r,t.length<=n.length?n:Fr(t.substr(0,t.length-n.length))+n;if(a=t.match(/^([#0]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=n.indexOf(".");var f=t.indexOf(".")-i,h=t.length-n.length-f;return Fr(t.substr(0,f)+n+t.substr(t.length-h))}if(a=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Zs(e,t,-r):Xn(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?Ws(0,3-p.length):"")+p})+"."+Ws(0,a[1].length);switch(t){case"###,###":case"##,###":case"#,###":var m=Xn(""+c);return m!=="0"?u+m:"";default:if(t.match(/\.[0#?]*$/))return Zs(e,t.slice(0,t.lastIndexOf(".")),r)+Fr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Sn(e,t,r){return(r|0)===r?Zs(e,t,r):xs(e,t,r)}function KR(e){for(var t=[],r=!1,s=0,n=0;s<e.length;++s)switch(e.charCodeAt(s)){case 34:r=!r;break;case 95:case 42:case 92:++s;break;case 59:t[t.length]=e.substr(n,s-n),n=s+1}if(t[t.length]=e.substr(n),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var zk=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Co(e){for(var t=0,r="",s="";t<e.length;)switch(r=e.charAt(t)){case"G":Nd(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(s=r;e.charAt(t++)!=="]"&&t<e.length;)s+=e.charAt(t);if(s.match(zk))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function XR(e,t,r,s){for(var n=[],a="",i=0,o="",c="t",u,d,f,h="H";i<e.length;)switch(o=e.charAt(i)){case"G":if(!Nd(e,i))throw new Error("unrecognized character "+o+" in "+e);n[n.length]={t:"G",v:"General"},i+=7;break;case'"':for(a="";(f=e.charCodeAt(++i))!==34&&i<e.length;)a+=String.fromCharCode(f);n[n.length]={t:"t",v:a},++i;break;case"\\":var m=e.charAt(++i),p=m==="("||m===")"?m:"t";n[n.length]={t:p,v:m},++i;break;case"_":n[n.length]={t:"t",v:" "},i+=2;break;case"@":n[n.length]={t:"T",v:t},++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2"){if(u==null&&(u=Ma(t,r,e.charAt(i+1)==="2"),u==null))return"";n[n.length]={t:"X",v:e.substr(i,2)},c=o,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=Ma(t,r),u==null))return"";for(a=o;++i<e.length&&e.charAt(i).toLowerCase()===o;)a+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=h),n[n.length]={t:o,v:a},c=o;break;case"A":case"a":case"":var x={t:o,v:o};if(u==null&&(u=Ma(t,r)),e.substr(i,3).toUpperCase()==="A/P"?(u!=null&&(x.v=u.H>=12?"P":"A"),x.t="T",h="h",i+=3):e.substr(i,5).toUpperCase()==="AM/PM"?(u!=null&&(x.v=u.H>=12?"PM":"AM"),x.t="T",i+=5,h="h"):e.substr(i,5).toUpperCase()==="/"?(u!=null&&(x.v=u.H>=12?"":""),x.t="T",i+=5,h="h"):(x.t="t",++i),u==null&&x.t==="T")return"";n[n.length]=x,c=o;break;case"[":for(a=o;e.charAt(i++)!=="]"&&i<e.length;)a+=e.charAt(i);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(zk)){if(u==null&&(u=Ma(t,r),u==null))return"";n[n.length]={t:"Z",v:a.toLowerCase()},c=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",Co(e)||(n[n.length]={t:"t",v:a}));break;case".":if(u!=null){for(a=o;++i<e.length&&(o=e.charAt(i))==="0";)a+=o;n[n.length]={t:"s",v:a};break}case"0":case"#":for(a=o;++i<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(i))>-1;)a+=o;n[n.length]={t:"n",v:a};break;case"?":for(a=o;e.charAt(++i)===o;)a+=o;n[n.length]={t:o,v:a},c=o;break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":n[n.length]={t:s===1?"t":o,v:o},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=o;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;)a+=e.charAt(i);n[n.length]={t:"D",v:a};break;case" ":n[n.length]={t:o,v:o},++i;break;case"$":n[n.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);n[n.length]={t:"t",v:o},++i;break}var v=0,y=0,w;for(i=n.length-1,c="t";i>=0;--i)switch(n[i].t){case"h":case"H":n[i].t=h,c="h",v<1&&(v=1);break;case"s":(w=n[i].v.match(/\.0+$/))&&(y=Math.max(y,w[0].length-1)),v<3&&(v=3);case"d":case"y":case"M":case"e":c=n[i].t;break;case"m":c==="s"&&(n[i].t="M",v<2&&(v=2));break;case"X":break;case"Z":v<1&&n[i].v.match(/[Hh]/)&&(v=1),v<2&&n[i].v.match(/[Mm]/)&&(v=2),v<3&&n[i].v.match(/[Ss]/)&&(v=3)}switch(v){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var g="",_;for(i=0;i<n.length;++i)switch(n[i].t){case"t":case"T":case" ":case"D":break;case"X":n[i].v="",n[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":n[i].v=BR(n[i].t.charCodeAt(0),n[i].v,u,y),n[i].t="t";break;case"n":case"?":for(_=i+1;n[_]!=null&&((o=n[_].t)==="?"||o==="D"||(o===" "||o==="t")&&n[_+1]!=null&&(n[_+1].t==="?"||n[_+1].t==="t"&&n[_+1].v==="/")||n[i].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(n[_].v==="/"||n[_].v===" "&&n[_+1]!=null&&n[_+1].t=="?"));)n[i].v+=n[_].v,n[_]={v:"",t:";"},++_;g+=n[i].v,i=_-1;break;case"G":n[i].t="t",n[i].v=Qa(t,r);break}var b="",k,S;if(g.length>0){g.charCodeAt(0)==40?(k=t<0&&g.charCodeAt(0)===45?-t:t,S=Sn("n",g,k)):(k=t<0&&s>1?-t:t,S=Sn("n",g,k),k<0&&n[0]&&n[0].t=="t"&&(S=S.substr(1),n[0].v="-"+n[0].v)),_=S.length-1;var T=n.length;for(i=0;i<n.length;++i)if(n[i]!=null&&n[i].t!="t"&&n[i].v.indexOf(".")>-1){T=i;break}var j=n.length;if(T===n.length&&S.indexOf("E")===-1){for(i=n.length-1;i>=0;--i)n[i]==null||"n?".indexOf(n[i].t)===-1||(_>=n[i].v.length-1?(_-=n[i].v.length,n[i].v=S.substr(_+1,n[i].v.length)):_<0?n[i].v="":(n[i].v=S.substr(0,_+1),_=-1),n[i].t="t",j=i);_>=0&&j<n.length&&(n[j].v=S.substr(0,_+1)+n[j].v)}else if(T!==n.length&&S.indexOf("E")===-1){for(_=S.indexOf(".")-1,i=T;i>=0;--i)if(!(n[i]==null||"n?".indexOf(n[i].t)===-1)){for(d=n[i].v.indexOf(".")>-1&&i===T?n[i].v.indexOf(".")-1:n[i].v.length-1,b=n[i].v.substr(d+1);d>=0;--d)_>=0&&(n[i].v.charAt(d)==="0"||n[i].v.charAt(d)==="#")&&(b=S.charAt(_--)+b);n[i].v=b,n[i].t="t",j=i}for(_>=0&&j<n.length&&(n[j].v=S.substr(0,_+1)+n[j].v),_=S.indexOf(".")+1,i=T;i<n.length;++i)if(!(n[i]==null||"n?(".indexOf(n[i].t)===-1&&i!==T)){for(d=n[i].v.indexOf(".")>-1&&i===T?n[i].v.indexOf(".")+1:0,b=n[i].v.substr(0,d);d<n[i].v.length;++d)_<S.length&&(b+=S.charAt(_++));n[i].v=b,n[i].t="t",j=i}}}for(i=0;i<n.length;++i)n[i]!=null&&"n?".indexOf(n[i].t)>-1&&(k=s>1&&t<0&&i>0&&n[i-1].v==="-"?-t:t,n[i].v=Sn(n[i].t,n[i].v,k),n[i].t="t");var U="";for(i=0;i!==n.length;++i)n[i]!=null&&(U+=n[i].v);return U}var wy=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function _y(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function YR(e,t){var r=KR(e),s=r.length,n=r[s-1].indexOf("@");if(s<4&&n>-1&&--s,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||n>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=n>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=n>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=n>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[s,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var i=r[0].match(wy),o=r[1].match(wy);return _y(t,i)?[s,r[0]]:_y(t,o)?[s,r[1]]:[s,r[i!=null&&o!=null?2:1]]}return[s,a]}function Ps(e,t,r){r==null&&(r={});var s="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?s=r.dateNF:s=e;break;case"number":e==14&&r.dateNF?s=r.dateNF:s=(r.table!=null?r.table:De)[e],s==null&&(s=r.table&&r.table[gy[e]]||De[gy[e]]),s==null&&(s=PR[e]||"General");break}if(Nd(s,0))return Qa(t,r);t instanceof Date&&(t=Ik(t,r.date1904));var n=YR(s,t);if(Nd(n[1]))return Qa(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return XR(n[1],t,r,n[0])}function kn(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(De[r]==null){t<0&&(t=r);continue}if(De[r]==e){t=r;break}}t<0&&(t=391)}return De[t]=e,t}function u0(e){for(var t=0;t!=392;++t)e[t]!==void 0&&kn(e[t],t)}function Ao(){De=FR()}var JR={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Wk=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function QR(e){var t=typeof e=="number"?De[e]:e;return t=t.replace(Wk,"(\\d+)"),new RegExp("^"+t+"$")}function ZR(e,t,r){var s=-1,n=-1,a=-1,i=-1,o=-1,c=-1;(t.match(Wk)||[]).forEach(function(f,h){var m=parseInt(r[h+1],10);switch(f.toLowerCase().charAt(0)){case"y":s=m;break;case"d":a=m;break;case"h":i=m;break;case"s":c=m;break;case"m":i>=0?o=m:n=m;break}}),c>=0&&o==-1&&n>=0&&(o=n,n=-1);var u=(""+(s>=0?s:new Date().getFullYear())).slice(-4)+"-"+("00"+(n>=1?n:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var d=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return i==-1&&o==-1&&c==-1?u:s==-1&&n==-1&&a==-1?d:u+"T"+d}var eO=function(){var e={};e.version="1.2.0";function t(){for(var S=0,T=new Array(256),j=0;j!=256;++j)S=j,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,T[j]=S;return typeof Int32Array<"u"?new Int32Array(T):T}var r=t();function s(S){var T=0,j=0,U=0,H=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(U=0;U!=256;++U)H[U]=S[U];for(U=0;U!=256;++U)for(j=S[U],T=256+U;T<4096;T+=256)j=H[T]=j>>>8^S[j&255];var z=[];for(U=1;U!=16;++U)z[U-1]=typeof Int32Array<"u"?H.subarray(U*256,U*256+256):H.slice(U*256,U*256+256);return z}var n=s(r),a=n[0],i=n[1],o=n[2],c=n[3],u=n[4],d=n[5],f=n[6],h=n[7],m=n[8],p=n[9],x=n[10],v=n[11],y=n[12],w=n[13],g=n[14];function _(S,T){for(var j=T^-1,U=0,H=S.length;U<H;)j=j>>>8^r[(j^S.charCodeAt(U++))&255];return~j}function b(S,T){for(var j=T^-1,U=S.length-15,H=0;H<U;)j=g[S[H++]^j&255]^w[S[H++]^j>>8&255]^y[S[H++]^j>>16&255]^v[S[H++]^j>>>24]^x[S[H++]]^p[S[H++]]^m[S[H++]]^h[S[H++]]^f[S[H++]]^d[S[H++]]^u[S[H++]]^c[S[H++]]^o[S[H++]]^i[S[H++]]^a[S[H++]]^r[S[H++]];for(U+=15;H<U;)j=j>>>8^r[(j^S[H++])&255];return~j}function k(S,T){for(var j=T^-1,U=0,H=S.length,z=0,q=0;U<H;)z=S.charCodeAt(U++),z<128?j=j>>>8^r[(j^z)&255]:z<2048?(j=j>>>8^r[(j^(192|z>>6&31))&255],j=j>>>8^r[(j^(128|z&63))&255]):z>=55296&&z<57344?(z=(z&1023)+64,q=S.charCodeAt(U++)&1023,j=j>>>8^r[(j^(240|z>>8&7))&255],j=j>>>8^r[(j^(128|z>>2&63))&255],j=j>>>8^r[(j^(128|q>>6&15|(z&3)<<4))&255],j=j>>>8^r[(j^(128|q&63))&255]):(j=j>>>8^r[(j^(224|z>>12&15))&255],j=j>>>8^r[(j^(128|z>>6&63))&255],j=j>>>8^r[(j^(128|z&63))&255]);return~j}return e.table=r,e.bstr=_,e.buf=b,e.str=k,e}(),Re=function(){var t={};t.version="1.2.1";function r(E,R){for(var A=E.split("/"),P=R.split("/"),O=0,L=0,Q=Math.min(A.length,P.length);O<Q;++O){if(L=A[O].length-P[O].length)return L;if(A[O]!=P[O])return A[O]<P[O]?-1:1}return A.length-P.length}function s(E){if(E.charAt(E.length-1)=="/")return E.slice(0,-1).indexOf("/")===-1?E:s(E.slice(0,-1));var R=E.lastIndexOf("/");return R===-1?E:E.slice(0,R+1)}function n(E){if(E.charAt(E.length-1)=="/")return n(E.slice(0,-1));var R=E.lastIndexOf("/");return R===-1?E:E.slice(R+1)}function a(E,R){typeof R=="string"&&(R=new Date(R));var A=R.getHours();A=A<<6|R.getMinutes(),A=A<<5|R.getSeconds()>>>1,E.write_shift(2,A);var P=R.getFullYear()-1980;P=P<<4|R.getMonth()+1,P=P<<5|R.getDate(),E.write_shift(2,P)}function i(E){var R=E.read_shift(2)&65535,A=E.read_shift(2)&65535,P=new Date,O=A&31;A>>>=5;var L=A&15;A>>>=4,P.setMilliseconds(0),P.setFullYear(A+1980),P.setMonth(L-1),P.setDate(O);var Q=R&31;R>>>=5;var ie=R&63;return R>>>=6,P.setHours(R),P.setMinutes(ie),P.setSeconds(Q<<1),P}function o(E){cr(E,0);for(var R={},A=0;E.l<=E.length-4;){var P=E.read_shift(2),O=E.read_shift(2),L=E.l+O,Q={};switch(P){case 21589:A=E.read_shift(1),A&1&&(Q.mtime=E.read_shift(4)),O>5&&(A&2&&(Q.atime=E.read_shift(4)),A&4&&(Q.ctime=E.read_shift(4))),Q.mtime&&(Q.mt=new Date(Q.mtime*1e3));break}E.l=L,R[P]=Q}return R}var c;function u(){return c||(c={})}function d(E,R){if(E[0]==80&&E[1]==75)return hs(E,R);if((E[0]|32)==109&&(E[1]|32)==105)return Ro(E,R);if(E.length<512)throw new Error("CFB file size "+E.length+" < 512");var A=3,P=512,O=0,L=0,Q=0,ie=0,Y=0,Z=[],te=E.slice(0,512);cr(te,0);var xe=f(te);switch(A=xe[0],A){case 3:P=512;break;case 4:P=4096;break;case 0:if(xe[1]==0)return hs(E,R);default:throw new Error("Major Version: Expected 3 or 4 saw "+A)}P!==512&&(te=E.slice(0,P),cr(te,28));var be=E.slice(0,P);h(te,A);var Ne=te.read_shift(4,"i");if(A===3&&Ne!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ne);te.l+=4,Q=te.read_shift(4,"i"),te.l+=4,te.chk("00100000","Mini Stream Cutoff Size: "),ie=te.read_shift(4,"i"),O=te.read_shift(4,"i"),Y=te.read_shift(4,"i"),L=te.read_shift(4,"i");for(var ye=-1,Se=0;Se<109&&(ye=te.read_shift(4,"i"),!(ye<0));++Se)Z[Se]=ye;var $e=m(E,P);v(Y,L,$e,P,Z);var bt=w($e,Q,Z,P);bt[Q].name="!Directory",O>0&&ie!==q&&(bt[ie].name="!MiniFAT"),bt[Z[0]].name="!FAT",bt.fat_addrs=Z,bt.ssz=P;var St={},pr=[],Oo=[],Io=[];g(Q,bt,$e,pr,O,St,Oo,ie),p(Oo,Io,pr),pr.shift();var Do={FileIndex:Oo,FullPaths:Io};return R&&R.raw&&(Do.raw={header:be,sectors:$e}),Do}function f(E){if(E[E.l]==80&&E[E.l+1]==75)return[0,0];E.chk(re,"Header Signature: "),E.l+=16;var R=E.read_shift(2,"u");return[E.read_shift(2,"u"),R]}function h(E,R){var A=9;switch(E.l+=2,A=E.read_shift(2)){case 9:if(R!=3)throw new Error("Sector Shift: Expected 9 saw "+A);break;case 12:if(R!=4)throw new Error("Sector Shift: Expected 12 saw "+A);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+A)}E.chk("0600","Mini Sector Shift: "),E.chk("000000000000","Reserved: ")}function m(E,R){for(var A=Math.ceil(E.length/R)-1,P=[],O=1;O<A;++O)P[O-1]=E.slice(O*R,(O+1)*R);return P[A-1]=E.slice(A*R),P}function p(E,R,A){for(var P=0,O=0,L=0,Q=0,ie=0,Y=A.length,Z=[],te=[];P<Y;++P)Z[P]=te[P]=P,R[P]=A[P];for(;ie<te.length;++ie)P=te[ie],O=E[P].L,L=E[P].R,Q=E[P].C,Z[P]===P&&(O!==-1&&Z[O]!==O&&(Z[P]=Z[O]),L!==-1&&Z[L]!==L&&(Z[P]=Z[L])),Q!==-1&&(Z[Q]=P),O!==-1&&P!=Z[P]&&(Z[O]=Z[P],te.lastIndexOf(O)<ie&&te.push(O)),L!==-1&&P!=Z[P]&&(Z[L]=Z[P],te.lastIndexOf(L)<ie&&te.push(L));for(P=1;P<Y;++P)Z[P]===P&&(L!==-1&&Z[L]!==L?Z[P]=Z[L]:O!==-1&&Z[O]!==O&&(Z[P]=Z[O]));for(P=1;P<Y;++P)if(E[P].type!==0){if(ie=P,ie!=Z[ie])do ie=Z[ie],R[P]=R[ie]+"/"+R[P];while(ie!==0&&Z[ie]!==-1&&ie!=Z[ie]);Z[P]=-1}for(R[0]+="/",P=1;P<Y;++P)E[P].type!==2&&(R[P]+="/")}function x(E,R,A){for(var P=E.start,O=E.size,L=[],Q=P;A&&O>0&&Q>=0;)L.push(R.slice(Q*z,Q*z+z)),O-=z,Q=Fa(A,Q*4);return L.length===0?ae(0):rr(L).slice(0,E.size)}function v(E,R,A,P,O){var L=q;if(E===q){if(R!==0)throw new Error("DIFAT chain shorter than expected")}else if(E!==-1){var Q=A[E],ie=(P>>>2)-1;if(!Q)return;for(var Y=0;Y<ie&&(L=Fa(Q,Y*4))!==q;++Y)O.push(L);v(Fa(Q,P-4),R-1,A,P,O)}}function y(E,R,A,P,O){var L=[],Q=[];O||(O=[]);var ie=P-1,Y=0,Z=0;for(Y=R;Y>=0;){O[Y]=!0,L[L.length]=Y,Q.push(E[Y]);var te=A[Math.floor(Y*4/P)];if(Z=Y*4&ie,P<4+Z)throw new Error("FAT boundary crossed: "+Y+" 4 "+P);if(!E[te])break;Y=Fa(E[te],Z)}return{nodes:L,data:Ry([Q])}}function w(E,R,A,P){var O=E.length,L=[],Q=[],ie=[],Y=[],Z=P-1,te=0,xe=0,be=0,Ne=0;for(te=0;te<O;++te)if(ie=[],be=te+R,be>=O&&(be-=O),!Q[be]){Y=[];var ye=[];for(xe=be;xe>=0;){ye[xe]=!0,Q[xe]=!0,ie[ie.length]=xe,Y.push(E[xe]);var Se=A[Math.floor(xe*4/P)];if(Ne=xe*4&Z,P<4+Ne)throw new Error("FAT boundary crossed: "+xe+" 4 "+P);if(!E[Se]||(xe=Fa(E[Se],Ne),ye[xe]))break}L[be]={nodes:ie,data:Ry([Y])}}return L}function g(E,R,A,P,O,L,Q,ie){for(var Y=0,Z=P.length?2:0,te=R[E].data,xe=0,be=0,Ne;xe<te.length;xe+=128){var ye=te.slice(xe,xe+128);cr(ye,64),be=ye.read_shift(2),Ne=Px(ye,0,be-Z),P.push(Ne);var Se={name:Ne,type:ye.read_shift(1),color:ye.read_shift(1),L:ye.read_shift(4,"i"),R:ye.read_shift(4,"i"),C:ye.read_shift(4,"i"),clsid:ye.read_shift(16),state:ye.read_shift(4,"i"),start:0,size:0},$e=ye.read_shift(2)+ye.read_shift(2)+ye.read_shift(2)+ye.read_shift(2);$e!==0&&(Se.ct=_(ye,ye.l-8));var bt=ye.read_shift(2)+ye.read_shift(2)+ye.read_shift(2)+ye.read_shift(2);bt!==0&&(Se.mt=_(ye,ye.l-8)),Se.start=ye.read_shift(4,"i"),Se.size=ye.read_shift(4,"i"),Se.size<0&&Se.start<0&&(Se.size=Se.type=0,Se.start=q,Se.name=""),Se.type===5?(Y=Se.start,O>0&&Y!==q&&(R[Y].name="!StreamData")):Se.size>=4096?(Se.storage="fat",R[Se.start]===void 0&&(R[Se.start]=y(A,Se.start,R.fat_addrs,R.ssz)),R[Se.start].name=Se.name,Se.content=R[Se.start].data.slice(0,Se.size)):(Se.storage="minifat",Se.size<0?Se.size=0:Y!==q&&Se.start!==q&&R[Y]&&(Se.content=x(Se,R[Y].data,(R[ie]||{}).data))),Se.content&&cr(Se.content,0),L[Ne]=Se,Q.push(Se)}}function _(E,R){return new Date((es(E,R+4)/1e7*Math.pow(2,32)+es(E,R)/1e7-11644473600)*1e3)}function b(E,R){return u(),d(c.readFileSync(E),R)}function k(E,R){var A=R&&R.type;switch(A||qe&&Buffer.isBuffer(E)&&(A="buffer"),A||"base64"){case"file":return b(E,R);case"base64":return d(ss(cs(E)),R);case"binary":return d(ss(E),R)}return d(E,R)}function S(E,R){var A=R||{},P=A.root||"Root Entry";if(E.FullPaths||(E.FullPaths=[]),E.FileIndex||(E.FileIndex=[]),E.FullPaths.length!==E.FileIndex.length)throw new Error("inconsistent CFB structure");E.FullPaths.length===0&&(E.FullPaths[0]=P+"/",E.FileIndex[0]={name:P,type:5}),A.CLSID&&(E.FileIndex[0].clsid=A.CLSID),T(E)}function T(E){var R="Sh33tJ5";if(!Re.find(E,"/"+R)){var A=ae(4);A[0]=55,A[1]=A[3]=50,A[2]=54,E.FileIndex.push({name:R,type:2,content:A,size:4,L:69,R:69,C:69}),E.FullPaths.push(E.FullPaths[0]+R),j(E)}}function j(E,R){S(E);for(var A=!1,P=!1,O=E.FullPaths.length-1;O>=0;--O){var L=E.FileIndex[O];switch(L.type){case 0:P?A=!0:(E.FileIndex.pop(),E.FullPaths.pop());break;case 1:case 2:case 5:P=!0,isNaN(L.R*L.L*L.C)&&(A=!0),L.R>-1&&L.L>-1&&L.R==L.L&&(A=!0);break;default:A=!0;break}}if(!(!A&&!R)){var Q=new Date(1987,1,19),ie=0,Y=Object.create?Object.create(null):{},Z=[];for(O=0;O<E.FullPaths.length;++O)Y[E.FullPaths[O]]=!0,E.FileIndex[O].type!==0&&Z.push([E.FullPaths[O],E.FileIndex[O]]);for(O=0;O<Z.length;++O){var te=s(Z[O][0]);P=Y[te],P||(Z.push([te,{name:n(te).replace("/",""),type:1,clsid:M,ct:Q,mt:Q,content:null}]),Y[te]=!0)}for(Z.sort(function(Ne,ye){return r(Ne[0],ye[0])}),E.FullPaths=[],E.FileIndex=[],O=0;O<Z.length;++O)E.FullPaths[O]=Z[O][0],E.FileIndex[O]=Z[O][1];for(O=0;O<Z.length;++O){var xe=E.FileIndex[O],be=E.FullPaths[O];if(xe.name=n(be).replace("/",""),xe.L=xe.R=xe.C=-(xe.color=1),xe.size=xe.content?xe.content.length:0,xe.start=0,xe.clsid=xe.clsid||M,O===0)xe.C=Z.length>1?1:-1,xe.size=0,xe.type=5;else if(be.slice(-1)=="/"){for(ie=O+1;ie<Z.length&&s(E.FullPaths[ie])!=be;++ie);for(xe.C=ie>=Z.length?-1:ie,ie=O+1;ie<Z.length&&s(E.FullPaths[ie])!=s(be);++ie);xe.R=ie>=Z.length?-1:ie,xe.type=1}else s(E.FullPaths[O+1]||"")==s(be)&&(xe.R=O+1),xe.type=2}}}function U(E,R){var A=R||{};if(A.fileType=="mad")return lg(E,A);switch(j(E),A.fileType){case"zip":return Yr(E,A)}var P=function(Ne){for(var ye=0,Se=0,$e=0;$e<Ne.FileIndex.length;++$e){var bt=Ne.FileIndex[$e];if(bt.content){var St=bt.content.length;St>0&&(St<4096?ye+=St+63>>6:Se+=St+511>>9)}}for(var pr=Ne.FullPaths.length+3>>2,Oo=ye+7>>3,Io=ye+127>>7,Do=Oo+Se+pr+Io,wa=Do+127>>7,b0=wa<=109?0:Math.ceil((wa-109)/127);Do+wa+b0+127>>7>wa;)b0=++wa<=109?0:Math.ceil((wa-109)/127);var hn=[1,b0,wa,Io,pr,Se,ye,0];return Ne.FileIndex[0].size=ye<<6,hn[7]=(Ne.FileIndex[0].start=hn[0]+hn[1]+hn[2]+hn[3]+hn[4]+hn[5])+(hn[6]+7>>3),hn}(E),O=ae(P[7]<<9),L=0,Q=0;{for(L=0;L<8;++L)O.write_shift(1,X[L]);for(L=0;L<8;++L)O.write_shift(2,0);for(O.write_shift(2,62),O.write_shift(2,3),O.write_shift(2,65534),O.write_shift(2,9),O.write_shift(2,6),L=0;L<3;++L)O.write_shift(2,0);for(O.write_shift(4,0),O.write_shift(4,P[2]),O.write_shift(4,P[0]+P[1]+P[2]+P[3]-1),O.write_shift(4,0),O.write_shift(4,4096),O.write_shift(4,P[3]?P[0]+P[1]+P[2]-1:q),O.write_shift(4,P[3]),O.write_shift(-4,P[1]?P[0]-1:q),O.write_shift(4,P[1]),L=0;L<109;++L)O.write_shift(-4,L<P[2]?P[1]+L:-1)}if(P[1])for(Q=0;Q<P[1];++Q){for(;L<236+Q*127;++L)O.write_shift(-4,L<P[2]?P[1]+L:-1);O.write_shift(-4,Q===P[1]-1?q:Q+1)}var ie=function(Ne){for(Q+=Ne;L<Q-1;++L)O.write_shift(-4,L+1);Ne&&(++L,O.write_shift(-4,q))};for(Q=L=0,Q+=P[1];L<Q;++L)O.write_shift(-4,J.DIFSECT);for(Q+=P[2];L<Q;++L)O.write_shift(-4,J.FATSECT);ie(P[3]),ie(P[4]);for(var Y=0,Z=0,te=E.FileIndex[0];Y<E.FileIndex.length;++Y)te=E.FileIndex[Y],te.content&&(Z=te.content.length,!(Z<4096)&&(te.start=Q,ie(Z+511>>9)));for(ie(P[6]+7>>3);O.l&511;)O.write_shift(-4,J.ENDOFCHAIN);for(Q=L=0,Y=0;Y<E.FileIndex.length;++Y)te=E.FileIndex[Y],te.content&&(Z=te.content.length,!(!Z||Z>=4096)&&(te.start=Q,ie(Z+63>>6)));for(;O.l&511;)O.write_shift(-4,J.ENDOFCHAIN);for(L=0;L<P[4]<<2;++L){var xe=E.FullPaths[L];if(!xe||xe.length===0){for(Y=0;Y<17;++Y)O.write_shift(4,0);for(Y=0;Y<3;++Y)O.write_shift(4,-1);for(Y=0;Y<12;++Y)O.write_shift(4,0);continue}te=E.FileIndex[L],L===0&&(te.start=te.size?te.start-1:q);var be=L===0&&A.root||te.name;if(Z=2*(be.length+1),O.write_shift(64,be,"utf16le"),O.write_shift(2,Z),O.write_shift(1,te.type),O.write_shift(1,te.color),O.write_shift(-4,te.L),O.write_shift(-4,te.R),O.write_shift(-4,te.C),te.clsid)O.write_shift(16,te.clsid,"hex");else for(Y=0;Y<4;++Y)O.write_shift(4,0);O.write_shift(4,te.state||0),O.write_shift(4,0),O.write_shift(4,0),O.write_shift(4,0),O.write_shift(4,0),O.write_shift(4,te.start),O.write_shift(4,te.size),O.write_shift(4,0)}for(L=1;L<E.FileIndex.length;++L)if(te=E.FileIndex[L],te.size>=4096)if(O.l=te.start+1<<9,qe&&Buffer.isBuffer(te.content))te.content.copy(O,O.l,0,te.size),O.l+=te.size+511&-512;else{for(Y=0;Y<te.size;++Y)O.write_shift(1,te.content[Y]);for(;Y&511;++Y)O.write_shift(1,0)}for(L=1;L<E.FileIndex.length;++L)if(te=E.FileIndex[L],te.size>0&&te.size<4096)if(qe&&Buffer.isBuffer(te.content))te.content.copy(O,O.l,0,te.size),O.l+=te.size+63&-64;else{for(Y=0;Y<te.size;++Y)O.write_shift(1,te.content[Y]);for(;Y&63;++Y)O.write_shift(1,0)}if(qe)O.l=O.length;else for(;O.l<O.length;)O.write_shift(1,0);return O}function H(E,R){var A=E.FullPaths.map(function(Y){return Y.toUpperCase()}),P=A.map(function(Y){var Z=Y.split("/");return Z[Z.length-(Y.slice(-1)=="/"?2:1)]}),O=!1;R.charCodeAt(0)===47?(O=!0,R=A[0].slice(0,-1)+R):O=R.indexOf("/")!==-1;var L=R.toUpperCase(),Q=O===!0?A.indexOf(L):P.indexOf(L);if(Q!==-1)return E.FileIndex[Q];var ie=!L.match(el);for(L=L.replace(Lr,""),ie&&(L=L.replace(el,"!")),Q=0;Q<A.length;++Q)if((ie?A[Q].replace(el,"!"):A[Q]).replace(Lr,"")==L||(ie?P[Q].replace(el,"!"):P[Q]).replace(Lr,"")==L)return E.FileIndex[Q];return null}var z=64,q=-2,re="d0cf11e0a1b11ae1",X=[208,207,17,224,161,177,26,225],M="00000000000000000000000000000000",J={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:q,FREESECT:-1,HEADER_SIGNATURE:re,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:M,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function G(E,R,A){u();var P=U(E,A);c.writeFileSync(R,P)}function D(E){for(var R=new Array(E.length),A=0;A<E.length;++A)R[A]=String.fromCharCode(E[A]);return R.join("")}function K(E,R){var A=U(E,R);switch(R&&R.type||"buffer"){case"file":return u(),c.writeFileSync(R.filename,A),A;case"binary":return typeof A=="string"?A:D(A);case"base64":return rc(typeof A=="string"?A:D(A));case"buffer":if(qe)return Buffer.isBuffer(A)?A:On(A);case"array":return typeof A=="string"?ss(A):A}return A}var oe;function N(E){try{var R=E.InflateRaw,A=new R;if(A._processChunk(new Uint8Array([3,0]),A._finishFlushFlag),A.bytesRead)oe=E;else throw new Error("zlib does not expose bytesRead")}catch(P){console.error("cannot use native zlib: "+(P.message||P))}}function W(E,R){if(!oe)return Cr(E,R);var A=oe.InflateRaw,P=new A,O=P._processChunk(E.slice(E.l),P._finishFlushFlag);return E.l+=P.bytesRead,O}function I(E){return oe?oe.deflateRawSync(E):Ce(E)}var B=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ee=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],le=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function fe(E){var R=(E<<1|E<<11)&139536|(E<<5|E<<15)&558144;return(R>>16|R>>8|R)&255}for(var se=typeof Uint8Array<"u",ne=se?new Uint8Array(256):[],V=0;V<256;++V)ne[V]=fe(V);function C(E,R){var A=ne[E&255];return R<=8?A>>>8-R:(A=A<<8|ne[E>>8&255],R<=16?A>>>16-R:(A=A<<8|ne[E>>16&255],A>>>24-R))}function he(E,R){var A=R&7,P=R>>>3;return(E[P]|(A<=6?0:E[P+1]<<8))>>>A&3}function ve(E,R){var A=R&7,P=R>>>3;return(E[P]|(A<=5?0:E[P+1]<<8))>>>A&7}function ke(E,R){var A=R&7,P=R>>>3;return(E[P]|(A<=4?0:E[P+1]<<8))>>>A&15}function Ae(E,R){var A=R&7,P=R>>>3;return(E[P]|(A<=3?0:E[P+1]<<8))>>>A&31}function me(E,R){var A=R&7,P=R>>>3;return(E[P]|(A<=1?0:E[P+1]<<8))>>>A&127}function Ke(E,R,A){var P=R&7,O=R>>>3,L=(1<<A)-1,Q=E[O]>>>P;return A<8-P||(Q|=E[O+1]<<8-P,A<16-P)||(Q|=E[O+2]<<16-P,A<24-P)||(Q|=E[O+3]<<24-P),Q&L}function de(E,R,A){var P=R&7,O=R>>>3;return P<=5?E[O]|=(A&7)<<P:(E[O]|=A<<P&255,E[O+1]=(A&7)>>8-P),R+3}function Ee(E,R,A){var P=R&7,O=R>>>3;return A=(A&1)<<P,E[O]|=A,R+1}function Oe(E,R,A){var P=R&7,O=R>>>3;return A<<=P,E[O]|=A&255,A>>>=8,E[O+1]=A,R+8}function Me(E,R,A){var P=R&7,O=R>>>3;return A<<=P,E[O]|=A&255,A>>>=8,E[O+1]=A&255,E[O+2]=A>>>8,R+16}function We(E,R){var A=E.length,P=2*A>R?2*A:R+5,O=0;if(A>=R)return E;if(qe){var L=py(P);if(E.copy)E.copy(L);else for(;O<E.length;++O)L[O]=E[O];return L}else if(se){var Q=new Uint8Array(P);if(Q.set)Q.set(E);else for(;O<A;++O)Q[O]=E[O];return Q}return E.length=P,E}function Ye(E){for(var R=new Array(E),A=0;A<E;++A)R[A]=0;return R}function xt(E,R,A){var P=1,O=0,L=0,Q=0,ie=0,Y=E.length,Z=se?new Uint16Array(32):Ye(32);for(L=0;L<32;++L)Z[L]=0;for(L=Y;L<A;++L)E[L]=0;Y=E.length;var te=se?new Uint16Array(Y):Ye(Y);for(L=0;L<Y;++L)Z[O=E[L]]++,P<O&&(P=O),te[L]=0;for(Z[0]=0,L=1;L<=P;++L)Z[L+16]=ie=ie+Z[L-1]<<1;for(L=0;L<Y;++L)ie=E[L],ie!=0&&(te[L]=Z[ie+16]++);var xe=0;for(L=0;L<Y;++L)if(xe=E[L],xe!=0)for(ie=C(te[L],P)>>P-xe,Q=(1<<P+4-xe)-1;Q>=0;--Q)R[ie|Q<<xe]=xe&15|L<<4;return P}var jr=se?new Uint16Array(512):Ye(512),Ys=se?new Uint16Array(32):Ye(32);if(!se){for(var Kt=0;Kt<512;++Kt)jr[Kt]=0;for(Kt=0;Kt<32;++Kt)Ys[Kt]=0}(function(){for(var E=[],R=0;R<32;R++)E.push(5);xt(E,Ys,32);var A=[];for(R=0;R<=143;R++)A.push(8);for(;R<=255;R++)A.push(9);for(;R<=279;R++)A.push(7);for(;R<=287;R++)A.push(8);xt(A,jr,288)})();var Ur=function(){for(var R=se?new Uint8Array(32768):[],A=0,P=0;A<le.length-1;++A)for(;P<le[A+1];++P)R[P]=A;for(;P<32768;++P)R[P]=29;var O=se?new Uint8Array(259):[];for(A=0,P=0;A<ee.length-1;++A)for(;P<ee[A+1];++P)O[P]=A;function L(ie,Y){for(var Z=0;Z<ie.length;){var te=Math.min(65535,ie.length-Z),xe=Z+te==ie.length;for(Y.write_shift(1,+xe),Y.write_shift(2,te),Y.write_shift(2,~te&65535);te-- >0;)Y[Y.l++]=ie[Z++]}return Y.l}function Q(ie,Y){for(var Z=0,te=0,xe=se?new Uint16Array(32768):[];te<ie.length;){var be=Math.min(65535,ie.length-te);if(be<10){for(Z=de(Y,Z,+(te+be==ie.length)),Z&7&&(Z+=8-(Z&7)),Y.l=Z/8|0,Y.write_shift(2,be),Y.write_shift(2,~be&65535);be-- >0;)Y[Y.l++]=ie[te++];Z=Y.l*8;continue}Z=de(Y,Z,+(te+be==ie.length)+2);for(var Ne=0;be-- >0;){var ye=ie[te];Ne=(Ne<<5^ye)&32767;var Se=-1,$e=0;if((Se=xe[Ne])&&(Se|=te&-32768,Se>te&&(Se-=32768),Se<te))for(;ie[Se+$e]==ie[te+$e]&&$e<250;)++$e;if($e>2){ye=O[$e],ye<=22?Z=Oe(Y,Z,ne[ye+1]>>1)-1:(Oe(Y,Z,3),Z+=5,Oe(Y,Z,ne[ye-23]>>5),Z+=3);var bt=ye<8?0:ye-4>>2;bt>0&&(Me(Y,Z,$e-ee[ye]),Z+=bt),ye=R[te-Se],Z=Oe(Y,Z,ne[ye]>>3),Z-=3;var St=ye<4?0:ye-2>>1;St>0&&(Me(Y,Z,te-Se-le[ye]),Z+=St);for(var pr=0;pr<$e;++pr)xe[Ne]=te&32767,Ne=(Ne<<5^ie[te])&32767,++te;be-=$e-1}else ye<=143?ye=ye+48:Z=Ee(Y,Z,1),Z=Oe(Y,Z,ne[ye]),xe[Ne]=te&32767,++te}Z=Oe(Y,Z,0)-1}return Y.l=(Z+7)/8|0,Y.l}return function(Y,Z){return Y.length<8?L(Y,Z):Q(Y,Z)}}();function Ce(E){var R=ae(50+Math.floor(E.length*1.1)),A=Ur(E,R);return R.slice(0,A)}var rt=se?new Uint16Array(32768):Ye(32768),hr=se?new Uint16Array(32768):Ye(32768),wt=se?new Uint16Array(128):Ye(128),fs=1,ue=1;function Ve(E,R){var A=Ae(E,R)+257;R+=5;var P=Ae(E,R)+1;R+=5;var O=ke(E,R)+4;R+=4;for(var L=0,Q=se?new Uint8Array(19):Ye(19),ie=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Y=1,Z=se?new Uint8Array(8):Ye(8),te=se?new Uint8Array(8):Ye(8),xe=Q.length,be=0;be<O;++be)Q[B[be]]=L=ve(E,R),Y<L&&(Y=L),Z[L]++,R+=3;var Ne=0;for(Z[0]=0,be=1;be<=Y;++be)te[be]=Ne=Ne+Z[be-1]<<1;for(be=0;be<xe;++be)(Ne=Q[be])!=0&&(ie[be]=te[Ne]++);var ye=0;for(be=0;be<xe;++be)if(ye=Q[be],ye!=0){Ne=ne[ie[be]]>>8-ye;for(var Se=(1<<7-ye)-1;Se>=0;--Se)wt[Ne|Se<<ye]=ye&7|be<<3}var $e=[];for(Y=1;$e.length<A+P;)switch(Ne=wt[me(E,R)],R+=Ne&7,Ne>>>=3){case 16:for(L=3+he(E,R),R+=2,Ne=$e[$e.length-1];L-- >0;)$e.push(Ne);break;case 17:for(L=3+ve(E,R),R+=3;L-- >0;)$e.push(0);break;case 18:for(L=11+me(E,R),R+=7;L-- >0;)$e.push(0);break;default:$e.push(Ne),Y<Ne&&(Y=Ne);break}var bt=$e.slice(0,A),St=$e.slice(A);for(be=A;be<286;++be)bt[be]=0;for(be=P;be<30;++be)St[be]=0;return fs=xt(bt,rt,286),ue=xt(St,hr,30),R}function _t(E,R){if(E[0]==3&&!(E[1]&3))return[la(R),2];for(var A=0,P=0,O=py(R||1<<18),L=0,Q=O.length>>>0,ie=0,Y=0;!(P&1);){if(P=ve(E,A),A+=3,P>>>1)P>>1==1?(ie=9,Y=5):(A=Ve(E,A),ie=fs,Y=ue);else{A&7&&(A+=8-(A&7));var Z=E[A>>>3]|E[(A>>>3)+1]<<8;if(A+=32,Z>0)for(!R&&Q<L+Z&&(O=We(O,L+Z),Q=O.length);Z-- >0;)O[L++]=E[A>>>3],A+=8;continue}for(;;){!R&&Q<L+32767&&(O=We(O,L+32767),Q=O.length);var te=Ke(E,A,ie),xe=P>>>1==1?jr[te]:rt[te];if(A+=xe&15,xe>>>=4,!(xe>>>8&255))O[L++]=xe;else{if(xe==256)break;xe-=257;var be=xe<8?0:xe-4>>2;be>5&&(be=0);var Ne=L+ee[xe];be>0&&(Ne+=Ke(E,A,be),A+=be),te=Ke(E,A,Y),xe=P>>>1==1?Ys[te]:hr[te],A+=xe&15,xe>>>=4;var ye=xe<4?0:xe-2>>1,Se=le[xe];for(ye>0&&(Se+=Ke(E,A,ye),A+=ye),!R&&Q<Ne&&(O=We(O,Ne+100),Q=O.length);L<Ne;)O[L]=O[L-Se],++L}}}return R?[O,A+7>>>3]:[O.slice(0,L),A+7>>>3]}function Cr(E,R){var A=E.slice(E.l||0),P=_t(A,R);return E.l+=P[1],P[0]}function $t(E,R){if(E)typeof console<"u"&&console.error(R);else throw new Error(R)}function hs(E,R){var A=E;cr(A,0);var P=[],O=[],L={FileIndex:P,FullPaths:O};S(L,{root:R.root});for(var Q=A.length-4;(A[Q]!=80||A[Q+1]!=75||A[Q+2]!=5||A[Q+3]!=6)&&Q>=0;)--Q;A.l=Q+4,A.l+=4;var ie=A.read_shift(2);A.l+=6;var Y=A.read_shift(4);for(A.l=Y,Q=0;Q<ie;++Q){A.l+=20;var Z=A.read_shift(4),te=A.read_shift(4),xe=A.read_shift(2),be=A.read_shift(2),Ne=A.read_shift(2);A.l+=8;var ye=A.read_shift(4),Se=o(A.slice(A.l+xe,A.l+xe+be));A.l+=xe+be+Ne;var $e=A.l;A.l=ye+4,fn(A,Z,te,L,Se),A.l=$e}return L}function fn(E,R,A,P,O){E.l+=2;var L=E.read_shift(2),Q=E.read_shift(2),ie=i(E);if(L&8257)throw new Error("Unsupported ZIP encryption");for(var Y=E.read_shift(4),Z=E.read_shift(4),te=E.read_shift(4),xe=E.read_shift(2),be=E.read_shift(2),Ne="",ye=0;ye<xe;++ye)Ne+=String.fromCharCode(E[E.l++]);if(be){var Se=o(E.slice(E.l,E.l+be));(Se[21589]||{}).mt&&(ie=Se[21589].mt),((O||{})[21589]||{}).mt&&(ie=O[21589].mt)}E.l+=be;var $e=E.slice(E.l,E.l+Z);switch(Q){case 8:$e=W(E,te);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Q)}var bt=!1;L&8&&(Y=E.read_shift(4),Y==134695760&&(Y=E.read_shift(4),bt=!0),Z=E.read_shift(4),te=E.read_shift(4)),Z!=R&&$t(bt,"Bad compressed size: "+R+" != "+Z),te!=A&&$t(bt,"Bad uncompressed size: "+A+" != "+te),Ic(P,Ne,$e,{unsafe:!0,mt:ie})}function Yr(E,R){var A=R||{},P=[],O=[],L=ae(1),Q=A.compression?8:0,ie=0,Y=0,Z=0,te=0,xe=0,be=E.FullPaths[0],Ne=be,ye=E.FileIndex[0],Se=[],$e=0;for(Y=1;Y<E.FullPaths.length;++Y)if(Ne=E.FullPaths[Y].slice(be.length),ye=E.FileIndex[Y],!(!ye.size||!ye.content||Ne=="Sh33tJ5")){var bt=te,St=ae(Ne.length);for(Z=0;Z<Ne.length;++Z)St.write_shift(1,Ne.charCodeAt(Z)&127);St=St.slice(0,St.l),Se[xe]=eO.buf(ye.content,0);var pr=ye.content;Q==8&&(pr=I(pr)),L=ae(30),L.write_shift(4,67324752),L.write_shift(2,20),L.write_shift(2,ie),L.write_shift(2,Q),ye.mt?a(L,ye.mt):L.write_shift(4,0),L.write_shift(-4,Se[xe]),L.write_shift(4,pr.length),L.write_shift(4,ye.content.length),L.write_shift(2,St.length),L.write_shift(2,0),te+=L.length,P.push(L),te+=St.length,P.push(St),te+=pr.length,P.push(pr),L=ae(46),L.write_shift(4,33639248),L.write_shift(2,0),L.write_shift(2,20),L.write_shift(2,ie),L.write_shift(2,Q),L.write_shift(4,0),L.write_shift(-4,Se[xe]),L.write_shift(4,pr.length),L.write_shift(4,ye.content.length),L.write_shift(2,St.length),L.write_shift(2,0),L.write_shift(2,0),L.write_shift(2,0),L.write_shift(2,0),L.write_shift(4,0),L.write_shift(4,bt),$e+=L.l,O.push(L),$e+=St.length,O.push(St),++xe}return L=ae(22),L.write_shift(4,101010256),L.write_shift(2,0),L.write_shift(2,0),L.write_shift(2,xe),L.write_shift(2,xe),L.write_shift(4,$e),L.write_shift(4,te),L.write_shift(2,0),rr([rr(P),rr(O),L])}var Je={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function fi(E,R){if(E.ctype)return E.ctype;var A=E.name||"",P=A.match(/\.([^\.]+)$/);return P&&Je[P[1]]||R&&(P=(A=R).match(/[\.\\]([^\.\\])+$/),P&&Je[P[1]])?Je[P[1]]:"application/octet-stream"}function v0(E){for(var R=rc(E),A=[],P=0;P<R.length;P+=76)A.push(R.slice(P,P+76));return A.join(`\r
`)+`\r
`}function y0(E){var R=E.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Z){var te=Z.charCodeAt(0).toString(16).toUpperCase();return"="+(te.length==1?"0"+te:te)});R=R.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),R.charAt(0)==`
`&&(R="=0D"+R.slice(1)),R=R.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var A=[],P=R.split(`\r
`),O=0;O<P.length;++O){var L=P[O];if(L.length==0){A.push("");continue}for(var Q=0;Q<L.length;){var ie=76,Y=L.slice(Q,Q+ie);Y.charAt(ie-1)=="="?ie--:Y.charAt(ie-2)=="="?ie-=2:Y.charAt(ie-3)=="="&&(ie-=3),Y=L.slice(Q,Q+ie),Q+=ie,Q<L.length&&(Y+="="),A.push(Y)}}return A.join(`\r
`)}function Oc(E){for(var R=[],A=0;A<E.length;++A){for(var P=E[A];A<=E.length&&P.charAt(P.length-1)=="=";)P=P.slice(0,P.length-1)+E[++A];R.push(P)}for(var O=0;O<R.length;++O)R[O]=R[O].replace(/[=][0-9A-Fa-f]{2}/g,function(L){return String.fromCharCode(parseInt(L.slice(1),16))});return ss(R.join(`\r
`))}function w0(E,R,A){for(var P="",O="",L="",Q,ie=0;ie<10;++ie){var Y=R[ie];if(!Y||Y.match(/^\s*$/))break;var Z=Y.match(/^(.*?):\s*([^\s].*)$/);if(Z)switch(Z[1].toLowerCase()){case"content-location":P=Z[2].trim();break;case"content-type":L=Z[2].trim();break;case"content-transfer-encoding":O=Z[2].trim();break}}switch(++ie,O.toLowerCase()){case"base64":Q=ss(cs(R.slice(ie).join("")));break;case"quoted-printable":Q=Oc(R.slice(ie));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+O)}var te=Ic(E,P.slice(A.length),Q,{unsafe:!0});L&&(te.ctype=L)}function Ro(E,R){if(D(E.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var A=R&&R.root||"",P=(qe&&Buffer.isBuffer(E)?E.toString("binary"):D(E)).split(`\r
`),O=0,L="";for(O=0;O<P.length;++O)if(L=P[O],!!/^Content-Location:/i.test(L)&&(L=L.slice(L.indexOf("file")),A||(A=L.slice(0,L.lastIndexOf("/")+1)),L.slice(0,A.length)!=A))for(;A.length>0&&(A=A.slice(0,A.length-1),A=A.slice(0,A.lastIndexOf("/")+1),L.slice(0,A.length)!=A););var Q=(P[1]||"").match(/boundary="(.*?)"/);if(!Q)throw new Error("MAD cannot find boundary");var ie="--"+(Q[1]||""),Y=[],Z=[],te={FileIndex:Y,FullPaths:Z};S(te);var xe,be=0;for(O=0;O<P.length;++O){var Ne=P[O];Ne!==ie&&Ne!==ie+"--"||(be++&&w0(te,P.slice(xe,O),A),xe=O)}return te}function lg(E,R){var A=R||{},P=A.boundary||"SheetJS";P="------="+P;for(var O=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+P.slice(2)+'"',"","",""],L=E.FullPaths[0],Q=L,ie=E.FileIndex[0],Y=1;Y<E.FullPaths.length;++Y)if(Q=E.FullPaths[Y].slice(L.length),ie=E.FileIndex[Y],!(!ie.size||!ie.content||Q=="Sh33tJ5")){Q=Q.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function($e){return"_x"+$e.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function($e){return"_u"+$e.charCodeAt(0).toString(16)+"_"});for(var Z=ie.content,te=qe&&Buffer.isBuffer(Z)?Z.toString("binary"):D(Z),xe=0,be=Math.min(1024,te.length),Ne=0,ye=0;ye<=be;++ye)(Ne=te.charCodeAt(ye))>=32&&Ne<128&&++xe;var Se=xe>=be*4/5;O.push(P),O.push("Content-Location: "+(A.root||"file:///C:/SheetJS/")+Q),O.push("Content-Transfer-Encoding: "+(Se?"quoted-printable":"base64")),O.push("Content-Type: "+fi(ie,Q)),O.push(""),O.push(Se?y0(te):v0(te))}return O.push(P+`--\r
`),O.join(`\r
`)}function cg(E){var R={};return S(R,E),R}function Ic(E,R,A,P){var O=P&&P.unsafe;O||S(E);var L=!O&&Re.find(E,R);if(!L){var Q=E.FullPaths[0];R.slice(0,Q.length)==Q?Q=R:(Q.slice(-1)!="/"&&(Q+="/"),Q=(Q+R).replace("//","/")),L={name:n(R),type:2},E.FileIndex.push(L),E.FullPaths.push(Q),O||Re.utils.cfb_gc(E)}return L.content=A,L.size=A?A.length:0,P&&(P.CLSID&&(L.clsid=P.CLSID),P.mt&&(L.mt=P.mt),P.ct&&(L.ct=P.ct)),L}function ug(E,R){S(E);var A=Re.find(E,R);if(A){for(var P=0;P<E.FileIndex.length;++P)if(E.FileIndex[P]==A)return E.FileIndex.splice(P,1),E.FullPaths.splice(P,1),!0}return!1}function _0(E,R,A){S(E);var P=Re.find(E,R);if(P){for(var O=0;O<E.FileIndex.length;++O)if(E.FileIndex[O]==P)return E.FileIndex[O].name=n(A),E.FullPaths[O]=A,!0}return!1}function Dc(E){j(E,!0)}return t.find=H,t.read=k,t.parse=d,t.write=K,t.writeFile=G,t.utils={cfb_new:cg,cfb_add:Ic,cfb_del:ug,cfb_mov:_0,cfb_gc:Dc,ReadShift:vl,CheckField:fE,prep_blob:cr,bconcat:rr,use_zlib:N,_deflateRaw:Ce,_inflateRaw:Cr,consts:J},t}();function tO(e){return typeof e=="string"?c0(e):Array.isArray(e)?NR(e):e}function Tc(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=c0(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var s=r=="utf8"?sn(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(s,e);if(typeof Blob<"u"){var n=new Blob([tO(s)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(n,e);if(typeof saveAs<"u")return saveAs(n,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var a=URL.createObjectURL(n);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),chrome.downloads.download({url:a,filename:e,saveAs:!0});var i=document.createElement("a");if(i.download!=null)return i.download=e,i.href=a,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),a}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=ga(t)),o.write(t),o.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function rO(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(s){if(!s.message||!s.message.match(/onstruct/))throw s}throw new Error("Cannot access file "+e)}function It(e){for(var t=Object.keys(e),r=[],s=0;s<t.length;++s)Object.prototype.hasOwnProperty.call(e,t[s])&&r.push(t[s]);return r}function by(e,t){for(var r=[],s=It(e),n=0;n!==s.length;++n)r[e[s[n]][t]]==null&&(r[e[s[n]][t]]=s[n]);return r}function d0(e){for(var t=[],r=It(e),s=0;s!==r.length;++s)t[e[r[s]]]=r[s];return t}function f0(e){for(var t=[],r=It(e),s=0;s!==r.length;++s)t[e[r[s]]]=parseInt(r[s],10);return t}function sO(e){for(var t=[],r=It(e),s=0;s!==r.length;++s)t[e[r[s]]]==null&&(t[e[r[s]]]=[]),t[e[r[s]]].push(r[s]);return t}var Cd=new Date(1899,11,30,0,0,0);function Zt(e,t){var r=e.getTime(),s=Cd.getTime()+(e.getTimezoneOffset()-Cd.getTimezoneOffset())*6e4;return(r-s)/(24*60*60*1e3)}var Hk=new Date,nO=Cd.getTime()+(Hk.getTimezoneOffset()-Cd.getTimezoneOffset())*6e4,Sy=Hk.getTimezoneOffset();function h0(e){var t=new Date;return t.setTime(e*24*60*60*1e3+nO),t.getTimezoneOffset()!==Sy&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Sy)*6e4),t}function aO(e){var t=0,r=0,s=!1,n=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!n)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var a=1;a!=n.length;++a)if(n[a]){switch(r=1,a>3&&(s=!0),n[a].slice(n[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+n[a].slice(n[a].length-1));case"D":r*=24;case"H":r*=60;case"M":if(s)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(n[a],10)}return t}var ky=new Date("2017-02-19T19:06:09.000Z"),qk=isNaN(ky.getFullYear())?new Date("2/19/17"):ky,iO=qk.getFullYear()==2017;function pt(e,t){var r=new Date(e);if(iO)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(qk.getFullYear()==1917&&!isNaN(r.getFullYear())){var s=r.getFullYear();return e.indexOf(""+s)>-1||r.setFullYear(r.getFullYear()+100),r}var n=e.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function Za(e,t){if(qe&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return sn(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return sn(Rk(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return sn(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return sn(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(a){return r[a]||a})}catch{}for(var s=[],n=0;n!=e.length;++n)s.push(String.fromCharCode(e[n]));return s.join("")}function mt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=mt(e[r]));return t}function Rt(e,t){for(var r="";r.length<t;)r+=e;return r}function Gs(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,s=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(s))||(s=s.replace(/[(](.*)[)]/,function(n,a){return r=-r,a}),!isNaN(t=Number(s)))?t/r:t}var oO=["january","february","march","april","may","june","july","august","september","october","november","december"];function xo(e){var t=new Date(e),r=new Date(NaN),s=t.getYear(),n=t.getMonth(),a=t.getDate();if(isNaN(a))return r;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&oO.indexOf(i)==-1)return r}else if(i.match(/[a-z]/))return r;return s<0||s>8099?r:(n>0||a>1)&&s!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var lO=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,s,n){if(e||typeof s=="string")return r.split(s);for(var a=r.split(s),i=[a[0]],o=1;o<a.length;++o)i.push(n),i.push(a[o]);return i}}();function Gk(e){return e?e.content&&e.type?Za(e.content,!0):e.data?Zo(e.data):e.asNodeBuffer&&qe?Zo(e.asNodeBuffer().toString("binary")):e.asBinary?Zo(e.asBinary()):e._data&&e._data.getContent?Zo(Za(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function Kk(e){if(!e)return null;if(e.data)return fy(e.data);if(e.asNodeBuffer&&qe)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?fy(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function cO(e){return e&&e.name.slice(-4)===".bin"?Kk(e):Gk(e)}function ws(e,t){for(var r=e.FullPaths||It(e.files),s=t.toLowerCase().replace(/[\/]/g,"\\"),n=s.replace(/\\/g,"/"),a=0;a<r.length;++a){var i=r[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(s==i||n==i)return e.files?e.files[r[a]]:e.FileIndex[a]}return null}function Tx(e,t){var r=ws(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function zt(e,t,r){if(!r)return cO(Tx(e,t));if(!t)return null;try{return zt(e,t)}catch{return null}}function ns(e,t,r){if(!r)return Gk(Tx(e,t));if(!t)return null;try{return ns(e,t)}catch{return null}}function uO(e,t,r){return Kk(Tx(e,t))}function Ey(e){for(var t=e.FullPaths||It(e.files),r=[],s=0;s<t.length;++s)t[s].slice(-1)!="/"&&r.push(t[s].replace(/^Root Entry[\/]/,""));return r.sort()}function He(e,t,r){if(e.FullPaths){if(typeof r=="string"){var s;return qe?s=On(r):s=jR(r),Re.utils.cfb_add(e,t,s)}Re.utils.cfb_add(e,t,r)}else e.file(t,r)}function Nx(){return Re.utils.cfb_new()}function Xk(e,t){switch(t.type){case"base64":return Re.read(e,{type:"base64"});case"binary":return Re.read(e,{type:"binary"});case"buffer":case"array":return Re.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function tl(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var s=e.split("/");s.length!==0;){var n=s.shift();n===".."?r.pop():n!=="."&&r.push(n)}return r.join("/")}var Ut=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,dO=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Ty=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,fO=/<[^>]*>/g,Nr=Ut.match(Ty)?Ty:fO,hO=/<\w*:/,pO=/<(\/?)\w+:/;function Ue(e,t,r){for(var s={},n=0,a=0;n!==e.length&&!((a=e.charCodeAt(n))===32||a===10||a===13);++n);if(t||(s[0]=e.slice(0,n)),n===e.length)return s;var i=e.match(dO),o=0,c="",u=0,d="",f="",h=1;if(i)for(u=0;u!=i.length;++u){for(f=i[u],a=0;a!=f.length&&f.charCodeAt(a)!==61;++a);for(d=f.slice(0,a).trim();f.charCodeAt(a+1)==32;)++a;for(h=(n=f.charCodeAt(a+1))==34||n==39?1:0,c=f.slice(a+1+h,f.length-h),o=0;o!=d.length&&d.charCodeAt(o)!==58;++o);if(o===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),s[d]=c,s[d.toLowerCase()]=c;else{var m=(o===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(o+1);if(s[m]&&d.slice(o-3,o)=="ext")continue;s[m]=c,s[m.toLowerCase()]=c}}return s}function un(e){return e.replace(pO,"<$1")}var Yk={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},jx=d0(Yk),Ze=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(s){var n=s+"",a=n.indexOf("<![CDATA[");if(a==-1)return n.replace(e,function(o,c){return Yk[o]||String.fromCharCode(parseInt(c,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,c){return String.fromCharCode(parseInt(c,16))});var i=n.indexOf("]]>");return r(n.slice(0,a))+n.slice(a+9,i)+r(n.slice(i+3))}}(),Cx=/[&<>'"]/g,mO=/[\u0000-\u0008\u000b-\u001f]/g;function at(e){var t=e+"";return t.replace(Cx,function(r){return jx[r]}).replace(mO,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Ny(e){return at(e).replace(/ /g,"_x0020_")}var Jk=/[\u0000-\u001f]/g;function Ax(e){var t=e+"";return t.replace(Cx,function(r){return jx[r]}).replace(/\n/g,"<br/>").replace(Jk,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function xO(e){var t=e+"";return t.replace(Cx,function(r){return jx[r]}).replace(Jk,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var jy=function(){var e=/&#(\d+);/g;function t(r,s){return String.fromCharCode(parseInt(s,10))}return function(s){return s.replace(e,t)}}();function gO(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function ft(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Ef(e){for(var t="",r=0,s=0,n=0,a=0,i=0,o=0;r<e.length;){if(s=e.charCodeAt(r++),s<128){t+=String.fromCharCode(s);continue}if(n=e.charCodeAt(r++),s>191&&s<224){i=(s&31)<<6,i|=n&63,t+=String.fromCharCode(i);continue}if(a=e.charCodeAt(r++),s<240){t+=String.fromCharCode((s&15)<<12|(n&63)<<6|a&63);continue}i=e.charCodeAt(r++),o=((s&7)<<18|(n&63)<<12|(a&63)<<6|i&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function Cy(e){var t=la(2*e.length),r,s,n=1,a=0,i=0,o;for(s=0;s<e.length;s+=n)n=1,(o=e.charCodeAt(s))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(s+1)&63),n=2):o<240?(r=(o&15)*4096+(e.charCodeAt(s+1)&63)*64+(e.charCodeAt(s+2)&63),n=3):(n=4,r=(o&7)*262144+(e.charCodeAt(s+1)&63)*4096+(e.charCodeAt(s+2)&63)*64+(e.charCodeAt(s+3)&63),r-=65536,i=55296+(r>>>10&1023),r=56320+(r&1023)),i!==0&&(t[a++]=i&255,t[a++]=i>>>8,i=0),t[a++]=r%256,t[a++]=r>>>8;return t.slice(0,a).toString("ucs2")}function Ay(e){return On(e,"binary").toString("utf8")}var mu="foo bar baz",ot=qe&&(Ay(mu)==Ef(mu)&&Ay||Cy(mu)==Ef(mu)&&Cy)||Ef,sn=qe?function(e){return On(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,s=0,n=0;r<e.length;)switch(s=e.charCodeAt(r++),!0){case s<128:t.push(String.fromCharCode(s));break;case s<2048:t.push(String.fromCharCode(192+(s>>6))),t.push(String.fromCharCode(128+(s&63)));break;case(s>=55296&&s<57344):s-=55296,n=e.charCodeAt(r++)-56320+(s<<10),t.push(String.fromCharCode(240+(n>>18&7))),t.push(String.fromCharCode(144+(n>>12&63))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)));break;default:t.push(String.fromCharCode(224+(s>>12))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)))}return t.join("")},nc=function(){var e={};return function(r,s){var n=r+"|"+(s||"");return e[n]?e[n]:e[n]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",s||"")}}(),Qk=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var s=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),n=0;n<e.length;++n)s=s.replace(e[n][0],e[n][1]);return s}}(),vO=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),yO=/<\/?(?:vt:)?variant>/g,wO=/<(?:vt:)([^>]*)>([\s\S]*)</;function Fy(e,t){var r=Ue(e),s=e.match(vO(r.baseType))||[],n=[];if(s.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+s.length+" != "+r.size);return n}return s.forEach(function(a){var i=a.replace(yO,"").match(wO);i&&n.push({v:ot(i[2]),t:i[1]})}),n}var Zk=/(^\s|\s$|\n)/;function ur(e,t){return"<"+e+(t.match(Zk)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function ac(e){return It(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function we(e,t,r){return"<"+e+(r!=null?ac(r):"")+(t!=null?(t.match(Zk)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function mp(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function _O(e,t){switch(typeof e){case"string":var r=we("vt:lpwstr",at(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return we((e|0)==e?"vt:i4":"vt:r8",at(String(e)));case"boolean":return we("vt:bool",e?"true":"false")}if(e instanceof Date)return we("vt:filetime",mp(e));throw new Error("Unable to serialize "+e)}function Fx(e){if(qe&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return ot(ga(Sx(e)));throw new Error("Bad input format: expected Buffer or string")}var ic=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Jt={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},ii=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Zr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function bO(e,t){for(var r=1-2*(e[t+7]>>>7),s=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),n=e[t+6]&15,a=5;a>=0;--a)n=n*256+e[t+a];return s==2047?n==0?r*(1/0):NaN:(s==0?s=-1022:(s-=1023,n+=Math.pow(2,52)),r*Math.pow(2,s-52)*n)}function SO(e,t,r){var s=(t<0||1/t==-1/0?1:0)<<7,n=0,a=0,i=s?-t:t;isFinite(i)?i==0?n=a=0:(n=Math.floor(Math.log(i)/Math.LN2),a=i*Math.pow(2,52-n),n<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?n=-1022:(a-=Math.pow(2,52),n+=1023)):(n=2047,a=isNaN(t)?26985:0);for(var o=0;o<=5;++o,a/=256)e[r+o]=a&255;e[r+6]=(n&15)<<4|a&15,e[r+7]=n>>4|s}var Py=function(e){for(var t=[],r=10240,s=0;s<e[0].length;++s)if(e[0][s])for(var n=0,a=e[0][s].length;n<a;n+=r)t.push.apply(t,e[0][s].slice(n,n+r));return t},Ry=qe?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:On(t)})):Py(e)}:Py,Oy=function(e,t,r){for(var s=[],n=t;n<r;n+=2)s.push(String.fromCharCode(_n(e,n)));return s.join("").replace(Lr,"")},Px=qe?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Lr,""):Oy(e,t,r)}:Oy,Iy=function(e,t,r){for(var s=[],n=t;n<t+r;++n)s.push(("0"+e[n].toString(16)).slice(-2));return s.join("")},eE=qe?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Iy(e,t,r)}:Iy,Dy=function(e,t,r){for(var s=[],n=t;n<r;n++)s.push(String.fromCharCode(ki(e,n)));return s.join("")},Nc=qe?function(t,r,s){return Buffer.isBuffer(t)?t.toString("utf8",r,s):Dy(t,r,s)}:Dy,tE=function(e,t){var r=es(e,t);return r>0?Nc(e,t+4,t+4+r-1):""},rE=tE,sE=function(e,t){var r=es(e,t);return r>0?Nc(e,t+4,t+4+r-1):""},nE=sE,aE=function(e,t){var r=2*es(e,t);return r>0?Nc(e,t+4,t+4+r-1):""},iE=aE,oE=function(t,r){var s=es(t,r);return s>0?Px(t,r+4,r+4+s):""},lE=oE,cE=function(e,t){var r=es(e,t);return r>0?Nc(e,t+4,t+4+r):""},uE=cE,dE=function(e,t){return bO(e,t)},Ad=dE,Rx=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};qe&&(rE=function(t,r){if(!Buffer.isBuffer(t))return tE(t,r);var s=t.readUInt32LE(r);return s>0?t.toString("utf8",r+4,r+4+s-1):""},nE=function(t,r){if(!Buffer.isBuffer(t))return sE(t,r);var s=t.readUInt32LE(r);return s>0?t.toString("utf8",r+4,r+4+s-1):""},iE=function(t,r){if(!Buffer.isBuffer(t))return aE(t,r);var s=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+s-1)},lE=function(t,r){if(!Buffer.isBuffer(t))return oE(t,r);var s=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+s)},uE=function(t,r){if(!Buffer.isBuffer(t))return cE(t,r);var s=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+s)},Ad=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):dE(t,r)},Rx=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var ki=function(e,t){return e[t]},_n=function(e,t){return e[t+1]*256+e[t]},kO=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},es=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Fa=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},EO=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function vl(e,t){var r="",s,n,a=[],i,o,c,u;switch(t){case"dbcs":if(u=this.l,qe&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(_n(this,u)),u+=2;e*=2;break;case"utf8":r=Nc(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Px(this,this.l,this.l+e);break;case"wstr":return vl.call(this,e,"dbcs");case"lpstr-ansi":r=rE(this,this.l),e=4+es(this,this.l);break;case"lpstr-cp":r=nE(this,this.l),e=4+es(this,this.l);break;case"lpwstr":r=iE(this,this.l),e=4+2*es(this,this.l);break;case"lpp4":e=4+es(this,this.l),r=lE(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+es(this,this.l),r=uE(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(i=ki(this,this.l+e++))!==0;)a.push(pu(i));r=a.join("");break;case"_wstr":for(e=0,r="";(i=_n(this,this.l+e))!==0;)a.push(pu(i)),e+=2;e+=2,r=a.join("");break;case"dbcs-cont":for(r="",u=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return i=ki(this,u),this.l=u+1,o=vl.call(this,e-c,i?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(pu(_n(this,u))),u+=2}r=a.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return i=ki(this,u),this.l=u+1,o=vl.call(this,e-c,i?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(pu(ki(this,u))),u+=1}r=a.join("");break;default:switch(e){case 1:return s=ki(this,this.l),this.l++,s;case 2:return s=(t==="i"?kO:_n)(this,this.l),this.l+=2,s;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(s=(e>0?Fa:EO)(this,this.l),this.l+=4,s):(n=es(this,this.l),this.l+=4,n);case 8:case-8:if(t==="f")return e==8?n=Ad(this,this.l):n=Ad([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;e=8;case 16:r=eE(this,this.l,e);break}}return this.l+=e,r}var TO=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},NO=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},jO=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function CO(e,t,r){var s=0,n=0;if(r==="dbcs"){for(n=0;n!=t.length;++n)jO(this,t.charCodeAt(n),this.l+2*n);s=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=t.length;++n)this[this.l+n]=t.charCodeAt(n)&255;s=t.length}else if(r==="hex"){for(;n<e;++n)this[this.l++]=parseInt(t.slice(2*n,2*n+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+e,this.length);for(n=0;n<Math.min(t.length,e);++n){var i=t.charCodeAt(n);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(e){case 1:s=1,this[this.l]=t&255;break;case 2:s=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:s=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:s=4,TO(this,t,this.l);break;case 8:if(s=8,r==="f"){SO(this,t,this.l);break}case 16:break;case-4:s=4,NO(this,t,this.l);break}return this.l+=s,this}function fE(e,t){var r=eE(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function cr(e,t){e.l=t,e.read_shift=vl,e.chk=fE,e.write_shift=CO}function Tr(e,t){e.l+=t}function ae(e){var t=la(e);return cr(t,0),t}function In(e,t,r){if(e){var s,n,a;cr(e,e.l||0);for(var i=e.length,o=0,c=0;e.l<i;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var u=fc[o]||fc[65535];for(s=e.read_shift(1),a=s&127,n=1;n<4&&s&128;++n)a+=((s=e.read_shift(1))&127)<<7*n;c=e.l+a;var d=u.f&&u.f(e,a,r);if(e.l=c,t(d,u,o))return}}}function Kr(){var e=[],t=qe?256:2048,r=function(u){var d=ae(u);return cr(d,0),d},s=r(t),n=function(){s&&(s.length>s.l&&(s=s.slice(0,s.l),s.l=s.length),s.length>0&&e.push(s),s=null)},a=function(u){return s&&u<s.length-s.l?s:(n(),s=r(Math.max(u+1,t)))},i=function(){return n(),rr(e)},o=function(u){n(),s=u,s.l==null&&(s.l=s.length),a(t)};return{next:a,push:o,end:i,_bufs:e}}function ce(e,t,r,s){var n=+t,a;if(!isNaN(n)){s||(s=fc[n].p||(r||[]).length||0),a=1+(n>=128?1:0)+1,s>=128&&++a,s>=16384&&++a,s>=2097152&&++a;var i=e.next(a);n<=127?i.write_shift(1,n):(i.write_shift(1,(n&127)+128),i.write_shift(1,n>>7));for(var o=0;o!=4;++o)if(s>=128)i.write_shift(1,(s&127)+128),s>>=7;else{i.write_shift(1,s);break}s>0&&Rx(r)&&e.push(r)}}function yl(e,t,r){var s=mt(e);if(t.s?(s.cRel&&(s.c+=t.s.c),s.rRel&&(s.r+=t.s.r)):(s.cRel&&(s.c+=t.c),s.rRel&&(s.r+=t.r)),!r||r.biff<12){for(;s.c>=256;)s.c-=256;for(;s.r>=65536;)s.r-=65536}return s}function Ly(e,t,r){var s=mt(e);return s.s=yl(s.s,t.s,r),s.e=yl(s.e,t.s,r),s}function wl(e,t){if(e.cRel&&e.c<0)for(e=mt(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=mt(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Le(e);return!e.cRel&&e.cRel!=null&&(r=PO(r)),!e.rRel&&e.rRel!=null&&(r=AO(r)),r}function Tf(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Nt(e.s.c)+":"+(e.e.cRel?"":"$")+Nt(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Bt(e.s.r)+":"+(e.e.rRel?"":"$")+Bt(e.e.r):wl(e.s,t.biff)+":"+wl(e.e,t.biff)}function Ox(e){return parseInt(FO(e),10)-1}function Bt(e){return""+(e+1)}function AO(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function FO(e){return e.replace(/\$(\d+)$/,"$1")}function Ix(e){for(var t=RO(e),r=0,s=0;s!==t.length;++s)r=26*r+t.charCodeAt(s)-64;return r-1}function Nt(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function PO(e){return e.replace(/^([A-Z])/,"$$$1")}function RO(e){return e.replace(/^\$([A-Z])/,"$1")}function OO(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function jt(e){for(var t=0,r=0,s=0;s<e.length;++s){var n=e.charCodeAt(s);n>=48&&n<=57?t=10*t+(n-48):n>=65&&n<=90&&(r=26*r+(n-64))}return{c:r-1,r:t-1}}function Le(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Xr(e){var t=e.indexOf(":");return t==-1?{s:jt(e),e:jt(e)}:{s:jt(e.slice(0,t)),e:jt(e.slice(t+1))}}function ze(e,t){return typeof t>"u"||typeof t=="number"?ze(e.s,e.e):(typeof e!="string"&&(e=Le(e)),typeof t!="string"&&(t=Le(t)),e==t?e:e+":"+t)}function et(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,s=0,n=0,a=e.length;for(r=0;s<a&&!((n=e.charCodeAt(s)-64)<1||n>26);++s)r=26*r+n;for(t.s.c=--r,r=0;s<a&&!((n=e.charCodeAt(s)-48)<0||n>9);++s)r=10*r+n;if(t.s.r=--r,s===a||n!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++s,r=0;s!=a&&!((n=e.charCodeAt(s)-64)<1||n>26);++s)r=26*r+n;for(t.e.c=--r,r=0;s!=a&&!((n=e.charCodeAt(s)-48)<0||n>9);++s)r=10*r+n;return t.e.r=--r,t}function My(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Ps(e.z,r?Zt(t):t)}catch{}try{return e.w=Ps((e.XF||{}).numFmtId||(r?14:0),r?Zt(t):t)}catch{return""+t}}function Pn(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Dn[e.v]||e.v:t==null?My(e,e.v):My(e,t))}function va(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",s={};return s[r]=e,{SheetNames:[r],Sheets:s}}function hE(e,t,r){var s=r||{},n=e?Array.isArray(e):s.dense,a=e||(n?[]:{}),i=0,o=0;if(a&&s.origin!=null){if(typeof s.origin=="number")i=s.origin;else{var c=typeof s.origin=="string"?jt(s.origin):s.origin;i=c.r,o=c.c}a["!ref"]||(a["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var d=et(a["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),i==-1&&(u.e.r=i=d.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[f].length;++h)if(!(typeof t[f][h]>"u")){var m={v:t[f][h]},p=i+f,x=o+h;if(u.s.r>p&&(u.s.r=p),u.s.c>x&&(u.s.c=x),u.e.r<p&&(u.e.r=p),u.e.c<x&&(u.e.c=x),t[f][h]&&typeof t[f][h]=="object"&&!Array.isArray(t[f][h])&&!(t[f][h]instanceof Date))m=t[f][h];else if(Array.isArray(m.v)&&(m.f=t[f][h][1],m.v=m.v[0]),m.v===null)if(m.f)m.t="n";else if(s.nullError)m.t="e",m.v=0;else if(s.sheetStubs)m.t="z";else continue;else typeof m.v=="number"?m.t="n":typeof m.v=="boolean"?m.t="b":m.v instanceof Date?(m.z=s.dateNF||De[14],s.cellDates?(m.t="d",m.w=Ps(m.z,Zt(m.v))):(m.t="n",m.v=Zt(m.v),m.w=Ps(m.z,m.v))):m.t="s";if(n)a[p]||(a[p]=[]),a[p][x]&&a[p][x].z&&(m.z=a[p][x].z),a[p][x]=m;else{var v=Le({c:x,r:p});a[v]&&a[v].z&&(m.z=a[v].z),a[v]=m}}}return u.s.c<1e7&&(a["!ref"]=ze(u)),a}function Fo(e,t){return hE(null,e,t)}function IO(e){return e.read_shift(4,"i")}function Ks(e,t){return t||(t=ae(4)),t.write_shift(4,e),t}function kr(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function sr(e,t){var r=!1;return t==null&&(r=!0,t=ae(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function DO(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function LO(e,t){return t||(t=ae(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Dx(e,t){var r=e.l,s=e.read_shift(1),n=kr(e),a=[],i={t:n,h:n};if(s&1){for(var o=e.read_shift(4),c=0;c!=o;++c)a.push(DO(e));i.r=a}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}function MO(e,t){var r=!1;return t==null&&(r=!0,t=ae(15+4*e.t.length)),t.write_shift(1,0),sr(e.t,t),r?t.slice(0,t.l):t}var BO=Dx;function UO(e,t){var r=!1;return t==null&&(r=!0,t=ae(23+4*e.t.length)),t.write_shift(1,1),sr(e.t,t),t.write_shift(4,1),LO({},t),r?t.slice(0,t.l):t}function Rs(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function oi(e,t){return t==null&&(t=ae(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function li(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function ci(e,t){return t==null&&(t=ae(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var $O=kr,pE=sr;function Lx(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Fd(e,t){var r=!1;return t==null&&(r=!0,t=ae(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var VO=kr,xp=Lx,Mx=Fd;function Bx(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,s=t[0]&2;e.l+=4;var n=s===0?Ad([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Fa(t,0)>>2;return r?n/100:n}function mE(e,t){t==null&&(t=ae(4));var r=0,s=0,n=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?s=1:n==(n|0)&&n>=-536870912&&n<1<<29&&(s=1,r=1),s)t.write_shift(-4,((r?n:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function xE(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function zO(e,t){return t||(t=ae(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var ui=xE,Po=zO;function br(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function ei(e,t){return(t||ae(8)).write_shift(8,e,"f")}function WO(e){var t={},r=e.read_shift(1),s=r>>>1,n=e.read_shift(1),a=e.read_shift(2,"i"),i=e.read_shift(1),o=e.read_shift(1),c=e.read_shift(1);switch(e.l++,s){case 0:t.auto=1;break;case 1:t.index=n;var u=za[n];u&&(t.rgb=lc(u));break;case 2:t.rgb=lc([i,o,c]);break;case 3:t.theme=n;break}return a!=0&&(t.tint=a>0?a/32767:a/32768),t}function Pd(e,t){if(t||(t=ae(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var s=e.rgb||"FFFFFF";typeof s=="number"&&(s=("000000"+s.toString(16)).slice(-6)),t.write_shift(1,parseInt(s.slice(0,2),16)),t.write_shift(1,parseInt(s.slice(2,4),16)),t.write_shift(1,parseInt(s.slice(4,6),16)),t.write_shift(1,255)}return t}function HO(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function qO(e,t){t||(t=ae(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function gE(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},s=e.read_shift(4);switch(s){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(s>400)throw new Error("Unsupported Clipboard: "+s.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function GO(e){return gE(e,1)}function KO(e){return gE(e,2)}var Ux=2,$r=3,xu=11,By=12,Rd=19,gu=64,XO=65,YO=71,JO=4108,QO=4126,er=80,vE=81,ZO=[er,vE],gp={1:{n:"CodePage",t:Ux},2:{n:"Category",t:er},3:{n:"PresentationFormat",t:er},4:{n:"ByteCount",t:$r},5:{n:"LineCount",t:$r},6:{n:"ParagraphCount",t:$r},7:{n:"SlideCount",t:$r},8:{n:"NoteCount",t:$r},9:{n:"HiddenCount",t:$r},10:{n:"MultimediaClipCount",t:$r},11:{n:"ScaleCrop",t:xu},12:{n:"HeadingPairs",t:JO},13:{n:"TitlesOfParts",t:QO},14:{n:"Manager",t:er},15:{n:"Company",t:er},16:{n:"LinksUpToDate",t:xu},17:{n:"CharacterCount",t:$r},19:{n:"SharedDoc",t:xu},22:{n:"HyperlinksChanged",t:xu},23:{n:"AppVersion",t:$r,p:"version"},24:{n:"DigSig",t:XO},26:{n:"ContentType",t:er},27:{n:"ContentStatus",t:er},28:{n:"Language",t:er},29:{n:"Version",t:er},255:{},2147483648:{n:"Locale",t:Rd},2147483651:{n:"Behavior",t:Rd},1919054434:{}},vp={1:{n:"CodePage",t:Ux},2:{n:"Title",t:er},3:{n:"Subject",t:er},4:{n:"Author",t:er},5:{n:"Keywords",t:er},6:{n:"Comments",t:er},7:{n:"Template",t:er},8:{n:"LastAuthor",t:er},9:{n:"RevNumber",t:er},10:{n:"EditTime",t:gu},11:{n:"LastPrinted",t:gu},12:{n:"CreatedDate",t:gu},13:{n:"ModifiedDate",t:gu},14:{n:"PageCount",t:$r},15:{n:"WordCount",t:$r},16:{n:"CharCount",t:$r},17:{n:"Thumbnail",t:YO},18:{n:"Application",t:er},19:{n:"DocSecurity",t:$r},255:{},2147483648:{n:"Locale",t:Rd},2147483651:{n:"Behavior",t:Rd},1919054434:{}},Uy={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},e8=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function t8(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var r8=t8([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),za=mt(r8),Dn={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},yE={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},yp={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},vu={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function $x(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function s8(e){var t=$x();if(!e||!e.match)return t;var r={};if((e.match(Nr)||[]).forEach(function(s){var n=Ue(s);switch(n[0].replace(hO,"<")){case"<?xml":break;case"<Types":t.xmlns=n["xmlns"+(n[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[n.Extension]=n.ContentType;break;case"<Override":t[yp[n.ContentType]]!==void 0&&t[yp[n.ContentType]].push(n.PartName);break}}),t.xmlns!==Jt.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function wE(e,t){var r=sO(yp),s=[],n;s[s.length]=Ut,s[s.length]=we("Types",null,{xmlns:Jt.CT,"xmlns:xsd":Jt.xsd,"xmlns:xsi":Jt.xsi}),s=s.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return we("Default",null,{Extension:c[0],ContentType:c[1]})}));var a=function(c){e[c]&&e[c].length>0&&(n=e[c][0],s[s.length]=we("Override",null,{PartName:(n[0]=="/"?"":"/")+n,ContentType:vu[c][t.bookType]||vu[c].xlsx}))},i=function(c){(e[c]||[]).forEach(function(u){s[s.length]=we("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:vu[c][t.bookType]||vu[c].xlsx})})},o=function(c){(e[c]||[]).forEach(function(u){s[s.length]=we("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[c][0]})})};return a("workbooks"),i("sheets"),i("charts"),o("themes"),["strs","styles"].forEach(a),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),i("metadata"),o("people"),s.length>2&&(s[s.length]="</Types>",s[1]=s[1].replace("/>",">")),s.join("")}var Ge={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function oc(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function _l(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var s={};return(e.match(Nr)||[]).forEach(function(n){var a=Ue(n);if(a[0]==="<Relationship"){var i={};i.Type=a.Type,i.Target=a.Target,i.Id=a.Id,a.TargetMode&&(i.TargetMode=a.TargetMode);var o=a.TargetMode==="External"?a.Target:tl(a.Target,t);r[o]=i,s[a.Id]=i}}),r["!id"]=s,r}function Zi(e){var t=[Ut,we("Relationships",null,{xmlns:Jt.RELS})];return It(e["!id"]).forEach(function(r){t[t.length]=we("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function nt(e,t,r,s,n,a){if(n||(n={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,n.Id="rId"+t,n.Type=s,n.Target=r,[Ge.HLINK,Ge.XPATH,Ge.XMISS].indexOf(n.Type)>-1&&(n.TargetMode="External"),e["!id"][n.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][n.Id]=n,e[("/"+n.Target).replace("//","/")]=n,t}var n8="application/vnd.oasis.opendocument.spreadsheet";function a8(e,t){for(var r=Fx(e),s,n;s=ic.exec(r);)switch(s[3]){case"manifest":break;case"file-entry":if(n=Ue(s[0],!1),n.path=="/"&&n.type!==n8)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw s}}function i8(e){var t=[Ut];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function $y(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function o8(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function l8(e){var t=[Ut];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push($y(e[r][0],e[r][1])),t.push(o8("",e[r][0]));return t.push($y("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function _E(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Ed.version+"</meta:generator></office:meta></office:document-meta>"}var Cs=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],c8=function(){for(var e=new Array(Cs.length),t=0;t<Cs.length;++t){var r=Cs[t],s="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+s+"[^>]*>([\\s\\S]*?)</"+s+">")}return e}();function bE(e){var t={};e=ot(e);for(var r=0;r<Cs.length;++r){var s=Cs[r],n=e.match(c8[r]);n!=null&&n.length>0&&(t[s[1]]=Ze(n[1])),s[2]==="date"&&t[s[1]]&&(t[s[1]]=pt(t[s[1]]))}return t}function Nf(e,t,r,s,n){n[e]!=null||t==null||t===""||(n[e]=t,t=at(t),s[s.length]=r?we(e,t,r):ur(e,t))}function SE(e,t){var r=t||{},s=[Ut,we("cp:coreProperties",null,{"xmlns:cp":Jt.CORE_PROPS,"xmlns:dc":Jt.dc,"xmlns:dcterms":Jt.dcterms,"xmlns:dcmitype":Jt.dcmitype,"xmlns:xsi":Jt.xsi})],n={};if(!e&&!r.Props)return s.join("");e&&(e.CreatedDate!=null&&Nf("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:mp(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},s,n),e.ModifiedDate!=null&&Nf("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:mp(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},s,n));for(var a=0;a!=Cs.length;++a){var i=Cs[a],o=r.Props&&r.Props[i[1]]!=null?r.Props[i[1]]:e?e[i[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&Nf(i[0],o,null,s,n)}return s.length>2&&(s[s.length]="</cp:coreProperties>",s[1]=s[1].replace("/>",">")),s.join("")}var Wa=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],kE=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function EE(e,t,r,s){var n=[];if(typeof e=="string")n=Fy(e,s);else for(var a=0;a<e.length;++a)n=n.concat(e[a].map(function(d){return{v:d}}));var i=typeof t=="string"?Fy(t,s).map(function(d){return d.v}):t,o=0,c=0;if(i.length>0)for(var u=0;u!==n.length;u+=2){switch(c=+n[u+1].v,n[u].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=i.slice(o,o+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=c,r.DefinedNames=i.slice(o,o+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=i.slice(o,o+c);break}o+=c}}function u8(e,t,r){var s={};return t||(t={}),e=ot(e),Wa.forEach(function(n){var a=(e.match(nc(n[0]))||[])[1];switch(n[2]){case"string":a&&(t[n[1]]=Ze(a));break;case"bool":t[n[1]]=a==="true";break;case"raw":var i=e.match(new RegExp("<"+n[0]+"[^>]*>([\\s\\S]*?)</"+n[0]+">"));i&&i.length>0&&(s[n[1]]=i[1]);break}}),s.HeadingPairs&&s.TitlesOfParts&&EE(s.HeadingPairs,s.TitlesOfParts,t,r),t}function TE(e){var t=[],r=we;return e||(e={}),e.Application="SheetJS",t[t.length]=Ut,t[t.length]=we("Properties",null,{xmlns:Jt.EXT_PROPS,"xmlns:vt":Jt.vt}),Wa.forEach(function(s){if(e[s[1]]!==void 0){var n;switch(s[2]){case"string":n=at(String(e[s[1]]));break;case"bool":n=e[s[1]]?"true":"false";break}n!==void 0&&(t[t.length]=r(s[0],n))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(s){return"<vt:lpstr>"+at(s)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var d8=/<[^>]+>[^<]*/g;function f8(e,t){var r={},s="",n=e.match(d8);if(n)for(var a=0;a!=n.length;++a){var i=n[a],o=Ue(i);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":s=Ze(o.name);break;case"</property>":s=null;break;default:if(i.indexOf("<vt:")===0){var c=i.split(">"),u=c[0].slice(4),d=c[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[s]=Ze(d);break;case"bool":r[s]=ft(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[s]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[s]=parseFloat(d);break;case"filetime":case"date":r[s]=pt(d);break;case"cy":case"error":r[s]=Ze(d);break;default:if(u.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",i,u,c)}}else if(i.slice(0,2)!=="</"){if(t.WTF)throw new Error(i)}}}return r}function NE(e){var t=[Ut,we("Properties",null,{xmlns:Jt.CUST_PROPS,"xmlns:vt":Jt.vt})];if(!e)return t.join("");var r=1;return It(e).forEach(function(n){++r,t[t.length]=we("property",_O(e[n]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:at(n)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var wp={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},jf;function h8(e,t,r){jf||(jf=d0(wp)),t=jf[t]||t,e[t]=r}function p8(e,t){var r=[];return It(wp).map(function(s){for(var n=0;n<Cs.length;++n)if(Cs[n][1]==s)return Cs[n];for(n=0;n<Wa.length;++n)if(Wa[n][1]==s)return Wa[n];throw s}).forEach(function(s){if(e[s[1]]!=null){var n=t&&t.Props&&t.Props[s[1]]!=null?t.Props[s[1]]:e[s[1]];switch(s[2]){case"date":n=new Date(n).toISOString().replace(/\.\d*Z/,"Z");break}typeof n=="number"?n=String(n):n===!0||n===!1?n=n?"1":"0":n instanceof Date&&(n=new Date(n).toISOString().replace(/\.\d*Z/,"")),r.push(ur(wp[s[1]]||s[1],n))}}),we("DocumentProperties",r.join(""),{xmlns:Zr.o})}function m8(e,t){var r=["Worksheets","SheetNames"],s="CustomDocumentProperties",n=[];return e&&It(e).forEach(function(a){if(Object.prototype.hasOwnProperty.call(e,a)){for(var i=0;i<Cs.length;++i)if(a==Cs[i][1])return;for(i=0;i<Wa.length;++i)if(a==Wa[i][1])return;for(i=0;i<r.length;++i)if(a==r[i])return;var o=e[a],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o=String(o),n.push(we(Ny(a),o,{"dt:dt":c}))}}),t&&It(t).forEach(function(a){if(Object.prototype.hasOwnProperty.call(t,a)&&!(e&&Object.prototype.hasOwnProperty.call(e,a))){var i=t[a],o="string";typeof i=="number"?(o="float",i=String(i)):i===!0||i===!1?(o="boolean",i=i?"1":"0"):i instanceof Date?(o="dateTime.tz",i=i.toISOString()):i=String(i),n.push(we(Ny(a),i,{"dt:dt":o}))}}),"<"+s+' xmlns="'+Zr.o+'">'+n.join("")+"</"+s+">"}function Vx(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function x8(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,s=r%Math.pow(2,32),n=(r-s)/Math.pow(2,32);s*=1e7,n*=1e7;var a=s/Math.pow(2,32)|0;a>0&&(s=s%Math.pow(2,32),n+=a);var i=ae(8);return i.write_shift(4,s),i.write_shift(4,n),i}function jE(e,t,r){var s=e.l,n=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-s&3;)++e.l;return n}function CE(e,t,r){var s=e.read_shift(0,"lpwstr");return s}function AE(e,t,r){return t===31?CE(e):jE(e,t,r)}function _p(e,t,r){return AE(e,t,r===!1?0:4)}function g8(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return AE(e,t,0)}function v8(e){for(var t=e.read_shift(4),r=[],s=0;s!=t;++s){var n=e.l;r[s]=e.read_shift(0,"lpwstr").replace(Lr,""),e.l-n&2&&(e.l+=2)}return r}function y8(e){for(var t=e.read_shift(4),r=[],s=0;s!=t;++s)r[s]=e.read_shift(0,"lpstr-cp").replace(Lr,"");return r}function w8(e){var t=e.l,r=Od(e,vE);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var s=Od(e,$r);return[r,s]}function _8(e){for(var t=e.read_shift(4),r=[],s=0;s<t/2;++s)r.push(w8(e));return r}function Vy(e,t){for(var r=e.read_shift(4),s={},n=0;n!=r;++n){var a=e.read_shift(4),i=e.read_shift(4);s[a]=e.read_shift(i,t===1200?"utf16le":"utf8").replace(Lr,"").replace(el,"!"),t===1200&&i%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),s}function FE(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function b8(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Od(e,t,r){var s=e.read_shift(2),n,a=r||{};if(e.l+=2,t!==By&&s!==t&&ZO.indexOf(t)===-1&&!((t&65534)==4126&&(s&65534)==4126))throw new Error("Expected type "+t+" saw "+s);switch(t===By?s:t){case 2:return n=e.read_shift(2,"i"),a.raw||(e.l+=2),n;case 3:return n=e.read_shift(4,"i"),n;case 11:return e.read_shift(4)!==0;case 19:return n=e.read_shift(4),n;case 30:return jE(e,s,4).replace(Lr,"");case 31:return CE(e);case 64:return Vx(e);case 65:return FE(e);case 71:return b8(e);case 80:return _p(e,s,!a.raw).replace(Lr,"");case 81:return g8(e,s).replace(Lr,"");case 4108:return _8(e);case 4126:case 4127:return s==4127?v8(e):y8(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+s)}}function zy(e,t){var r=ae(4),s=ae(4);switch(r.write_shift(4,e==80?31:e),e){case 3:s.write_shift(-4,t);break;case 5:s=ae(8),s.write_shift(8,t,"f");break;case 11:s.write_shift(4,t?1:0);break;case 64:s=x8(t);break;case 31:case 80:for(s=ae(4+2*(t.length+1)+(t.length%2?0:2)),s.write_shift(4,t.length+1),s.write_shift(0,t,"dbcs");s.l!=s.length;)s.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return rr([r,s])}function Wy(e,t){var r=e.l,s=e.read_shift(4),n=e.read_shift(4),a=[],i=0,o=0,c=-1,u={};for(i=0;i!=n;++i){var d=e.read_shift(4),f=e.read_shift(4);a[i]=[d,f+r]}a.sort(function(w,g){return w[1]-g[1]});var h={};for(i=0;i!=n;++i){if(e.l!==a[i][1]){var m=!0;if(i>0&&t)switch(t[a[i-1][0]].t){case 2:e.l+2===a[i][1]&&(e.l+=2,m=!1);break;case 80:e.l<=a[i][1]&&(e.l=a[i][1],m=!1);break;case 4108:e.l<=a[i][1]&&(e.l=a[i][1],m=!1);break}if((!t||i==0)&&e.l<=a[i][1]&&(m=!1,e.l=a[i][1]),m)throw new Error("Read Error: Expected address "+a[i][1]+" at "+e.l+" :"+i)}if(t){var p=t[a[i][0]];if(h[p.n]=Od(e,p.t,{raw:!0}),p.p==="version"&&(h[p.n]=String(h[p.n]>>16)+"."+("0000"+String(h[p.n]&65535)).slice(-4)),p.n=="CodePage")switch(h[p.n]){case 0:h[p.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:zs(o=h[p.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[p.n])}}else if(a[i][0]===1){if(o=h.CodePage=Od(e,Ux),zs(o),c!==-1){var x=e.l;e.l=a[c][1],u=Vy(e,o),e.l=x}}else if(a[i][0]===0){if(o===0){c=i,e.l=a[i+1][1];continue}u=Vy(e,o)}else{var v=u[a[i][0]],y;switch(e[e.l]){case 65:e.l+=4,y=FE(e);break;case 30:e.l+=4,y=_p(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,y=_p(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,y=e.read_shift(4,"i");break;case 19:e.l+=4,y=e.read_shift(4);break;case 5:e.l+=4,y=e.read_shift(8,"f");break;case 11:e.l+=4,y=Dt(e,4);break;case 64:e.l+=4,y=pt(Vx(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[v]=y}}return e.l=r+s,h}var PE=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function S8(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function Hy(e,t,r){var s=ae(8),n=[],a=[],i=8,o=0,c=ae(8),u=ae(8);if(c.write_shift(4,2),c.write_shift(4,1200),u.write_shift(4,1),a.push(c),n.push(u),i+=8+c.length,!t){u=ae(8),u.write_shift(4,0),n.unshift(u);var d=[ae(4)];for(d[0].write_shift(4,e.length),o=0;o<e.length;++o){var f=e[o][0];for(c=ae(8+2*(f.length+1)+(f.length%2?0:2)),c.write_shift(4,o+2),c.write_shift(4,f.length+1),c.write_shift(0,f,"dbcs");c.l!=c.length;)c.write_shift(1,0);d.push(c)}c=rr(d),a.unshift(c),i+=8+c.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(PE.indexOf(e[o][0])>-1||kE.indexOf(e[o][0])>-1)&&e[o][1]!=null){var h=e[o][1],m=0;if(t){m=+t[e[o][0]];var p=r[m];if(p.p=="version"&&typeof h=="string"){var x=h.split(".");h=(+x[0]<<16)+(+x[1]||0)}c=zy(p.t,h)}else{var v=S8(h);v==-1&&(v=31,h=String(h)),c=zy(v,h)}a.push(c),u=ae(8),u.write_shift(4,t?m:2+o),n.push(u),i+=8+c.length}var y=8*(a.length+1);for(o=0;o<a.length;++o)n[o].write_shift(4,y),y+=a[o].length;return s.write_shift(4,i),s.write_shift(4,a.length),rr([s].concat(n).concat(a))}function qy(e,t,r){var s=e.content;if(!s)return{};cr(s,0);var n,a,i,o,c=0;s.chk("feff","Byte Order: "),s.read_shift(2);var u=s.read_shift(4),d=s.read_shift(16);if(d!==Re.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(n=s.read_shift(4),n!==1&&n!==2)throw new Error("Unrecognized #Sets: "+n);if(a=s.read_shift(16),o=s.read_shift(4),n===1&&o!==s.l)throw new Error("Length mismatch: "+o+" !== "+s.l);n===2&&(i=s.read_shift(16),c=s.read_shift(4));var f=Wy(s,t),h={SystemIdentifier:u};for(var m in f)h[m]=f[m];if(h.FMTID=a,n===1)return h;if(c-s.l==2&&(s.l+=2),s.l!==c)throw new Error("Length mismatch 2: "+s.l+" !== "+c);var p;try{p=Wy(s,null)}catch{}for(m in p)h[m]=p[m];return h.FMTID=[a,i],h}function Gy(e,t,r,s,n,a){var i=ae(n?68:48),o=[i];i.write_shift(2,65534),i.write_shift(2,0),i.write_shift(4,842412599),i.write_shift(16,Re.utils.consts.HEADER_CLSID,"hex"),i.write_shift(4,n?2:1),i.write_shift(16,t,"hex"),i.write_shift(4,n?68:48);var c=Hy(e,r,s);if(o.push(c),n){var u=Hy(n,null,null);i.write_shift(16,a,"hex"),i.write_shift(4,68+c.length),o.push(u)}return rr(o)}function Bn(e,t){return e.read_shift(t),null}function k8(e,t){t||(t=ae(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function E8(e,t,r){for(var s=[],n=e.l+t;e.l<n;)s.push(r(e,n-e.l));if(n!==e.l)throw new Error("Slurp error");return s}function Dt(e,t){return e.read_shift(t)===1}function Pr(e,t){return t||(t=ae(2)),t.write_shift(2,+!!e),t}function Wt(e){return e.read_shift(2,"u")}function _s(e,t){return t||(t=ae(2)),t.write_shift(2,e),t}function RE(e,t){return E8(e,t,Wt)}function T8(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function OE(e,t,r){return r||(r=ae(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function jc(e,t,r){var s=e.read_shift(r&&r.biff>=12?2:1),n="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=e.read_shift(1);a&&(n="dbcs-cont")}else r.biff==12&&(n="wstr");r.biff>=2&&r.biff<=5&&(n="cpstr");var i=s?e.read_shift(s,n):"";return i}function N8(e){var t=e.read_shift(2),r=e.read_shift(1),s=r&4,n=r&8,a=1+(r&1),i=0,o,c={};n&&(i=e.read_shift(2)),s&&(o=e.read_shift(4));var u=a==2?"dbcs-cont":"sbcs-cont",d=t===0?"":e.read_shift(t,u);return n&&(e.l+=4*i),s&&(e.l+=o),c.t=d,n||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function j8(e){var t=e.t||"",r=ae(3);r.write_shift(2,t.length),r.write_shift(1,1);var s=ae(2*t.length);s.write_shift(2*t.length,t,"utf16le");var n=[r,s];return rr(n)}function ti(e,t,r){var s;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var n=e.read_shift(1);return n===0?s=e.read_shift(t,"sbcs-cont"):s=e.read_shift(t,"dbcs-cont"),s}function Cc(e,t,r){var s=e.read_shift(r&&r.biff==2?1:2);return s===0?(e.l++,""):ti(e,s,r)}function di(e,t,r){if(r.biff>5)return Cc(e,t,r);var s=e.read_shift(1);return s===0?(e.l++,""):e.read_shift(s,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function IE(e,t,r){return r||(r=ae(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function C8(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function A8(e){var t=e.read_shift(4),r=e.l,s=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(s=!0),e.l=r);var n=e.read_shift((s?t-24:t)>>1,"utf16le").replace(Lr,"");return s&&(e.l+=24),n}function F8(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var s=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var n=e.read_shift(4);if(n===0)return r+s.replace(/\\/g,"/");var a=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=e.read_shift(a>>1,"utf16le").replace(Lr,"");return r+i}function P8(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return A8(e);case"0303000000000000c000000000000046":return F8(e);default:throw new Error("Unsupported Moniker "+r)}}function yu(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Lr,""):"";return r}function Ky(e,t){t||(t=ae(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function R8(e,t){var r=e.l+t,s=e.read_shift(4);if(s!==2)throw new Error("Unrecognized streamVersion: "+s);var n=e.read_shift(2);e.l+=2;var a,i,o,c,u="",d,f;n&16&&(a=yu(e,r-e.l)),n&128&&(i=yu(e,r-e.l)),(n&257)===257&&(o=yu(e,r-e.l)),(n&257)===1&&(c=P8(e,r-e.l)),n&8&&(u=yu(e,r-e.l)),n&32&&(d=e.read_shift(16)),n&64&&(f=Vx(e)),e.l=r;var h=i||o||c||"";h&&u&&(h+="#"+u),h||(h="#"+u),n&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var m={Target:h};return d&&(m.guid=d),f&&(m.time=f),a&&(m.Tooltip=a),m}function O8(e){var t=ae(512),r=0,s=e.Target;s.slice(0,7)=="file://"&&(s=s.slice(7));var n=s.indexOf("#"),a=n>-1?31:23;switch(s.charAt(0)){case"#":a=28;break;case".":a&=-3;break}t.write_shift(4,2),t.write_shift(4,a);var i=[8,6815827,6619237,4849780,83];for(r=0;r<i.length;++r)t.write_shift(4,i[r]);if(a==28)s=s.slice(1),Ky(s,t);else if(a&2){for(i="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));var o=n>-1?s.slice(0,n):s;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),a&8&&Ky(n>-1?s.slice(n+1):"",t)}else{for(i="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));for(var c=0;s.slice(c*3,c*3+3)=="../"||s.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,s.length-3*c+1),r=0;r<s.length-3*c;++r)t.write_shift(1,s.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function DE(e){var t=e.read_shift(1),r=e.read_shift(1),s=e.read_shift(1),n=e.read_shift(1);return[t,r,s,n]}function LE(e,t){var r=DE(e);return r[3]=0,r}function dn(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2);return{r:t,c:r,ixfe:s}}function ri(e,t,r,s){return s||(s=ae(6)),s.write_shift(2,e),s.write_shift(2,t),s.write_shift(2,r||0),s}function I8(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function D8(e,t,r){return t===0?"":di(e,t,r)}function L8(e,t,r){var s=r.biff>8?4:2,n=e.read_shift(s),a=e.read_shift(s,"i"),i=e.read_shift(s,"i");return[n,a,i]}function ME(e){var t=e.read_shift(2),r=Bx(e);return[t,r]}function M8(e,t,r){e.l+=4,t-=4;var s=e.l+t,n=jc(e,t,r),a=e.read_shift(2);if(s-=e.l,a!==s)throw new Error("Malformed AddinUdf: padding = "+s+" != "+a);return e.l+=a,n}function p0(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2),n=e.read_shift(2);return{s:{c:s,r:t},e:{c:n,r}}}function BE(e,t){return t||(t=ae(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function UE(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(1),n=e.read_shift(1);return{s:{c:s,r:t},e:{c:n,r}}}var B8=UE;function $E(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2);return e.l+=12,[r,t,s]}function U8(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function $8(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function gr(e){e.l+=2,e.l+=e.read_shift(2)}var V8={0:gr,4:gr,5:gr,6:gr,7:$8,8:gr,9:gr,10:gr,11:gr,12:gr,13:U8,14:gr,15:gr,16:gr,17:gr,18:gr,19:gr,20:gr,21:$E};function z8(e,t){for(var r=e.l+t,s=[];e.l<r;){var n=e.read_shift(2);e.l-=2;try{s.push(V8[n](e,r-e.l))}catch{return e.l=r,s}}return e.l!=r&&(e.l=r),s}function wu(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function zx(e,t,r){var s=1536,n=16;switch(r.bookType){case"biff8":break;case"biff5":s=1280,n=8;break;case"biff4":s=4,n=6;break;case"biff3":s=3,n=6;break;case"biff2":s=2,n=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var a=ae(n);return a.write_shift(2,s),a.write_shift(2,t),n>4&&a.write_shift(2,29282),n>6&&a.write_shift(2,1997),n>8&&(a.write_shift(2,49161),a.write_shift(2,1),a.write_shift(2,1798),a.write_shift(2,0)),a}function W8(e,t){return t===0||e.read_shift(2),1200}function H8(e,t,r){if(r.enc)return e.l+=t,"";var s=e.l,n=di(e,0,r);return e.read_shift(t+s-e.l),n}function q8(e,t){var r=!t||t.biff==8,s=ae(r?112:54);for(s.write_shift(t.biff==8?2:1,7),r&&s.write_shift(1,0),s.write_shift(4,859007059),s.write_shift(4,5458548|(r?0:536870912));s.l<s.length;)s.write_shift(1,r?0:32);return s}function G8(e,t,r){var s=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:s&16,fBelow:s&64,fRight:s&128}}function K8(e,t,r){var s=e.read_shift(4),n=e.read_shift(1)&3,a=e.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var i=jc(e,0,r);return i.length===0&&(i="Sheet1"),{pos:s,hs:n,dt:a,name:i}}function X8(e,t){var r=!t||t.biff>=8?2:1,s=ae(8+r*e.name.length);s.write_shift(4,e.pos),s.write_shift(1,e.hs||0),s.write_shift(1,e.dt),s.write_shift(1,e.name.length),t.biff>=8&&s.write_shift(1,1),s.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var n=s.slice(0,s.l);return n.l=s.l,n}function Y8(e,t){for(var r=e.l+t,s=e.read_shift(4),n=e.read_shift(4),a=[],i=0;i!=n&&e.l<r;++i)a.push(N8(e));return a.Count=s,a.Unique=n,a}function J8(e,t){var r=ae(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var s=[],n=0;n<e.length;++n)s[n]=j8(e[n]);var a=rr([r].concat(s));return a.parts=[r.length].concat(s.map(function(i){return i.length})),a}function Q8(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function Z8(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var s=e.read_shift(1);return e.l+=3,s&7&&(t.level=s&7),s&32&&(t.hidden=!0),s&64&&(t.hpt=r/20),t}function eI(e){var t=I8(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function tI(e){return e.read_shift(2),e.read_shift(4)}function Xy(e,t,r){var s=0;r&&r.biff==2||(s=e.read_shift(2));var n=e.read_shift(2);r&&r.biff==2&&(s=1-(n>>15),n&=32767);var a={Unsynced:s&1,DyZero:(s&2)>>1,ExAsc:(s&4)>>2,ExDsc:(s&8)>>3};return[a,n]}function rI(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),c=e.read_shift(2),u=e.read_shift(2);return{Pos:[t,r],Dim:[s,n],Flags:a,CurTab:i,FirstTab:o,Selected:c,TabRatio:u}}function sI(){var e=ae(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function nI(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var s=e.read_shift(2);return{RTL:s&64}}function aI(e){var t=ae(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function iI(){}function oI(e,t,r){var s={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return s.name=jc(e,0,r),s}function lI(e,t){var r=e.name||"Arial",s=t&&t.biff==5,n=s?15+r.length:16+2*r.length,a=ae(n);return a.write_shift(2,e.sz*20),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,r.length),s||a.write_shift(1,1),a.write_shift((s?1:2)*r.length,r,s?"sbcs":"utf16le"),a}function cI(e){var t=dn(e);return t.isst=e.read_shift(4),t}function uI(e,t,r,s){var n=ae(10);return ri(e,t,s,n),n.write_shift(4,r),n}function dI(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var s=e.l+t,n=dn(e);r.biff==2&&e.l++;var a=Cc(e,s-e.l,r);return n.val=a,n}function fI(e,t,r,s,n){var a=!n||n.biff==8,i=ae(8+ +a+(1+a)*r.length);return ri(e,t,s,i),i.write_shift(2,r.length),a&&i.write_shift(1,1),i.write_shift((1+a)*r.length,r,a?"utf16le":"sbcs"),i}function hI(e,t,r){var s=e.read_shift(2),n=di(e,0,r);return[s,n]}function pI(e,t,r,s){var n=r&&r.biff==5;s||(s=ae(n?3+t.length:5+2*t.length)),s.write_shift(2,e),s.write_shift(n?1:2,t.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*t.length,t,n?"sbcs":"utf16le");var a=s.length>s.l?s.slice(0,s.l):s;return a.l==null&&(a.l=a.length),a}var mI=di;function Yy(e,t,r){var s=e.l+t,n=r.biff==8||!r.biff?4:2,a=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(2),c=e.read_shift(2);return e.l=s,{s:{r:a,c:o},e:{r:i,c}}}function xI(e,t){var r=t.biff==8||!t.biff?4:2,s=ae(2*r+6);return s.write_shift(r,e.s.r),s.write_shift(r,e.e.r+1),s.write_shift(2,e.s.c),s.write_shift(2,e.e.c+1),s.write_shift(2,0),s}function gI(e){var t=e.read_shift(2),r=e.read_shift(2),s=ME(e);return{r:t,c:r,ixfe:s[0],rknum:s[1]}}function vI(e,t){for(var r=e.l+t-2,s=e.read_shift(2),n=e.read_shift(2),a=[];e.l<r;)a.push(ME(e));if(e.l!==r)throw new Error("MulRK read error");var i=e.read_shift(2);if(a.length!=i-n+1)throw new Error("MulRK length mismatch");return{r:s,c:n,C:i,rkrec:a}}function yI(e,t){for(var r=e.l+t-2,s=e.read_shift(2),n=e.read_shift(2),a=[];e.l<r;)a.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var i=e.read_shift(2);if(a.length!=i-n+1)throw new Error("MulBlank length mismatch");return{r:s,c:n,C:i,ixfe:a}}function wI(e,t,r,s){var n={},a=e.read_shift(4),i=e.read_shift(4),o=e.read_shift(4),c=e.read_shift(2);return n.patternType=e8[o>>26],s.cellStyles&&(n.alc=a&7,n.fWrap=a>>3&1,n.alcV=a>>4&7,n.fJustLast=a>>7&1,n.trot=a>>8&255,n.cIndent=a>>16&15,n.fShrinkToFit=a>>20&1,n.iReadOrder=a>>22&2,n.fAtrNum=a>>26&1,n.fAtrFnt=a>>27&1,n.fAtrAlc=a>>28&1,n.fAtrBdr=a>>29&1,n.fAtrPat=a>>30&1,n.fAtrProt=a>>31&1,n.dgLeft=i&15,n.dgRight=i>>4&15,n.dgTop=i>>8&15,n.dgBottom=i>>12&15,n.icvLeft=i>>16&127,n.icvRight=i>>23&127,n.grbitDiag=i>>30&3,n.icvTop=o&127,n.icvBottom=o>>7&127,n.icvDiag=o>>14&127,n.dgDiag=o>>21&15,n.icvFore=c&127,n.icvBack=c>>7&127,n.fsxButton=c>>14&1),n}function _I(e,t,r){var s={};return s.ifnt=e.read_shift(2),s.numFmtId=e.read_shift(2),s.flags=e.read_shift(2),s.fStyle=s.flags>>2&1,t-=6,s.data=wI(e,t,s.fStyle,r),s}function Jy(e,t,r,s){var n=r&&r.biff==5;s||(s=ae(n?16:20)),s.write_shift(2,0),e.style?(s.write_shift(2,e.numFmtId||0),s.write_shift(2,65524)):(s.write_shift(2,e.numFmtId||0),s.write_shift(2,t<<4));var a=0;return e.numFmtId>0&&n&&(a|=1024),s.write_shift(4,a),s.write_shift(4,0),n||s.write_shift(4,0),s.write_shift(2,0),s}function bI(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function SI(e){var t=ae(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function Qy(e,t,r){var s=dn(e);(r.biff==2||t==9)&&++e.l;var n=T8(e);return s.val=n,s.t=n===!0||n===!1?"b":"e",s}function kI(e,t,r,s,n,a){var i=ae(8);return ri(e,t,s,i),OE(r,a,i),i}function EI(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var s=dn(e),n=br(e);return s.val=n,s}function TI(e,t,r,s){var n=ae(14);return ri(e,t,s,n),ei(r,n),n}var Zy=D8;function NI(e,t,r){var s=e.l+t,n=e.read_shift(2),a=e.read_shift(2);if(r.sbcch=a,a==1025||a==14849)return[a,n];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var i=ti(e,a),o=[];s>e.l;)o.push(Cc(e));return[a,n,i,o]}function ew(e,t,r){var s=e.read_shift(2),n,a={fBuiltIn:s&1,fWantAdvise:s>>>1&1,fWantPict:s>>>2&1,fOle:s>>>3&1,fOleLink:s>>>4&1,cf:s>>>5&1023,fIcon:s>>>15&1};return r.sbcch===14849&&(n=M8(e,t-2,r)),a.body=n||e.read_shift(t-2),typeof n=="string"&&(a.Name=n),a}var jI=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function tw(e,t,r){var s=e.l+t,n=e.read_shift(2),a=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),c=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var u=ti(e,i,r);n&32&&(u=jI[u.charCodeAt(0)]);var d=s-e.l;r&&r.biff==2&&--d;var f=s==e.l||o===0||!(d>0)?[]:z7(e,d,r,o);return{chKey:a,Name:u,itab:c,rgce:f}}function VE(e,t,r){if(r.biff<8)return CI(e,t,r);for(var s=[],n=e.l+t,a=e.read_shift(r.biff>8?4:2);a--!==0;)s.push(L8(e,r.biff>8?12:6,r));if(e.l!=n)throw new Error("Bad ExternSheet: "+e.l+" != "+n);return s}function CI(e,t,r){e[e.l+1]==3&&e[e.l]++;var s=jc(e,t,r);return s.charCodeAt(0)==3?s.slice(1):s}function AI(e,t,r){if(r.biff<8){e.l+=t;return}var s=e.read_shift(2),n=e.read_shift(2),a=ti(e,s,r),i=ti(e,n,r);return[a,i]}function FI(e,t,r){var s=UE(e);e.l++;var n=e.read_shift(1);return t-=8,[W7(e,t,r),n,s]}function rw(e,t,r){var s=B8(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[s,$7(e,t,r)]}function PI(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,s=e.read_shift(4);return[t,r,s]}function RI(e,t,r){if(!(r.biff<8)){var s=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),o=di(e,0,r);return r.biff<8&&e.read_shift(1),[{r:s,c:n},o,i,a]}}function OI(e,t,r){return RI(e,t,r)}function II(e,t){for(var r=[],s=e.read_shift(2);s--;)r.push(p0(e));return r}function DI(e){var t=ae(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)BE(e[r],t);return t}function LI(e,t,r){if(r&&r.biff<8)return BI(e,t,r);var s=$E(e),n=z8(e,t-22,s[1]);return{cmo:s,ft:n}}var MI={8:function(e,t){var r=e.l+t;e.l+=10;var s=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var n=e.read_shift(1);return e.l+=n,e.l=r,{fmt:s}}};function BI(e,t,r){e.l+=4;var s=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var i=[];return i.push((MI[s]||Tr)(e,t,r)),{cmo:[n,s,a],ft:i}}function UI(e,t,r){var s=e.l,n="";try{e.l+=4;var a=(r.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(a)==-1?e.l+=6:i=C8(e,6,r);var o=e.read_shift(2);e.read_shift(2),Wt(e,2);var c=e.read_shift(2);e.l+=c;for(var u=1;u<e.lens.length-1;++u){if(e.l-s!=e.lens[u])throw new Error("TxO: bad continue record");var d=e[e.l],f=ti(e,e.lens[u+1]-e.lens[u]-1);if(n+=f,n.length>=(d?o:2*o))break}if(n.length!==o&&n.length!==o*2)throw new Error("cchText: "+o+" != "+n.length);return e.l=s+t,{t:n}}catch{return e.l=s+t,{t:n}}}function $I(e,t){var r=p0(e);e.l+=16;var s=R8(e,t-24);return[r,s]}function VI(e){var t=ae(24),r=jt(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var s="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<16;++n)t.write_shift(1,parseInt(s[n],16));return rr([t,O8(e[1])])}function zI(e,t){e.read_shift(2);var r=p0(e),s=e.read_shift((t-10)/2,"dbcs-cont");return s=s.replace(Lr,""),[r,s]}function WI(e){var t=e[1].Tooltip,r=ae(10+2*(t.length+1));r.write_shift(2,2048);var s=jt(e[0]);r.write_shift(2,s.r),r.write_shift(2,s.r),r.write_shift(2,s.c),r.write_shift(2,s.c);for(var n=0;n<t.length;++n)r.write_shift(2,t.charCodeAt(n));return r.write_shift(2,0),r}function HI(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=Uy[r]||r,r=e.read_shift(2),t[1]=Uy[r]||r,t}function qI(e){return e||(e=ae(4)),e.write_shift(2,1),e.write_shift(2,1),e}function GI(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(LE(e));return r}function KI(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(LE(e));return r}function XI(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function zE(e,t,r){if(!r.cellStyles)return Tr(e,t);var s=r&&r.biff>=12?4:2,n=e.read_shift(s),a=e.read_shift(s),i=e.read_shift(s),o=e.read_shift(s),c=e.read_shift(2);s==2&&(e.l+=2);var u={s:n,e:a,w:i,ixfe:o,flags:c};return(r.biff>=5||!r.biff)&&(u.level=c>>8&7),u}function YI(e,t){var r=ae(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var s=0;return e.hidden&&(s|=1),r.write_shift(1,s),s=e.level||0,r.write_shift(1,s),r.write_shift(2,0),r}function JI(e,t){var r={};return t<32||(e.l+=16,r.header=br(e),r.footer=br(e),e.l+=2),r}function QI(e,t,r){var s={area:!1};if(r.biff!=5)return e.l+=t,s;var n=e.read_shift(1);return e.l+=3,n&16&&(s.area=!0),s}function ZI(e){for(var t=ae(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var eD=dn,tD=RE,rD=Cc;function sD(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(4),n={fmt:t,env:r,len:s,data:e.slice(e.l,e.l+s)};return e.l+=s,n}function nD(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var s=dn(e);++e.l;var n=di(e,t-7,r);return s.t="str",s.val=n,s}function aD(e){var t=dn(e);++e.l;var r=br(e);return t.t="n",t.val=r,t}function iD(e,t,r){var s=ae(15);return Rc(s,e,t),s.write_shift(8,r,"f"),s}function oD(e){var t=dn(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function lD(e,t,r){var s=ae(9);return Rc(s,e,t),s.write_shift(2,r),s}function cD(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function uD(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function dD(e,t,r){var s=e.l+t,n=dn(e),a=e.read_shift(2),i=ti(e,a,r);return e.l=s,n.t="str",n.val=i,n}var fD=[2,3,48,49,131,139,140,245],bp=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=d0({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,c){var u=[],d=la(1);switch(c.type){case"base64":d=ss(cs(o));break;case"binary":d=ss(o);break;case"buffer":case"array":d=o;break}cr(d,0);var f=d.read_shift(1),h=!!(f&136),m=!1,p=!1;switch(f){case 2:break;case 3:break;case 48:m=!0,h=!0;break;case 49:m=!0,h=!0;break;case 131:break;case 139:break;case 140:p=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var x=0,v=521;f==2&&(x=d.read_shift(2)),d.l+=3,f!=2&&(x=d.read_shift(4)),x>1048576&&(x=1e6),f!=2&&(v=d.read_shift(2));var y=d.read_shift(2),w=c.codepage||1252;f!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(w=e[d[d.l]]),d.l+=1,d.l+=2),p&&(d.l+=36);for(var g=[],_={},b=Math.min(d.length,f==2?521:v-10-(m?264:0)),k=p?32:11;d.l<b&&d[d.l]!=13;)switch(_={},_.name=tc.utils.decode(w,d.slice(d.l,d.l+k)).replace(/[\u0000\r\n].*$/g,""),d.l+=k,_.type=String.fromCharCode(d.read_shift(1)),f!=2&&!p&&(_.offset=d.read_shift(4)),_.len=d.read_shift(1),f==2&&(_.offset=d.read_shift(2)),_.dec=d.read_shift(1),_.name.length&&g.push(_),f!=2&&(d.l+=p?13:14),_.type){case"B":(!m||_.len!=8)&&c.WTF&&console.log("Skipping "+_.name+":"+_.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+_.name+":"+_.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+_.type)}if(d[d.l]!==13&&(d.l=v-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=v;var S=0,T=0;for(u[0]=[],T=0;T!=g.length;++T)u[0][T]=g[T].name;for(;x-- >0;){if(d[d.l]===42){d.l+=y;continue}for(++d.l,u[++S]=[],T=0,T=0;T!=g.length;++T){var j=d.slice(d.l,d.l+g[T].len);d.l+=g[T].len,cr(j,0);var U=tc.utils.decode(w,j);switch(g[T].type){case"C":U.trim().length&&(u[S][T]=U.replace(/\s+$/,""));break;case"D":U.length===8?u[S][T]=new Date(+U.slice(0,4),+U.slice(4,6)-1,+U.slice(6,8)):u[S][T]=U;break;case"F":u[S][T]=parseFloat(U.trim());break;case"+":case"I":u[S][T]=p?j.read_shift(-4,"i")^2147483648:j.read_shift(4,"i");break;case"L":switch(U.trim().toUpperCase()){case"Y":case"T":u[S][T]=!0;break;case"N":case"F":u[S][T]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+U+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));u[S][T]="##MEMO##"+(p?parseInt(U.trim(),10):j.read_shift(4));break;case"N":U=U.replace(/\u0000/g,"").trim(),U&&U!="."&&(u[S][T]=+U||0);break;case"@":u[S][T]=new Date(j.read_shift(-8,"f")-621356832e5);break;case"T":u[S][T]=new Date((j.read_shift(4)-2440588)*864e5+j.read_shift(4));break;case"Y":u[S][T]=j.read_shift(4,"i")/1e4+j.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[S][T]=-j.read_shift(-8,"f");break;case"B":if(m&&g[T].len==8){u[S][T]=j.read_shift(8,"f");break}case"G":case"P":j.l+=g[T].len;break;case"0":if(g[T].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+g[T].type)}}}if(f!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=g,u}function s(o,c){var u=c||{};u.dateNF||(u.dateNF="yyyymmdd");var d=Fo(r(o,u),u);return d["!cols"]=u.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete u.DBF,d}function n(o,c){try{return va(s(o,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function i(o,c){var u=c||{};if(+u.codepage>=0&&zs(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var d=Kr(),f=Ld(o,{header:1,raw:!0,cellDates:!0}),h=f[0],m=f.slice(1),p=o["!cols"]||[],x=0,v=0,y=0,w=1;for(x=0;x<h.length;++x){if(((p[x]||{}).DBF||{}).name){h[x]=p[x].DBF.name,++y;continue}if(h[x]!=null){if(++y,typeof h[x]=="number"&&(h[x]=h[x].toString(10)),typeof h[x]!="string")throw new Error("DBF Invalid column name "+h[x]+" |"+typeof h[x]+"|");if(h.indexOf(h[x])!==x){for(v=0;v<1024;++v)if(h.indexOf(h[x]+"_"+v)==-1){h[x]+="_"+v;break}}}}var g=et(o["!ref"]),_=[],b=[],k=[];for(x=0;x<=g.e.c-g.s.c;++x){var S="",T="",j=0,U=[];for(v=0;v<m.length;++v)m[v][x]!=null&&U.push(m[v][x]);if(U.length==0||h[x]==null){_[x]="?";continue}for(v=0;v<U.length;++v){switch(typeof U[v]){case"number":T="B";break;case"string":T="C";break;case"boolean":T="L";break;case"object":T=U[v]instanceof Date?"D":"C";break;default:T="C"}j=Math.max(j,String(U[v]).length),S=S&&S!=T?"C":T}j>250&&(j=250),T=((p[x]||{}).DBF||{}).type,T=="C"&&p[x].DBF.len>j&&(j=p[x].DBF.len),S=="B"&&T=="N"&&(S="N",k[x]=p[x].DBF.dec,j=p[x].DBF.len),b[x]=S=="C"||T=="N"?j:a[S]||0,w+=b[x],_[x]=S}var H=d.next(32);for(H.write_shift(4,318902576),H.write_shift(4,m.length),H.write_shift(2,296+32*y),H.write_shift(2,w),x=0;x<4;++x)H.write_shift(4,0);for(H.write_shift(4,0|(+t[Pk]||3)<<8),x=0,v=0;x<h.length;++x)if(h[x]!=null){var z=d.next(32),q=(h[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);z.write_shift(1,q,"sbcs"),z.write_shift(1,_[x]=="?"?"C":_[x],"sbcs"),z.write_shift(4,v),z.write_shift(1,b[x]||a[_[x]]||0),z.write_shift(1,k[x]||0),z.write_shift(1,2),z.write_shift(4,0),z.write_shift(1,0),z.write_shift(4,0),z.write_shift(4,0),v+=b[x]||a[_[x]]||0}var re=d.next(264);for(re.write_shift(4,13),x=0;x<65;++x)re.write_shift(4,0);for(x=0;x<m.length;++x){var X=d.next(w);for(X.write_shift(1,0),v=0;v<h.length;++v)if(h[v]!=null)switch(_[v]){case"L":X.write_shift(1,m[x][v]==null?63:m[x][v]?84:70);break;case"B":X.write_shift(8,m[x][v]||0,"f");break;case"N":var M="0";for(typeof m[x][v]=="number"&&(M=m[x][v].toFixed(k[v]||0)),y=0;y<b[v]-M.length;++y)X.write_shift(1,32);X.write_shift(1,M,"sbcs");break;case"D":m[x][v]?(X.write_shift(4,("0000"+m[x][v].getFullYear()).slice(-4),"sbcs"),X.write_shift(2,("00"+(m[x][v].getMonth()+1)).slice(-2),"sbcs"),X.write_shift(2,("00"+m[x][v].getDate()).slice(-2),"sbcs")):X.write_shift(8,"00000000","sbcs");break;case"C":var J=String(m[x][v]!=null?m[x][v]:"").slice(0,b[v]);for(X.write_shift(1,J,"sbcs"),y=0;y<b[v]-J.length;++y)X.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:n,to_sheet:s,from_sheet:i}}(),WE=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+It(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,m){var p=e[m];return typeof p=="number"?hy(p):p},s=function(h,m,p){var x=m.charCodeAt(0)-32<<4|p.charCodeAt(0)-48;return x==59?h:hy(x)};e["|"]=254;function n(h,m){switch(m.type){case"base64":return a(cs(h),m);case"binary":return a(h,m);case"buffer":return a(qe&&Buffer.isBuffer(h)?h.toString("binary"):ga(h),m);case"array":return a(Za(h),m)}throw new Error("Unrecognized type "+m.type)}function a(h,m){var p=h.split(/[\n\r]+/),x=-1,v=-1,y=0,w=0,g=[],_=[],b=null,k={},S=[],T=[],j=[],U=0,H;for(+m.codepage>=0&&zs(+m.codepage);y!==p.length;++y){U=0;var z=p[y].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,s).replace(t,r),q=z.replace(/;;/g,"\0").split(";").map(function(B){return B.replace(/\u0000/g,";")}),re=q[0],X;if(z.length>0)switch(re){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":q[1].charAt(0)=="P"&&_.push(z.slice(3).replace(/;;/g,";"));break;case"C":var M=!1,J=!1,G=!1,D=!1,K=-1,oe=-1;for(w=1;w<q.length;++w)switch(q[w].charAt(0)){case"A":break;case"X":v=parseInt(q[w].slice(1))-1,J=!0;break;case"Y":for(x=parseInt(q[w].slice(1))-1,J||(v=0),H=g.length;H<=x;++H)g[H]=[];break;case"K":X=q[w].slice(1),X.charAt(0)==='"'?X=X.slice(1,X.length-1):X==="TRUE"?X=!0:X==="FALSE"?X=!1:isNaN(Gs(X))?isNaN(xo(X).getDate())||(X=pt(X)):(X=Gs(X),b!==null&&Co(b)&&(X=h0(X))),M=!0;break;case"E":D=!0;var N=eo(q[w].slice(1),{r:x,c:v});g[x][v]=[g[x][v],N];break;case"S":G=!0,g[x][v]=[g[x][v],"S5S"];break;case"G":break;case"R":K=parseInt(q[w].slice(1))-1;break;case"C":oe=parseInt(q[w].slice(1))-1;break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+z)}if(M&&(g[x][v]&&g[x][v].length==2?g[x][v][0]=X:g[x][v]=X,b=null),G){if(D)throw new Error("SYLK shared formula cannot have own formula");var W=K>-1&&g[K][oe];if(!W||!W[1])throw new Error("SYLK shared formula cannot find base");g[x][v][1]=lT(W[1],{r:x-K,c:v-oe})}break;case"F":var I=0;for(w=1;w<q.length;++w)switch(q[w].charAt(0)){case"X":v=parseInt(q[w].slice(1))-1,++I;break;case"Y":for(x=parseInt(q[w].slice(1))-1,H=g.length;H<=x;++H)g[H]=[];break;case"M":U=parseInt(q[w].slice(1))/20;break;case"F":break;case"G":break;case"P":b=_[parseInt(q[w].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(j=q[w].slice(1).split(" "),H=parseInt(j[0],10);H<=parseInt(j[1],10);++H)U=parseInt(j[2],10),T[H-1]=U===0?{hidden:!0}:{wch:U},ca(T[H-1]);break;case"C":v=parseInt(q[w].slice(1))-1,T[v]||(T[v]={});break;case"R":x=parseInt(q[w].slice(1))-1,S[x]||(S[x]={}),U>0?(S[x].hpt=U,S[x].hpx=vo(U)):U===0&&(S[x].hidden=!0);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+z)}I<1&&(b=null);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+z)}}return S.length>0&&(k["!rows"]=S),T.length>0&&(k["!cols"]=T),m&&m.sheetRows&&(g=g.slice(0,m.sheetRows)),[g,k]}function i(h,m){var p=n(h,m),x=p[0],v=p[1],y=Fo(x,m);return It(v).forEach(function(w){y[w]=v[w]}),y}function o(h,m){return va(i(h,m),m)}function c(h,m,p,x){var v="C;Y"+(p+1)+";X"+(x+1)+";K";switch(h.t){case"n":v+=h.v||0,h.f&&!h.F&&(v+=";E"+Xx(h.f,{r:p,c:x}));break;case"b":v+=h.v?"TRUE":"FALSE";break;case"e":v+=h.w||h.v;break;case"d":v+='"'+(h.w||h.v)+'"';break;case"s":v+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return v}function u(h,m){m.forEach(function(p,x){var v="F;W"+(x+1)+" "+(x+1)+" ";p.hidden?v+="0":(typeof p.width=="number"&&!p.wpx&&(p.wpx=cc(p.width)),typeof p.wpx=="number"&&!p.wch&&(p.wch=uc(p.wpx)),typeof p.wch=="number"&&(v+=Math.round(p.wch))),v.charAt(v.length-1)!=" "&&h.push(v)})}function d(h,m){m.forEach(function(p,x){var v="F;";p.hidden?v+="M0;":p.hpt?v+="M"+20*p.hpt+";":p.hpx&&(v+="M"+20*dc(p.hpx)+";"),v.length>2&&h.push(v+"R"+(x+1))})}function f(h,m){var p=["ID;PWXL;N;E"],x=[],v=et(h["!ref"]),y,w=Array.isArray(h),g=`\r
`;p.push("P;PGeneral"),p.push("F;P0;DG0G8;M255"),h["!cols"]&&u(p,h["!cols"]),h["!rows"]&&d(p,h["!rows"]),p.push("B;Y"+(v.e.r-v.s.r+1)+";X"+(v.e.c-v.s.c+1)+";D"+[v.s.c,v.s.r,v.e.c,v.e.r].join(" "));for(var _=v.s.r;_<=v.e.r;++_)for(var b=v.s.c;b<=v.e.c;++b){var k=Le({r:_,c:b});y=w?(h[_]||[])[b]:h[k],!(!y||y.v==null&&(!y.f||y.F))&&x.push(c(y,h,_,b))}return p.join(g)+g+x.join(g)+g+"E"+g}return{to_workbook:o,to_sheet:i,from_sheet:f}}(),HE=function(){function e(a,i){switch(i.type){case"base64":return t(cs(a),i);case"binary":return t(a,i);case"buffer":return t(qe&&Buffer.isBuffer(a)?a.toString("binary"):ga(a),i);case"array":return t(Za(a),i)}throw new Error("Unrecognized type "+i.type)}function t(a,i){for(var o=a.split(`
`),c=-1,u=-1,d=0,f=[];d!==o.length;++d){if(o[d].trim()==="BOT"){f[++c]=[],u=0;continue}if(!(c<0)){var h=o[d].trim().split(","),m=h[0],p=h[1];++d;for(var x=o[d]||"";(x.match(/["]/g)||[]).length&1&&d<o.length-1;)x+=`
`+o[++d];switch(x=x.trim(),+m){case-1:if(x==="BOT"){f[++c]=[],u=0;continue}else if(x!=="EOD")throw new Error("Unrecognized DIF special command "+x);break;case 0:x==="TRUE"?f[c][u]=!0:x==="FALSE"?f[c][u]=!1:isNaN(Gs(p))?isNaN(xo(p).getDate())?f[c][u]=p:f[c][u]=pt(p):f[c][u]=Gs(p),++u;break;case 1:x=x.slice(1,x.length-1),x=x.replace(/""/g,'"'),x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),f[c][u++]=x!==""?x:null;break}if(x==="EOD")break}}return i&&i.sheetRows&&(f=f.slice(0,i.sheetRows)),f}function r(a,i){return Fo(e(a,i),i)}function s(a,i){return va(r(a,i),i)}var n=function(){var a=function(c,u,d,f,h){c.push(u),c.push(d+","+f),c.push('"'+h.replace(/"/g,'""')+'"')},i=function(c,u,d,f){c.push(u+","+d),c.push(u==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(c){var u=[],d=et(c["!ref"]),f,h=Array.isArray(c);a(u,"TABLE",0,1,"sheetjs"),a(u,"VECTORS",0,d.e.r-d.s.r+1,""),a(u,"TUPLES",0,d.e.c-d.s.c+1,""),a(u,"DATA",0,0,"");for(var m=d.s.r;m<=d.e.r;++m){i(u,-1,0,"BOT");for(var p=d.s.c;p<=d.e.c;++p){var x=Le({r:m,c:p});if(f=h?(c[m]||[])[p]:c[x],!f){i(u,1,0,"");continue}switch(f.t){case"n":var v=f.w;!v&&f.v!=null&&(v=f.v),v==null?f.f&&!f.F?i(u,1,0,"="+f.f):i(u,1,0,""):i(u,0,v,"V");break;case"b":i(u,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":i(u,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=Ps(f.z||De[14],Zt(pt(f.v)))),i(u,0,f.w,"V");break;default:i(u,1,0,"")}}}i(u,-1,0,"EOD");var y=`\r
`,w=u.join(y);return w}}();return{to_workbook:s,to_sheet:r,from_sheet:n}}(),qE=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,h){for(var m=f.split(`
`),p=-1,x=-1,v=0,y=[];v!==m.length;++v){var w=m[v].trim().split(":");if(w[0]==="cell"){var g=jt(w[1]);if(y.length<=g.r)for(p=y.length;p<=g.r;++p)y[p]||(y[p]=[]);switch(p=g.r,x=g.c,w[2]){case"t":y[p][x]=e(w[3]);break;case"v":y[p][x]=+w[3];break;case"vtf":var _=w[w.length-1];case"vtc":switch(w[3]){case"nl":y[p][x]=!!+w[4];break;default:y[p][x]=+w[4];break}w[2]=="vtf"&&(y[p][x]=[y[p][x],_])}}}return h&&h.sheetRows&&(y=y.slice(0,h.sheetRows)),y}function s(f,h){return Fo(r(f,h),h)}function n(f,h){return va(s(f,h),h)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function u(f){if(!f||!f["!ref"])return"";for(var h=[],m=[],p,x="",v=Xr(f["!ref"]),y=Array.isArray(f),w=v.s.r;w<=v.e.r;++w)for(var g=v.s.c;g<=v.e.c;++g)if(x=Le({r:w,c:g}),p=y?(f[w]||[])[g]:f[x],!(!p||p.v==null||p.t==="z")){switch(m=["cell",x,"t"],p.t){case"s":case"str":m.push(t(p.v));break;case"n":p.f?(m[2]="vtf",m[3]="n",m[4]=p.v,m[5]=t(p.f)):(m[2]="v",m[3]=p.v);break;case"b":m[2]="vt"+(p.f?"f":"c"),m[3]="nl",m[4]=p.v?"1":"0",m[5]=t(p.f||(p.v?"TRUE":"FALSE"));break;case"d":var _=Zt(pt(p.v));m[2]="vtc",m[3]="nd",m[4]=""+_,m[5]=p.w||Ps(p.z||De[14],_);break;case"e":continue}h.push(m.join(":"))}return h.push("sheet:c:"+(v.e.c-v.s.c+1)+":r:"+(v.e.r-v.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function d(f){return[a,i,o,i,u(f),c].join(`
`)}return{to_workbook:n,to_sheet:s,from_sheet:d}}(),go=function(){function e(d,f,h,m,p){p.raw?f[h][m]=d:d===""||(d==="TRUE"?f[h][m]=!0:d==="FALSE"?f[h][m]=!1:isNaN(Gs(d))?isNaN(xo(d).getDate())?f[h][m]=d:f[h][m]=pt(d):f[h][m]=Gs(d))}function t(d,f){var h=f||{},m=[];if(!d||d.length===0)return m;for(var p=d.split(/[\r\n]/),x=p.length-1;x>=0&&p[x].length===0;)--x;for(var v=10,y=0,w=0;w<=x;++w)y=p[w].indexOf(" "),y==-1?y=p[w].length:y++,v=Math.max(v,y);for(w=0;w<=x;++w){m[w]=[];var g=0;for(e(p[w].slice(0,v).trim(),m,w,g,h),g=1;g<=(p[w].length-v)/10+1;++g)e(p[w].slice(v+(g-1)*10,v+g*10).trim(),m,w,g,h)}return h.sheetRows&&(m=m.slice(0,h.sheetRows)),m}var r={44:",",9:"	",59:";",124:"|"},s={44:3,9:2,59:1,124:0};function n(d){for(var f={},h=!1,m=0,p=0;m<d.length;++m)(p=d.charCodeAt(m))==34?h=!h:!h&&p in r&&(f[p]=(f[p]||0)+1);p=[];for(m in f)Object.prototype.hasOwnProperty.call(f,m)&&p.push([f[m],m]);if(!p.length){f=s;for(m in f)Object.prototype.hasOwnProperty.call(f,m)&&p.push([f[m],m])}return p.sort(function(x,v){return x[0]-v[0]||s[x[1]]-s[v[1]]}),r[p.pop()[1]]||44}function a(d,f){var h=f||{},m="",p=h.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(m=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(m=d.charAt(4),d=d.slice(6)):m=n(d.slice(0,1024)):h&&h.FS?m=h.FS:m=n(d.slice(0,1024));var v=0,y=0,w=0,g=0,_=0,b=m.charCodeAt(0),k=!1,S=0,T=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var j=h.dateNF!=null?QR(h.dateNF):null;function U(){var H=d.slice(g,_),z={};if(H.charAt(0)=='"'&&H.charAt(H.length-1)=='"'&&(H=H.slice(1,-1).replace(/""/g,'"')),H.length===0)z.t="z";else if(h.raw)z.t="s",z.v=H;else if(H.trim().length===0)z.t="s",z.v=H;else if(H.charCodeAt(0)==61)H.charCodeAt(1)==34&&H.charCodeAt(H.length-1)==34?(z.t="s",z.v=H.slice(2,-1).replace(/""/g,'"')):NM(H)?(z.t="n",z.f=H.slice(1)):(z.t="s",z.v=H);else if(H=="TRUE")z.t="b",z.v=!0;else if(H=="FALSE")z.t="b",z.v=!1;else if(!isNaN(w=Gs(H)))z.t="n",h.cellText!==!1&&(z.w=H),z.v=w;else if(!isNaN(xo(H).getDate())||j&&H.match(j)){z.z=h.dateNF||De[14];var q=0;j&&H.match(j)&&(H=ZR(H,h.dateNF,H.match(j)||[]),q=1),h.cellDates?(z.t="d",z.v=pt(H,q)):(z.t="n",z.v=Zt(pt(H,q))),h.cellText!==!1&&(z.w=Ps(z.z,z.v instanceof Date?Zt(z.v):z.v)),h.cellNF||delete z.z}else z.t="s",z.v=H;if(z.t=="z"||(h.dense?(p[v]||(p[v]=[]),p[v][y]=z):p[Le({c:y,r:v})]=z),g=_+1,T=d.charCodeAt(g),x.e.c<y&&(x.e.c=y),x.e.r<v&&(x.e.r=v),S==b)++y;else if(y=0,++v,h.sheetRows&&h.sheetRows<=v)return!0}e:for(;_<d.length;++_)switch(S=d.charCodeAt(_)){case 34:T===34&&(k=!k);break;case b:case 10:case 13:if(!k&&U())break e;break}return _-g>0&&U(),p["!ref"]=ze(x),p}function i(d,f){return!(f&&f.PRN)||f.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?a(d,f):Fo(t(d,f),f)}function o(d,f){var h="",m=f.type=="string"?[0,0,0,0]:sg(d,f);switch(f.type){case"base64":h=cs(d);break;case"binary":h=d;break;case"buffer":f.codepage==65001?h=d.toString("utf8"):f.codepage&&typeof tc<"u"||(h=qe&&Buffer.isBuffer(d)?d.toString("binary"):ga(d));break;case"array":h=Za(d);break;case"string":h=d;break;default:throw new Error("Unrecognized type "+f.type)}return m[0]==239&&m[1]==187&&m[2]==191?h=ot(h.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?h=ot(h):f.type=="binary"&&typeof tc<"u",h.slice(0,19)=="socialcalc:version:"?qE.to_sheet(f.type=="string"?h:ot(h),f):i(h,f)}function c(d,f){return va(o(d,f),f)}function u(d){for(var f=[],h=et(d["!ref"]),m,p=Array.isArray(d),x=h.s.r;x<=h.e.r;++x){for(var v=[],y=h.s.c;y<=h.e.c;++y){var w=Le({r:x,c:y});if(m=p?(d[x]||[])[y]:d[w],!m||m.v==null){v.push("          ");continue}for(var g=(m.w||(Pn(m),m.w)||"").slice(0,10);g.length<10;)g+=" ";v.push(g+(y===0?" ":""))}f.push(v.join(""))}return f.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:u}}();function hD(e,t){var r=t||{},s=!!r.WTF;r.WTF=!0;try{var n=WE.to_workbook(e,r);return r.WTF=s,n}catch(a){if(r.WTF=s,!a.message.match(/SYLK bad record ID/)&&s)throw a;return go.to_workbook(e,t)}}var Ha=function(){function e(N,W,I){if(N){cr(N,N.l||0);for(var B=I.Enum||K;N.l<N.length;){var ee=N.read_shift(2),le=B[ee]||B[65535],fe=N.read_shift(2),se=N.l+fe,ne=le.f&&le.f(N,fe,I);if(N.l=se,W(ne,le,ee))return}}}function t(N,W){switch(W.type){case"base64":return r(ss(cs(N)),W);case"binary":return r(ss(N),W);case"buffer":case"array":return r(N,W)}throw"Unsupported type "+W.type}function r(N,W){if(!N)return N;var I=W||{},B=I.dense?[]:{},ee="Sheet1",le="",fe=0,se={},ne=[],V=[],C={s:{r:0,c:0},e:{r:0,c:0}},he=I.sheetRows||0;if(N[2]==0&&(N[3]==8||N[3]==9)&&N.length>=16&&N[14]==5&&N[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(N[2]==2)I.Enum=K,e(N,function(me,Ke,de){switch(de){case 0:I.vers=me,me>=4096&&(I.qpro=!0);break;case 6:C=me;break;case 204:me&&(le=me);break;case 222:le=me;break;case 15:case 51:I.qpro||(me[1].v=me[1].v.slice(1));case 13:case 14:case 16:de==14&&(me[2]&112)==112&&(me[2]&15)>1&&(me[2]&15)<15&&(me[1].z=I.dateNF||De[14],I.cellDates&&(me[1].t="d",me[1].v=h0(me[1].v))),I.qpro&&me[3]>fe&&(B["!ref"]=ze(C),se[ee]=B,ne.push(ee),B=I.dense?[]:{},C={s:{r:0,c:0},e:{r:0,c:0}},fe=me[3],ee=le||"Sheet"+(fe+1),le="");var Ee=I.dense?(B[me[0].r]||[])[me[0].c]:B[Le(me[0])];if(Ee){Ee.t=me[1].t,Ee.v=me[1].v,me[1].z!=null&&(Ee.z=me[1].z),me[1].f!=null&&(Ee.f=me[1].f);break}I.dense?(B[me[0].r]||(B[me[0].r]=[]),B[me[0].r][me[0].c]=me[1]):B[Le(me[0])]=me[1];break}},I);else if(N[2]==26||N[2]==14)I.Enum=oe,N[2]==14&&(I.qpro=!0,N.l=0),e(N,function(me,Ke,de){switch(de){case 204:ee=me;break;case 22:me[1].v=me[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(me[3]>fe&&(B["!ref"]=ze(C),se[ee]=B,ne.push(ee),B=I.dense?[]:{},C={s:{r:0,c:0},e:{r:0,c:0}},fe=me[3],ee="Sheet"+(fe+1)),he>0&&me[0].r>=he)break;I.dense?(B[me[0].r]||(B[me[0].r]=[]),B[me[0].r][me[0].c]=me[1]):B[Le(me[0])]=me[1],C.e.c<me[0].c&&(C.e.c=me[0].c),C.e.r<me[0].r&&(C.e.r=me[0].r);break;case 27:me[14e3]&&(V[me[14e3][0]]=me[14e3][1]);break;case 1537:V[me[0]]=me[1],me[0]==fe&&(ee=me[1]);break}},I);else throw new Error("Unrecognized LOTUS BOF "+N[2]);if(B["!ref"]=ze(C),se[le||ee]=B,ne.push(le||ee),!V.length)return{SheetNames:ne,Sheets:se};for(var ve={},ke=[],Ae=0;Ae<V.length;++Ae)se[ne[Ae]]?(ke.push(V[Ae]||ne[Ae]),ve[V[Ae]]=se[V[Ae]]||se[ne[Ae]]):(ke.push(V[Ae]),ve[V[Ae]]={"!ref":"A1"});return{SheetNames:ke,Sheets:ve}}function s(N,W){var I=W||{};if(+I.codepage>=0&&zs(+I.codepage),I.type=="string")throw new Error("Cannot write WK1 to JS string");var B=Kr(),ee=et(N["!ref"]),le=Array.isArray(N),fe=[];_e(B,0,a(1030)),_e(B,6,c(ee));for(var se=Math.min(ee.e.r,8191),ne=ee.s.r;ne<=se;++ne)for(var V=Bt(ne),C=ee.s.c;C<=ee.e.c;++C){ne===ee.s.r&&(fe[C]=Nt(C));var he=fe[C]+V,ve=le?(N[ne]||[])[C]:N[he];if(!(!ve||ve.t=="z"))if(ve.t=="n")(ve.v|0)==ve.v&&ve.v>=-32768&&ve.v<=32767?_e(B,13,m(ne,C,ve.v)):_e(B,14,x(ne,C,ve.v));else{var ke=Pn(ve);_e(B,15,f(ne,C,ke.slice(0,239)))}}return _e(B,1),B.end()}function n(N,W){var I=W||{};if(+I.codepage>=0&&zs(+I.codepage),I.type=="string")throw new Error("Cannot write WK3 to JS string");var B=Kr();_e(B,0,i(N));for(var ee=0,le=0;ee<N.SheetNames.length;++ee)(N.Sheets[N.SheetNames[ee]]||{})["!ref"]&&_e(B,27,D(N.SheetNames[ee],le++));var fe=0;for(ee=0;ee<N.SheetNames.length;++ee){var se=N.Sheets[N.SheetNames[ee]];if(!(!se||!se["!ref"])){for(var ne=et(se["!ref"]),V=Array.isArray(se),C=[],he=Math.min(ne.e.r,8191),ve=ne.s.r;ve<=he;++ve)for(var ke=Bt(ve),Ae=ne.s.c;Ae<=ne.e.c;++Ae){ve===ne.s.r&&(C[Ae]=Nt(Ae));var me=C[Ae]+ke,Ke=V?(se[ve]||[])[Ae]:se[me];if(!(!Ke||Ke.t=="z"))if(Ke.t=="n")_e(B,23,U(ve,Ae,fe,Ke.v));else{var de=Pn(Ke);_e(B,22,S(ve,Ae,fe,de.slice(0,239)))}}++fe}}return _e(B,1),B.end()}function a(N){var W=ae(2);return W.write_shift(2,N),W}function i(N){var W=ae(26);W.write_shift(2,4096),W.write_shift(2,4),W.write_shift(4,0);for(var I=0,B=0,ee=0,le=0;le<N.SheetNames.length;++le){var fe=N.SheetNames[le],se=N.Sheets[fe];if(!(!se||!se["!ref"])){++ee;var ne=Xr(se["!ref"]);I<ne.e.r&&(I=ne.e.r),B<ne.e.c&&(B=ne.e.c)}}return I>8191&&(I=8191),W.write_shift(2,I),W.write_shift(1,ee),W.write_shift(1,B),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(1,1),W.write_shift(1,2),W.write_shift(4,0),W.write_shift(4,0),W}function o(N,W,I){var B={s:{c:0,r:0},e:{c:0,r:0}};return W==8&&I.qpro?(B.s.c=N.read_shift(1),N.l++,B.s.r=N.read_shift(2),B.e.c=N.read_shift(1),N.l++,B.e.r=N.read_shift(2),B):(B.s.c=N.read_shift(2),B.s.r=N.read_shift(2),W==12&&I.qpro&&(N.l+=2),B.e.c=N.read_shift(2),B.e.r=N.read_shift(2),W==12&&I.qpro&&(N.l+=2),B.s.c==65535&&(B.s.c=B.e.c=B.s.r=B.e.r=0),B)}function c(N){var W=ae(8);return W.write_shift(2,N.s.c),W.write_shift(2,N.s.r),W.write_shift(2,N.e.c),W.write_shift(2,N.e.r),W}function u(N,W,I){var B=[{c:0,r:0},{t:"n",v:0},0,0];return I.qpro&&I.vers!=20768?(B[0].c=N.read_shift(1),B[3]=N.read_shift(1),B[0].r=N.read_shift(2),N.l+=2):(B[2]=N.read_shift(1),B[0].c=N.read_shift(2),B[0].r=N.read_shift(2)),B}function d(N,W,I){var B=N.l+W,ee=u(N,W,I);if(ee[1].t="s",I.vers==20768){N.l++;var le=N.read_shift(1);return ee[1].v=N.read_shift(le,"utf8"),ee}return I.qpro&&N.l++,ee[1].v=N.read_shift(B-N.l,"cstr"),ee}function f(N,W,I){var B=ae(7+I.length);B.write_shift(1,255),B.write_shift(2,W),B.write_shift(2,N),B.write_shift(1,39);for(var ee=0;ee<B.length;++ee){var le=I.charCodeAt(ee);B.write_shift(1,le>=128?95:le)}return B.write_shift(1,0),B}function h(N,W,I){var B=u(N,W,I);return B[1].v=N.read_shift(2,"i"),B}function m(N,W,I){var B=ae(7);return B.write_shift(1,255),B.write_shift(2,W),B.write_shift(2,N),B.write_shift(2,I,"i"),B}function p(N,W,I){var B=u(N,W,I);return B[1].v=N.read_shift(8,"f"),B}function x(N,W,I){var B=ae(13);return B.write_shift(1,255),B.write_shift(2,W),B.write_shift(2,N),B.write_shift(8,I,"f"),B}function v(N,W,I){var B=N.l+W,ee=u(N,W,I);if(ee[1].v=N.read_shift(8,"f"),I.qpro)N.l=B;else{var le=N.read_shift(2);_(N.slice(N.l,N.l+le),ee),N.l+=le}return ee}function y(N,W,I){var B=W&32768;return W&=-32769,W=(B?N:0)+(W>=8192?W-16384:W),(B?"":"$")+(I?Nt(W):Bt(W))}var w={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},g=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function _(N,W){cr(N,0);for(var I=[],B=0,ee="",le="",fe="",se="";N.l<N.length;){var ne=N[N.l++];switch(ne){case 0:I.push(N.read_shift(8,"f"));break;case 1:le=y(W[0].c,N.read_shift(2),!0),ee=y(W[0].r,N.read_shift(2),!1),I.push(le+ee);break;case 2:{var V=y(W[0].c,N.read_shift(2),!0),C=y(W[0].r,N.read_shift(2),!1);le=y(W[0].c,N.read_shift(2),!0),ee=y(W[0].r,N.read_shift(2),!1),I.push(V+C+":"+le+ee)}break;case 3:if(N.l<N.length){console.error("WK1 premature formula end");return}break;case 4:I.push("("+I.pop()+")");break;case 5:I.push(N.read_shift(2));break;case 6:{for(var he="";ne=N[N.l++];)he+=String.fromCharCode(ne);I.push('"'+he.replace(/"/g,'""')+'"')}break;case 8:I.push("-"+I.pop());break;case 23:I.push("+"+I.pop());break;case 22:I.push("NOT("+I.pop()+")");break;case 20:case 21:se=I.pop(),fe=I.pop(),I.push(["AND","OR"][ne-20]+"("+fe+","+se+")");break;default:if(ne<32&&g[ne])se=I.pop(),fe=I.pop(),I.push(fe+g[ne]+se);else if(w[ne]){if(B=w[ne][1],B==69&&(B=N[N.l++]),B>I.length){console.error("WK1 bad formula parse 0x"+ne.toString(16)+":|"+I.join("|")+"|");return}var ve=I.slice(-B);I.length-=B,I.push(w[ne][0]+"("+ve.join(",")+")")}else return ne<=7?console.error("WK1 invalid opcode "+ne.toString(16)):ne<=24?console.error("WK1 unsupported op "+ne.toString(16)):ne<=30?console.error("WK1 invalid opcode "+ne.toString(16)):ne<=115?console.error("WK1 unsupported function opcode "+ne.toString(16)):console.error("WK1 unrecognized opcode "+ne.toString(16))}}I.length==1?W[1].f=""+I[0]:console.error("WK1 bad formula parse |"+I.join("|")+"|")}function b(N){var W=[{c:0,r:0},{t:"n",v:0},0];return W[0].r=N.read_shift(2),W[3]=N[N.l++],W[0].c=N[N.l++],W}function k(N,W){var I=b(N);return I[1].t="s",I[1].v=N.read_shift(W-4,"cstr"),I}function S(N,W,I,B){var ee=ae(6+B.length);ee.write_shift(2,N),ee.write_shift(1,I),ee.write_shift(1,W),ee.write_shift(1,39);for(var le=0;le<B.length;++le){var fe=B.charCodeAt(le);ee.write_shift(1,fe>=128?95:fe)}return ee.write_shift(1,0),ee}function T(N,W){var I=b(N);I[1].v=N.read_shift(2);var B=I[1].v>>1;if(I[1].v&1)switch(B&7){case 0:B=(B>>3)*5e3;break;case 1:B=(B>>3)*500;break;case 2:B=(B>>3)/20;break;case 3:B=(B>>3)/200;break;case 4:B=(B>>3)/2e3;break;case 5:B=(B>>3)/2e4;break;case 6:B=(B>>3)/16;break;case 7:B=(B>>3)/64;break}return I[1].v=B,I}function j(N,W){var I=b(N),B=N.read_shift(4),ee=N.read_shift(4),le=N.read_shift(2);if(le==65535)return B===0&&ee===3221225472?(I[1].t="e",I[1].v=15):B===0&&ee===3489660928?(I[1].t="e",I[1].v=42):I[1].v=0,I;var fe=le&32768;return le=(le&32767)-16446,I[1].v=(1-fe*2)*(ee*Math.pow(2,le+32)+B*Math.pow(2,le)),I}function U(N,W,I,B){var ee=ae(14);if(ee.write_shift(2,N),ee.write_shift(1,I),ee.write_shift(1,W),B==0)return ee.write_shift(4,0),ee.write_shift(4,0),ee.write_shift(2,65535),ee;var le=0,fe=0,se=0,ne=0;return B<0&&(le=1,B=-B),fe=Math.log2(B)|0,B/=Math.pow(2,fe-31),ne=B>>>0,ne&2147483648||(B/=2,++fe,ne=B>>>0),B-=ne,ne|=2147483648,ne>>>=0,B*=Math.pow(2,32),se=B>>>0,ee.write_shift(4,se),ee.write_shift(4,ne),fe+=16383+(le?32768:0),ee.write_shift(2,fe),ee}function H(N,W){var I=j(N);return N.l+=W-14,I}function z(N,W){var I=b(N),B=N.read_shift(4);return I[1].v=B>>6,I}function q(N,W){var I=b(N),B=N.read_shift(8,"f");return I[1].v=B,I}function re(N,W){var I=q(N);return N.l+=W-10,I}function X(N,W){return N[N.l+W-1]==0?N.read_shift(W,"cstr"):""}function M(N,W){var I=N[N.l++];I>W-1&&(I=W-1);for(var B="";B.length<I;)B+=String.fromCharCode(N[N.l++]);return B}function J(N,W,I){if(!(!I.qpro||W<21)){var B=N.read_shift(1);N.l+=17,N.l+=1,N.l+=2;var ee=N.read_shift(W-21,"cstr");return[B,ee]}}function G(N,W){for(var I={},B=N.l+W;N.l<B;){var ee=N.read_shift(2);if(ee==14e3){for(I[ee]=[0,""],I[ee][0]=N.read_shift(2);N[N.l];)I[ee][1]+=String.fromCharCode(N[N.l]),N.l++;N.l++}}return I}function D(N,W){var I=ae(5+N.length);I.write_shift(2,14e3),I.write_shift(2,W);for(var B=0;B<N.length;++B){var ee=N.charCodeAt(B);I[I.l++]=ee>127?95:ee}return I[I.l++]=0,I}var K={0:{n:"BOF",f:Wt},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:p},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:v},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:X},222:{n:"SHEETNAMELP",f:M},65535:{n:""}},oe={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:k},23:{n:"NUMBER17",f:j},24:{n:"NUMBER18",f:T},25:{n:"FORMULA19",f:H},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:G},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:z},38:{n:"??"},39:{n:"NUMBER27",f:q},40:{n:"FORMULA28",f:re},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:X},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:J},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:s,book_to_wk3:n,to_workbook:t}}();function pD(e){var t={},r=e.match(Nr),s=0,n=!1;if(r)for(;s!=r.length;++s){var a=Ue(r[s]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;t.cp=wx[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=a.val;break;case"<sz":t.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":a.rgb&&(t.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(a[0].charCodeAt(1)!==47&&!n)throw new Error("Unrecognized rich format "+a[0])}}return t}var mD=function(){var e=nc("t"),t=nc("rPr");function r(a){var i=a.match(e);if(!i)return{t:"s",v:""};var o={t:"s",v:Ze(i[1])},c=a.match(t);return c&&(o.s=pD(c[1])),o}var s=/<(?:\w+:)?r>/g,n=/<\/(?:\w+:)?r>/;return function(i){return i.replace(s,"").split(n).map(r).filter(function(o){return o.v})}}(),xD=function(){var t=/(\r\n|\n)/g;function r(n,a,i){var o=[];n.u&&o.push("text-decoration: underline;"),n.uval&&o.push("text-underline-style:"+n.uval+";"),n.sz&&o.push("font-size:"+n.sz+"pt;"),n.outline&&o.push("text-effect: outline;"),n.shadow&&o.push("text-shadow: auto;"),a.push('<span style="'+o.join("")+'">'),n.b&&(a.push("<b>"),i.push("</b>")),n.i&&(a.push("<i>"),i.push("</i>")),n.strike&&(a.push("<s>"),i.push("</s>"));var c=n.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(a.push("<"+c+">"),i.push("</"+c+">")),i.push("</span>"),n}function s(n){var a=[[],n.v,[]];return n.v?(n.s&&r(n.s,a[0],a[2]),a[0].join("")+a[1].replace(t,"<br/>")+a[2].join("")):""}return function(a){return a.map(s).join("")}}(),gD=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,vD=/<(?:\w+:)?r>/,yD=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Wx(e,t){var r=t?t.cellHTML:!0,s={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(s.t=Ze(ot(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),s.r=ot(e),r&&(s.h=Ax(s.t))):e.match(vD)&&(s.r=ot(e),s.t=Ze(ot((e.replace(yD,"").match(gD)||[]).join("").replace(Nr,""))),r&&(s.h=xD(mD(s.r)))),s):{t:""}}var wD=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,_D=/<(?:\w+:)?(?:si|sstItem)>/g,bD=/<\/(?:\w+:)?(?:si|sstItem)>/;function SD(e,t){var r=[],s="";if(!e)return r;var n=e.match(wD);if(n){s=n[2].replace(_D,"").split(bD);for(var a=0;a!=s.length;++a){var i=Wx(s[a].trim(),t);i!=null&&(r[r.length]=i)}n=Ue(n[1]),r.Count=n.count,r.Unique=n.uniqueCount}return r}var kD=/^\s|\s$|[\t\n\r]/;function GE(e,t){if(!t.bookSST)return"";var r=[Ut];r[r.length]=we("sst",null,{xmlns:ii[0],count:e.Count,uniqueCount:e.Unique});for(var s=0;s!=e.length;++s)if(e[s]!=null){var n=e[s],a="<si>";n.r?a+=n.r:(a+="<t",n.t||(n.t=""),n.t.match(kD)&&(a+=' xml:space="preserve"'),a+=">"+at(n.t)+"</t>"),a+="</si>",r[r.length]=a}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function ED(e){return[e.read_shift(4),e.read_shift(4)]}function TD(e,t){var r=[],s=!1;return In(e,function(a,i,o){switch(o){case 159:r.Count=a[0],r.Unique=a[1];break;case 19:r.push(a);break;case 160:return!0;case 35:s=!0;break;case 36:s=!1;break;default:if(i.T,!s||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function ND(e,t){return t||(t=ae(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var jD=MO;function CD(e){var t=Kr();ce(t,159,ND(e));for(var r=0;r<e.length;++r)ce(t,19,jD(e[r]));return ce(t,160),t.end()}function KE(e){for(var t=[],r=e.split(""),s=0;s<r.length;++s)t[s]=r[s].charCodeAt(0);return t}function En(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function AD(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=En(e,4),t.U=En(e,4),t.W=En(e,4),t}function FD(e){for(var t=e.read_shift(4),r=e.l+t-4,s={},n=e.read_shift(4),a=[];n-- >0;)a.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(s.name=e.read_shift(0,"lpp4"),s.comps=a,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return s}function PD(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(FD(e));return t}function RD(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function OD(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=En(e,4),t.U=En(e,4),t.W=En(e,4),t}function ID(e){var t=OD(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function XE(e,t){var r=e.l+t,s={};s.Flags=e.read_shift(4)&63,e.l+=4,s.AlgID=e.read_shift(4);var n=!1;switch(s.AlgID){case 26126:case 26127:case 26128:n=s.Flags==36;break;case 26625:n=s.Flags==4;break;case 0:n=s.Flags==16||s.Flags==4||s.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+s.AlgID}if(!n)throw new Error("Encryption Flags/AlgID mismatch");return s.AlgIDHash=e.read_shift(4),s.KeySize=e.read_shift(4),s.ProviderType=e.read_shift(4),e.l+=8,s.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,s}function YE(e,t){var r={},s=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,s),e.l=s,r}function DD(e){var t=En(e);switch(t.Minor){case 2:return[t.Minor,LD(e)];case 3:return[t.Minor,MD()];case 4:return[t.Minor,BD(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function LD(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),s=XE(e,r),n=YE(e,e.length-e.l);return{t:"Std",h:s,v:n}}function MD(){throw new Error("File is password-protected: ECMA-376 Extensible")}function BD(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),s={};return r.replace(Nr,function(a){var i=Ue(a);switch(un(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){s[o]=i[o]});break;case"<dataIntegrity":s.encryptedHmacKey=i.encryptedHmacKey,s.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":s.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":s.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":s.encs.push(i);break;default:throw i[0]}}),s}function UD(e,t){var r={},s=r.EncryptionVersionInfo=En(e,4);if(t-=4,s.Minor!=2)throw new Error("unrecognized minor version code: "+s.Minor);if(s.Major>4||s.Major<2)throw new Error("unrecognized major version code: "+s.Major);r.Flags=e.read_shift(4),t-=4;var n=e.read_shift(4);return t-=4,r.EncryptionHeader=XE(e,n),t-=n,r.EncryptionVerifier=YE(e,t),r}function $D(e){var t={},r=t.EncryptionVersionInfo=En(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function Hx(e){var t=0,r,s=KE(e),n=s.length+1,a,i,o,c,u;for(r=la(n),r[0]=s.length,a=1;a!=n;++a)r[a]=s[a-1];for(a=n-1;a>=0;--a)i=r[a],o=t&16384?1:0,c=t<<1&32767,u=o|c,t=u^i;return t^52811}var JE=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],s=function(i){return(i/2|i*128)&255},n=function(i,o){return s(i^o)},a=function(i){for(var o=t[i.length-1],c=104,u=i.length-1;u>=0;--u)for(var d=i[u],f=0;f!=7;++f)d&64&&(o^=r[c]),d*=2,--c;return o};return function(i){for(var o=KE(i),c=a(o),u=o.length,d=la(16),f=0;f!=16;++f)d[f]=0;var h,m,p;for((u&1)===1&&(h=c>>8,d[u]=n(e[0],h),--u,h=c&255,m=o[o.length-1],d[u]=n(m,h));u>0;)--u,h=c>>8,d[u]=n(o[u],h),--u,h=c&255,d[u]=n(o[u],h);for(u=15,p=15-o.length;p>0;)h=c>>8,d[u]=n(e[p],h),--u,--p,h=c&255,d[u]=n(o[u],h),--u,--p;return d}}(),VD=function(e,t,r,s,n){n||(n=t),s||(s=JE(e));var a,i;for(a=0;a!=t.length;++a)i=t[a],i^=s[r],i=(i>>5|i<<3)&255,n[a]=i,++r;return[n,r,s]},zD=function(e){var t=0,r=JE(e);return function(s){var n=VD("",s,t,r);return t=n[1],n[0]}};function WD(e,t,r,s){var n={key:Wt(e),verificationBytes:Wt(e)};return r.password&&(n.verifier=Hx(r.password)),s.valid=n.verificationBytes===n.verifier,s.valid&&(s.insitu=zD(r.password)),n}function HD(e,t,r){var s=r||{};return s.Info=e.read_shift(2),e.l-=2,s.Info===1?s.Data=$D(e):s.Data=UD(e,t),s}function qD(e,t,r){var s={Type:r.biff>=8?e.read_shift(2):0};return s.Type?HD(e,t-2,s):WD(e,r.biff>=8?t:t-2,r,s),s}var QE=function(){function e(n,a){switch(a.type){case"base64":return t(cs(n),a);case"binary":return t(n,a);case"buffer":return t(qe&&Buffer.isBuffer(n)?n.toString("binary"):ga(n),a);case"array":return t(Za(n),a)}throw new Error("Unrecognized type "+a.type)}function t(n,a){var i=a||{},o=i.dense?[]:{},c=n.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(d,f){Array.isArray(o)&&(o[f]=[]);for(var h=/\\\w+\b/g,m=0,p,x=-1;p=h.exec(d);){switch(p[0]){case"\\cell":var v=d.slice(m,h.lastIndex-p[0].length);if(v[0]==" "&&(v=v.slice(1)),++x,v.length){var y={v,t:"s"};Array.isArray(o)?o[f][x]=y:o[Le({r:f,c:x})]=y}break}m=h.lastIndex}x>u.e.c&&(u.e.c=x)}),o["!ref"]=ze(u),o}function r(n,a){return va(e(n,a),a)}function s(n){for(var a=["{\\rtf1\\ansi"],i=et(n["!ref"]),o,c=Array.isArray(n),u=i.s.r;u<=i.e.r;++u){a.push("\\trowd\\trautofit1");for(var d=i.s.c;d<=i.e.c;++d)a.push("\\cellx"+(d+1));for(a.push("\\pard\\intbl"),d=i.s.c;d<=i.e.c;++d){var f=Le({r:u,c:d});o=c?(n[u]||[])[d]:n[f],!(!o||o.v==null&&(!o.f||o.F))&&(a.push(" "+(o.w||(Pn(o),o.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:s}}();function GD(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function lc(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function KD(e){var t=e[0]/255,r=e[1]/255,s=e[2]/255,n=Math.max(t,r,s),a=Math.min(t,r,s),i=n-a;if(i===0)return[0,0,t];var o=0,c=0,u=n+a;switch(c=i/(u>1?2-u:u),n){case t:o=((r-s)/i+6)%6;break;case r:o=(s-t)/i+2;break;case s:o=(t-r)/i+4;break}return[o/6,c,u/2]}function XD(e){var t=e[0],r=e[1],s=e[2],n=r*2*(s<.5?s:1-s),a=s-n/2,i=[a,a,a],o=6*t,c;if(r!==0)switch(o|0){case 0:case 6:c=n*o,i[0]+=n,i[1]+=c;break;case 1:c=n*(2-o),i[0]+=c,i[1]+=n;break;case 2:c=n*(o-2),i[1]+=n,i[2]+=c;break;case 3:c=n*(4-o),i[1]+=c,i[2]+=n;break;case 4:c=n*(o-4),i[2]+=n,i[0]+=c;break;case 5:c=n*(6-o),i[2]+=c,i[0]+=n;break}for(var u=0;u!=3;++u)i[u]=Math.round(i[u]*255);return i}function Id(e,t){if(t===0)return e;var r=KD(GD(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),lc(XD(r))}var ZE=6,YD=15,JD=1,_r=ZE;function cc(e){return Math.floor((e+Math.round(128/_r)/256)*_r)}function uc(e){return Math.floor((e-5)/_r*100+.5)/100}function Dd(e){return Math.round((e*_r+5)/_r*256)/256}function Cf(e){return Dd(uc(cc(e)))}function qx(e){var t=Math.abs(e-Cf(e)),r=_r;if(t>.005)for(_r=JD;_r<YD;++_r)Math.abs(e-Cf(e))<=t&&(t=Math.abs(e-Cf(e)),r=_r);_r=r}function ca(e){e.width?(e.wpx=cc(e.width),e.wch=uc(e.wpx),e.MDW=_r):e.wpx?(e.wch=uc(e.wpx),e.width=Dd(e.wch),e.MDW=_r):typeof e.wch=="number"&&(e.width=Dd(e.wch),e.wpx=cc(e.width),e.MDW=_r),e.customWidth&&delete e.customWidth}var QD=96,eT=QD;function dc(e){return e*96/eT}function vo(e){return e*eT/96}var ZD={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function eL(e,t,r,s){t.Borders=[];var n={},a=!1;(e[0].match(Nr)||[]).forEach(function(i){var o=Ue(i);switch(un(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":n={},o.diagonalUp&&(n.diagonalUp=ft(o.diagonalUp)),o.diagonalDown&&(n.diagonalDown=ft(o.diagonalDown)),t.Borders.push(n);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(s&&s.WTF&&!a)throw new Error("unrecognized "+o[0]+" in borders")}})}function tL(e,t,r,s){t.Fills=[];var n={},a=!1;(e[0].match(Nr)||[]).forEach(function(i){var o=Ue(i);switch(un(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":n={},t.Fills.push(n);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(n),n={};break;case"<patternFill":case"<patternFill>":o.patternType&&(n.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":n.bgColor||(n.bgColor={}),o.indexed&&(n.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(n.bgColor.theme=parseInt(o.theme,10)),o.tint&&(n.bgColor.tint=parseFloat(o.tint)),o.rgb&&(n.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":n.fgColor||(n.fgColor={}),o.theme&&(n.fgColor.theme=parseInt(o.theme,10)),o.tint&&(n.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(n.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(s&&s.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fills")}})}function rL(e,t,r,s){t.Fonts=[];var n={},a=!1;(e[0].match(Nr)||[]).forEach(function(i){var o=Ue(i);switch(un(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(n),n={};break;case"<name":o.val&&(n.name=ot(o.val));break;case"<name/>":case"</name>":break;case"<b":n.bold=o.val?ft(o.val):1;break;case"<b/>":n.bold=1;break;case"<i":n.italic=o.val?ft(o.val):1;break;case"<i/>":n.italic=1;break;case"<u":switch(o.val){case"none":n.underline=0;break;case"single":n.underline=1;break;case"double":n.underline=2;break;case"singleAccounting":n.underline=33;break;case"doubleAccounting":n.underline=34;break}break;case"<u/>":n.underline=1;break;case"<strike":n.strike=o.val?ft(o.val):1;break;case"<strike/>":n.strike=1;break;case"<outline":n.outline=o.val?ft(o.val):1;break;case"<outline/>":n.outline=1;break;case"<shadow":n.shadow=o.val?ft(o.val):1;break;case"<shadow/>":n.shadow=1;break;case"<condense":n.condense=o.val?ft(o.val):1;break;case"<condense/>":n.condense=1;break;case"<extend":n.extend=o.val?ft(o.val):1;break;case"<extend/>":n.extend=1;break;case"<sz":o.val&&(n.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(n.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(n.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(n.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=wx[parseInt(o.val,10)];break;case"<color":if(n.color||(n.color={}),o.auto&&(n.color.auto=ft(o.auto)),o.rgb)n.color.rgb=o.rgb.slice(-6);else if(o.indexed){n.color.index=parseInt(o.indexed,10);var c=za[n.color.index];n.color.index==81&&(c=za[1]),c||(c=za[1]),n.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else o.theme&&(n.color.theme=parseInt(o.theme,10),o.tint&&(n.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(n.color.rgb=Id(r.themeElements.clrScheme[n.color.theme].rgb,n.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(s&&s.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fonts")}})}function sL(e,t,r){t.NumberFmt=[];for(var s=It(De),n=0;n<s.length;++n)t.NumberFmt[s[n]]=De[s[n]];var a=e[0].match(Nr);if(a)for(n=0;n<a.length;++n){var i=Ue(a[n]);switch(un(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Ze(ot(i.formatCode)),c=parseInt(i.numFmtId,10);if(t.NumberFmt[c]=o,c>0){if(c>392){for(c=392;c>60&&t.NumberFmt[c]!=null;--c);t.NumberFmt[c]=o}kn(o,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}function nL(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var s=r[0];s<=r[1];++s)e[s]!=null&&(t[t.length]=we("numFmt",null,{numFmtId:s,formatCode:at(e[s])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=we("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var _u=["numFmtId","fillId","fontId","borderId","xfId"],bu=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function aL(e,t,r){t.CellXf=[];var s,n=!1;(e[0].match(Nr)||[]).forEach(function(a){var i=Ue(a),o=0;switch(un(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(s=i,delete s[0],o=0;o<_u.length;++o)s[_u[o]]&&(s[_u[o]]=parseInt(s[_u[o]],10));for(o=0;o<bu.length;++o)s[bu[o]]&&(s[bu[o]]=ft(s[bu[o]]));if(t.NumberFmt&&s.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[s.numFmtId]==t.NumberFmt[o]){s.numFmtId=o;break}}t.CellXf.push(s);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};i.vertical&&(c.vertical=i.vertical),i.horizontal&&(c.horizontal=i.horizontal),i.textRotation!=null&&(c.textRotation=i.textRotation),i.indent&&(c.indent=i.indent),i.wrapText&&(c.wrapText=ft(i.wrapText)),s.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":n=!0;break;case"</AlternateContent>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(r&&r.WTF&&!n)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}function iL(e){var t=[];return t[t.length]=we("cellXfs",null),e.forEach(function(r){t[t.length]=we("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=we("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var oL=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,s=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,n=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,c,u){var d={};if(!o)return d;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=o.match(t))&&sL(f,d,u),(f=o.match(n))&&rL(f,d,c,u),(f=o.match(s))&&tL(f,d,c,u),(f=o.match(a))&&eL(f,d,c,u),(f=o.match(r))&&aL(f,d,u),d}}();function tT(e,t){var r=[Ut,we("styleSheet",null,{xmlns:ii[0],"xmlns:vt":Jt.vt})],s;return e.SSF&&(s=nL(e.SSF))!=null&&(r[r.length]=s),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(s=iL(t.cellXfs))&&(r[r.length]=s),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function lL(e,t){var r=e.read_shift(2),s=kr(e);return[r,s]}function cL(e,t,r){r||(r=ae(6+4*t.length)),r.write_shift(2,e),sr(t,r);var s=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),s}function uL(e,t,r){var s={};s.sz=e.read_shift(2)/20;var n=HO(e);n.fItalic&&(s.italic=1),n.fCondense&&(s.condense=1),n.fExtend&&(s.extend=1),n.fShadow&&(s.shadow=1),n.fOutline&&(s.outline=1),n.fStrikeout&&(s.strike=1);var a=e.read_shift(2);switch(a===700&&(s.bold=1),e.read_shift(2)){case 1:s.vertAlign="superscript";break;case 2:s.vertAlign="subscript";break}var i=e.read_shift(1);i!=0&&(s.underline=i);var o=e.read_shift(1);o>0&&(s.family=o);var c=e.read_shift(1);switch(c>0&&(s.charset=c),e.l++,s.color=WO(e),e.read_shift(1)){case 1:s.scheme="major";break;case 2:s.scheme="minor";break}return s.name=kr(e),s}function dL(e,t){t||(t=ae(25+4*32)),t.write_shift(2,e.sz*20),qO(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Pd(e.color,t);var s=0;return s=2,t.write_shift(1,s),sr(e.name,t),t.length>t.l?t.slice(0,t.l):t}var fL=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Af,hL=Tr;function sw(e,t){t||(t=ae(4*3+8*7+16*1)),Af||(Af=d0(fL));var r=Af[e.patternType];r==null&&(r=40),t.write_shift(4,r);var s=0;if(r!=40)for(Pd({auto:1},t),Pd({auto:1},t);s<12;++s)t.write_shift(4,0);else{for(;s<4;++s)t.write_shift(4,0);for(;s<12;++s)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function pL(e,t){var r=e.l+t,s=e.read_shift(2),n=e.read_shift(2);return e.l=r,{ixfe:s,numFmtId:n}}function rT(e,t,r){r||(r=ae(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var s=0;return r.write_shift(1,s),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function qo(e,t){return t||(t=ae(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var mL=Tr;function xL(e,t){return t||(t=ae(51)),t.write_shift(1,0),qo(null,t),qo(null,t),qo(null,t),qo(null,t),qo(null,t),t.length>t.l?t.slice(0,t.l):t}function gL(e,t){return t||(t=ae(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),Fd(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function vL(e,t,r){var s=ae(2052);return s.write_shift(4,e),Fd(t,s),Fd(r,s),s.length>s.l?s.slice(0,s.l):s}function yL(e,t,r){var s={};s.NumberFmt=[];for(var n in De)s.NumberFmt[n]=De[n];s.CellXf=[],s.Fonts=[];var a=[],i=!1;return In(e,function(c,u,d){switch(d){case 44:s.NumberFmt[c[0]]=c[1],kn(c[1],c[0]);break;case 43:s.Fonts.push(c),c.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(c.color.rgb=Id(t.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&s.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:a.push(d),i=!0;break;case 38:a.pop(),i=!1;break;default:if(u.T>0)a.push(d);else if(u.T<0)a.pop();else if(!i||r.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),s}function wL(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var n=s[0];n<=s[1];++n)t[n]!=null&&++r}),r!=0&&(ce(e,615,Ks(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var n=s[0];n<=s[1];++n)t[n]!=null&&ce(e,44,cL(n,t[n]))}),ce(e,616))}}function _L(e){var t=1;ce(e,611,Ks(t)),ce(e,43,dL({sz:12,color:{theme:1},name:"Calibri",family:2})),ce(e,612)}function bL(e){var t=2;ce(e,603,Ks(t)),ce(e,45,sw({patternType:"none"})),ce(e,45,sw({patternType:"gray125"})),ce(e,604)}function SL(e){var t=1;ce(e,613,Ks(t)),ce(e,46,xL()),ce(e,614)}function kL(e){var t=1;ce(e,626,Ks(t)),ce(e,47,rT({numFmtId:0},65535)),ce(e,627)}function EL(e,t){ce(e,617,Ks(t.length)),t.forEach(function(r){ce(e,47,rT(r,0))}),ce(e,618)}function TL(e){var t=1;ce(e,619,Ks(t)),ce(e,48,gL({xfId:0,name:"Normal"})),ce(e,620)}function NL(e){var t=0;ce(e,505,Ks(t)),ce(e,506)}function jL(e){var t=0;ce(e,508,vL(t,"TableStyleMedium9","PivotStyleMedium4")),ce(e,509)}function CL(e,t){var r=Kr();return ce(r,278),wL(r,e.SSF),_L(r),bL(r),SL(r),kL(r),EL(r,t.cellXfs),TL(r),NL(r),jL(r),ce(r,279),r.end()}var AL=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function FL(e,t,r){t.themeElements.clrScheme=[];var s={};(e[0].match(Nr)||[]).forEach(function(n){var a=Ue(n);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":s.rgb=a.val;break;case"<a:sysClr":s.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(t.themeElements.clrScheme[AL.indexOf(a[0])]=s,s={}):s.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function PL(){}function RL(){}var OL=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,IL=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,DL=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function LL(e,t,r){t.themeElements={};var s;[["clrScheme",OL,FL],["fontScheme",IL,PL],["fmtScheme",DL,RL]].forEach(function(n){if(!(s=e.match(n[1])))throw new Error(n[0]+" not found in themeElements");n[2](s,t,r)})}var ML=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function sT(e,t){(!e||e.length===0)&&(e=Gx());var r,s={};if(!(r=e.match(ML)))throw new Error("themeElements not found in theme");return LL(r[0],s,t),s.raw=e,s}function Gx(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Ut];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function BL(e,t,r){var s=e.l+t,n=e.read_shift(4);if(n!==124226){if(!r.cellStyles){e.l=s;return}var a=e.slice(e.l);e.l=s;var i;try{i=Xk(a,{type:"array"})}catch{return}var o=ns(i,"theme/theme/theme1.xml",!0);if(o)return sT(o,r)}}function UL(e){return e.read_shift(4)}function $L(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=VL(e,4);break;case 2:t.xclrValue=DE(e);break;case 3:t.xclrValue=UL(e);break;case 4:e.l+=4;break}return e.l+=8,t}function VL(e,t){return Tr(e,t)}function zL(e,t){return Tr(e,t)}function WL(e){var t=e.read_shift(2),r=e.read_shift(2)-4,s=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:s[1]=$L(e);break;case 6:s[1]=zL(e,r);break;case 14:case 15:s[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return s}function HL(e,t){var r=e.l+t;e.l+=2;var s=e.read_shift(2);e.l+=2;for(var n=e.read_shift(2),a=[];n-- >0;)a.push(WL(e,r-e.l));return{ixfe:s,ext:a}}function qL(e,t){t.forEach(function(r){switch(r[0]){}})}function GL(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:kr(e)}}function KL(e){var t=ae(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),sr(e.name,t),t.slice(0,t.l)}function XL(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function YL(e){var t=ae(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function JL(e,t){var r=ae(8+2*t.length);return r.write_shift(4,e),sr(t,r),r.slice(0,r.l)}function QL(e){return e.l+=4,e.read_shift(4)!=0}function ZL(e,t){var r=ae(8);return r.write_shift(4,e),r.write_shift(4,1),r}function eM(e,t,r){var s={Types:[],Cell:[],Value:[]},n=r||{},a=[],i=!1,o=2;return In(e,function(c,u,d){switch(d){case 335:s.Types.push({name:c.name});break;case 51:c.forEach(function(f){o==1?s.Cell.push({type:s.Types[f[0]-1].name,index:f[1]}):o==0&&s.Value.push({type:s.Types[f[0]-1].name,index:f[1]})});break;case 337:o=c?1:0;break;case 338:o=2;break;case 35:a.push(d),i=!0;break;case 36:a.pop(),i=!1;break;default:if(!u.T){if(!i||n.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),s}function tM(){var e=Kr();return ce(e,332),ce(e,334,Ks(1)),ce(e,335,KL({name:"XLDAPR",version:12e4,flags:3496657072})),ce(e,336),ce(e,339,JL(1,"XLDAPR")),ce(e,52),ce(e,35,Ks(514)),ce(e,4096,Ks(0)),ce(e,4097,_s(1)),ce(e,36),ce(e,53),ce(e,340),ce(e,337,ZL(1)),ce(e,51,YL([[1,0]])),ce(e,338),ce(e,333),e.end()}function rM(e,t,r){var s={Types:[],Cell:[],Value:[]};if(!e)return s;var n=!1,a=2,i;return e.replace(Nr,function(o){var c=Ue(o);switch(un(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":s.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<s.Types.length;++u)s.Types[u].name==c.name&&(i=s.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?s.Cell.push({type:s.Types[c.t-1].name,index:+c.v}):a==0&&s.Value.push({type:s.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+c.i);break;default:if(!n&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return o}),s}function nT(){var e=[Ut];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function sM(e){var t=[];if(!e)return t;var r=1;return(e.match(Nr)||[]).forEach(function(s){var n=Ue(s);switch(n[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete n[0],n.i?r=n.i:n.i=r,t.push(n);break}}),t}function nM(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Le(r);var s=e.read_shift(1);return s&2&&(t.l="1"),s&8&&(t.a="1"),t}function aM(e,t,r){var s=[];return In(e,function(a,i,o){switch(o){case 63:s.push(a);break;default:if(!i.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),s}function iM(e,t,r,s){if(!e)return e;var n=s||{},a=!1;In(e,function(o,c,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!c.T){if(!a||n.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},n)}function oM(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var Vi=1024;function aT(e,t){for(var r=[21600,21600],s=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),n=[we("xml",null,{"xmlns:v":Zr.v,"xmlns:o":Zr.o,"xmlns:x":Zr.x,"xmlns:mv":Zr.mv}).replace(/\/>/,">"),we("o:shapelayout",we("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),we("v:shapetype",[we("v:stroke",null,{joinstyle:"miter"}),we("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:s})];Vi<e*1e3;)Vi+=1e3;return t.forEach(function(a){var i=jt(a[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var c=o.type=="gradient"?we("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=we("v:fill",c,o),d={on:"t",obscured:"t"};++Vi,n=n.concat(["<v:shape"+ac({id:"_x0000_s"+Vi,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(a[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,we("v:shadow",null,d),we("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",ur("x:Anchor",[i.c+1,0,i.r+1,0,i.c+3,20,i.r+5,20].join(",")),ur("x:AutoFill","False"),ur("x:Row",String(i.r)),ur("x:Column",String(i.c)),a[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),n.push("</xml>"),n.join("")}function nw(e,t,r,s){var n=Array.isArray(e),a;t.forEach(function(i){var o=jt(i.ref);if(n?(e[o.r]||(e[o.r]=[]),a=e[o.r][o.c]):a=e[i.ref],!a){a={t:"z"},n?e[o.r][o.c]=a:e[i.ref]=a;var c=et(e["!ref"]||"BDWGO1000001:A1");c.s.r>o.r&&(c.s.r=o.r),c.e.r<o.r&&(c.e.r=o.r),c.s.c>o.c&&(c.s.c=o.c),c.e.c<o.c&&(c.e.c=o.c);var u=ze(c);u!==e["!ref"]&&(e["!ref"]=u)}a.c||(a.c=[]);var d={a:i.author,t:i.t,r:i.r,T:r};i.h&&(d.h=i.h);for(var f=a.c.length-1;f>=0;--f){if(!r&&a.c[f].T)return;r&&!a.c[f].T&&a.c.splice(f,1)}if(r&&s){for(f=0;f<s.length;++f)if(d.a==s[f].id){d.a=s[f].name||d.a;break}}a.c.push(d)})}function lM(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],s=[],n=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);n&&n[1]&&n[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var a=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?comment[^>]*>/);if(o){var c=Ue(o[0]),u={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},d=jt(c.ref);if(!(t.sheetRows&&t.sheetRows<=d.r)){var f=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!f&&!!f[1]&&Wx(f[1])||{r:"",t:"",h:""};u.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),u.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(u.h=h.h),s.push(u)}}}}),s}function iT(e){var t=[Ut,we("comments",null,{xmlns:ii[0]})],r=[];return t.push("<authors>"),e.forEach(function(s){s[1].forEach(function(n){var a=at(n.a);r.indexOf(a)==-1&&(r.push(a),t.push("<author>"+a+"</author>")),n.T&&n.ID&&r.indexOf("tc="+n.ID)==-1&&(r.push("tc="+n.ID),t.push("<author>tc="+n.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(s){var n=0,a=[];if(s[1][0]&&s[1][0].T&&s[1][0].ID?n=r.indexOf("tc="+s[1][0].ID):s[1].forEach(function(c){c.a&&(n=r.indexOf(at(c.a))),a.push(c.t||"")}),t.push('<comment ref="'+s[0]+'" authorId="'+n+'"><text>'),a.length<=1)t.push(ur("t",at(a[0]||"")));else{for(var i=`Comment:
    `+a[0]+`
`,o=1;o<a.length;++o)i+=`Reply:
    `+a[o]+`
`;t.push(ur("t",at(i)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function cM(e,t){var r=[],s=!1,n={},a=0;return e.replace(Nr,function(o,c){var u=Ue(o);switch(un(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":n={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":n.t!=null&&r.push(n);break;case"<text>":case"<text":a=c+o.length;break;case"</text>":n.t=e.slice(a,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":s=!0;break;case"</mentions>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(!s&&t.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return o}),r}function uM(e,t,r){var s=[Ut,we("ThreadedComments",null,{xmlns:Jt.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(n){var a="";(n[1]||[]).forEach(function(i,o){if(!i.T){delete i.ID;return}i.a&&t.indexOf(i.a)==-1&&t.push(i.a);var c={ref:n[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?a=c.id:c.parentId=a,i.ID=c.id,i.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(i.a)).slice(-12)+"}"),s.push(we("threadedComment",ur("text",i.t||""),c))})}),s.push("</ThreadedComments>"),s.join("")}function dM(e,t){var r=[],s=!1;return e.replace(Nr,function(a){var i=Ue(a);switch(un(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(!s&&t.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return a}),r}function fM(e){var t=[Ut,we("personList",null,{xmlns:Jt.TCMNT,"xmlns:x":ii[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,s){t.push(we("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+s).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function hM(e){var t={};t.iauthor=e.read_shift(4);var r=ui(e);return t.rfx=r.s,t.ref=Le(r.s),e.l+=16,t}function pM(e,t){return t==null&&(t=ae(36)),t.write_shift(4,e[1].iauthor),Po(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var mM=kr;function xM(e){return sr(e.slice(0,54))}function gM(e,t){var r=[],s=[],n={},a=!1;return In(e,function(o,c,u){switch(u){case 632:s.push(o);break;case 635:n=o;break;case 637:n.t=o.t,n.h=o.h,n.r=o.r;break;case 636:if(n.author=s[n.iauthor],delete n.iauthor,t.sheetRows&&n.rfx&&t.sheetRows<=n.rfx.r)break;n.t||(n.t=""),delete n.rfx,r.push(n);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!a||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}function vM(e){var t=Kr(),r=[];return ce(t,628),ce(t,630),e.forEach(function(s){s[1].forEach(function(n){r.indexOf(n.a)>-1||(r.push(n.a.slice(0,54)),ce(t,632,xM(n.a)))})}),ce(t,631),ce(t,633),e.forEach(function(s){s[1].forEach(function(n){n.iauthor=r.indexOf(n.a);var a={s:jt(s[0]),e:jt(s[0])};ce(t,635,pM([a,n])),n.t&&n.t.length>0&&ce(t,637,UO(n)),ce(t,636),delete n.iauthor})}),ce(t,634),ce(t,629),t.end()}var yM="application/vnd.ms-office.vbaProject";function wM(e){var t=Re.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,s){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var n=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Re.utils.cfb_add(t,n,e.FileIndex[s].content)}}),Re.write(t)}function _M(e,t){t.FullPaths.forEach(function(r,s){if(s!=0){var n=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");n.slice(-1)!=="/"&&Re.utils.cfb_add(e,n,t.FileIndex[s].content)}})}var oT=["xlsb","xlsm","xlam","biff8","xla"];function bM(){return{"!type":"dialog"}}function SM(){return{"!type":"dialog"}}function kM(){return{"!type":"macro"}}function EM(){return{"!type":"macro"}}var eo=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(s,n,a,i){var o=!1,c=!1;a.length==0?c=!0:a.charAt(0)=="["&&(c=!0,a=a.slice(1,-1)),i.length==0?o=!0:i.charAt(0)=="["&&(o=!0,i=i.slice(1,-1));var u=a.length>0?parseInt(a,10)|0:0,d=i.length>0?parseInt(i,10)|0:0;return o?d+=t.c:--d,c?u+=t.r:--u,n+(o?"":"$")+Nt(d)+(c?"":"$")+Bt(u)}return function(n,a){return t=a,n.replace(e,r)}}(),Kx=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Xx=function(){return function(t,r){return t.replace(Kx,function(s,n,a,i,o,c){var u=Ix(i)-(a?0:r.c),d=Ox(c)-(o?0:r.r),f=d==0?"":o?d+1:"["+d+"]",h=u==0?"":a?u+1:"["+u+"]";return n+"R"+f+"C"+h})}}();function lT(e,t){return e.replace(Kx,function(r,s,n,a,i,o){return s+(n=="$"?n+a:Nt(Ix(a)+t.c))+(i=="$"?i+o:Bt(Ox(o)+t.r))})}function TM(e,t,r){var s=Xr(t),n=s.s,a=jt(r),i={r:a.r-n.r,c:a.c-n.c};return lT(e,i)}function NM(e){return e.length!=1}function aw(e){return e.replace(/_xlfn\./g,"")}function Vt(e){e.l+=1}function ua(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function cT(e,t,r){var s=2;if(r){if(r.biff>=2&&r.biff<=5)return uT(e);r.biff==12&&(s=4)}var n=e.read_shift(s),a=e.read_shift(s),i=ua(e),o=ua(e);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function uT(e){var t=ua(e),r=ua(e),s=e.read_shift(1),n=e.read_shift(1);return{s:{r:t[0],c:s,cRel:t[1],rRel:t[2]},e:{r:r[0],c:n,cRel:r[1],rRel:r[2]}}}function jM(e,t,r){if(r.biff<8)return uT(e);var s=e.read_shift(r.biff==12?4:2),n=e.read_shift(r.biff==12?4:2),a=ua(e),i=ua(e);return{s:{r:s,c:a[0],cRel:a[1],rRel:a[2]},e:{r:n,c:i[0],cRel:i[1],rRel:i[2]}}}function dT(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return CM(e);var s=e.read_shift(r&&r.biff==12?4:2),n=ua(e);return{r:s,c:n[0],cRel:n[1],rRel:n[2]}}function CM(e){var t=ua(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function AM(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function FM(e,t,r){var s=r&&r.biff?r.biff:8;if(s>=2&&s<=5)return PM(e);var n=e.read_shift(s>=12?4:2),a=e.read_shift(2),i=(a&16384)>>14,o=(a&32768)>>15;if(a&=16383,o==1)for(;n>524287;)n-=1048576;if(i==1)for(;a>8191;)a=a-16384;return{r:n,c:a,cRel:i,rRel:o}}function PM(e){var t=e.read_shift(2),r=e.read_shift(1),s=(t&32768)>>15,n=(t&16384)>>14;return t&=16383,s==1&&t>=8192&&(t=t-16384),n==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:n,rRel:s}}function RM(e,t,r){var s=(e[e.l++]&96)>>5,n=cT(e,r.biff>=2&&r.biff<=5?6:8,r);return[s,n]}function OM(e,t,r){var s=(e[e.l++]&96)>>5,n=e.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}var i=cT(e,a,r);return[s,n,i]}function IM(e,t,r){var s=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[s]}function DM(e,t,r){var s=(e[e.l++]&96)>>5,n=e.read_shift(2),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}return e.l+=a,[s,n]}function LM(e,t,r){var s=(e[e.l++]&96)>>5,n=jM(e,t-1,r);return[s,n]}function MM(e,t,r){var s=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[s]}function iw(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function BM(e,t,r){e.l+=2;for(var s=e.read_shift(r&&r.biff==2?1:2),n=[],a=0;a<=s;++a)n.push(e.read_shift(r&&r.biff==2?1:2));return n}function UM(e,t,r){var s=e[e.l+1]&255?1:0;return e.l+=2,[s,e.read_shift(r&&r.biff==2?1:2)]}function $M(e,t,r){var s=e[e.l+1]&255?1:0;return e.l+=2,[s,e.read_shift(r&&r.biff==2?1:2)]}function VM(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function zM(e,t,r){var s=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[s]}function fT(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function WM(e){return e.read_shift(2),fT(e)}function HM(e){return e.read_shift(2),fT(e)}function qM(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var n=dT(e,0,r);return[s,n]}function GM(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var n=FM(e,0,r);return[s,n]}function KM(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var a=dT(e,0,r);return[s,n,a]}function XM(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(r&&r.biff<=3?1:2);return[Q7[n],mT[n],s]}function YM(e,t,r){var s=e[e.l++],n=e.read_shift(1),a=r&&r.biff<=3?[s==88?-1:0,e.read_shift(1)]:JM(e);return[n,(a[0]===0?mT:J7)[a[1]]]}function JM(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function QM(e,t,r){e.l+=r&&r.biff==2?3:4}function ZM(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var s=e.read_shift(2),n=e.read_shift(r&&r.biff==2?1:2);return[s,n]}function e7(e){return e.l++,Dn[e.read_shift(1)]}function t7(e){return e.l++,e.read_shift(2)}function r7(e){return e.l++,e.read_shift(1)!==0}function s7(e){return e.l++,br(e)}function n7(e,t,r){return e.l++,jc(e,t-1,r)}function a7(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Dt(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Dn[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=br(e);break;case 2:r[1]=di(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function i7(e,t,r){for(var s=e.read_shift(r.biff==12?4:2),n=[],a=0;a!=s;++a)n.push((r.biff==12?ui:p0)(e));return n}function o7(e,t,r){var s=0,n=0;r.biff==12?(s=e.read_shift(4),n=e.read_shift(4)):(n=1+e.read_shift(1),s=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--s,--n==0&&(n=256));for(var a=0,i=[];a!=s&&(i[a]=[]);++a)for(var o=0;o!=n;++o)i[a][o]=a7(e,r.biff);return i}function l7(e,t,r){var s=e.read_shift(1)>>>5&3,n=!r||r.biff>=8?4:2,a=e.read_shift(n);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[s,0,a]}function c7(e,t,r){if(r.biff==5)return u7(e);var s=e.read_shift(1)>>>5&3,n=e.read_shift(2),a=e.read_shift(4);return[s,n,a]}function u7(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var s=e.read_shift(2);return e.l+=12,[t,r,s]}function d7(e,t,r){var s=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var n=e.read_shift(r&&r.biff==2?1:2);return[s,n]}function f7(e,t,r){var s=e.read_shift(1)>>>5&3,n=e.read_shift(r&&r.biff==2?1:2);return[s,n]}function h7(e,t,r){var s=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[s]}function p7(e,t,r){var s=(e[e.l++]&96)>>5,n=e.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return e.l+=a,[s,n]}var m7=Tr,x7=Tr,g7=Tr;function Ac(e,t,r){return e.l+=2,[AM(e)]}function Yx(e){return e.l+=6,[]}var v7=Ac,y7=Yx,w7=Yx,_7=Ac;function hT(e){return e.l+=2,[Wt(e),e.read_shift(2)&1]}var b7=Ac,S7=hT,k7=Yx,E7=Ac,T7=Ac,N7=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function j7(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(4),n=e.read_shift(2),a=e.read_shift(2),i=N7[r>>2&31];return{ixti:t,coltype:r&3,rt:i,idx:s,c:n,C:a}}function C7(e){return e.l+=2,[e.read_shift(4)]}function A7(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function F7(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function P7(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function R7(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function O7(e){return e.l+=4,[0,0]}var ow={1:{n:"PtgExp",f:ZM},2:{n:"PtgTbl",f:g7},3:{n:"PtgAdd",f:Vt},4:{n:"PtgSub",f:Vt},5:{n:"PtgMul",f:Vt},6:{n:"PtgDiv",f:Vt},7:{n:"PtgPower",f:Vt},8:{n:"PtgConcat",f:Vt},9:{n:"PtgLt",f:Vt},10:{n:"PtgLe",f:Vt},11:{n:"PtgEq",f:Vt},12:{n:"PtgGe",f:Vt},13:{n:"PtgGt",f:Vt},14:{n:"PtgNe",f:Vt},15:{n:"PtgIsect",f:Vt},16:{n:"PtgUnion",f:Vt},17:{n:"PtgRange",f:Vt},18:{n:"PtgUplus",f:Vt},19:{n:"PtgUminus",f:Vt},20:{n:"PtgPercent",f:Vt},21:{n:"PtgParen",f:Vt},22:{n:"PtgMissArg",f:Vt},23:{n:"PtgStr",f:n7},26:{n:"PtgSheet",f:A7},27:{n:"PtgEndSheet",f:F7},28:{n:"PtgErr",f:e7},29:{n:"PtgBool",f:r7},30:{n:"PtgInt",f:t7},31:{n:"PtgNum",f:s7},32:{n:"PtgArray",f:MM},33:{n:"PtgFunc",f:XM},34:{n:"PtgFuncVar",f:YM},35:{n:"PtgName",f:l7},36:{n:"PtgRef",f:qM},37:{n:"PtgArea",f:RM},38:{n:"PtgMemArea",f:d7},39:{n:"PtgMemErr",f:m7},40:{n:"PtgMemNoMem",f:x7},41:{n:"PtgMemFunc",f:f7},42:{n:"PtgRefErr",f:h7},43:{n:"PtgAreaErr",f:IM},44:{n:"PtgRefN",f:GM},45:{n:"PtgAreaN",f:LM},46:{n:"PtgMemAreaN",f:P7},47:{n:"PtgMemNoMemN",f:R7},57:{n:"PtgNameX",f:c7},58:{n:"PtgRef3d",f:KM},59:{n:"PtgArea3d",f:OM},60:{n:"PtgRefErr3d",f:p7},61:{n:"PtgAreaErr3d",f:DM},255:{}},I7={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},D7={1:{n:"PtgElfLel",f:hT},2:{n:"PtgElfRw",f:E7},3:{n:"PtgElfCol",f:v7},6:{n:"PtgElfRwV",f:T7},7:{n:"PtgElfColV",f:_7},10:{n:"PtgElfRadical",f:b7},11:{n:"PtgElfRadicalS",f:k7},13:{n:"PtgElfColS",f:y7},15:{n:"PtgElfColSV",f:w7},16:{n:"PtgElfRadicalLel",f:S7},25:{n:"PtgList",f:j7},29:{n:"PtgSxName",f:C7},255:{}},L7={0:{n:"PtgAttrNoop",f:O7},1:{n:"PtgAttrSemi",f:zM},2:{n:"PtgAttrIf",f:$M},4:{n:"PtgAttrChoose",f:BM},8:{n:"PtgAttrGoto",f:UM},16:{n:"PtgAttrSum",f:QM},32:{n:"PtgAttrBaxcel",f:iw},33:{n:"PtgAttrBaxcel",f:iw},64:{n:"PtgAttrSpace",f:WM},65:{n:"PtgAttrSpaceSemi",f:HM},128:{n:"PtgAttrIfError",f:VM},255:{}};function Fc(e,t,r,s){if(s.biff<8)return Tr(e,t);for(var n=e.l+t,a=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=o7(e,0,s),a.push(r[i][1]);break;case"PtgMemArea":r[i][2]=i7(e,r[i][1],s),a.push(r[i][2]);break;case"PtgExp":s&&s.biff==12&&(r[i][1][1]=e.read_shift(4),a.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return t=n-e.l,t!==0&&a.push(Tr(e,t)),a}function Pc(e,t,r){for(var s=e.l+t,n,a,i=[];s!=e.l;)t=s-e.l,a=e[e.l],n=ow[a]||ow[I7[a]],(a===24||a===25)&&(n=(a===24?D7:L7)[e[e.l+1]]),!n||!n.f?Tr(e,t):i.push([n.n,n.f(e,t,r)]);return i}function M7(e){for(var t=[],r=0;r<e.length;++r){for(var s=e[r],n=[],a=0;a<s.length;++a){var i=s[a];if(i)switch(i[0]){case 2:n.push('"'+i[1].replace(/"/g,'""')+'"');break;default:n.push(i[1])}else n.push("")}t.push(n.join(","))}return t.join(";")}var B7={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function U7(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function pT(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var s=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!s)return"SH33TJSERR1";var n="";if(r.biff>8)switch(e[s[0]][0]){case 357:return n=s[1]==-1?"#REF":e.SheetNames[s[1]],s[1]==s[2]?n:n+":"+e.SheetNames[s[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[s[0]][0];case 355:default:return"SH33TJSSRC"+e[s[0]][0]}switch(e[s[0]][0][0]){case 1025:return n=s[1]==-1?"#REF":e.SheetNames[s[1]]||"SH33TJSERR3",s[1]==s[2]?n:n+":"+e.SheetNames[s[2]];case 14849:return e[s[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return e[s[0]][0][3]?(n=s[1]==-1?"#REF":e[s[0]][0][3][s[1]]||"SH33TJSERR4",s[1]==s[2]?n:n+":"+e[s[0]][0][3][s[2]]):"SH33TJSERR2"}}function lw(e,t,r){var s=pT(e,t,r);return s=="#REF"?s:U7(s,r)}function yr(e,t,r,s,n){var a=n&&n.biff||8,i={s:{c:0,r:0}},o=[],c,u,d,f=0,h=0,m,p="";if(!e[0]||!e[0][0])return"";for(var x=-1,v="",y=0,w=e[0].length;y<w;++y){var g=e[0][y];switch(g[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),u=o.pop(),x>=0){switch(e[0][x][1][0]){case 0:v=Rt(" ",e[0][x][1][1]);break;case 1:v=Rt("\r",e[0][x][1][1]);break;default:if(v="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}u=u+v,x=-1}o.push(u+B7[g[0]]+c);break;case"PtgIsect":c=o.pop(),u=o.pop(),o.push(u+" "+c);break;case"PtgUnion":c=o.pop(),u=o.pop(),o.push(u+","+c);break;case"PtgRange":c=o.pop(),u=o.pop(),o.push(u+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=yl(g[1][1],i,n),o.push(wl(d,a));break;case"PtgRefN":d=r?yl(g[1][1],r,n):g[1][1],o.push(wl(d,a));break;case"PtgRef3d":f=g[1][1],d=yl(g[1][2],i,n),p=lw(s,f,n),o.push(p+"!"+wl(d,a));break;case"PtgFunc":case"PtgFuncVar":var _=g[1][0],b=g[1][1];_||(_=0),_&=127;var k=_==0?[]:o.slice(-_);o.length-=_,b==="User"&&(b=k.shift()),o.push(b+"("+k.join(",")+")");break;case"PtgBool":o.push(g[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(g[1]);break;case"PtgNum":o.push(String(g[1]));break;case"PtgStr":o.push('"'+g[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(g[1]);break;case"PtgAreaN":m=Ly(g[1][1],r?{s:r}:i,n),o.push(Tf(m,n));break;case"PtgArea":m=Ly(g[1][1],i,n),o.push(Tf(m,n));break;case"PtgArea3d":f=g[1][1],m=g[1][2],p=lw(s,f,n),o.push(p+"!"+Tf(m,n));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=g[1][2];var S=(s.names||[])[h-1]||(s[0]||[])[h],T=S?S.Name:"SH33TJSNAME"+String(h);T&&T.slice(0,6)=="_xlfn."&&!n.xlfn&&(T=T.slice(6)),o.push(T);break;case"PtgNameX":var j=g[1][1];h=g[1][2];var U;if(n.biff<=5)j<0&&(j=-j),s[j]&&(U=s[j][h]);else{var H="";if(((s[j]||[])[0]||[])[0]==14849||(((s[j]||[])[0]||[])[0]==1025?s[j][h]&&s[j][h].itab>0&&(H=s.SheetNames[s[j][h].itab-1]+"!"):H=s.SheetNames[h-1]+"!"),s[j]&&s[j][h])H+=s[j][h].Name;else if(s[0]&&s[0][h])H+=s[0][h].Name;else{var z=(pT(s,j,n)||"").split(";;");z[h-1]?H=z[h-1]:H+="SH33TJSERRX"}o.push(H);break}U||(U={Name:"SH33TJSERRY"}),o.push(U.Name);break;case"PtgParen":var q="(",re=")";if(x>=0){switch(v="",e[0][x][1][0]){case 2:q=Rt(" ",e[0][x][1][1])+q;break;case 3:q=Rt("\r",e[0][x][1][1])+q;break;case 4:re=Rt(" ",e[0][x][1][1])+re;break;case 5:re=Rt("\r",e[0][x][1][1])+re;break;default:if(n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}x=-1}o.push(q+o.pop()+re);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":d={c:g[1][1],r:g[1][0]};var X={c:r.c,r:r.r};if(s.sharedf[Le(d)]){var M=s.sharedf[Le(d)];o.push(yr(M,i,X,s,n))}else{var J=!1;for(c=0;c!=s.arrayf.length;++c)if(u=s.arrayf[c],!(d.c<u[0].s.c||d.c>u[0].e.c)&&!(d.r<u[0].s.r||d.r>u[0].e.r)){o.push(yr(u[1],i,X,s,n)),J=!0;break}J||o.push(g[1])}break;case"PtgArray":o.push("{"+M7(g[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=y;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+g[1].idx+"[#"+g[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(g));default:throw new Error("Unrecognized Formula Token: "+String(g))}var G=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(n.biff!=3&&x>=0&&G.indexOf(e[0][y][0])==-1){g=e[0][x];var D=!0;switch(g[1][0]){case 4:D=!1;case 0:v=Rt(" ",g[1][1]);break;case 5:D=!1;case 1:v=Rt("\r",g[1][1]);break;default:if(v="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+g[1][0])}o.push((D?v:"")+o.pop()+(D?"":v)),x=-1}}if(o.length>1&&n.WTF)throw new Error("bad formula stack");return o[0]}function $7(e,t,r){var s=e.l+t,n=r.biff==2?1:2,a,i=e.read_shift(n);if(i==65535)return[[],Tr(e,t-2)];var o=Pc(e,i,r);return t!==i+n&&(a=Fc(e,t-i-n,o,r)),e.l=s,[o,a]}function V7(e,t,r){var s=e.l+t,n=r.biff==2?1:2,a,i=e.read_shift(n);if(i==65535)return[[],Tr(e,t-2)];var o=Pc(e,i,r);return t!==i+n&&(a=Fc(e,t-i-n,o,r)),e.l=s,[o,a]}function z7(e,t,r,s){var n=e.l+t,a=Pc(e,s,r),i;return n!==e.l&&(i=Fc(e,n-e.l,a,r)),[a,i]}function W7(e,t,r){var s=e.l+t,n,a=e.read_shift(2),i=Pc(e,a,r);return a==65535?[[],Tr(e,t-2)]:(t!==a+2&&(n=Fc(e,s-a-2,i,r)),[i,n])}function H7(e){var t;if(_n(e,e.l+6)!==65535)return[br(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function q7(e){if(e==null){var t=ae(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return ei(e);return ei(0)}function Ff(e,t,r){var s=e.l+t,n=dn(e);r.biff==2&&++e.l;var a=H7(e),i=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=V7(e,s-e.l,r);return{cell:n,val:a[0],formula:o,shared:i>>3&1,tt:a[1]}}function G7(e,t,r,s,n){var a=ri(t,r,n),i=q7(e.v),o=ae(6),c=33;o.write_shift(2,c),o.write_shift(4,0);for(var u=ae(e.bf.length),d=0;d<e.bf.length;++d)u[d]=e.bf[d];var f=rr([a,i,o,u]);return f}function m0(e,t,r){var s=e.read_shift(4),n=Pc(e,s,r),a=e.read_shift(4),i=a>0?Fc(e,a,n,r):null;return[n,i]}var K7=m0,x0=m0,X7=m0,Y7=m0,J7={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},mT={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Q7={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function cw(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function Z7(e){var t="of:="+e.replace(Kx,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Pf(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function e9(e){return e.replace(/\./,"!")}var bl={},to={},Sl=typeof Map<"u";function Jx(e,t,r){var s=0,n=e.length;if(r){if(Sl?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var a=Sl?r.get(t):r[t];s<a.length;++s)if(e[a[s]].t===t)return e.Count++,a[s]}}else for(;s<n;++s)if(e[s].t===t)return e.Count++,s;return e[n]={t},e.Count++,e.Unique++,r&&(Sl?(r.has(t)||r.set(t,[]),r.get(t).push(n)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(n))),n}function g0(e,t){var r={min:e+1,max:e+1},s=-1;return t.MDW&&(_r=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?s=uc(t.wpx):t.wch!=null&&(s=t.wch),s>-1?(r.width=Dd(s),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function qa(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function ya(e,t,r){var s=r.revssf[t.z!=null?t.z:"General"],n=60,a=e.length;if(s==null&&r.ssf){for(;n<392;++n)if(r.ssf[n]==null){kn(t.z,n),r.ssf[n]=t.z,r.revssf[t.z]=s=n;break}}for(n=0;n!=a;++n)if(e[n].numFmtId===s)return n;return e[a]={numFmtId:s,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},a}function xT(e,t,r,s,n,a){try{s.cellNF&&(e.z=De[t])}catch(o){if(s.WTF)throw o}if(!(e.t==="z"&&!s.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=pt(e.v)),(!s||s.cellText!==!1)&&e.t!=="z")try{if(De[t]==null&&kn(JR[t]||"General",t),e.t==="e")e.w=e.w||Dn[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=sc(e.v);else if(e.t==="d"){var i=Zt(e.v);(i|0)===i?e.w=i.toString(10):e.w=sc(i)}else{if(e.v===void 0)return"";e.w=Qa(e.v,to)}else e.t==="d"?e.w=Ps(t,Zt(e.v),to):e.w=Ps(t,e.v,to)}catch(o){if(s.WTF)throw o}if(s.cellStyles&&r!=null)try{e.s=a.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Id(n.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),s.WTF&&(e.s.fgColor.raw_rgb=n.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Id(n.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),s.WTF&&(e.s.bgColor.raw_rgb=n.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(s.WTF&&a.Fills)throw o}}}function t9(e,t,r){if(e&&e["!ref"]){var s=et(e["!ref"]);if(s.e.c<s.s.c||s.e.r<s.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function r9(e,t){var r=et(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=ze(r))}var s9=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,n9=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,a9=/<(?:\w:)?hyperlink [^>]*>/mg,i9=/"(\w*:\w*)"/,o9=/<(?:\w:)?col\b[^>]*[\/]?>/g,l9=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,c9=/<(?:\w:)?pageMargins[^>]*\/>/g,gT=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,u9=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,d9=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function f9(e,t,r,s,n,a,i){if(!e)return e;s||(s={"!id":{}});var o=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",d="",f=e.match(n9);f?(u=e.slice(0,f.index),d=e.slice(f.index+f[0].length)):u=d=e;var h=u.match(gT);h?Qx(h[0],o,n,r):(h=u.match(u9))&&p9(h[0],h[1]||"",o,n,r);var m=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(m>0){var p=u.slice(m,m+50).match(i9);p&&r9(o,p[1])}var x=u.match(d9);x&&x[1]&&N9(x[1],n);var v=[];if(t.cellStyles){var y=u.match(o9);y&&b9(v,y)}f&&A9(f[1],o,t,c,a,i);var w=d.match(l9);w&&(o["!autofilter"]=k9(w[0]));var g=[],_=d.match(s9);if(_)for(m=0;m!=_.length;++m)g[m]=et(_[m].slice(_[m].indexOf('"')+1));var b=d.match(a9);b&&y9(o,b,s);var k=d.match(c9);if(k&&(o["!margins"]=w9(Ue(k[0]))),!o["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(o["!ref"]=ze(c)),t.sheetRows>0&&o["!ref"]){var S=et(o["!ref"]);t.sheetRows<=+S.e.r&&(S.e.r=t.sheetRows-1,S.e.r>c.e.r&&(S.e.r=c.e.r),S.e.r<S.s.r&&(S.s.r=S.e.r),S.e.c>c.e.c&&(S.e.c=c.e.c),S.e.c<S.s.c&&(S.s.c=S.e.c),o["!fullref"]=o["!ref"],o["!ref"]=ze(S))}return v.length>0&&(o["!cols"]=v),g.length>0&&(o["!merges"]=g),o}function h9(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+ze(e[r])+'"/>';return t+"</mergeCells>"}function Qx(e,t,r,s){var n=Ue(e);r.Sheets[s]||(r.Sheets[s]={}),n.codeName&&(r.Sheets[s].CodeName=Ze(ot(n.codeName)))}function p9(e,t,r,s,n){Qx(e.slice(0,e.indexOf(">")),r,s,n)}function m9(e,t,r,s,n){var a=!1,i={},o=null;if(s.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}a=!0,i.codeName=sn(at(c))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),o=(o||"")+we("outlinePr",null,u)}!a&&!o||(n[n.length]=we("sheetPr",o,i))}var x9=["objects","scenarios","selectLockedCells","selectUnlockedCells"],g9=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function v9(e){var t={sheet:1};return x9.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),g9.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=Hx(e.password).toString(16).toUpperCase()),we("sheetProtection",null,t)}function y9(e,t,r){for(var s=Array.isArray(e),n=0;n!=t.length;++n){var a=Ue(ot(t[n]),!0);if(!a.ref)return;var i=((r||{})["!id"]||[])[a.id];i?(a.Target=i.Target,a.location&&(a.Target+="#"+Ze(a.location))):(a.Target="#"+Ze(a.location),i={Target:a.Target,TargetMode:"Internal"}),a.Rel=i,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var o=et(a.ref),c=o.s.r;c<=o.e.r;++c)for(var u=o.s.c;u<=o.e.c;++u){var d=Le({c:u,r:c});s?(e[c]||(e[c]=[]),e[c][u]||(e[c][u]={t:"z",v:void 0}),e[c][u].l=a):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=a)}}}function w9(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function _9(e){return qa(e),we("pageMargins",null,e)}function b9(e,t){for(var r=!1,s=0;s!=t.length;++s){var n=Ue(t[s],!0);n.hidden&&(n.hidden=ft(n.hidden));var a=parseInt(n.min,10)-1,i=parseInt(n.max,10)-1;for(n.outlineLevel&&(n.level=+n.outlineLevel||0),delete n.min,delete n.max,n.width=+n.width,!r&&n.width&&(r=!0,qx(n.width)),ca(n);a<=i;)e[a++]=mt(n)}}function S9(e,t){for(var r=["<cols>"],s,n=0;n!=t.length;++n)(s=t[n])&&(r[r.length]=we("col",null,g0(n,s)));return r[r.length]="</cols>",r.join("")}function k9(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function E9(e,t,r,s){var n=typeof e.ref=="string"?e.ref:ze(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,i=Xr(n);i.s.r==i.e.r&&(i.e.r=Xr(t["!ref"]).e.r,n=ze(i));for(var o=0;o<a.length;++o){var c=a[o];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==s){c.Ref="'"+r.SheetNames[s]+"'!"+n;break}}return o==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:s,Ref:"'"+r.SheetNames[s]+"'!"+n}),we("autoFilter",null,{ref:n})}var T9=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function N9(e,t){t.Views||(t.Views=[{}]),(e.match(T9)||[]).forEach(function(r,s){var n=Ue(r);t.Views[s]||(t.Views[s]={}),+n.zoomScale&&(t.Views[s].zoom=+n.zoomScale),ft(n.rightToLeft)&&(t.Views[s].RTL=!0)})}function j9(e,t,r,s){var n={workbookViewId:"0"};return(((s||{}).Workbook||{}).Views||[])[0]&&(n.rightToLeft=s.Workbook.Views[0].RTL?"1":"0"),we("sheetViews",we("sheetView",null,n),{})}function C9(e,t,r,s){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var n="",a=e.t,i=e.v;if(e.t!=="z")switch(e.t){case"b":n=e.v?"1":"0";break;case"n":n=""+e.v;break;case"e":n=Dn[e.v];break;case"d":s&&s.cellDates?n=pt(e.v,-1).toISOString():(e=mt(e),e.t="n",n=""+(e.v=Zt(pt(e.v)))),typeof e.z>"u"&&(e.z=De[14]);break;default:n=e.v;break}var o=ur("v",at(n)),c={r:t},u=ya(s.cellXfs,e,s);switch(u!==0&&(c.s=u),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(s&&s.bookSST){o=ur("v",""+Jx(s.Strings,e.v,s.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=a&&(e.t=a,e.v=i),typeof e.f=="string"&&e.f){var d=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=we("f",at(e.f),d)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),we("c",o,c)}var A9=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,s=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,n=/ref=["']([^"']*)["']/,a=nc("v"),i=nc("f");return function(c,u,d,f,h,m){for(var p=0,x="",v=[],y=[],w=0,g=0,_=0,b="",k,S,T=0,j=0,U,H,z=0,q=0,re=Array.isArray(m.CellXf),X,M=[],J=[],G=Array.isArray(u),D=[],K={},oe=!1,N=!!d.sheetStubs,W=c.split(t),I=0,B=W.length;I!=B;++I){x=W[I].trim();var ee=x.length;if(ee!==0){var le=0;e:for(p=0;p<ee;++p)switch(x[p]){case">":if(x[p-1]!="/"){++p;break e}if(d&&d.cellStyles){if(S=Ue(x.slice(le,p),!0),T=S.r!=null?parseInt(S.r,10):T+1,j=-1,d.sheetRows&&d.sheetRows<T)continue;K={},oe=!1,S.ht&&(oe=!0,K.hpt=parseFloat(S.ht),K.hpx=vo(K.hpt)),S.hidden=="1"&&(oe=!0,K.hidden=!0),S.outlineLevel!=null&&(oe=!0,K.level=+S.outlineLevel),oe&&(D[T-1]=K)}break;case"<":le=p;break}if(le>=p)break;if(S=Ue(x.slice(le,p),!0),T=S.r!=null?parseInt(S.r,10):T+1,j=-1,!(d.sheetRows&&d.sheetRows<T)){f.s.r>T-1&&(f.s.r=T-1),f.e.r<T-1&&(f.e.r=T-1),d&&d.cellStyles&&(K={},oe=!1,S.ht&&(oe=!0,K.hpt=parseFloat(S.ht),K.hpx=vo(K.hpt)),S.hidden=="1"&&(oe=!0,K.hidden=!0),S.outlineLevel!=null&&(oe=!0,K.level=+S.outlineLevel),oe&&(D[T-1]=K)),v=x.slice(p).split(e);for(var fe=0;fe!=v.length&&v[fe].trim().charAt(0)=="<";++fe);for(v=v.slice(fe),p=0;p!=v.length;++p)if(x=v[p].trim(),x.length!==0){if(y=x.match(r),w=p,g=0,_=0,x="<c "+(x.slice(0,1)=="<"?">":"")+x,y!=null&&y.length===2){for(w=0,b=y[1],g=0;g!=b.length&&!((_=b.charCodeAt(g)-64)<1||_>26);++g)w=26*w+_;--w,j=w}else++j;for(g=0;g!=x.length&&x.charCodeAt(g)!==62;++g);if(++g,S=Ue(x.slice(0,g),!0),S.r||(S.r=Le({r:T-1,c:j})),b=x.slice(g),k={t:""},(y=b.match(a))!=null&&y[1]!==""&&(k.v=Ze(y[1])),d.cellFormula){if((y=b.match(i))!=null&&y[1]!==""){if(k.f=Ze(ot(y[1])).replace(/\r\n/g,`
`),d.xlfn||(k.f=aw(k.f)),y[0].indexOf('t="array"')>-1)k.F=(b.match(n)||[])[1],k.F.indexOf(":")>-1&&M.push([et(k.F),k.F]);else if(y[0].indexOf('t="shared"')>-1){H=Ue(y[0]);var se=Ze(ot(y[1]));d.xlfn||(se=aw(se)),J[parseInt(H.si,10)]=[H,se,S.r]}}else(y=b.match(/<f[^>]*\/>/))&&(H=Ue(y[0]),J[H.si]&&(k.f=TM(J[H.si][1],J[H.si][2],S.r)));var ne=jt(S.r);for(g=0;g<M.length;++g)ne.r>=M[g][0].s.r&&ne.r<=M[g][0].e.r&&ne.c>=M[g][0].s.c&&ne.c<=M[g][0].e.c&&(k.F=M[g][1])}if(S.t==null&&k.v===void 0)if(k.f||k.F)k.v=0,k.t="n";else if(N)k.t="z";else continue;else k.t=S.t||"n";switch(f.s.c>j&&(f.s.c=j),f.e.c<j&&(f.e.c=j),k.t){case"n":if(k.v==""||k.v==null){if(!N)continue;k.t="z"}else k.v=parseFloat(k.v);break;case"s":if(typeof k.v>"u"){if(!N)continue;k.t="z"}else U=bl[parseInt(k.v,10)],k.v=U.t,k.r=U.r,d.cellHTML&&(k.h=U.h);break;case"str":k.t="s",k.v=k.v!=null?ot(k.v):"",d.cellHTML&&(k.h=Ax(k.v));break;case"inlineStr":y=b.match(s),k.t="s",y!=null&&(U=Wx(y[1]))?(k.v=U.t,d.cellHTML&&(k.h=U.h)):k.v="";break;case"b":k.v=ft(k.v);break;case"d":d.cellDates?k.v=pt(k.v,1):(k.v=Zt(pt(k.v,1)),k.t="n");break;case"e":(!d||d.cellText!==!1)&&(k.w=k.v),k.v=yE[k.v];break}if(z=q=0,X=null,re&&S.s!==void 0&&(X=m.CellXf[S.s],X!=null&&(X.numFmtId!=null&&(z=X.numFmtId),d.cellStyles&&X.fillId!=null&&(q=X.fillId))),xT(k,z,q,d,h,m),d.cellDates&&re&&k.t=="n"&&Co(De[z])&&(k.t="d",k.v=h0(k.v)),S.cm&&d.xlmeta){var V=(d.xlmeta.Cell||[])[+S.cm-1];V&&V.type=="XLDAPR"&&(k.D=!0)}if(G){var C=jt(S.r);u[C.r]||(u[C.r]=[]),u[C.r][C.c]=k}else u[S.r]=k}}}}D.length>0&&(u["!rows"]=D)}}();function F9(e,t,r,s){var n=[],a=[],i=et(e["!ref"]),o="",c,u="",d=[],f=0,h=0,m=e["!rows"],p=Array.isArray(e),x={r:u},v,y=-1;for(h=i.s.c;h<=i.e.c;++h)d[h]=Nt(h);for(f=i.s.r;f<=i.e.r;++f){for(a=[],u=Bt(f),h=i.s.c;h<=i.e.c;++h){c=d[h]+u;var w=p?(e[f]||[])[h]:e[c];w!==void 0&&(o=C9(w,c,e,t))!=null&&a.push(o)}(a.length>0||m&&m[f])&&(x={r:u},m&&m[f]&&(v=m[f],v.hidden&&(x.hidden=1),y=-1,v.hpx?y=dc(v.hpx):v.hpt&&(y=v.hpt),y>-1&&(x.ht=y,x.customHeight=1),v.level&&(x.outlineLevel=v.level)),n[n.length]=we("row",a.join(""),x))}if(m)for(;f<m.length;++f)m&&m[f]&&(x={r:f+1},v=m[f],v.hidden&&(x.hidden=1),y=-1,v.hpx?y=dc(v.hpx):v.hpt&&(y=v.hpt),y>-1&&(x.ht=y,x.customHeight=1),v.level&&(x.outlineLevel=v.level),n[n.length]=we("row","",x));return n.join("")}function vT(e,t,r,s){var n=[Ut,we("worksheet",null,{xmlns:ii[0],"xmlns:r":Jt.r})],a=r.SheetNames[e],i=0,o="",c=r.Sheets[a];c==null&&(c={});var u=c["!ref"]||"A1",d=et(u);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),u=ze(d)}s||(s={}),c["!comments"]=[];var f=[];m9(c,r,e,t,n),n[n.length]=we("dimension",null,{ref:u}),n[n.length]=j9(c,t,e,r),t.sheetFormat&&(n[n.length]=we("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(n[n.length]=S9(c,c["!cols"])),n[i=n.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(o=F9(c,t),o.length>0&&(n[n.length]=o)),n.length>i+1&&(n[n.length]="</sheetData>",n[i]=n[i].replace("/>",">")),c["!protect"]&&(n[n.length]=v9(c["!protect"])),c["!autofilter"]!=null&&(n[n.length]=E9(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(n[n.length]=h9(c["!merges"]));var h=-1,m,p=-1;return c["!links"].length>0&&(n[n.length]="<hyperlinks>",c["!links"].forEach(function(x){x[1].Target&&(m={ref:x[0]},x[1].Target.charAt(0)!="#"&&(p=nt(s,-1,at(x[1].Target).replace(/#.*$/,""),Ge.HLINK),m["r:id"]="rId"+p),(h=x[1].Target.indexOf("#"))>-1&&(m.location=at(x[1].Target.slice(h+1))),x[1].Tooltip&&(m.tooltip=at(x[1].Tooltip)),n[n.length]=we("hyperlink",null,m))}),n[n.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(n[n.length]=_9(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(n[n.length]=ur("ignoredErrors",we("ignoredError",null,{numberStoredAsText:1,sqref:u}))),f.length>0&&(p=nt(s,-1,"../drawings/drawing"+(e+1)+".xml",Ge.DRAW),n[n.length]=we("drawing",null,{"r:id":"rId"+p}),c["!drawing"]=f),c["!comments"].length>0&&(p=nt(s,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Ge.VML),n[n.length]=we("legacyDrawing",null,{"r:id":"rId"+p}),c["!legacy"]=p),n.length>1&&(n[n.length]="</worksheet>",n[1]=n[1].replace("/>",">")),n.join("")}function P9(e,t){var r={},s=e.l+t;r.r=e.read_shift(4),e.l+=4;var n=e.read_shift(2);e.l+=1;var a=e.read_shift(1);return e.l=s,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=n/20),r}function R9(e,t,r){var s=ae(145),n=(r["!rows"]||[])[e]||{};s.write_shift(4,e),s.write_shift(4,0);var a=320;n.hpx?a=dc(n.hpx)*20:n.hpt&&(a=n.hpt*20),s.write_shift(2,a),s.write_shift(1,0);var i=0;n.level&&(i|=n.level),n.hidden&&(i|=16),(n.hpx||n.hpt)&&(i|=32),s.write_shift(1,i),s.write_shift(1,0);var o=0,c=s.l;s.l+=4;for(var u={r:e,c:0},d=0;d<16;++d)if(!(t.s.c>d+1<<10||t.e.c<d<<10)){for(var f=-1,h=-1,m=d<<10;m<d+1<<10;++m){u.c=m;var p=Array.isArray(r)?(r[u.r]||[])[u.c]:r[Le(u)];p&&(f<0&&(f=m),h=m)}f<0||(++o,s.write_shift(4,f),s.write_shift(4,h))}var x=s.l;return s.l=c,s.write_shift(4,o),s.l=x,s.length>s.l?s.slice(0,s.l):s}function O9(e,t,r,s){var n=R9(s,r,t);(n.length>17||(t["!rows"]||[])[s])&&ce(e,0,n)}var I9=ui,D9=Po;function L9(){}function M9(e,t){var r={},s=e[e.l];return++e.l,r.above=!(s&64),r.left=!(s&128),e.l+=18,r.name=$O(e),r}function B9(e,t,r){r==null&&(r=ae(84+4*e.length));var s=192;t&&(t.above&&(s&=-65),t.left&&(s&=-129)),r.write_shift(1,s);for(var n=1;n<3;++n)r.write_shift(1,0);return Pd({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),pE(e,r),r.slice(0,r.l)}function U9(e){var t=Rs(e);return[t]}function $9(e,t,r){return r==null&&(r=ae(8)),oi(t,r)}function V9(e){var t=li(e);return[t]}function z9(e,t,r){return r==null&&(r=ae(4)),ci(t,r)}function W9(e){var t=Rs(e),r=e.read_shift(1);return[t,r,"b"]}function H9(e,t,r){return r==null&&(r=ae(9)),oi(t,r),r.write_shift(1,e.v?1:0),r}function q9(e){var t=li(e),r=e.read_shift(1);return[t,r,"b"]}function G9(e,t,r){return r==null&&(r=ae(5)),ci(t,r),r.write_shift(1,e.v?1:0),r}function K9(e){var t=Rs(e),r=e.read_shift(1);return[t,r,"e"]}function X9(e,t,r){return r==null&&(r=ae(9)),oi(t,r),r.write_shift(1,e.v),r}function Y9(e){var t=li(e),r=e.read_shift(1);return[t,r,"e"]}function J9(e,t,r){return r==null&&(r=ae(8)),ci(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function Q9(e){var t=Rs(e),r=e.read_shift(4);return[t,r,"s"]}function Z9(e,t,r){return r==null&&(r=ae(12)),oi(t,r),r.write_shift(4,t.v),r}function eB(e){var t=li(e),r=e.read_shift(4);return[t,r,"s"]}function tB(e,t,r){return r==null&&(r=ae(8)),ci(t,r),r.write_shift(4,t.v),r}function rB(e){var t=Rs(e),r=br(e);return[t,r,"n"]}function sB(e,t,r){return r==null&&(r=ae(16)),oi(t,r),ei(e.v,r),r}function yT(e){var t=li(e),r=br(e);return[t,r,"n"]}function nB(e,t,r){return r==null&&(r=ae(12)),ci(t,r),ei(e.v,r),r}function aB(e){var t=Rs(e),r=Bx(e);return[t,r,"n"]}function iB(e,t,r){return r==null&&(r=ae(12)),oi(t,r),mE(e.v,r),r}function oB(e){var t=li(e),r=Bx(e);return[t,r,"n"]}function lB(e,t,r){return r==null&&(r=ae(8)),ci(t,r),mE(e.v,r),r}function cB(e){var t=Rs(e),r=Dx(e);return[t,r,"is"]}function uB(e){var t=Rs(e),r=kr(e);return[t,r,"str"]}function dB(e,t,r){return r==null&&(r=ae(12+4*e.v.length)),oi(t,r),sr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function fB(e){var t=li(e),r=kr(e);return[t,r,"str"]}function hB(e,t,r){return r==null&&(r=ae(8+4*e.v.length)),ci(t,r),sr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function pB(e,t,r){var s=e.l+t,n=Rs(e);n.r=r["!row"];var a=e.read_shift(1),i=[n,a,"b"];if(r.cellFormula){e.l+=2;var o=x0(e,s-e.l,r);i[3]=yr(o,null,n,r.supbooks,r)}else e.l=s;return i}function mB(e,t,r){var s=e.l+t,n=Rs(e);n.r=r["!row"];var a=e.read_shift(1),i=[n,a,"e"];if(r.cellFormula){e.l+=2;var o=x0(e,s-e.l,r);i[3]=yr(o,null,n,r.supbooks,r)}else e.l=s;return i}function xB(e,t,r){var s=e.l+t,n=Rs(e);n.r=r["!row"];var a=br(e),i=[n,a,"n"];if(r.cellFormula){e.l+=2;var o=x0(e,s-e.l,r);i[3]=yr(o,null,n,r.supbooks,r)}else e.l=s;return i}function gB(e,t,r){var s=e.l+t,n=Rs(e);n.r=r["!row"];var a=kr(e),i=[n,a,"str"];if(r.cellFormula){e.l+=2;var o=x0(e,s-e.l,r);i[3]=yr(o,null,n,r.supbooks,r)}else e.l=s;return i}var vB=ui,yB=Po;function wB(e,t){return t==null&&(t=ae(4)),t.write_shift(4,e),t}function _B(e,t){var r=e.l+t,s=ui(e),n=Lx(e),a=kr(e),i=kr(e),o=kr(e);e.l=r;var c={rfx:s,relId:n,loc:a,display:o};return i&&(c.Tooltip=i),c}function bB(e,t){var r=ae(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Po({s:jt(e[0]),e:jt(e[0])},r),Mx("rId"+t,r);var s=e[1].Target.indexOf("#"),n=s==-1?"":e[1].Target.slice(s+1);return sr(n||"",r),sr(e[1].Tooltip||"",r),sr("",r),r.slice(0,r.l)}function SB(){}function kB(e,t,r){var s=e.l+t,n=xE(e),a=e.read_shift(1),i=[n];if(i[2]=a,r.cellFormula){var o=K7(e,s-e.l,r);i[1]=o}else e.l=s;return i}function EB(e,t,r){var s=e.l+t,n=ui(e),a=[n];if(r.cellFormula){var i=Y7(e,s-e.l,r);a[1]=i,e.l=s}else e.l=s;return a}function TB(e,t,r){r==null&&(r=ae(18));var s=g0(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(s.width||10)*256),r.write_shift(4,0);var n=0;return t.hidden&&(n|=1),typeof s.width=="number"&&(n|=2),t.level&&(n|=t.level<<8),r.write_shift(2,n),r}var wT=["left","right","top","bottom","header","footer"];function NB(e){var t={};return wT.forEach(function(r){t[r]=br(e)}),t}function jB(e,t){return t==null&&(t=ae(6*8)),qa(e),wT.forEach(function(r){ei(e[r],t)}),t}function CB(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function AB(e,t,r){r==null&&(r=ae(30));var s=924;return(((t||{}).Views||[])[0]||{}).RTL&&(s|=32),r.write_shift(2,s),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function FB(e){var t=ae(24);return t.write_shift(4,4),t.write_shift(4,1),Po(e,t),t}function PB(e,t){return t==null&&(t=ae(16*4+2)),t.write_shift(2,e.password?Hx(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function RB(){}function OB(){}function IB(e,t,r,s,n,a,i){if(!e)return e;var o=t||{};s||(s={"!id":{}});var c=o.dense?[]:{},u,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,h=!1,m,p,x,v,y,w,g,_,b,k=[];o.biff=12,o["!row"]=0;var S=0,T=!1,j=[],U={},H=o.supbooks||n.supbooks||[[]];if(H.sharedf=U,H.arrayf=j,H.SheetNames=n.SheetNames||n.Sheets.map(function(G){return G.name}),!o.supbooks&&(o.supbooks=H,n.Names))for(var z=0;z<n.Names.length;++z)H[0][z+1]=n.Names[z];var q=[],re=[],X=!1;fc[16]={n:"BrtShortReal",f:yT};var M;if(In(e,function(D,K,oe){if(!h)switch(oe){case 148:u=D;break;case 0:m=D,o.sheetRows&&o.sheetRows<=m.r&&(h=!0),_=Bt(v=m.r),o["!row"]=m.r,(D.hidden||D.hpt||D.level!=null)&&(D.hpt&&(D.hpx=vo(D.hpt)),re[D.r]=D);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(p={t:D[2]},D[2]){case"n":p.v=D[1];break;case"s":g=bl[D[1]],p.v=g.t,p.r=g.r;break;case"b":p.v=!!D[1];break;case"e":p.v=D[1],o.cellText!==!1&&(p.w=Dn[p.v]);break;case"str":p.t="s",p.v=D[1];break;case"is":p.t="s",p.v=D[1].t;break}if((x=i.CellXf[D[0].iStyleRef])&&xT(p,x.numFmtId,null,o,a,i),y=D[0].c==-1?y+1:D[0].c,o.dense?(c[v]||(c[v]=[]),c[v][y]=p):c[Nt(y)+_]=p,o.cellFormula){for(T=!1,S=0;S<j.length;++S){var N=j[S];m.r>=N[0].s.r&&m.r<=N[0].e.r&&y>=N[0].s.c&&y<=N[0].e.c&&(p.F=ze(N[0]),T=!0)}!T&&D.length>3&&(p.f=D[3])}if(d.s.r>m.r&&(d.s.r=m.r),d.s.c>y&&(d.s.c=y),d.e.r<m.r&&(d.e.r=m.r),d.e.c<y&&(d.e.c=y),o.cellDates&&x&&p.t=="n"&&Co(De[x.numFmtId])){var W=Ma(p.v);W&&(p.t="d",p.v=new Date(W.y,W.m-1,W.d,W.H,W.M,W.S,W.u))}M&&(M.type=="XLDAPR"&&(p.D=!0),M=void 0);break;case 1:case 12:if(!o.sheetStubs||f)break;p={t:"z",v:void 0},y=D[0].c==-1?y+1:D[0].c,o.dense?(c[v]||(c[v]=[]),c[v][y]=p):c[Nt(y)+_]=p,d.s.r>m.r&&(d.s.r=m.r),d.s.c>y&&(d.s.c=y),d.e.r<m.r&&(d.e.r=m.r),d.e.c<y&&(d.e.c=y),M&&(M.type=="XLDAPR"&&(p.D=!0),M=void 0);break;case 176:k.push(D);break;case 49:M=((o.xlmeta||{}).Cell||[])[D-1];break;case 494:var I=s["!id"][D.relId];for(I?(D.Target=I.Target,D.loc&&(D.Target+="#"+D.loc),D.Rel=I):D.relId==""&&(D.Target="#"+D.loc),v=D.rfx.s.r;v<=D.rfx.e.r;++v)for(y=D.rfx.s.c;y<=D.rfx.e.c;++y)o.dense?(c[v]||(c[v]=[]),c[v][y]||(c[v][y]={t:"z",v:void 0}),c[v][y].l=D):(w=Le({c:y,r:v}),c[w]||(c[w]={t:"z",v:void 0}),c[w].l=D);break;case 426:if(!o.cellFormula)break;j.push(D),b=o.dense?c[v][y]:c[Nt(y)+_],b.f=yr(D[1],d,{r:m.r,c:y},H,o),b.F=ze(D[0]);break;case 427:if(!o.cellFormula)break;U[Le(D[0].s)]=D[1],b=o.dense?c[v][y]:c[Nt(y)+_],b.f=yr(D[1],d,{r:m.r,c:y},H,o);break;case 60:if(!o.cellStyles)break;for(;D.e>=D.s;)q[D.e--]={width:D.w/256,hidden:!!(D.flags&1),level:D.level},X||(X=!0,qx(D.w/256)),ca(q[D.e+1]);break;case 161:c["!autofilter"]={ref:ze(D)};break;case 476:c["!margins"]=D;break;case 147:n.Sheets[r]||(n.Sheets[r]={}),D.name&&(n.Sheets[r].CodeName=D.name),(D.above||D.left)&&(c["!outline"]={above:D.above,left:D.left});break;case 137:n.Views||(n.Views=[{}]),n.Views[0]||(n.Views[0]={}),D.RTL&&(n.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!K.T){if(!f||o.WTF)throw new Error("Unexpected record 0x"+oe.toString(16))}}},o),delete o.supbooks,delete o["!row"],!c["!ref"]&&(d.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(c["!ref"]=ze(u||d)),o.sheetRows&&c["!ref"]){var J=et(c["!ref"]);o.sheetRows<=+J.e.r&&(J.e.r=o.sheetRows-1,J.e.r>d.e.r&&(J.e.r=d.e.r),J.e.r<J.s.r&&(J.s.r=J.e.r),J.e.c>d.e.c&&(J.e.c=d.e.c),J.e.c<J.s.c&&(J.s.c=J.e.c),c["!fullref"]=c["!ref"],c["!ref"]=ze(J))}return k.length>0&&(c["!merges"]=k),q.length>0&&(c["!cols"]=q),re.length>0&&(c["!rows"]=re),c}function DB(e,t,r,s,n,a,i){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=mt(t),t.z=t.z||De[14],t.v=Zt(pt(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var c={r,c:s};switch(c.s=ya(n.cellXfs,t,n),t.l&&a["!links"].push([Le(c),t.l]),t.c&&a["!comments"].push([Le(c),t.c]),t.t){case"s":case"str":return n.bookSST?(o=Jx(n.Strings,t.v,n.revStrings),c.t="s",c.v=o,i?ce(e,18,tB(t,c)):ce(e,7,Z9(t,c))):(c.t="str",i?ce(e,17,hB(t,c)):ce(e,6,dB(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?i?ce(e,13,lB(t,c)):ce(e,2,iB(t,c)):i?ce(e,16,nB(t,c)):ce(e,5,sB(t,c)),!0;case"b":return c.t="b",i?ce(e,15,G9(t,c)):ce(e,4,H9(t,c)),!0;case"e":return c.t="e",i?ce(e,14,J9(t,c)):ce(e,3,X9(t,c)),!0}return i?ce(e,12,z9(t,c)):ce(e,1,$9(t,c)),!0}function LB(e,t,r,s){var n=et(t["!ref"]||"A1"),a,i="",o=[];ce(e,145);var c=Array.isArray(t),u=n.e.r;t["!rows"]&&(u=Math.max(n.e.r,t["!rows"].length-1));for(var d=n.s.r;d<=u;++d){i=Bt(d),O9(e,t,n,d);var f=!1;if(d<=n.e.r)for(var h=n.s.c;h<=n.e.c;++h){d===n.s.r&&(o[h]=Nt(h)),a=o[h]+i;var m=c?(t[d]||[])[h]:t[a];if(!m){f=!1;continue}f=DB(e,m,d,h,s,t,f)}}ce(e,146)}function MB(e,t){!t||!t["!merges"]||(ce(e,177,wB(t["!merges"].length)),t["!merges"].forEach(function(r){ce(e,176,yB(r))}),ce(e,178))}function BB(e,t){!t||!t["!cols"]||(ce(e,390),t["!cols"].forEach(function(r,s){r&&ce(e,60,TB(s,r))}),ce(e,391))}function UB(e,t){!t||!t["!ref"]||(ce(e,648),ce(e,649,FB(et(t["!ref"]))),ce(e,650))}function $B(e,t,r){t["!links"].forEach(function(s){if(s[1].Target){var n=nt(r,-1,s[1].Target.replace(/#.*$/,""),Ge.HLINK);ce(e,494,bB(s,n))}}),delete t["!links"]}function VB(e,t,r,s){if(t["!comments"].length>0){var n=nt(s,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Ge.VML);ce(e,551,Mx("rId"+n)),t["!legacy"]=n}}function zB(e,t,r,s){if(t["!autofilter"]){var n=t["!autofilter"],a=typeof n.ref=="string"?n.ref:ze(n.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=Xr(a);o.s.r==o.e.r&&(o.e.r=Xr(t["!ref"]).e.r,a=ze(o));for(var c=0;c<i.length;++c){var u=i[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==s){u.Ref="'"+r.SheetNames[s]+"'!"+a;break}}c==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:s,Ref:"'"+r.SheetNames[s]+"'!"+a}),ce(e,161,Po(et(a))),ce(e,162)}}function WB(e,t,r){ce(e,133),ce(e,137,AB(t,r)),ce(e,138),ce(e,134)}function HB(e,t){t["!protect"]&&ce(e,535,PB(t["!protect"]))}function qB(e,t,r,s){var n=Kr(),a=r.SheetNames[e],i=r.Sheets[a]||{},o=a;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var c=et(i["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return i["!links"]=[],i["!comments"]=[],ce(n,129),(r.vbaraw||i["!outline"])&&ce(n,147,B9(o,i["!outline"])),ce(n,148,D9(c)),WB(n,i,r.Workbook),BB(n,i),LB(n,i,e,t),HB(n,i),zB(n,i,r,e),MB(n,i),$B(n,i,s),i["!margins"]&&ce(n,476,jB(i["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&UB(n,i),VB(n,i,e,s),ce(n,130),n.end()}function GB(e){var t=[],r=e.match(/^<c:numCache>/),s;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var i=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(t[+i[1]]=r?+i[2]:i[2])});var n=Ze((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){s=a.replace(/<.*?>/g,"")}),[t,n,s]}function KB(e,t,r,s,n,a){var i=a||{"!type":"chart"};if(!e)return a;var o=0,c=0,u="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var h=GB(f);d.s.r=d.s.c=0,d.e.c=o,u=Nt(o),h[0].forEach(function(m,p){i[u+Bt(p)]={t:"n",v:m,z:h[1]},c=p}),d.e.r<c&&(d.e.r=c),++o}),o>0&&(i["!ref"]=ze(d)),i}function XB(e,t,r,s,n){if(!e)return e;s||(s={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i,o=e.match(gT);return o&&Qx(o[0],a,n,r),(i=e.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=i[1]),s["!id"][a["!rel"]]&&(a["!drawel"]=s["!id"][a["!rel"]]),a}function YB(e,t){e.l+=10;var r=kr(e);return{name:r}}function JB(e,t,r,s,n){if(!e)return e;s||(s={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i=!1;return In(e,function(c,u,d){switch(d){case 550:a["!rel"]=c;break;case 651:n.Sheets[r]||(n.Sheets[r]={}),c.name&&(n.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!i||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},t),s["!id"][a["!rel"]]&&(a["!drawel"]=s["!id"][a["!rel"]]),a}var Zx=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],QB=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],ZB=[],eU=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function uw(e,t){for(var r=0;r!=e.length;++r)for(var s=e[r],n=0;n!=t.length;++n){var a=t[n];if(s[a[0]]==null)s[a[0]]=a[1];else switch(a[2]){case"bool":typeof s[a[0]]=="string"&&(s[a[0]]=ft(s[a[0]]));break;case"int":typeof s[a[0]]=="string"&&(s[a[0]]=parseInt(s[a[0]],10));break}}}function dw(e,t){for(var r=0;r!=t.length;++r){var s=t[r];if(e[s[0]]==null)e[s[0]]=s[1];else switch(s[2]){case"bool":typeof e[s[0]]=="string"&&(e[s[0]]=ft(e[s[0]]));break;case"int":typeof e[s[0]]=="string"&&(e[s[0]]=parseInt(e[s[0]],10));break}}}function _T(e){dw(e.WBProps,Zx),dw(e.CalcPr,eU),uw(e.WBView,QB),uw(e.Sheets,ZB),to.date1904=ft(e.WBProps.date1904)}function tU(e){return!e.Workbook||!e.Workbook.WBProps?"false":ft(e.Workbook.WBProps.date1904)?"true":"false"}var rU="][*?/\\".split("");function bT(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return rU.forEach(function(s){if(e.indexOf(s)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function sU(e,t,r){e.forEach(function(s,n){bT(s);for(var a=0;a<n;++a)if(s==e[a])throw new Error("Duplicate Sheet Name: "+s);if(r){var i=t&&t[n]&&t[n].CodeName||s;if(i.charCodeAt(0)==95&&i.length>22)throw new Error("Bad Code Name: Worksheet"+i)}})}function nU(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];sU(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)t9(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var aU=/<\w+:workbook/;function iU(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},s=!1,n="xmlns",a={},i=0;if(e.replace(Nr,function(c,u){var d=Ue(c);switch(un(d[0])){case"<?xml":break;case"<workbook":c.match(aU)&&(n="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=d[n];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Zx.forEach(function(f){if(d[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=ft(d[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(d[f[0]],10);break;default:r.WBProps[f[0]]=d[f[0]]}}),d.codeName&&(r.WBProps.CodeName=ot(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=Ze(ot(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":s=!0;break;case"</definedNames>":s=!1;break;case"<definedName":a={},a.Name=ot(d.name),d.comment&&(a.Comment=d.comment),d.localSheetId&&(a.Sheet=+d.localSheetId),ft(d.hidden||"0")&&(a.Hidden=!0),i=u+c.length;break;case"</definedName>":a.Ref=Ze(ot(e.slice(i,u))),r.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":s=!0;break;case"</AlternateContent>":s=!1;break;case"<revisionPtr":break;default:if(!s&&t.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return c}),ii.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return _T(r),r}function ST(e){var t=[Ut];t[t.length]=we("workbook",null,{xmlns:ii[0],"xmlns:r":Jt.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,s={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Zx.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(s[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(s.codeName=e.Workbook.WBProps.CodeName,delete s.CodeName)),t[t.length]=we("workbookPr",null,s);var n=e.Workbook&&e.Workbook.Sheets||[],a=0;if(n&&n[0]&&n[0].Hidden){for(t[t.length]="<bookViews>",a=0;a!=e.SheetNames.length&&!(!n[a]||!n[a].Hidden);++a);a==e.SheetNames.length&&(a=0),t[t.length]='<workbookView firstSheet="'+a+'" activeTab="'+a+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",a=0;a!=e.SheetNames.length;++a){var i={name:at(e.SheetNames[a].slice(0,31))};if(i.sheetId=""+(a+1),i["r:id"]="rId"+(a+1),n[a])switch(n[a].Hidden){case 1:i.state="hidden";break;case 2:i.state="veryHidden";break}t[t.length]=we("sheet",null,i)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var c={name:o.Name};o.Comment&&(c.comment=o.Comment),o.Sheet!=null&&(c.localSheetId=""+o.Sheet),o.Hidden&&(c.hidden="1"),o.Ref&&(t[t.length]=we("definedName",at(o.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function oU(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=xp(e),r.name=kr(e),r}function lU(e,t){return t||(t=ae(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Mx(e.strRelID,t),sr(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function cU(e,t){var r={},s=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var n=t>8?kr(e):"";return n.length>0&&(r.CodeName=n),r.autoCompressPictures=!!(s&65536),r.backupFile=!!(s&64),r.checkCompatibility=!!(s&4096),r.date1904=!!(s&1),r.filterPrivacy=!!(s&8),r.hidePivotFieldList=!!(s&1024),r.promptedSolutions=!!(s&16),r.publishItems=!!(s&2048),r.refreshAllConnections=!!(s&262144),r.saveExternalLinkValues=!!(s&128),r.showBorderUnselectedTables=!!(s&4),r.showInkAnnotation=!!(s&32),r.showObjects=["all","placeholders","none"][s>>13&3],r.showPivotChartFilter=!!(s&32768),r.updateLinks=["userSet","never","always"][s>>8&3],r}function uU(e,t){t||(t=ae(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),pE(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function dU(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function fU(e,t,r){var s=e.l+t;e.l+=4,e.l+=1;var n=e.read_shift(4),a=VO(e),i=X7(e,0,r),o=Lx(e);e.l=s;var c={Name:a,Ptg:i};return n<268435455&&(c.Sheet=n),o&&(c.Comment=o),c}function hU(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},s=[],n=!1;t||(t={}),t.biff=12;var a=[],i=[[]];return i.SheetNames=[],i.XTI=[],fc[16]={n:"BrtFRTArchID$",f:dU},In(e,function(c,u,d){switch(d){case 156:i.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(t.SID=c.Sheet),c.Ref=yr(c.Ptg,null,null,i,t),delete t.SID,delete c.Ptg,a.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([d,c]):i[0]=[d,c],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(c),i.XTI=i.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:s.push(d),n=!0;break;case 36:s.pop(),n=!1;break;case 37:s.push(d),n=!0;break;case 38:s.pop(),n=!1;break;case 16:break;default:if(!u.T){if(!n||t.WTF&&s[s.length-1]!=37&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},t),_T(r),r.Names=a,r.supbooks=i,r}function pU(e,t){ce(e,143);for(var r=0;r!=t.SheetNames.length;++r){var s=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,n={Hidden:s,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};ce(e,156,lU(n))}ce(e,144)}function mU(e,t){t||(t=ae(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return sr("SheetJS",t),sr(Ed.version,t),sr(Ed.version,t),sr("7262",t),t.length>t.l?t.slice(0,t.l):t}function xU(e,t){t||(t=ae(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function gU(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,s=0,n=-1,a=-1;s<r.length;++s)!r[s]||!r[s].Hidden&&n==-1?n=s:r[s].Hidden==1&&a==-1&&(a=s);a>n||(ce(e,135),ce(e,158,xU(n)),ce(e,136))}}function vU(e,t){var r=Kr();return ce(r,131),ce(r,128,mU()),ce(r,153,uU(e.Workbook&&e.Workbook.WBProps||null)),gU(r,e),pU(r,e),ce(r,132),r.end()}function yU(e,t,r){return t.slice(-4)===".bin"?hU(e,r):iU(e,r)}function wU(e,t,r,s,n,a,i,o){return t.slice(-4)===".bin"?IB(e,s,r,n,a,i,o):f9(e,s,r,n,a,i,o)}function _U(e,t,r,s,n,a,i,o){return t.slice(-4)===".bin"?JB(e,s,r,n,a):XB(e,s,r,n,a)}function bU(e,t,r,s,n,a,i,o){return t.slice(-4)===".bin"?kM():EM()}function SU(e,t,r,s,n,a,i,o){return t.slice(-4)===".bin"?bM():SM()}function kU(e,t,r,s){return t.slice(-4)===".bin"?yL(e,r,s):oL(e,r,s)}function EU(e,t,r){return sT(e,r)}function TU(e,t,r){return t.slice(-4)===".bin"?TD(e,r):SD(e,r)}function NU(e,t,r){return t.slice(-4)===".bin"?gM(e,r):lM(e,r)}function jU(e,t,r){return t.slice(-4)===".bin"?aM(e):sM(e)}function CU(e,t,r,s){return r.slice(-4)===".bin"?iM(e,t,r,s):void 0}function AU(e,t,r){return t.slice(-4)===".bin"?eM(e,t,r):rM(e,t,r)}function FU(e,t,r){return(t.slice(-4)===".bin"?vU:ST)(e)}function PU(e,t,r,s,n){return(t.slice(-4)===".bin"?qB:vT)(e,r,s,n)}function RU(e,t,r){return(t.slice(-4)===".bin"?CL:tT)(e,r)}function OU(e,t,r){return(t.slice(-4)===".bin"?CD:GE)(e,r)}function IU(e,t,r){return(t.slice(-4)===".bin"?vM:iT)(e)}function DU(e){return(e.slice(-4)===".bin"?tM:nT)()}var kT=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,ET=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Is(e,t){var r=e.split(/\s+/),s=[];if(s[0]=r[0],r.length===1)return s;var n=e.match(kT),a,i,o,c;if(n)for(c=0;c!=n.length;++c)a=n[c].match(ET),(i=a[1].indexOf(":"))===-1?s[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(i+1),s[o]=a[2].slice(1,a[2].length-1));return s}function LU(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var s=e.match(kT),n,a,i,o;if(s)for(o=0;o!=s.length;++o)n=s[o].match(ET),(a=n[1].indexOf(":"))===-1?r[n[1]]=n[2].slice(1,n[2].length-1):(n[1].slice(0,6)==="xmlns:"?i="xmlns"+n[1].slice(6):i=n[1].slice(a+1),r[i]=n[2].slice(1,n[2].length-1));return r}var kl;function MU(e,t){var r=kl[e]||Ze(e);return r==="General"?Qa(t):Ps(r,t)}function BU(e,t,r,s){var n=s;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":n=ft(s);break;case"i2":case"int":n=parseInt(s,10);break;case"r4":case"float":n=parseFloat(s);break;case"date":case"dateTime.tz":n=pt(s);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Ze(t)]=n}function UU(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Dn[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=sc(e.v):e.w=Qa(e.v):e.w=MU(t||"General",e.v)}catch(a){if(r.WTF)throw a}try{var s=kl[t]||t||"General";if(r.cellNF&&(e.z=s),r.cellDates&&e.t=="n"&&Co(s)){var n=Ma(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}catch(a){if(r.WTF)throw a}}}function $U(e,t,r){if(r.cellStyles&&t.Interior){var s=t.Interior;s.Pattern&&(s.patternType=ZD[s.Pattern]||s.Pattern)}e[t.ID]=t}function VU(e,t,r,s,n,a,i,o,c,u){var d="General",f=s.StyleID,h={};u=u||{};var m=[],p=0;for(f===void 0&&o&&(f=o.StyleID),f===void 0&&i&&(f=i.StyleID);a[f]!==void 0&&(a[f].nf&&(d=a[f].nf),a[f].Interior&&m.push(a[f].Interior),!!a[f].Parent);)f=a[f].Parent;switch(r.Type){case"Boolean":s.t="b",s.v=ft(e);break;case"String":s.t="s",s.r=jy(Ze(e)),s.v=e.indexOf("<")>-1?Ze(t||e).replace(/<.*?>/g,""):s.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),s.v=(pt(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),s.v!==s.v?s.v=Ze(e):s.v<60&&(s.v=s.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":s.v===void 0&&(s.v=+e),s.t||(s.t="n");break;case"Error":s.t="e",s.v=yE[e],u.cellText!==!1&&(s.w=e);break;default:e==""&&t==""?s.t="z":(s.t="s",s.v=jy(t||e));break}if(UU(s,d,u),u.cellFormula!==!1)if(s.Formula){var x=Ze(s.Formula);x.charCodeAt(0)==61&&(x=x.slice(1)),s.f=eo(x,n),delete s.Formula,s.ArrayRange=="RC"?s.F=eo("RC:RC",n):s.ArrayRange&&(s.F=eo(s.ArrayRange,n),c.push([et(s.F),s.F]))}else for(p=0;p<c.length;++p)n.r>=c[p][0].s.r&&n.r<=c[p][0].e.r&&n.c>=c[p][0].s.c&&n.c<=c[p][0].e.c&&(s.F=c[p][1]);u.cellStyles&&(m.forEach(function(v){!h.patternType&&v.patternType&&(h.patternType=v.patternType)}),s.s=h),s.StyleID!==void 0&&(s.ixfe=s.StyleID)}function zU(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Rf(e,t){var r=t||{};Ao();var s=Zo(Fx(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(s=ot(s));var n=s.slice(0,1024).toLowerCase(),a=!1;if(n=n.replace(/".*?"/g,""),(n.indexOf(">")&1023)>Math.min(n.indexOf(",")&1023,n.indexOf(";")&1023)){var i=mt(r);return i.type="string",go.to_workbook(s,i)}if(n.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ke){n.indexOf("<"+Ke)>=0&&(a=!0)}),a)return j$(s,r);kl={"General Number":"General","General Date":De[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":De[15],"Short Date":De[14],"Long Time":De[19],"Medium Time":De[18],"Short Time":De[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:De[2],Standard:De[4],Percent:De[10],Scientific:De[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,c=[],u,d={},f=[],h=r.dense?[]:{},m="",p={},x={},v=Is('<Data ss:Type="String">'),y=0,w=0,g=0,_={s:{r:2e6,c:2e6},e:{r:0,c:0}},b={},k={},S="",T=0,j=[],U={},H={},z=0,q=[],re=[],X={},M=[],J,G=!1,D=[],K=[],oe={},N=0,W=0,I={Sheets:[],WBProps:{date1904:!1}},B={};ic.lastIndex=0,s=s.replace(/<!--([\s\S]*?)-->/mg,"");for(var ee="";o=ic.exec(s);)switch(o[3]=(ee=o[3]).toLowerCase()){case"data":if(ee=="data"){if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break}if(c[c.length-1][1])break;o[1]==="/"?VU(s.slice(y,o.index),S,v,c[c.length-1][0]=="comment"?X:p,{c:w,r:g},b,M[w],x,D,r):(S="",v=Is(o[0]),y=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(re.length>0&&(p.c=re),(!r.sheetRows||r.sheetRows>g)&&p.v!==void 0&&(r.dense?(h[g]||(h[g]=[]),h[g][w]=p):h[Nt(w)+Bt(g)]=p),p.HRef&&(p.l={Target:Ze(p.HRef)},p.HRefScreenTip&&(p.l.Tooltip=p.HRefScreenTip),delete p.HRef,delete p.HRefScreenTip),(p.MergeAcross||p.MergeDown)&&(N=w+(parseInt(p.MergeAcross,10)|0),W=g+(parseInt(p.MergeDown,10)|0),j.push({s:{c:w,r:g},e:{c:N,r:W}})),!r.sheetStubs)p.MergeAcross?w=N+1:++w;else if(p.MergeAcross||p.MergeDown){for(var le=w;le<=N;++le)for(var fe=g;fe<=W;++fe)(le>w||fe>g)&&(r.dense?(h[fe]||(h[fe]=[]),h[fe][le]={t:"z"}):h[Nt(le)+Bt(fe)]={t:"z"});w=N+1}else++w;else p=LU(o[0]),p.Index&&(w=+p.Index-1),w<_.s.c&&(_.s.c=w),w>_.e.c&&(_.e.c=w),o[0].slice(-2)==="/>"&&++w,re=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(g<_.s.r&&(_.s.r=g),g>_.e.r&&(_.e.r=g),o[0].slice(-2)==="/>"&&(x=Is(o[0]),x.Index&&(g=+x.Index-1)),w=0,++g):(x=Is(o[0]),x.Index&&(g=+x.Index-1),oe={},(x.AutoFitHeight=="0"||x.Height)&&(oe.hpx=parseInt(x.Height,10),oe.hpt=dc(oe.hpx),K[g]=oe),x.Hidden=="1"&&(oe.hidden=!0,K[g]=oe));break;case"worksheet":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));f.push(m),_.s.r<=_.e.r&&_.s.c<=_.e.c&&(h["!ref"]=ze(_),r.sheetRows&&r.sheetRows<=_.e.r&&(h["!fullref"]=h["!ref"],_.e.r=r.sheetRows-1,h["!ref"]=ze(_))),j.length&&(h["!merges"]=j),M.length>0&&(h["!cols"]=M),K.length>0&&(h["!rows"]=K),d[m]=h}else _={s:{r:2e6,c:2e6},e:{r:0,c:0}},g=w=0,c.push([o[3],!1]),u=Is(o[0]),m=Ze(u.Name),h=r.dense?[]:{},j=[],D=[],K=[],B={name:m,Hidden:0},I.Sheets.push(B);break;case"table":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else{if(o[0].slice(-2)=="/>")break;c.push([o[3],!1]),M=[],G=!1}break;case"style":o[1]==="/"?$U(b,k,r):k=Is(o[0]);break;case"numberformat":k.nf=Ze(Is(o[0]).Format||"General"),kl[k.nf]&&(k.nf=kl[k.nf]);for(var se=0;se!=392&&De[se]!=k.nf;++se);if(se==392){for(se=57;se!=392;++se)if(De[se]==null){kn(k.nf,se);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(J=Is(o[0]),J.Hidden&&(J.hidden=!0,delete J.Hidden),J.Width&&(J.wpx=parseInt(J.Width,10)),!G&&J.wpx>10){G=!0,_r=ZE;for(var ne=0;ne<M.length;++ne)M[ne]&&ca(M[ne])}G&&ca(J),M[J.Index-1||M.length]=J;for(var V=0;V<+J.Span;++V)M[M.length]=mt(J);break;case"namedrange":if(o[1]==="/")break;I.Names||(I.Names=[]);var C=Ue(o[0]),he={Name:C.Name,Ref:eo(C.RefersTo.slice(1),{r:0,c:0})};I.Sheets.length>0&&(he.Sheet=I.Sheets.length-1),I.Names.push(he);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?S+=s.slice(T,o.index):T=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;k.Interior=Is(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?h8(U,ee,s.slice(z,o.index)):z=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else c.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));zU(X),re.push(X)}else c.push([o[3],!1]),u=Is(o[0]),X={a:u.Author};break;case"autofilter":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var ve=Is(o[0]);h["!autofilter"]={ref:eo(ve.Range).replace(/\$/g,"")},c.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"null":break;default:if(c.length==0&&o[3]=="document"||c.length==0&&o[3]=="uof")return xw(s,r);var ke=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:ke=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:ke=!1}break;case"excelworkbook":switch(o[3]){case"date1904":I.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:ke=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:ke=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(s.slice(z,o.index)){case"SheetHidden":B.Hidden=1;break;case"SheetVeryHidden":B.Hidden=2;break}else z=o.index+o[0].length;break;case"header":h["!margins"]||qa(h["!margins"]={},"xlml"),isNaN(+Ue(o[0]).Margin)||(h["!margins"].header=+Ue(o[0]).Margin);break;case"footer":h["!margins"]||qa(h["!margins"]={},"xlml"),isNaN(+Ue(o[0]).Margin)||(h["!margins"].footer=+Ue(o[0]).Margin);break;case"pagemargins":var Ae=Ue(o[0]);h["!margins"]||qa(h["!margins"]={},"xlml"),isNaN(+Ae.Top)||(h["!margins"].top=+Ae.Top),isNaN(+Ae.Left)||(h["!margins"].left=+Ae.Left),isNaN(+Ae.Right)||(h["!margins"].right=+Ae.Right),isNaN(+Ae.Bottom)||(h["!margins"].bottom=+Ae.Bottom);break;case"displayrighttoleft":I.Views||(I.Views=[]),I.Views[0]||(I.Views[0]={}),I.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:ke=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:ke=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:ke=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:ke=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:ke=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:ke=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:ke=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:ke=!1}break;case"smarttags":break;default:ke=!1;break}if(ke||o[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?BU(H,ee,q,s.slice(z,o.index)):(q=o,z=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+c.join("|")}var me={};return!r.bookSheets&&!r.bookProps&&(me.Sheets=d),me.SheetNames=f,me.Workbook=I,me.SSF=mt(De),me.Props=U,me.Custprops=H,me}function Sp(e,t){switch(tg(t=t||{}),t.type||"base64"){case"base64":return Rf(cs(e),t);case"binary":case"buffer":case"file":return Rf(e,t);case"array":return Rf(ga(e),t)}}function WU(e,t){var r=[];return e.Props&&r.push(p8(e.Props,t)),e.Custprops&&r.push(m8(e.Props,e.Custprops)),r.join("")}function HU(){return""}function qU(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(s,n){var a=[];a.push(we("NumberFormat",null,{"ss:Format":at(De[s.numFmtId])}));var i={"ss:ID":"s"+(21+n)};r.push(we("Style",a.join(""),i))}),we("Styles",r.join(""))}function TT(e){return we("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Xx(e.Ref,{r:0,c:0})})}function GU(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],s=0;s<t.length;++s){var n=t[s];n.Sheet==null&&(n.Name.match(/^_xlfn\./)||r.push(TT(n)))}return we("Names",r.join(""))}function KU(e,t,r,s){if(!e||!((s||{}).Workbook||{}).Names)return"";for(var n=s.Workbook.Names,a=[],i=0;i<n.length;++i){var o=n[i];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||a.push(TT(o)))}return a.join("")}function XU(e,t,r,s){if(!e)return"";var n=[];if(e["!margins"]&&(n.push("<PageSetup>"),e["!margins"].header&&n.push(we("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&n.push(we("Footer",null,{"x:Margin":e["!margins"].footer})),n.push(we("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),n.push("</PageSetup>")),s&&s.Workbook&&s.Workbook.Sheets&&s.Workbook.Sheets[r])if(s.Workbook.Sheets[r].Hidden)n.push(we("Visible",s.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var a=0;a<r&&!(s.Workbook.Sheets[a]&&!s.Workbook.Sheets[a].Hidden);++a);a==r&&n.push("<Selected/>")}return((((s||{}).Workbook||{}).Views||[])[0]||{}).RTL&&n.push("<DisplayRightToLeft/>"),e["!protect"]&&(n.push(ur("ProtectContents","True")),e["!protect"].objects&&n.push(ur("ProtectObjects","True")),e["!protect"].scenarios&&n.push(ur("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?n.push(ur("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&n.push(ur("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(i){e["!protect"][i[0]]&&n.push("<"+i[1]+"/>")})),n.length==0?"":we("WorksheetOptions",n.join(""),{xmlns:Zr.x})}function YU(e){return e.map(function(t){var r=gO(t.t||""),s=we("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return we("Comment",s,{"ss:Author":t.a})}).join("")}function JU(e,t,r,s,n,a,i){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+at(Xx(e.f,i))),e.F&&e.F.slice(0,t.length)==t){var c=jt(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(c.r==i.r?"":"["+(c.r-i.r)+"]")+"C"+(c.c==i.c?"":"["+(c.c-i.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=at(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=at(e.l.Tooltip))),r["!merges"])for(var u=r["!merges"],d=0;d!=u.length;++d)u[d].s.c!=i.c||u[d].s.r!=i.r||(u[d].e.c>u[d].s.c&&(o["ss:MergeAcross"]=u[d].e.c-u[d].s.c),u[d].e.r>u[d].s.r&&(o["ss:MergeDown"]=u[d].e.r-u[d].s.r));var f="",h="";switch(e.t){case"z":if(!s.sheetStubs)return"";break;case"n":f="Number",h=String(e.v);break;case"b":f="Boolean",h=e.v?"1":"0";break;case"e":f="Error",h=Dn[e.v];break;case"d":f="DateTime",h=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||De[14]);break;case"s":f="String",h=xO(e.v||"");break}var m=ya(s.cellXfs,e,s);o["ss:StyleID"]="s"+(21+m),o["ss:Index"]=i.c+1;var p=e.v!=null?h:"",x=e.t=="z"?"":'<Data ss:Type="'+f+'">'+p+"</Data>";return(e.c||[]).length>0&&(x+=YU(e.c)),we("Cell",x,o)}function QU(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=vo(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function ZU(e,t,r,s){if(!e["!ref"])return"";var n=et(e["!ref"]),a=e["!merges"]||[],i=0,o=[];e["!cols"]&&e["!cols"].forEach(function(v,y){ca(v);var w=!!v.width,g=g0(y,v),_={"ss:Index":y+1};w&&(_["ss:Width"]=cc(g.width)),v.hidden&&(_["ss:Hidden"]="1"),o.push(we("Column",null,_))});for(var c=Array.isArray(e),u=n.s.r;u<=n.e.r;++u){for(var d=[QU(u,(e["!rows"]||[])[u])],f=n.s.c;f<=n.e.c;++f){var h=!1;for(i=0;i!=a.length;++i)if(!(a[i].s.c>f)&&!(a[i].s.r>u)&&!(a[i].e.c<f)&&!(a[i].e.r<u)){(a[i].s.c!=f||a[i].s.r!=u)&&(h=!0);break}if(!h){var m={r:u,c:f},p=Le(m),x=c?(e[u]||[])[f]:e[p];d.push(JU(x,p,e,t,r,s,m))}}d.push("</Row>"),d.length>2&&o.push(d.join(""))}return o.join("")}function e$(e,t,r){var s=[],n=r.SheetNames[e],a=r.Sheets[n],i=a?KU(a,t,e,r):"";return i.length>0&&s.push("<Names>"+i+"</Names>"),i=a?ZU(a,t,e,r):"",i.length>0&&s.push("<Table>"+i+"</Table>"),s.push(XU(a,t,e,r)),s.join("")}function t$(e,t){t||(t={}),e.SSF||(e.SSF=mt(De)),e.SSF&&(Ao(),u0(e.SSF),t.revssf=f0(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],ya(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(WU(e,t)),r.push(HU()),r.push(""),r.push("");for(var s=0;s<e.SheetNames.length;++s)r.push(we("Worksheet",e$(s,t,e),{"ss:Name":at(e.SheetNames[s])}));return r[2]=qU(e,t),r[3]=GU(e),Ut+we("Workbook",r.join(""),{xmlns:Zr.ss,"xmlns:o":Zr.o,"xmlns:x":Zr.x,"xmlns:ss":Zr.ss,"xmlns:dt":Zr.dt,"xmlns:html":Zr.html})}function r$(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=GO(r),r.length-r.l<=4)return t;var s=r.read_shift(4);if(s==0||s>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(s=r.read_shift(4),s!==1907505652)||(t.UnicodeClipboardFormat=KO(r),s=r.read_shift(4),s==0||s>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var s$=[60,1084,2066,2165,2175];function n$(e,t,r,s,n){var a=s,i=[],o=r.slice(r.l,r.l+a);if(n&&n.enc&&n.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:n.enc.insitu(o)}i.push(o),r.l+=a;for(var c=_n(r,r.l),u=kp[c],d=0;u!=null&&s$.indexOf(c)>-1;)a=_n(r,r.l+2),d=r.l+4,c==2066?d+=4:(c==2165||c==2175)&&(d+=12),o=r.slice(d,r.l+4+a),i.push(o),r.l+=4+a,u=kp[c=_n(r,r.l)];var f=rr(i);cr(f,0);var h=0;f.lens=[];for(var m=0;m<i.length;++m)f.lens.push(h),h+=i[m].length;if(f.length<s)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+s;return t.f(f,f.length,n)}function Qs(e,t,r){if(e.t!=="z"&&e.XF){var s=0;try{s=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=De[s])}catch(a){if(t.WTF)throw a}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Dn[e.v]:s===0||s=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=sc(e.v):e.w=Qa(e.v):e.w=Ps(s,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(a){if(t.WTF)throw a}if(t.cellDates&&s&&e.t=="n"&&Co(De[s]||String(s))){var n=Ma(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}}function Su(e,t,r){return{v:e,ixfe:t,t:r}}function a$(e,t){var r={opts:{}},s={},n=t.dense?[]:{},a={},i={},o=null,c=[],u="",d={},f,h="",m,p,x,v,y={},w=[],g,_,b=[],k=[],S={Sheets:[],WBProps:{date1904:!1},Views:[{}]},T={},j=function(Ce){return Ce<8?za[Ce]:Ce<64&&k[Ce-8]||za[Ce]},U=function(Ce,rt,hr){var wt=rt.XF.data;if(!(!wt||!wt.patternType||!hr||!hr.cellStyles)){rt.s={},rt.s.patternType=wt.patternType;var fs;(fs=lc(j(wt.icvFore)))&&(rt.s.fgColor={rgb:fs}),(fs=lc(j(wt.icvBack)))&&(rt.s.bgColor={rgb:fs})}},H=function(Ce,rt,hr){if(!(oe>1)&&!(hr.sheetRows&&Ce.r>=hr.sheetRows)){if(hr.cellStyles&&rt.XF&&rt.XF.data&&U(Ce,rt,hr),delete rt.ixfe,delete rt.XF,f=Ce,h=Le(Ce),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),Ce.r<i.s.r&&(i.s.r=Ce.r),Ce.c<i.s.c&&(i.s.c=Ce.c),Ce.r+1>i.e.r&&(i.e.r=Ce.r+1),Ce.c+1>i.e.c&&(i.e.c=Ce.c+1),hr.cellFormula&&rt.f){for(var wt=0;wt<w.length;++wt)if(!(w[wt][0].s.c>Ce.c||w[wt][0].s.r>Ce.r)&&!(w[wt][0].e.c<Ce.c||w[wt][0].e.r<Ce.r)){rt.F=ze(w[wt][0]),(w[wt][0].s.c!=Ce.c||w[wt][0].s.r!=Ce.r)&&delete rt.f,rt.f&&(rt.f=""+yr(w[wt][1],i,Ce,D,z));break}}hr.dense?(n[Ce.r]||(n[Ce.r]=[]),n[Ce.r][Ce.c]=rt):n[h]=rt}},z={enc:!1,sbcch:0,snames:[],sharedf:y,arrayf:w,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(z.password=t.password);var q,re=[],X=[],M=[],J=[],G=!1,D=[];D.SheetNames=z.snames,D.sharedf=z.sharedf,D.arrayf=z.arrayf,D.names=[],D.XTI=[];var K=0,oe=0,N=0,W=[],I=[],B;z.codepage=1200,zs(1200);for(var ee=!1;e.l<e.length-1;){var le=e.l,fe=e.read_shift(2);if(fe===0&&K===10)break;var se=e.l===e.length?0:e.read_shift(2),ne=kp[fe];if(ne&&ne.f){if(t.bookSheets&&K===133&&fe!==133)break;if(K=fe,ne.r===2||ne.r==12){var V=e.read_shift(2);if(se-=2,!z.enc&&V!==fe&&((V&255)<<8|V>>8)!==fe)throw new Error("rt mismatch: "+V+"!="+fe);ne.r==12&&(e.l+=10,se-=10)}var C={};if(fe===10?C=ne.f(e,se,z):C=n$(fe,ne,e,se,z),oe==0&&[9,521,1033,2057].indexOf(K)===-1)continue;switch(fe){case 34:r.opts.Date1904=S.WBProps.date1904=C;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(z.enc||(e.l=0),z.enc=C,!t.password)throw new Error("File is password-protected");if(C.valid==null)throw new Error("Encryption scheme unsupported");if(!C.valid)throw new Error("Password is incorrect");break;case 92:z.lastuser=C;break;case 66:var he=Number(C);switch(he){case 21010:he=1200;break;case 32768:he=1e4;break;case 32769:he=1252;break}zs(z.codepage=he),ee=!0;break;case 317:z.rrtabid=C;break;case 25:z.winlocked=C;break;case 439:r.opts.RefreshAll=C;break;case 12:r.opts.CalcCount=C;break;case 16:r.opts.CalcDelta=C;break;case 17:r.opts.CalcIter=C;break;case 13:r.opts.CalcMode=C;break;case 14:r.opts.CalcPrecision=C;break;case 95:r.opts.CalcSaveRecalc=C;break;case 15:z.CalcRefMode=C;break;case 2211:r.opts.FullCalc=C;break;case 129:C.fDialog&&(n["!type"]="dialog"),C.fBelow||((n["!outline"]||(n["!outline"]={})).above=!0),C.fRight||((n["!outline"]||(n["!outline"]={})).left=!0);break;case 224:b.push(C);break;case 430:D.push([C]),D[D.length-1].XTI=[];break;case 35:case 547:D[D.length-1].push(C);break;case 24:case 536:B={Name:C.Name,Ref:yr(C.rgce,i,null,D,z)},C.itab>0&&(B.Sheet=C.itab-1),D.names.push(B),D[0]||(D[0]=[],D[0].XTI=[]),D[D.length-1].push(C),C.Name=="_xlnm._FilterDatabase"&&C.itab>0&&C.rgce&&C.rgce[0]&&C.rgce[0][0]&&C.rgce[0][0][0]=="PtgArea3d"&&(I[C.itab-1]={ref:ze(C.rgce[0][0][1][2])});break;case 22:z.ExternCount=C;break;case 23:D.length==0&&(D[0]=[],D[0].XTI=[]),D[D.length-1].XTI=D[D.length-1].XTI.concat(C),D.XTI=D.XTI.concat(C);break;case 2196:if(z.biff<8)break;B!=null&&(B.Comment=C[1]);break;case 18:n["!protect"]=C;break;case 19:C!==0&&z.WTF&&console.error("Password verifier: "+C);break;case 133:a[C.pos]=C,z.snames.push(C.name);break;case 10:{if(--oe)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,n["!ref"]=ze(i),t.sheetRows&&t.sheetRows<=i.e.r){var ve=i.e.r;i.e.r=t.sheetRows-1,n["!fullref"]=n["!ref"],n["!ref"]=ze(i),i.e.r=ve}i.e.r++,i.e.c++}re.length>0&&(n["!merges"]=re),X.length>0&&(n["!objects"]=X),M.length>0&&(n["!cols"]=M),J.length>0&&(n["!rows"]=J),S.Sheets.push(T)}u===""?d=n:s[u]=n,n=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(z.biff===8&&(z.biff={9:2,521:3,1033:4}[fe]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[C.BIFFVer]||8),z.biffguess=C.BIFFVer==0,C.BIFFVer==0&&C.dt==4096&&(z.biff=5,ee=!0,zs(z.codepage=28591)),z.biff==8&&C.BIFFVer==0&&C.dt==16&&(z.biff=2),oe++)break;if(n=t.dense?[]:{},z.biff<8&&!ee&&(ee=!0,zs(z.codepage=t.codepage||1252)),z.biff<5||C.BIFFVer==0&&C.dt==4096){u===""&&(u="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var ke={pos:e.l-se,name:u};a[ke.pos]=ke,z.snames.push(u)}else u=(a[le]||{name:""}).name;C.dt==32&&(n["!type"]="chart"),C.dt==64&&(n["!type"]="macro"),re=[],X=[],z.arrayf=w=[],M=[],J=[],G=!1,T={Hidden:(a[le]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:n["!type"]=="chart"&&(t.dense?(n[C.r]||[])[C.c]:n[Le({c:C.c,r:C.r})])&&++C.c,g={ixfe:C.ixfe,XF:b[C.ixfe]||{},v:C.val,t:"n"},N>0&&(g.z=W[g.ixfe>>8&63]),Qs(g,t,r.opts.Date1904),H({c:C.c,r:C.r},g,t);break;case 5:case 517:g={ixfe:C.ixfe,XF:b[C.ixfe],v:C.val,t:C.t},N>0&&(g.z=W[g.ixfe>>8&63]),Qs(g,t,r.opts.Date1904),H({c:C.c,r:C.r},g,t);break;case 638:g={ixfe:C.ixfe,XF:b[C.ixfe],v:C.rknum,t:"n"},N>0&&(g.z=W[g.ixfe>>8&63]),Qs(g,t,r.opts.Date1904),H({c:C.c,r:C.r},g,t);break;case 189:for(var Ae=C.c;Ae<=C.C;++Ae){var me=C.rkrec[Ae-C.c][0];g={ixfe:me,XF:b[me],v:C.rkrec[Ae-C.c][1],t:"n"},N>0&&(g.z=W[g.ixfe>>8&63]),Qs(g,t,r.opts.Date1904),H({c:Ae,r:C.r},g,t)}break;case 6:case 518:case 1030:{if(C.val=="String"){o=C;break}if(g=Su(C.val,C.cell.ixfe,C.tt),g.XF=b[g.ixfe],t.cellFormula){var Ke=C.formula;if(Ke&&Ke[0]&&Ke[0][0]&&Ke[0][0][0]=="PtgExp"){var de=Ke[0][0][1][0],Ee=Ke[0][0][1][1],Oe=Le({r:de,c:Ee});y[Oe]?g.f=""+yr(C.formula,i,C.cell,D,z):g.F=((t.dense?(n[de]||[])[Ee]:n[Oe])||{}).F}else g.f=""+yr(C.formula,i,C.cell,D,z)}N>0&&(g.z=W[g.ixfe>>8&63]),Qs(g,t,r.opts.Date1904),H(C.cell,g,t),o=C}break;case 7:case 519:if(o)o.val=C,g=Su(C,o.cell.ixfe,"s"),g.XF=b[g.ixfe],t.cellFormula&&(g.f=""+yr(o.formula,i,o.cell,D,z)),N>0&&(g.z=W[g.ixfe>>8&63]),Qs(g,t,r.opts.Date1904),H(o.cell,g,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{w.push(C);var Me=Le(C[0].s);if(m=t.dense?(n[C[0].s.r]||[])[C[0].s.c]:n[Me],t.cellFormula&&m){if(!o||!Me||!m)break;m.f=""+yr(C[1],i,C[0],D,z),m.F=ze(C[0])}}break;case 1212:{if(!t.cellFormula)break;if(h){if(!o)break;y[Le(o.cell)]=C[0],m=t.dense?(n[o.cell.r]||[])[o.cell.c]:n[Le(o.cell)],(m||{}).f=""+yr(C[0],i,f,D,z)}}break;case 253:g=Su(c[C.isst].t,C.ixfe,"s"),c[C.isst].h&&(g.h=c[C.isst].h),g.XF=b[g.ixfe],N>0&&(g.z=W[g.ixfe>>8&63]),Qs(g,t,r.opts.Date1904),H({c:C.c,r:C.r},g,t);break;case 513:t.sheetStubs&&(g={ixfe:C.ixfe,XF:b[C.ixfe],t:"z"},N>0&&(g.z=W[g.ixfe>>8&63]),Qs(g,t,r.opts.Date1904),H({c:C.c,r:C.r},g,t));break;case 190:if(t.sheetStubs)for(var We=C.c;We<=C.C;++We){var Ye=C.ixfe[We-C.c];g={ixfe:Ye,XF:b[Ye],t:"z"},N>0&&(g.z=W[g.ixfe>>8&63]),Qs(g,t,r.opts.Date1904),H({c:We,r:C.r},g,t)}break;case 214:case 516:case 4:g=Su(C.val,C.ixfe,"s"),g.XF=b[g.ixfe],N>0&&(g.z=W[g.ixfe>>8&63]),Qs(g,t,r.opts.Date1904),H({c:C.c,r:C.r},g,t);break;case 0:case 512:oe===1&&(i=C);break;case 252:c=C;break;case 1054:if(z.biff==4){W[N++]=C[1];for(var xt=0;xt<N+163&&De[xt]!=C[1];++xt);xt>=163&&kn(C[1],N+163)}else kn(C[1],C[0]);break;case 30:{W[N++]=C;for(var jr=0;jr<N+163&&De[jr]!=C;++jr);jr>=163&&kn(C,N+163)}break;case 229:re=re.concat(C);break;case 93:X[C.cmo[0]]=z.lastobj=C;break;case 438:z.lastobj.TxO=C;break;case 127:z.lastobj.ImData=C;break;case 440:for(v=C[0].s.r;v<=C[0].e.r;++v)for(x=C[0].s.c;x<=C[0].e.c;++x)m=t.dense?(n[v]||[])[x]:n[Le({c:x,r:v})],m&&(m.l=C[1]);break;case 2048:for(v=C[0].s.r;v<=C[0].e.r;++v)for(x=C[0].s.c;x<=C[0].e.c;++x)m=t.dense?(n[v]||[])[x]:n[Le({c:x,r:v})],m&&m.l&&(m.l.Tooltip=C[1]);break;case 28:{if(z.biff<=5&&z.biff>=2)break;m=t.dense?(n[C[0].r]||[])[C[0].c]:n[Le(C[0])];var Ys=X[C[2]];m||(t.dense?(n[C[0].r]||(n[C[0].r]=[]),m=n[C[0].r][C[0].c]={t:"z"}):m=n[Le(C[0])]={t:"z"},i.e.r=Math.max(i.e.r,C[0].r),i.s.r=Math.min(i.s.r,C[0].r),i.e.c=Math.max(i.e.c,C[0].c),i.s.c=Math.min(i.s.c,C[0].c)),m.c||(m.c=[]),p={a:C[1],t:Ys.TxO.t},m.c.push(p)}break;case 2173:qL(b[C.ixfe],C.ext);break;case 125:{if(!z.cellStyles)break;for(;C.e>=C.s;)M[C.e--]={width:C.w/256,level:C.level||0,hidden:!!(C.flags&1)},G||(G=!0,qx(C.w/256)),ca(M[C.e+1])}break;case 520:{var Kt={};C.level!=null&&(J[C.r]=Kt,Kt.level=C.level),C.hidden&&(J[C.r]=Kt,Kt.hidden=!0),C.hpt&&(J[C.r]=Kt,Kt.hpt=C.hpt,Kt.hpx=vo(C.hpt))}break;case 38:case 39:case 40:case 41:n["!margins"]||qa(n["!margins"]={}),n["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[fe]]=C;break;case 161:n["!margins"]||qa(n["!margins"]={}),n["!margins"].header=C.header,n["!margins"].footer=C.footer;break;case 574:C.RTL&&(S.Views[0].RTL=!0);break;case 146:k=C;break;case 2198:q=C;break;case 140:_=C;break;case 442:u?T.CodeName=C||T.name:S.WBProps.CodeName=C||"ThisWorkbook";break}}else ne||console.error("Missing Info for XLS Record 0x"+fe.toString(16)),e.l+=se}return r.SheetNames=It(a).sort(function(Ur,Ce){return Number(Ur)-Number(Ce)}).map(function(Ur){return a[Ur].name}),t.bookSheets||(r.Sheets=s),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&I.forEach(function(Ur,Ce){r.Sheets[r.SheetNames[Ce]]["!autofilter"]=Ur}),r.Strings=c,r.SSF=mt(De),z.enc&&(r.Encryption=z.enc),q&&(r.Themes=q),r.Metadata={},_!==void 0&&(r.Metadata.Country=_),D.names.length>0&&(S.Names=D.names),r.Workbook=S,r}var El={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function i$(e,t,r){var s=Re.find(e,"/!DocumentSummaryInformation");if(s&&s.size>0)try{var n=qy(s,gp,El.DSI);for(var a in n)t[a]=n[a]}catch(u){if(r.WTF)throw u}var i=Re.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var o=qy(i,vp,El.SI);for(var c in o)t[c]==null&&(t[c]=o[c])}catch(u){if(r.WTF)throw u}t.HeadingPairs&&t.TitlesOfParts&&(EE(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function o$(e,t){var r=[],s=[],n=[],a=0,i,o=by(gp,"n"),c=by(vp,"n");if(e.Props)for(i=It(e.Props),a=0;a<i.length;++a)(Object.prototype.hasOwnProperty.call(o,i[a])?r:Object.prototype.hasOwnProperty.call(c,i[a])?s:n).push([i[a],e.Props[i[a]]]);if(e.Custprops)for(i=It(e.Custprops),a=0;a<i.length;++a)Object.prototype.hasOwnProperty.call(e.Props||{},i[a])||(Object.prototype.hasOwnProperty.call(o,i[a])?r:Object.prototype.hasOwnProperty.call(c,i[a])?s:n).push([i[a],e.Custprops[i[a]]]);var u=[];for(a=0;a<n.length;++a)PE.indexOf(n[a][0])>-1||kE.indexOf(n[a][0])>-1||n[a][1]!=null&&u.push(n[a]);s.length&&Re.utils.cfb_add(t,"/SummaryInformation",Gy(s,El.SI,c,vp)),(r.length||u.length)&&Re.utils.cfb_add(t,"/DocumentSummaryInformation",Gy(r,El.DSI,o,gp,u.length?u:null,El.UDI))}function NT(e,t){t||(t={}),tg(t),bx(),t.codepage&&_x(t.codepage);var r,s;if(e.FullPaths){if(Re.find(e,"/encryption"))throw new Error("File is password-protected");r=Re.find(e,"!CompObj"),s=Re.find(e,"/Workbook")||Re.find(e,"/Book")}else{switch(t.type){case"base64":e=ss(cs(e));break;case"binary":e=ss(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}cr(e,0),s={content:e}}var n,a;if(r&&r$(r),t.bookProps&&!t.bookSheets)n={};else{var i=qe?"buffer":"array";if(s&&s.content)n=a$(s.content,t);else if((a=Re.find(e,"PerfectOffice_MAIN"))&&a.content)n=Ha.to_workbook(a.content,(t.type=i,t));else if((a=Re.find(e,"NativeContent_MAIN"))&&a.content)n=Ha.to_workbook(a.content,(t.type=i,t));else throw(a=Re.find(e,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Re.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(n.vbaraw=wM(e))}var o={};return e.FullPaths&&i$(e,o,t),n.Props=n.Custprops=o,t.bookFiles&&(n.cfb=e),n}function l$(e,t){var r=t||{},s=Re.utils.cfb_new({root:"R"}),n="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":n="/Workbook",r.biff=8;break;case"biff5":n="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Re.utils.cfb_add(s,n,jT(e,r)),r.biff==8&&(e.Props||e.Custprops)&&o$(e,s),r.biff==8&&e.vbaraw&&_M(s,Re.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),s}var fc={0:{f:P9},1:{f:U9},2:{f:aB},3:{f:K9},4:{f:W9},5:{f:rB},6:{f:uB},7:{f:Q9},8:{f:gB},9:{f:xB},10:{f:pB},11:{f:mB},12:{f:V9},13:{f:oB},14:{f:Y9},15:{f:q9},16:{f:yT},17:{f:fB},18:{f:eB},19:{f:Dx},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:fU},40:{},42:{},43:{f:uL},44:{f:lL},45:{f:hL},46:{f:mL},47:{f:pL},48:{},49:{f:IO},50:{},51:{f:XL},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:zE},62:{f:cB},63:{f:nM},64:{f:RB},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Tr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:CB},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:M9},148:{f:I9,p:16},151:{f:SB},152:{},153:{f:cU},154:{},155:{},156:{f:oU},157:{},158:{},159:{T:1,f:ED},160:{T:-1},161:{T:1,f:ui},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:vB},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:GL},336:{T:-1},337:{f:QL,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:xp},357:{},358:{},359:{},360:{T:1},361:{},362:{f:VE},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:kB},427:{f:EB},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:NB},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:L9},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:_B},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:xp},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:mM},633:{T:1},634:{T:-1},635:{T:1,f:hM},636:{T:-1},637:{f:BO},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:YB},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:OB},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},kp={6:{f:Ff},10:{f:Bn},12:{f:Wt},13:{f:Wt},14:{f:Dt},15:{f:Dt},16:{f:br},17:{f:Dt},18:{f:Dt},19:{f:Wt},20:{f:Zy},21:{f:Zy},23:{f:VE},24:{f:tw},25:{f:Dt},26:{},27:{},28:{f:OI},29:{},34:{f:Dt},35:{f:ew},38:{f:br},39:{f:br},40:{f:br},41:{f:br},42:{f:Dt},43:{f:Dt},47:{f:qD},49:{f:oI},51:{f:Wt},60:{},61:{f:rI},64:{f:Dt},65:{f:iI},66:{f:Wt},77:{},80:{},81:{},82:{},85:{f:Wt},89:{},90:{},91:{},92:{f:H8},93:{f:LI},94:{},95:{f:Dt},96:{},97:{},99:{f:Dt},125:{f:zE},128:{f:bI},129:{f:G8},130:{f:Wt},131:{f:Dt},132:{f:Dt},133:{f:K8},134:{},140:{f:HI},141:{f:Wt},144:{},146:{f:KI},151:{},152:{},153:{},154:{},155:{},156:{f:Wt},157:{},158:{},160:{f:tD},161:{f:JI},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:vI},190:{f:yI},193:{f:Bn},197:{},198:{},199:{},200:{},201:{},202:{f:Dt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Wt},220:{},221:{f:Dt},222:{},224:{f:_I},225:{f:W8},226:{f:Bn},227:{},229:{f:II},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:Y8},253:{f:cI},255:{f:Q8},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:RE},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Dt},353:{f:Bn},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:NI},431:{f:Dt},432:{},433:{},434:{},437:{},438:{f:UI},439:{f:Dt},440:{f:$I},441:{},442:{f:Cc},443:{},444:{f:Wt},445:{},446:{},448:{f:Bn},449:{f:tI,r:2},450:{f:Bn},512:{f:Yy},513:{f:eD},515:{f:EI},516:{f:dI},517:{f:Qy},519:{f:rD},520:{f:Z8},523:{},545:{f:rw},549:{f:Xy},566:{},574:{f:nI},638:{f:gI},659:{},1048:{},1054:{f:hI},1084:{},1212:{f:FI},2048:{f:zI},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:wu},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Bn},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:XI,r:12},2173:{f:HL,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Dt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:AI,r:12},2197:{},2198:{f:BL,r:12},2199:{},2200:{},2201:{},2202:{f:PI,r:12},2203:{f:Bn},2204:{},2205:{},2206:{},2207:{},2211:{f:eI},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Wt},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:QI},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:GI},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Yy},1:{},2:{f:oD},3:{f:aD},4:{f:nD},5:{f:Qy},7:{f:cD},8:{},9:{f:wu},11:{},22:{f:Wt},30:{f:mI},31:{},32:{},33:{f:rw},36:{},37:{f:Xy},50:{f:uD},62:{},52:{},67:{},68:{f:Wt},69:{},86:{},126:{},127:{f:sD},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:dD},223:{},234:{},354:{},421:{},518:{f:Ff},521:{f:wu},536:{f:tw},547:{f:ew},561:{},579:{},1030:{f:Ff},1033:{f:wu},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function _e(e,t,r,s){var n=t;if(!isNaN(n)){var a=s||(r||[]).length||0,i=e.next(4);i.write_shift(2,n),i.write_shift(2,a),a>0&&Rx(r)&&e.push(r)}}function c$(e,t,r,s){var n=(r||[]).length||0;if(n<=8224)return _e(e,t,r,n);var a=t;if(!isNaN(a)){for(var i=r.parts||[],o=0,c=0,u=0;u+(i[o]||8224)<=8224;)u+=i[o]||8224,o++;var d=e.next(4);for(d.write_shift(2,a),d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u;c<n;){for(d=e.next(4),d.write_shift(2,60),u=0;u+(i[o]||8224)<=8224;)u+=i[o]||8224,o++;d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u}}}function Rc(e,t,r){return e||(e=ae(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function u$(e,t,r,s){var n=ae(9);return Rc(n,e,t),OE(r,s||"b",n),n}function d$(e,t,r){var s=ae(8+2*r.length);return Rc(s,e,t),s.write_shift(1,r.length),s.write_shift(r.length,r,"sbcs"),s.l<s.length?s.slice(0,s.l):s}function f$(e,t,r,s){if(t.v!=null)switch(t.t){case"d":case"n":var n=t.t=="d"?Zt(pt(t.v)):t.v;n==(n|0)&&n>=0&&n<65536?_e(e,2,lD(r,s,n)):_e(e,3,iD(r,s,n));return;case"b":case"e":_e(e,5,u$(r,s,t.v,t.t));return;case"s":case"str":_e(e,4,d$(r,s,(t.v||"").slice(0,255)));return}_e(e,1,Rc(null,r,s))}function h$(e,t,r,s){var n=Array.isArray(t),a=et(t["!ref"]||"A1"),i,o="",c=[];if(a.e.c>255||a.e.r>16383){if(s.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.c,16383),i=ze(a)}for(var u=a.s.r;u<=a.e.r;++u){o=Bt(u);for(var d=a.s.c;d<=a.e.c;++d){u===a.s.r&&(c[d]=Nt(d)),i=c[d]+o;var f=n?(t[u]||[])[d]:t[i];f&&f$(e,f,u,d)}}}function p$(e,t){for(var r=t||{},s=Kr(),n=0,a=0;a<e.SheetNames.length;++a)e.SheetNames[a]==r.sheet&&(n=a);if(n==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return _e(s,r.biff==4?1033:r.biff==3?521:9,zx(e,16,r)),h$(s,e.Sheets[e.SheetNames[n]],n,r),_e(s,10),s.end()}function m$(e,t,r){_e(e,49,lI({sz:12,name:"Arial"},r))}function x$(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var n=s[0];n<=s[1];++n)t[n]!=null&&_e(e,1054,pI(n,t[n],r))})}function g$(e,t){var r=ae(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),_e(e,2151,r),r=ae(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),BE(et(t["!ref"]||"A1"),r),r.write_shift(4,4),_e(e,2152,r)}function v$(e,t){for(var r=0;r<16;++r)_e(e,224,Jy({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(s){_e(e,224,Jy(s,0,t))})}function y$(e,t){for(var r=0;r<t["!links"].length;++r){var s=t["!links"][r];_e(e,440,VI(s)),s[1].Tooltip&&_e(e,2048,WI(s))}delete t["!links"]}function w$(e,t){if(t){var r=0;t.forEach(function(s,n){++r<=256&&s&&_e(e,125,YI(g0(n,s),n))})}}function _$(e,t,r,s,n){var a=16+ya(n.cellXfs,t,n);if(t.v==null&&!t.bf){_e(e,513,ri(r,s,a));return}if(t.bf)_e(e,6,G7(t,r,s,n,a));else switch(t.t){case"d":case"n":var i=t.t=="d"?Zt(pt(t.v)):t.v;_e(e,515,TI(r,s,i,a));break;case"b":case"e":_e(e,517,kI(r,s,t.v,a,n,t.t));break;case"s":case"str":if(n.bookSST){var o=Jx(n.Strings,t.v,n.revStrings);_e(e,253,uI(r,s,o,a))}else _e(e,516,fI(r,s,(t.v||"").slice(0,255),a,n));break;default:_e(e,513,ri(r,s,a))}}function b$(e,t,r){var s=Kr(),n=r.SheetNames[e],a=r.Sheets[n]||{},i=(r||{}).Workbook||{},o=(i.Sheets||[])[e]||{},c=Array.isArray(a),u=t.biff==8,d,f="",h=[],m=et(a["!ref"]||"A1"),p=u?65536:16384;if(m.e.c>255||m.e.r>=p){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");m.e.c=Math.min(m.e.c,255),m.e.r=Math.min(m.e.c,p-1)}_e(s,2057,zx(r,16,t)),_e(s,13,_s(1)),_e(s,12,_s(100)),_e(s,15,Pr(!0)),_e(s,17,Pr(!1)),_e(s,16,ei(.001)),_e(s,95,Pr(!0)),_e(s,42,Pr(!1)),_e(s,43,Pr(!1)),_e(s,130,_s(1)),_e(s,128,SI()),_e(s,131,Pr(!1)),_e(s,132,Pr(!1)),u&&w$(s,a["!cols"]),_e(s,512,xI(m,t)),u&&(a["!links"]=[]);for(var x=m.s.r;x<=m.e.r;++x){f=Bt(x);for(var v=m.s.c;v<=m.e.c;++v){x===m.s.r&&(h[v]=Nt(v)),d=h[v]+f;var y=c?(a[x]||[])[v]:a[d];y&&(_$(s,y,x,v,t),u&&y.l&&a["!links"].push([d,y.l]))}}var w=o.CodeName||o.name||n;return u&&_e(s,574,aI((i.Views||[])[0])),u&&(a["!merges"]||[]).length&&_e(s,229,DI(a["!merges"])),u&&y$(s,a),_e(s,442,IE(w)),u&&g$(s,a),_e(s,10),s.end()}function S$(e,t,r){var s=Kr(),n=(e||{}).Workbook||{},a=n.Sheets||[],i=n.WBProps||{},o=r.biff==8,c=r.biff==5;if(_e(s,2057,zx(e,5,r)),r.bookType=="xla"&&_e(s,135),_e(s,225,o?_s(1200):null),_e(s,193,k8(2)),c&&_e(s,191),c&&_e(s,192),_e(s,226),_e(s,92,q8("SheetJS",r)),_e(s,66,_s(o?1200:1252)),o&&_e(s,353,_s(0)),o&&_e(s,448),_e(s,317,ZI(e.SheetNames.length)),o&&e.vbaraw&&_e(s,211),o&&e.vbaraw){var u=i.CodeName||"ThisWorkbook";_e(s,442,IE(u))}_e(s,156,_s(17)),_e(s,25,Pr(!1)),_e(s,18,Pr(!1)),_e(s,19,_s(0)),o&&_e(s,431,Pr(!1)),o&&_e(s,444,_s(0)),_e(s,61,sI()),_e(s,64,Pr(!1)),_e(s,141,_s(0)),_e(s,34,Pr(tU(e)=="true")),_e(s,14,Pr(!0)),o&&_e(s,439,Pr(!1)),_e(s,218,_s(0)),m$(s,e,r),x$(s,e.SSF,r),v$(s,r),o&&_e(s,352,Pr(!1));var d=s.end(),f=Kr();o&&_e(f,140,qI()),o&&r.Strings&&c$(f,252,J8(r.Strings)),_e(f,10);var h=f.end(),m=Kr(),p=0,x=0;for(x=0;x<e.SheetNames.length;++x)p+=(o?12:11)+(o?2:1)*e.SheetNames[x].length;var v=d.length+p+h.length;for(x=0;x<e.SheetNames.length;++x){var y=a[x]||{};_e(m,133,X8({pos:v,hs:y.Hidden||0,dt:0,name:e.SheetNames[x]},r)),v+=t[x].length}var w=m.end();if(p!=w.length)throw new Error("BS8 "+p+" != "+w.length);var g=[];return d.length&&g.push(d),w.length&&g.push(w),h.length&&g.push(h),rr(g)}function k$(e,t){var r=t||{},s=[];e&&!e.SSF&&(e.SSF=mt(De)),e&&e.SSF&&(Ao(),u0(e.SSF),r.revssf=f0(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,rg(r),r.cellXfs=[],ya(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var n=0;n<e.SheetNames.length;++n)s[s.length]=b$(n,r,e);return s.unshift(S$(e,s,r)),rr(s)}function jT(e,t){for(var r=0;r<=e.SheetNames.length;++r){var s=e.Sheets[e.SheetNames[r]];if(!(!s||!s["!ref"])){var n=Xr(s["!ref"]);n.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var a=t||{};switch(a.biff||2){case 8:case 5:return k$(e,t);case 4:case 3:case 2:return p$(e,t)}throw new Error("invalid type "+a.bookType+" for BIFF")}function fw(e,t){var r=t||{},s=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var n=e.match(/<table/i);if(!n)throw new Error("Invalid HTML: could not find <table>");var a=e.match(/<\/table/i),i=n.index,o=a&&a.index||e.length,c=lO(e.slice(i,o),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,d=0,f=0,h=0,m={s:{r:1e7,c:1e7},e:{r:0,c:0}},p=[];for(i=0;i<c.length;++i){var x=c[i].trim(),v=x.slice(0,3).toLowerCase();if(v=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}d=0;continue}if(!(v!="<td"&&v!="<th")){var y=x.split(/<\/t[dh]>/i);for(o=0;o<y.length;++o){var w=y[o].trim();if(w.match(/<t[dh]/i)){for(var g=w,_=0;g.charAt(0)=="<"&&(_=g.indexOf(">"))>-1;)g=g.slice(_+1);for(var b=0;b<p.length;++b){var k=p[b];k.s.c==d&&k.s.r<u&&u<=k.e.r&&(d=k.e.c+1,b=-1)}var S=Ue(w.slice(0,w.indexOf(">")));h=S.colspan?+S.colspan:1,((f=+S.rowspan)>1||h>1)&&p.push({s:{r:u,c:d},e:{r:u+(f||1)-1,c:d+h-1}});var T=S.t||S["data-t"]||"";if(!g.length){d+=h;continue}if(g=Qk(g),m.s.r>u&&(m.s.r=u),m.e.r<u&&(m.e.r=u),m.s.c>d&&(m.s.c=d),m.e.c<d&&(m.e.c=d),!g.length){d+=h;continue}var j={t:"s",v:g};r.raw||!g.trim().length||T=="s"||(g==="TRUE"?j={t:"b",v:!0}:g==="FALSE"?j={t:"b",v:!1}:isNaN(Gs(g))?isNaN(xo(g).getDate())||(j={t:"d",v:pt(g)},r.cellDates||(j={t:"n",v:Zt(j.v)}),j.z=r.dateNF||De[14]):j={t:"n",v:Gs(g)}),r.dense?(s[u]||(s[u]=[]),s[u][d]=j):s[Le({r:u,c:d})]=j,d+=h}}}}return s["!ref"]=ze(m),p.length&&(s["!merges"]=p),s}function E$(e,t,r,s){for(var n=e["!merges"]||[],a=[],i=t.s.c;i<=t.e.c;++i){for(var o=0,c=0,u=0;u<n.length;++u)if(!(n[u].s.r>r||n[u].s.c>i)&&!(n[u].e.r<r||n[u].e.c<i)){if(n[u].s.r<r||n[u].s.c<i){o=-1;break}o=n[u].e.r-n[u].s.r+1,c=n[u].e.c-n[u].s.c+1;break}if(!(o<0)){var d=Le({r,c:i}),f=s.dense?(e[r]||[])[i]:e[d],h=f&&f.v!=null&&(f.h||Ax(f.w||(Pn(f),f.w)||""))||"",m={};o>1&&(m.rowspan=o),c>1&&(m.colspan=c),s.editable?h='<span contenteditable="true">'+h+"</span>":f&&(m["data-t"]=f&&f.t||"z",f.v!=null&&(m["data-v"]=f.v),f.z!=null&&(m["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+f.l.Target+'">'+h+"</a>")),m.id=(s.id||"sjs")+"-"+d,a.push(we("td",h,m))}}var p="<tr>";return p+a.join("")+"</tr>"}var T$='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',N$="</body></html>";function j$(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return va(fw(r[0],t),t);var s=ig();return r.forEach(function(n,a){og(s,fw(n,t),"Sheet"+(a+1))}),s}function C$(e,t,r){var s=[];return s.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function CT(e,t){var r=t||{},s=r.header!=null?r.header:T$,n=r.footer!=null?r.footer:N$,a=[s],i=Xr(e["!ref"]);r.dense=Array.isArray(e),a.push(C$(e,i,r));for(var o=i.s.r;o<=i.e.r;++o)a.push(E$(e,i,o,r));return a.push("</table>"+n),a.join("")}function AT(e,t,r){var s=r||{},n=0,a=0;if(s.origin!=null)if(typeof s.origin=="number")n=s.origin;else{var i=typeof s.origin=="string"?jt(s.origin):s.origin;n=i.r,a=i.c}var o=t.getElementsByTagName("tr"),c=Math.min(s.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:n,c:a}};if(e["!ref"]){var d=Xr(e["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),n==-1&&(u.e.r=n=d.e.r+1)}var f=[],h=0,m=e["!rows"]||(e["!rows"]=[]),p=0,x=0,v=0,y=0,w=0,g=0;for(e["!cols"]||(e["!cols"]=[]);p<o.length&&x<c;++p){var _=o[p];if(hw(_)){if(s.display)continue;m[x]={hidden:!0}}var b=_.children;for(v=y=0;v<b.length;++v){var k=b[v];if(!(s.display&&hw(k))){var S=k.hasAttribute("data-v")?k.getAttribute("data-v"):k.hasAttribute("v")?k.getAttribute("v"):Qk(k.innerHTML),T=k.getAttribute("data-z")||k.getAttribute("z");for(h=0;h<f.length;++h){var j=f[h];j.s.c==y+a&&j.s.r<x+n&&x+n<=j.e.r&&(y=j.e.c+1-a,h=-1)}g=+k.getAttribute("colspan")||1,((w=+k.getAttribute("rowspan")||1)>1||g>1)&&f.push({s:{r:x+n,c:y+a},e:{r:x+n+(w||1)-1,c:y+a+(g||1)-1}});var U={t:"s",v:S},H=k.getAttribute("data-t")||k.getAttribute("t")||"";S!=null&&(S.length==0?U.t=H||"z":s.raw||S.trim().length==0||H=="s"||(S==="TRUE"?U={t:"b",v:!0}:S==="FALSE"?U={t:"b",v:!1}:isNaN(Gs(S))?isNaN(xo(S).getDate())||(U={t:"d",v:pt(S)},s.cellDates||(U={t:"n",v:Zt(U.v)}),U.z=s.dateNF||De[14]):U={t:"n",v:Gs(S)})),U.z===void 0&&T!=null&&(U.z=T);var z="",q=k.getElementsByTagName("A");if(q&&q.length)for(var re=0;re<q.length&&!(q[re].hasAttribute("href")&&(z=q[re].getAttribute("href"),z.charAt(0)!="#"));++re);z&&z.charAt(0)!="#"&&(U.l={Target:z}),s.dense?(e[x+n]||(e[x+n]=[]),e[x+n][y+a]=U):e[Le({c:y+a,r:x+n})]=U,u.e.c<y+a&&(u.e.c=y+a),y+=g}}++x}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),u.e.r=Math.max(u.e.r,x-1+n),e["!ref"]=ze(u),x>=c&&(e["!fullref"]=ze((u.e.r=o.length-p+x-1+n,u))),e}function FT(e,t){var r=t||{},s=r.dense?[]:{};return AT(s,e,t)}function A$(e,t){return va(FT(e,t),t)}function hw(e){var t="",r=F$(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function F$(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function P$(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(s,n){return Array(parseInt(n,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Ze(t.replace(/<[^>]*>/g,""));return[r]}var pw={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function PT(e,t){var r=t||{},s=Fx(e),n=[],a,i,o={name:""},c="",u=0,d,f,h={},m=[],p=r.dense?[]:{},x,v,y={value:""},w="",g=0,_=[],b=-1,k=-1,S={s:{r:1e6,c:1e7},e:{r:0,c:0}},T=0,j={},U=[],H={},z=0,q=0,re=[],X=1,M=1,J=[],G={Names:[]},D={},K=["",""],oe=[],N={},W="",I=0,B=!1,ee=!1,le=0;for(ic.lastIndex=0,s=s.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");x=ic.exec(s);)switch(x[3]=x[3].replace(/_.*$/,"")){case"table":case"":x[1]==="/"?(S.e.c>=S.s.c&&S.e.r>=S.s.r?p["!ref"]=ze(S):p["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=S.e.r&&(p["!fullref"]=p["!ref"],S.e.r=r.sheetRows-1,p["!ref"]=ze(S)),U.length&&(p["!merges"]=U),re.length&&(p["!rows"]=re),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),m.push(d.name),h[d.name]=p,ee=!1):x[0].charAt(x[0].length-2)!=="/"&&(d=Ue(x[0],!1),b=k=-1,S.s.r=S.s.c=1e7,S.e.r=S.e.c=0,p=r.dense?[]:{},U=[],re=[],ee=!0);break;case"table-row-group":x[1]==="/"?--T:++T;break;case"table-row":case"":if(x[1]==="/"){b+=X,X=1;break}if(f=Ue(x[0],!1),f.?b=f.-1:b==-1&&(b=0),X=+f["number-rows-repeated"]||1,X<10)for(le=0;le<X;++le)T>0&&(re[b+le]={level:T});k=-1;break;case"covered-table-cell":x[1]!=="/"&&++k,r.sheetStubs&&(r.dense?(p[b]||(p[b]=[]),p[b][k]={t:"z"}):p[Le({r:b,c:k})]={t:"z"}),w="",_=[];break;case"table-cell":case"":if(x[0].charAt(x[0].length-2)==="/")++k,y=Ue(x[0],!1),M=parseInt(y["number-columns-repeated"]||"1",10),v={t:"z",v:null},y.formula&&r.cellFormula!=!1&&(v.f=cw(Ze(y.formula))),(y.||y["value-type"])=="string"&&(v.t="s",v.v=Ze(y["string-value"]||""),r.dense?(p[b]||(p[b]=[]),p[b][k]=v):p[Le({r:b,c:k})]=v),k+=M-1;else if(x[1]!=="/"){++k,w="",g=0,_=[],M=1;var fe=X?b+X-1:b;if(k>S.e.c&&(S.e.c=k),k<S.s.c&&(S.s.c=k),b<S.s.r&&(S.s.r=b),fe>S.e.r&&(S.e.r=fe),y=Ue(x[0],!1),oe=[],N={},v={t:y.||y["value-type"],v:null},r.cellFormula)if(y.formula&&(y.formula=Ze(y.formula)),y["number-matrix-columns-spanned"]&&y["number-matrix-rows-spanned"]&&(z=parseInt(y["number-matrix-rows-spanned"],10)||0,q=parseInt(y["number-matrix-columns-spanned"],10)||0,H={s:{r:b,c:k},e:{r:b+z-1,c:k+q-1}},v.F=ze(H),J.push([H,v.F])),y.formula)v.f=cw(y.formula);else for(le=0;le<J.length;++le)b>=J[le][0].s.r&&b<=J[le][0].e.r&&k>=J[le][0].s.c&&k<=J[le][0].e.c&&(v.F=J[le][1]);switch((y["number-columns-spanned"]||y["number-rows-spanned"])&&(z=parseInt(y["number-rows-spanned"],10)||0,q=parseInt(y["number-columns-spanned"],10)||0,H={s:{r:b,c:k},e:{r:b+z-1,c:k+q-1}},U.push(H)),y["number-columns-repeated"]&&(M=parseInt(y["number-columns-repeated"],10)),v.t){case"boolean":v.t="b",v.v=ft(y["boolean-value"]);break;case"float":v.t="n",v.v=parseFloat(y.value);break;case"percentage":v.t="n",v.v=parseFloat(y.value);break;case"currency":v.t="n",v.v=parseFloat(y.value);break;case"date":v.t="d",v.v=pt(y["date-value"]),r.cellDates||(v.t="n",v.v=Zt(v.v)),v.z="m/d/yy";break;case"time":v.t="n",v.v=aO(y["time-value"])/86400,r.cellDates&&(v.t="d",v.v=h0(v.v)),v.z="HH:MM:SS";break;case"number":v.t="n",v.v=parseFloat(y.);break;default:if(v.t==="string"||v.t==="text"||!v.t)v.t="s",y["string-value"]!=null&&(w=Ze(y["string-value"]),_=[]);else throw new Error("Unsupported value type "+v.t)}}else{if(B=!1,v.t==="s"&&(v.v=w||"",_.length&&(v.R=_),B=g==0),D.Target&&(v.l=D),oe.length>0&&(v.c=oe,oe=[]),w&&r.cellText!==!1&&(v.w=w),B&&(v.t="z",delete v.v),(!B||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=b))for(var se=0;se<X;++se){if(M=parseInt(y["number-columns-repeated"]||"1",10),r.dense)for(p[b+se]||(p[b+se]=[]),p[b+se][k]=se==0?v:mt(v);--M>0;)p[b+se][k+M]=mt(v);else for(p[Le({r:b+se,c:k})]=v;--M>0;)p[Le({r:b+se,c:k+M})]=mt(v);S.e.c<=k&&(S.e.c=k)}M=parseInt(y["number-columns-repeated"]||"1",10),k+=M-1,M=0,v={},w="",_=[]}D={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(x[1]==="/"){if((a=n.pop())[0]!==x[3])throw"Bad state: "+a}else x[0].charAt(x[0].length-2)!=="/"&&n.push([x[3],!0]);break;case"annotation":if(x[1]==="/"){if((a=n.pop())[0]!==x[3])throw"Bad state: "+a;N.t=w,_.length&&(N.R=_),N.a=W,oe.push(N)}else x[0].charAt(x[0].length-2)!=="/"&&n.push([x[3],!1]);W="",I=0,w="",g=0,_=[];break;case"creator":x[1]==="/"?W=s.slice(I,x.index):I=x.index+x[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(x[1]==="/"){if((a=n.pop())[0]!==x[3])throw"Bad state: "+a}else x[0].charAt(x[0].length-2)!=="/"&&n.push([x[3],!1]);w="",g=0,_=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(x[1]==="/"){if(j[o.name]=c,(a=n.pop())[0]!==x[3])throw"Bad state: "+a}else x[0].charAt(x[0].length-2)!=="/"&&(c="",o=Ue(x[0],!1),n.push([x[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(n[n.length-1][0]){case"time-style":case"date-style":i=Ue(x[0],!1),c+=pw[x[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(n[n.length-1][0]){case"time-style":case"date-style":i=Ue(x[0],!1),c+=pw[x[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(x[0].slice(-2)==="/>")break;if(x[1]==="/")switch(n[n.length-1][0]){case"number-style":case"date-style":case"time-style":c+=s.slice(u,x.index);break}else u=x.index+x[0].length;break;case"named-range":i=Ue(x[0],!1),K=Pf(i["cell-range-address"]);var ne={Name:i.name,Ref:K[0]+"!"+K[1]};ee&&(ne.Sheet=m.length),G.Names.push(ne);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(n[n.length-1][0])>-1)break;if(x[1]==="/"&&(!y||!y["string-value"])){var V=P$(s.slice(g,x.index));w=(w.length>0?w+`
`:"")+V[0]}else Ue(x[0],!1),g=x.index+x[0].length;break;case"s":break;case"database-range":if(x[1]==="/")break;try{K=Pf(Ue(x[0])["target-range-address"]),h[K[0]]["!autofilter"]={ref:K[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(x[1]!=="/"){if(D=Ue(x[0],!1),!D.href)break;D.Target=Ze(D.href),delete D.href,D.Target.charAt(0)=="#"&&D.Target.indexOf(".")>-1?(K=Pf(D.Target.slice(1)),D.Target="#"+K[0]+"!"+K[1]):D.Target.match(/^\.\.[\\\/]/)&&(D.Target=D.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(x[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(x)}}var C={Sheets:h,SheetNames:m,Workbook:G};return r.bookSheets&&delete C.Sheets,C}function mw(e,t){t=t||{},ws(e,"META-INF/manifest.xml")&&a8(zt(e,"META-INF/manifest.xml"),t);var r=ns(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var s=PT(ot(r),t);return ws(e,"meta.xml")&&(s.Props=bE(zt(e,"meta.xml"))),s}function xw(e,t){return PT(e,t)}var R$=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+ac({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Ut+t}}(),gw=function(){var e=function(a){return at(a).replace(/  +/g,function(i){return'<text:s text:c="'+i.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,s=function(a,i,o){var c=[];c.push('      <table:table table:name="'+at(i.SheetNames[o])+`" table:style-name="ta1">
`);var u=0,d=0,f=Xr(a["!ref"]||"A1"),h=a["!merges"]||[],m=0,p=Array.isArray(a);if(a["!cols"])for(d=0;d<=f.e.c;++d)c.push("        <table:table-column"+(a["!cols"][d]?' table:style-name="co'+a["!cols"][d].ods+'"':"")+`></table:table-column>
`);var x="",v=a["!rows"]||[];for(u=0;u<f.s.r;++u)x=v[u]?' table:style-name="ro'+v[u].ods+'"':"",c.push("        <table:table-row"+x+`></table:table-row>
`);for(;u<=f.e.r;++u){for(x=v[u]?' table:style-name="ro'+v[u].ods+'"':"",c.push("        <table:table-row"+x+`>
`),d=0;d<f.s.c;++d)c.push(t);for(;d<=f.e.c;++d){var y=!1,w={},g="";for(m=0;m!=h.length;++m)if(!(h[m].s.c>d)&&!(h[m].s.r>u)&&!(h[m].e.c<d)&&!(h[m].e.r<u)){(h[m].s.c!=d||h[m].s.r!=u)&&(y=!0),w["table:number-columns-spanned"]=h[m].e.c-h[m].s.c+1,w["table:number-rows-spanned"]=h[m].e.r-h[m].s.r+1;break}if(y){c.push(r);continue}var _=Le({r:u,c:d}),b=p?(a[u]||[])[d]:a[_];if(b&&b.f&&(w["table:formula"]=at(Z7(b.f)),b.F&&b.F.slice(0,_.length)==_)){var k=Xr(b.F);w["table:number-matrix-columns-spanned"]=k.e.c-k.s.c+1,w["table:number-matrix-rows-spanned"]=k.e.r-k.s.r+1}if(!b){c.push(t);continue}switch(b.t){case"b":g=b.v?"TRUE":"FALSE",w["office:value-type"]="boolean",w["office:boolean-value"]=b.v?"true":"false";break;case"n":g=b.w||String(b.v||0),w["office:value-type"]="float",w["office:value"]=b.v||0;break;case"s":case"str":g=b.v==null?"":b.v,w["office:value-type"]="string";break;case"d":g=b.w||pt(b.v).toISOString(),w["office:value-type"]="date",w["office:date-value"]=pt(b.v).toISOString(),w["table:style-name"]="ce1";break;default:c.push(t);continue}var S=e(g);if(b.l&&b.l.Target){var T=b.l.Target;T=T.charAt(0)=="#"?"#"+e9(T.slice(1)):T,T.charAt(0)!="#"&&!T.match(/^\w+:/)&&(T="../"+T),S=we("text:a",S,{"xlink:href":T.replace(/&/g,"&amp;")})}c.push("          "+we("table:table-cell",we("text:p",S,{}),w)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},n=function(a,i){a.push(` <office:automatic-styles>
`),a.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),a.push(`   <number:month number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:day number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:year/>
`),a.push(`  </number:date-style>
`);var o=0;i.SheetNames.map(function(u){return i.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var d=0;d<u["!cols"].length;++d)if(u["!cols"][d]){var f=u["!cols"][d];if(f.width==null&&f.wpx==null&&f.wch==null)continue;ca(f),f.ods=o;var h=u["!cols"][d].wpx+"px";a.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),a.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+h+`"/>
`),a.push(`  </style:style>
`),++o}}});var c=0;i.SheetNames.map(function(u){return i.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var d=0;d<u["!rows"].length;++d)if(u["!rows"][d]){u["!rows"][d].ods=c;var f=u["!rows"][d].hpx+"px";a.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),a.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),a.push(`  </style:style>
`),++c}}}),a.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),a.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),a.push(`  </style:style>
`),a.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),a.push(` </office:automatic-styles>
`)};return function(i,o){var c=[Ut],u=ac({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=ac({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(c.push("<office:document"+u+d+`>
`),c.push(_E().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+u+`>
`),n(c,i),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var f=0;f!=i.SheetNames.length;++f)c.push(s(i.Sheets[i.SheetNames[f]],i,f));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),o.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function RT(e,t){if(t.bookType=="fods")return gw(e,t);var r=Nx(),s="",n=[],a=[];return s="mimetype",He(r,s,"application/vnd.oasis.opendocument.spreadsheet"),s="content.xml",He(r,s,gw(e,t)),n.push([s,"text/xml"]),a.push([s,"ContentFile"]),s="styles.xml",He(r,s,R$(e,t)),n.push([s,"text/xml"]),a.push([s,"StylesFile"]),s="meta.xml",He(r,s,Ut+_E()),n.push([s,"text/xml"]),a.push([s,"MetadataFile"]),s="manifest.rdf",He(r,s,l8(a)),n.push([s,"application/rdf+xml"]),s="META-INF/manifest.xml",He(r,s,i8(n)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function si(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Ep(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):ot(ga(e))}function O$(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):ss(sn(e))}function I$(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var s=0;s<t.length;++s)if(e[r+s]!=t[s])continue e;return!0}return!1}function da(e){var t=e.reduce(function(n,a){return n+a.length},0),r=new Uint8Array(t),s=0;return e.forEach(function(n){r.set(n,s),s+=n.length}),r}function vw(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function D$(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,s=e[t+14]&1,n=t+13;n>=t;--n)s=s*256+e[n];return(e[t+15]&128?-s:s)*Math.pow(10,r-6176)}function L$(e,t,r){var s=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,n=r/Math.pow(10,s-6176);e[t+15]|=s>>7,e[t+14]|=(s&127)<<1;for(var a=0;n>=1;++a,n/=256)e[t+a]=n&255;e[t+15]|=r>=0?0:128}function hc(e,t){var r=t?t[0]:0,s=e[r]&127;e:if(e[r++]>=128&&(s|=(e[r]&127)<<7,e[r++]<128||(s|=(e[r]&127)<<14,e[r++]<128)||(s|=(e[r]&127)<<21,e[r++]<128)||(s+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(s+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(s+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),s}function st(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Ot(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function tt(e){for(var t=[],r=[0];r[0]<e.length;){var s=r[0],n=hc(e,r),a=n&7;n=Math.floor(n/8);var i=0,o;if(n==0)break;switch(a){case 0:{for(var c=r[0];e[r[0]++]>=128;);o=e.slice(c,r[0])}break;case 5:i=4,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 1:i=8,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 2:i=hc(e,r),o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(n," at offset ").concat(s))}var u={data:o,type:a};t[n]==null?t[n]=[u]:t[n].push(u)}return t}function ir(e){var t=[];return e.forEach(function(r,s){r.forEach(function(n){n.data&&(t.push(st(s*8+n.type)),n.type==2&&t.push(st(n.data.length)),t.push(n.data))})}),da(t)}function eg(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function gs(e){for(var t,r=[],s=[0];s[0]<e.length;){var n=hc(e,s),a=tt(e.slice(s[0],s[0]+n));s[0]+=n;var i={id:Ot(a[1][0].data),messages:[]};a[2].forEach(function(o){var c=tt(o.data),u=Ot(c[3][0].data);i.messages.push({meta:c,data:e.slice(s[0],s[0]+u)}),s[0]+=u}),(t=a[3])!=null&&t[0]&&(i.merge=Ot(a[3][0].data)>>>0>0),r.push(i)}return r}function wi(e){var t=[];return e.forEach(function(r){var s=[];s[1]=[{data:st(r.id),type:0}],s[2]=[],r.merge!=null&&(s[3]=[{data:st(+!!r.merge),type:0}]);var n=[];r.messages.forEach(function(i){n.push(i.data),i.meta[3]=[{type:0,data:st(i.data.length)}],s[2].push({data:ir(i.meta),type:2})});var a=ir(s);t.push(st(a.length)),t.push(a),n.forEach(function(i){return t.push(i)})}),da(t)}function M$(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],s=hc(t,r),n=[];r[0]<t.length;){var a=t[r[0]]&3;if(a==0){var i=t[r[0]++]>>2;if(i<60)++i;else{var o=i-59;i=t[r[0]],o>1&&(i|=t[r[0]+1]<<8),o>2&&(i|=t[r[0]+2]<<16),o>3&&(i|=t[r[0]+3]<<24),i>>>=0,i++,r[0]+=o}n.push(t.slice(r[0],r[0]+i)),r[0]+=i;continue}else{var c=0,u=0;if(a==1?(u=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,a==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),n=[da(n)],c==0)throw new Error("Invalid offset 0");if(c>n[0].length)throw new Error("Invalid offset beyond length");if(u>=c)for(n.push(n[0].slice(-c)),u-=c;u>=n[n.length-1].length;)n.push(n[n.length-1]),u-=n[n.length-1].length;n.push(n[0].slice(-c,-c+u))}}var d=da(n);if(d.length!=s)throw new Error("Unexpected length: ".concat(d.length," != ").concat(s));return d}function vs(e){for(var t=[],r=0;r<e.length;){var s=e[r++],n=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(M$(s,e.slice(r,r+n))),r+=n}if(r!==e.length)throw new Error("data is not a valid framed stream!");return da(t)}function _i(e){for(var t=[],r=0;r<e.length;){var s=Math.min(e.length-r,268435455),n=new Uint8Array(4);t.push(n);var a=st(s),i=a.length;t.push(a),s<=60?(i++,t.push(new Uint8Array([s-1<<2]))):s<=256?(i+=2,t.push(new Uint8Array([240,s-1&255]))):s<=65536?(i+=3,t.push(new Uint8Array([244,s-1&255,s-1>>8&255]))):s<=16777216?(i+=4,t.push(new Uint8Array([248,s-1&255,s-1>>8&255,s-1>>16&255]))):s<=4294967296&&(i+=5,t.push(new Uint8Array([252,s-1&255,s-1>>8&255,s-1>>16&255,s-1>>>24&255]))),t.push(e.slice(r,r+s)),i+=s,n[0]=0,n[1]=i&255,n[2]=i>>8&255,n[3]=i>>16&255,r+=s}return da(t)}function B$(e,t,r,s){var n=si(e),a=n.getUint32(4,!0),i=(s>1?12:8)+vw(a&(s>1?3470:398))*4,o=-1,c=-1,u=NaN,d=new Date(2001,0,1);a&512&&(o=n.getUint32(i,!0),i+=4),i+=vw(a&(s>1?12288:4096))*4,a&16&&(c=n.getUint32(i,!0),i+=4),a&32&&(u=n.getFloat64(i,!0),i+=8),a&64&&(d.setTime(d.getTime()+n.getFloat64(i,!0)*1e3),i+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:u};break;case 3:f={t:"s",v:t[c]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:r[o]};else if(c>-1)f={t:"s",v:t[c]};else if(!isNaN(u))f={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function U$(e,t,r){var s=si(e),n=s.getUint32(8,!0),a=12,i=-1,o=-1,c=NaN,u=NaN,d=new Date(2001,0,1);n&1&&(c=D$(e,a),a+=16),n&2&&(u=s.getFloat64(a,!0),a+=8),n&4&&(d.setTime(d.getTime()+s.getFloat64(a,!0)*1e3),a+=8),n&8&&(o=s.getUint32(a,!0),a+=4),n&16&&(i=s.getUint32(a,!0),a+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:t[o]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(i>-1)f={t:"s",v:r[i]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)))}return f}function Of(e,t){var r=new Uint8Array(32),s=si(r),n=12,a=0;switch(r[0]=5,e.t){case"n":r[1]=2,L$(r,n,e.v),a|=1,n+=16;break;case"b":r[1]=6,s.setFloat64(n,e.v?1:0,!0),a|=2,n+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,s.setUint32(n,t.indexOf(e.v),!0),a|=8,n+=4;break;default:throw"unsupported cell type "+e.t}return s.setUint32(8,a,!0),r.slice(0,n)}function If(e,t){var r=new Uint8Array(32),s=si(r),n=12,a=0;switch(r[0]=3,e.t){case"n":r[2]=2,s.setFloat64(n,e.v,!0),a|=32,n+=8;break;case"b":r[2]=6,s.setFloat64(n,e.v?1:0,!0),a|=32,n+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,s.setUint32(n,t.indexOf(e.v),!0),a|=16,n+=4;break;default:throw"unsupported cell type "+e.t}return s.setUint32(4,a,!0),r.slice(0,n)}function $$(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return B$(e,t,r,e[0]);case 5:return U$(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function vr(e){var t=tt(e);return hc(t[1][0].data)}function yw(e,t){var r=tt(t.data),s=Ot(r[1][0].data),n=r[3],a=[];return(n||[]).forEach(function(i){var o=tt(i.data),c=Ot(o[1][0].data)>>>0;switch(s){case 1:a[c]=Ep(o[3][0].data);break;case 8:{var u=e[vr(o[9][0].data)][0],d=tt(u.data),f=e[vr(d[1][0].data)][0],h=Ot(f.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var m=tt(f.data);a[c]=m[3].map(function(p){return Ep(p.data)}).join("")}break}}),a}function V$(e,t){var r,s,n,a,i,o,c,u,d,f,h,m,p,x,v=tt(e),y=Ot(v[1][0].data)>>>0,w=Ot(v[2][0].data)>>>0,g=((s=(r=v[8])==null?void 0:r[0])==null?void 0:s.data)&&Ot(v[8][0].data)>0||!1,_,b;if((a=(n=v[7])==null?void 0:n[0])!=null&&a.data&&t!=0)_=(o=(i=v[7])==null?void 0:i[0])==null?void 0:o.data,b=(u=(c=v[6])==null?void 0:c[0])==null?void 0:u.data;else if((f=(d=v[4])==null?void 0:d[0])!=null&&f.data&&t!=1)_=(m=(h=v[4])==null?void 0:h[0])==null?void 0:m.data,b=(x=(p=v[3])==null?void 0:p[0])==null?void 0:x.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var k=g?4:1,S=si(_),T=[],j=0;j<_.length/2;++j){var U=S.getUint16(j*2,!0);U<65535&&T.push([j,U])}if(T.length!=w)throw"Expected ".concat(w," cells, found ").concat(T.length);var H=[];for(j=0;j<T.length-1;++j)H[T[j][0]]=b.subarray(T[j][1]*k,T[j+1][1]*k);return T.length>=1&&(H[T[T.length-1][0]]=b.subarray(T[T.length-1][1]*k)),{R:y,cells:H}}function z$(e,t){var r,s=tt(t.data),n=(r=s==null?void 0:s[7])!=null&&r[0]?Ot(s[7][0].data)>>>0>0?1:0:-1,a=eg(s[5],function(i){return V$(i,n)});return{nrows:Ot(s[4][0].data)>>>0,data:a.reduce(function(i,o){return i[o.R]||(i[o.R]=[]),o.cells.forEach(function(c,u){if(i[o.R][u])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(u));i[o.R][u]=c}),i},[])}}function W$(e,t,r){var s,n=tt(t.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(Ot(n[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(n[6][0].data));if(a.e.c=(Ot(n[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(n[7][0].data));r["!ref"]=ze(a);var i=tt(n[4][0].data),o=yw(e,e[vr(i[4][0].data)][0]),c=(s=i[17])!=null&&s[0]?yw(e,e[vr(i[17][0].data)][0]):[],u=tt(i[3][0].data),d=0;u[1].forEach(function(f){var h=tt(f.data),m=e[vr(h[2][0].data)][0],p=Ot(m.meta[1][0].data);if(p!=6002)throw new Error("6001 unexpected reference to ".concat(p));var x=z$(e,m);x.data.forEach(function(v,y){v.forEach(function(w,g){var _=Le({r:d+y,c:g}),b=$$(w,o,c);b&&(r[_]=b)})}),d+=x.nrows})}function H$(e,t){var r=tt(t.data),s={"!ref":"A1"},n=e[vr(r[2][0].data)],a=Ot(n[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return W$(e,n[0],s),s}function q$(e,t){var r,s=tt(t.data),n={name:(r=s[1])!=null&&r[0]?Ep(s[1][0].data):"",sheets:[]},a=eg(s[2],vr);return a.forEach(function(i){e[i].forEach(function(o){var c=Ot(o.meta[1][0].data);c==6e3&&n.sheets.push(H$(e,o))})}),n}function G$(e,t){var r=ig(),s=tt(t.data),n=eg(s[1],vr);if(n.forEach(function(a){e[a].forEach(function(i){var o=Ot(i.meta[1][0].data);if(o==2){var c=q$(e,i);c.sheets.forEach(function(u,d){og(r,u,d==0?c.name:c.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Df(e){var t,r,s,n,a={},i=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var u;try{u=vs(c.content)}catch(f){return console.log("?? "+c.content.length+" "+(f.message||f))}var d;try{d=gs(u)}catch(f){return console.log("## "+(f.message||f))}d.forEach(function(f){a[f.id]=f.messages,i.push(f.id)})}}),!i.length)throw new Error("File has no messages");var o=((n=(s=(r=(t=a==null?void 0:a[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:s[1])==null?void 0:n[0].data)&&Ot(a[1][0].meta[1][0].data)==1&&a[1][0];if(o||i.forEach(function(c){a[c].forEach(function(u){var d=Ot(u.meta[1][0].data)>>>0;if(d==1)if(!o)o=u;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return G$(a,o)}function K$(e,t,r){var s,n,a,i;if(!((s=e[6])!=null&&s[0])||!((n=e[7])!=null&&n[0]))throw"Mutation only works on post-BNC storages!";var o=((i=(a=e[8])==null?void 0:a[0])==null?void 0:i.data)&&Ot(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var c=0,u=si(e[7][0].data),d=0,f=[],h=si(e[4][0].data),m=0,p=[],x=0;x<t.length;++x){if(t[x]==null){u.setUint16(x*2,65535,!0),h.setUint16(x*2,65535);continue}u.setUint16(x*2,d,!0),h.setUint16(x*2,m,!0);var v,y;switch(typeof t[x]){case"string":v=Of({t:"s",v:t[x]},r),y=If({t:"s",v:t[x]},r);break;case"number":v=Of({t:"n",v:t[x]},r),y=If({t:"n",v:t[x]},r);break;case"boolean":v=Of({t:"b",v:t[x]},r),y=If({t:"b",v:t[x]},r);break;default:throw new Error("Unsupported value "+t[x])}f.push(v),d+=v.length,p.push(y),m+=y.length,++c}for(e[2][0].data=st(c);x<e[7][0].data.length/2;++x)u.setUint16(x*2,65535,!0),h.setUint16(x*2,65535,!0);return e[6][0].data=da(f),e[3][0].data=da(p),c}function X$(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var s=Xr(r["!ref"]);s.s.r=s.s.c=0;var n=!1;s.e.c>9&&(n=!0,s.e.c=9),s.e.r>49&&(n=!0,s.e.r=49),n&&console.error("The Numbers writer is currently limited to ".concat(ze(s)));var a=Ld(r,{range:s,header:1}),i=["~Sh33tJ5~"];a.forEach(function(W){return W.forEach(function(I){typeof I=="string"&&i.push(I)})});var o={},c=[],u=Re.read(t.numbers,{type:"base64"});u.FileIndex.map(function(W,I){return[W,u.FullPaths[I]]}).forEach(function(W){var I=W[0],B=W[1];if(I.type==2&&I.name.match(/\.iwa/)){var ee=I.content,le=vs(ee),fe=gs(le);fe.forEach(function(se){c.push(se.id),o[se.id]={deps:[],location:B,type:Ot(se.messages[0].meta[1][0].data)}})}}),c.sort(function(W,I){return W-I});var d=c.filter(function(W){return W>1}).map(function(W){return[W,st(W)]});u.FileIndex.map(function(W,I){return[W,u.FullPaths[I]]}).forEach(function(W){var I=W[0];if(W[1],!!I.name.match(/\.iwa/)){var B=gs(vs(I.content));B.forEach(function(ee){ee.messages.forEach(function(le){d.forEach(function(fe){ee.messages.some(function(se){return Ot(se.meta[1][0].data)!=11006&&I$(se.data,fe[1])})&&o[fe[0]].deps.push(ee.id)})})})}});for(var f=Re.find(u,o[1].location),h=gs(vs(f.content)),m,p=0;p<h.length;++p){var x=h[p];x.id==1&&(m=x)}var v=vr(tt(m.messages[0].data)[1][0].data);for(f=Re.find(u,o[v].location),h=gs(vs(f.content)),p=0;p<h.length;++p)x=h[p],x.id==v&&(m=x);for(v=vr(tt(m.messages[0].data)[2][0].data),f=Re.find(u,o[v].location),h=gs(vs(f.content)),p=0;p<h.length;++p)x=h[p],x.id==v&&(m=x);for(v=vr(tt(m.messages[0].data)[2][0].data),f=Re.find(u,o[v].location),h=gs(vs(f.content)),p=0;p<h.length;++p)x=h[p],x.id==v&&(m=x);var y=tt(m.messages[0].data);{y[6][0].data=st(s.e.r+1),y[7][0].data=st(s.e.c+1);var w=vr(y[46][0].data),g=Re.find(u,o[w].location),_=gs(vs(g.content));{for(var b=0;b<_.length&&_[b].id!=w;++b);if(_[b].id!=w)throw"Bad ColumnRowUIDMapArchive";var k=tt(_[b].messages[0].data);k[1]=[],k[2]=[],k[3]=[];for(var S=0;S<=s.e.c;++S){var T=[];T[1]=T[2]=[{type:0,data:st(S+420690)}],k[1].push({type:2,data:ir(T)}),k[2].push({type:0,data:st(S)}),k[3].push({type:0,data:st(S)})}k[4]=[],k[5]=[],k[6]=[];for(var j=0;j<=s.e.r;++j)T=[],T[1]=T[2]=[{type:0,data:st(j+726270)}],k[4].push({type:2,data:ir(T)}),k[5].push({type:0,data:st(j)}),k[6].push({type:0,data:st(j)});_[b].messages[0].data=ir(k)}g.content=_i(wi(_)),g.size=g.content.length,delete y[46];var U=tt(y[4][0].data);{U[7][0].data=st(s.e.r+1);var H=tt(U[1][0].data),z=vr(H[2][0].data);g=Re.find(u,o[z].location),_=gs(vs(g.content));{if(_[0].id!=z)throw"Bad HeaderStorageBucket";var q=tt(_[0].messages[0].data);for(j=0;j<a.length;++j){var re=tt(q[2][0].data);re[1][0].data=st(j),re[4][0].data=st(a[j].length),q[2][j]={type:q[2][0].type,data:ir(re)}}_[0].messages[0].data=ir(q)}g.content=_i(wi(_)),g.size=g.content.length;var X=vr(U[2][0].data);g=Re.find(u,o[X].location),_=gs(vs(g.content));{if(_[0].id!=X)throw"Bad HeaderStorageBucket";for(q=tt(_[0].messages[0].data),S=0;S<=s.e.c;++S)re=tt(q[2][0].data),re[1][0].data=st(S),re[4][0].data=st(s.e.r+1),q[2][S]={type:q[2][0].type,data:ir(re)};_[0].messages[0].data=ir(q)}g.content=_i(wi(_)),g.size=g.content.length;var M=vr(U[4][0].data);(function(){for(var W=Re.find(u,o[M].location),I=gs(vs(W.content)),B,ee=0;ee<I.length;++ee){var le=I[ee];le.id==M&&(B=le)}var fe=tt(B.messages[0].data);{fe[3]=[];var se=[];i.forEach(function(C,he){se[1]=[{type:0,data:st(he)}],se[2]=[{type:0,data:st(1)}],se[3]=[{type:2,data:O$(C)}],fe[3].push({type:2,data:ir(se)})})}B.messages[0].data=ir(fe);var ne=wi(I),V=_i(ne);W.content=V,W.size=W.content.length})();var J=tt(U[3][0].data);{var G=J[1][0];delete J[2];var D=tt(G.data);{var K=vr(D[2][0].data);(function(){for(var W=Re.find(u,o[K].location),I=gs(vs(W.content)),B,ee=0;ee<I.length;++ee){var le=I[ee];le.id==K&&(B=le)}var fe=tt(B.messages[0].data);{delete fe[6],delete J[7];var se=new Uint8Array(fe[5][0].data);fe[5]=[];for(var ne=0,V=0;V<=s.e.r;++V){var C=tt(se);ne+=K$(C,a[V],i),C[1][0].data=st(V),fe[5].push({data:ir(C),type:2})}fe[1]=[{type:0,data:st(s.e.c+1)}],fe[2]=[{type:0,data:st(s.e.r+1)}],fe[3]=[{type:0,data:st(ne)}],fe[4]=[{type:0,data:st(s.e.r+1)}]}B.messages[0].data=ir(fe);var he=wi(I),ve=_i(he);W.content=ve,W.size=W.content.length})()}G.data=ir(D)}U[3][0].data=ir(J)}y[4][0].data=ir(U)}m.messages[0].data=ir(y);var oe=wi(h),N=_i(oe);return f.content=N,f.size=f.content.length,u}function OT(e){return function(r){for(var s=0;s!=e.length;++s){var n=e[s];r[n[0]]===void 0&&(r[n[0]]=n[1]),n[2]==="n"&&(r[n[0]]=Number(r[n[0]]))}}}function tg(e){OT([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function rg(e){OT([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function Y$(e){return Ge.WS.indexOf(e)>-1?"sheet":e==Ge.CS?"chart":e==Ge.DS?"dialog":e==Ge.MS?"macro":e&&e.length?e:"sheet"}function J$(e,t){if(!e)return 0;try{e=t.map(function(s){return s.id||(s.id=s.strRelID),[s.name,e["!id"][s.id].Target,Y$(e["!id"][s.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function Q$(e,t,r,s,n,a,i,o,c,u,d,f){try{a[s]=_l(ns(e,r,!0),t);var h=zt(e,t),m;switch(o){case"sheet":m=wU(h,t,n,c,a[s],u,d,f);break;case"chart":if(m=_U(h,t,n,c,a[s],u,d,f),!m||!m["!drawel"])break;var p=tl(m["!drawel"].Target,t),x=oc(p),v=oM(ns(e,p,!0),_l(ns(e,x,!0),p)),y=tl(v,p),w=oc(y);m=KB(ns(e,y,!0),y,c,_l(ns(e,w,!0),y),u,m);break;case"macro":m=bU(h,t,n,c,a[s],u,d,f);break;case"dialog":m=SU(h,t,n,c,a[s],u,d,f);break;default:throw new Error("Unrecognized sheet type "+o)}i[s]=m;var g=[];a&&a[s]&&It(a[s]).forEach(function(_){var b="";if(a[s][_].Type==Ge.CMNT){b=tl(a[s][_].Target,t);var k=NU(zt(e,b,!0),b,c);if(!k||!k.length)return;nw(m,k,!1)}a[s][_].Type==Ge.TCMNT&&(b=tl(a[s][_].Target,t),g=g.concat(cM(zt(e,b,!0),c)))}),g&&g.length&&nw(m,g,!0,c.people||[])}catch(_){if(c.WTF)throw _}}function ms(e){return e.charAt(0)=="/"?e.slice(1):e}function Z$(e,t){if(Ao(),t=t||{},tg(t),ws(e,"META-INF/manifest.xml")||ws(e,"objectdata.xml"))return mw(e,t);if(ws(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Df<"u"){if(e.FileIndex)return Df(e);var r=Re.utils.cfb_new();return Ey(e).forEach(function(re){He(r,re,uO(e,re))}),Df(r)}throw new Error("Unsupported NUMBERS file")}if(!ws(e,"[Content_Types].xml"))throw ws(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):ws(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var s=Ey(e),n=s8(ns(e,"[Content_Types].xml")),a=!1,i,o;if(n.workbooks.length===0&&(o="xl/workbook.xml",zt(e,o,!0)&&n.workbooks.push(o)),n.workbooks.length===0){if(o="xl/workbook.bin",!zt(e,o,!0))throw new Error("Could not find workbook");n.workbooks.push(o),a=!0}n.workbooks[0].slice(-3)=="bin"&&(a=!0);var c={},u={};if(!t.bookSheets&&!t.bookProps){if(bl=[],n.sst)try{bl=TU(zt(e,ms(n.sst)),n.sst,t)}catch(re){if(t.WTF)throw re}t.cellStyles&&n.themes.length&&(c=EU(ns(e,n.themes[0].replace(/^\//,""),!0)||"",n.themes[0],t)),n.style&&(u=kU(zt(e,ms(n.style)),n.style,c,t))}n.links.map(function(re){try{var X=_l(ns(e,oc(ms(re))),re);return CU(zt(e,ms(re)),X,re,t)}catch{}});var d=yU(zt(e,ms(n.workbooks[0])),n.workbooks[0],t),f={},h="";n.coreprops.length&&(h=zt(e,ms(n.coreprops[0]),!0),h&&(f=bE(h)),n.extprops.length!==0&&(h=zt(e,ms(n.extprops[0]),!0),h&&u8(h,f,t)));var m={};(!t.bookSheets||t.bookProps)&&n.custprops.length!==0&&(h=ns(e,ms(n.custprops[0]),!0),h&&(m=f8(h,t)));var p={};if((t.bookSheets||t.bookProps)&&(d.Sheets?i=d.Sheets.map(function(X){return X.name}):f.Worksheets&&f.SheetNames.length>0&&(i=f.SheetNames),t.bookProps&&(p.Props=f,p.Custprops=m),t.bookSheets&&typeof i<"u"&&(p.SheetNames=i),t.bookSheets?p.SheetNames:t.bookProps))return p;i={};var x={};t.bookDeps&&n.calcchain&&(x=jU(zt(e,ms(n.calcchain)),n.calcchain));var v=0,y={},w,g;{var _=d.Sheets;f.Worksheets=_.length,f.SheetNames=[];for(var b=0;b!=_.length;++b)f.SheetNames[b]=_[b].name}var k=a?"bin":"xml",S=n.workbooks[0].lastIndexOf("/"),T=(n.workbooks[0].slice(0,S+1)+"_rels/"+n.workbooks[0].slice(S+1)+".rels").replace(/^\//,"");ws(e,T)||(T="xl/_rels/workbook."+k+".rels");var j=_l(ns(e,T,!0),T.replace(/_rels.*/,"s5s"));(n.metadata||[]).length>=1&&(t.xlmeta=AU(zt(e,ms(n.metadata[0])),n.metadata[0],t)),(n.people||[]).length>=1&&(t.people=dM(zt(e,ms(n.people[0])),t)),j&&(j=J$(j,d.Sheets));var U=zt(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(v=0;v!=f.Worksheets;++v){var H="sheet";if(j&&j[v]?(w="xl/"+j[v][1].replace(/[\/]?xl\//,""),ws(e,w)||(w=j[v][1]),ws(e,w)||(w=T.replace(/_rels\/.*$/,"")+j[v][1]),H=j[v][2]):(w="xl/worksheets/sheet"+(v+1-U)+"."+k,w=w.replace(/sheet0\./,"sheet.")),g=w.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(v!=t.sheets)continue e;break;case"string":if(f.SheetNames[v].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var z=!1,q=0;q!=t.sheets.length;++q)typeof t.sheets[q]=="number"&&t.sheets[q]==v&&(z=1),typeof t.sheets[q]=="string"&&t.sheets[q].toLowerCase()==f.SheetNames[v].toLowerCase()&&(z=1);if(!z)continue e}}Q$(e,w,g,f.SheetNames[v],v,y,i,H,t,d,c,u)}return p={Directory:n,Workbook:d,Props:f,Custprops:m,Deps:x,Sheets:i,SheetNames:f.SheetNames,Strings:bl,Styles:u,Themes:c,SSF:mt(De)},t&&t.bookFiles&&(e.files?(p.keys=s,p.files=e.files):(p.keys=[],p.files={},e.FullPaths.forEach(function(re,X){re=re.replace(/^Root Entry[\/]/,""),p.keys.push(re),p.files[re]=e.FileIndex[X]}))),t&&t.bookVBA&&(n.vba.length>0?p.vbaraw=zt(e,ms(n.vba[0]),!0):n.defaults&&n.defaults.bin===yM&&(p.vbaraw=zt(e,"xl/vbaProject.bin",!0))),p}function eV(e,t){var r=t||{},s="Workbook",n=Re.find(e,s);try{if(s="/!DataSpaces/Version",n=Re.find(e,s),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);if(AD(n.content),s="/!DataSpaces/DataSpaceMap",n=Re.find(e,s),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);var a=PD(n.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+s);if(s="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",n=Re.find(e,s),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);var i=RD(n.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+s);if(s="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",n=Re.find(e,s),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);ID(n.content)}catch{}if(s="/EncryptionInfo",n=Re.find(e,s),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);var o=DD(n.content);if(s="/EncryptedPackage",n=Re.find(e,s),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],n.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],n.content,r.password||"",r);throw new Error("File is password-protected")}function tV(e,t){return t.bookType=="ods"?RT(e,t):t.bookType=="numbers"?X$(e,t):t.bookType=="xlsb"?rV(e,t):sV(e,t)}function rV(e,t){Vi=1024,e&&!e.SSF&&(e.SSF=mt(De)),e&&e.SSF&&(Ao(),u0(e.SSF),t.revssf=f0(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Sl?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",s=oT.indexOf(t.bookType)>-1,n=$x();rg(t=t||{});var a=Nx(),i="",o=0;if(t.cellXfs=[],ya(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",He(a,i,SE(e.Props,t)),n.coreprops.push(i),nt(t.rels,2,i,Ge.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,He(a,i,TE(e.Props)),n.extprops.push(i),nt(t.rels,3,i,Ge.EXT_PROPS),e.Custprops!==e.Props&&It(e.Custprops||{}).length>0&&(i="docProps/custom.xml",He(a,i,NE(e.Custprops)),n.custprops.push(i),nt(t.rels,4,i,Ge.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var d={"!id":{}},f=e.Sheets[e.SheetNames[o-1]],h=(f||{})["!type"]||"sheet";switch(h){case"chart":default:i="xl/worksheets/sheet"+o+"."+r,He(a,i,PU(o-1,i,t,e,d)),n.sheets.push(i),nt(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Ge.WS[0])}if(f){var m=f["!comments"],p=!1,x="";m&&m.length>0&&(x="xl/comments"+o+"."+r,He(a,x,IU(m,x)),n.comments.push(x),nt(d,-1,"../comments"+o+"."+r,Ge.CMNT),p=!0),f["!legacy"]&&p&&He(a,"xl/drawings/vmlDrawing"+o+".vml",aT(o,f["!comments"])),delete f["!comments"],delete f["!legacy"]}d["!id"].rId1&&He(a,oc(i),Zi(d))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,He(a,i,OU(t.Strings,i,t)),n.strs.push(i),nt(t.wbrels,-1,"sharedStrings."+r,Ge.SST)),i="xl/workbook."+r,He(a,i,FU(e,i)),n.workbooks.push(i),nt(t.rels,1,i,Ge.WB),i="xl/theme/theme1.xml",He(a,i,Gx(e.Themes,t)),n.themes.push(i),nt(t.wbrels,-1,"theme/theme1.xml",Ge.THEME),i="xl/styles."+r,He(a,i,RU(e,i,t)),n.styles.push(i),nt(t.wbrels,-1,"styles."+r,Ge.STY),e.vbaraw&&s&&(i="xl/vbaProject.bin",He(a,i,e.vbaraw),n.vba.push(i),nt(t.wbrels,-1,"vbaProject.bin",Ge.VBA)),i="xl/metadata."+r,He(a,i,DU(i)),n.metadata.push(i),nt(t.wbrels,-1,"metadata."+r,Ge.XLMETA),He(a,"[Content_Types].xml",wE(n,t)),He(a,"_rels/.rels",Zi(t.rels)),He(a,"xl/_rels/workbook."+r+".rels",Zi(t.wbrels)),delete t.revssf,delete t.ssf,a}function sV(e,t){Vi=1024,e&&!e.SSF&&(e.SSF=mt(De)),e&&e.SSF&&(Ao(),u0(e.SSF),t.revssf=f0(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Sl?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",s=oT.indexOf(t.bookType)>-1,n=$x();rg(t=t||{});var a=Nx(),i="",o=0;if(t.cellXfs=[],ya(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",He(a,i,SE(e.Props,t)),n.coreprops.push(i),nt(t.rels,2,i,Ge.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,He(a,i,TE(e.Props)),n.extprops.push(i),nt(t.rels,3,i,Ge.EXT_PROPS),e.Custprops!==e.Props&&It(e.Custprops||{}).length>0&&(i="docProps/custom.xml",He(a,i,NE(e.Custprops)),n.custprops.push(i),nt(t.rels,4,i,Ge.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var f={"!id":{}},h=e.Sheets[e.SheetNames[o-1]],m=(h||{})["!type"]||"sheet";switch(m){case"chart":default:i="xl/worksheets/sheet"+o+"."+r,He(a,i,vT(o-1,t,e,f)),n.sheets.push(i),nt(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Ge.WS[0])}if(h){var p=h["!comments"],x=!1,v="";if(p&&p.length>0){var y=!1;p.forEach(function(w){w[1].forEach(function(g){g.T==!0&&(y=!0)})}),y&&(v="xl/threadedComments/threadedComment"+o+"."+r,He(a,v,uM(p,d,t)),n.threadedcomments.push(v),nt(f,-1,"../threadedComments/threadedComment"+o+"."+r,Ge.TCMNT)),v="xl/comments"+o+"."+r,He(a,v,iT(p)),n.comments.push(v),nt(f,-1,"../comments"+o+"."+r,Ge.CMNT),x=!0}h["!legacy"]&&x&&He(a,"xl/drawings/vmlDrawing"+o+".vml",aT(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}f["!id"].rId1&&He(a,oc(i),Zi(f))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,He(a,i,GE(t.Strings,t)),n.strs.push(i),nt(t.wbrels,-1,"sharedStrings."+r,Ge.SST)),i="xl/workbook."+r,He(a,i,ST(e)),n.workbooks.push(i),nt(t.rels,1,i,Ge.WB),i="xl/theme/theme1.xml",He(a,i,Gx(e.Themes,t)),n.themes.push(i),nt(t.wbrels,-1,"theme/theme1.xml",Ge.THEME),i="xl/styles."+r,He(a,i,tT(e,t)),n.styles.push(i),nt(t.wbrels,-1,"styles."+r,Ge.STY),e.vbaraw&&s&&(i="xl/vbaProject.bin",He(a,i,e.vbaraw),n.vba.push(i),nt(t.wbrels,-1,"vbaProject.bin",Ge.VBA)),i="xl/metadata."+r,He(a,i,nT()),n.metadata.push(i),nt(t.wbrels,-1,"metadata."+r,Ge.XLMETA),d.length>1&&(i="xl/persons/person.xml",He(a,i,fM(d)),n.people.push(i),nt(t.wbrels,-1,"persons/person.xml",Ge.PEOPLE)),He(a,"[Content_Types].xml",wE(n,t)),He(a,"_rels/.rels",Zi(t.rels)),He(a,"xl/_rels/workbook."+r+".rels",Zi(t.wbrels)),delete t.revssf,delete t.ssf,a}function sg(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=cs(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function nV(e,t){return Re.find(e,"EncryptedPackage")?eV(e,t):NT(e,t)}function aV(e,t){var r,s=e,n=t||{};return n.type||(n.type=qe&&Buffer.isBuffer(e)?"buffer":"base64"),r=Xk(s,n),Z$(r,n)}function IT(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Sp(e.slice(r),t);default:break e}return go.to_workbook(e,t)}function iV(e,t){var r="",s=sg(e,t);switch(t.type){case"base64":r=cs(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Za(e);break;default:throw new Error("Unrecognized type "+t.type)}return s[0]==239&&s[1]==187&&s[2]==191&&(r=ot(r)),t.type="binary",IT(r,t)}function oV(e,t){var r=e;return t.type=="base64"&&(r=cs(r)),r=tc.utils.decode(1200,r.slice(2),"str"),t.type="binary",IT(r,t)}function lV(e){return e.match(/[^\x00-\x7F]/)?sn(e):e}function Lf(e,t,r,s){return s?(r.type="string",go.to_workbook(e,r)):go.to_workbook(t,r)}function Tp(e,t){bx();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Tp(new Uint8Array(e),(r=mt(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var s=e,n=[0,0,0,0],a=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),to={},r.dateNF&&(to.dateNF=r.dateNF),r.type||(r.type=qe&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=qe?"buffer":"binary",s=rO(e),typeof Uint8Array<"u"&&!qe&&(r.type="array")),r.type=="string"&&(a=!0,r.type="binary",r.codepage=65001,s=lV(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),o=new Uint8Array(i);if(o.foo="bar",!o.foo)return r=mt(r),r.type="array",Tp(Sx(s),r)}switch((n=sg(s,r))[0]){case 208:if(n[1]===207&&n[2]===17&&n[3]===224&&n[4]===161&&n[5]===177&&n[6]===26&&n[7]===225)return nV(Re.read(s,r),r);break;case 9:if(n[1]<=8)return NT(s,r);break;case 60:return Sp(s,r);case 73:if(n[1]===73&&n[2]===42&&n[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(n[1]===68)return hD(s,r);break;case 84:if(n[1]===65&&n[2]===66&&n[3]===76)return HE.to_workbook(s,r);break;case 80:return n[1]===75&&n[2]<9&&n[3]<9?aV(s,r):Lf(e,s,r,a);case 239:return n[3]===60?Sp(s,r):Lf(e,s,r,a);case 255:if(n[1]===254)return oV(s,r);if(n[1]===0&&n[2]===2&&n[3]===0)return Ha.to_workbook(s,r);break;case 0:if(n[1]===0&&(n[2]>=2&&n[3]===0||n[2]===0&&(n[3]===8||n[3]===9)))return Ha.to_workbook(s,r);break;case 3:case 131:case 139:case 140:return bp.to_workbook(s,r);case 123:if(n[1]===92&&n[2]===114&&n[3]===116)return QE.to_workbook(s,r);break;case 10:case 13:case 32:return iV(s,r);case 137:if(n[1]===80&&n[2]===78&&n[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return fD.indexOf(n[0])>-1&&n[2]<=12&&n[3]<=31?bp.to_workbook(s,r):Lf(e,s,r,a)}function DT(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Tc(t.file,Re.write(e,{type:qe?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Re.write(e,t)}function cV(e,t){var r=mt(t||{}),s=tV(e,r);return uV(s,r)}function uV(e,t){var r={},s=qe?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=s;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=s;break;default:throw new Error("Unrecognized type "+t.type)}var n=e.FullPaths?Re.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof n=="string"){if(t.type=="binary"||t.type=="base64")return n;n=new Uint8Array(c0(n))}return t.password&&typeof encrypt_agile<"u"?DT(encrypt_agile(n,t.password),t):t.type==="file"?Tc(t.file,n):t.type=="string"?ot(n):n}function dV(e,t){var r=t||{},s=l$(e,r);return DT(s,r)}function en(e,t,r){r||(r="");var s=r+e;switch(t.type){case"base64":return rc(sn(s));case"binary":return sn(s);case"string":return e;case"file":return Tc(t.file,s,"utf8");case"buffer":return qe?On(s,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(s):en(s,{type:"binary"}).split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function fV(e,t){switch(t.type){case"base64":return rc(e);case"binary":return e;case"string":return e;case"file":return Tc(t.file,e,"binary");case"buffer":return qe?On(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function ku(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",s=0;s<e.length;++s)r+=String.fromCharCode(e[s]);return t.type=="base64"?rc(r):t.type=="string"?ot(r):r;case"file":return Tc(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function LT(e,t){bx(),nU(e);var r=mt(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var s=LT(e,r);return r.type="array",c0(s)}var n=0;if(r.sheet&&(typeof r.sheet=="number"?n=r.sheet:n=e.SheetNames.indexOf(r.sheet),!e.SheetNames[n]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return en(t$(e,r),r);case"slk":case"sylk":return en(WE.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"htm":case"html":return en(CT(e.Sheets[e.SheetNames[n]],r),r);case"txt":return fV(MT(e.Sheets[e.SheetNames[n]],r),r);case"csv":return en(ag(e.Sheets[e.SheetNames[n]],r),r,"\uFEFF");case"dif":return en(HE.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"dbf":return ku(bp.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"prn":return en(go.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"rtf":return en(QE.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"eth":return en(qE.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"fods":return en(RT(e,r),r);case"wk1":return ku(Ha.sheet_to_wk1(e.Sheets[e.SheetNames[n]],r),r);case"wk3":return ku(Ha.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),ku(jT(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),dV(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return cV(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function hV(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function ng(e,t,r){var s={};return s.type="file",s.file=t,hV(s),LT(e,s)}function pV(e,t,r,s,n,a,i,o){var c=Bt(r),u=o.defval,d=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),f=!0,h=n===1?[]:{};if(n!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!i||e[r])for(var m=t.s.c;m<=t.e.c;++m){var p=i?e[r][m]:e[s[m]+c];if(p===void 0||p.t===void 0){if(u===void 0)continue;a[m]!=null&&(h[a[m]]=u);continue}var x=p.v;switch(p.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+p.t)}if(a[m]!=null){if(x==null)if(p.t=="e"&&x===null)h[a[m]]=null;else if(u!==void 0)h[a[m]]=u;else if(d&&x===null)h[a[m]]=null;else continue;else h[a[m]]=d&&(p.t!=="n"||p.t==="n"&&o.rawNumbers!==!1)?x:Pn(p,x,o);x!=null&&(f=!1)}}return{row:h,isempty:f}}function Ld(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},s=0,n=1,a=[],i=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},d=u.range!=null?u.range:e["!ref"];switch(u.header===1?s=1:u.header==="A"?s=2:Array.isArray(u.header)?s=3:u.header==null&&(s=0),typeof d){case"string":c=et(d);break;case"number":c=et(e["!ref"]),c.s.r=d;break;default:c=d}s>0&&(n=0);var f=Bt(c.s.r),h=[],m=[],p=0,x=0,v=Array.isArray(e),y=c.s.r,w=0,g={};v&&!e[y]&&(e[y]=[]);var _=u.skipHidden&&e["!cols"]||[],b=u.skipHidden&&e["!rows"]||[];for(w=c.s.c;w<=c.e.c;++w)if(!(_[w]||{}).hidden)switch(h[w]=Nt(w),r=v?e[y][w]:e[h[w]+f],s){case 1:a[w]=w-c.s.c;break;case 2:a[w]=h[w];break;case 3:a[w]=u.header[w-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=i=Pn(r,null,u),x=g[i]||0,!x)g[i]=1;else{do o=i+"_"+x++;while(g[o]);g[i]=x,g[o]=1}a[w]=o}for(y=c.s.r+n;y<=c.e.r;++y)if(!(b[y]||{}).hidden){var k=pV(e,c,y,h,s,a,v,u);(k.isempty===!1||(s===1?u.blankrows!==!1:u.blankrows))&&(m[p++]=k.row)}return m.length=p,m}var ww=/"/g;function mV(e,t,r,s,n,a,i,o){for(var c=!0,u=[],d="",f=Bt(r),h=t.s.c;h<=t.e.c;++h)if(s[h]){var m=o.dense?(e[r]||[])[h]:e[s[h]+f];if(m==null)d="";else if(m.v!=null){c=!1,d=""+(o.rawNumbers&&m.t=="n"?m.v:Pn(m,null,o));for(var p=0,x=0;p!==d.length;++p)if((x=d.charCodeAt(p))===n||x===a||x===34||o.forceQuotes){d='"'+d.replace(ww,'""')+'"';break}d=="ID"&&(d='"ID"')}else m.f!=null&&!m.F?(c=!1,d="="+m.f,d.indexOf(",")>=0&&(d='"'+d.replace(ww,'""')+'"')):d="";u.push(d)}return o.blankrows===!1&&c?null:u.join(i)}function ag(e,t){var r=[],s=t??{};if(e==null||e["!ref"]==null)return"";var n=et(e["!ref"]),a=s.FS!==void 0?s.FS:",",i=a.charCodeAt(0),o=s.RS!==void 0?s.RS:`
`,c=o.charCodeAt(0),u=new RegExp((a=="|"?"\\|":a)+"+$"),d="",f=[];s.dense=Array.isArray(e);for(var h=s.skipHidden&&e["!cols"]||[],m=s.skipHidden&&e["!rows"]||[],p=n.s.c;p<=n.e.c;++p)(h[p]||{}).hidden||(f[p]=Nt(p));for(var x=0,v=n.s.r;v<=n.e.r;++v)(m[v]||{}).hidden||(d=mV(e,n,v,f,i,c,a,s),d!=null&&(s.strip&&(d=d.replace(u,"")),(d||s.blankrows!==!1)&&r.push((x++?o:"")+d)));return delete s.dense,r.join("")}function MT(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=ag(e,t);return r}function xV(e){var t="",r,s="";if(e==null||e["!ref"]==null)return[];var n=et(e["!ref"]),a="",i=[],o,c=[],u=Array.isArray(e);for(o=n.s.c;o<=n.e.c;++o)i[o]=Nt(o);for(var d=n.s.r;d<=n.e.r;++d)for(a=Bt(d),o=n.s.c;o<=n.e.c;++o)if(t=i[o]+a,r=u?(e[d]||[])[o]:e[t],s="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;s=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)s=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)s=""+r.v;else if(r.t=="b")s=r.v?"TRUE":"FALSE";else if(r.w!==void 0)s="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?s="'"+r.v:s=""+r.v}}c[c.length]=t+"="+s}return c}function BT(e,t,r){var s=r||{},n=+!s.skipHeader,a=e||{},i=0,o=0;if(a&&s.origin!=null)if(typeof s.origin=="number")i=s.origin;else{var c=typeof s.origin=="string"?jt(s.origin):s.origin;i=c.r,o=c.c}var u,d={s:{c:0,r:0},e:{c:o,r:i+t.length-1+n}};if(a["!ref"]){var f=et(a["!ref"]);d.e.c=Math.max(d.e.c,f.e.c),d.e.r=Math.max(d.e.r,f.e.r),i==-1&&(i=f.e.r+1,d.e.r=i+t.length-1+n)}else i==-1&&(i=0,d.e.r=t.length-1+n);var h=s.header||[],m=0;t.forEach(function(x,v){It(x).forEach(function(y){(m=h.indexOf(y))==-1&&(h[m=h.length]=y);var w=x[y],g="z",_="",b=Le({c:o+m,r:i+v+n});u=pc(a,b),w&&typeof w=="object"&&!(w instanceof Date)?a[b]=w:(typeof w=="number"?g="n":typeof w=="boolean"?g="b":typeof w=="string"?g="s":w instanceof Date?(g="d",s.cellDates||(g="n",w=Zt(w)),_=s.dateNF||De[14]):w===null&&s.nullError&&(g="e",w=0),u?(u.t=g,u.v=w,delete u.w,delete u.R,_&&(u.z=_)):a[b]=u={t:g,v:w},_&&(u.z=_))})}),d.e.c=Math.max(d.e.c,o+h.length-1);var p=Bt(i);if(n)for(m=0;m<h.length;++m)a[Nt(m+o)+p]={t:"s",v:h[m]};return a["!ref"]=ze(d),a}function gV(e,t){return BT(null,e,t)}function pc(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var s=jt(t);return e[s.r]||(e[s.r]=[]),e[s.r][s.c]||(e[s.r][s.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?pc(e,Le(t)):pc(e,Le({r:t,c:r||0}))}function vV(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function ig(){return{SheetNames:[],Sheets:{}}}function og(e,t,r,s){var n=1;if(!r)for(;n<=65535&&e.SheetNames.indexOf(r="Sheet"+n)!=-1;++n,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(s&&e.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);n=a&&+a[2]||0;var i=a&&a[1]||r;for(++n;n<=65535&&e.SheetNames.indexOf(r=i+n)!=-1;++n);}if(bT(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function yV(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var s=vV(e,t);switch(e.Workbook.Sheets[s]||(e.Workbook.Sheets[s]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[s].Hidden=r}function wV(e,t){return e.z=t,e}function UT(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function _V(e,t,r){return UT(e,"#"+t,r)}function bV(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function SV(e,t,r,s){for(var n=typeof t!="string"?t:et(t),a=typeof t=="string"?t:ze(t),i=n.s.r;i<=n.e.r;++i)for(var o=n.s.c;o<=n.e.c;++o){var c=pc(e,i,o);c.t="n",c.F=a,delete c.v,i==n.s.r&&o==n.s.c&&(c.f=r,s&&(c.D=!0))}return e}var dt={encode_col:Nt,encode_row:Bt,encode_cell:Le,encode_range:ze,decode_col:Ix,decode_row:Ox,split_cell:OO,decode_cell:jt,decode_range:Xr,format_cell:Pn,sheet_add_aoa:hE,sheet_add_json:BT,sheet_add_dom:AT,aoa_to_sheet:Fo,json_to_sheet:gV,table_to_sheet:FT,table_to_book:A$,sheet_to_csv:ag,sheet_to_txt:MT,sheet_to_json:Ld,sheet_to_html:CT,sheet_to_formulae:xV,sheet_to_row_object_array:Ld,sheet_get_cell:pc,book_new:ig,book_append_sheet:og,book_set_sheet_visibility:yV,cell_set_number_format:wV,cell_set_hyperlink:UT,cell_set_internal_link:_V,cell_add_comment:bV,sheet_set_array_formula:SV,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};async function kV(e,t){let r=pe.from("quotes").select("*").eq("project_id",e);const{data:s,error:n}=await r;if(n)throw new Error(`Failed to fetch quotes: ${n.message}`);if(!s||s.length===0)return EV(e,t);const a=s,i=a.map(g=>g.id),{data:o,error:c}=await pe.from("quote_items").select("*").in("quote_id",i).eq("is_excluded",!1);if(c)throw new Error(`Failed to fetch quote items: ${c.message}`);const u=o||[],d=a.map(g=>({quoteId:g.id,supplierName:g.supplier_name})),f=TV(a,u),h=NV(a,u),m=jV(a,u),p=CV(a,u),x=AV(a,u),v=FV(u),y=PV(a),w=RV(a,u);return{projectId:e,quoteIds:t,quotesAnalyzed:a.length,analyzedAt:new Date().toISOString(),summary:{totalRedFlags:f.length,criticalIssues:f.filter(g=>g.severity==="critical").length,coverageScore:x,averageQualityScore:v,bestValueSupplier:y,mostCompleteSupplier:w},redFlags:f,coverageGaps:h,systemsDetected:m,supplierInsights:p,normalizedItems:d}}function EV(e,t){return{projectId:e,quoteIds:t,quotesAnalyzed:0,analyzedAt:new Date().toISOString(),summary:{totalRedFlags:0,criticalIssues:0,coverageScore:0,averageQualityScore:0,bestValueSupplier:"N/A",mostCompleteSupplier:"N/A"},redFlags:[],coverageGaps:[],systemsDetected:[],supplierInsights:[],normalizedItems:[]}}function TV(e,t){const r=[];for(const s of e){const n=t.filter(f=>f.quote_id===s.id),a=n.reduce((f,h)=>f+(h.total_price||0),0),i=s.quoted_total||s.total_amount||0,o=Math.abs(a-i),c=i>0?o/i*100:0;c>10&&r.push({id:`price-discrepancy-${s.id}`,quoteId:s.id,severity:c>20?"critical":"high",category:"Pricing",title:"Significant Price Discrepancy",description:`Quote total ($${i.toLocaleString()}) differs from line items sum ($${a.toLocaleString()}) by ${c.toFixed(1)}%`,recommendation:"Verify quoted total matches line items. Check for missing items or calculation errors."}),n.length===0&&r.push({id:`no-items-${s.id}`,quoteId:s.id,severity:"critical",category:"Completeness",title:"No Line Items",description:"Quote contains no line items",recommendation:"Ensure quote has been properly imported with all line items."});const u=n.filter(f=>!f.unit_price||f.unit_price===0);u.length>0&&r.push({id:`missing-prices-${s.id}`,quoteId:s.id,severity:u.length>n.length*.1?"high":"medium",category:"Pricing",title:"Items Missing Unit Prices",description:`${u.length} items have no unit price specified`,recommendation:"Request unit prices for all items to enable accurate comparison."});const d=n.filter(f=>f.confidence!==null&&f.confidence<.7);d.length>n.length*.2&&r.push({id:`low-confidence-${s.id}`,quoteId:s.id,severity:"medium",category:"Data Quality",title:"Poor Data Normalization Quality",description:`${Math.round(d.length/n.length*100)}% of items have low confidence scores`,recommendation:"Review and manually correct items with low confidence scores for better comparison accuracy."}),(!s.contingency_amount||s.contingency_amount===0)&&r.push({id:`no-contingency-${s.id}`,quoteId:s.id,severity:"low",category:"Commercial",title:"No Contingency Specified",description:"Quote does not include a contingency amount",recommendation:"Confirm if contingency is included in pricing or needs to be added separately."})}return r}function NV(e,t){const r=[];if(e.length<2)return r;const s=new Map;for(const n of t){const a=n.scope_category||"Uncategorized";s.has(a)||s.set(a,new Map);const i=s.get(a);i.has(n.quote_id)||i.set(n.quote_id,new Set),i.get(n.quote_id).add(n.description.toLowerCase().trim())}for(const[n,a]of s){const i=Array.from(a.keys());if(i.length<e.length){const o=e.filter(c=>!i.includes(c.id));r.push({id:`missing-category-${n}`,gapType:"Missing Category",title:`Category "${n}" not quoted by all suppliers`,description:`${o.length} supplier(s) did not quote this category`,missingIn:o.map(c=>c.supplier_name),presentIn:e.filter(c=>i.includes(c.id)).map(c=>c.supplier_name),estimatedImpact:0,recommendation:"Request quotes for this category from suppliers who did not include it."})}}return r}function jV(e,t){const r=[],s=new Map;for(const n of t)if(n.system_label&&n.system_id){const a=`${n.quote_id}-${n.system_id}`;s.has(a)||s.set(a,{quoteId:n.quote_id,items:[]}),s.get(a).items.push(n)}for(const[n,{quoteId:a,items:i}]of s){const o=i.reduce((u,d)=>u+(d.total_price||0),0),c=i.reduce((u,d)=>u+(d.confidence||0),0)/i.length;r.push({id:n,quoteId:a,systemName:i[0].system_label,systemType:i[0].system_id.split("-")[0]||"Unknown",itemCount:i.length,totalValue:o,confidence:c})}return r.sort((n,a)=>a.totalValue-n.totalValue)}function CV(e,t){const r=[];for(const s of e){const n=t.filter(c=>c.quote_id===s.id);if(n.length===0)continue;n.reduce((c,u)=>c+(u.unit_price||0),0)/n.length,n.filter(c=>c.unit_price>0).length/n.length*100===100&&r.push({id:`complete-${s.id}`,supplierName:s.supplier_name,insightType:"Positive",title:"Complete Pricing",description:"All items have unit prices specified, enabling full comparison.",recommendation:"This supplier has provided comprehensive pricing information."});const i=new Set(n.map(c=>c.scope_category)).size;i>5&&r.push({id:`comprehensive-${s.id}`,supplierName:s.supplier_name,insightType:"Positive",title:"Comprehensive Quote",description:`Quote covers ${i} different scope categories.`,recommendation:"This supplier has provided broad coverage across multiple work areas."});const o=new Set(n.filter(c=>c.system_id).map(c=>c.system_id)).size;o>3&&r.push({id:`systems-${s.id}`,supplierName:s.supplier_name,insightType:"Positive",title:"Multiple Systems Identified",description:`${o} fire protection systems detected in quote.`,recommendation:"Items have been successfully mapped to fire protection systems."})}return r}function AV(e,t){if(e.length===0)return 0;const r=new Set(t.map(n=>n.scope_category||"Uncategorized"));let s=0;for(const n of e){const a=t.filter(c=>c.quote_id===n.id),o=new Set(a.map(c=>c.scope_category||"Uncategorized")).size/r.size*100;s+=o}return Math.round(s/e.length)}function FV(e){if(e.length===0)return 0;const t=e.filter(o=>o.unit_price>0).length,r=e.filter(o=>o.system_id).length,s=e.reduce((o,c)=>o+(c.confidence||0),0)/e.length,n=t/e.length*40,a=r/e.length*30,i=s*30;return Math.round(n+a+i)}function PV(e){return e.length===0?"N/A":e.reduce((r,s)=>s.total_amount<r.total_amount?s:r).supplier_name}function RV(e,t){if(e.length===0)return"N/A";let r=e[0],s=0;for(const n of e){const a=t.filter(o=>o.quote_id===n.id),i=a.length+a.filter(o=>o.unit_price>0).length*2+a.filter(o=>o.system_id).length;i>s&&(s=i,r=n)}return r.supplier_name}async function OV(e,t){return kV(e,t)}function IV({projectId:e,projectName:t}){const[r,s]=F.useState(null),[n,a]=F.useState(!0),[i,o]=F.useState(null);F.useEffect(()=>{c()},[e]);const c=async()=>{a(!0),o(null);try{const m=await OV(e);s(m)}catch(m){o(m instanceof Error?m.message:"Failed to analyze quotes"),console.error("Quote intelligence error:",m)}finally{a(!1)}},u=()=>{window.print()},d=()=>{window.print()},f=()=>{if(!r)return;const m=dt.book_new(),p=[["Quote Intelligence Report"],["Project:",t||"Unknown"],["Generated:",new Date(r.analyzedAt).toLocaleString()],[],["Summary"],["Quotes Analyzed:",r.quotesAnalyzed],["Total Red Flags:",r.summary.totalRedFlags],["Critical Issues:",r.summary.criticalIssues],["Coverage Score:",`${r.summary.coverageScore}%`],["Average Quality Score:",`${r.summary.averageQualityScore}%`],["Best Value Supplier:",r.summary.bestValueSupplier],["Most Complete Supplier:",r.summary.mostCompleteSupplier]],x=dt.aoa_to_sheet(p);dt.book_append_sheet(m,x,"Summary");const v=[["Severity","Category","Title","Description","Supplier","Recommendation"],...r.redFlags.map(j=>{const U=r.normalizedItems.find(H=>H.quoteId===j.quoteId);return[j.severity,j.category,j.title,j.description,(U==null?void 0:U.supplierName)||"Unknown",j.recommendation]})],y=dt.aoa_to_sheet(v);dt.book_append_sheet(m,y,"Red Flags");const w=[["Type","Title","Description","Missing In","Present In","Impact","Recommendation"],...r.coverageGaps.map(j=>[j.gapType,j.title,j.description,j.missingIn.join(", "),j.presentIn.join(", "),`$${j.estimatedImpact.toLocaleString()}`,j.recommendation])],g=dt.aoa_to_sheet(w);dt.book_append_sheet(m,g,"Coverage Gaps");const _=[["System Name","System Type","Supplier","Item Count","Total Value","Confidence"],...r.systemsDetected.map(j=>{const U=r.normalizedItems.find(H=>H.quoteId===j.quoteId);return[j.systemName,j.systemType,(U==null?void 0:U.supplierName)||"Unknown",j.itemCount,`$${j.totalValue.toLocaleString()}`,`${(j.confidence*100).toFixed(1)}%`]})],b=dt.aoa_to_sheet(_);dt.book_append_sheet(m,b,"Systems Detected");const k=[["Supplier","Type","Title","Description","Recommendation"],...r.supplierInsights.map(j=>[j.supplierName,j.insightType,j.title,j.description,j.recommendation])],S=dt.aoa_to_sheet(k);dt.book_append_sheet(m,S,"Supplier Insights");const T=`${t}_QuoteIntelligence.xlsx`;ng(m,T)},h=m=>{switch(m){case"critical":return"bg-red-100 text-red-800 border-red-300";case"high":return"bg-orange-100 text-orange-800 border-orange-300";case"medium":return"bg-yellow-100 text-yellow-800 border-yellow-300";case"low":return"bg-blue-100 text-blue-800 border-blue-300";default:return"bg-gray-100 text-gray-800 border-gray-300"}};return n?l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsxs("div",{className:"text-center",children:[l.jsx(wn,{className:"animate-spin mx-auto mb-4 text-blue-600",size:40}),l.jsx("p",{className:"text-lg font-medium text-gray-900",children:"Analyzing Quotes..."})]})}):i||!r?l.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:l.jsxs("div",{className:"flex items-start gap-3",children:[l.jsx(Yi,{className:"text-red-600 flex-shrink-0",size:24}),l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold text-red-900 mb-1",children:"Analysis Error"}),l.jsx("p",{className:"text-sm text-red-800",children:i||"No analysis data available"}),l.jsx("button",{onClick:c,className:"mt-3 px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 text-sm",children:"Retry Analysis"})]})]})}):l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 print:shadow-none",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6 print:mb-4",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Quote Intelligence Report"}),l.jsx("p",{className:"text-sm text-gray-600 mt-1",children:t||"Project Analysis"}),l.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Generated: ",new Date(r.analyzedAt).toLocaleString()]})]}),l.jsxs("div",{className:"flex gap-2 print:hidden",children:[l.jsxs("button",{onClick:f,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[l.jsx(po,{size:18}),"Excel"]}),l.jsxs("button",{onClick:d,className:"flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:[l.jsx(pF,{size:18}),"PDF"]}),l.jsxs("button",{onClick:u,className:"flex items-center gap-2 px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:[l.jsx(ix,{size:18}),"Print"]})]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8",children:[l.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 border border-blue-200",children:[l.jsx("div",{className:"text-sm text-blue-700 font-medium mb-1",children:"Quotes Analyzed"}),l.jsx("div",{className:"text-3xl font-bold text-blue-900",children:r.quotesAnalyzed})]}),l.jsxs("div",{className:"bg-red-50 rounded-lg p-4 border border-red-200",children:[l.jsx("div",{className:"text-sm text-red-700 font-medium mb-1",children:"Red Flags"}),l.jsx("div",{className:"text-3xl font-bold text-red-900",children:r.summary.totalRedFlags}),l.jsxs("div",{className:"text-xs text-red-600 mt-1",children:[r.summary.criticalIssues," critical"]})]}),l.jsxs("div",{className:"bg-green-50 rounded-lg p-4 border border-green-200",children:[l.jsx("div",{className:"text-sm text-green-700 font-medium mb-1",children:"Coverage Score"}),l.jsxs("div",{className:"text-3xl font-bold text-green-900",children:[r.summary.coverageScore,"%"]})]}),l.jsxs("div",{className:"bg-purple-50 rounded-lg p-4 border border-purple-200",children:[l.jsx("div",{className:"text-sm text-purple-700 font-medium mb-1",children:"Quality Score"}),l.jsxs("div",{className:"text-3xl font-bold text-purple-900",children:[Math.round(r.summary.averageQualityScore),"%"]})]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-8",children:[l.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 rounded-lg p-4 border border-blue-200",children:[l.jsx("div",{className:"text-sm text-blue-700 font-semibold mb-2",children:"Best Value Supplier"}),l.jsx("div",{className:"text-xl font-bold text-blue-900",children:r.summary.bestValueSupplier})]}),l.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 rounded-lg p-4 border border-green-200",children:[l.jsx("div",{className:"text-sm text-green-700 font-semibold mb-2",children:"Most Complete Supplier"}),l.jsx("div",{className:"text-xl font-bold text-green-900",children:r.summary.mostCompleteSupplier})]})]})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 print:shadow-none print:break-after-page",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[l.jsx(Yi,{className:"text-red-600",size:24}),l.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Red Flags"})]}),r.redFlags.length===0?l.jsx("p",{className:"text-gray-600 py-4",children:"No red flags detected."}):l.jsx("div",{className:"space-y-3",children:r.redFlags.map(m=>{const p=r.normalizedItems.find(x=>x.quoteId===m.quoteId);return l.jsxs("div",{className:`border rounded-lg p-4 ${h(m.severity)}`,children:[l.jsx("div",{className:"flex items-start justify-between mb-2",children:l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[l.jsx("span",{className:"text-xs font-bold uppercase px-2 py-1 bg-white rounded",children:m.severity}),l.jsx("span",{className:"text-sm font-medium",children:m.category})]}),l.jsx("h3",{className:"font-semibold text-lg",children:m.title}),l.jsx("p",{className:"text-sm mt-1",children:(p==null?void 0:p.supplierName)||"Unknown Supplier"})]})}),l.jsx("p",{className:"text-sm mb-2",children:m.description}),m.recommendation&&l.jsxs("div",{className:"mt-2 pt-2 border-t border-current border-opacity-20",children:[l.jsx("p",{className:"text-sm font-medium",children:"Recommendation:"}),l.jsx("p",{className:"text-sm",children:m.recommendation})]})]},m.id)})})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 print:shadow-none print:break-after-page",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[l.jsx(ES,{className:"text-orange-600",size:24}),l.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Coverage Gaps"})]}),r.coverageGaps.length===0?l.jsx("p",{className:"text-gray-600 py-4",children:"No coverage gaps identified."}):l.jsx("div",{className:"space-y-3",children:r.coverageGaps.map(m=>l.jsxs("div",{className:"border border-orange-200 rounded-lg p-4 bg-orange-50",children:[l.jsx("h3",{className:"font-semibold text-lg text-orange-900 mb-2",children:m.title}),l.jsx("p",{className:"text-sm text-orange-800 mb-3",children:m.description}),l.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-3 text-sm",children:[l.jsxs("div",{children:[l.jsx("p",{className:"font-medium text-orange-900",children:"Missing in:"}),l.jsx("p",{className:"text-orange-700",children:m.missingIn.join(", ")})]}),l.jsxs("div",{children:[l.jsx("p",{className:"font-medium text-orange-900",children:"Present in:"}),l.jsx("p",{className:"text-orange-700",children:m.presentIn.join(", ")})]})]}),m.estimatedImpact>0&&l.jsxs("p",{className:"text-sm font-semibold text-orange-900 mb-2",children:["Estimated Impact: $",m.estimatedImpact.toLocaleString()]}),m.recommendation&&l.jsxs("div",{className:"mt-2 pt-2 border-t border-orange-300",children:[l.jsx("p",{className:"text-sm font-medium text-orange-900",children:"Recommendation:"}),l.jsx("p",{className:"text-sm text-orange-800",children:m.recommendation})]})]},m.id))})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 print:shadow-none print:break-after-page",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[l.jsx(a0,{className:"text-blue-600",size:24}),l.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Systems Detected"})]}),r.systemsDetected.length===0?l.jsx("p",{className:"text-gray-600 py-4",children:"No systems detected."}):l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full text-sm",children:[l.jsx("thead",{children:l.jsxs("tr",{className:"border-b border-gray-200",children:[l.jsx("th",{className:"text-left py-2 font-semibold",children:"System"}),l.jsx("th",{className:"text-left py-2 font-semibold",children:"Type"}),l.jsx("th",{className:"text-left py-2 font-semibold",children:"Supplier"}),l.jsx("th",{className:"text-right py-2 font-semibold",children:"Items"}),l.jsx("th",{className:"text-right py-2 font-semibold",children:"Total Value"}),l.jsx("th",{className:"text-right py-2 font-semibold",children:"Confidence"})]})}),l.jsx("tbody",{children:r.systemsDetected.map(m=>{const p=r.normalizedItems.find(x=>x.quoteId===m.quoteId);return l.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[l.jsx("td",{className:"py-2",children:m.systemName}),l.jsx("td",{className:"py-2 text-gray-600",children:m.systemType}),l.jsx("td",{className:"py-2 text-gray-600",children:(p==null?void 0:p.supplierName)||"Unknown"}),l.jsx("td",{className:"py-2 text-right",children:m.itemCount}),l.jsxs("td",{className:"py-2 text-right font-medium",children:["$",m.totalValue.toLocaleString()]}),l.jsx("td",{className:"py-2 text-right",children:l.jsxs("span",{className:`px-2 py-1 rounded text-xs font-medium ${m.confidence>.8?"bg-green-100 text-green-800":m.confidence>.6?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:[(m.confidence*100).toFixed(0),"%"]})})]},m.id)})})]})})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 print:shadow-none",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[l.jsx(ox,{className:"text-purple-600",size:24}),l.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Supplier Insights"})]}),r.supplierInsights.length===0?l.jsx("p",{className:"text-gray-600 py-4",children:"No supplier insights available."}):l.jsx("div",{className:"space-y-3",children:r.supplierInsights.map(m=>l.jsxs("div",{className:"border border-purple-200 rounded-lg p-4 bg-purple-50",children:[l.jsx("div",{className:"flex items-start justify-between mb-2",children:l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold text-lg text-purple-900",children:m.supplierName}),l.jsx("span",{className:"text-xs font-medium text-purple-700 uppercase",children:m.insightType})]})}),l.jsx("h4",{className:"font-semibold text-purple-900 mb-1",children:m.title}),l.jsx("p",{className:"text-sm text-purple-800 mb-3",children:m.description}),m.recommendation&&l.jsxs("div",{className:"mt-2 pt-2 border-t border-purple-300",children:[l.jsx("p",{className:"text-sm font-medium text-purple-900",children:"Recommendation:"}),l.jsx("p",{className:"text-sm text-purple-800",children:m.recommendation})]})]},m.id))})]})]})}function DV(e){return l.jsx(IV,{...e})}async function LV(e){return{}}async function MV(e,t){return null}async function $T(e){return{getRate:async t=>MV(),getRates:async()=>LV()}}async function BV(e,t){return console.log("Hybrid comparison not fully implemented"),[]}async function UV(e,t){return BV()}function $V(e){const[t,r]=F.useState([]),[s,n]=F.useState(!0),[a,i]=F.useState(null),o=async()=>{if(!e){n(!1);return}n(!0),i(null);try{const{data:c}=await pe.from("quotes").select("id, supplier_name").eq("project_id",e);if(!c||c.length===0){r([]),n(!1);return}const u=c.map(v=>v.id),{data:d,error:f}=await pe.from("quote_items").select("id, description, unit_price, system_id, quantity, quote_id").in("quote_id",u);if(f)throw f;if(!d||d.length===0){r([]),n(!1);return}const m=d.map(v=>{const y=c.find(w=>w.id===v.quote_id);return{...v,supplier_name:(y==null?void 0:y.supplier_name)||"Unknown"}}).filter(v=>yx(v)?!1:!v.system_id||v.system_id===""||v.system_id==="unknown"),p=new Map;m.forEach(v=>{const y=_R(v.description);y&&(p.has(y)||p.set(y,[]),p.get(y).push(v))});const x=[];p.forEach((v,y)=>{if(v.length<2)return;const w=[...new Set(v.map(T=>T.supplier_name))],g=v.map(T=>T.unit_price).filter(T=>T>0),_=g.length>0?Math.min(...g):0,b=g.length>0?Math.max(...g):0,k=v[0].description,S=bR(k);x.push({key:y,defaultName:S,exampleDescription:k,suppliers:w,count:v.length,rateMin:_,rateMax:b,itemIds:v.map(T=>T.id)})}),x.sort((v,y)=>y.count-v.count),r(x)}catch(c){console.error("Error loading suggested systems:",c),i(c instanceof Error?c.message:"Failed to load suggestions")}finally{n(!1)}};return F.useEffect(()=>{o()},[e]),{suggestions:t,loading:s,error:a,reload:o}}function VV(){return null}const zV=e=>{switch(e){case"GREEN":return"bg-green-100 text-green-900 border-green-300";case"AMBER":return"bg-amber-100 text-amber-900 border-amber-300";case"RED":return"bg-red-100 text-red-900 border-red-300";default:return"bg-gray-100 text-gray-600 border-gray-300"}};function WV({projectId:e,onNavigateBack:t,onNavigateNext:r}){const[s,n]=F.useState([]),[a,i]=F.useState([]),[o,c]=F.useState([]),[u,d]=F.useState(!0),[f,h]=F.useState(!1),[m,p]=F.useState(new Set),[x,v]=F.useState(!1),[y,w]=F.useState(!1),{currentOrganisation:g}=jo(),_=(g==null?void 0:g.id)||"",{suggestions:b}=$V(e),[k,S]=F.useState({}),[T,j]=F.useState({sections:[],services:[],subclasses:[],frrs:[],sizeBuckets:[]});F.useEffect(()=>{U()},[e]),F.useEffect(()=>{z()},[s,k]);const U=async()=>{d(!0);try{const{data:M}=await pe.from("quotes").select("id, supplier_name").eq("project_id",e).order("supplier_name");if(!M||M.length===0){d(!1);return}const J=M.map(I=>I.id),{data:G}=await pe.from("quote_items").select("*").in("quote_id",J);if(!G){d(!1);return}const D=new Set(G.filter(I=>yx(I)).map(I=>I.id));p(D);const K=G.map(I=>{const B=M.find(ee=>ee.id===I.quote_id);return{quoteId:I.quote_id,quoteItemId:I.id,supplier:(B==null?void 0:B.supplier_name)||"Unknown",originalDescription:I.description,quantity:I.quantity||1,rate:I.unit_price,total:I.total_price,section:I.section,service:I.service,subclass:I.subclass,frr:I.frr,size:I.size}}),oe=G.map(I=>({quoteItemId:I.id,systemId:I.system_id,systemLabel:I.system_label})),N=$T(e);await N.loadSettings();const W=await UV(K,oe,I=>N.getModelRate(I));n(W),H(W),await pe.from("project_settings").upsert({project_id:e,scope_matrix_completed:!0,updated_at:new Date().toISOString()},{onConflict:"project_id"})}catch(M){console.error("Error loading data:",M)}finally{d(!1)}},H=M=>{const J=new Set,G=new Set,D=new Set,K=new Set,oe=new Set;M.forEach(N=>{N.section&&J.add(N.section),N.service&&G.add(N.service),N.subclass&&D.add(N.subclass),N.frr&&K.add(N.frr),N.sizeBucket&&oe.add(N.sizeBucket)}),j({sections:Array.from(J).sort(),services:Array.from(G).sort(),subclasses:Array.from(D).sort(),frrs:Array.from(K).sort(),sizeBuckets:Array.from(oe).sort()})},z=()=>{let M=s;k.section&&(M=M.filter(K=>K.section===k.section)),k.service&&(M=M.filter(K=>K.service===k.service)),k.subclass&&(M=M.filter(K=>K.subclass===k.subclass)),k.frr&&(M=M.filter(K=>K.frr===k.frr)),k.sizeBucket&&(M=M.filter(K=>K.sizeBucket===k.sizeBucket));const J=Array.from(new Set(M.map(K=>K.supplier))).sort();c(J);const G=new Map;M.forEach(K=>{const oe=`${K.systemId}|${K.systemLabel}`;G.has(oe)||G.set(oe,{systemId:K.systemId,systemLabel:K.systemLabel,section:K.section,service:K.service,subclass:K.subclass,frr:K.frr,sizeBucket:K.sizeBucket,cells:{}});const N=G.get(oe);N.cells[K.supplier]||(N.cells[K.supplier]={unitRate:K.unitRate,flag:K.flag,modelRate:K.modelRate,variancePct:K.variancePct,componentCount:K.componentCount,quoteId:K.quoteId,quoteItemId:K.quoteItemId})});const D=Array.from(G.values()).sort((K,oe)=>K.systemId==="UNMAPPED"&&oe.systemId!=="UNMAPPED"?1:oe.systemId==="UNMAPPED"&&K.systemId!=="UNMAPPED"?-1:K.systemLabel.localeCompare(oe.systemLabel));i(D)},q=()=>{try{if(console.log("Export CSV clicked",{matrixRowsCount:a.length,suppliersCount:o.length}),a.length===0){alert("No data available to export. Please ensure quotes are imported and the matrix has been generated.");return}const M=["System ID","System Label","Section","Service","Subclass","FRR","Size Bucket"];o.forEach(N=>{M.push(`${N} - Unit Rate`),M.push(`${N} - Model Rate`),M.push(`${N} - Variance %`),M.push(`${N} - Flag`)});const J=a.map(N=>{const W=[N.systemId,N.systemLabel,N.section||"",N.service||"",N.subclass||"",N.frr||"",N.sizeBucket||""];return o.forEach(I=>{var ee,le,fe;const B=N.cells[I];B?(W.push(((ee=B.unitRate)==null?void 0:ee.toFixed(2))||""),W.push(((le=B.modelRate)==null?void 0:le.toFixed(2))||""),W.push(((fe=B.variancePct)==null?void 0:fe.toFixed(2))||""),W.push(B.flag)):W.push("","","","")}),W}),G=[M.join(","),...J.map(N=>N.map(W=>`"${W}"`).join(","))].join(`
`),D=new Blob([G],{type:"text/csv;charset=utf-8;"}),K=URL.createObjectURL(D),oe=document.createElement("a");oe.href=K,oe.download=`scope-matrix-${e}-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(oe),oe.click(),document.body.removeChild(oe),URL.revokeObjectURL(K),console.log("Export completed successfully")}catch(M){console.error("Error exporting CSV:",M),alert("Failed to export CSV. Check console for details.")}},re=()=>{S({})},X=Object.values(k).some(M=>M);return u?l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsx("div",{className:"text-gray-500",children:"Loading scope matrix..."})}):s.length===0?l.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center",children:[l.jsx("p",{className:"text-gray-500 text-lg",children:"No data available."}),l.jsx("p",{className:"text-gray-400 mt-2",children:"Import quotes and configure model rate settings to view the scope matrix."})]}):l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsxs("button",{onClick:()=>h(!f),className:"flex items-center gap-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 transition-colors",children:[l.jsx(wS,{size:18}),"Filters",X&&l.jsx("span",{className:"ml-1 px-2 py-0.5 bg-blue-600 text-white text-xs rounded-full",children:Object.values(k).filter(M=>M).length})]}),X&&l.jsxs("button",{onClick:re,className:"flex items-center gap-2 px-3 py-2 text-sm text-gray-600 hover:text-gray-900",children:[l.jsx(cn,{size:16}),"Clear filters"]})]}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsxs("button",{onClick:()=>v(!0),disabled:b.length===0,className:"flex items-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed",children:[l.jsx(SF,{size:18}),"Suggested Systems",b.length>0&&l.jsx("span",{className:"ml-1 px-2 py-0.5 bg-purple-800 text-white text-xs rounded-full",children:b.length})]}),l.jsxs("button",{onClick:q,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:[l.jsx(po,{size:18}),"Export CSV"]})]})]}),f&&l.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Section"}),l.jsxs("select",{value:k.section||"",onChange:M=>S({...k,section:M.target.value||void 0}),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[l.jsx("option",{value:"",children:"All"}),T.sections.map(M=>l.jsx("option",{value:M,children:M},M))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Service"}),l.jsxs("select",{value:k.service||"",onChange:M=>S({...k,service:M.target.value||void 0}),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[l.jsx("option",{value:"",children:"All"}),T.services.map(M=>l.jsx("option",{value:M,children:M},M))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Subclass"}),l.jsxs("select",{value:k.subclass||"",onChange:M=>S({...k,subclass:M.target.value||void 0}),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[l.jsx("option",{value:"",children:"All"}),T.subclasses.map(M=>l.jsx("option",{value:M,children:M},M))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"FRR"}),l.jsxs("select",{value:k.frr||"",onChange:M=>S({...k,frr:M.target.value||void 0}),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[l.jsx("option",{value:"",children:"All"}),T.frrs.map(M=>l.jsx("option",{value:M,children:M},M))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Size Bucket"}),l.jsxs("select",{value:k.sizeBucket||"",onChange:M=>S({...k,sizeBucket:M.target.value||void 0}),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[l.jsx("option",{value:"",children:"All"}),T.sizeBuckets.map(M=>l.jsx("option",{value:M,children:M},M))]})]})]})}),l.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Scope Matrix"}),l.jsxs("div",{className:"relative group",children:[l.jsx(vd,{size:18,className:"text-gray-400 hover:text-gray-600 cursor-help"}),l.jsxs("div",{className:"absolute left-1/2 -translate-x-1/2 bottom-full mb-2 hidden group-hover:block z-20 w-80 p-3 bg-gray-900 text-white text-sm rounded-lg shadow-lg",children:[l.jsx("div",{className:"font-semibold mb-1",children:"Scope Matrix"}),l.jsx("div",{className:"text-gray-200",children:"Compare supplier rates for each passive fire system and quickly see pricing differences and missing items."}),l.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 top-full w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-gray-900"})]})]})]}),l.jsxs("div",{className:"flex items-center gap-6 text-sm",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-4 h-4 bg-green-100 border-2 border-green-300 rounded"}),l.jsx("span",{className:"text-gray-600",children:"10%"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-4 h-4 bg-amber-100 border-2 border-amber-300 rounded"}),l.jsx("span",{className:"text-gray-600",children:"20%"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-4 h-4 bg-red-100 border-2 border-red-300 rounded"}),l.jsx("span",{className:"text-gray-600",children:">20%"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-4 h-4 bg-gray-100 border-2 border-gray-300 rounded"}),l.jsx("span",{className:"text-gray-600",children:"N/A"})]})]})]}),l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full border-collapse text-sm",children:[l.jsx("thead",{children:l.jsxs("tr",{className:"bg-gray-50",children:[l.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700 border border-gray-200 sticky left-0 bg-gray-50 z-10",children:"System"}),o.map(M=>l.jsx("th",{className:"px-3 py-2 text-center font-medium text-gray-700 border border-gray-200 min-w-[120px]",children:M},M))]})}),l.jsx("tbody",{children:a.map((M,J)=>l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"px-3 py-2 text-sm font-medium text-gray-900 border border-gray-200 sticky left-0 bg-white z-10",children:l.jsxs("div",{className:"flex flex-col",children:[l.jsx("span",{className:"font-semibold",children:M.systemLabel}),M.systemId!==M.systemLabel&&l.jsx("span",{className:"text-xs text-gray-500",children:M.systemId})]})}),o.map(G=>{const D=M.cells[G];if(!D)return l.jsx("td",{className:"px-3 py-2 text-center border border-gray-200",children:l.jsx("span",{className:"text-gray-400",children:"-"})},G);const K=m.has(D.quoteItemId);return l.jsx("td",{className:"px-3 py-2 border border-gray-200",children:l.jsxs("div",{className:"relative group",children:[l.jsxs("div",{className:`px-2 py-1.5 rounded text-center font-medium border-2 ${zV(D.flag)} flex items-center justify-center gap-1`,children:[l.jsx("span",{children:D.unitRate!==null?`$${D.unitRate.toFixed(2)}`:"N/A"}),K&&l.jsx(vt,{size:14,className:"text-yellow-600"})]}),l.jsxs("div",{className:"absolute left-1/2 -translate-x-1/2 bottom-full mb-2 hidden group-hover:block z-20 w-48 p-3 bg-gray-900 text-white text-xs rounded-lg shadow-lg",children:[l.jsxs("div",{className:"space-y-1",children:[K&&l.jsxs("div",{className:"pb-2 mb-2 border-b border-gray-700 text-yellow-300 flex items-start gap-1",children:[l.jsx(vt,{size:14,className:"flex-shrink-0 mt-0.5"}),l.jsx("span",{children:"Quantity missing in source quote. Please review before finalising."})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-gray-300",children:"Unit Rate:"}),l.jsx("span",{className:"font-semibold",children:D.unitRate!==null?`$${D.unitRate.toFixed(2)}`:"N/A"})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-gray-300",children:"Model Rate:"}),l.jsx("span",{className:"font-semibold",children:D.modelRate!==null?`$${D.modelRate.toFixed(2)}`:"N/A"})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-gray-300",children:"Variance:"}),l.jsx("span",{className:"font-semibold",children:D.variancePct!==null?`${D.variancePct>0?"+":""}${D.variancePct.toFixed(1)}%`:"N/A"})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-gray-300",children:"Components:"}),l.jsx("span",{className:"font-semibold",children:D.componentCount||"N/A"})]})]}),l.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 top-full w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-gray-900"})]})]})},G)})]},J))})]})}),a.length===0&&l.jsx("div",{className:"text-center py-8 text-gray-500",children:"No data matches the selected filters."}),l.jsxs("div",{className:"mt-6 pt-4 border-t border-gray-200",children:[l.jsx("button",{onClick:()=>w(!y),className:"flex items-center gap-2 text-sm text-gray-600 hover:text-gray-900 transition-colors",children:y?l.jsxs(l.Fragment,{children:[l.jsx(cF,{size:16}),l.jsx("span",{children:"Less Info"})]}):l.jsxs(l.Fragment,{children:[l.jsx(ho,{size:16}),l.jsx("span",{children:"More Info"})]})}),y&&l.jsxs("div",{className:"mt-4 p-4 bg-gray-50 border border-gray-200 rounded-lg",children:[l.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-2",children:"How to Read This Matrix"}),l.jsx("p",{className:"text-sm text-gray-700 leading-relaxed",children:"This matrix compares each supplier's rates for the same passive fire systems so you can accurately assess scope and pricing differences. Every row is a system type, and each column shows how each supplier priced that system. Colour indicators highlight where prices vary, helping you quickly identify mismatches, missing items, and potential scope gaps."})]})]})]}),l.jsx(Fk,{currentStep:4,onBack:t,onNext:r,backLabel:"Back: Quote Intelligence",nextLabel:"Next: Equalisation"}),x&&l.jsx(VV,{projectId:e,organisationId:_,onClose:()=>v(!1),onSystemCreated:()=>{U()}})]})}function HV({projectId:e}){const[t,r]=F.useState([]),[s,n]=F.useState(!0);F.useEffect(()=>{a()},[e]);const a=async()=>{n(!0);try{const{data:p,error:x}=await pe.from("base_tracker").select("*").eq("project_id",e).order("section",{ascending:!0}).order("system_id",{ascending:!0});if(x)throw x;const v=(p||[]).map(y=>({...y,claim_period:y.claim_period||null,claim_qty:y.claim_qty||0,previous_qty:y.previous_qty||0}));r(v)}catch(p){console.error("Error loading base tracker data:",p)}finally{n(!1)}},i=(p,x)=>p*x,o=(p,x)=>p+x,c=(p,x)=>p*x,u=(p,x)=>{const v=p-x;return v>0?v:0},d=()=>{const p=t.reduce((v,y)=>v+i(y.qty_base,y.unit_rate),0),x=t.reduce((v,y)=>v+c(y.claim_qty,y.unit_rate),0);return{contractSum:p,thisClaim:x}},f=()=>{const p=t.map(g=>{const _=i(g.qty_base,g.unit_rate),b=o(g.claim_qty,g.previous_qty),k=c(g.claim_qty,g.unit_rate),S=u(b,g.qty_base);return{Section:g.section,Code:g.system_id,Description:g.description,Size:g.size,"Substrate & Fire rating":`${g.material||""} ${g.frr||""}`.trim(),"Qty (Contract)":g.qty_base,Unit:g.unit,"Unit Rate":g.unit_rate,"Total Price (Contract)":_,"Claim Period":g.claim_period||"","Claim Qty":g.claim_qty,"Previous Qty":g.previous_qty,"Total Qty":b,Rates:g.unit_rate,"Claim Amount":k,"Exceeding contract works":S,Notes:g.notes,"Last Updated":new Date(g.updated_at).toLocaleDateString()}}),x=dt.json_to_sheet(p),v=dt.book_new();dt.book_append_sheet(v,x,"Base Tracker");const y=d(),w=[[""],["Summary"],["Contract Sum",y.contractSum],["This Claim",y.thisClaim]];dt.sheet_add_aoa(x,w,{origin:-1}),ng(v,`BaseTracker_${e}_${new Date().toISOString().split("T")[0]}.xlsx`)},h=()=>{const p=t.map(g=>{const _=i(g.qty_base,g.unit_rate),b=o(g.claim_qty,g.previous_qty),k=c(g.claim_qty,g.unit_rate),S=u(b,g.qty_base);return{Section:g.section,Code:g.system_id,Description:g.description,Size:g.size,"Substrate & Fire rating":`${g.material||""} ${g.frr||""}`.trim(),"Qty (Contract)":g.qty_base,Unit:g.unit,"Unit Rate":g.unit_rate,"Total Price (Contract)":_,"Claim Period":g.claim_period||"","Claim Qty":g.claim_qty,"Previous Qty":g.previous_qty,"Total Qty":b,Rates:g.unit_rate,"Claim Amount":k,"Exceeding contract works":S,Notes:g.notes,"Last Updated":new Date(g.updated_at).toLocaleDateString()}}),x=dt.json_to_sheet(p),v=dt.sheet_to_csv(x),y=new Blob([v],{type:"text/csv;charset=utf-8;"}),w=document.createElement("a");w.href=URL.createObjectURL(y),w.download=`BaseTracker_${e}_${new Date().toISOString().split("T")[0]}.csv`,w.click()};if(s)return l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsx("div",{className:"text-gray-500",children:"Loading base tracker data..."})});if(t.length===0)return l.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center",children:[l.jsx(vt,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-500 text-lg mb-2",children:"No base tracker data available"}),l.jsx("p",{className:"text-gray-400",children:"Create base tracker items from the Award Report page"})]});const m=d();return l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Base Tracker"}),l.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Contract baseline with ",t.length," items"]})]}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsxs("button",{onClick:f,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors",children:[l.jsx(mF,{size:18}),"Export Excel"]}),l.jsxs("button",{onClick:h,className:"flex items-center gap-2 px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors",children:[l.jsx(po,{size:18}),"Export CSV"]})]})]}),l.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full text-sm",children:[l.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-3 py-3 text-left text-xs font-semibold text-gray-700 uppercase",children:"Section"}),l.jsx("th",{className:"px-3 py-3 text-left text-xs font-semibold text-gray-700 uppercase",children:"Code"}),l.jsx("th",{className:"px-3 py-3 text-left text-xs font-semibold text-gray-700 uppercase",children:"Description"}),l.jsx("th",{className:"px-3 py-3 text-left text-xs font-semibold text-gray-700 uppercase",children:"Size"}),l.jsx("th",{className:"px-3 py-3 text-left text-xs font-semibold text-gray-700 uppercase",children:"Substrate & Fire Rating"}),l.jsx("th",{className:"px-3 py-3 text-right text-xs font-semibold text-gray-700 uppercase",children:"Qty (Contract)"}),l.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-gray-700 uppercase",children:"Unit"}),l.jsx("th",{className:"px-3 py-3 text-right text-xs font-semibold text-gray-700 uppercase",children:"Unit Rate"}),l.jsx("th",{className:"px-3 py-3 text-right text-xs font-semibold text-gray-700 uppercase bg-blue-50",children:"Total Price (Contract)"}),l.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-gray-700 uppercase",children:"Claim Period"}),l.jsx("th",{className:"px-3 py-3 text-right text-xs font-semibold text-gray-700 uppercase",children:"Claim Qty"}),l.jsx("th",{className:"px-3 py-3 text-right text-xs font-semibold text-gray-700 uppercase",children:"Previous Qty"}),l.jsx("th",{className:"px-3 py-3 text-right text-xs font-semibold text-gray-700 uppercase bg-blue-50",children:"Total Qty"}),l.jsx("th",{className:"px-3 py-3 text-right text-xs font-semibold text-gray-700 uppercase bg-blue-50",children:"Rates"}),l.jsx("th",{className:"px-3 py-3 text-right text-xs font-semibold text-gray-700 uppercase bg-green-50",children:"Claim Amount"}),l.jsx("th",{className:"px-3 py-3 text-right text-xs font-semibold text-gray-700 uppercase bg-amber-50",children:"Exceeding Contract Works"}),l.jsx("th",{className:"px-3 py-3 text-left text-xs font-semibold text-gray-700 uppercase",children:"Notes"}),l.jsx("th",{className:"px-3 py-3 text-left text-xs font-semibold text-gray-700 uppercase",children:"Last Updated"})]})}),l.jsx("tbody",{className:"divide-y divide-gray-200",children:t.map(p=>{const x=i(p.qty_base,p.unit_rate),v=o(p.claim_qty,p.previous_qty),y=c(p.claim_qty,p.unit_rate),w=u(v,p.qty_base);return l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"px-3 py-2 text-gray-900",children:p.section}),l.jsx("td",{className:"px-3 py-2 text-gray-900 font-mono text-xs",children:p.system_id}),l.jsx("td",{className:"px-3 py-2 text-gray-900 max-w-xs",children:p.description}),l.jsx("td",{className:"px-3 py-2 text-gray-900",children:p.size}),l.jsx("td",{className:"px-3 py-2 text-gray-900",children:`${p.material||""} ${p.frr||""}`.trim()}),l.jsx("td",{className:"px-3 py-2 text-right text-gray-900",children:p.qty_base.toFixed(2)}),l.jsx("td",{className:"px-3 py-2 text-center text-gray-900",children:p.unit}),l.jsxs("td",{className:"px-3 py-2 text-right text-gray-900",children:["$",p.unit_rate.toFixed(2)]}),l.jsxs("td",{className:"px-3 py-2 text-right text-gray-900 font-semibold bg-blue-50",children:["$",x.toFixed(2)]}),l.jsx("td",{className:"px-3 py-2 text-center text-gray-600",children:p.claim_period||"-"}),l.jsx("td",{className:"px-3 py-2 text-right text-gray-900",children:p.claim_qty.toFixed(2)}),l.jsx("td",{className:"px-3 py-2 text-right text-gray-900",children:p.previous_qty.toFixed(2)}),l.jsx("td",{className:"px-3 py-2 text-right text-gray-900 font-semibold bg-blue-50",children:v.toFixed(2)}),l.jsxs("td",{className:"px-3 py-2 text-right text-gray-900 bg-blue-50",children:["$",p.unit_rate.toFixed(2)]}),l.jsxs("td",{className:"px-3 py-2 text-right text-gray-900 font-semibold bg-green-50",children:["$",y.toFixed(2)]}),l.jsx("td",{className:`px-3 py-2 text-right font-semibold ${w>0?"text-red-700 bg-red-50":"text-gray-900 bg-amber-50"}`,children:w.toFixed(2)}),l.jsx("td",{className:"px-3 py-2 text-gray-600 max-w-xs truncate",children:p.notes}),l.jsx("td",{className:"px-3 py-2 text-gray-600 text-xs",children:new Date(p.updated_at).toLocaleDateString()})]},p.id)})})]})})}),l.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:l.jsxs("div",{className:"grid grid-cols-2 gap-8",children:[l.jsxs("div",{children:[l.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Contract Sum"}),l.jsxs("div",{className:"text-3xl font-bold text-gray-900",children:["$",m.contractSum.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),l.jsxs("div",{children:[l.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"This Claim"}),l.jsxs("div",{className:"text-3xl font-bold text-green-600",children:["$",m.thisClaim.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]})})]})}const Np={set:(e,t)=>localStorage.setItem(e,JSON.stringify(t)),get:e=>{const t=localStorage.getItem(e);return t?JSON.parse(t):null}};function _w(e){return{get:t=>Np.get(`${e}_${t}`),set:(t,r)=>Np.set(`${e}_${t}`,r)}}function bw(e,t,r){Np.set(`project_${e}_${t}`,r)}function qV({projectId:e,projectName:t}){const[r,s]=F.useState("claims"),[n,a]=F.useState(()=>{const c=_w(e);return(c==null?void 0:c.period)||"all"}),[i,o]=F.useState(()=>{var u;const c=_w(e);return((u=c==null?void 0:c.filters)==null?void 0:u.status)||[]});return F.useEffect(()=>{bw(e,"claims",{period:n})},[e,n]),F.useEffect(()=>{bw(e,"variations",{filters:{status:i}})},[e,i]),e?l.jsxs(fo.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},className:"space-y-6",children:[l.jsxs("div",{className:"card",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"metric-icon primary",children:l.jsx(nu,{className:"w-6 h-6"})}),l.jsxs("div",{children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Claims & Variations"}),l.jsx("p",{className:"text-gray-600 mt-1",children:"Reconcile payment claims to baseline and manage change"})]})]}),l.jsx("div",{className:"px-4 py-2 bg-gray-100 rounded-lg",children:l.jsxs("span",{className:"text-sm font-medium text-gray-700",children:["Project: ",t]})})]}),l.jsxs("div",{className:"grid grid-cols-3 gap-6",children:[l.jsxs("div",{className:"metric-tile",children:[l.jsxs("div",{children:[l.jsx("div",{className:"metric-label",children:"Overclaimed"}),l.jsx("div",{className:"metric-value text-red-600",children:"$0"})]}),l.jsx("div",{className:"metric-icon danger",children:l.jsx(Yi,{className:"w-6 h-6"})})]}),l.jsxs("div",{className:"metric-tile",children:[l.jsxs("div",{children:[l.jsx("div",{className:"metric-label",children:"Underclaimed"}),l.jsx("div",{className:"metric-value",style:"color: var(--warning)",children:"$0"})]}),l.jsx("div",{className:"metric-icon warning",children:l.jsx(nu,{className:"w-6 h-6"})})]}),l.jsxs("div",{className:"metric-tile",children:[l.jsxs("div",{children:[l.jsx("div",{className:"metric-label",children:"Unmatched"}),l.jsx("div",{className:"metric-value",children:"0"})]}),l.jsx("div",{className:"metric-icon primary",children:l.jsx(Dr,{className:"w-6 h-6"})})]})]})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"bg-gray-100 p-1 rounded-lg flex gap-1",children:[l.jsx("button",{onClick:()=>s("claims"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${r==="claims"?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"Claims Reconciliation"}),l.jsx("button",{onClick:()=>s("variations"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${r==="variations"?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"Variations Register"})]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{disabled:!0,className:"p-2 bg-white border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed shadow-sm",children:l.jsx(Jl,{className:"w-5 h-5 text-gray-400"})}),l.jsx("button",{disabled:!0,className:"p-2 bg-white border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed shadow-sm",children:l.jsx(po,{className:"w-5 h-5 text-gray-400"})}),l.jsx("button",{disabled:!0,className:"p-2 bg-white border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed shadow-sm",children:l.jsx(yd,{className:"w-5 h-5 text-gray-400"})})]})]}),r==="claims"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsxs("select",{value:n,onChange:c=>a(c.target.value),className:"input-field",children:[l.jsx("option",{value:"all",children:"All Periods"}),l.jsx("option",{value:"2024-01",children:"January 2024"}),l.jsx("option",{value:"2024-02",children:"February 2024"}),l.jsx("option",{value:"2024-03",children:"March 2024"})]}),l.jsxs("button",{disabled:!0,className:"btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:[l.jsx(Jl,{className:"w-4 h-4"}),"Import Claim XLSX"]})]}),l.jsx("div",{className:"card p-0 overflow-hidden",children:l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"table-clean",children:[l.jsx("thead",{children:l.jsxs("tr",{children:[l.jsx("th",{children:"Item"}),l.jsx("th",{children:"Description"}),l.jsx("th",{children:"Unit"}),l.jsx("th",{className:"text-right",children:"Qty (Base)"}),l.jsx("th",{className:"text-right",children:"Qty (Claimed)"}),l.jsx("th",{className:"text-right",children:"Delta"}),l.jsx("th",{className:"text-right",children:"Rate"}),l.jsx("th",{className:"text-right",children:"Amount"}),l.jsx("th",{className:"text-center",children:"Match Status"})]})}),l.jsx("tbody",{children:l.jsx("tr",{children:l.jsxs("td",{colSpan:9,className:"px-4 py-16 text-center",children:[l.jsx(Yi,{className:"w-12 h-12 mx-auto mb-3 text-gray-400"}),l.jsx("p",{className:"text-lg font-medium mb-2 text-gray-900",children:"No Claims Data"}),l.jsx("p",{className:"text-sm mb-4 text-gray-600",children:"Import payment claims to reconcile against baseline"}),l.jsxs("button",{className:"text-blue-600 hover:text-blue-700 transition-colors text-sm font-medium flex items-center gap-2 mx-auto",children:[l.jsx(Dr,{className:"w-4 h-4"}),"Learn more"]})]})})})]})})})]}),r==="variations"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("div",{className:"flex gap-2",children:["Pending","Approved","Rejected"].map(c=>l.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-700",children:[l.jsx("input",{type:"checkbox",checked:i.includes(c),onChange:u=>{u.target.checked?o([...i,c]):o(i.filter(d=>d!==c))},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),c]},c))}),l.jsx("button",{disabled:!0,className:"ml-auto px-4 py-2 bg-amber-600 text-white rounded-lg text-sm font-medium hover:bg-amber-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:"Auto-Detect Variations"}),l.jsxs("button",{disabled:!0,className:"px-4 py-2 glass-card text-slate-300 rounded-lg text-sm font-medium hover:bg-slate-800/50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[l.jsx(po,{className:"w-4 h-4"}),"Export Register"]})]}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:l.jsxs("div",{className:"card text-center",children:[l.jsx(Yi,{className:"w-12 h-12 mx-auto mb-3 text-gray-400"}),l.jsx("p",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Variations"}),l.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Variations will appear here once detected or manually added"}),l.jsxs("button",{className:"text-blue-600 hover:text-blue-700 transition-colors text-sm font-medium flex items-center gap-2 mx-auto",children:[l.jsx(Dr,{className:"w-4 h-4"}),"Learn more"]})]})})]}),l.jsxs("div",{className:"card flex items-center gap-3 text-gray-600 text-sm",children:[l.jsx(nu,{className:"w-5 h-5 icon-blue"}),l.jsx("span",{children:"Claims & Variations: Reconciliation & Change Management"})]})]}):l.jsx("div",{className:"flex items-center justify-center min-h-[60vh] p-8",children:l.jsxs("div",{className:"card max-w-md text-center",children:[l.jsx("div",{className:"metric-icon primary mx-auto mb-4",children:l.jsx(nu,{className:"w-8 h-8"})}),l.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Select or Create a Project"}),l.jsx("p",{className:"text-gray-600 mb-6",children:"Choose a project to access Claims & Variations features"}),l.jsx("button",{className:"btn-primary",children:"Go to Project Dashboard"})]})})}function GV({projectId:e}){const[t,r]=F.useState("basetracker");return l.jsxs("div",{className:"h-full flex flex-col bg-gray-50",children:[l.jsxs("div",{className:"bg-white border-b border-gray-200 px-8 py-6",children:[l.jsx("div",{className:"flex items-center justify-between mb-4",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-10 h-10 bg-blue-50 rounded-lg flex items-center justify-center",children:l.jsx(vS,{className:"w-5 h-5 text-blue-600"})}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-semibold brand-navy",children:"Contract Manager"}),l.jsx("p",{className:"text-gray-600 text-base",children:"Base contract tracking and management"})]})]})}),l.jsx("div",{className:"flex gap-2",children:l.jsxs("button",{onClick:()=>r("basetracker"),className:`flex items-center gap-2 px-4 py-2 rounded-full text-sm font-medium transition-colors ${t==="basetracker"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[l.jsx(Dr,{size:16}),"Base Tracker"]})})]}),l.jsxs("div",{className:"flex-1 overflow-auto",children:[t==="basetracker"&&l.jsx(HV,{projectId:e}),t==="claims"&&l.jsx(qV,{projectId:e})]})]})}function KV({projects:e,onNavigate:t}){const[r,s]=F.useState(""),[n,a]=F.useState(null),[i,o]=F.useState(!1),[c,u]=F.useState(null),d=e.filter(b=>b.name.toLowerCase().includes(r.toLowerCase())||b.client_reference.toLowerCase().includes(r.toLowerCase())),f=d.filter(b=>!b.has_report),h=d.filter(b=>b.has_report),m=()=>{n!=null&&n.report_id&&(t==null||t("award-report",n.report_id))},p=async(b=!1)=>{var k,S,T,j,U,H,z;if(n){o(!0),u(null);try{const X=await fetch("https://cbankidsdfsvsgfygbzt.supabase.co/functions/v1/compute_award_report",{method:"POST",headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNiYW5raWRzZGZzdnNnZnlnYnp0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMzMTk3NDgsImV4cCI6MjA3ODg5NTc0OH0.SXgc-9ZamplKeJm5_nl8J2-UzO7A0f8KbAnPZEmsiSo","Content-Type":"application/json"},body:JSON.stringify({projectId:n.id,force:b})});if(!X.ok){const K=await X.text();throw new Error(`Server returned ${X.status}: ${K}`)}const M=await X.json();if(!M||!M.reportId)throw new Error("No report ID returned from server");const{data:J}=await pe.from("award_reports").select("id, generated_at, result_json").eq("id",M.reportId).single(),G=((T=(S=(k=J==null?void 0:J.result_json)==null?void 0:k.awardSummary)==null?void 0:S.suppliers)==null?void 0:T.length)||0,D=((z=(H=(U=(j=J==null?void 0:J.result_json)==null?void 0:j.awardSummary)==null?void 0:U.suppliers)==null?void 0:H[0])==null?void 0:z.coveragePercent)||0;a({...n,has_report:!0,report_id:M.reportId,report_generated_at:J==null?void 0:J.generated_at,report_quotes_count:G,report_coverage_percent:Math.round(D)}),t==null||t("award-report",M.reportId)}catch(q){console.error("Error computing award report:",q),u(q.message||"Failed to compute award report")}finally{o(!1)}}},x=()=>{p(!1)},v=()=>{p(!0)},y=async()=>{var b,k,S,T,j,U,H;if(n!=null&&n.report_id)try{const{data:z}=await pe.from("award_reports").select("id, generated_at, result_json").eq("id",n.report_id).single();if(z){const q=((S=(k=(b=z.result_json)==null?void 0:b.awardSummary)==null?void 0:k.suppliers)==null?void 0:S.length)||0,re=((H=(U=(j=(T=z.result_json)==null?void 0:T.awardSummary)==null?void 0:j.suppliers)==null?void 0:U[0])==null?void 0:H.coveragePercent)||0;a({...n,report_generated_at:z.generated_at,report_quotes_count:q,report_coverage_percent:Math.round(re)})}}catch(z){console.error("Error refreshing project metadata:",z)}};F.useEffect(()=>{n!=null&&n.has_report&&n.report_id&&y()},[n==null?void 0:n.id]);const w=async()=>{if(n!=null&&n.report_id)try{const{data:b,error:k}=await pe.from("award_reports").select("result_json, generated_at").eq("id",n.report_id).single();if(k||!b){console.error("Error loading report:",k);return}const T=b.result_json.awardSummary,j=`
        <!DOCTYPE html>
        <html>
        <head>
          <meta charset="UTF-8">
          <title>Award Report - ${n.name}</title>
          <style>
            body { font-family: Arial, sans-serif; padding: 40px; line-height: 1.6; color: #333; }
            h1 { color: #1e40af; border-bottom: 3px solid #3b82f6; padding-bottom: 10px; margin-bottom: 30px; }
            h2 { color: #1e40af; margin-top: 30px; margin-bottom: 15px; border-bottom: 1px solid #e5e7eb; padding-bottom: 8px; }
            h3 { color: #374151; margin-top: 20px; }
            table { width: 100%; border-collapse: collapse; margin: 20px 0; }
            th, td { padding: 12px; text-align: left; border: 1px solid #d1d5db; }
            th { background-color: #3b82f6; color: white; font-weight: 600; }
            tr:nth-child(even) { background-color: #f9fafb; }
            .meta { color: #6b7280; font-size: 14px; margin-bottom: 30px; }
            .supplier-section { margin: 30px 0; padding: 20px; background: #f9fafb; border-radius: 8px; }
            .recommendation { background: #dbeafe; padding: 15px; border-left: 4px solid #3b82f6; margin: 20px 0; }
          </style>
        </head>
        <body>
          <h1>Award Recommendation Report</h1>
          <div class="meta">
            <p><strong>Project:</strong> ${n.name}</p>
            <p><strong>Client:</strong> ${n.client_reference}</p>
            <p><strong>Generated:</strong> ${new Date(b.generated_at).toLocaleString()}</p>
            <p><strong>Equalisation Mode:</strong> ${T.equalisationMode}</p>
          </div>

          <h2>Supplier Rankings</h2>
          <table>
            <thead>
              <tr>
                <th>Rank</th>
                <th>Supplier</th>
                <th>Adjusted Total</th>
                <th>Risk Score</th>
                <th>Coverage %</th>
                <th>Items Quoted</th>
              </tr>
            </thead>
            <tbody>
              ${T.suppliers.map((q,re)=>`
                <tr>
                  <td>${re+1}</td>
                  <td>${q.supplierName}</td>
                  <td>$${q.adjustedTotal.toLocaleString()}</td>
                  <td>${q.riskScore}</td>
                  <td>${q.coveragePercent}%</td>
                  <td>${q.itemsQuoted}</td>
                </tr>
              `).join("")}
            </tbody>
          </table>

          <h2>Recommendations</h2>
          ${T.recommendations.map(q=>`
            <div class="recommendation">
              <h3>${q.type.replace("_"," ")}</h3>
              <p><strong>Supplier:</strong> ${q.supplier.supplierName}</p>
              <p><strong>Reason:</strong> ${q.reason}</p>
            </div>
          `).join("")}
        </body>
        </html>
      `,U=new Blob([j],{type:"text/html"}),H=URL.createObjectURL(U),z=window.open(H,"_blank","width=1024,height=768");if(z)z.onload=()=>{setTimeout(()=>{z.print(),setTimeout(()=>{URL.revokeObjectURL(H)},1e3)},500)};else{const q=document.createElement("a");q.href=H,q.download=`Award_Report_${n.name.replace(/[^a-z0-9]/gi,"_")}.html`,document.body.appendChild(q),q.click(),document.body.removeChild(q),setTimeout(()=>URL.revokeObjectURL(H),1e3)}}catch(b){console.error("Error exporting PDF:",b)}},g=()=>{n&&(t==null||t("award-report"))},_=b=>new Date(b).toLocaleDateString("en-NZ",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"});return l.jsxs("div",{className:"h-full flex flex-col bg-gray-50",children:[l.jsx("div",{className:"bg-white border-b border-gray-200 px-6 py-4",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-10 h-10 bg-blue-500 rounded-lg flex items-center justify-center",children:l.jsx(Dr,{className:"w-6 h-6 text-white"})}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Reports Hub"}),l.jsx("p",{className:"text-sm text-gray-500",children:"Manage and generate award reports"})]})]})}),l.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[l.jsxs("div",{className:"w-96 bg-white border-r border-gray-200 flex flex-col",children:[l.jsx("div",{className:"p-4 border-b border-gray-200",children:l.jsxs("div",{className:"relative",children:[l.jsx(tp,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),l.jsx("input",{type:"text",placeholder:"Search projects...",value:r,onChange:b=>s(b.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),l.jsxs("div",{className:"flex-1 overflow-y-auto",children:[f.length>0&&l.jsxs("div",{className:"mb-6",children:[l.jsx("div",{className:"px-4 py-2 bg-amber-50 border-b border-amber-100",children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(vt,{className:"w-4 h-4 text-amber-600"}),l.jsxs("span",{className:"text-sm font-medium text-amber-900",children:["Needs Report (",f.length,")"]})]})}),l.jsx("div",{className:"divide-y divide-gray-100",children:f.map(b=>l.jsxs("button",{onClick:()=>a(b),className:`w-full text-left px-4 py-3 hover:bg-gray-50 transition-colors ${(n==null?void 0:n.id)===b.id?"bg-blue-50 border-l-4 border-blue-500":""}`,children:[l.jsx("div",{className:"font-medium text-gray-900 mb-1",children:b.name}),l.jsx("div",{className:"text-xs text-gray-500 mb-1",children:b.client_reference}),l.jsxs("div",{className:"text-xs text-gray-400",children:["Updated ",_(b.updated_at)]})]},b.id))})]}),h.length>0&&l.jsxs("div",{children:[l.jsx("div",{className:"px-4 py-2 bg-green-50 border-b border-green-100",children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Qh,{className:"w-4 h-4 text-green-600"}),l.jsxs("span",{className:"text-sm font-medium text-green-900",children:["With Report (",h.length,")"]})]})}),l.jsx("div",{className:"divide-y divide-gray-100",children:h.map(b=>l.jsxs("button",{onClick:()=>a(b),className:`w-full text-left px-4 py-3 hover:bg-gray-50 transition-colors ${(n==null?void 0:n.id)===b.id?"bg-blue-50 border-l-4 border-blue-500":""}`,children:[l.jsx("div",{className:"font-medium text-gray-900 mb-1",children:b.name}),l.jsx("div",{className:"text-xs text-gray-500 mb-1",children:b.client_reference}),l.jsxs("div",{className:"text-xs text-gray-400",children:["Updated ",_(b.updated_at)]})]},b.id))})]}),d.length===0&&l.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-gray-400",children:[l.jsx(tp,{className:"w-12 h-12 mb-3"}),l.jsx("p",{className:"text-sm",children:"No projects found"})]})]})]}),l.jsx("div",{className:"flex-1 overflow-y-auto",children:n?l.jsxs("div",{className:"p-8",children:[l.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6",children:[l.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-4",children:n.name}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{className:"flex items-center gap-3 text-gray-600",children:[l.jsx(Xl,{className:"w-5 h-5 text-gray-400"}),l.jsxs("div",{children:[l.jsx("div",{className:"text-xs text-gray-500 uppercase",children:"Client"}),l.jsx("div",{className:"font-medium",children:n.client_reference||"Not specified"})]})]}),l.jsxs("div",{className:"flex items-center gap-3 text-gray-600",children:[l.jsx(wF,{className:"w-5 h-5 text-gray-400"}),l.jsxs("div",{children:[l.jsx("div",{className:"text-xs text-gray-500 uppercase",children:"Reference"}),l.jsx("div",{className:"font-medium",children:n.client_reference||"N/A"})]})]})]})]}),n.has_report?l.jsxs(l.Fragment,{children:[c&&l.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:l.jsxs("div",{className:"flex items-center gap-2 text-red-800",children:[l.jsx(vt,{className:"w-5 h-5"}),l.jsx("span",{className:"font-medium",children:c})]})}),l.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Report Actions"}),l.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4",children:l.jsxs("div",{className:"flex items-start gap-2",children:[l.jsx(vt,{className:"w-5 h-5 text-blue-600 mt-0.5 flex-shrink-0"}),l.jsx("p",{className:"text-sm text-blue-800",children:"This report is cached. Changes to quotes will show after you click Regenerate."})]})}),l.jsxs("div",{className:"flex flex-wrap gap-3",children:[l.jsx("button",{onClick:m,disabled:i,className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium",children:"View Report"}),l.jsx("button",{onClick:v,disabled:i,className:"flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium",children:i?l.jsxs(l.Fragment,{children:[l.jsx(wn,{className:"w-4 h-4 animate-spin"}),"Regenerating..."]}):l.jsxs(l.Fragment,{children:[l.jsx(is,{className:"w-4 h-4"}),"Regenerate"]})}),l.jsxs("button",{onClick:w,disabled:i,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium",children:[l.jsx(ix,{className:"w-4 h-4"}),"Export PDF"]}),l.jsxs("button",{onClick:g,disabled:i,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium",children:[l.jsx(kS,{className:"w-4 h-4"}),"Export Excel"]})]})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Report Details"}),l.jsxs("div",{className:"grid grid-cols-3 gap-6",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:l.jsx(lF,{className:"w-5 h-5 text-blue-600"})}),l.jsxs("div",{children:[l.jsx("div",{className:"text-xs text-gray-500 uppercase",children:"Generated"}),l.jsx("div",{className:"font-medium text-gray-900",children:n.report_generated_at?_(n.report_generated_at):"N/A"})]})]}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:l.jsx(Dr,{className:"w-5 h-5 text-green-600"})}),l.jsxs("div",{children:[l.jsx("div",{className:"text-xs text-gray-500 uppercase",children:"Quotes Included"}),l.jsx("div",{className:"font-medium text-gray-900",children:n.report_quotes_count||0})]})]}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center",children:l.jsx(ox,{className:"w-5 h-5 text-purple-600"})}),l.jsxs("div",{children:[l.jsx("div",{className:"text-xs text-gray-500 uppercase",children:"Coverage"}),l.jsx("div",{className:"font-medium text-gray-900",children:n.report_coverage_percent?`${n.report_coverage_percent}%`:"N/A"})]})]})]})]})]}):l.jsxs(l.Fragment,{children:[c&&l.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:l.jsxs("div",{className:"flex items-center gap-2 text-red-800",children:[l.jsx(vt,{className:"w-5 h-5"}),l.jsx("span",{className:"font-medium",children:c})]})}),l.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center",children:[l.jsx("div",{className:"w-16 h-16 bg-amber-100 rounded-full flex items-center justify-center mx-auto mb-4",children:l.jsx(vt,{className:"w-8 h-8 text-amber-600"})}),l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Report Available"}),l.jsx("p",{className:"text-gray-500 mb-6",children:"Generate an award report to compare quotes and make award decisions."}),l.jsx("button",{onClick:x,disabled:i,className:"px-6 py-3 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium inline-flex items-center gap-2",children:i?l.jsxs(l.Fragment,{children:[l.jsx(wn,{className:"w-5 h-5 animate-spin"}),"Generating Report..."]}):l.jsxs(l.Fragment,{children:[l.jsx(Dr,{className:"w-5 h-5"}),"Generate Award Report"]})})]})]})]}):l.jsx("div",{className:"flex items-center justify-center h-full",children:l.jsxs("div",{className:"text-center text-gray-400",children:[l.jsx(lx,{className:"w-16 h-16 mx-auto mb-4"}),l.jsx("p",{className:"text-lg",children:"Select a project to view details"})]})})})]})]})}function XV({projectId:e,reportId:t,onToast:r,onNavigate:s}){const[n,a]=F.useState([]),[i,o]=F.useState(null),[c,u]=F.useState(null),[d,f]=F.useState("MODEL"),[h,m]=F.useState(!0),[p,x]=F.useState([]),[v,y]=F.useState(null),[w,g]=F.useState(!1),[_,b]=F.useState(!1),[k,S]=F.useState("excel"),[T,j]=F.useState(null),[U,H]=F.useState(new Map),[z,q]=F.useState(!1),[re,X]=F.useState(!1),[M,J]=F.useState(t||null),[G,D]=F.useState(null),K=F.useRef(null),oe=F.useRef(null);F.useEffect(()=>{N(),t?ee(t):e?B():(m(!1),D("No project ID provided"))},[t,e]),F.useEffect(()=>{const de=Ee=>{oe.current&&!oe.current.contains(Ee.target)&&g(!1)};return document.addEventListener("mousedown",de),()=>document.removeEventListener("mousedown",de)},[]);const N=async()=>{try{const{data:de}=await pe.from("projects").select("id, name, client, approved_quote_id").order("last_accessed_at",{ascending:!1}).limit(10);if(de){x(de);const Ee=de.find(Oe=>Oe.id===e);y(Ee||null)}}catch(de){console.error("Error loading projects:",de)}},W=de=>{window.location.href=`?project=${de}`},I=()=>`05_Exports_Reports/VerifyPlus/${((v==null?void 0:v.name)||"Unknown-Project").replace(/[^a-zA-Z0-9-_]/g,"_")}/`,B=async()=>{var de;try{m(!0),D(null);const{data:Ee,error:Oe}=await pe.from("award_reports").select("*").eq("project_id",e).order("created_at",{ascending:!1}).limit(1).maybeSingle();if(Oe)throw new Error("Failed to load report");if(!Ee){D("No report found for this project. Generate one from the Reports Hub."),m(!1);return}Ee.result_json&&(a(Ee.result_json.comparisonData||[]),o(Ee.result_json.awardSummary||null),u(Ee.result_json.aiAnalysis||null),(de=Ee.params_json)!=null&&de.equalisationMode&&f(Ee.params_json.equalisationMode)),J(Ee.id);const{data:Me}=await pe.from("quotes").select("id, supplier_name").eq("project_id",Ee.project_id);if(Me){const We=new Map;Me.forEach(Ye=>We.set(Ye.supplier_name,Ye.id)),H(We)}}catch(Ee){console.error("Error loading report:",Ee),D(Ee.message||"Failed to load report"),r==null||r(Ee.message||"Failed to load report","error")}finally{m(!1)}},ee=async de=>{var Ee;try{m(!0),D(null);const{data:Oe,error:Me}=await pe.from("award_reports").select("*").eq("id",de).maybeSingle();if(Me)throw new Error("Failed to load report");if(!Oe)throw new Error("Report not found");Oe.result_json&&(a(Oe.result_json.comparisonData||[]),o(Oe.result_json.awardSummary||null),u(Oe.result_json.aiAnalysis||null),(Ee=Oe.params_json)!=null&&Ee.equalisationMode&&f(Oe.params_json.equalisationMode)),J(Oe.id);const{data:We}=await pe.from("quotes").select("id, supplier_name").eq("project_id",Oe.project_id);if(We){const Ye=new Map;We.forEach(xt=>Ye.set(xt.supplier_name,xt.id)),H(Ye)}}catch(Oe){console.error("Error loading report:",Oe),D(Oe.message||"Failed to load report"),r==null||r(Oe.message||"Failed to load report","error")}finally{m(!1)}},le=async()=>{try{m(!0),D(null),console.log("[Award Report] Regenerating report for project:",e);const de="https://cbankidsdfsvsgfygbzt.supabase.co/functions/v1/compute_award_report",Ee={Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNiYW5raWRzZGZzdnNnZnlnYnp0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMzMTk3NDgsImV4cCI6MjA3ODg5NTc0OH0.SXgc-9ZamplKeJm5_nl8J2-UzO7A0f8KbAnPZEmsiSo","Content-Type":"application/json"};console.log("[Award Report] Calling function:",de);const Oe=await fetch(de,{method:"POST",headers:Ee,body:JSON.stringify({projectId:e,force:!0})});if(console.log("[Award Report] Response status:",Oe.status),!Oe.ok){const We=await Oe.text();throw console.error("[Award Report] Error response:",We),new Error(`Server returned ${Oe.status}: ${We}`)}const Me=await Oe.json();if(console.log("[Award Report] Response data:",Me),!Me||!Me.reportId)throw console.error("[Award Report] Invalid response:",Me),new Error((Me==null?void 0:Me.error)||(Me==null?void 0:Me.message)||"No report ID returned from server");J(Me.reportId),await ee(Me.reportId),D(null),r==null||r("Report generated successfully","success")}catch(de){console.error("Error regenerating report:",de),D(de.message||"Failed to regenerate report"),r==null||r(de.message||"Failed to regenerate report","error")}finally{m(!1)}},fe=()=>{window.print()},se=de=>{S(de),b(!0)},ne=()=>{b(!1),k==="excel"?V():C()},V=()=>{if(!i)return;const de=dt.book_new(),Ee=[["Award Summary Report"],["Generated:",new Date().toLocaleDateString()],["Equalisation Mode:",i.equalisationMode],["Total Systems:",i.totalSystems.toString()],[],["Supplier","Adjusted Total","Risk Score","Coverage %","Items Quoted","Notes"],...i.suppliers.map(Ce=>[Ce.supplierName,Ce.adjustedTotal,Ce.riskScore,Ce.coveragePercent,Ce.itemsQuoted,Ce.notes.join("; ")])],Oe=dt.aoa_to_sheet(Ee);dt.book_append_sheet(de,Oe,"Summary");const Me=[["Recommendations"],[],["Type","Supplier","Reason"],...i.recommendations.map(Ce=>[Ce.type.replace("_"," "),Ce.supplier.supplierName,Ce.reason])],We=dt.aoa_to_sheet(Me);dt.book_append_sheet(de,We,"Recommendations");const Ye=["System ID","System Label"],xt=i.suppliers.map(Ce=>Ce.supplierName);Ye.push(...xt);const jr=new Map;n.forEach(Ce=>{const rt=`${Ce.systemId}|${Ce.systemLabel}`;jr.has(rt)||jr.set(rt,new Map),jr.get(rt).set(Ce.supplier,Ce.unitRate)});const Ys=[Ye];jr.forEach((Ce,rt)=>{const[hr,wt]=rt.split("|"),fs=[hr,wt];xt.forEach(ue=>{const Ve=Ce.get(ue);fs.push(Ve!=null?Ve.toFixed(2):"")}),Ys.push(fs)});const Kt=dt.aoa_to_sheet(Ys);dt.book_append_sheet(de,Kt,"Matrix");const Ur=`${e}_AwardReport.xlsx`;ng(de,Ur)},C=()=>{fe()},he=async de=>{const Ee=U.get(de);if(!Ee){r==null||r("Quote not found","error");return}j(Ee);try{const We=await fetch("https://cbankidsdfsvsgfygbzt.supabase.co/functions/v1/approve_quote",{method:"POST",headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNiYW5raWRzZGZzdnNnZnlnYnp0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMzMTk3NDgsImV4cCI6MjA3ODg5NTc0OH0.SXgc-9ZamplKeJm5_nl8J2-UzO7A0f8KbAnPZEmsiSo","Content-Type":"application/json"},body:JSON.stringify({projectId:e,quoteId:Ee})}),Ye=await We.json();if(!We.ok)throw new Error(Ye.message||"Failed to approve quote");r==null||r(`Approved ${de}`,"success"),v&&y({...v,approved_quote_id:Ee}),await N()}catch(Oe){console.error("Error approving quote:",Oe),r==null||r(Oe.message||"Failed to approve quote","error")}finally{j(null)}},ve=()=>{if(!(v!=null&&v.approved_quote_id)){r==null||r("No approved quote selected","error");return}q(!0)},ke=async de=>{q(!1),X(!0);try{const Me=await fetch("https://cbankidsdfsvsgfygbzt.supabase.co/functions/v1/generate_base_tracker",{method:"POST",headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNiYW5raWRzZGZzdnNnZnlnYnp0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMzMTk3NDgsImV4cCI6MjA3ODg5NTc0OH0.SXgc-9ZamplKeJm5_nl8J2-UzO7A0f8KbAnPZEmsiSo","Content-Type":"application/json"},body:JSON.stringify({projectId:e,mode:de})}),We=await Me.json();if(!Me.ok)throw new Error(We.message||"Failed to generate base tracker");r==null||r(`Base Tracker created: ${We.rowsInserted} lines`,"success"),s&&s("base-tracker")}catch(Ee){console.error("Error generating base tracker:",Ee),r==null||r(Ee.message||"Failed to generate base tracker","error")}finally{X(!1)}};if(h)return l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsx("div",{className:"text-gray-500",children:"Loading award report..."})});if(G)return l.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center max-w-2xl mx-auto mt-12",children:[l.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:l.jsx(Dr,{className:"w-8 h-8 text-blue-600"})}),l.jsx("p",{className:"text-gray-900 text-lg font-semibold mb-2",children:"No Award Report Available"}),l.jsx("p",{className:"text-gray-600 mb-6",children:G}),l.jsxs("button",{onClick:le,disabled:h,className:"btn-primary disabled:opacity-50",children:[l.jsx(Ov,{className:"w-5 h-5"}),h?"Generating Report...":"Generate Award Report"]})]});if(!i||i.suppliers.length===0)return l.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center",children:[l.jsx("p",{className:"text-gray-500 text-lg",children:"No data available."}),l.jsx("p",{className:"text-gray-400 mt-2",children:"No report data found. Please generate a report from the Reports Hub."})]});const Ae=i.recommendations.find(de=>de.type==="BEST_VALUE"),me=i.recommendations.find(de=>de.type==="LOWEST_RISK"),Ke=i.recommendations.find(de=>de.type==="BALANCED");return l.jsxs("div",{id:"award-report-root","data-award-needs-project":"true",children:[l.jsx("style",{children:`
          @media print {
            body * {
              visibility: hidden;
            }
            #printable-report, #printable-report * {
              visibility: visible;
            }
            #printable-report {
              position: absolute;
              left: 0;
              top: 0;
              width: 100%;
            }
            .no-print {
              display: none !important;
            }
            .print-break {
              page-break-after: always;
            }
          }
        `}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"no-print flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Award Report"}),l.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Generated ",new Date(i.generatedAt).toLocaleString()]})]}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsxs("div",{className:"relative",ref:oe,children:[l.jsxs("button",{onClick:()=>g(!w),className:"flex items-center gap-2 px-3 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 transition-colors",children:[l.jsx(_S,{size:16}),l.jsx("span",{className:"text-sm",children:(v==null?void 0:v.name)||"Select Project"}),l.jsx(ho,{size:14,className:`transition-transform ${w?"rotate-180":""}`})]}),w&&l.jsx("div",{className:"absolute right-0 mt-2 w-64 bg-white rounded-lg shadow-lg border border-gray-200 z-50",children:l.jsx("div",{className:"p-2 max-h-80 overflow-y-auto",children:p.map(de=>l.jsxs("button",{onClick:()=>{g(!1),de.id!==e&&W(de.id)},className:`w-full text-left px-3 py-2 rounded-md text-sm hover:bg-gray-100 transition-colors ${de.id===e?"bg-blue-50 text-blue-900 font-medium":"text-gray-700"}`,children:[l.jsx("div",{className:"font-medium",children:de.name}),de.client&&l.jsx("div",{className:"text-xs text-gray-500",children:de.client})]},de.id))})})]}),l.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-blue-50 text-blue-800 rounded-md border border-blue-200",children:[l.jsx(Dr,{size:16}),l.jsxs("span",{className:"text-sm font-semibold",children:["Mode: ",d]})]}),l.jsx("button",{onClick:()=>f(d==="MODEL"?"PEER_MEDIAN":"MODEL"),className:"px-3 py-2 text-sm bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 transition-colors",children:"Toggle Mode"}),l.jsxs("button",{onClick:le,disabled:h,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[l.jsx(Dr,{size:18}),h?"Regenerating...":"Regenerate"]}),l.jsxs("button",{onClick:()=>se("pdf"),className:"flex items-center gap-2 px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors",children:[l.jsx(ix,{size:18}),"Export PDF"]}),l.jsxs("button",{onClick:()=>se("excel"),className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors",children:[l.jsx(kS,{size:18}),"Export Excel"]}),l.jsxs("button",{onClick:ve,disabled:!(v!=null&&v.approved_quote_id)||re,"data-testid":"btn-generate-base-tracker",className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[l.jsx(dF,{size:18}),re?"Creating...":"Create Base Tracker"]})]})]}),z&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 max-w-md w-full mx-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Create Base Tracker"}),l.jsx("p",{className:"text-sm text-gray-700 mb-6",children:"Choose how to generate the base tracker from the approved quote:"}),l.jsxs("div",{className:"space-y-3 mb-6",children:[l.jsxs("button",{onClick:()=>ke("replace"),className:"w-full text-left p-4 border-2 border-gray-300 rounded-lg hover:border-blue-500 hover:bg-blue-50 transition-colors",children:[l.jsx("div",{className:"font-semibold text-gray-900 mb-1",children:"Replace"}),l.jsx("div",{className:"text-sm text-gray-600",children:"Delete all existing base tracker items and create new ones from the approved quote"})]}),l.jsxs("button",{onClick:()=>ke("append"),className:"w-full text-left p-4 border-2 border-gray-300 rounded-lg hover:border-blue-500 hover:bg-blue-50 transition-colors",children:[l.jsx("div",{className:"font-semibold text-gray-900 mb-1",children:"Append"}),l.jsx("div",{className:"text-sm text-gray-600",children:"Keep existing base tracker items and add new ones from the approved quote"})]})]}),l.jsx("div",{className:"flex gap-3 justify-end",children:l.jsx("button",{onClick:()=>q(!1),className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 transition-colors",children:"Cancel"})})]})}),_&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 max-w-md w-full mx-4",children:[l.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Export ",k==="pdf"?"PDF":"Excel"," Report"]}),l.jsxs("div",{className:"mb-4",children:[l.jsxs("p",{className:"text-sm text-gray-700 mb-2",children:[l.jsx("strong",{children:"Filename:"})," ",e,"_AwardReport.",k==="pdf"?"pdf":"xlsx"]}),l.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-3",children:[l.jsx("p",{className:"text-xs font-semibold text-blue-900 mb-1",children:"Suggested Save Location:"}),l.jsx("p",{className:"text-sm text-blue-800 font-mono break-all",children:I()})]})]}),l.jsx("p",{className:"text-sm text-gray-600 mb-6",children:k==="pdf"?"The report will open in your browser's print dialog. Save as PDF from there.":"The Excel file will be downloaded to your default downloads folder."}),l.jsxs("div",{className:"flex gap-3 justify-end",children:[l.jsx("button",{onClick:()=>b(!1),className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 transition-colors",children:"Cancel"}),l.jsx("button",{onClick:ne,className:`px-4 py-2 text-white rounded-md transition-colors ${k==="pdf"?"bg-gray-600 hover:bg-gray-700":"bg-green-600 hover:bg-green-700"}`,children:"Continue"})]})]})}),l.jsx("div",{id:"printable-report",ref:K,children:l.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-8",children:[l.jsxs("div",{className:"text-center mb-8 print:mb-6",children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Award Recommendation Report"}),l.jsx("p",{className:"text-gray-600",children:"Project Analysis & Supplier Evaluation"}),l.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:[new Date().toLocaleDateString()," | ",i.totalSystems," Systems | ",i.equalisationMode," Mode"]})]}),l.jsxs("div",{className:"grid grid-cols-3 gap-6 mb-8 print:mb-6",children:[l.jsxs("div",{className:"p-6 bg-gradient-to-br from-blue-50 to-blue-100 rounded-lg border-2 border-blue-300",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[l.jsx(Ov,{className:"text-blue-600",size:28}),l.jsx("h3",{className:"text-sm font-semibold text-blue-900 uppercase",children:"Best Value"})]}),Ae&&l.jsxs(l.Fragment,{children:[l.jsx("p",{className:"text-2xl font-bold text-blue-900",children:Ae.supplier.supplierName}),l.jsxs("p",{className:"text-lg text-blue-800 mt-1",children:["$",Ae.supplier.adjustedTotal.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),l.jsx("p",{className:"text-sm text-blue-700 mt-2",children:Ae.reason})]})]}),l.jsxs("div",{className:"p-6 bg-gradient-to-br from-green-50 to-green-100 rounded-lg border-2 border-green-300",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[l.jsx(a0,{className:"text-green-600",size:28}),l.jsx("h3",{className:"text-sm font-semibold text-green-900 uppercase",children:"Lowest Risk"})]}),me&&l.jsxs(l.Fragment,{children:[l.jsx("p",{className:"text-2xl font-bold text-green-900",children:me.supplier.supplierName}),l.jsxs("p",{className:"text-lg text-green-800 mt-1",children:["Risk Score: ",me.supplier.riskScore.toFixed(1)]}),l.jsx("p",{className:"text-sm text-green-700 mt-2",children:me.reason})]})]}),l.jsxs("div",{className:"p-6 bg-gradient-to-br from-purple-50 to-purple-100 rounded-lg border-2 border-purple-300",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[l.jsx(ox,{className:"text-purple-600",size:28}),l.jsx("h3",{className:"text-sm font-semibold text-purple-900 uppercase",children:"Balanced"})]}),Ke&&l.jsxs(l.Fragment,{children:[l.jsx("p",{className:"text-2xl font-bold text-purple-900",children:Ke.supplier.supplierName}),l.jsxs("p",{className:"text-lg text-purple-800 mt-1",children:["$",Ke.supplier.adjustedTotal.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),l.jsx("p",{className:"text-sm text-purple-700 mt-2",children:Ke.reason})]})]})]}),c&&l.jsxs("div",{className:"mb-8 print:mb-6 bg-gradient-to-br from-amber-50 to-yellow-50 rounded-lg border-2 border-amber-200 p-6",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[l.jsx("div",{className:"p-2 bg-amber-100 rounded-lg",children:l.jsx("svg",{className:"w-6 h-6 text-amber-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})})}),l.jsx("h2",{className:"text-xl font-bold text-amber-900",children:"AI Analysis & Insights"})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[l.jsxs("div",{className:"bg-white rounded-lg p-4 border border-amber-200",children:[l.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Items Compared"}),l.jsx("div",{className:"text-2xl font-bold text-gray-900",children:c.totalItemsCompared||0})]}),l.jsxs("div",{className:"bg-white rounded-lg p-4 border border-amber-200",children:[l.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Matched Items"}),l.jsx("div",{className:"text-2xl font-bold text-green-600",children:c.matchedItems||0})]}),l.jsxs("div",{className:"bg-white rounded-lg p-4 border border-amber-200",children:[l.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Unmatched Items"}),l.jsx("div",{className:"text-2xl font-bold text-blue-600",children:c.unmatchedItems||0})]})]}),c.priceVariances&&l.jsxs("div",{className:"bg-white rounded-lg p-4 border border-amber-200 mb-3",children:[l.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Price Variances"}),l.jsx("p",{className:"text-sm text-gray-700",children:c.priceVariances})]}),c.scopeGaps&&l.jsxs("div",{className:"bg-white rounded-lg p-4 border border-amber-200 mb-3",children:[l.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Scope Gaps"}),l.jsx("p",{className:"text-sm text-gray-700",children:c.scopeGaps})]}),c.recommendations&&l.jsxs("div",{className:"bg-white rounded-lg p-4 border border-amber-200",children:[l.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"AI Recommendations"}),l.jsx("p",{className:"text-sm text-gray-700",children:c.recommendations})]})]}),l.jsxs("div",{className:"mb-8 print:mb-6",children:[l.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Executive Summary"}),l.jsxs("div",{className:"prose prose-sm max-w-none text-gray-700",children:[l.jsxs("p",{className:"mb-3",children:["Analysis of ",i.suppliers.length," supplier quotes covering ",i.totalSystems," passive fire protection systems. Equalisation performed using ",l.jsx("strong",{children:i.equalisationMode})," methodology to ensure fair comparison."]}),l.jsx("p",{children:"The evaluation considers both financial value and risk factors including price variance from model rates, scope coverage completeness, and data quality. Three recommendations are provided based on different prioritization strategies."})]})]}),l.jsxs("div",{className:"mb-8 print:mb-6",children:[l.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Supplier Comparison"}),l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full border-collapse text-sm",children:[l.jsx("thead",{children:l.jsxs("tr",{className:"bg-gray-50",children:[l.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700 border border-gray-300",children:"Supplier"}),l.jsx("th",{className:"px-4 py-3 text-right font-semibold text-gray-700 border border-gray-300",children:"Adjusted Total"}),l.jsx("th",{className:"px-4 py-3 text-right font-semibold text-gray-700 border border-gray-300",children:"Risk Score"}),l.jsx("th",{className:"px-4 py-3 text-right font-semibold text-gray-700 border border-gray-300",children:"Coverage"}),l.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700 border border-gray-300",children:"Notes"}),l.jsx("th",{className:"px-4 py-3 text-center font-semibold text-gray-700 border border-gray-300 no-print",children:"Actions"})]})}),l.jsx("tbody",{children:i.suppliers.map((de,Ee)=>{const Oe=U.get(de.supplierName),Me=(v==null?void 0:v.approved_quote_id)===Oe,We=T===Oe;return l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsxs("td",{className:"px-4 py-3 font-semibold text-gray-900 border border-gray-300",children:[de.supplierName,Me&&l.jsx("span",{className:"ml-2 inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-green-100 text-green-800",children:"Approved"})]}),l.jsxs("td",{className:"px-4 py-3 text-right text-gray-900 border border-gray-300",children:["$",de.adjustedTotal.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),l.jsx("td",{className:`px-4 py-3 text-right font-semibold border border-gray-300 ${de.riskScore<=2?"text-green-700":de.riskScore<=5?"text-amber-700":"text-red-700"}`,children:de.riskScore.toFixed(1)}),l.jsxs("td",{className:"px-4 py-3 text-right text-gray-900 border border-gray-300",children:[de.coveragePercent.toFixed(0),"%",l.jsxs("span",{className:"text-xs text-gray-600 ml-1",children:["(",de.itemsQuoted,"/",de.totalItems,")"]})]}),l.jsx("td",{className:"px-4 py-3 text-gray-700 border border-gray-300",children:l.jsx("ul",{className:"text-xs space-y-0.5",children:de.notes.slice(0,3).map((Ye,xt)=>l.jsxs("li",{children:[" ",Ye]},xt))})}),l.jsx("td",{className:"px-4 py-3 border border-gray-300 no-print",children:l.jsx("div",{className:"flex items-center justify-center gap-2",children:!Me&&l.jsxs("button",{onClick:()=>he(de.supplierName),disabled:We,"data-testid":"btn-approve-quote",className:"flex items-center gap-1.5 px-3 py-1.5 bg-blue-600 text-white text-xs font-medium rounded hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[l.jsx(Vs,{size:14}),We?"Processing...":"Approve"]})})})]},Ee)})})]})})]}),n.length>0&&l.jsxs("div",{className:"mb-8 print:mb-6",children:[l.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Itemized Comparison"}),l.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Line-by-line comparison of all items across ",i.suppliers.length," suppliers"]}),l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full border-collapse text-xs",children:[l.jsxs("thead",{children:[l.jsxs("tr",{className:"bg-gray-50",children:[l.jsx("th",{className:"px-3 py-2 text-left font-semibold text-gray-700 border border-gray-300 sticky left-0 bg-gray-50 z-10",children:"Item Description"}),l.jsx("th",{className:"px-3 py-2 text-center font-semibold text-gray-700 border border-gray-300",children:"Qty"}),l.jsx("th",{className:"px-3 py-2 text-center font-semibold text-gray-700 border border-gray-300",children:"Unit"}),i.suppliers.map((de,Ee)=>l.jsx("th",{colSpan:2,className:"px-3 py-2 text-center font-semibold text-gray-700 border border-gray-300 bg-blue-50",children:de.supplierName},Ee))]}),l.jsxs("tr",{className:"bg-gray-50",children:[l.jsx("th",{className:"px-3 py-2 border border-gray-300 sticky left-0 bg-gray-50 z-10"}),l.jsx("th",{className:"px-3 py-2 border border-gray-300"}),l.jsx("th",{className:"px-3 py-2 border border-gray-300"}),i.suppliers.map((de,Ee)=>l.jsxs(l.Fragment,{children:[l.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-600 border border-gray-300 bg-blue-50",children:"Unit Rate"},`${Ee}-rate`),l.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-600 border border-gray-300 bg-blue-50",children:"Total"},`${Ee}-total`)]}))]})]}),l.jsx("tbody",{children:n.map((de,Ee)=>{const Oe=de.matchStatus==="unmatched";return l.jsxs("tr",{className:`hover:bg-gray-50 ${Oe?"bg-amber-50":""}`,children:[l.jsxs("td",{className:"px-3 py-2 text-gray-900 border border-gray-300 sticky left-0 bg-white z-10",children:[l.jsx("div",{className:"font-medium",children:de.description}),de.notes&&l.jsx("div",{className:"text-xs text-amber-600 mt-1",children:de.notes})]}),l.jsx("td",{className:"px-3 py-2 text-center text-gray-700 border border-gray-300",children:de.quantity}),l.jsx("td",{className:"px-3 py-2 text-center text-gray-700 border border-gray-300",children:de.unit}),i.suppliers.map((Me,We)=>{const Ye=de.suppliers[Me.supplierName],xt=Ye&&Ye.unitPrice!==null;return l.jsxs(l.Fragment,{children:[l.jsx("td",{className:`px-3 py-2 text-right border border-gray-300 ${xt?"":"bg-gray-100 text-gray-400"}`,children:xt?`$${Ye.unitPrice.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}`:"N/A"},`${We}-rate`),l.jsx("td",{className:`px-3 py-2 text-right font-medium border border-gray-300 ${xt?"":"bg-gray-100 text-gray-400"}`,children:xt?`$${Ye.total.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}`:"N/A"},`${We}-total`)]})})]},Ee)})}),l.jsx("tfoot",{className:"bg-gray-50",children:l.jsxs("tr",{className:"font-bold",children:[l.jsx("td",{colSpan:3,className:"px-3 py-3 text-right text-gray-900 border border-gray-300",children:"Subtotals:"}),i.suppliers.map((de,Ee)=>l.jsxs(l.Fragment,{children:[l.jsx("td",{className:"border border-gray-300"},`${Ee}-spacer`),l.jsxs("td",{className:"px-3 py-3 text-right text-gray-900 border border-gray-300",children:["$",de.adjustedTotal.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]},`${Ee}-total`)]}))]})})]})})]}),l.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[l.jsx("h2",{className:"text-lg font-bold text-gray-900 mb-3",children:"Risk Scoring Methodology"}),l.jsxs("div",{className:"text-xs text-gray-600 space-y-1",children:[l.jsxs("p",{children:[" ",l.jsx("strong",{children:"+1 point"})," per RED variance cell (>20% from model rate)"]}),l.jsxs("p",{children:[" ",l.jsx("strong",{children:"+0.5 points"})," per AMBER variance cell (10-20% from model rate)"]}),l.jsxs("p",{children:[" ",l.jsx("strong",{children:"+1 point"})," per missing scope item requiring equalisation"]}),l.jsxs("p",{children:[" ",l.jsx("strong",{children:"+1 point"})," if >10% of items have low mapping confidence (<0.7)"]})]})]})]})})]})]})}function YV(e){const[t,r]=F.useState("hub"),[s,n]=F.useState(null),a=(o,c)=>{r(o)},i=()=>{r("hub"),n(null)};return t==="award-report"?l.jsx(XV,{projectId:e.projectId,reportId:s||void 0,onNavigate:i}):l.jsx(KV,{...e,onNavigate:o=>a(o)})}function JV({projectId:e}){return l.jsxs("div",{className:"p-8",children:[l.jsx(l0,{title:"Insights Dashboard",description:"AI-powered insights and analytics"}),l.jsx("div",{className:"mt-6 p-6 bg-white rounded-lg border border-gray-200",children:l.jsx("p",{className:"text-gray-600",children:"Insights Dashboard - Analytics and intelligence coming soon"})})]})}function QV({onNavigateToTemplates:e}){return l.jsxs("div",{className:"p-8 max-w-7xl mx-auto",children:[l.jsxs("div",{className:"mb-8",children:[l.jsx("h1",{className:"text-3xl font-semibold brand-navy mb-2",children:"library.pageTitle"}),l.jsx("p",{className:"text-gray-600 text-base",children:"library.pageSubtitle"})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[l.jsx("button",{onClick:e,className:"bg-white rounded-xl shadow-sm border border-gray-200 p-8 hover:shadow-md hover:border-gray-300 transition-all text-left group",children:l.jsxs("div",{className:"flex items-start gap-4",children:[l.jsx("div",{className:"w-14 h-14 bg-blue-50 rounded-xl flex items-center justify-center flex-shrink-0 group-hover:bg-blue-100 transition-colors",children:l.jsx(Dr,{className:"w-7 h-7 text-blue-600"})}),l.jsxs("div",{className:"flex-1",children:[l.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2 group-hover:text-blue-600 transition-colors",children:"library.cards.projectTemplates.title"}),l.jsx("p",{className:"text-gray-600 text-sm leading-relaxed",children:"library.cards.projectTemplates.body"})]})]})}),l.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-8 opacity-50 cursor-not-allowed",children:l.jsxs("div",{className:"flex items-start gap-4",children:[l.jsx("div",{className:"w-14 h-14 bg-gray-100 rounded-xl flex items-center justify-center flex-shrink-0",children:l.jsx(gF,{className:"w-7 h-7 text-gray-400"})}),l.jsxs("div",{className:"flex-1",children:[l.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"library.cards.forms.title"}),l.jsx("p",{className:"text-gray-600 text-sm leading-relaxed",children:"library.cards.forms.body"})]})]})})]})]})}function ZV(){return null}function ez({onBack:e,onNavigateToNewProject:t}){const[r,s]=F.useState([]),[n,a]=F.useState(!0),[i,o]=F.useState(!1),[c,u]=F.useState(null),[d,f]=F.useState(!1),[h,m]=F.useState(null),[p,x]=F.useState(null);F.useEffect(()=>{v()},[]),F.useEffect(()=>{if(p){const b=setTimeout(()=>x(null),5e3);return()=>clearTimeout(b)}},[p]);const v=async()=>{a(!0);try{const{data:b,error:k}=await pe.from("project_templates").select("*").order("updated_at",{ascending:!1});if(k)throw k;s(b||[])}catch(b){console.error("Error loading templates:",b),x({type:"error",message:"projectTemplates.toasts.loadError"})}finally{a(!1)}},y=b=>{m(b),f(!0)},w=async()=>{if(h)try{const{error:b}=await pe.from("project_templates").delete().eq("id",h.id);if(b)throw b;x({type:"success",message:Vu("projectTemplates.toasts.deleteSuccess",{templateName:h.name})}),await v()}catch(b){console.error("Error deleting template:",b),x({type:"error",message:"projectTemplates.toasts.loadError"})}finally{f(!1),m(null)}},g=async b=>{var k,S;try{const{data:T}=await pe.auth.getSession(),j=(S=(k=T==null?void 0:T.session)==null?void 0:k.user)==null?void 0:S.id;if(!j){x({type:"error",message:"You must be logged in to duplicate templates"});return}const U=`${b.name} (Copy)`,{error:H}=await pe.from("project_templates").insert({name:U,description:b.description,trade:b.trade,is_default:!1,created_by_user_id:j,project_settings:b.project_settings,analysis_settings:b.analysis_settings,report_settings:b.report_settings,compliance_settings:b.compliance_settings});if(H)throw H;x({type:"success",message:Vu("projectTemplates.toasts.duplicateSuccess",{newTemplateName:U})}),await v()}catch(T){console.error("Error duplicating template:",T),x({type:"error",message:"projectTemplates.toasts.loadError"})}},_=b=>new Date(b).toLocaleDateString("en-NZ",{day:"numeric",month:"short",year:"numeric"});return n?l.jsx("div",{className:"p-8",children:l.jsx("div",{className:"flex items-center justify-center py-12",children:l.jsx("div",{className:"text-gray-600",children:"Loading templates..."})})}):l.jsxs("div",{className:"p-8 max-w-7xl mx-auto",children:[p&&l.jsx("div",{className:`mb-4 p-4 rounded-lg ${p.type==="success"?"bg-green-50 text-green-800 border border-green-200":"bg-red-50 text-red-800 border border-red-200"}`,children:p.message}),l.jsxs("div",{className:"mb-6",children:[l.jsxs("button",{onClick:e,className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 mb-4 transition-colors",children:[l.jsx(nx,{size:20}),l.jsx("span",{className:"text-sm font-medium",children:"projectTemplates.backToLibrary"})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-10 h-10 bg-blue-50 rounded-lg flex items-center justify-center",children:l.jsx(Dr,{className:"w-5 h-5 text-blue-600"})}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-semibold brand-navy",children:"projectTemplates.pageTitle"}),l.jsx("p",{className:"text-gray-600 text-base",children:"projectTemplates.pageSubtitle"})]})]}),l.jsxs("button",{onClick:()=>{u(null),o(!0)},className:"flex items-center gap-2 px-4 py-2 bg-brand-primary text-white rounded-lg hover:bg-blue-600 transition-colors font-medium text-sm",children:[l.jsx($u,{size:18}),"projectTemplates.newTemplateButton"]})]})]}),r.length===0?l.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-12 text-center",children:l.jsxs("div",{className:"max-w-md mx-auto",children:[l.jsx("div",{className:"w-16 h-16 bg-gray-50 rounded-xl flex items-center justify-center mx-auto mb-4",children:l.jsx(Dr,{size:32,className:"text-gray-400"})}),l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"projectTemplates.emptyState.title"}),l.jsx("p",{className:"text-gray-600 text-sm mb-6 leading-relaxed",children:"projectTemplates.emptyState.body"}),l.jsxs("button",{onClick:()=>{u(null),o(!0)},className:"inline-flex items-center gap-2 px-4 py-2 bg-brand-primary text-white rounded-lg hover:bg-blue-600 transition-colors font-medium text-sm",children:[l.jsx($u,{size:18}),"projectTemplates.emptyState.button"]})]})}):l.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full",children:[l.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"projectTemplates.table.columns.template"}),l.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"projectTemplates.table.columns.trade"}),l.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"projectTemplates.table.columns.description"}),l.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"projectTemplates.table.columns.lastUpdated"}),l.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"projectTemplates.table.columns.actions"})]})}),l.jsx("tbody",{className:"divide-y divide-gray-200",children:r.map(b=>l.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[l.jsx("td",{className:"px-6 py-4",children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"font-medium text-gray-900",children:b.name}),b.is_default&&l.jsx("span",{className:"px-2 py-0.5 bg-blue-100 text-blue-700 text-xs font-medium rounded-full",children:"Default"})]})}),l.jsx("td",{className:"px-6 py-4",children:l.jsx("span",{className:"text-sm text-gray-700",children:b.trade})}),l.jsx("td",{className:"px-6 py-4",children:l.jsx("span",{className:"text-sm text-gray-600 line-clamp-2",children:b.description||""})}),l.jsx("td",{className:"px-6 py-4",children:l.jsx("span",{className:"text-sm text-gray-600",children:_(b.updated_at)})}),l.jsx("td",{className:"px-6 py-4",children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{onClick:()=>t==null?void 0:t(),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"projectTemplates.table.rowActions.applyToNewProject",children:l.jsx($u,{size:16})}),l.jsx("button",{onClick:()=>{u(b),o(!0)},className:"p-2 text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",title:"projectTemplates.table.rowActions.edit",children:l.jsx(jF,{size:16})}),l.jsx("button",{onClick:()=>g(b),className:"p-2 text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",title:"projectTemplates.table.rowActions.duplicate",children:l.jsx(fF,{size:16})}),l.jsx("button",{onClick:()=>y(b),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"projectTemplates.table.rowActions.delete",children:l.jsx(Yl,{size:16})})]})})]},b.id))})]})})}),i&&l.jsx(ZV,{template:c,onClose:()=>{o(!1),u(null)},onSave:b=>{x({type:"success",message:c?"projectTemplates.toasts.updateSuccess":"projectTemplates.toasts.createSuccess"}),v()}}),d&&h&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:l.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full",children:[l.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:l.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"projectTemplates.deleteDialog.title"})}),l.jsx("div",{className:"px-6 py-4",children:l.jsx("p",{className:"text-gray-700",children:Vu("projectTemplates.deleteDialog.body",{templateName:h.name})})}),l.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex items-center justify-end gap-3",children:[l.jsx("button",{onClick:()=>{f(!1),m(null)},className:"px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg transition-colors font-medium text-sm",children:"projectTemplates.deleteDialog.cancel"}),l.jsx("button",{onClick:w,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors font-medium text-sm",children:"projectTemplates.deleteDialog.confirm"})]})]})})]})}function VT(){const[e,t]=F.useState(!1),[r,s]=F.useState(null),[n,a]=F.useState(null),[i,o]=F.useState(null),[c,u]=F.useState(!1);F.useEffect(()=>{d()},[]);const d=async()=>{u(!0);try{const y=await fetch("https://cbankidsdfsvsgfygbzt.supabase.co/functions/v1/test_openai_connection",{method:"POST",headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNiYW5raWRzZGZzdnNnZnlnYnp0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMzMTk3NDgsImV4cCI6MjA3ODg5NTc0OH0.SXgc-9ZamplKeJm5_nl8J2-UzO7A0f8KbAnPZEmsiSo","Content-Type":"application/json"}});if(y.ok){const w=await y.json();o(w)}else o({ok:!1,error:"Failed to check OpenAI connection"})}catch{o({ok:!1,error:"Network error while checking OpenAI connection"})}finally{u(!1)}},f=async x=>{t(!0),a(null);try{const w=await fetch("https://cbankidsdfsvsgfygbzt.supabase.co/functions/v1/verify_installation",{method:"POST",headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNiYW5raWRzZGZzdnNnZnlnYnp0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMzMTk3NDgsImV4cCI6MjA3ODg5NTc0OH0.SXgc-9ZamplKeJm5_nl8J2-UzO7A0f8KbAnPZEmsiSo","Content-Type":"application/json"},body:JSON.stringify({autoFix:x})});if(!w.ok)throw new Error("Failed to run system check");const g=await w.json();s(g)}catch(v){a(v.message||"An error occurred while running the system check")}finally{t(!1)}},h=x=>{switch(x){case"pass":return l.jsx("span",{className:"text-2xl",children:""});case"fixed":return l.jsx("span",{className:"text-2xl",children:""});case"fail":return l.jsx("span",{className:"text-2xl",children:""})}},m=x=>{switch(x){case"pass":return"Pass";case"fixed":return"Fixed";case"fail":return"Fail"}},p=x=>new Date(x).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"});return l.jsxs("div",{className:"space-y-6 px-8 py-6",children:[l.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:l.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-6",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-semibold brand-navy mb-2",children:"Verify+ System Audit"}),l.jsx("p",{className:"text-gray-600 text-base",children:"Comprehensive system health check and automatic issue resolution"})]}),l.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[l.jsx("button",{onClick:()=>f(!1),disabled:e,className:"flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:bg-gray-300 disabled:text-gray-500 disabled:cursor-not-allowed font-medium text-sm",children:e?l.jsxs(l.Fragment,{children:[l.jsx(is,{size:18,className:"animate-spin"}),"Running..."]}):l.jsxs(l.Fragment,{children:[l.jsx(ff,{size:18}),"Run Check"]})}),l.jsx("button",{onClick:()=>f(!0),disabled:e,className:"flex items-center justify-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed font-medium text-sm",children:e?l.jsxs(l.Fragment,{children:[l.jsx(is,{size:18,className:"animate-spin"}),"Running..."]}):l.jsxs(l.Fragment,{children:[l.jsx(hf,{size:18}),"Run & Auto-Fix"]})})]})]})}),l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[l.jsxs("div",{className:"flex items-start justify-between mb-6",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-10 h-10 bg-blue-50 rounded-lg flex items-center justify-center flex-shrink-0",children:l.jsx(_F,{className:"text-blue-600",size:20})}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"OpenAI API Configuration"}),l.jsx("p",{className:"text-sm text-gray-600 mt-0.5",children:"Required for Verify+ Copilot functionality"})]})]}),l.jsxs("button",{onClick:d,disabled:c,className:"flex items-center gap-2 px-3 py-1.5 text-sm bg-white text-blue-700 rounded-full hover:bg-blue-50 transition-colors disabled:opacity-50 font-medium border border-blue-200",children:[l.jsx(is,{size:14,className:c?"animate-spin":""}),"Recheck"]})]}),c&&l.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[l.jsx(is,{size:16,className:"animate-spin"}),l.jsx("span",{className:"text-sm",children:"Checking OpenAI connection..."})]}),!c&&i&&l.jsx("div",{className:`rounded-lg p-4 ${i.ok?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"}`,children:l.jsxs("div",{className:"flex items-start gap-3",children:[l.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 ${i.ok?"bg-green-100":"bg-red-100"}`,children:i.ok?l.jsx(Qh,{className:"text-green-600",size:18}):l.jsx(vt,{className:"text-red-600",size:18})}),l.jsxs("div",{className:"flex-1",children:[l.jsx("h4",{className:`font-semibold text-sm mb-1 ${i.ok?"text-green-900":"text-red-900"}`,children:i.ok?"Connected":"Not Configured"}),l.jsx("p",{className:`text-xs mb-2 ${i.ok?"text-green-700":"text-red-700"}`,children:i.message||i.error||"Unknown status"}),i.ok&&l.jsxs("div",{className:"text-xs text-green-700 space-y-1 mt-2",children:[l.jsxs("div",{children:["Models available: ",l.jsx("span",{className:"font-semibold",children:i.modelCount})]}),l.jsxs("div",{children:["GPT-4 access: ",l.jsx("span",{className:"font-semibold",children:i.gpt4Available?"Yes":"No"})]})]}),!i.ok&&l.jsxs("div",{className:"mt-3 p-4 bg-white rounded-lg border border-red-200",children:[l.jsx("p",{className:"text-sm text-red-900 font-semibold mb-3",children:"Setup Instructions:"}),l.jsxs("ol",{className:"text-sm text-red-800 space-y-2 list-decimal list-inside",children:[l.jsx("li",{children:"Go to Supabase Dashboard"}),l.jsx("li",{children:"Navigate to Project Settings  Edge Functions  Secrets"}),l.jsxs("li",{children:["Add a new secret named ",l.jsx("code",{className:"bg-red-100 px-2 py-0.5 rounded font-mono text-xs",children:"OPENAI_API_KEY"})]}),l.jsx("li",{children:"Paste your OpenAI API key as the value"}),l.jsx("li",{children:'Click "Recheck" above to verify'})]})]})]})]})})]}),n&&l.jsx("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4",children:l.jsxs("div",{className:"flex items-start gap-3",children:[l.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-full flex items-center justify-center flex-shrink-0",children:l.jsx(vt,{className:"text-red-600",size:18})}),l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold text-red-900 mb-1 text-sm",children:"Error"}),l.jsx("p",{className:"text-red-700 text-xs",children:n})]})]})}),r&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[l.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-5",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("div",{className:"text-xs font-semibold text-gray-600 mb-2 uppercase",children:"Passed"}),l.jsx("div",{className:"text-2xl font-bold text-green-600",children:r.passed})]}),l.jsx("div",{className:"w-12 h-12 bg-green-50 rounded-lg flex items-center justify-center",children:l.jsx(Qh,{size:24,className:"text-green-600"})})]})}),l.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-5",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("div",{className:"text-xs font-semibold text-gray-600 mb-2 uppercase",children:"Failed"}),l.jsx("div",{className:"text-2xl font-bold text-red-600",children:r.failed})]}),l.jsx("div",{className:"w-12 h-12 bg-red-50 rounded-lg flex items-center justify-center",children:l.jsx(vt,{size:24,className:"text-red-600"})})]})}),l.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-5",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("div",{className:"text-xs font-semibold text-gray-600 mb-2 uppercase",children:"Fixed"}),l.jsx("div",{className:"text-2xl font-bold text-amber-600",children:r.fixed})]}),l.jsx("div",{className:"w-12 h-12 bg-amber-50 rounded-lg flex items-center justify-center",children:l.jsx(hf,{size:24,className:"text-amber-600"})})]})})]}),r.failed>0&&l.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-xl p-4",children:l.jsxs("div",{className:"flex items-start gap-3",children:[l.jsx("div",{className:"w-8 h-8 bg-amber-100 rounded-full flex items-center justify-center flex-shrink-0",children:l.jsx(vt,{className:"text-amber-600",size:18})}),l.jsxs("div",{children:[l.jsxs("h3",{className:"font-semibold text-amber-900 mb-1 text-sm",children:[r.failed," check",r.failed!==1?"s":""," failed"]}),l.jsx("p",{className:"text-amber-700 text-xs",children:"Run & Auto-Fix recommended to resolve these issues automatically"})]})]})}),l.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full",children:[l.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Area"}),l.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Name"}),l.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Status"}),l.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Detail"}),l.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Fix Hint"})]})}),l.jsx("tbody",{className:"divide-y divide-gray-200",children:r.checks.map((x,v)=>l.jsxs("tr",{className:`hover:bg-gray-50 transition-colors ${x.status==="fail"?"bg-red-50":""}`,children:[l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:x.area}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:x.name}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsxs("div",{className:"flex items-center gap-2",children:[h(x.status),l.jsx("span",{className:`text-sm font-medium ${x.status==="pass"?"text-green-700":x.status==="fixed"?"text-amber-700":"text-red-700"}`,children:m(x.status)})]})}),l.jsx("td",{className:"px-6 py-4 text-sm text-gray-700",children:x.detail}),l.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:x.fixHint||"-"})]},v))})]})})}),l.jsx("div",{className:"bg-gray-50 rounded-xl border border-gray-200 px-6 py-4",children:l.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 text-sm",children:[l.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[l.jsx(ax,{size:16}),l.jsxs("span",{children:["Last check: ",p(r.timestamp)]})]}),l.jsx("div",{className:"text-gray-500 font-medium",children:"PassiveFire Verify+ v1.0.0"})]})})]}),!r&&!e&&!n&&l.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-12 text-center",children:l.jsxs("div",{className:"max-w-md mx-auto",children:[l.jsx("div",{className:"w-16 h-16 bg-blue-50 rounded-xl flex items-center justify-center mx-auto mb-4",children:l.jsx(ff,{size:32,className:"text-blue-600"})}),l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Ready to Check System Health"}),l.jsx("p",{className:"text-gray-600 text-sm mb-6 leading-relaxed",children:"Run a comprehensive system audit to verify your installation and identify any issues. Use Auto-Fix to automatically resolve common problems."}),l.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 justify-center",children:[l.jsxs("button",{onClick:()=>f(!1),className:"flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium text-sm",children:[l.jsx(ff,{size:18}),"Run Check"]}),l.jsxs("button",{onClick:()=>f(!0),className:"flex items-center justify-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors font-medium text-sm",children:[l.jsx(hf,{size:18}),"Run & Auto-Fix"]})]})]})})]})}function zT(){const[e,t]=F.useState([]),[r,s]=F.useState(!0),[n,a]=F.useState(new Set),[i,o]=F.useState("all"),c=async()=>{s(!0);try{let p=pe.from("copilot_audit").select("*").order("ts",{ascending:!1}).limit(100);i==="success"?p=p.eq("result_ok",!0):i==="failed"&&(p=p.eq("result_ok",!1));const{data:x,error:v}=await p;if(v){console.error("Error loading audit logs:",v);return}t(x||[])}finally{s(!1)}};F.useEffect(()=>{c()},[i]);const u=p=>{a(x=>{const v=new Set(x);return v.has(p)?v.delete(p):v.add(p),v})},d=p=>new Date(p).toLocaleString(),f=p=>p.includes("verify")?"bg-blue-50 text-blue-700 border-blue-200":p.includes("compute")?"bg-purple-50 text-purple-700 border-purple-200":p.includes("approve")?"bg-green-50 text-green-700 border-green-200":p.includes("generate")?"bg-amber-50 text-amber-700 border-amber-200":"bg-gray-100 text-gray-700 border-gray-200",h=p=>p==="owner"?"bg-red-50 text-red-700 border-red-200":p==="estimator"?"bg-orange-50 text-blue-700 border-orange-200":"bg-gray-100 text-gray-700 border-gray-200",m=e;return l.jsxs("div",{className:"space-y-6 p-6",children:[l.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-bold brand-navy mb-2",children:"Copilot Audit Logs"}),l.jsx("p",{className:"text-gray-600",children:"Last 100 Copilot actions for this project"})]}),l.jsxs("button",{onClick:c,disabled:r,className:"flex items-center justify-center gap-2 px-4 py-2 bg-blue-50 text-blue-700 rounded-lg hover:bg-blue-100 transition-colors disabled:opacity-50 font-medium border border-blue-100",children:[l.jsx(is,{size:18,className:r?"animate-spin":""}),l.jsx("span",{children:"Refresh"})]})]}),l.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4",children:l.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[l.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[l.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Filter:"}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{onClick:()=>o("all"),className:`px-4 py-2 rounded-full text-sm font-medium transition-colors ${i==="all"?"bg-brand-primary text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"All"}),l.jsx("button",{onClick:()=>o("success"),className:`px-4 py-2 rounded-full text-sm font-medium transition-colors ${i==="success"?"bg-green-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Success"}),l.jsx("button",{onClick:()=>o("failed"),className:`px-4 py-2 rounded-full text-sm font-medium transition-colors ${i==="failed"?"bg-red-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Failed"})]})]}),l.jsxs("div",{className:"text-sm text-gray-600 font-medium",children:["Showing ",m.length," log",m.length!==1?"s":""]})]})}),r?l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-12 text-center",children:[l.jsx(is,{className:"animate-spin mx-auto mb-4 text-blue-600",size:48}),l.jsx("p",{className:"text-gray-600",children:"Loading audit logs..."})]}):m.length===0?l.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-12 text-center",children:l.jsx("p",{className:"text-gray-600",children:"No audit logs found"})}):l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full",children:[l.jsx("thead",{children:l.jsxs("tr",{className:"bg-gray-50 border-b border-gray-200",children:[l.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(ax,{size:14}),l.jsx("span",{children:"Time"})]})}),l.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(lx,{size:14}),l.jsx("span",{children:"User"})]})}),l.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Role"}),l.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Tool"}),l.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Status"}),l.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Details"})]})}),l.jsx("tbody",{className:"divide-y divide-gray-200",children:m.map(p=>l.jsxs(fo.tr,{initial:{opacity:0},animate:{opacity:1},className:"hover:bg-gray-50 transition-colors",children:[l.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:d(p.ts)}),l.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:p.user_email}),l.jsx("td",{className:"px-6 py-4",children:l.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-medium border ${h(p.role)}`,children:p.role})}),l.jsx("td",{className:"px-6 py-4",children:l.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-medium border ${f(p.tool_name)}`,children:p.tool_name})}),l.jsx("td",{className:"px-6 py-4",children:p.result_ok?l.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 bg-green-50 text-green-700 rounded-full text-xs font-medium border border-green-200",children:[l.jsx(Vs,{size:14}),l.jsx("span",{children:"Success"})]}):l.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 bg-red-50 text-red-700 rounded-full text-xs font-medium border border-red-200",children:[l.jsx(cx,{size:14}),l.jsx("span",{children:"Failed"})]})}),l.jsx("td",{className:"px-6 py-4",children:l.jsxs("button",{onClick:()=>u(p.id),className:"flex items-center gap-1 text-sm brand-primary hover:underline transition-colors font-medium",children:[n.has(p.id)?l.jsx(ho,{size:16}):l.jsx(n0,{size:16}),l.jsx("span",{children:"View"})]})})]},p.id))})]})}),Array.from(n).map(p=>{const x=m.find(v=>v.id===p);return x?l.jsxs(fo.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"border-t border-gray-200 bg-gray-50 p-6",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[l.jsxs("div",{children:[l.jsx("h4",{className:"text-xs font-semibold text-gray-700 uppercase mb-3",children:"Arguments"}),l.jsx("pre",{className:"text-xs text-gray-900 bg-white p-4 rounded-lg border border-gray-200 overflow-x-auto",children:JSON.stringify(x.args_json,null,2)})]}),l.jsxs("div",{children:[l.jsx("h4",{className:"text-xs font-semibold text-gray-700 uppercase mb-3",children:"Result"}),l.jsx("pre",{className:"text-xs text-gray-900 bg-white p-4 rounded-lg border border-gray-200 overflow-x-auto",children:JSON.stringify(x.result_json,null,2)})]})]}),x.error_message&&l.jsxs("div",{className:"mt-6",children:[l.jsx("h4",{className:"text-xs font-semibold text-red-700 uppercase mb-3",children:"Error Message"}),l.jsx("p",{className:"text-sm text-red-700 bg-red-50 p-4 rounded-lg border border-red-200",children:x.error_message})]})]},`details-${p}`):null})]})]})}async function tz(e,t){console.log("Snapshot creation not implemented")}async function rz(e){return[]}async function sz(e){console.log("Snapshot restore not implemented")}async function nz(e,t){return tz()}async function az(e){return sz()}async function iz(e){return rz()}async function oz(e){console.log("Delete snapshot not implemented")}async function lz(e){console.log("Legacy data migration not implemented")}async function Sw(e){return!1}function cz(){return null}const uz="https://verify-pdf-extractor.onrender.com";async function dz(){try{const e=await fetch(`${uz}/health`,{method:"GET"});if(!e.ok){const r=await e.text();throw new Error(`Health check failed: ${e.status} ${r}`)}return await e.json()}catch(e){throw console.error("PDF Extractor health check error:",e),new Error(e instanceof Error?`Health check failed: ${e.message}`:"Health check failed: Unknown error")}}function fz({projectId:e,onProjectDeleted:t,onNavigateToMatrix:r}){const[s,n]=F.useState("project"),[a,i]=F.useState(!1),[o,c]=F.useState(!1),[u,d]=F.useState(null),[f,h]=F.useState("api"),[m,p]=F.useState(""),[x,v]=F.useState([]),[y,w]=F.useState(!0),[g,_]=F.useState(!1),[b,k]=F.useState(!1),[S,T]=F.useState(!1),[j,U]=F.useState(!1),[H,z]=F.useState(!1),[q,re]=F.useState(!1),[X,M]=F.useState(""),[J,G]=F.useState(""),[D,K]=F.useState(!1),[oe,N]=F.useState([]),[W,I]=F.useState(!1),[B,ee]=F.useState(!1),[le,fe]=F.useState(!1),[se,ne]=F.useState(""),[V,C]=F.useState(""),[he,ve]=F.useState(""),[ke,Ae]=F.useState(null),[me,Ke]=F.useState(!1),de=$T();F.useEffect(()=>{Ee(),Ce(),Oe(),U(Sw())},[e]);const Ee=async()=>{w(!0);try{const ue=await de.loadSettings();ue&&(h(ue.model_rate_source),p(ue.api_base_url),ue.csv_data&&v(ue.csv_data))}catch(ue){console.error("Error loading settings:",ue)}w(!1)},Oe=async()=>{try{const{data:ue}=await pe.from("user_preferences").select("show_splash_on_load").eq("id","00000000-0000-0000-0000-000000000001").maybeSingle();ue&&(z(ue.show_splash_on_load),localStorage.setItem("showSplashOnLoad",String(ue.show_splash_on_load)))}catch(ue){console.error("Error loading user preferences:",ue)}},Me=async()=>{Ke(!0),Ae(null);try{const ue=await dz();Ae(` Healthy - ${ue.status||"OK"}${ue.message?`: ${ue.message}`:""}`),d({type:"success",text:"PDF Extractor API is healthy and responding"})}catch(ue){const Ve=ue instanceof Error?ue.message:"Unknown error";Ae(` Failed - ${Ve}`),d({type:"error",text:`PDF Extractor health check failed: ${Ve}`})}finally{Ke(!1)}},We=async ue=>{try{const{error:Ve}=await pe.from("user_preferences").update({show_splash_on_load:ue}).eq("id","00000000-0000-0000-0000-000000000001");if(Ve)throw Ve;z(ue),localStorage.setItem("showSplashOnLoad",String(ue)),d({type:"success",text:`Splash screen will ${ue?"show":"not show"} on every load`})}catch(Ve){console.error("Error updating splash preference:",Ve),d({type:"error",text:"Failed to update splash screen preference"})}},Ye=async()=>{i(!0),d(null);try{const{data:ue}=await pe.from("projects").select("*").eq("id",e).single(),{data:Ve}=await pe.from("quotes").select("*").eq("project_id",e),_t=(Ve==null?void 0:Ve.map(fi=>fi.id))||[],{data:Cr}=await pe.from("quote_items").select("*").in("quote_id",_t),{data:$t}=await pe.from("scope_categories").select("*").eq("project_id",e),hs={version:"1.0",exported_at:new Date().toISOString(),project:ue,quotes:Ve||[],quote_items:Cr||[],scope_categories:$t||[]},fn=new Blob([JSON.stringify(hs,null,2)],{type:"application/json"}),Yr=URL.createObjectURL(fn),Je=document.createElement("a");Je.href=Yr,Je.download=`passivefire-project-${e}-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(Je),Je.click(),document.body.removeChild(Je),URL.revokeObjectURL(Yr),d({type:"success",text:"Project data exported successfully!"})}catch(ue){console.error("Export error:",ue),d({type:"error",text:"Failed to export project data."})}finally{i(!1)}},xt=async ue=>{var _t;const Ve=(_t=ue.target.files)==null?void 0:_t[0];if(Ve){c(!0),d(null);try{const Cr=await Ve.text(),$t=JSON.parse(Cr);if(!$t.quotes||!$t.quote_items)throw new Error("Invalid file format");for(const hs of $t.quotes){const{id:fn,project_id:Yr,created_at:Je,updated_at:fi,...v0}=hs,{data:y0,error:Oc}=await pe.from("quotes").insert({...v0,project_id:e}).select().single();if(Oc)throw Oc;const w0=$t.quote_items.filter(Ro=>Ro.quote_id===fn);for(const Ro of w0){const{id:lg,quote_id:cg,created_at:Ic,updated_at:ug,..._0}=Ro,{error:Dc}=await pe.from("quote_items").insert({..._0,quote_id:y0.id});if(Dc)throw Dc}}if($t.scope_categories&&$t.scope_categories.length>0)for(const hs of $t.scope_categories){const{id:fn,project_id:Yr,created_at:Je,...fi}=hs;await pe.from("scope_categories").insert({...fi,project_id:e})}d({type:"success",text:`Imported ${$t.quotes.length} quotes successfully!`}),ue.target.value=""}catch(Cr){console.error("Import error:",Cr),d({type:"error",text:"Failed to import project data. Please check the file format."})}finally{c(!1)}}},jr=async()=>{var ue,Ve;if(confirm("This will check for legacy data in localStorage and migrate it to a new project. Continue?")){T(!0),d(null);try{if(!Sw()){d({type:"error",text:"No legacy data found to migrate."}),U(!1);return}const _t=await lz();_t.success&&_t.projectId?(d({type:"success",text:`Legacy data migrated successfully! ${((ue=_t.itemsMigrated)==null?void 0:ue.lines)||0} items from ${((Ve=_t.itemsMigrated)==null?void 0:Ve.suppliers)||0} suppliers. Reload the page to see the new project.`}),U(!1)):d({type:"error",text:_t.error||"Failed to migrate legacy data."})}catch(_t){console.error("Migration error:",_t),d({type:"error",text:"An error occurred during migration."})}finally{T(!1)}}},Ys=async()=>{if(confirm("Are you sure you want to delete this project? This will remove all quotes and data. This action cannot be undone."))try{const{error:ue}=await pe.from("projects").delete().eq("id",e);if(ue)throw ue;t()}catch(ue){console.error("Delete error:",ue),d({type:"error",text:"Failed to delete project."})}},Kt=async()=>{_(!0),d(null);try{await de.saveSettings({model_rate_source:f,api_base_url:m,csv_data:x.length>0?x:void 0})?(await pe.from("projects").update({updated_at:new Date().toISOString()}).eq("id",e),d({type:"success",text:"Settings saved successfully!"})):d({type:"error",text:"Failed to save settings."})}catch(ue){console.error("Save settings error:",ue),d({type:"error",text:"Failed to save settings."})}finally{_(!1)}},Ur=async ue=>{var _t;const Ve=(_t=ue.target.files)==null?void 0:_t[0];if(Ve){k(!0),d(null);try{const Cr=await Ve.arrayBuffer(),$t=Tp(Cr,{type:"array"}),hs=$t.Sheets[$t.SheetNames[0]],Yr=dt.sheet_to_json(hs).map(Je=>({systemId:String(Je.systemId||Je.SystemId||Je.system_id||"").trim(),sizeBucket:String(Je.sizeBucket||Je.SizeBucket||Je.size_bucket||"").trim(),frr:String(Je.frr||Je.FRR||"").trim(),service:String(Je.service||Je.Service||"").trim(),subclass:String(Je.subclass||Je.Subclass||Je.sub_class||"").trim(),componentCount:parseInt(Je.componentCount||Je.ComponentCount||Je.component_count||"0"),modelRate:parseFloat(Je.modelRate||Je.ModelRate||Je.model_rate||"0")})).filter(Je=>Je.systemId&&Je.modelRate>0);if(Yr.length===0)throw new Error("No valid data found in CSV file");v(Yr),d({type:"success",text:`Loaded ${Yr.length} model rates from CSV.`}),ue.target.value=""}catch(Cr){console.error("CSV upload error:",Cr),d({type:"error",text:"Failed to parse CSV file. Please check the format."})}finally{k(!1)}}},Ce=async()=>{I(!0);const ue=await iz();N(ue),I(!1)},rt=async()=>{if(!se||!V){d({type:"error",text:"Please provide snapshot key and name."});return}ee(!0),d(null);try{await nz(se,e,{name:V,client:he||"Unknown",created:new Date().toISOString().split("T")[0]})?(d({type:"success",text:`Snapshot "${se}" saved successfully!`}),ne(""),C(""),ve(""),await Ce()):d({type:"error",text:"Failed to save snapshot."})}catch(ue){console.error("Save snapshot error:",ue),d({type:"error",text:"Failed to save snapshot."})}finally{ee(!1)}},hr=async ue=>{if(confirm(`Restore snapshot "${ue}"? This will replace all current project data.`)){fe(!0),d(null);try{await az(ue,e)?(d({type:"success",text:`Snapshot "${ue}" restored successfully! Refresh the page to see changes.`}),await Ee()):d({type:"error",text:"Failed to restore snapshot."})}catch(Ve){console.error("Restore snapshot error:",Ve),d({type:"error",text:"Failed to restore snapshot."})}finally{fe(!1)}}},wt=async ue=>{if(confirm(`Delete snapshot "${ue}"? This action cannot be undone.`)){d(null);try{await oz(ue)?(d({type:"success",text:`Snapshot "${ue}" deleted successfully!`}),await Ce()):d({type:"error",text:"Failed to delete snapshot."})}catch(Ve){console.error("Delete snapshot error:",Ve),d({type:"error",text:"Failed to delete snapshot."})}}},fs=async()=>{var ue,Ve;if(!X.trim()){alert("Please enter a template name");return}K(!0);try{const{data:_t}=await pe.auth.getSession(),Cr=(Ve=(ue=_t==null?void 0:_t.session)==null?void 0:ue.user)==null?void 0:Ve.id;if(!Cr){alert("You must be logged in to save templates");return}const{data:$t}=await pe.from("projects").select("name").eq("id",e).maybeSingle(),hs=await de.loadSettings(),{data:fn}=await pe.from("project_settings").select("*").eq("project_id",e).maybeSingle(),{error:Yr}=await pe.from("project_templates").insert({name:X.trim(),description:J.trim(),trade:"Passive Fire",is_default:!1,created_by_user_id:Cr,project_settings:{...hs,...fn},analysis_settings:{},report_settings:{},compliance_settings:{}});if(Yr)throw Yr;d({type:"success",text:Vu("saveProjectAsTemplate.toasts.success",{templateName:X,projectName:($t==null?void 0:$t.name)||"Project"})}),re(!1),M(""),G("")}catch(_t){console.error("Error saving template:",_t),alert("Failed to save template")}finally{K(!1)}};return l.jsxs("div",{className:"space-y-6",children:[l.jsx("div",{className:"bg-white rounded-lg shadow-sm border-b border-gray-200",children:l.jsxs("div",{className:"flex gap-1 p-2",children:[l.jsxs("button",{onClick:()=>n("project"),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-colors ${s==="project"?"bg-orange-50 text-brand-primary border border-brand-primary":"text-gray-600 hover:bg-gray-50"}`,children:[l.jsx(yd,{size:18}),"Project Settings"]}),l.jsxs("button",{onClick:()=>n("systemcheck"),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-colors ${s==="systemcheck"?"bg-orange-50 text-brand-primary border border-brand-primary":"text-gray-600 hover:bg-gray-50"}`,children:[l.jsx(NF,{size:18}),"System Check"]}),l.jsxs("button",{onClick:()=>n("copilotaudit"),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-colors ${s==="copilotaudit"?"bg-orange-50 text-brand-primary border border-brand-primary":"text-gray-600 hover:bg-gray-50"}`,children:[l.jsx(a0,{size:18}),"Copilot Audit"]})]})}),u&&l.jsx("div",{className:`p-4 rounded-md ${u.type==="success"?"bg-green-50 text-green-800":"bg-red-50 text-red-800"}`,children:u.text}),s==="systemcheck"?l.jsx(VT,{}):s==="copilotaudit"?l.jsx(zT,{}):l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(yd,{size:20,className:"text-gray-700"}),l.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Project Settings"})]}),l.jsxs("button",{onClick:()=>{const{data:ue}=pe.from("projects").select("name").eq("id",e).maybeSingle().then(({data:Ve})=>{M(`${(Ve==null?void 0:Ve.name)||"Project"} Template`)});re(!0)},className:"flex items-center gap-2 px-4 py-2 text-blue-600 bg-blue-50 hover:bg-blue-100 rounded-lg transition-colors font-medium text-sm border border-blue-200",children:[l.jsx(oF,{size:16}),"saveProjectAsTemplate.buttonLabel"]})]}),l.jsx("h3",{className:"text-base font-semibold text-gray-900 mb-4",children:"Model Rate Provider"}),y?l.jsx("div",{className:"text-center py-8 text-gray-500",children:"Loading settings..."}):l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Model Rate Source"}),l.jsxs("div",{className:"flex gap-4",children:[l.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[l.jsx("input",{type:"radio",name:"modelRateSource",value:"api",checked:f==="api",onChange:ue=>h(ue.target.value),className:"w-4 h-4 text-blue-600"}),l.jsx(vF,{size:18,className:"text-gray-600"}),l.jsx("span",{className:"text-sm text-gray-700",children:"API"})]}),l.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[l.jsx("input",{type:"radio",name:"modelRateSource",value:"csv",checked:f==="csv",onChange:ue=>h(ue.target.value),className:"w-4 h-4 text-blue-600"}),l.jsx(Dr,{size:18,className:"text-gray-600"}),l.jsx("span",{className:"text-sm text-gray-700",children:"CSV"})]})]})]}),f==="api"&&l.jsxs("div",{children:[l.jsx("label",{htmlFor:"apiBaseUrl",className:"block text-sm font-medium text-gray-700 mb-2",children:"API Base URL"}),l.jsx("input",{id:"apiBaseUrl",type:"url",value:m,onChange:ue=>p(ue.target.value),placeholder:"https://gkdvcyocchnfwelrxvmz.supabase.co/functions/v1/rate-api",className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-gray-900"}),l.jsxs("div",{className:"mt-2 space-y-1",children:[l.jsx("p",{className:"text-xs text-gray-500",children:"Leave empty to use the default Verify+ Rate API"}),l.jsx("p",{className:"text-xs text-blue-600 font-mono",children:"Default: https://gkdvcyocchnfwelrxvmz.supabase.co/functions/v1/rate-api"}),l.jsxs("p",{className:"text-xs text-gray-500",children:["The API will be called as: POST ","{baseUrl}","/rate with system_label, size, frr, service, and subclass"]})]})]}),l.jsx(cz,{projectId:e}),l.jsxs("div",{className:"bg-gray-50 p-4 rounded-md border border-gray-200",children:[l.jsxs("p",{className:"text-sm text-gray-700 mb-2",children:[l.jsx("strong",{children:"Project ID:"})," ",l.jsx("code",{className:"text-xs bg-white px-2 py-1 rounded border border-gray-300",children:e})]}),l.jsx("p",{className:"text-xs text-gray-500",children:"Used for storage keys and data isolation"})]}),f==="csv"&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Upload ModelSolutions.csv"}),l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsxs("label",{className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors cursor-pointer",children:[l.jsx(Jl,{size:18}),b?"Uploading...":"Upload CSV",l.jsx("input",{type:"file",accept:".csv,.xlsx,.xls",multiple:!1,onChange:Ur,disabled:b,className:"hidden"})]}),x.length>0&&l.jsxs("span",{className:"text-sm text-gray-600",children:[x.length," model rates loaded"]})]}),l.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"Required columns: systemId, sizeBucket, frr, service, subclass, componentCount, modelRate"}),x.length>0&&l.jsxs("div",{className:"mt-4 border border-gray-200 rounded-md overflow-hidden",children:[l.jsx("div",{className:"max-h-64 overflow-y-auto",children:l.jsxs("table",{className:"w-full text-xs",children:[l.jsx("thead",{className:"bg-gray-50 border-b border-gray-200 sticky top-0",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700",children:"System ID"}),l.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700",children:"Size Bucket"}),l.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700",children:"FRR"}),l.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700",children:"Service"}),l.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700",children:"Subclass"}),l.jsx("th",{className:"px-3 py-2 text-right font-medium text-gray-700",children:"Components"}),l.jsx("th",{className:"px-3 py-2 text-right font-medium text-gray-700",children:"Model Rate"})]})}),l.jsx("tbody",{className:"divide-y divide-gray-200",children:x.slice(0,10).map((ue,Ve)=>l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"px-3 py-2 text-gray-900",children:ue.systemId}),l.jsx("td",{className:"px-3 py-2 text-gray-600",children:ue.sizeBucket}),l.jsx("td",{className:"px-3 py-2 text-gray-600",children:ue.frr}),l.jsx("td",{className:"px-3 py-2 text-gray-600",children:ue.service}),l.jsx("td",{className:"px-3 py-2 text-gray-600",children:ue.subclass}),l.jsx("td",{className:"px-3 py-2 text-right text-gray-900",children:ue.componentCount}),l.jsxs("td",{className:"px-3 py-2 text-right text-gray-900",children:["$",ue.modelRate.toFixed(2)]})]},Ve))})]})}),x.length>10&&l.jsxs("div",{className:"px-3 py-2 bg-gray-50 border-t border-gray-200 text-xs text-gray-500",children:["Showing 10 of ",x.length," rows"]})]})]}),l.jsx("div",{className:"flex items-center gap-3 pt-4 border-t border-gray-200",children:l.jsx("button",{onClick:Kt,disabled:g||f==="csv"&&x.length===0,className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed",children:g?"Saving...":"Save Settings"})})]})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[l.jsx(kc,{className:"text-cyan-600",size:24}),l.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"User Experience"})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg border border-gray-200",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"Show Splash Screen on Every Load"}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Display the animated BurnRatePro splash screen each time the app loads"})]}),l.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:H,onChange:ue=>We(ue.target.checked),className:"sr-only peer"}),l.jsx("div",{className:"w-11 h-6 bg-gray-300 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-cyan-300 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-cyan-600"})]})]}),l.jsx("div",{className:"text-xs text-gray-500 bg-blue-50 border border-blue-200 rounded-lg p-3",children:l.jsxs("p",{children:[l.jsx("strong",{children:"Tip:"})," Press ",l.jsx("kbd",{className:"px-2 py-1 bg-white border border-blue-300 rounded text-xs",children:"Shift"})," + ",l.jsx("kbd",{className:"px-2 py-1 bg-white border border-blue-300 rounded text-xs",children:"S"})," to replay the splash screen at any time"]})})]})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[l.jsxs("h2",{className:"text-xl font-semibold text-gray-900 mb-6 flex items-center gap-2",children:[l.jsx(Rv,{size:20,className:"text-gray-700"}),"PDF Extractor API"]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg border border-gray-200",children:[l.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-2",children:"External PDF Extraction Service"}),l.jsx("p",{className:"text-xs text-gray-600 mb-3",children:"This service automatically extracts structured data from supplier quote PDFs."}),l.jsxs("div",{className:"text-xs text-gray-500 space-y-1 mb-4",children:[l.jsxs("div",{children:[l.jsx("strong",{children:"Endpoint:"})," https://verify-pdf-extractor.onrender.com"]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Status:"})," ",ke||"Not checked"]})]}),l.jsx("button",{onClick:Me,disabled:me,className:"flex items-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed text-sm font-medium",children:me?l.jsxs(l.Fragment,{children:[l.jsx(is,{size:16,className:"animate-spin"}),"Checking..."]}):l.jsxs(l.Fragment,{children:[l.jsx(Rv,{size:16}),"Check Health"]})})]}),l.jsx("div",{className:"text-xs text-gray-500 bg-purple-50 border border-purple-200 rounded-lg p-3",children:l.jsxs("p",{children:[l.jsx("strong",{children:"Note:"})," The PDF extractor is called automatically when you upload a PDF in the Import Quotes screen. This health check verifies the service is online and responding."]})})]})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Project Data"}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"border-b border-gray-200 pb-6",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-3",children:"Export Data"}),l.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Export all project data including quotes, items, and categories to a JSON file."}),l.jsxs("button",{onClick:Ye,disabled:a,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed",children:[l.jsx(po,{size:18}),a?"Exporting...":"Export Project Data"]})]}),l.jsxs("div",{className:"border-b border-gray-200 pb-6",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-3",children:"Import Data"}),l.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Import quotes and items from a previously exported JSON file. This will add to existing data."}),l.jsxs("label",{className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors cursor-pointer inline-flex",children:[l.jsx(Jl,{size:18}),o?"Importing...":"Import Project Data",l.jsx("input",{type:"file",accept:".json",multiple:!1,onChange:xt,disabled:o,className:"hidden"})]})]}),j&&l.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[l.jsxs("h3",{className:"text-lg font-medium text-yellow-900 mb-3 flex items-center gap-2",children:[l.jsx(Yi,{size:20,className:"text-yellow-600"}),"Legacy Data Migration"]}),l.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Legacy data detected in localStorage. Click below to migrate it to a new project in the database."}),l.jsxs("button",{onClick:jr,disabled:S,className:"flex items-center gap-2 px-4 py-2 bg-yellow-600 text-white rounded-md hover:bg-yellow-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed",children:[l.jsx(is,{size:18,className:S?"animate-spin":""}),S?"Migrating...":"Re-run Migration"]})]}),l.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[l.jsx("h3",{className:"text-lg font-medium text-red-900 mb-3",children:"Danger Zone"}),l.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Permanently delete this project and all associated data. This action cannot be undone."}),l.jsxs("button",{onClick:Ys,className:"flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors",children:[l.jsx(Yl,{size:18}),"Delete Project"]})]})]})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[l.jsx(hF,{size:20,className:"text-gray-700"}),l.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Project Snapshots"})]}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"border-b border-gray-200 pb-6",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-3",children:"Save Current Project"}),l.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Create a snapshot of the current project state including all quotes, mappings, comparisons, and settings."}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[l.jsxs("div",{children:[l.jsx("label",{htmlFor:"snapshotKey",className:"block text-sm font-medium text-gray-700 mb-2",children:"Snapshot Key *"}),l.jsx("input",{id:"snapshotKey",type:"text",value:se,onChange:ue=>ne(ue.target.value),placeholder:"HowickLibrary_2025",className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-gray-900"})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"snapshotName",className:"block text-sm font-medium text-gray-700 mb-2",children:"Project Name *"}),l.jsx("input",{id:"snapshotName",type:"text",value:V,onChange:ue=>C(ue.target.value),placeholder:"Howick Library",className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-gray-900"})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"snapshotClient",className:"block text-sm font-medium text-gray-700 mb-2",children:"Client"}),l.jsx("input",{id:"snapshotClient",type:"text",value:he,onChange:ue=>ve(ue.target.value),placeholder:"Cassidy",className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-gray-900"})]})]}),l.jsxs("button",{onClick:rt,disabled:B||!se||!V,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed",children:[l.jsx(ep,{size:18}),B?"Saving Snapshot...":"Save Snapshot"]})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Saved Snapshots"}),l.jsxs("button",{onClick:Ce,disabled:W,className:"flex items-center gap-2 px-3 py-1 text-sm bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 transition-colors",children:[l.jsx(is,{size:16}),"Refresh"]})]}),W?l.jsx("div",{className:"text-center py-8 text-gray-500",children:"Loading snapshots..."}):oe.length===0?l.jsx("div",{className:"text-center py-8 text-gray-500 bg-gray-50 rounded-md border border-gray-200",children:"No snapshots saved yet."}):l.jsx("div",{className:"space-y-3",children:oe.map(ue=>l.jsx("div",{className:"p-4 bg-gray-50 rounded-md border border-gray-200 hover:border-blue-300 transition-colors",children:l.jsxs("div",{className:"flex items-start justify-between",children:[l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[l.jsx("h4",{className:"font-semibold text-gray-900",children:ue.projectMeta.name}),l.jsx("code",{className:"px-2 py-0.5 text-xs bg-white rounded border border-gray-300 text-gray-700",children:ue.projectKey})]}),l.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[l.jsxs("p",{children:[l.jsx("strong",{children:"Client:"})," ",ue.projectMeta.client," |",l.jsx("strong",{className:"ml-2",children:"Created:"})," ",ue.projectMeta.created]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Suppliers:"})," ",ue.suppliers.length," |",l.jsx("strong",{className:"ml-2",children:"Items:"})," ",ue.normalisedLines.length," |",l.jsx("strong",{className:"ml-2",children:"Saved:"})," ",new Date(ue.snapshotDate||"").toLocaleDateString()]})]})]}),l.jsxs("div",{className:"flex gap-2 ml-4",children:[l.jsxs("button",{onClick:()=>hr(ue.projectKey),disabled:le,className:"flex items-center gap-1 px-3 py-1 text-sm bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors disabled:bg-gray-400",children:[l.jsx(is,{size:14}),"Restore"]}),l.jsxs("button",{onClick:()=>wt(ue.projectKey),className:"flex items-center gap-1 px-3 py-1 text-sm bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors",children:[l.jsx(Yl,{size:14}),"Delete"]})]})]})},ue.id))})]})]})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Account"}),l.jsx("div",{className:"space-y-4",children:l.jsxs("button",{onClick:async()=>{await pe.auth.signOut()},className:"flex items-center gap-2 px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors",children:[l.jsx(bS,{size:18}),"Logout"]})})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"About PassiveFire Verify+"}),l.jsxs("div",{className:"text-sm text-gray-600 space-y-2",children:[l.jsx("p",{children:"Version 1.0"}),l.jsx("p",{children:"PassiveFire Verify+ helps you manage and analyze quotes for passive fire protection projects. Import quotes, review items, compare suppliers, and generate award reports."})]})]})]}),q&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:l.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full",children:[l.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:l.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"saveProjectAsTemplate.modal.title"})}),l.jsxs("div",{className:"px-6 py-4 space-y-4",children:[l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["saveProjectAsTemplate.modal.fields.name.label"," ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("input",{type:"text",value:X,onChange:ue=>M(ue.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"saveProjectAsTemplate.modal.fields.name.placeholder"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"saveProjectAsTemplate.modal.fields.description.label"}),l.jsx("textarea",{value:J,onChange:ue=>G(ue.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"saveProjectAsTemplate.modal.fields.description.placeholder"})]}),l.jsx("div",{className:"text-sm text-gray-600 bg-blue-50 border border-blue-200 rounded-lg p-3",children:"saveProjectAsTemplate.modal.description"})]}),l.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex items-center justify-end gap-3",children:[l.jsx("button",{onClick:()=>{re(!1),M(""),G("")},className:"px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg transition-colors font-medium text-sm",children:"saveProjectAsTemplate.modal.buttons.cancel"}),l.jsx("button",{onClick:fs,disabled:D||!X.trim(),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium text-sm disabled:bg-gray-300 disabled:cursor-not-allowed",children:D?l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Saving..."]}):l.jsxs(l.Fragment,{children:[l.jsx(ep,{size:16}),"saveProjectAsTemplate.modal.buttons.confirm"]})})]})]})})]})}function hz({message:e,type:t,onClose:r,duration:s=5e3}){F.useEffect(()=>{if(s>0){const c=setTimeout(()=>{r()},s);return()=>clearTimeout(c)}},[s,r]);const n={success:Vs,error:cx,info:vd,warning:vt},a={success:"bg-green-50 text-green-800 border-green-200",error:"bg-red-50 text-red-800 border-red-200",info:"bg-blue-50 text-blue-800 border-blue-200",warning:"bg-yellow-50 text-yellow-800 border-yellow-200"},i={success:"text-green-600",error:"text-red-600",info:"text-blue-600",warning:"text-yellow-600"},o=n[t];return l.jsxs("div",{className:`fixed top-4 right-4 z-50 flex items-start gap-3 min-w-80 max-w-md p-4 rounded-lg border shadow-lg ${a[t]} animate-slide-in`,children:[l.jsx(o,{size:20,className:`flex-shrink-0 mt-0.5 ${i[t]}`}),l.jsx("div",{className:"flex-1 text-sm font-medium",children:e}),l.jsx("button",{onClick:r,className:"flex-shrink-0 hover:opacity-70 transition-opacity",children:l.jsx(cn,{size:18})})]})}class pz{constructor(){S0(this,"listeners",new Set);S0(this,"messages",[])}subscribe(t){return this.listeners.add(t),()=>this.listeners.delete(t)}notify(){this.listeners.forEach(t=>t([...this.messages]))}show(t){const r={...t,id:Math.random().toString(36).substring(2,11),createdAt:Date.now(),duration:t.duration||5e3};this.messages.push(r),this.notify(),r.duration&&r.duration>0&&setTimeout(()=>{this.dismiss(r.id)},r.duration)}dismiss(t){this.messages=this.messages.filter(r=>r.id!==t),this.notify()}clear(){this.messages=[],this.notify()}showAccessDenied(t){this.show({type:"warning",title:"Access denied",body:t||"You don't have permission to manage organisation members. If you need access, please contact your organisation admin.",duration:6e3})}}const jp=new pz;function mz(){const[e,t]=F.useState([]);F.useEffect(()=>{const a=jp.subscribe(i=>{t(i)});return()=>a()},[]);const r=a=>{jp.remove(a)},s=a=>{switch(a){case"success":return l.jsx(Vs,{className:"text-green-500",size:20});case"error":return l.jsx(vt,{className:"text-red-500",size:20});case"warning":return l.jsx(vt,{className:"text-amber-500",size:20});case"info":return l.jsx(vd,{className:"text-blue-500",size:20});default:return l.jsx(vd,{className:"text-gray-500",size:20})}},n=a=>{switch(a){case"success":return"bg-green-50 border-green-200";case"error":return"bg-red-50 border-red-200";case"warning":return"bg-amber-50 border-amber-200";case"info":return"bg-blue-50 border-blue-200";default:return"bg-gray-50 border-gray-200"}};return l.jsx("div",{className:"fixed top-4 right-4 z-50 flex flex-col gap-2 pointer-events-none",children:l.jsx(Km,{children:e.map(a=>l.jsx(fo.div,{initial:{opacity:0,x:100,scale:.8},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:100,scale:.8},className:`min-w-80 max-w-md rounded-lg border shadow-lg p-4 pointer-events-auto ${n(a.type)}`,children:l.jsxs("div",{className:"flex items-start gap-3",children:[s(a.type),l.jsxs("div",{className:"flex-1 min-w-0",children:[a.title&&l.jsx("div",{className:"font-semibold text-gray-900 mb-1",children:a.title}),l.jsx("div",{className:"text-sm text-gray-700",children:a.body})]}),l.jsx("button",{onClick:()=>r(a.id),className:"text-gray-400 hover:text-gray-600 transition-colors",children:l.jsx(cn,{size:18})})]})},a.id))})})}function xz(){return l.jsx("footer",{className:"py-4 px-6 flex justify-center lg:justify-end",children:l.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-full border border-gray-200 bg-white/90 text-xs text-gray-500",children:[l.jsx("span",{className:"font-medium",children:"PassiveFire Verify+"}),l.jsx("span",{className:"text-gray-300",children:""}),l.jsx("span",{children:"v1.9"}),l.jsx("span",{className:"text-gray-300",children:""}),l.jsx("span",{children:" 2025 PassiveFire Verify+. All rights reserved."})]})})}function gz({isOpen:e,onClose:t,currentProjectId:r,allProjects:s,onNavigate:n}){const[a,i]=F.useState(""),[o,c]=F.useState([{role:"assistant",content:"Hi! I'm your AI Copilot. I can help you navigate the app, answer questions about your quotes, and provide insights. What can I help you with?"}]),u=()=>{if(!a.trim())return;c(h=>[...h,{role:"user",content:a}]);const d=a.toLowerCase();let f="I'm still learning! This is a placeholder response. In production, I would be powered by AI to provide intelligent assistance.";d.includes("quote")||d.includes("import")?(f="To import quotes, navigate to the Quotes tab and upload your PDF or Excel files. I can help you with parsing issues if you encounter any.",setTimeout(()=>n("quotes",r),2e3)):d.includes("report")||d.includes("award")?(f="The Award Report is generated in the Reports section. It uses AI to analyze all quotes and recommend the best supplier based on price, coverage, and risk.",setTimeout(()=>n("reports",r),2e3)):(d.includes("scope")||d.includes("matrix"))&&(f="The Scope Matrix shows a side-by-side comparison of all suppliers' pricing. It highlights variances and helps identify gaps in coverage.",setTimeout(()=>n("scope",r),2e3)),setTimeout(()=>{c(h=>[...h,{role:"assistant",content:f}])},500),i("")};return l.jsx(Km,{children:e&&l.jsxs(l.Fragment,{children:[l.jsx(fo.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-30 z-40",onClick:t}),l.jsxs(fo.div,{initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:{type:"spring",damping:25,stiffness:200},className:"fixed right-0 top-0 h-full w-96 bg-white shadow-2xl z-50 flex flex-col",children:[l.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-purple-600 to-blue-600 rounded-full flex items-center justify-center",children:l.jsx(kc,{size:18,className:"text-white"})}),l.jsx("h2",{className:"text-lg font-semibold",children:"AI Copilot"})]}),l.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:l.jsx(cn,{size:20})})]}),l.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:o.map((d,f)=>l.jsx("div",{className:`flex ${d.role==="user"?"justify-end":"justify-start"}`,children:l.jsx("div",{className:`max-w-[80%] rounded-lg p-3 ${d.role==="user"?"bg-blue-600 text-white":"bg-gray-100 text-gray-900"}`,children:d.content})},f))}),l.jsx("div",{className:"p-4 border-t border-gray-200",children:l.jsxs("div",{className:"flex gap-2",children:[l.jsx("input",{type:"text",value:a,onChange:d=>i(d.target.value),onKeyPress:d=>d.key==="Enter"&&u(),placeholder:"Ask me anything...",className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),l.jsx("button",{onClick:u,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:l.jsx(TF,{size:18})})]})})]})]})})}function vz(){const[e,t]=F.useState(""),[r,s]=F.useState(""),[n,a]=F.useState(!1),[i,o]=F.useState(""),[c,u]=F.useState(!1),d=async f=>{f.preventDefault(),o(""),a(!0);try{if(c){const{error:h}=await pe.auth.signUp({email:e,password:r});if(h)throw h;o("Check your email for the confirmation link")}else{const{error:h}=await pe.auth.signInWithPassword({email:e,password:r});if(h)throw h}}catch(h){o(h.message||"An error occurred")}finally{a(!1)}};return l.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",children:l.jsxs("div",{className:"max-w-md w-full bg-white rounded-2xl shadow-xl p-8",children:[l.jsxs("div",{className:"text-center mb-8",children:[l.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-blue-600 rounded-full mb-4",children:l.jsx(a0,{className:"text-white",size:32})}),l.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"PassiveFire Verify+"}),l.jsx("p",{className:"text-gray-600",children:c?"Create your account":"Sign in to your account"})]}),l.jsxs("form",{onSubmit:d,className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),l.jsxs("div",{className:"relative",children:[l.jsx(EF,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:20}),l.jsx("input",{type:"email",value:e,onChange:f=>t(f.target.value),required:!0,className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"you@example.com"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),l.jsxs("div",{className:"relative",children:[l.jsx(kF,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:20}),l.jsx("input",{type:"password",value:r,onChange:f=>s(f.target.value),required:!0,className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:""})]})]}),i&&l.jsx("div",{className:`text-sm ${i.includes("email")?"text-green-600":"text-red-600"} bg-red-50 p-3 rounded-lg`,children:i}),l.jsx("button",{type:"submit",disabled:n,className:"w-full bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed font-medium",children:n?"Please wait...":c?"Sign Up":"Sign In"})]}),l.jsx("div",{className:"mt-6 text-center",children:l.jsx("button",{onClick:()=>u(!c),className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:c?"Already have an account? Sign in":"Don't have an account? Sign up"})})]})})}function kw({onOrganisationSelected:e}){const{organisations:t,setCurrentOrganisation:r}=jo(),s=n=>{r(n),e()};return l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:l.jsxs("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-8",children:[l.jsxs("div",{className:"text-center mb-6",children:[l.jsx(Xl,{className:"mx-auto mb-4 text-blue-600",size:48}),l.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Select Organisation"}),l.jsx("p",{className:"text-gray-600",children:"Choose which organisation to work with"})]}),l.jsx("div",{className:"space-y-3",children:t.map(n=>l.jsx("button",{onClick:()=>s(n),className:"w-full p-4 border border-gray-200 rounded-lg hover:border-blue-500 hover:bg-blue-50 transition-colors text-left",children:l.jsx("div",{className:"font-semibold text-gray-900",children:n.name})},n.id))})]})})}function yz(){const{currentOrganisation:e}=jo();return l.jsxs("div",{children:[l.jsx(l0,{title:"Organisation Settings",description:"Manage your organisation preferences"}),l.jsxs("div",{className:"mt-6 p-6 bg-white rounded-lg border border-gray-200",children:[l.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Current Organisation"}),l.jsx("p",{className:"text-gray-600",children:e==null?void 0:e.name})]})]})}function Ew(){return l.jsxs("div",{className:"p-8",children:[l.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Admin Dashboard"}),l.jsx("p",{className:"text-gray-600",children:"Platform administration"})]})}function wz(){const[e,t]=F.useState([]),[r,s]=F.useState([]),[n,a]=F.useState(!0),[i,o]=F.useState(""),[c,u]=F.useState("all");F.useEffect(()=>{d()},[]),F.useEffect(()=>{f()},[i,c,e]);const d=async()=>{try{const{data:p,error:x}=await pe.from("organisations").select("*").order("created_at",{ascending:!1});if(x)throw x;const v=await Promise.all((p||[]).map(async y=>{const{data:w}=await pe.from("organisation_members").select("user_id, role, status").eq("organisation_id",y.id),g=w==null?void 0:w.find(j=>j.role==="owner"),_=(w==null?void 0:w.filter(j=>j.status==="active"&&["owner","admin","member"].includes(j.role)).length)||0;let b="";if(g){const{data:j}=await pe.from("profiles").select("email, full_name").eq("id",g.user_id).maybeSingle();b=(j==null?void 0:j.email)||""}const{data:k}=await pe.from("subscriptions").select("plan_name").eq("organisation_id",y.id).maybeSingle(),{count:S}=await pe.from("projects").select("*",{count:"exact",head:!0}).eq("organisation_id",y.id),{data:T}=await pe.from("projects").select("updated_at").eq("organisation_id",y.id).order("updated_at",{ascending:!1}).limit(1).maybeSingle();return{...y,owner_email:b,plan_name:(k==null?void 0:k.plan_name)||"Trial",seats_used:_,project_count:S||0,last_active:(T==null?void 0:T.updated_at)||y.created_at}}));t(v)}catch(p){console.error("Error loading organisations:",p)}finally{a(!1)}},f=()=>{let p=e;if(c!=="all"&&(p=p.filter(x=>x.status===c)),i.trim()){const x=i.toLowerCase();p=p.filter(v=>v.name.toLowerCase().includes(x)||v.owner_email&&v.owner_email.toLowerCase().includes(x))}s(p)},h=p=>new Date(p).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"}),m=p=>{switch(p){case"trial":return"bg-amber-50 text-amber-700";case"suspended":return"bg-rose-50 text-rose-700";default:return"bg-emerald-50 text-emerald-700"}};return l.jsxs("div",{className:"px-6 py-6 max-w-7xl mx-auto",children:[l.jsxs("div",{className:"flex items-start justify-between mb-6",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-xl font-semibold text-slate-900",children:"Organisations"}),l.jsx("p",{className:"mt-1 text-sm text-slate-500",children:"Manage client organisations, seat limits, and subscription status."})]}),l.jsx("button",{onClick:()=>window.location.href="/admin/organisations/new",className:"inline-flex items-center rounded-lg bg-[#0A66C2] px-4 py-2 text-sm font-semibold text-white shadow hover:bg-[#0952A0] transition",children:"Create organisation"})]}),l.jsxs("div",{className:"mb-4 flex items-center gap-4",children:[l.jsxs("div",{className:"relative flex-1",children:[l.jsx(tp,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:16}),l.jsx("input",{type:"text",placeholder:"Search by organisation name or owner email",value:i,onChange:p=>o(p.target.value),className:"w-full rounded-lg border border-slate-300 bg-slate-50 pl-9 pr-3 py-2 text-sm text-slate-800 placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-[#0A66C2] focus:border-[#0A66C2]"})]}),l.jsxs("select",{value:c,onChange:p=>u(p.target.value),className:"rounded-lg border border-slate-300 bg-slate-50 px-3 py-2 text-sm text-slate-800 focus:outline-none focus:ring-2 focus:ring-[#0A66C2] focus:border-[#0A66C2]",children:[l.jsx("option",{value:"all",children:"All"}),l.jsx("option",{value:"active",children:"Active"}),l.jsx("option",{value:"trial",children:"Trial"}),l.jsx("option",{value:"suspended",children:"Suspended"})]})]}),l.jsx("div",{className:"rounded-xl border border-slate-200 bg-white shadow-[0_4px_14px_rgba(15,23,42,0.06)] overflow-hidden",children:n?l.jsx("div",{className:"text-center py-12 text-slate-500",children:"Loading organisations..."}):r.length===0?l.jsx("div",{className:"text-center py-12 text-slate-500",children:i||c!=="all"?"No organisations found":"No organisations yet"}):l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full table-auto text-left text-sm",children:[l.jsx("thead",{children:l.jsxs("tr",{className:"border-b border-slate-100",children:[l.jsx("th",{className:"px-4 py-3 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Organisation"}),l.jsx("th",{className:"px-4 py-3 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Owner"}),l.jsx("th",{className:"px-4 py-3 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Plan"}),l.jsx("th",{className:"px-4 py-3 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Seats"}),l.jsx("th",{className:"px-4 py-3 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Projects"}),l.jsx("th",{className:"px-4 py-3 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Status"}),l.jsx("th",{className:"px-4 py-3 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Last active"}),l.jsx("th",{className:"px-4 py-3 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Actions"})]})}),l.jsx("tbody",{children:r.map(p=>l.jsxs("tr",{className:"border-b border-slate-100 hover:bg-slate-50 cursor-pointer",onClick:()=>window.location.href=`/admin/organisations/${p.id}`,children:[l.jsx("td",{className:"px-4 py-3 align-middle",children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"font-medium text-slate-900",children:p.name}),p.status!=="active"&&l.jsx("span",{className:`inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium ${m(p.status)}`,children:p.status.charAt(0).toUpperCase()+p.status.slice(1)})]})}),l.jsx("td",{className:"px-4 py-3 align-middle text-sm text-slate-600",children:p.owner_email||""}),l.jsx("td",{className:"px-4 py-3 align-middle text-sm text-slate-800",children:p.plan_name}),l.jsx("td",{className:"px-4 py-3 align-middle text-sm text-slate-800",children:l.jsxs("span",{className:p.seats_used>p.seat_limit?"text-rose-600 font-medium":"",children:[p.seats_used," / ",p.seat_limit]})}),l.jsx("td",{className:"px-4 py-3 align-middle text-sm text-slate-800",children:p.project_count}),l.jsx("td",{className:"px-4 py-3 align-middle",children:l.jsx("span",{className:`inline-flex items-center rounded-full px-2 py-1 text-xs font-medium ${m(p.status)}`,children:p.status.charAt(0).toUpperCase()+p.status.slice(1)})}),l.jsx("td",{className:"px-4 py-3 align-middle text-sm text-slate-600",children:h(p.last_active)}),l.jsx("td",{className:"px-4 py-3 align-middle",children:l.jsx("button",{onClick:x=>{x.stopPropagation(),window.location.href=`/admin/organisations/${p.id}`},className:"text-xs font-medium text-[#0A66C2] hover:underline",children:"Open"})})]},p.id))})]})})})]})}function _z({organisationId:e}){const[t,r]=F.useState(null),[s,n]=F.useState(null),[a,i]=F.useState([]),[o,c]=F.useState([]),[u,d]=F.useState(!0),[f,h]=F.useState(!1),[m,p]=F.useState(!1),[x,v]=F.useState(""),[y,w]=F.useState(10),[g,_]=F.useState(null),[b,k]=F.useState(""),[S,T]=F.useState("");F.useEffect(()=>{j()},[e]);const j=async()=>{try{const{data:M,error:J}=await pe.from("organisations").select("*").eq("id",e).single();if(J)throw J;r(M),w(M.seat_limit),T(new Date(M.created_at).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"}));const{data:G}=await pe.from("subscriptions").select("*").eq("organisation_id",e).maybeSingle();n(G),v((G==null?void 0:G.plan_name)||"Trial");const{data:D}=await pe.from("organisation_members").select("*").eq("organisation_id",e).order("activated_at",{ascending:!1,nullsFirst:!1}),K=await Promise.all((D||[]).map(async W=>{const{data:I}=await pe.from("profiles").select("email, full_name").eq("id",W.user_id).maybeSingle();return W.role==="owner"&&k((I==null?void 0:I.email)||"Unknown"),{...W,email:(I==null?void 0:I.email)||"Unknown",full_name:I==null?void 0:I.full_name}}));i(K);const{data:oe}=await pe.from("projects").select("*").eq("organisation_id",e).order("updated_at",{ascending:!1}),N=await Promise.all((oe||[]).map(async W=>{const{count:I}=await pe.from("quotes").select("*",{count:"exact",head:!0}).eq("project_id",W.id),{data:B}=await pe.from("profiles").select("email").eq("id",W.user_id).maybeSingle();return{...W,quote_count:I||0,owner_email:B==null?void 0:B.email}}));c(N)}catch(M){console.error("Error loading organisation:",M)}finally{d(!1)}},U=async()=>{if(t){h(!0);try{const{error:M}=await pe.from("organisations").update({seat_limit:y}).eq("id",e);if(M)throw M;if(s){const{error:J}=await pe.from("subscriptions").update({plan_name:x,seat_limit:y}).eq("organisation_id",e);if(J)throw J}_({type:"success",message:"Changes saved successfully"}),p(!1),await j()}catch(M){_({type:"error",message:M.message||"Failed to save changes"})}finally{h(!1)}}},H=async()=>{if(confirm("Suspend this organisation? Members will lose access immediately."))try{const{error:M}=await pe.from("organisations").update({status:"suspended"}).eq("id",e);if(M)throw M;_({type:"success",message:"Organisation suspended"}),await j()}catch(M){_({type:"error",message:M.message||"Failed to suspend organisation"})}},z=async()=>{try{const{error:M}=await pe.from("organisations").update({status:"active"}).eq("id",e);if(M)throw M;_({type:"success",message:"Organisation activated"}),await j()}catch(M){_({type:"error",message:M.message||"Failed to activate organisation"})}},q=M=>new Date(M).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"}),re=M=>{switch(M){case"trial":return"bg-amber-50 text-amber-700 border-amber-200";case"suspended":return"bg-rose-50 text-rose-700 border-rose-200";default:return"bg-emerald-50 text-emerald-700 border-emerald-200"}},X=a.filter(M=>M.status==="active"&&["owner","admin","member"].includes(M.role)).length;return u?l.jsx("div",{className:"px-6 py-6 max-w-7xl mx-auto",children:l.jsx("div",{className:"text-center py-12 text-slate-500",children:"Loading organisation..."})}):t?l.jsxs("div",{className:"px-6 py-6 max-w-7xl mx-auto",children:[g&&l.jsxs("div",{className:`fixed top-4 right-4 z-50 rounded-lg px-4 py-3 shadow-lg flex items-center gap-3 ${g.type==="success"?"bg-emerald-50 text-emerald-800 border border-emerald-200":"bg-rose-50 text-rose-800 border border-rose-200"}`,children:[g.type==="error"&&l.jsx(vt,{size:18}),l.jsx("span",{className:"text-sm font-medium",children:g.message}),l.jsx("button",{onClick:()=>_(null),className:"ml-2",children:l.jsx(cn,{size:16})})]}),l.jsxs("button",{onClick:()=>window.location.href="/admin/organisations",className:"inline-flex items-center gap-2 text-sm text-slate-600 hover:text-slate-900 mb-4",children:[l.jsx(gS,{size:16}),"Back to organisations"]}),l.jsxs("div",{className:"flex items-start justify-between mb-6",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-xl font-semibold text-slate-900",children:t.name}),l.jsxs("p",{className:"mt-1 text-sm text-slate-500",children:["Created ",S,"  Owner: ",b]})]}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("span",{className:`inline-flex items-center rounded-full border px-3 py-1 text-xs font-medium ${re(t.status)}`,children:t.status.charAt(0).toUpperCase()+t.status.slice(1)}),t.status==="suspended"?l.jsx("button",{onClick:z,className:"inline-flex items-center rounded-lg bg-emerald-600 px-4 py-2 text-sm font-semibold text-white shadow hover:bg-emerald-700 transition",children:"Activate"}):l.jsx("button",{onClick:H,className:"inline-flex items-center rounded-lg bg-rose-600 px-4 py-2 text-sm font-semibold text-white shadow hover:bg-rose-700 transition",children:"Suspend"})]})]}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[l.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[l.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white shadow-[0_4px_14px_rgba(15,23,42,0.06)] p-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx("h2",{className:"text-sm font-semibold text-slate-900",children:"Plan & seats"}),m?null:l.jsx("button",{onClick:()=>p(!0),className:"text-xs font-medium text-[#0A66C2] hover:underline",children:"Edit"})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Plan"}),l.jsxs("select",{value:x,onChange:M=>v(M.target.value),disabled:!m,className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-[#0A66C2] focus:border-[#0A66C2] disabled:bg-slate-50 disabled:text-slate-500",children:[l.jsx("option",{value:"Trial",children:"Trial (14 days)"}),l.jsx("option",{value:"Starter",children:"Starter"}),l.jsx("option",{value:"Pro",children:"Pro"}),l.jsx("option",{value:"Enterprise",children:"Enterprise"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Seat limit"}),l.jsx("input",{type:"number",value:y,onChange:M=>w(parseInt(M.target.value)||0),disabled:!m,className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-[#0A66C2] focus:border-[#0A66C2] disabled:bg-slate-50 disabled:text-slate-500"}),l.jsxs("p",{className:"mt-1 text-xs text-slate-500",children:["Currently using ",X," seats. Owners, admins, and members use a seat. Viewers are free."]}),y<X&&l.jsxs("p",{className:"mt-1 text-xs text-rose-600",children:["Warning: This organisation uses ",X," seats. Reducing to ",y," will place them over their limit."]})]}),m&&l.jsxs("div",{className:"flex items-center gap-3 pt-2",children:[l.jsx("button",{onClick:U,disabled:f,className:"px-4 py-2 rounded-lg bg-[#0A66C2] text-sm font-semibold text-white hover:bg-[#0952A0] disabled:opacity-50 transition",children:f?"Saving...":"Save changes"}),l.jsx("button",{onClick:()=>{p(!1),w(t.seat_limit),v((s==null?void 0:s.plan_name)||"Trial")},className:"px-4 py-2 text-sm font-medium text-slate-700 hover:text-slate-900",children:"Cancel"})]})]})]}),l.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white shadow-[0_4px_14px_rgba(15,23,42,0.06)] p-4",children:[l.jsx("h2",{className:"text-sm font-semibold text-slate-900 mb-3",children:"Members"}),l.jsx("p",{className:"text-xs text-slate-500 mb-4",children:"Overview of all members in this organisation. Seat-consuming roles are highlighted."}),l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full table-auto text-left text-sm",children:[l.jsx("thead",{children:l.jsxs("tr",{className:"border-b border-slate-100",children:[l.jsx("th",{className:"px-2 py-2 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Member"}),l.jsx("th",{className:"px-2 py-2 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Email"}),l.jsx("th",{className:"px-2 py-2 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Role"}),l.jsx("th",{className:"px-2 py-2 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Status"}),l.jsx("th",{className:"px-2 py-2 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Last active"})]})}),l.jsx("tbody",{children:a.map(M=>l.jsxs("tr",{className:"border-b border-slate-50",children:[l.jsx("td",{className:"px-2 py-2 text-sm text-slate-900",children:M.full_name||M.email.split("@")[0]}),l.jsx("td",{className:"px-2 py-2 text-sm text-slate-600",children:M.email}),l.jsx("td",{className:"px-2 py-2",children:l.jsx("span",{className:`inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium ${["owner","admin","member"].includes(M.role)?"bg-blue-50 text-blue-700":"bg-slate-50 text-slate-700"}`,children:M.role.charAt(0).toUpperCase()+M.role.slice(1)})}),l.jsx("td",{className:"px-2 py-2",children:l.jsx("span",{className:`inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium ${M.status==="active"?"bg-emerald-50 text-emerald-700":M.status==="invited"?"bg-slate-50 text-slate-700":"bg-rose-50 text-rose-700"}`,children:M.status.charAt(0).toUpperCase()+M.status.slice(1)})}),l.jsx("td",{className:"px-2 py-2 text-sm text-slate-600",children:M.activated_at?q(M.activated_at):"Never"})]},M.id))})]})})]}),l.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white shadow-[0_4px_14px_rgba(15,23,42,0.06)] p-4",children:[l.jsx("h2",{className:"text-sm font-semibold text-slate-900 mb-4",children:"Projects"}),l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full table-auto text-left text-sm",children:[l.jsx("thead",{children:l.jsxs("tr",{className:"border-b border-slate-100",children:[l.jsx("th",{className:"px-2 py-2 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Project"}),l.jsx("th",{className:"px-2 py-2 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Status"}),l.jsx("th",{className:"px-2 py-2 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Last updated"}),l.jsx("th",{className:"px-2 py-2 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Quotes"}),l.jsx("th",{className:"px-2 py-2 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Owner"})]})}),l.jsx("tbody",{children:o.length===0?l.jsx("tr",{children:l.jsx("td",{colSpan:5,className:"px-2 py-4 text-center text-sm text-slate-500",children:"No projects yet"})}):o.map(M=>l.jsxs("tr",{className:"border-b border-slate-50",children:[l.jsx("td",{className:"px-2 py-2 font-medium text-sm text-slate-900",children:M.name}),l.jsx("td",{className:"px-2 py-2",children:l.jsx("span",{className:`inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium ${M.status==="active"?"bg-emerald-50 text-emerald-700":"bg-slate-50 text-slate-700"}`,children:M.status.charAt(0).toUpperCase()+M.status.slice(1)})}),l.jsx("td",{className:"px-2 py-2 text-sm text-slate-600",children:q(M.updated_at)}),l.jsx("td",{className:"px-2 py-2 text-sm text-slate-800",children:M.quote_count}),l.jsx("td",{className:"px-2 py-2 text-sm text-slate-600",children:M.owner_email||""})]},M.id))})]})})]})]}),l.jsx("div",{children:l.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white shadow-[0_4px_14px_rgba(15,23,42,0.06)] p-4",children:[l.jsx("h2",{className:"text-sm font-semibold text-slate-900 mb-3",children:"Quick actions"}),l.jsx("div",{className:"space-y-2",children:l.jsx("button",{onClick:()=>navigator.clipboard.writeText(e),className:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-slate-50 rounded-lg transition",children:"Copy organisation ID"})})]})})]})]}):l.jsx("div",{className:"px-6 py-6 max-w-7xl mx-auto",children:l.jsx("div",{className:"text-center py-12 text-slate-500",children:"Organisation not found"})})}function bz(){const[e,t]=F.useState(""),[r,s]=F.useState("Trial"),[n,a]=F.useState(5),[i,o]=F.useState(""),[c,u]=F.useState(""),[d,f]=F.useState(!1),[h,m]=F.useState(null),p=async()=>{if(!e||!i){m({type:"error",message:"Please fill in all required fields"});return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(i)){m({type:"error",message:"Please enter a valid email address"});return}f(!0);try{const{data:{user:x}}=await pe.auth.getUser(),{data:v,error:y}=await pe.from("organisations").insert({name:e,status:r==="Trial"?"trial":"active",seat_limit:n,created_by_user_id:x==null?void 0:x.id}).select().single();if(y)throw y;const{error:w}=await pe.from("subscriptions").insert({organisation_id:v.id,plan_name:r,seat_limit:n,billing_status:"active"});if(w)throw w;let g="";const{data:_}=await pe.from("profiles").select("id").eq("email",i).maybeSingle();if(_)g=_.id;else{const k=Math.random().toString(36).slice(-12),{data:S,error:T}=await pe.auth.admin.createUser({email:i,password:k,email_confirm:!1});if(T)throw T;g=S.user.id}const{error:b}=await pe.from("organisation_members").insert({organisation_id:v.id,user_id:g,role:"owner",status:"invited",invited_by_user_id:x==null?void 0:x.id});if(b)throw b;window.location.href=`/admin/organisations/${v.id}`}catch(x){console.error("Error creating organisation:",x),m({type:"error",message:x.message||"Failed to create organisation"}),f(!1)}};return l.jsxs("div",{className:"px-6 py-6 max-w-3xl mx-auto",children:[h&&l.jsxs("div",{className:`fixed top-4 right-4 z-50 rounded-lg px-4 py-3 shadow-lg flex items-center gap-3 ${h.type==="success"?"bg-emerald-50 text-emerald-800 border border-emerald-200":"bg-rose-50 text-rose-800 border border-rose-200"}`,children:[h.type==="error"&&l.jsx(vt,{size:18}),l.jsx("span",{className:"text-sm font-medium",children:h.message}),l.jsx("button",{onClick:()=>m(null),className:"ml-2",children:l.jsx(cn,{size:16})})]}),l.jsxs("button",{onClick:()=>window.location.href="/admin/organisations",className:"inline-flex items-center gap-2 text-sm text-slate-600 hover:text-slate-900 mb-6",children:[l.jsx(gS,{size:16}),"Back to organisations"]}),l.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white shadow-[0_4px_14px_rgba(15,23,42,0.06)] p-6",children:[l.jsx("h1",{className:"text-xl font-semibold text-slate-900 mb-2",children:"Create organisation"}),l.jsx("p",{className:"text-sm text-slate-500 mb-6",children:"Set up a new organisation with a primary owner who will receive an invite email."}),l.jsxs("div",{className:"space-y-5",children:[l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Organisation name ",l.jsx("span",{className:"text-rose-600",children:"*"})]}),l.jsx("input",{type:"text",placeholder:"Optimal Fire",value:e,onChange:x=>t(x.target.value),className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-[#0A66C2] focus:border-[#0A66C2]"})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Plan ",l.jsx("span",{className:"text-rose-600",children:"*"})]}),l.jsxs("select",{value:r,onChange:x=>s(x.target.value),className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-[#0A66C2] focus:border-[#0A66C2]",children:[l.jsx("option",{value:"Trial",children:"Trial (14 days)"}),l.jsx("option",{value:"Starter",children:"Starter"}),l.jsx("option",{value:"Pro",children:"Pro"}),l.jsx("option",{value:"Enterprise",children:"Enterprise"})]})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Seat limit ",l.jsx("span",{className:"text-rose-600",children:"*"})]}),l.jsx("input",{type:"number",value:n,onChange:x=>a(parseInt(x.target.value)||0),min:"1",className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-[#0A66C2] focus:border-[#0A66C2]"}),l.jsx("p",{className:"mt-1 text-xs text-slate-500",children:"Owners, admins, and members use a seat. Viewers are free."})]})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Primary owner email ",l.jsx("span",{className:"text-rose-600",children:"*"})]}),l.jsx("input",{type:"email",placeholder:"owner@company.com",value:i,onChange:x=>o(x.target.value),className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-[#0A66C2] focus:border-[#0A66C2]"}),l.jsx("p",{className:"mt-1 text-xs text-slate-500",children:"We'll send an invite to this email. They'll become the Organisation Owner."})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Internal notes"}),l.jsx("textarea",{placeholder:"Optional admin-only notes about this organisation...",value:c,onChange:x=>u(x.target.value),rows:3,className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-[#0A66C2] focus:border-[#0A66C2] resize-none"})]})]}),l.jsxs("div",{className:"mt-6 flex items-center justify-end gap-3 pt-4 border-t border-slate-200",children:[l.jsx("button",{onClick:()=>window.location.href="/admin/organisations",className:"px-4 py-2 text-sm font-medium text-slate-700 hover:text-slate-900",disabled:d,children:"Cancel"}),l.jsx("button",{onClick:p,disabled:d||!e||!i,className:"px-4 py-2 rounded-lg bg-[#0A66C2] text-sm font-semibold text-white hover:bg-[#0952A0] disabled:opacity-50 disabled:cursor-not-allowed transition",children:d?"Creating...":"Create organisation"})]})]})]})}function Tw(){const[e,t]=F.useState("dashboard"),[r,s]=F.useState(null);F.useEffect(()=>{const i=window.location.pathname;if(i==="/admin"||i==="/admin/")t("dashboard");else if(i==="/admin/organisations")t("organisations");else if(i==="/admin/organisations/new")t("create-organisation");else if(i.startsWith("/admin/organisations/")){const o=i.split("/").pop();o&&(s(o),t("organisation-detail"))}},[]);const n=async()=>{await pe.auth.signOut(),window.location.href="/"},a=()=>{switch(e){case"dashboard":return l.jsx(Ew,{});case"organisations":return l.jsx(wz,{});case"organisation-detail":return r?l.jsx(_z,{organisationId:r}):null;case"create-organisation":return l.jsx(bz,{});default:return l.jsx(Ew,{})}};return l.jsxs("div",{className:"min-h-screen bg-slate-50 flex",children:[l.jsxs("div",{className:"w-64 bg-white border-r border-slate-200 flex flex-col",children:[l.jsx("div",{className:"p-6 border-b border-slate-200",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-blue-500 to-blue-600 flex items-center justify-center",children:l.jsx(Xl,{className:"text-white",size:20})}),l.jsxs("div",{children:[l.jsx("div",{className:"font-semibold text-slate-900",children:"Admin Console"}),l.jsx("div",{className:"text-xs text-slate-500",children:"Master Admin"})]})]})}),l.jsxs("nav",{className:"flex-1 p-4",children:[l.jsxs("button",{onClick:()=>window.location.href="/admin",className:`w-full flex items-center gap-3 px-4 py-2 rounded-lg text-sm font-medium transition ${e==="dashboard"?"bg-blue-50 text-blue-700":"text-slate-700 hover:bg-slate-50"}`,children:[l.jsx(Zh,{size:18}),"Dashboard"]}),l.jsxs("button",{onClick:()=>window.location.href="/admin/organisations",className:`w-full flex items-center gap-3 px-4 py-2 rounded-lg text-sm font-medium transition ${e==="organisations"||e==="organisation-detail"||e==="create-organisation"?"bg-blue-50 text-blue-700":"text-slate-700 hover:bg-slate-50"}`,children:[l.jsx(Xl,{size:18}),"Organisations"]})]}),l.jsxs("div",{className:"p-4 border-t border-slate-200 space-y-2",children:[l.jsxs("button",{onClick:()=>window.location.href="/",className:"w-full flex items-center gap-3 px-4 py-2 rounded-lg text-sm font-medium text-slate-700 hover:bg-slate-50 transition",children:[l.jsx(Zh,{size:18}),"Main App"]}),l.jsxs("button",{onClick:n,className:"w-full flex items-center gap-3 px-4 py-2 rounded-lg text-sm font-medium text-rose-600 hover:bg-rose-50 transition",children:[l.jsx(bS,{size:18}),"Logout"]})]})]}),l.jsx("div",{className:"flex-1 overflow-auto",children:a()})]})}const WT=F.createContext(null);function Sz({children:e}){const[t,r]=F.useState(!1),[s,n]=F.useState(!0);F.useEffect(()=>{a()},[]);const a=async()=>{try{const{data:{user:i}}=await pe.auth.getUser();if(!i){r(!1),n(!1);return}const{data:o}=await pe.from("platform_admins").select("is_active").eq("user_id",i.id).eq("is_active",!0).maybeSingle();r(!!o)}catch(i){console.error("Error checking admin status:",i),r(!1)}finally{n(!1)}};return l.jsx(WT.Provider,{value:{isMasterAdmin:t,loading:s},children:e})}function kz(){const e=F.useContext(WT);if(!e)throw new Error("useAdmin must be used within AdminProvider");return e}function Ez(){const[e,t]=F.useState(null),[r,s]=F.useState(!0),[n,a]=F.useState("dashboard"),[i,o]=F.useState("hub"),[c,u]=F.useState(null),[d,f]=F.useState(null),[h,m]=F.useState([]),[p,x]=F.useState(!0),[v,y]=F.useState(null),[w,g]=F.useState(!1),{currentOrganisation:_,organisations:b,loading:k,setCurrentOrganisation:S}=jo(),{isMasterAdmin:T,loading:j}=kz();F.useEffect(()=>{const G=setTimeout(()=>{r&&(console.warn("Auth loading timeout - forcing completion"),s(!1))},5e3);pe.auth.getSession().then(({data:{session:K}})=>{t(K),s(!1),clearTimeout(G)}).catch(K=>{console.error("Error loading session:",K),s(!1),clearTimeout(G)});const{data:{subscription:D}}=pe.auth.onAuthStateChange((K,oe)=>{(async()=>t(oe))()});return()=>{D.unsubscribe(),clearTimeout(G)}},[]),F.useEffect(()=>{!r&&e&&U()},[r,e]),F.useEffect(()=>{_&&U()},[_]),F.useEffect(()=>{c&&q(c)},[c]),F.useEffect(()=>{h.length===0&&_&&re()},[_]);const U=async()=>{x(!0),await re();const G=localStorage.getItem("passivefire_current_project_id");if(G&&_){const{data:D}=await pe.from("projects").select("id, name, client, reference").eq("id",G).eq("organisation_id",_.id).maybeSingle();D?(u(D.id),f(D)):(localStorage.removeItem("passivefire_current_project_id"),u(null),f(null))}x(!1)},H=async G=>{u(G),localStorage.setItem("passivefire_current_project_id",G),await pe.from("projects").update({last_accessed_at:new Date().toISOString()}).eq("id",G),await q(G)},z=async(G,D,K)=>{if(!_||!(e!=null&&e.user))return y({message:"Must be logged in to create a project",type:"error"}),null;try{const{data:oe,error:N}=await pe.from("projects").insert({organisation_id:_.id,name:G,client:D||null,reference:K||null,status:"active",created_by_user_id:e.user.id,user_id:e.user.id}).select().single();if(N)throw N;return await re(),y({message:`Project "${G}" created successfully`,type:"success"}),await H(oe.id),oe.id}catch(oe){return console.error("Error creating project:",oe),y({message:"Failed to create project",type:"error"}),null}},q=async G=>{const{data:D}=await pe.from("projects").select("id, name, client, reference").eq("id",G).maybeSingle();D&&f(D)},re=async()=>{if(!_)return;const{data:G,error:D}=await pe.from("projects").select("id, name, client, reference, updated_at, approved_quote_id").eq("organisation_id",_.id).order("updated_at",{ascending:!1});if(D){console.error("Error loading projects:",D);return}if(G){const K=await Promise.all(G.map(async oe=>{var B,ee,le,fe,se,ne,V;const{data:N}=await pe.from("award_reports").select("id, generated_at, status, result_json").eq("project_id",oe.id).eq("status","ready").order("generated_at",{ascending:!1}).limit(1).maybeSingle(),W=((le=(ee=(B=N==null?void 0:N.result_json)==null?void 0:B.awardSummary)==null?void 0:ee.suppliers)==null?void 0:le.length)||0,I=((V=(ne=(se=(fe=N==null?void 0:N.result_json)==null?void 0:fe.awardSummary)==null?void 0:se.suppliers)==null?void 0:ne[0])==null?void 0:V.coveragePercent)||0;return{id:oe.id,name:oe.name,client_reference:oe.client||oe.reference||"No client",updated_at:oe.updated_at,has_report:!!N,report_id:N==null?void 0:N.id,report_generated_at:N==null?void 0:N.generated_at,report_quotes_count:W,report_coverage_percent:Math.round(I)}}));m(K)}},X=G=>c?!0:(y({message:"Select or create a project first.",type:"error"}),!1),M=(G,D)=>{const K=D||c;switch(K&&u(K),G){case"dashboard":a("dashboard");break;case"quotes":a("quotes");break;case"review":a("review");break;case"quoteintel":a("quoteintel");break;case"scope":a("scope");break;case"reports":case"award":a("reports");break;case"contract":case"basetracker":a("contract");break;case"insights":a("insights");break;case"library":a("library");break;case"settings":a("settings");break;default:a("dashboard")}},J=()=>{switch(n){case"dashboard":return l.jsx(pn,{projectId:c,projectName:d==null?void 0:d.name,allProjects:h,onProjectSelect:H,onCreateProject:z,onNavigateToQuotes:()=>{X()&&a("quotes")},onNavigateToMatrix:()=>{X()&&a("scope")},onNavigateToReports:()=>{X()&&a("reports")},onNavigateToLibrary:()=>a("library")});case"quotes":return c?l.jsx(dR,{projectId:c,onQuotesImported:()=>{},onNavigateToDashboard:()=>a("dashboard"),onNavigateToNext:()=>a("review")}):l.jsx(pn,{projectId:null,projectName:void 0,allProjects:h,onProjectSelect:H,onCreateProject:z,onNavigateToQuotes:()=>{X()&&a("quotes")},onNavigateToMatrix:()=>{X()&&a("scope")},onNavigateToReports:()=>{X()&&a("reports")},onNavigateToLibrary:()=>a("library")});case"review":return c?l.jsx(SR,{projectId:c,onNavigateBack:()=>a("quotes"),onNavigateNext:()=>a("quoteintel")}):l.jsx(pn,{projectId:null,projectName:void 0,allProjects:h,onProjectSelect:H,onCreateProject:z,onNavigateToQuotes:()=>{X()&&a("quotes")},onNavigateToMatrix:()=>{X()&&a("scope")},onNavigateToReports:()=>{X()&&a("reports")},onNavigateToLibrary:()=>a("library")});case"quoteintel":return c?l.jsx(DV,{projectId:c,onNavigateBack:()=>a("review"),onNavigateNext:()=>a("scope")}):l.jsx(pn,{projectId:null,projectName:void 0,allProjects:h,onProjectSelect:H,onCreateProject:z,onNavigateToQuotes:()=>{X()&&a("quotes")},onNavigateToMatrix:()=>{X()&&a("scope")},onNavigateToReports:()=>{X()&&a("reports")},onNavigateToLibrary:()=>a("library")});case"scope":return c?l.jsx(WV,{projectId:c,onNavigateBack:()=>a("quoteintel"),onNavigateNext:()=>a("reports")}):l.jsx(pn,{projectId:null,projectName:void 0,allProjects:h,onProjectSelect:H,onCreateProject:z,onNavigateToQuotes:()=>{X()&&a("quotes")},onNavigateToMatrix:()=>{X()&&a("scope")},onNavigateToReports:()=>{X()&&a("reports")},onNavigateToLibrary:()=>a("library")});case"contract":return c?l.jsx(GV,{projectId:c}):l.jsx(pn,{projectId:null,projectName:void 0,allProjects:h,onProjectSelect:H,onCreateProject:z,onNavigateToQuotes:()=>{X()&&a("quotes")},onNavigateToMatrix:()=>{X()&&a("scope")},onNavigateToReports:()=>{X()&&a("reports")},onNavigateToLibrary:()=>a("library")});case"reports":return c?l.jsx(YV,{projectId:c,projects:h,onNavigateBackToScope:()=>a("scope"),onNavigateBackToDashboard:()=>a("dashboard")}):l.jsx(pn,{projectId:null,projectName:void 0,allProjects:h,onProjectSelect:H,onCreateProject:z,onNavigateToQuotes:()=>{X()&&a("quotes")},onNavigateToMatrix:()=>{X()&&a("scope")},onNavigateToReports:()=>{X()&&a("reports")},onNavigateToLibrary:()=>a("library")});case"insights":return c?l.jsx(JV,{projectId:c}):l.jsx(pn,{projectId:null,projectName:void 0,allProjects:h,onProjectSelect:H,onCreateProject:z,onNavigateToQuotes:()=>{X()&&a("quotes")},onNavigateToMatrix:()=>{X()&&a("scope")},onNavigateToReports:()=>{X()&&a("reports")},onNavigateToLibrary:()=>a("library")});case"library":return i==="templates"?l.jsx(ez,{onBack:()=>o("hub"),onNavigateToNewProject:()=>u(null)}):l.jsx(QV,{onNavigateToTemplates:()=>o("templates")});case"systemcheck":return l.jsx(VT,{});case"copilotaudit":return l.jsx(zT,{});case"settings":return c?l.jsx(fz,{projectId:c,onProjectDeleted:()=>u(null)}):l.jsxs("div",{className:"p-8",children:[l.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Settings"}),l.jsx("p",{className:"text-gray-600 mb-4",children:"Select a project to configure project-specific settings, or manage organisation settings below."}),l.jsx(yz,{})]});default:return l.jsx(pn,{projectId:c,projectName:d==null?void 0:d.name,allProjects:h,onProjectSelect:H,onCreateProject:z,onNavigateToQuotes:()=>{X()&&a("quotes")},onNavigateToMatrix:()=>{X()&&a("scope")},onNavigateToReports:()=>{X()&&a("reports")},onNavigateToLibrary:()=>a("library")})}};return r||k||j?l.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-600",children:"Loading..."})]})}):e?window.location.pathname.startsWith("/admin")?T?l.jsx(Tw,{}):(jp.show({type:"warning",title:"Access denied",body:"The Admin Console is only accessible to platform administrators.",duration:5e3}),setTimeout(()=>{window.location.href="/"},1e3),null):!_&&b.length>0?l.jsx(kw,{onOrganisationSelected:()=>{}}):_?p?l.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-600",children:"Loading..."})]})}):l.jsxs("div",{className:"min-h-screen bg-gray-50 flex overflow-x-hidden",children:[l.jsx(eR,{activeTab:n,onTabChange:a}),l.jsxs("div",{className:"flex-1 flex flex-col max-w-full overflow-x-hidden",children:[l.jsx(tR,{currentProjectId:c||void 0,currentProjectName:d==null?void 0:d.name,onProjectChange:H,onBackToDashboard:()=>{u(null),f(null),a("dashboard")},notificationCount:0,onNavigateToAccount:()=>a("settings"),onNavigateToBilling:()=>a("settings"),onSwitchOrganisation:()=>{S(null),u(null),f(null),m([]),a("dashboard")}}),l.jsx("main",{className:"flex-1 overflow-auto",children:J()}),l.jsx(xz,{})]}),l.jsx(Km,{children:v&&l.jsx(hz,{message:v.message,type:v.type,onClose:()=>y(null)})}),l.jsx(mz,{}),l.jsx("button",{onClick:()=>g(!0),className:"fixed bottom-6 right-6 w-14 h-14 bg-gradient-to-r from-purple-600 to-blue-600 text-white rounded-full shadow-lg hover:shadow-xl transition-all duration-200 flex items-center justify-center z-40 hover:scale-110",title:"Ask AI Copilot",children:l.jsx(kc,{size:24})}),l.jsx(gz,{isOpen:w,onClose:()=>g(!1),currentProjectId:c||void 0,allProjects:h.map(G=>({id:G.id,name:G.name})),onNavigate:M})]}):T?l.jsx(Tw,{}):l.jsx(kw,{onOrganisationSelected:()=>{}}):l.jsx(vz,{})}function Tz(){return l.jsx(Sz,{children:l.jsx(Q5,{children:l.jsx(Ez,{})})})}class Nz extends F.Component{constructor(t){super(t),this.state={hasError:!1,error:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,r){console.error("Error caught by boundary:",t,r)}render(){var t,r;return this.state.hasError?l.jsxs("div",{style:{padding:"40px",fontFamily:"system-ui, -apple-system, sans-serif",maxWidth:"800px",margin:"0 auto"},children:[l.jsx("h1",{style:{color:"#dc2626",marginBottom:"16px"},children:"Application Error"}),l.jsx("div",{style:{background:"#fee2e2",border:"1px solid #fecaca",borderRadius:"8px",padding:"16px",marginBottom:"16px"},children:l.jsx("p",{style:{margin:0,fontFamily:"monospace",fontSize:"14px"},children:((t=this.state.error)==null?void 0:t.message)||"Unknown error"})}),l.jsxs("details",{style:{marginTop:"16px"},children:[l.jsx("summary",{style:{cursor:"pointer",marginBottom:"8px"},children:"Stack Trace"}),l.jsx("pre",{style:{background:"#f3f4f6",padding:"12px",borderRadius:"4px",overflow:"auto",fontSize:"12px"},children:(r=this.state.error)==null?void 0:r.stack})]}),l.jsx("button",{onClick:()=>window.location.reload(),style:{marginTop:"24px",padding:"8px 16px",background:"#3b82f6",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"14px"},children:"Reload Page"})]}):this.props.children}}Mf.createRoot(document.getElementById("root")).render(l.jsx(dN.StrictMode,{children:l.jsx(Nz,{children:l.jsx(Tz,{})})}));
