var nj=Object.defineProperty;var aj=(e,t,r)=>t in e?nj(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var C0=(e,t,r)=>aj(e,typeof t!="symbol"?t+"":t,r);function ij(e,t){for(var r=0;r<t.length;r++){const s=t[r];if(typeof s!="string"&&!Array.isArray(s)){for(const n in s)if(n!=="default"&&!(n in e)){const a=Object.getOwnPropertyDescriptor(s,n);a&&Object.defineProperty(e,n,a.get?a:{enumerable:!0,get:()=>s[n]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function r(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(n){if(n.ep)return;n.ep=!0;const a=r(n);fetch(n.href,a)}})();function oj(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function lj(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function s(){return this instanceof s?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(s){var n=Object.getOwnPropertyDescriptor(e,s);Object.defineProperty(r,s,n.get?n:{enumerable:!0,get:function(){return e[s]}})}),r}var Mw={exports:{}},Vd={},Bw={exports:{}},st={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _c=Symbol.for("react.element"),cj=Symbol.for("react.portal"),uj=Symbol.for("react.fragment"),dj=Symbol.for("react.strict_mode"),fj=Symbol.for("react.profiler"),hj=Symbol.for("react.provider"),mj=Symbol.for("react.context"),pj=Symbol.for("react.forward_ref"),xj=Symbol.for("react.suspense"),gj=Symbol.for("react.memo"),vj=Symbol.for("react.lazy"),wg=Symbol.iterator;function yj(e){return e===null||typeof e!="object"?null:(e=wg&&e[wg]||e["@@iterator"],typeof e=="function"?e:null)}var Uw={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},zw=Object.assign,$w={};function Eo(e,t,r){this.props=e,this.context=t,this.refs=$w,this.updater=r||Uw}Eo.prototype.isReactComponent={};Eo.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Eo.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Vw(){}Vw.prototype=Eo.prototype;function Bm(e,t,r){this.props=e,this.context=t,this.refs=$w,this.updater=r||Uw}var Um=Bm.prototype=new Vw;Um.constructor=Bm;zw(Um,Eo.prototype);Um.isPureReactComponent=!0;var bg=Array.isArray,Ww=Object.prototype.hasOwnProperty,zm={current:null},qw={key:!0,ref:!0,__self:!0,__source:!0};function Hw(e,t,r){var s,n={},a=null,i=null;if(t!=null)for(s in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(a=""+t.key),t)Ww.call(t,s)&&!qw.hasOwnProperty(s)&&(n[s]=t[s]);var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];n.children=c}if(e&&e.defaultProps)for(s in l=e.defaultProps,l)n[s]===void 0&&(n[s]=l[s]);return{$$typeof:_c,type:e,key:a,ref:i,props:n,_owner:zm.current}}function wj(e,t){return{$$typeof:_c,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function $m(e){return typeof e=="object"&&e!==null&&e.$$typeof===_c}function bj(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var _g=/\/+/g;function A0(e,t){return typeof e=="object"&&e!==null&&e.key!=null?bj(""+e.key):t.toString(36)}function Fu(e,t,r,s,n){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(a){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case _c:case cj:i=!0}}if(i)return i=e,n=n(i),e=s===""?"."+A0(i,0):s,bg(n)?(r="",e!=null&&(r=e.replace(_g,"$&/")+"/"),Fu(n,t,r,"",function(u){return u})):n!=null&&($m(n)&&(n=wj(n,r+(!n.key||i&&i.key===n.key?"":(""+n.key).replace(_g,"$&/")+"/")+e)),t.push(n)),1;if(i=0,s=s===""?".":s+":",bg(e))for(var l=0;l<e.length;l++){a=e[l];var c=s+A0(a,l);i+=Fu(a,t,r,c,n)}else if(c=yj(e),typeof c=="function")for(e=c.call(e),l=0;!(a=e.next()).done;)a=a.value,c=s+A0(a,l++),i+=Fu(a,t,r,c,n);else if(a==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function Wc(e,t,r){if(e==null)return e;var s=[],n=0;return Fu(e,s,"","",function(a){return t.call(r,a,n++)}),s}function _j(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var $r={current:null},Pu={transition:null},Sj={ReactCurrentDispatcher:$r,ReactCurrentBatchConfig:Pu,ReactCurrentOwner:zm};function Gw(){throw Error("act(...) is not supported in production builds of React.")}st.Children={map:Wc,forEach:function(e,t,r){Wc(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Wc(e,function(){t++}),t},toArray:function(e){return Wc(e,function(t){return t})||[]},only:function(e){if(!$m(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};st.Component=Eo;st.Fragment=uj;st.Profiler=fj;st.PureComponent=Bm;st.StrictMode=dj;st.Suspense=xj;st.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Sj;st.act=Gw;st.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var s=zw({},e.props),n=e.key,a=e.ref,i=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,i=zm.current),t.key!==void 0&&(n=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)Ww.call(t,c)&&!qw.hasOwnProperty(c)&&(s[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)s.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];s.children=l}return{$$typeof:_c,type:e.type,key:n,ref:a,props:s,_owner:i}};st.createContext=function(e){return e={$$typeof:mj,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:hj,_context:e},e.Consumer=e};st.createElement=Hw;st.createFactory=function(e){var t=Hw.bind(null,e);return t.type=e,t};st.createRef=function(){return{current:null}};st.forwardRef=function(e){return{$$typeof:pj,render:e}};st.isValidElement=$m;st.lazy=function(e){return{$$typeof:vj,_payload:{_status:-1,_result:e},_init:_j}};st.memo=function(e,t){return{$$typeof:gj,type:e,compare:t===void 0?null:t}};st.startTransition=function(e){var t=Pu.transition;Pu.transition={};try{e()}finally{Pu.transition=t}};st.unstable_act=Gw;st.useCallback=function(e,t){return $r.current.useCallback(e,t)};st.useContext=function(e){return $r.current.useContext(e)};st.useDebugValue=function(){};st.useDeferredValue=function(e){return $r.current.useDeferredValue(e)};st.useEffect=function(e,t){return $r.current.useEffect(e,t)};st.useId=function(){return $r.current.useId()};st.useImperativeHandle=function(e,t,r){return $r.current.useImperativeHandle(e,t,r)};st.useInsertionEffect=function(e,t){return $r.current.useInsertionEffect(e,t)};st.useLayoutEffect=function(e,t){return $r.current.useLayoutEffect(e,t)};st.useMemo=function(e,t){return $r.current.useMemo(e,t)};st.useReducer=function(e,t,r){return $r.current.useReducer(e,t,r)};st.useRef=function(e){return $r.current.useRef(e)};st.useState=function(e){return $r.current.useState(e)};st.useSyncExternalStore=function(e,t,r){return $r.current.useSyncExternalStore(e,t,r)};st.useTransition=function(){return $r.current.useTransition()};st.version="18.3.1";Bw.exports=st;var j=Bw.exports;const kj=oj(j);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Nj=j,Ej=Symbol.for("react.element"),jj=Symbol.for("react.fragment"),Tj=Object.prototype.hasOwnProperty,Cj=Nj.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Aj={key:!0,ref:!0,__self:!0,__source:!0};function Kw(e,t,r){var s,n={},a=null,i=null;r!==void 0&&(a=""+r),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(i=t.ref);for(s in t)Tj.call(t,s)&&!Aj.hasOwnProperty(s)&&(n[s]=t[s]);if(e&&e.defaultProps)for(s in t=e.defaultProps,t)n[s]===void 0&&(n[s]=t[s]);return{$$typeof:Ej,type:e,key:a,ref:i,props:n,_owner:Cj.current}}Vd.Fragment=jj;Vd.jsx=Kw;Vd.jsxs=Kw;Mw.exports=Vd;var o=Mw.exports,Hf={},Xw={exports:{}},hs={},Qw={exports:{}},Yw={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(W,U){var he=W.length;W.push(U);e:for(;0<he;){var be=he-1>>>1,R=W[be];if(0<n(R,U))W[be]=U,W[he]=R,he=be;else break e}}function r(W){return W.length===0?null:W[0]}function s(W){if(W.length===0)return null;var U=W[0],he=W.pop();if(he!==U){W[0]=he;e:for(var be=0,R=W.length,M=R>>>1;be<M;){var O=2*(be+1)-1,z=W[O],J=O+1,pe=W[J];if(0>n(z,he))J<R&&0>n(pe,z)?(W[be]=pe,W[J]=he,be=J):(W[be]=z,W[O]=he,be=O);else if(J<R&&0>n(pe,he))W[be]=pe,W[J]=he,be=J;else break e}}return U}function n(W,U){var he=W.sortIndex-U.sortIndex;return he!==0?he:W.id-U.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var i=Date,l=i.now();e.unstable_now=function(){return i.now()-l}}var c=[],u=[],d=1,f=null,h=3,m=!1,x=!1,p=!1,g=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(W){for(var U=r(u);U!==null;){if(U.callback===null)s(u);else if(U.startTime<=W)s(u),U.sortIndex=U.expirationTime,t(c,U);else break;U=r(u)}}function b(W){if(p=!1,y(W),!x)if(r(c)!==null)x=!0,X(S);else{var U=r(u);U!==null&&ie(b,U.startTime-W)}}function S(W,U){x=!1,p&&(p=!1,w(N),N=-1),m=!0;var he=h;try{for(y(U),f=r(c);f!==null&&(!(f.expirationTime>U)||W&&!H());){var be=f.callback;if(typeof be=="function"){f.callback=null,h=f.priorityLevel;var R=be(f.expirationTime<=U);U=e.unstable_now(),typeof R=="function"?f.callback=R:f===r(c)&&s(c),y(U)}else s(c);f=r(c)}if(f!==null)var M=!0;else{var O=r(u);O!==null&&ie(b,O.startTime-U),M=!1}return M}finally{f=null,h=he,m=!1}}var k=!1,_=null,N=-1,C=5,B=-1;function H(){return!(e.unstable_now()-B<C)}function V(){if(_!==null){var W=e.unstable_now();B=W;var U=!0;try{U=_(!0,W)}finally{U?K():(k=!1,_=null)}}else k=!1}var K;if(typeof v=="function")K=function(){v(V)};else if(typeof MessageChannel<"u"){var Y=new MessageChannel,q=Y.port2;Y.port1.onmessage=V,K=function(){q.postMessage(null)}}else K=function(){g(V,0)};function X(W){_=W,k||(k=!0,K())}function ie(W,U){N=g(function(){W(e.unstable_now())},U)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(W){W.callback=null},e.unstable_continueExecution=function(){x||m||(x=!0,X(S))},e.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<W?Math.floor(1e3/W):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(W){switch(h){case 1:case 2:case 3:var U=3;break;default:U=h}var he=h;h=U;try{return W()}finally{h=he}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(W,U){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var he=h;h=W;try{return U()}finally{h=he}},e.unstable_scheduleCallback=function(W,U,he){var be=e.unstable_now();switch(typeof he=="object"&&he!==null?(he=he.delay,he=typeof he=="number"&&0<he?be+he:be):he=be,W){case 1:var R=-1;break;case 2:R=250;break;case 5:R=1073741823;break;case 4:R=1e4;break;default:R=5e3}return R=he+R,W={id:d++,callback:U,priorityLevel:W,startTime:he,expirationTime:R,sortIndex:-1},he>be?(W.sortIndex=he,t(u,W),r(c)===null&&W===r(u)&&(p?(w(N),N=-1):p=!0,ie(b,he-be))):(W.sortIndex=R,t(c,W),x||m||(x=!0,X(S))),W},e.unstable_shouldYield=H,e.unstable_wrapCallback=function(W){var U=h;return function(){var he=h;h=U;try{return W.apply(this,arguments)}finally{h=he}}}})(Yw);Qw.exports=Yw;var Fj=Qw.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Pj=j,ds=Fj;function Se(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Jw=new Set,Rl={};function ui(e,t){co(e,t),co(e+"Capture",t)}function co(e,t){for(Rl[e]=t,e=0;e<t.length;e++)Jw.add(t[e])}var Tn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Gf=Object.prototype.hasOwnProperty,Rj=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Sg={},kg={};function Ij(e){return Gf.call(kg,e)?!0:Gf.call(Sg,e)?!1:Rj.test(e)?kg[e]=!0:(Sg[e]=!0,!1)}function Oj(e,t,r,s){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return s?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Dj(e,t,r,s){if(t===null||typeof t>"u"||Oj(e,t,r,s))return!0;if(s)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Vr(e,t,r,s,n,a,i){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=s,this.attributeNamespace=n,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=i}var vr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){vr[e]=new Vr(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];vr[t]=new Vr(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){vr[e]=new Vr(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){vr[e]=new Vr(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){vr[e]=new Vr(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){vr[e]=new Vr(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){vr[e]=new Vr(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){vr[e]=new Vr(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){vr[e]=new Vr(e,5,!1,e.toLowerCase(),null,!1,!1)});var Vm=/[\-:]([a-z])/g;function Wm(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Vm,Wm);vr[t]=new Vr(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Vm,Wm);vr[t]=new Vr(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Vm,Wm);vr[t]=new Vr(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){vr[e]=new Vr(e,1,!1,e.toLowerCase(),null,!1,!1)});vr.xlinkHref=new Vr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){vr[e]=new Vr(e,1,!1,e.toLowerCase(),null,!0,!0)});function qm(e,t,r,s){var n=vr.hasOwnProperty(t)?vr[t]:null;(n!==null?n.type!==0:s||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Dj(t,r,n,s)&&(r=null),s||n===null?Ij(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):n.mustUseProperty?e[n.propertyName]=r===null?n.type===3?!1:"":r:(t=n.attributeName,s=n.attributeNamespace,r===null?e.removeAttribute(t):(n=n.type,r=n===3||n===4&&r===!0?"":""+r,s?e.setAttributeNS(s,t,r):e.setAttribute(t,r))))}var On=Pj.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,qc=Symbol.for("react.element"),Pi=Symbol.for("react.portal"),Ri=Symbol.for("react.fragment"),Hm=Symbol.for("react.strict_mode"),Kf=Symbol.for("react.profiler"),Zw=Symbol.for("react.provider"),e2=Symbol.for("react.context"),Gm=Symbol.for("react.forward_ref"),Xf=Symbol.for("react.suspense"),Qf=Symbol.for("react.suspense_list"),Km=Symbol.for("react.memo"),Vn=Symbol.for("react.lazy"),t2=Symbol.for("react.offscreen"),Ng=Symbol.iterator;function Wo(e){return e===null||typeof e!="object"?null:(e=Ng&&e[Ng]||e["@@iterator"],typeof e=="function"?e:null)}var Ot=Object.assign,F0;function el(e){if(F0===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);F0=t&&t[1]||""}return`
`+F0+e}var P0=!1;function R0(e,t){if(!e||P0)return"";P0=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var s=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){s=u}e.call(t.prototype)}else{try{throw Error()}catch(u){s=u}e()}}catch(u){if(u&&s&&typeof u.stack=="string"){for(var n=u.stack.split(`
`),a=s.stack.split(`
`),i=n.length-1,l=a.length-1;1<=i&&0<=l&&n[i]!==a[l];)l--;for(;1<=i&&0<=l;i--,l--)if(n[i]!==a[l]){if(i!==1||l!==1)do if(i--,l--,0>l||n[i]!==a[l]){var c=`
`+n[i].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=i&&0<=l);break}}}finally{P0=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?el(e):""}function Lj(e){switch(e.tag){case 5:return el(e.type);case 16:return el("Lazy");case 13:return el("Suspense");case 19:return el("SuspenseList");case 0:case 2:case 15:return e=R0(e.type,!1),e;case 11:return e=R0(e.type.render,!1),e;case 1:return e=R0(e.type,!0),e;default:return""}}function Yf(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Ri:return"Fragment";case Pi:return"Portal";case Kf:return"Profiler";case Hm:return"StrictMode";case Xf:return"Suspense";case Qf:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case e2:return(e.displayName||"Context")+".Consumer";case Zw:return(e._context.displayName||"Context")+".Provider";case Gm:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Km:return t=e.displayName||null,t!==null?t:Yf(e.type)||"Memo";case Vn:t=e._payload,e=e._init;try{return Yf(e(t))}catch{}}return null}function Mj(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Yf(t);case 8:return t===Hm?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function ia(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function r2(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Bj(e){var t=r2(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),s=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var n=r.get,a=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return n.call(this)},set:function(i){s=""+i,a.call(this,i)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return s},setValue:function(i){s=""+i},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Hc(e){e._valueTracker||(e._valueTracker=Bj(e))}function s2(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),s="";return e&&(s=r2(e)?e.checked?"true":"false":e.value),e=s,e!==r?(t.setValue(e),!0):!1}function Xu(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Jf(e,t){var r=t.checked;return Ot({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function Eg(e,t){var r=t.defaultValue==null?"":t.defaultValue,s=t.checked!=null?t.checked:t.defaultChecked;r=ia(t.value!=null?t.value:r),e._wrapperState={initialChecked:s,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function n2(e,t){t=t.checked,t!=null&&qm(e,"checked",t,!1)}function Zf(e,t){n2(e,t);var r=ia(t.value),s=t.type;if(r!=null)s==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(s==="submit"||s==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?eh(e,t.type,r):t.hasOwnProperty("defaultValue")&&eh(e,t.type,ia(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function jg(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var s=t.type;if(!(s!=="submit"&&s!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function eh(e,t,r){(t!=="number"||Xu(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var tl=Array.isArray;function Qi(e,t,r,s){if(e=e.options,t){t={};for(var n=0;n<r.length;n++)t["$"+r[n]]=!0;for(r=0;r<e.length;r++)n=t.hasOwnProperty("$"+e[r].value),e[r].selected!==n&&(e[r].selected=n),n&&s&&(e[r].defaultSelected=!0)}else{for(r=""+ia(r),t=null,n=0;n<e.length;n++){if(e[n].value===r){e[n].selected=!0,s&&(e[n].defaultSelected=!0);return}t!==null||e[n].disabled||(t=e[n])}t!==null&&(t.selected=!0)}}function th(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Se(91));return Ot({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Tg(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Se(92));if(tl(r)){if(1<r.length)throw Error(Se(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:ia(r)}}function a2(e,t){var r=ia(t.value),s=ia(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),s!=null&&(e.defaultValue=""+s)}function Cg(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function i2(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function rh(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?i2(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Gc,o2=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,s,n){MSApp.execUnsafeLocalFunction(function(){return e(t,r,s,n)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Gc=Gc||document.createElement("div"),Gc.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Gc.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Il(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var cl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Uj=["Webkit","ms","Moz","O"];Object.keys(cl).forEach(function(e){Uj.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),cl[t]=cl[e]})});function l2(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||cl.hasOwnProperty(e)&&cl[e]?(""+t).trim():t+"px"}function c2(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var s=r.indexOf("--")===0,n=l2(r,t[r],s);r==="float"&&(r="cssFloat"),s?e.setProperty(r,n):e[r]=n}}var zj=Ot({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function sh(e,t){if(t){if(zj[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Se(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Se(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Se(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Se(62))}}function nh(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ah=null;function Xm(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var ih=null,Yi=null,Ji=null;function Ag(e){if(e=Nc(e)){if(typeof ih!="function")throw Error(Se(280));var t=e.stateNode;t&&(t=Kd(t),ih(e.stateNode,e.type,t))}}function u2(e){Yi?Ji?Ji.push(e):Ji=[e]:Yi=e}function d2(){if(Yi){var e=Yi,t=Ji;if(Ji=Yi=null,Ag(e),t)for(e=0;e<t.length;e++)Ag(t[e])}}function f2(e,t){return e(t)}function h2(){}var I0=!1;function m2(e,t,r){if(I0)return e(t,r);I0=!0;try{return f2(e,t,r)}finally{I0=!1,(Yi!==null||Ji!==null)&&(h2(),d2())}}function Ol(e,t){var r=e.stateNode;if(r===null)return null;var s=Kd(r);if(s===null)return null;r=s[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(e=e.type,s=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!s;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Se(231,t,typeof r));return r}var oh=!1;if(Tn)try{var qo={};Object.defineProperty(qo,"passive",{get:function(){oh=!0}}),window.addEventListener("test",qo,qo),window.removeEventListener("test",qo,qo)}catch{oh=!1}function $j(e,t,r,s,n,a,i,l,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(d){this.onError(d)}}var ul=!1,Qu=null,Yu=!1,lh=null,Vj={onError:function(e){ul=!0,Qu=e}};function Wj(e,t,r,s,n,a,i,l,c){ul=!1,Qu=null,$j.apply(Vj,arguments)}function qj(e,t,r,s,n,a,i,l,c){if(Wj.apply(this,arguments),ul){if(ul){var u=Qu;ul=!1,Qu=null}else throw Error(Se(198));Yu||(Yu=!0,lh=u)}}function di(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function p2(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Fg(e){if(di(e)!==e)throw Error(Se(188))}function Hj(e){var t=e.alternate;if(!t){if(t=di(e),t===null)throw Error(Se(188));return t!==e?null:e}for(var r=e,s=t;;){var n=r.return;if(n===null)break;var a=n.alternate;if(a===null){if(s=n.return,s!==null){r=s;continue}break}if(n.child===a.child){for(a=n.child;a;){if(a===r)return Fg(n),e;if(a===s)return Fg(n),t;a=a.sibling}throw Error(Se(188))}if(r.return!==s.return)r=n,s=a;else{for(var i=!1,l=n.child;l;){if(l===r){i=!0,r=n,s=a;break}if(l===s){i=!0,s=n,r=a;break}l=l.sibling}if(!i){for(l=a.child;l;){if(l===r){i=!0,r=a,s=n;break}if(l===s){i=!0,s=a,r=n;break}l=l.sibling}if(!i)throw Error(Se(189))}}if(r.alternate!==s)throw Error(Se(190))}if(r.tag!==3)throw Error(Se(188));return r.stateNode.current===r?e:t}function x2(e){return e=Hj(e),e!==null?g2(e):null}function g2(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=g2(e);if(t!==null)return t;e=e.sibling}return null}var v2=ds.unstable_scheduleCallback,Pg=ds.unstable_cancelCallback,Gj=ds.unstable_shouldYield,Kj=ds.unstable_requestPaint,Vt=ds.unstable_now,Xj=ds.unstable_getCurrentPriorityLevel,Qm=ds.unstable_ImmediatePriority,y2=ds.unstable_UserBlockingPriority,Ju=ds.unstable_NormalPriority,Qj=ds.unstable_LowPriority,w2=ds.unstable_IdlePriority,Wd=null,cn=null;function Yj(e){if(cn&&typeof cn.onCommitFiberRoot=="function")try{cn.onCommitFiberRoot(Wd,e,void 0,(e.current.flags&128)===128)}catch{}}var Xs=Math.clz32?Math.clz32:eT,Jj=Math.log,Zj=Math.LN2;function eT(e){return e>>>=0,e===0?32:31-(Jj(e)/Zj|0)|0}var Kc=64,Xc=4194304;function rl(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Zu(e,t){var r=e.pendingLanes;if(r===0)return 0;var s=0,n=e.suspendedLanes,a=e.pingedLanes,i=r&268435455;if(i!==0){var l=i&~n;l!==0?s=rl(l):(a&=i,a!==0&&(s=rl(a)))}else i=r&~n,i!==0?s=rl(i):a!==0&&(s=rl(a));if(s===0)return 0;if(t!==0&&t!==s&&!(t&n)&&(n=s&-s,a=t&-t,n>=a||n===16&&(a&4194240)!==0))return t;if(s&4&&(s|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=s;0<t;)r=31-Xs(t),n=1<<r,s|=e[r],t&=~n;return s}function tT(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function rT(e,t){for(var r=e.suspendedLanes,s=e.pingedLanes,n=e.expirationTimes,a=e.pendingLanes;0<a;){var i=31-Xs(a),l=1<<i,c=n[i];c===-1?(!(l&r)||l&s)&&(n[i]=tT(l,t)):c<=t&&(e.expiredLanes|=l),a&=~l}}function ch(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function b2(){var e=Kc;return Kc<<=1,!(Kc&4194240)&&(Kc=64),e}function O0(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Sc(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Xs(t),e[t]=r}function sT(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var s=e.eventTimes;for(e=e.expirationTimes;0<r;){var n=31-Xs(r),a=1<<n;t[n]=0,s[n]=-1,e[n]=-1,r&=~a}}function Ym(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var s=31-Xs(r),n=1<<s;n&t|e[s]&t&&(e[s]|=t),r&=~n}}var mt=0;function _2(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var S2,Jm,k2,N2,E2,uh=!1,Qc=[],Jn=null,Zn=null,ea=null,Dl=new Map,Ll=new Map,qn=[],nT="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Rg(e,t){switch(e){case"focusin":case"focusout":Jn=null;break;case"dragenter":case"dragleave":Zn=null;break;case"mouseover":case"mouseout":ea=null;break;case"pointerover":case"pointerout":Dl.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ll.delete(t.pointerId)}}function Ho(e,t,r,s,n,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:r,eventSystemFlags:s,nativeEvent:a,targetContainers:[n]},t!==null&&(t=Nc(t),t!==null&&Jm(t)),e):(e.eventSystemFlags|=s,t=e.targetContainers,n!==null&&t.indexOf(n)===-1&&t.push(n),e)}function aT(e,t,r,s,n){switch(t){case"focusin":return Jn=Ho(Jn,e,t,r,s,n),!0;case"dragenter":return Zn=Ho(Zn,e,t,r,s,n),!0;case"mouseover":return ea=Ho(ea,e,t,r,s,n),!0;case"pointerover":var a=n.pointerId;return Dl.set(a,Ho(Dl.get(a)||null,e,t,r,s,n)),!0;case"gotpointercapture":return a=n.pointerId,Ll.set(a,Ho(Ll.get(a)||null,e,t,r,s,n)),!0}return!1}function j2(e){var t=Da(e.target);if(t!==null){var r=di(t);if(r!==null){if(t=r.tag,t===13){if(t=p2(r),t!==null){e.blockedOn=t,E2(e.priority,function(){k2(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Ru(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=dh(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var s=new r.constructor(r.type,r);ah=s,r.target.dispatchEvent(s),ah=null}else return t=Nc(r),t!==null&&Jm(t),e.blockedOn=r,!1;t.shift()}return!0}function Ig(e,t,r){Ru(e)&&r.delete(t)}function iT(){uh=!1,Jn!==null&&Ru(Jn)&&(Jn=null),Zn!==null&&Ru(Zn)&&(Zn=null),ea!==null&&Ru(ea)&&(ea=null),Dl.forEach(Ig),Ll.forEach(Ig)}function Go(e,t){e.blockedOn===t&&(e.blockedOn=null,uh||(uh=!0,ds.unstable_scheduleCallback(ds.unstable_NormalPriority,iT)))}function Ml(e){function t(n){return Go(n,e)}if(0<Qc.length){Go(Qc[0],e);for(var r=1;r<Qc.length;r++){var s=Qc[r];s.blockedOn===e&&(s.blockedOn=null)}}for(Jn!==null&&Go(Jn,e),Zn!==null&&Go(Zn,e),ea!==null&&Go(ea,e),Dl.forEach(t),Ll.forEach(t),r=0;r<qn.length;r++)s=qn[r],s.blockedOn===e&&(s.blockedOn=null);for(;0<qn.length&&(r=qn[0],r.blockedOn===null);)j2(r),r.blockedOn===null&&qn.shift()}var Zi=On.ReactCurrentBatchConfig,ed=!0;function oT(e,t,r,s){var n=mt,a=Zi.transition;Zi.transition=null;try{mt=1,Zm(e,t,r,s)}finally{mt=n,Zi.transition=a}}function lT(e,t,r,s){var n=mt,a=Zi.transition;Zi.transition=null;try{mt=4,Zm(e,t,r,s)}finally{mt=n,Zi.transition=a}}function Zm(e,t,r,s){if(ed){var n=dh(e,t,r,s);if(n===null)q0(e,t,s,td,r),Rg(e,s);else if(aT(n,e,t,r,s))s.stopPropagation();else if(Rg(e,s),t&4&&-1<nT.indexOf(e)){for(;n!==null;){var a=Nc(n);if(a!==null&&S2(a),a=dh(e,t,r,s),a===null&&q0(e,t,s,td,r),a===n)break;n=a}n!==null&&s.stopPropagation()}else q0(e,t,s,null,r)}}var td=null;function dh(e,t,r,s){if(td=null,e=Xm(s),e=Da(e),e!==null)if(t=di(e),t===null)e=null;else if(r=t.tag,r===13){if(e=p2(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return td=e,null}function T2(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Xj()){case Qm:return 1;case y2:return 4;case Ju:case Qj:return 16;case w2:return 536870912;default:return 16}default:return 16}}var Kn=null,ep=null,Iu=null;function C2(){if(Iu)return Iu;var e,t=ep,r=t.length,s,n="value"in Kn?Kn.value:Kn.textContent,a=n.length;for(e=0;e<r&&t[e]===n[e];e++);var i=r-e;for(s=1;s<=i&&t[r-s]===n[a-s];s++);return Iu=n.slice(e,1<s?1-s:void 0)}function Ou(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Yc(){return!0}function Og(){return!1}function ms(e){function t(r,s,n,a,i){this._reactName=r,this._targetInst=n,this.type=s,this.nativeEvent=a,this.target=i,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(r=e[l],this[l]=r?r(a):a[l]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?Yc:Og,this.isPropagationStopped=Og,this}return Ot(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Yc)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Yc)},persist:function(){},isPersistent:Yc}),t}var jo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},tp=ms(jo),kc=Ot({},jo,{view:0,detail:0}),cT=ms(kc),D0,L0,Ko,qd=Ot({},kc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:rp,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ko&&(Ko&&e.type==="mousemove"?(D0=e.screenX-Ko.screenX,L0=e.screenY-Ko.screenY):L0=D0=0,Ko=e),D0)},movementY:function(e){return"movementY"in e?e.movementY:L0}}),Dg=ms(qd),uT=Ot({},qd,{dataTransfer:0}),dT=ms(uT),fT=Ot({},kc,{relatedTarget:0}),M0=ms(fT),hT=Ot({},jo,{animationName:0,elapsedTime:0,pseudoElement:0}),mT=ms(hT),pT=Ot({},jo,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),xT=ms(pT),gT=Ot({},jo,{data:0}),Lg=ms(gT),vT={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},yT={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},wT={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function bT(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=wT[e])?!!t[e]:!1}function rp(){return bT}var _T=Ot({},kc,{key:function(e){if(e.key){var t=vT[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Ou(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?yT[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:rp,charCode:function(e){return e.type==="keypress"?Ou(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Ou(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),ST=ms(_T),kT=Ot({},qd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Mg=ms(kT),NT=Ot({},kc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:rp}),ET=ms(NT),jT=Ot({},jo,{propertyName:0,elapsedTime:0,pseudoElement:0}),TT=ms(jT),CT=Ot({},qd,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),AT=ms(CT),FT=[9,13,27,32],sp=Tn&&"CompositionEvent"in window,dl=null;Tn&&"documentMode"in document&&(dl=document.documentMode);var PT=Tn&&"TextEvent"in window&&!dl,A2=Tn&&(!sp||dl&&8<dl&&11>=dl),Bg=" ",Ug=!1;function F2(e,t){switch(e){case"keyup":return FT.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function P2(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Ii=!1;function RT(e,t){switch(e){case"compositionend":return P2(t);case"keypress":return t.which!==32?null:(Ug=!0,Bg);case"textInput":return e=t.data,e===Bg&&Ug?null:e;default:return null}}function IT(e,t){if(Ii)return e==="compositionend"||!sp&&F2(e,t)?(e=C2(),Iu=ep=Kn=null,Ii=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return A2&&t.locale!=="ko"?null:t.data;default:return null}}var OT={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function zg(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!OT[e.type]:t==="textarea"}function R2(e,t,r,s){u2(s),t=rd(t,"onChange"),0<t.length&&(r=new tp("onChange","change",null,r,s),e.push({event:r,listeners:t}))}var fl=null,Bl=null;function DT(e){W2(e,0)}function Hd(e){var t=Li(e);if(s2(t))return e}function LT(e,t){if(e==="change")return t}var I2=!1;if(Tn){var B0;if(Tn){var U0="oninput"in document;if(!U0){var $g=document.createElement("div");$g.setAttribute("oninput","return;"),U0=typeof $g.oninput=="function"}B0=U0}else B0=!1;I2=B0&&(!document.documentMode||9<document.documentMode)}function Vg(){fl&&(fl.detachEvent("onpropertychange",O2),Bl=fl=null)}function O2(e){if(e.propertyName==="value"&&Hd(Bl)){var t=[];R2(t,Bl,e,Xm(e)),m2(DT,t)}}function MT(e,t,r){e==="focusin"?(Vg(),fl=t,Bl=r,fl.attachEvent("onpropertychange",O2)):e==="focusout"&&Vg()}function BT(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Hd(Bl)}function UT(e,t){if(e==="click")return Hd(t)}function zT(e,t){if(e==="input"||e==="change")return Hd(t)}function $T(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Zs=typeof Object.is=="function"?Object.is:$T;function Ul(e,t){if(Zs(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),s=Object.keys(t);if(r.length!==s.length)return!1;for(s=0;s<r.length;s++){var n=r[s];if(!Gf.call(t,n)||!Zs(e[n],t[n]))return!1}return!0}function Wg(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function qg(e,t){var r=Wg(e);e=0;for(var s;r;){if(r.nodeType===3){if(s=e+r.textContent.length,e<=t&&s>=t)return{node:r,offset:t-e};e=s}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Wg(r)}}function D2(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?D2(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function L2(){for(var e=window,t=Xu();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Xu(e.document)}return t}function np(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function VT(e){var t=L2(),r=e.focusedElem,s=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&D2(r.ownerDocument.documentElement,r)){if(s!==null&&np(r)){if(t=s.start,e=s.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var n=r.textContent.length,a=Math.min(s.start,n);s=s.end===void 0?a:Math.min(s.end,n),!e.extend&&a>s&&(n=s,s=a,a=n),n=qg(r,a);var i=qg(r,s);n&&i&&(e.rangeCount!==1||e.anchorNode!==n.node||e.anchorOffset!==n.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(t=t.createRange(),t.setStart(n.node,n.offset),e.removeAllRanges(),a>s?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var WT=Tn&&"documentMode"in document&&11>=document.documentMode,Oi=null,fh=null,hl=null,hh=!1;function Hg(e,t,r){var s=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;hh||Oi==null||Oi!==Xu(s)||(s=Oi,"selectionStart"in s&&np(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),hl&&Ul(hl,s)||(hl=s,s=rd(fh,"onSelect"),0<s.length&&(t=new tp("onSelect","select",null,t,r),e.push({event:t,listeners:s}),t.target=Oi)))}function Jc(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Di={animationend:Jc("Animation","AnimationEnd"),animationiteration:Jc("Animation","AnimationIteration"),animationstart:Jc("Animation","AnimationStart"),transitionend:Jc("Transition","TransitionEnd")},z0={},M2={};Tn&&(M2=document.createElement("div").style,"AnimationEvent"in window||(delete Di.animationend.animation,delete Di.animationiteration.animation,delete Di.animationstart.animation),"TransitionEvent"in window||delete Di.transitionend.transition);function Gd(e){if(z0[e])return z0[e];if(!Di[e])return e;var t=Di[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in M2)return z0[e]=t[r];return e}var B2=Gd("animationend"),U2=Gd("animationiteration"),z2=Gd("animationstart"),$2=Gd("transitionend"),V2=new Map,Gg="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function pa(e,t){V2.set(e,t),ui(t,[e])}for(var $0=0;$0<Gg.length;$0++){var V0=Gg[$0],qT=V0.toLowerCase(),HT=V0[0].toUpperCase()+V0.slice(1);pa(qT,"on"+HT)}pa(B2,"onAnimationEnd");pa(U2,"onAnimationIteration");pa(z2,"onAnimationStart");pa("dblclick","onDoubleClick");pa("focusin","onFocus");pa("focusout","onBlur");pa($2,"onTransitionEnd");co("onMouseEnter",["mouseout","mouseover"]);co("onMouseLeave",["mouseout","mouseover"]);co("onPointerEnter",["pointerout","pointerover"]);co("onPointerLeave",["pointerout","pointerover"]);ui("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ui("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ui("onBeforeInput",["compositionend","keypress","textInput","paste"]);ui("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ui("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ui("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var sl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),GT=new Set("cancel close invalid load scroll toggle".split(" ").concat(sl));function Kg(e,t,r){var s=e.type||"unknown-event";e.currentTarget=r,qj(s,t,void 0,e),e.currentTarget=null}function W2(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var s=e[r],n=s.event;s=s.listeners;e:{var a=void 0;if(t)for(var i=s.length-1;0<=i;i--){var l=s[i],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==a&&n.isPropagationStopped())break e;Kg(n,l,u),a=c}else for(i=0;i<s.length;i++){if(l=s[i],c=l.instance,u=l.currentTarget,l=l.listener,c!==a&&n.isPropagationStopped())break e;Kg(n,l,u),a=c}}}if(Yu)throw e=lh,Yu=!1,lh=null,e}function yt(e,t){var r=t[vh];r===void 0&&(r=t[vh]=new Set);var s=e+"__bubble";r.has(s)||(q2(t,e,2,!1),r.add(s))}function W0(e,t,r){var s=0;t&&(s|=4),q2(r,e,s,t)}var Zc="_reactListening"+Math.random().toString(36).slice(2);function zl(e){if(!e[Zc]){e[Zc]=!0,Jw.forEach(function(r){r!=="selectionchange"&&(GT.has(r)||W0(r,!1,e),W0(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Zc]||(t[Zc]=!0,W0("selectionchange",!1,t))}}function q2(e,t,r,s){switch(T2(t)){case 1:var n=oT;break;case 4:n=lT;break;default:n=Zm}r=n.bind(null,t,r,e),n=void 0,!oh||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(n=!0),s?n!==void 0?e.addEventListener(t,r,{capture:!0,passive:n}):e.addEventListener(t,r,!0):n!==void 0?e.addEventListener(t,r,{passive:n}):e.addEventListener(t,r,!1)}function q0(e,t,r,s,n){var a=s;if(!(t&1)&&!(t&2)&&s!==null)e:for(;;){if(s===null)return;var i=s.tag;if(i===3||i===4){var l=s.stateNode.containerInfo;if(l===n||l.nodeType===8&&l.parentNode===n)break;if(i===4)for(i=s.return;i!==null;){var c=i.tag;if((c===3||c===4)&&(c=i.stateNode.containerInfo,c===n||c.nodeType===8&&c.parentNode===n))return;i=i.return}for(;l!==null;){if(i=Da(l),i===null)return;if(c=i.tag,c===5||c===6){s=a=i;continue e}l=l.parentNode}}s=s.return}m2(function(){var u=a,d=Xm(r),f=[];e:{var h=V2.get(e);if(h!==void 0){var m=tp,x=e;switch(e){case"keypress":if(Ou(r)===0)break e;case"keydown":case"keyup":m=ST;break;case"focusin":x="focus",m=M0;break;case"focusout":x="blur",m=M0;break;case"beforeblur":case"afterblur":m=M0;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=Dg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=dT;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=ET;break;case B2:case U2:case z2:m=mT;break;case $2:m=TT;break;case"scroll":m=cT;break;case"wheel":m=AT;break;case"copy":case"cut":case"paste":m=xT;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=Mg}var p=(t&4)!==0,g=!p&&e==="scroll",w=p?h!==null?h+"Capture":null:h;p=[];for(var v=u,y;v!==null;){y=v;var b=y.stateNode;if(y.tag===5&&b!==null&&(y=b,w!==null&&(b=Ol(v,w),b!=null&&p.push($l(v,b,y)))),g)break;v=v.return}0<p.length&&(h=new m(h,x,null,r,d),f.push({event:h,listeners:p}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",m=e==="mouseout"||e==="pointerout",h&&r!==ah&&(x=r.relatedTarget||r.fromElement)&&(Da(x)||x[Cn]))break e;if((m||h)&&(h=d.window===d?d:(h=d.ownerDocument)?h.defaultView||h.parentWindow:window,m?(x=r.relatedTarget||r.toElement,m=u,x=x?Da(x):null,x!==null&&(g=di(x),x!==g||x.tag!==5&&x.tag!==6)&&(x=null)):(m=null,x=u),m!==x)){if(p=Dg,b="onMouseLeave",w="onMouseEnter",v="mouse",(e==="pointerout"||e==="pointerover")&&(p=Mg,b="onPointerLeave",w="onPointerEnter",v="pointer"),g=m==null?h:Li(m),y=x==null?h:Li(x),h=new p(b,v+"leave",m,r,d),h.target=g,h.relatedTarget=y,b=null,Da(d)===u&&(p=new p(w,v+"enter",x,r,d),p.target=y,p.relatedTarget=g,b=p),g=b,m&&x)t:{for(p=m,w=x,v=0,y=p;y;y=wi(y))v++;for(y=0,b=w;b;b=wi(b))y++;for(;0<v-y;)p=wi(p),v--;for(;0<y-v;)w=wi(w),y--;for(;v--;){if(p===w||w!==null&&p===w.alternate)break t;p=wi(p),w=wi(w)}p=null}else p=null;m!==null&&Xg(f,h,m,p,!1),x!==null&&g!==null&&Xg(f,g,x,p,!0)}}e:{if(h=u?Li(u):window,m=h.nodeName&&h.nodeName.toLowerCase(),m==="select"||m==="input"&&h.type==="file")var S=LT;else if(zg(h))if(I2)S=zT;else{S=BT;var k=MT}else(m=h.nodeName)&&m.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(S=UT);if(S&&(S=S(e,u))){R2(f,S,r,d);break e}k&&k(e,h,u),e==="focusout"&&(k=h._wrapperState)&&k.controlled&&h.type==="number"&&eh(h,"number",h.value)}switch(k=u?Li(u):window,e){case"focusin":(zg(k)||k.contentEditable==="true")&&(Oi=k,fh=u,hl=null);break;case"focusout":hl=fh=Oi=null;break;case"mousedown":hh=!0;break;case"contextmenu":case"mouseup":case"dragend":hh=!1,Hg(f,r,d);break;case"selectionchange":if(WT)break;case"keydown":case"keyup":Hg(f,r,d)}var _;if(sp)e:{switch(e){case"compositionstart":var N="onCompositionStart";break e;case"compositionend":N="onCompositionEnd";break e;case"compositionupdate":N="onCompositionUpdate";break e}N=void 0}else Ii?F2(e,r)&&(N="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(N="onCompositionStart");N&&(A2&&r.locale!=="ko"&&(Ii||N!=="onCompositionStart"?N==="onCompositionEnd"&&Ii&&(_=C2()):(Kn=d,ep="value"in Kn?Kn.value:Kn.textContent,Ii=!0)),k=rd(u,N),0<k.length&&(N=new Lg(N,e,null,r,d),f.push({event:N,listeners:k}),_?N.data=_:(_=P2(r),_!==null&&(N.data=_)))),(_=PT?RT(e,r):IT(e,r))&&(u=rd(u,"onBeforeInput"),0<u.length&&(d=new Lg("onBeforeInput","beforeinput",null,r,d),f.push({event:d,listeners:u}),d.data=_))}W2(f,t)})}function $l(e,t,r){return{instance:e,listener:t,currentTarget:r}}function rd(e,t){for(var r=t+"Capture",s=[];e!==null;){var n=e,a=n.stateNode;n.tag===5&&a!==null&&(n=a,a=Ol(e,r),a!=null&&s.unshift($l(e,a,n)),a=Ol(e,t),a!=null&&s.push($l(e,a,n))),e=e.return}return s}function wi(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Xg(e,t,r,s,n){for(var a=t._reactName,i=[];r!==null&&r!==s;){var l=r,c=l.alternate,u=l.stateNode;if(c!==null&&c===s)break;l.tag===5&&u!==null&&(l=u,n?(c=Ol(r,a),c!=null&&i.unshift($l(r,c,l))):n||(c=Ol(r,a),c!=null&&i.push($l(r,c,l)))),r=r.return}i.length!==0&&e.push({event:t,listeners:i})}var KT=/\r\n?/g,XT=/\u0000|\uFFFD/g;function Qg(e){return(typeof e=="string"?e:""+e).replace(KT,`
`).replace(XT,"")}function eu(e,t,r){if(t=Qg(t),Qg(e)!==t&&r)throw Error(Se(425))}function sd(){}var mh=null,ph=null;function xh(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var gh=typeof setTimeout=="function"?setTimeout:void 0,QT=typeof clearTimeout=="function"?clearTimeout:void 0,Yg=typeof Promise=="function"?Promise:void 0,YT=typeof queueMicrotask=="function"?queueMicrotask:typeof Yg<"u"?function(e){return Yg.resolve(null).then(e).catch(JT)}:gh;function JT(e){setTimeout(function(){throw e})}function H0(e,t){var r=t,s=0;do{var n=r.nextSibling;if(e.removeChild(r),n&&n.nodeType===8)if(r=n.data,r==="/$"){if(s===0){e.removeChild(n),Ml(t);return}s--}else r!=="$"&&r!=="$?"&&r!=="$!"||s++;r=n}while(r);Ml(t)}function ta(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Jg(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var To=Math.random().toString(36).slice(2),on="__reactFiber$"+To,Vl="__reactProps$"+To,Cn="__reactContainer$"+To,vh="__reactEvents$"+To,ZT="__reactListeners$"+To,e4="__reactHandles$"+To;function Da(e){var t=e[on];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Cn]||r[on]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=Jg(e);e!==null;){if(r=e[on])return r;e=Jg(e)}return t}e=r,r=e.parentNode}return null}function Nc(e){return e=e[on]||e[Cn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Li(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Se(33))}function Kd(e){return e[Vl]||null}var yh=[],Mi=-1;function xa(e){return{current:e}}function bt(e){0>Mi||(e.current=yh[Mi],yh[Mi]=null,Mi--)}function vt(e,t){Mi++,yh[Mi]=e.current,e.current=t}var oa={},Fr=xa(oa),Kr=xa(!1),Ya=oa;function uo(e,t){var r=e.type.contextTypes;if(!r)return oa;var s=e.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===t)return s.__reactInternalMemoizedMaskedChildContext;var n={},a;for(a in r)n[a]=t[a];return s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=n),n}function Xr(e){return e=e.childContextTypes,e!=null}function nd(){bt(Kr),bt(Fr)}function Zg(e,t,r){if(Fr.current!==oa)throw Error(Se(168));vt(Fr,t),vt(Kr,r)}function H2(e,t,r){var s=e.stateNode;if(t=t.childContextTypes,typeof s.getChildContext!="function")return r;s=s.getChildContext();for(var n in s)if(!(n in t))throw Error(Se(108,Mj(e)||"Unknown",n));return Ot({},r,s)}function ad(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||oa,Ya=Fr.current,vt(Fr,e),vt(Kr,Kr.current),!0}function ev(e,t,r){var s=e.stateNode;if(!s)throw Error(Se(169));r?(e=H2(e,t,Ya),s.__reactInternalMemoizedMergedChildContext=e,bt(Kr),bt(Fr),vt(Fr,e)):bt(Kr),vt(Kr,r)}var yn=null,Xd=!1,G0=!1;function G2(e){yn===null?yn=[e]:yn.push(e)}function t4(e){Xd=!0,G2(e)}function ga(){if(!G0&&yn!==null){G0=!0;var e=0,t=mt;try{var r=yn;for(mt=1;e<r.length;e++){var s=r[e];do s=s(!0);while(s!==null)}yn=null,Xd=!1}catch(n){throw yn!==null&&(yn=yn.slice(e+1)),v2(Qm,ga),n}finally{mt=t,G0=!1}}return null}var Bi=[],Ui=0,id=null,od=0,Ns=[],Es=0,Ja=null,wn=1,bn="";function Ta(e,t){Bi[Ui++]=od,Bi[Ui++]=id,id=e,od=t}function K2(e,t,r){Ns[Es++]=wn,Ns[Es++]=bn,Ns[Es++]=Ja,Ja=e;var s=wn;e=bn;var n=32-Xs(s)-1;s&=~(1<<n),r+=1;var a=32-Xs(t)+n;if(30<a){var i=n-n%5;a=(s&(1<<i)-1).toString(32),s>>=i,n-=i,wn=1<<32-Xs(t)+n|r<<n|s,bn=a+e}else wn=1<<a|r<<n|s,bn=e}function ap(e){e.return!==null&&(Ta(e,1),K2(e,1,0))}function ip(e){for(;e===id;)id=Bi[--Ui],Bi[Ui]=null,od=Bi[--Ui],Bi[Ui]=null;for(;e===Ja;)Ja=Ns[--Es],Ns[Es]=null,bn=Ns[--Es],Ns[Es]=null,wn=Ns[--Es],Ns[Es]=null}var us=null,cs=null,kt=!1,qs=null;function X2(e,t){var r=Ts(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function tv(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,us=e,cs=ta(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,us=e,cs=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Ja!==null?{id:wn,overflow:bn}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Ts(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,us=e,cs=null,!0):!1;default:return!1}}function wh(e){return(e.mode&1)!==0&&(e.flags&128)===0}function bh(e){if(kt){var t=cs;if(t){var r=t;if(!tv(e,t)){if(wh(e))throw Error(Se(418));t=ta(r.nextSibling);var s=us;t&&tv(e,t)?X2(s,r):(e.flags=e.flags&-4097|2,kt=!1,us=e)}}else{if(wh(e))throw Error(Se(418));e.flags=e.flags&-4097|2,kt=!1,us=e}}}function rv(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;us=e}function tu(e){if(e!==us)return!1;if(!kt)return rv(e),kt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!xh(e.type,e.memoizedProps)),t&&(t=cs)){if(wh(e))throw Q2(),Error(Se(418));for(;t;)X2(e,t),t=ta(t.nextSibling)}if(rv(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Se(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){cs=ta(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}cs=null}}else cs=us?ta(e.stateNode.nextSibling):null;return!0}function Q2(){for(var e=cs;e;)e=ta(e.nextSibling)}function fo(){cs=us=null,kt=!1}function op(e){qs===null?qs=[e]:qs.push(e)}var r4=On.ReactCurrentBatchConfig;function Xo(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Se(309));var s=r.stateNode}if(!s)throw Error(Se(147,e));var n=s,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(i){var l=n.refs;i===null?delete l[a]:l[a]=i},t._stringRef=a,t)}if(typeof e!="string")throw Error(Se(284));if(!r._owner)throw Error(Se(290,e))}return e}function ru(e,t){throw e=Object.prototype.toString.call(t),Error(Se(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function sv(e){var t=e._init;return t(e._payload)}function Y2(e){function t(w,v){if(e){var y=w.deletions;y===null?(w.deletions=[v],w.flags|=16):y.push(v)}}function r(w,v){if(!e)return null;for(;v!==null;)t(w,v),v=v.sibling;return null}function s(w,v){for(w=new Map;v!==null;)v.key!==null?w.set(v.key,v):w.set(v.index,v),v=v.sibling;return w}function n(w,v){return w=aa(w,v),w.index=0,w.sibling=null,w}function a(w,v,y){return w.index=y,e?(y=w.alternate,y!==null?(y=y.index,y<v?(w.flags|=2,v):y):(w.flags|=2,v)):(w.flags|=1048576,v)}function i(w){return e&&w.alternate===null&&(w.flags|=2),w}function l(w,v,y,b){return v===null||v.tag!==6?(v=ef(y,w.mode,b),v.return=w,v):(v=n(v,y),v.return=w,v)}function c(w,v,y,b){var S=y.type;return S===Ri?d(w,v,y.props.children,b,y.key):v!==null&&(v.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Vn&&sv(S)===v.type)?(b=n(v,y.props),b.ref=Xo(w,v,y),b.return=w,b):(b=$u(y.type,y.key,y.props,null,w.mode,b),b.ref=Xo(w,v,y),b.return=w,b)}function u(w,v,y,b){return v===null||v.tag!==4||v.stateNode.containerInfo!==y.containerInfo||v.stateNode.implementation!==y.implementation?(v=tf(y,w.mode,b),v.return=w,v):(v=n(v,y.children||[]),v.return=w,v)}function d(w,v,y,b,S){return v===null||v.tag!==7?(v=Wa(y,w.mode,b,S),v.return=w,v):(v=n(v,y),v.return=w,v)}function f(w,v,y){if(typeof v=="string"&&v!==""||typeof v=="number")return v=ef(""+v,w.mode,y),v.return=w,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case qc:return y=$u(v.type,v.key,v.props,null,w.mode,y),y.ref=Xo(w,null,v),y.return=w,y;case Pi:return v=tf(v,w.mode,y),v.return=w,v;case Vn:var b=v._init;return f(w,b(v._payload),y)}if(tl(v)||Wo(v))return v=Wa(v,w.mode,y,null),v.return=w,v;ru(w,v)}return null}function h(w,v,y,b){var S=v!==null?v.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return S!==null?null:l(w,v,""+y,b);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case qc:return y.key===S?c(w,v,y,b):null;case Pi:return y.key===S?u(w,v,y,b):null;case Vn:return S=y._init,h(w,v,S(y._payload),b)}if(tl(y)||Wo(y))return S!==null?null:d(w,v,y,b,null);ru(w,y)}return null}function m(w,v,y,b,S){if(typeof b=="string"&&b!==""||typeof b=="number")return w=w.get(y)||null,l(v,w,""+b,S);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case qc:return w=w.get(b.key===null?y:b.key)||null,c(v,w,b,S);case Pi:return w=w.get(b.key===null?y:b.key)||null,u(v,w,b,S);case Vn:var k=b._init;return m(w,v,y,k(b._payload),S)}if(tl(b)||Wo(b))return w=w.get(y)||null,d(v,w,b,S,null);ru(v,b)}return null}function x(w,v,y,b){for(var S=null,k=null,_=v,N=v=0,C=null;_!==null&&N<y.length;N++){_.index>N?(C=_,_=null):C=_.sibling;var B=h(w,_,y[N],b);if(B===null){_===null&&(_=C);break}e&&_&&B.alternate===null&&t(w,_),v=a(B,v,N),k===null?S=B:k.sibling=B,k=B,_=C}if(N===y.length)return r(w,_),kt&&Ta(w,N),S;if(_===null){for(;N<y.length;N++)_=f(w,y[N],b),_!==null&&(v=a(_,v,N),k===null?S=_:k.sibling=_,k=_);return kt&&Ta(w,N),S}for(_=s(w,_);N<y.length;N++)C=m(_,w,N,y[N],b),C!==null&&(e&&C.alternate!==null&&_.delete(C.key===null?N:C.key),v=a(C,v,N),k===null?S=C:k.sibling=C,k=C);return e&&_.forEach(function(H){return t(w,H)}),kt&&Ta(w,N),S}function p(w,v,y,b){var S=Wo(y);if(typeof S!="function")throw Error(Se(150));if(y=S.call(y),y==null)throw Error(Se(151));for(var k=S=null,_=v,N=v=0,C=null,B=y.next();_!==null&&!B.done;N++,B=y.next()){_.index>N?(C=_,_=null):C=_.sibling;var H=h(w,_,B.value,b);if(H===null){_===null&&(_=C);break}e&&_&&H.alternate===null&&t(w,_),v=a(H,v,N),k===null?S=H:k.sibling=H,k=H,_=C}if(B.done)return r(w,_),kt&&Ta(w,N),S;if(_===null){for(;!B.done;N++,B=y.next())B=f(w,B.value,b),B!==null&&(v=a(B,v,N),k===null?S=B:k.sibling=B,k=B);return kt&&Ta(w,N),S}for(_=s(w,_);!B.done;N++,B=y.next())B=m(_,w,N,B.value,b),B!==null&&(e&&B.alternate!==null&&_.delete(B.key===null?N:B.key),v=a(B,v,N),k===null?S=B:k.sibling=B,k=B);return e&&_.forEach(function(V){return t(w,V)}),kt&&Ta(w,N),S}function g(w,v,y,b){if(typeof y=="object"&&y!==null&&y.type===Ri&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case qc:e:{for(var S=y.key,k=v;k!==null;){if(k.key===S){if(S=y.type,S===Ri){if(k.tag===7){r(w,k.sibling),v=n(k,y.props.children),v.return=w,w=v;break e}}else if(k.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Vn&&sv(S)===k.type){r(w,k.sibling),v=n(k,y.props),v.ref=Xo(w,k,y),v.return=w,w=v;break e}r(w,k);break}else t(w,k);k=k.sibling}y.type===Ri?(v=Wa(y.props.children,w.mode,b,y.key),v.return=w,w=v):(b=$u(y.type,y.key,y.props,null,w.mode,b),b.ref=Xo(w,v,y),b.return=w,w=b)}return i(w);case Pi:e:{for(k=y.key;v!==null;){if(v.key===k)if(v.tag===4&&v.stateNode.containerInfo===y.containerInfo&&v.stateNode.implementation===y.implementation){r(w,v.sibling),v=n(v,y.children||[]),v.return=w,w=v;break e}else{r(w,v);break}else t(w,v);v=v.sibling}v=tf(y,w.mode,b),v.return=w,w=v}return i(w);case Vn:return k=y._init,g(w,v,k(y._payload),b)}if(tl(y))return x(w,v,y,b);if(Wo(y))return p(w,v,y,b);ru(w,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,v!==null&&v.tag===6?(r(w,v.sibling),v=n(v,y),v.return=w,w=v):(r(w,v),v=ef(y,w.mode,b),v.return=w,w=v),i(w)):r(w,v)}return g}var ho=Y2(!0),J2=Y2(!1),ld=xa(null),cd=null,zi=null,lp=null;function cp(){lp=zi=cd=null}function up(e){var t=ld.current;bt(ld),e._currentValue=t}function _h(e,t,r){for(;e!==null;){var s=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,s!==null&&(s.childLanes|=t)):s!==null&&(s.childLanes&t)!==t&&(s.childLanes|=t),e===r)break;e=e.return}}function eo(e,t){cd=e,lp=zi=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Hr=!0),e.firstContext=null)}function Rs(e){var t=e._currentValue;if(lp!==e)if(e={context:e,memoizedValue:t,next:null},zi===null){if(cd===null)throw Error(Se(308));zi=e,cd.dependencies={lanes:0,firstContext:e}}else zi=zi.next=e;return t}var La=null;function dp(e){La===null?La=[e]:La.push(e)}function Z2(e,t,r,s){var n=t.interleaved;return n===null?(r.next=r,dp(t)):(r.next=n.next,n.next=r),t.interleaved=r,An(e,s)}function An(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Wn=!1;function fp(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function eb(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function kn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ra(e,t,r){var s=e.updateQueue;if(s===null)return null;if(s=s.shared,ot&2){var n=s.pending;return n===null?t.next=t:(t.next=n.next,n.next=t),s.pending=t,An(e,r)}return n=s.interleaved,n===null?(t.next=t,dp(s)):(t.next=n.next,n.next=t),s.interleaved=t,An(e,r)}function Du(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var s=t.lanes;s&=e.pendingLanes,r|=s,t.lanes=r,Ym(e,r)}}function nv(e,t){var r=e.updateQueue,s=e.alternate;if(s!==null&&(s=s.updateQueue,r===s)){var n=null,a=null;if(r=r.firstBaseUpdate,r!==null){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};a===null?n=a=i:a=a.next=i,r=r.next}while(r!==null);a===null?n=a=t:a=a.next=t}else n=a=t;r={baseState:s.baseState,firstBaseUpdate:n,lastBaseUpdate:a,shared:s.shared,effects:s.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function ud(e,t,r,s){var n=e.updateQueue;Wn=!1;var a=n.firstBaseUpdate,i=n.lastBaseUpdate,l=n.shared.pending;if(l!==null){n.shared.pending=null;var c=l,u=c.next;c.next=null,i===null?a=u:i.next=u,i=c;var d=e.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==i&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(a!==null){var f=n.baseState;i=0,d=u=c=null,l=a;do{var h=l.lane,m=l.eventTime;if((s&h)===h){d!==null&&(d=d.next={eventTime:m,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var x=e,p=l;switch(h=t,m=r,p.tag){case 1:if(x=p.payload,typeof x=="function"){f=x.call(m,f,h);break e}f=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=p.payload,h=typeof x=="function"?x.call(m,f,h):x,h==null)break e;f=Ot({},f,h);break e;case 2:Wn=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,h=n.effects,h===null?n.effects=[l]:h.push(l))}else m={eventTime:m,lane:h,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=m,c=f):d=d.next=m,i|=h;if(l=l.next,l===null){if(l=n.shared.pending,l===null)break;h=l,l=h.next,h.next=null,n.lastBaseUpdate=h,n.shared.pending=null}}while(!0);if(d===null&&(c=f),n.baseState=c,n.firstBaseUpdate=u,n.lastBaseUpdate=d,t=n.shared.interleaved,t!==null){n=t;do i|=n.lane,n=n.next;while(n!==t)}else a===null&&(n.shared.lanes=0);ei|=i,e.lanes=i,e.memoizedState=f}}function av(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var s=e[t],n=s.callback;if(n!==null){if(s.callback=null,s=r,typeof n!="function")throw Error(Se(191,n));n.call(s)}}}var Ec={},un=xa(Ec),Wl=xa(Ec),ql=xa(Ec);function Ma(e){if(e===Ec)throw Error(Se(174));return e}function hp(e,t){switch(vt(ql,t),vt(Wl,e),vt(un,Ec),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:rh(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=rh(t,e)}bt(un),vt(un,t)}function mo(){bt(un),bt(Wl),bt(ql)}function tb(e){Ma(ql.current);var t=Ma(un.current),r=rh(t,e.type);t!==r&&(vt(Wl,e),vt(un,r))}function mp(e){Wl.current===e&&(bt(un),bt(Wl))}var At=xa(0);function dd(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var K0=[];function pp(){for(var e=0;e<K0.length;e++)K0[e]._workInProgressVersionPrimary=null;K0.length=0}var Lu=On.ReactCurrentDispatcher,X0=On.ReactCurrentBatchConfig,Za=0,It=null,er=null,or=null,fd=!1,ml=!1,Hl=0,s4=0;function wr(){throw Error(Se(321))}function xp(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Zs(e[r],t[r]))return!1;return!0}function gp(e,t,r,s,n,a){if(Za=a,It=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Lu.current=e===null||e.memoizedState===null?o4:l4,e=r(s,n),ml){a=0;do{if(ml=!1,Hl=0,25<=a)throw Error(Se(301));a+=1,or=er=null,t.updateQueue=null,Lu.current=c4,e=r(s,n)}while(ml)}if(Lu.current=hd,t=er!==null&&er.next!==null,Za=0,or=er=It=null,fd=!1,t)throw Error(Se(300));return e}function vp(){var e=Hl!==0;return Hl=0,e}function an(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return or===null?It.memoizedState=or=e:or=or.next=e,or}function Is(){if(er===null){var e=It.alternate;e=e!==null?e.memoizedState:null}else e=er.next;var t=or===null?It.memoizedState:or.next;if(t!==null)or=t,er=e;else{if(e===null)throw Error(Se(310));er=e,e={memoizedState:er.memoizedState,baseState:er.baseState,baseQueue:er.baseQueue,queue:er.queue,next:null},or===null?It.memoizedState=or=e:or=or.next=e}return or}function Gl(e,t){return typeof t=="function"?t(e):t}function Q0(e){var t=Is(),r=t.queue;if(r===null)throw Error(Se(311));r.lastRenderedReducer=e;var s=er,n=s.baseQueue,a=r.pending;if(a!==null){if(n!==null){var i=n.next;n.next=a.next,a.next=i}s.baseQueue=n=a,r.pending=null}if(n!==null){a=n.next,s=s.baseState;var l=i=null,c=null,u=a;do{var d=u.lane;if((Za&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),s=u.hasEagerState?u.eagerState:e(s,u.action);else{var f={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=f,i=s):c=c.next=f,It.lanes|=d,ei|=d}u=u.next}while(u!==null&&u!==a);c===null?i=s:c.next=l,Zs(s,t.memoizedState)||(Hr=!0),t.memoizedState=s,t.baseState=i,t.baseQueue=c,r.lastRenderedState=s}if(e=r.interleaved,e!==null){n=e;do a=n.lane,It.lanes|=a,ei|=a,n=n.next;while(n!==e)}else n===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Y0(e){var t=Is(),r=t.queue;if(r===null)throw Error(Se(311));r.lastRenderedReducer=e;var s=r.dispatch,n=r.pending,a=t.memoizedState;if(n!==null){r.pending=null;var i=n=n.next;do a=e(a,i.action),i=i.next;while(i!==n);Zs(a,t.memoizedState)||(Hr=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),r.lastRenderedState=a}return[a,s]}function rb(){}function sb(e,t){var r=It,s=Is(),n=t(),a=!Zs(s.memoizedState,n);if(a&&(s.memoizedState=n,Hr=!0),s=s.queue,yp(ib.bind(null,r,s,e),[e]),s.getSnapshot!==t||a||or!==null&&or.memoizedState.tag&1){if(r.flags|=2048,Kl(9,ab.bind(null,r,s,n,t),void 0,null),ur===null)throw Error(Se(349));Za&30||nb(r,t,n)}return n}function nb(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=It.updateQueue,t===null?(t={lastEffect:null,stores:null},It.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function ab(e,t,r,s){t.value=r,t.getSnapshot=s,ob(t)&&lb(e)}function ib(e,t,r){return r(function(){ob(t)&&lb(e)})}function ob(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Zs(e,r)}catch{return!0}}function lb(e){var t=An(e,1);t!==null&&Qs(t,e,1,-1)}function iv(e){var t=an();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Gl,lastRenderedState:e},t.queue=e,e=e.dispatch=i4.bind(null,It,e),[t.memoizedState,e]}function Kl(e,t,r,s){return e={tag:e,create:t,destroy:r,deps:s,next:null},t=It.updateQueue,t===null?(t={lastEffect:null,stores:null},It.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(s=r.next,r.next=e,e.next=s,t.lastEffect=e)),e}function cb(){return Is().memoizedState}function Mu(e,t,r,s){var n=an();It.flags|=e,n.memoizedState=Kl(1|t,r,void 0,s===void 0?null:s)}function Qd(e,t,r,s){var n=Is();s=s===void 0?null:s;var a=void 0;if(er!==null){var i=er.memoizedState;if(a=i.destroy,s!==null&&xp(s,i.deps)){n.memoizedState=Kl(t,r,a,s);return}}It.flags|=e,n.memoizedState=Kl(1|t,r,a,s)}function ov(e,t){return Mu(8390656,8,e,t)}function yp(e,t){return Qd(2048,8,e,t)}function ub(e,t){return Qd(4,2,e,t)}function db(e,t){return Qd(4,4,e,t)}function fb(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function hb(e,t,r){return r=r!=null?r.concat([e]):null,Qd(4,4,fb.bind(null,t,e),r)}function wp(){}function mb(e,t){var r=Is();t=t===void 0?null:t;var s=r.memoizedState;return s!==null&&t!==null&&xp(t,s[1])?s[0]:(r.memoizedState=[e,t],e)}function pb(e,t){var r=Is();t=t===void 0?null:t;var s=r.memoizedState;return s!==null&&t!==null&&xp(t,s[1])?s[0]:(e=e(),r.memoizedState=[e,t],e)}function xb(e,t,r){return Za&21?(Zs(r,t)||(r=b2(),It.lanes|=r,ei|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Hr=!0),e.memoizedState=r)}function n4(e,t){var r=mt;mt=r!==0&&4>r?r:4,e(!0);var s=X0.transition;X0.transition={};try{e(!1),t()}finally{mt=r,X0.transition=s}}function gb(){return Is().memoizedState}function a4(e,t,r){var s=na(e);if(r={lane:s,action:r,hasEagerState:!1,eagerState:null,next:null},vb(e))yb(t,r);else if(r=Z2(e,t,r,s),r!==null){var n=Ur();Qs(r,e,s,n),wb(r,t,s)}}function i4(e,t,r){var s=na(e),n={lane:s,action:r,hasEagerState:!1,eagerState:null,next:null};if(vb(e))yb(t,n);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var i=t.lastRenderedState,l=a(i,r);if(n.hasEagerState=!0,n.eagerState=l,Zs(l,i)){var c=t.interleaved;c===null?(n.next=n,dp(t)):(n.next=c.next,c.next=n),t.interleaved=n;return}}catch{}finally{}r=Z2(e,t,n,s),r!==null&&(n=Ur(),Qs(r,e,s,n),wb(r,t,s))}}function vb(e){var t=e.alternate;return e===It||t!==null&&t===It}function yb(e,t){ml=fd=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function wb(e,t,r){if(r&4194240){var s=t.lanes;s&=e.pendingLanes,r|=s,t.lanes=r,Ym(e,r)}}var hd={readContext:Rs,useCallback:wr,useContext:wr,useEffect:wr,useImperativeHandle:wr,useInsertionEffect:wr,useLayoutEffect:wr,useMemo:wr,useReducer:wr,useRef:wr,useState:wr,useDebugValue:wr,useDeferredValue:wr,useTransition:wr,useMutableSource:wr,useSyncExternalStore:wr,useId:wr,unstable_isNewReconciler:!1},o4={readContext:Rs,useCallback:function(e,t){return an().memoizedState=[e,t===void 0?null:t],e},useContext:Rs,useEffect:ov,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Mu(4194308,4,fb.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Mu(4194308,4,e,t)},useInsertionEffect:function(e,t){return Mu(4,2,e,t)},useMemo:function(e,t){var r=an();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var s=an();return t=r!==void 0?r(t):t,s.memoizedState=s.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},s.queue=e,e=e.dispatch=a4.bind(null,It,e),[s.memoizedState,e]},useRef:function(e){var t=an();return e={current:e},t.memoizedState=e},useState:iv,useDebugValue:wp,useDeferredValue:function(e){return an().memoizedState=e},useTransition:function(){var e=iv(!1),t=e[0];return e=n4.bind(null,e[1]),an().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var s=It,n=an();if(kt){if(r===void 0)throw Error(Se(407));r=r()}else{if(r=t(),ur===null)throw Error(Se(349));Za&30||nb(s,t,r)}n.memoizedState=r;var a={value:r,getSnapshot:t};return n.queue=a,ov(ib.bind(null,s,a,e),[e]),s.flags|=2048,Kl(9,ab.bind(null,s,a,r,t),void 0,null),r},useId:function(){var e=an(),t=ur.identifierPrefix;if(kt){var r=bn,s=wn;r=(s&~(1<<32-Xs(s)-1)).toString(32)+r,t=":"+t+"R"+r,r=Hl++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=s4++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},l4={readContext:Rs,useCallback:mb,useContext:Rs,useEffect:yp,useImperativeHandle:hb,useInsertionEffect:ub,useLayoutEffect:db,useMemo:pb,useReducer:Q0,useRef:cb,useState:function(){return Q0(Gl)},useDebugValue:wp,useDeferredValue:function(e){var t=Is();return xb(t,er.memoizedState,e)},useTransition:function(){var e=Q0(Gl)[0],t=Is().memoizedState;return[e,t]},useMutableSource:rb,useSyncExternalStore:sb,useId:gb,unstable_isNewReconciler:!1},c4={readContext:Rs,useCallback:mb,useContext:Rs,useEffect:yp,useImperativeHandle:hb,useInsertionEffect:ub,useLayoutEffect:db,useMemo:pb,useReducer:Y0,useRef:cb,useState:function(){return Y0(Gl)},useDebugValue:wp,useDeferredValue:function(e){var t=Is();return er===null?t.memoizedState=e:xb(t,er.memoizedState,e)},useTransition:function(){var e=Y0(Gl)[0],t=Is().memoizedState;return[e,t]},useMutableSource:rb,useSyncExternalStore:sb,useId:gb,unstable_isNewReconciler:!1};function zs(e,t){if(e&&e.defaultProps){t=Ot({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Sh(e,t,r,s){t=e.memoizedState,r=r(s,t),r=r==null?t:Ot({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Yd={isMounted:function(e){return(e=e._reactInternals)?di(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var s=Ur(),n=na(e),a=kn(s,n);a.payload=t,r!=null&&(a.callback=r),t=ra(e,a,n),t!==null&&(Qs(t,e,n,s),Du(t,e,n))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var s=Ur(),n=na(e),a=kn(s,n);a.tag=1,a.payload=t,r!=null&&(a.callback=r),t=ra(e,a,n),t!==null&&(Qs(t,e,n,s),Du(t,e,n))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Ur(),s=na(e),n=kn(r,s);n.tag=2,t!=null&&(n.callback=t),t=ra(e,n,s),t!==null&&(Qs(t,e,s,r),Du(t,e,s))}};function lv(e,t,r,s,n,a,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(s,a,i):t.prototype&&t.prototype.isPureReactComponent?!Ul(r,s)||!Ul(n,a):!0}function bb(e,t,r){var s=!1,n=oa,a=t.contextType;return typeof a=="object"&&a!==null?a=Rs(a):(n=Xr(t)?Ya:Fr.current,s=t.contextTypes,a=(s=s!=null)?uo(e,n):oa),t=new t(r,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Yd,e.stateNode=t,t._reactInternals=e,s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=n,e.__reactInternalMemoizedMaskedChildContext=a),t}function cv(e,t,r,s){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,s),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,s),t.state!==e&&Yd.enqueueReplaceState(t,t.state,null)}function kh(e,t,r,s){var n=e.stateNode;n.props=r,n.state=e.memoizedState,n.refs={},fp(e);var a=t.contextType;typeof a=="object"&&a!==null?n.context=Rs(a):(a=Xr(t)?Ya:Fr.current,n.context=uo(e,a)),n.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(Sh(e,t,a,r),n.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof n.getSnapshotBeforeUpdate=="function"||typeof n.UNSAFE_componentWillMount!="function"&&typeof n.componentWillMount!="function"||(t=n.state,typeof n.componentWillMount=="function"&&n.componentWillMount(),typeof n.UNSAFE_componentWillMount=="function"&&n.UNSAFE_componentWillMount(),t!==n.state&&Yd.enqueueReplaceState(n,n.state,null),ud(e,r,n,s),n.state=e.memoizedState),typeof n.componentDidMount=="function"&&(e.flags|=4194308)}function po(e,t){try{var r="",s=t;do r+=Lj(s),s=s.return;while(s);var n=r}catch(a){n=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:n,digest:null}}function J0(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Nh(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var u4=typeof WeakMap=="function"?WeakMap:Map;function _b(e,t,r){r=kn(-1,r),r.tag=3,r.payload={element:null};var s=t.value;return r.callback=function(){pd||(pd=!0,Oh=s),Nh(e,t)},r}function Sb(e,t,r){r=kn(-1,r),r.tag=3;var s=e.type.getDerivedStateFromError;if(typeof s=="function"){var n=t.value;r.payload=function(){return s(n)},r.callback=function(){Nh(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(r.callback=function(){Nh(e,t),typeof s!="function"&&(sa===null?sa=new Set([this]):sa.add(this));var i=t.stack;this.componentDidCatch(t.value,{componentStack:i!==null?i:""})}),r}function uv(e,t,r){var s=e.pingCache;if(s===null){s=e.pingCache=new u4;var n=new Set;s.set(t,n)}else n=s.get(t),n===void 0&&(n=new Set,s.set(t,n));n.has(r)||(n.add(r),e=k4.bind(null,e,t,r),t.then(e,e))}function dv(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function fv(e,t,r,s,n){return e.mode&1?(e.flags|=65536,e.lanes=n,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=kn(-1,1),t.tag=2,ra(r,t,1))),r.lanes|=1),e)}var d4=On.ReactCurrentOwner,Hr=!1;function Or(e,t,r,s){t.child=e===null?J2(t,null,r,s):ho(t,e.child,r,s)}function hv(e,t,r,s,n){r=r.render;var a=t.ref;return eo(t,n),s=gp(e,t,r,s,a,n),r=vp(),e!==null&&!Hr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n,Fn(e,t,n)):(kt&&r&&ap(t),t.flags|=1,Or(e,t,s,n),t.child)}function mv(e,t,r,s,n){if(e===null){var a=r.type;return typeof a=="function"&&!Tp(a)&&a.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=a,kb(e,t,a,s,n)):(e=$u(r.type,null,s,t,t.mode,n),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!(e.lanes&n)){var i=a.memoizedProps;if(r=r.compare,r=r!==null?r:Ul,r(i,s)&&e.ref===t.ref)return Fn(e,t,n)}return t.flags|=1,e=aa(a,s),e.ref=t.ref,e.return=t,t.child=e}function kb(e,t,r,s,n){if(e!==null){var a=e.memoizedProps;if(Ul(a,s)&&e.ref===t.ref)if(Hr=!1,t.pendingProps=s=a,(e.lanes&n)!==0)e.flags&131072&&(Hr=!0);else return t.lanes=e.lanes,Fn(e,t,n)}return Eh(e,t,r,s,n)}function Nb(e,t,r){var s=t.pendingProps,n=s.children,a=e!==null?e.memoizedState:null;if(s.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},vt(Vi,rs),rs|=r;else{if(!(r&1073741824))return e=a!==null?a.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,vt(Vi,rs),rs|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=a!==null?a.baseLanes:r,vt(Vi,rs),rs|=s}else a!==null?(s=a.baseLanes|r,t.memoizedState=null):s=r,vt(Vi,rs),rs|=s;return Or(e,t,n,r),t.child}function Eb(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Eh(e,t,r,s,n){var a=Xr(r)?Ya:Fr.current;return a=uo(t,a),eo(t,n),r=gp(e,t,r,s,a,n),s=vp(),e!==null&&!Hr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n,Fn(e,t,n)):(kt&&s&&ap(t),t.flags|=1,Or(e,t,r,n),t.child)}function pv(e,t,r,s,n){if(Xr(r)){var a=!0;ad(t)}else a=!1;if(eo(t,n),t.stateNode===null)Bu(e,t),bb(t,r,s),kh(t,r,s,n),s=!0;else if(e===null){var i=t.stateNode,l=t.memoizedProps;i.props=l;var c=i.context,u=r.contextType;typeof u=="object"&&u!==null?u=Rs(u):(u=Xr(r)?Ya:Fr.current,u=uo(t,u));var d=r.getDerivedStateFromProps,f=typeof d=="function"||typeof i.getSnapshotBeforeUpdate=="function";f||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(l!==s||c!==u)&&cv(t,i,s,u),Wn=!1;var h=t.memoizedState;i.state=h,ud(t,s,i,n),c=t.memoizedState,l!==s||h!==c||Kr.current||Wn?(typeof d=="function"&&(Sh(t,r,d,s),c=t.memoizedState),(l=Wn||lv(t,r,l,s,h,c,u))?(f||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=s,t.memoizedState=c),i.props=s,i.state=c,i.context=u,s=l):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),s=!1)}else{i=t.stateNode,eb(e,t),l=t.memoizedProps,u=t.type===t.elementType?l:zs(t.type,l),i.props=u,f=t.pendingProps,h=i.context,c=r.contextType,typeof c=="object"&&c!==null?c=Rs(c):(c=Xr(r)?Ya:Fr.current,c=uo(t,c));var m=r.getDerivedStateFromProps;(d=typeof m=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(l!==f||h!==c)&&cv(t,i,s,c),Wn=!1,h=t.memoizedState,i.state=h,ud(t,s,i,n);var x=t.memoizedState;l!==f||h!==x||Kr.current||Wn?(typeof m=="function"&&(Sh(t,r,m,s),x=t.memoizedState),(u=Wn||lv(t,r,u,s,h,x,c)||!1)?(d||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(s,x,c),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(s,x,c)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=s,t.memoizedState=x),i.props=s,i.state=x,i.context=c,s=u):(typeof i.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),s=!1)}return jh(e,t,r,s,a,n)}function jh(e,t,r,s,n,a){Eb(e,t);var i=(t.flags&128)!==0;if(!s&&!i)return n&&ev(t,r,!1),Fn(e,t,a);s=t.stateNode,d4.current=t;var l=i&&typeof r.getDerivedStateFromError!="function"?null:s.render();return t.flags|=1,e!==null&&i?(t.child=ho(t,e.child,null,a),t.child=ho(t,null,l,a)):Or(e,t,l,a),t.memoizedState=s.state,n&&ev(t,r,!0),t.child}function jb(e){var t=e.stateNode;t.pendingContext?Zg(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Zg(e,t.context,!1),hp(e,t.containerInfo)}function xv(e,t,r,s,n){return fo(),op(n),t.flags|=256,Or(e,t,r,s),t.child}var Th={dehydrated:null,treeContext:null,retryLane:0};function Ch(e){return{baseLanes:e,cachePool:null,transitions:null}}function Tb(e,t,r){var s=t.pendingProps,n=At.current,a=!1,i=(t.flags&128)!==0,l;if((l=i)||(l=e!==null&&e.memoizedState===null?!1:(n&2)!==0),l?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(n|=1),vt(At,n&1),e===null)return bh(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(i=s.children,e=s.fallback,a?(s=t.mode,a=t.child,i={mode:"hidden",children:i},!(s&1)&&a!==null?(a.childLanes=0,a.pendingProps=i):a=e0(i,s,0,null),e=Wa(e,s,r,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=Ch(r),t.memoizedState=Th,e):bp(t,i));if(n=e.memoizedState,n!==null&&(l=n.dehydrated,l!==null))return f4(e,t,i,s,l,n,r);if(a){a=s.fallback,i=t.mode,n=e.child,l=n.sibling;var c={mode:"hidden",children:s.children};return!(i&1)&&t.child!==n?(s=t.child,s.childLanes=0,s.pendingProps=c,t.deletions=null):(s=aa(n,c),s.subtreeFlags=n.subtreeFlags&14680064),l!==null?a=aa(l,a):(a=Wa(a,i,r,null),a.flags|=2),a.return=t,s.return=t,s.sibling=a,t.child=s,s=a,a=t.child,i=e.child.memoizedState,i=i===null?Ch(r):{baseLanes:i.baseLanes|r,cachePool:null,transitions:i.transitions},a.memoizedState=i,a.childLanes=e.childLanes&~r,t.memoizedState=Th,s}return a=e.child,e=a.sibling,s=aa(a,{mode:"visible",children:s.children}),!(t.mode&1)&&(s.lanes=r),s.return=t,s.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=s,t.memoizedState=null,s}function bp(e,t){return t=e0({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function su(e,t,r,s){return s!==null&&op(s),ho(t,e.child,null,r),e=bp(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function f4(e,t,r,s,n,a,i){if(r)return t.flags&256?(t.flags&=-257,s=J0(Error(Se(422))),su(e,t,i,s)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=s.fallback,n=t.mode,s=e0({mode:"visible",children:s.children},n,0,null),a=Wa(a,n,i,null),a.flags|=2,s.return=t,a.return=t,s.sibling=a,t.child=s,t.mode&1&&ho(t,e.child,null,i),t.child.memoizedState=Ch(i),t.memoizedState=Th,a);if(!(t.mode&1))return su(e,t,i,null);if(n.data==="$!"){if(s=n.nextSibling&&n.nextSibling.dataset,s)var l=s.dgst;return s=l,a=Error(Se(419)),s=J0(a,s,void 0),su(e,t,i,s)}if(l=(i&e.childLanes)!==0,Hr||l){if(s=ur,s!==null){switch(i&-i){case 4:n=2;break;case 16:n=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:n=32;break;case 536870912:n=268435456;break;default:n=0}n=n&(s.suspendedLanes|i)?0:n,n!==0&&n!==a.retryLane&&(a.retryLane=n,An(e,n),Qs(s,e,n,-1))}return jp(),s=J0(Error(Se(421))),su(e,t,i,s)}return n.data==="$?"?(t.flags|=128,t.child=e.child,t=N4.bind(null,e),n._reactRetry=t,null):(e=a.treeContext,cs=ta(n.nextSibling),us=t,kt=!0,qs=null,e!==null&&(Ns[Es++]=wn,Ns[Es++]=bn,Ns[Es++]=Ja,wn=e.id,bn=e.overflow,Ja=t),t=bp(t,s.children),t.flags|=4096,t)}function gv(e,t,r){e.lanes|=t;var s=e.alternate;s!==null&&(s.lanes|=t),_h(e.return,t,r)}function Z0(e,t,r,s,n){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:s,tail:r,tailMode:n}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=s,a.tail=r,a.tailMode=n)}function Cb(e,t,r){var s=t.pendingProps,n=s.revealOrder,a=s.tail;if(Or(e,t,s.children,r),s=At.current,s&2)s=s&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&gv(e,r,t);else if(e.tag===19)gv(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}s&=1}if(vt(At,s),!(t.mode&1))t.memoizedState=null;else switch(n){case"forwards":for(r=t.child,n=null;r!==null;)e=r.alternate,e!==null&&dd(e)===null&&(n=r),r=r.sibling;r=n,r===null?(n=t.child,t.child=null):(n=r.sibling,r.sibling=null),Z0(t,!1,n,r,a);break;case"backwards":for(r=null,n=t.child,t.child=null;n!==null;){if(e=n.alternate,e!==null&&dd(e)===null){t.child=n;break}e=n.sibling,n.sibling=r,r=n,n=e}Z0(t,!0,r,null,a);break;case"together":Z0(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Bu(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Fn(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),ei|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Se(153));if(t.child!==null){for(e=t.child,r=aa(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=aa(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function h4(e,t,r){switch(t.tag){case 3:jb(t),fo();break;case 5:tb(t);break;case 1:Xr(t.type)&&ad(t);break;case 4:hp(t,t.stateNode.containerInfo);break;case 10:var s=t.type._context,n=t.memoizedProps.value;vt(ld,s._currentValue),s._currentValue=n;break;case 13:if(s=t.memoizedState,s!==null)return s.dehydrated!==null?(vt(At,At.current&1),t.flags|=128,null):r&t.child.childLanes?Tb(e,t,r):(vt(At,At.current&1),e=Fn(e,t,r),e!==null?e.sibling:null);vt(At,At.current&1);break;case 19:if(s=(r&t.childLanes)!==0,e.flags&128){if(s)return Cb(e,t,r);t.flags|=128}if(n=t.memoizedState,n!==null&&(n.rendering=null,n.tail=null,n.lastEffect=null),vt(At,At.current),s)break;return null;case 22:case 23:return t.lanes=0,Nb(e,t,r)}return Fn(e,t,r)}var Ab,Ah,Fb,Pb;Ab=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Ah=function(){};Fb=function(e,t,r,s){var n=e.memoizedProps;if(n!==s){e=t.stateNode,Ma(un.current);var a=null;switch(r){case"input":n=Jf(e,n),s=Jf(e,s),a=[];break;case"select":n=Ot({},n,{value:void 0}),s=Ot({},s,{value:void 0}),a=[];break;case"textarea":n=th(e,n),s=th(e,s),a=[];break;default:typeof n.onClick!="function"&&typeof s.onClick=="function"&&(e.onclick=sd)}sh(r,s);var i;r=null;for(u in n)if(!s.hasOwnProperty(u)&&n.hasOwnProperty(u)&&n[u]!=null)if(u==="style"){var l=n[u];for(i in l)l.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Rl.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in s){var c=s[u];if(l=n!=null?n[u]:void 0,s.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(i in l)!l.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in c)c.hasOwnProperty(i)&&l[i]!==c[i]&&(r||(r={}),r[i]=c[i])}else r||(a||(a=[]),a.push(u,r)),r=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(a=a||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(a=a||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Rl.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&yt("scroll",e),a||l===c||(a=[])):(a=a||[]).push(u,c))}r&&(a=a||[]).push("style",r);var u=a;(t.updateQueue=u)&&(t.flags|=4)}};Pb=function(e,t,r,s){r!==s&&(t.flags|=4)};function Qo(e,t){if(!kt)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var s=null;r!==null;)r.alternate!==null&&(s=r),r=r.sibling;s===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:s.sibling=null}}function br(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,s=0;if(t)for(var n=e.child;n!==null;)r|=n.lanes|n.childLanes,s|=n.subtreeFlags&14680064,s|=n.flags&14680064,n.return=e,n=n.sibling;else for(n=e.child;n!==null;)r|=n.lanes|n.childLanes,s|=n.subtreeFlags,s|=n.flags,n.return=e,n=n.sibling;return e.subtreeFlags|=s,e.childLanes=r,t}function m4(e,t,r){var s=t.pendingProps;switch(ip(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return br(t),null;case 1:return Xr(t.type)&&nd(),br(t),null;case 3:return s=t.stateNode,mo(),bt(Kr),bt(Fr),pp(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(e===null||e.child===null)&&(tu(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,qs!==null&&(Mh(qs),qs=null))),Ah(e,t),br(t),null;case 5:mp(t);var n=Ma(ql.current);if(r=t.type,e!==null&&t.stateNode!=null)Fb(e,t,r,s,n),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!s){if(t.stateNode===null)throw Error(Se(166));return br(t),null}if(e=Ma(un.current),tu(t)){s=t.stateNode,r=t.type;var a=t.memoizedProps;switch(s[on]=t,s[Vl]=a,e=(t.mode&1)!==0,r){case"dialog":yt("cancel",s),yt("close",s);break;case"iframe":case"object":case"embed":yt("load",s);break;case"video":case"audio":for(n=0;n<sl.length;n++)yt(sl[n],s);break;case"source":yt("error",s);break;case"img":case"image":case"link":yt("error",s),yt("load",s);break;case"details":yt("toggle",s);break;case"input":Eg(s,a),yt("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!a.multiple},yt("invalid",s);break;case"textarea":Tg(s,a),yt("invalid",s)}sh(r,a),n=null;for(var i in a)if(a.hasOwnProperty(i)){var l=a[i];i==="children"?typeof l=="string"?s.textContent!==l&&(a.suppressHydrationWarning!==!0&&eu(s.textContent,l,e),n=["children",l]):typeof l=="number"&&s.textContent!==""+l&&(a.suppressHydrationWarning!==!0&&eu(s.textContent,l,e),n=["children",""+l]):Rl.hasOwnProperty(i)&&l!=null&&i==="onScroll"&&yt("scroll",s)}switch(r){case"input":Hc(s),jg(s,a,!0);break;case"textarea":Hc(s),Cg(s);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(s.onclick=sd)}s=n,t.updateQueue=s,s!==null&&(t.flags|=4)}else{i=n.nodeType===9?n:n.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=i2(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof s.is=="string"?e=i.createElement(r,{is:s.is}):(e=i.createElement(r),r==="select"&&(i=e,s.multiple?i.multiple=!0:s.size&&(i.size=s.size))):e=i.createElementNS(e,r),e[on]=t,e[Vl]=s,Ab(e,t,!1,!1),t.stateNode=e;e:{switch(i=nh(r,s),r){case"dialog":yt("cancel",e),yt("close",e),n=s;break;case"iframe":case"object":case"embed":yt("load",e),n=s;break;case"video":case"audio":for(n=0;n<sl.length;n++)yt(sl[n],e);n=s;break;case"source":yt("error",e),n=s;break;case"img":case"image":case"link":yt("error",e),yt("load",e),n=s;break;case"details":yt("toggle",e),n=s;break;case"input":Eg(e,s),n=Jf(e,s),yt("invalid",e);break;case"option":n=s;break;case"select":e._wrapperState={wasMultiple:!!s.multiple},n=Ot({},s,{value:void 0}),yt("invalid",e);break;case"textarea":Tg(e,s),n=th(e,s),yt("invalid",e);break;default:n=s}sh(r,n),l=n;for(a in l)if(l.hasOwnProperty(a)){var c=l[a];a==="style"?c2(e,c):a==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&o2(e,c)):a==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&Il(e,c):typeof c=="number"&&Il(e,""+c):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(Rl.hasOwnProperty(a)?c!=null&&a==="onScroll"&&yt("scroll",e):c!=null&&qm(e,a,c,i))}switch(r){case"input":Hc(e),jg(e,s,!1);break;case"textarea":Hc(e),Cg(e);break;case"option":s.value!=null&&e.setAttribute("value",""+ia(s.value));break;case"select":e.multiple=!!s.multiple,a=s.value,a!=null?Qi(e,!!s.multiple,a,!1):s.defaultValue!=null&&Qi(e,!!s.multiple,s.defaultValue,!0);break;default:typeof n.onClick=="function"&&(e.onclick=sd)}switch(r){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return br(t),null;case 6:if(e&&t.stateNode!=null)Pb(e,t,e.memoizedProps,s);else{if(typeof s!="string"&&t.stateNode===null)throw Error(Se(166));if(r=Ma(ql.current),Ma(un.current),tu(t)){if(s=t.stateNode,r=t.memoizedProps,s[on]=t,(a=s.nodeValue!==r)&&(e=us,e!==null))switch(e.tag){case 3:eu(s.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&eu(s.nodeValue,r,(e.mode&1)!==0)}a&&(t.flags|=4)}else s=(r.nodeType===9?r:r.ownerDocument).createTextNode(s),s[on]=t,t.stateNode=s}return br(t),null;case 13:if(bt(At),s=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(kt&&cs!==null&&t.mode&1&&!(t.flags&128))Q2(),fo(),t.flags|=98560,a=!1;else if(a=tu(t),s!==null&&s.dehydrated!==null){if(e===null){if(!a)throw Error(Se(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(Se(317));a[on]=t}else fo(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;br(t),a=!1}else qs!==null&&(Mh(qs),qs=null),a=!0;if(!a)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(s=s!==null,s!==(e!==null&&e.memoizedState!==null)&&s&&(t.child.flags|=8192,t.mode&1&&(e===null||At.current&1?sr===0&&(sr=3):jp())),t.updateQueue!==null&&(t.flags|=4),br(t),null);case 4:return mo(),Ah(e,t),e===null&&zl(t.stateNode.containerInfo),br(t),null;case 10:return up(t.type._context),br(t),null;case 17:return Xr(t.type)&&nd(),br(t),null;case 19:if(bt(At),a=t.memoizedState,a===null)return br(t),null;if(s=(t.flags&128)!==0,i=a.rendering,i===null)if(s)Qo(a,!1);else{if(sr!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(i=dd(e),i!==null){for(t.flags|=128,Qo(a,!1),s=i.updateQueue,s!==null&&(t.updateQueue=s,t.flags|=4),t.subtreeFlags=0,s=r,r=t.child;r!==null;)a=r,e=s,a.flags&=14680066,i=a.alternate,i===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=i.childLanes,a.lanes=i.lanes,a.child=i.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=i.memoizedProps,a.memoizedState=i.memoizedState,a.updateQueue=i.updateQueue,a.type=i.type,e=i.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return vt(At,At.current&1|2),t.child}e=e.sibling}a.tail!==null&&Vt()>xo&&(t.flags|=128,s=!0,Qo(a,!1),t.lanes=4194304)}else{if(!s)if(e=dd(i),e!==null){if(t.flags|=128,s=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Qo(a,!0),a.tail===null&&a.tailMode==="hidden"&&!i.alternate&&!kt)return br(t),null}else 2*Vt()-a.renderingStartTime>xo&&r!==1073741824&&(t.flags|=128,s=!0,Qo(a,!1),t.lanes=4194304);a.isBackwards?(i.sibling=t.child,t.child=i):(r=a.last,r!==null?r.sibling=i:t.child=i,a.last=i)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=Vt(),t.sibling=null,r=At.current,vt(At,s?r&1|2:r&1),t):(br(t),null);case 22:case 23:return Ep(),s=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==s&&(t.flags|=8192),s&&t.mode&1?rs&1073741824&&(br(t),t.subtreeFlags&6&&(t.flags|=8192)):br(t),null;case 24:return null;case 25:return null}throw Error(Se(156,t.tag))}function p4(e,t){switch(ip(t),t.tag){case 1:return Xr(t.type)&&nd(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return mo(),bt(Kr),bt(Fr),pp(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return mp(t),null;case 13:if(bt(At),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Se(340));fo()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return bt(At),null;case 4:return mo(),null;case 10:return up(t.type._context),null;case 22:case 23:return Ep(),null;case 24:return null;default:return null}}var nu=!1,Nr=!1,x4=typeof WeakSet=="function"?WeakSet:Set,Oe=null;function $i(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(s){Lt(e,t,s)}else r.current=null}function Fh(e,t,r){try{r()}catch(s){Lt(e,t,s)}}var vv=!1;function g4(e,t){if(mh=ed,e=L2(),np(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var s=r.getSelection&&r.getSelection();if(s&&s.rangeCount!==0){r=s.anchorNode;var n=s.anchorOffset,a=s.focusNode;s=s.focusOffset;try{r.nodeType,a.nodeType}catch{r=null;break e}var i=0,l=-1,c=-1,u=0,d=0,f=e,h=null;t:for(;;){for(var m;f!==r||n!==0&&f.nodeType!==3||(l=i+n),f!==a||s!==0&&f.nodeType!==3||(c=i+s),f.nodeType===3&&(i+=f.nodeValue.length),(m=f.firstChild)!==null;)h=f,f=m;for(;;){if(f===e)break t;if(h===r&&++u===n&&(l=i),h===a&&++d===s&&(c=i),(m=f.nextSibling)!==null)break;f=h,h=f.parentNode}f=m}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(ph={focusedElem:e,selectionRange:r},ed=!1,Oe=t;Oe!==null;)if(t=Oe,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Oe=e;else for(;Oe!==null;){t=Oe;try{var x=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var p=x.memoizedProps,g=x.memoizedState,w=t.stateNode,v=w.getSnapshotBeforeUpdate(t.elementType===t.type?p:zs(t.type,p),g);w.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var y=t.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Se(163))}}catch(b){Lt(t,t.return,b)}if(e=t.sibling,e!==null){e.return=t.return,Oe=e;break}Oe=t.return}return x=vv,vv=!1,x}function pl(e,t,r){var s=t.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var n=s=s.next;do{if((n.tag&e)===e){var a=n.destroy;n.destroy=void 0,a!==void 0&&Fh(t,r,a)}n=n.next}while(n!==s)}}function Jd(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var s=r.create;r.destroy=s()}r=r.next}while(r!==t)}}function Ph(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function Rb(e){var t=e.alternate;t!==null&&(e.alternate=null,Rb(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[on],delete t[Vl],delete t[vh],delete t[ZT],delete t[e4])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Ib(e){return e.tag===5||e.tag===3||e.tag===4}function yv(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Ib(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Rh(e,t,r){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=sd));else if(s!==4&&(e=e.child,e!==null))for(Rh(e,t,r),e=e.sibling;e!==null;)Rh(e,t,r),e=e.sibling}function Ih(e,t,r){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(s!==4&&(e=e.child,e!==null))for(Ih(e,t,r),e=e.sibling;e!==null;)Ih(e,t,r),e=e.sibling}var hr=null,Vs=!1;function Bn(e,t,r){for(r=r.child;r!==null;)Ob(e,t,r),r=r.sibling}function Ob(e,t,r){if(cn&&typeof cn.onCommitFiberUnmount=="function")try{cn.onCommitFiberUnmount(Wd,r)}catch{}switch(r.tag){case 5:Nr||$i(r,t);case 6:var s=hr,n=Vs;hr=null,Bn(e,t,r),hr=s,Vs=n,hr!==null&&(Vs?(e=hr,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):hr.removeChild(r.stateNode));break;case 18:hr!==null&&(Vs?(e=hr,r=r.stateNode,e.nodeType===8?H0(e.parentNode,r):e.nodeType===1&&H0(e,r),Ml(e)):H0(hr,r.stateNode));break;case 4:s=hr,n=Vs,hr=r.stateNode.containerInfo,Vs=!0,Bn(e,t,r),hr=s,Vs=n;break;case 0:case 11:case 14:case 15:if(!Nr&&(s=r.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){n=s=s.next;do{var a=n,i=a.destroy;a=a.tag,i!==void 0&&(a&2||a&4)&&Fh(r,t,i),n=n.next}while(n!==s)}Bn(e,t,r);break;case 1:if(!Nr&&($i(r,t),s=r.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=r.memoizedProps,s.state=r.memoizedState,s.componentWillUnmount()}catch(l){Lt(r,t,l)}Bn(e,t,r);break;case 21:Bn(e,t,r);break;case 22:r.mode&1?(Nr=(s=Nr)||r.memoizedState!==null,Bn(e,t,r),Nr=s):Bn(e,t,r);break;default:Bn(e,t,r)}}function wv(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new x4),t.forEach(function(s){var n=E4.bind(null,e,s);r.has(s)||(r.add(s),s.then(n,n))})}}function Ls(e,t){var r=t.deletions;if(r!==null)for(var s=0;s<r.length;s++){var n=r[s];try{var a=e,i=t,l=i;e:for(;l!==null;){switch(l.tag){case 5:hr=l.stateNode,Vs=!1;break e;case 3:hr=l.stateNode.containerInfo,Vs=!0;break e;case 4:hr=l.stateNode.containerInfo,Vs=!0;break e}l=l.return}if(hr===null)throw Error(Se(160));Ob(a,i,n),hr=null,Vs=!1;var c=n.alternate;c!==null&&(c.return=null),n.return=null}catch(u){Lt(n,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Db(t,e),t=t.sibling}function Db(e,t){var r=e.alternate,s=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Ls(t,e),en(e),s&4){try{pl(3,e,e.return),Jd(3,e)}catch(p){Lt(e,e.return,p)}try{pl(5,e,e.return)}catch(p){Lt(e,e.return,p)}}break;case 1:Ls(t,e),en(e),s&512&&r!==null&&$i(r,r.return);break;case 5:if(Ls(t,e),en(e),s&512&&r!==null&&$i(r,r.return),e.flags&32){var n=e.stateNode;try{Il(n,"")}catch(p){Lt(e,e.return,p)}}if(s&4&&(n=e.stateNode,n!=null)){var a=e.memoizedProps,i=r!==null?r.memoizedProps:a,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&a.type==="radio"&&a.name!=null&&n2(n,a),nh(l,i);var u=nh(l,a);for(i=0;i<c.length;i+=2){var d=c[i],f=c[i+1];d==="style"?c2(n,f):d==="dangerouslySetInnerHTML"?o2(n,f):d==="children"?Il(n,f):qm(n,d,f,u)}switch(l){case"input":Zf(n,a);break;case"textarea":a2(n,a);break;case"select":var h=n._wrapperState.wasMultiple;n._wrapperState.wasMultiple=!!a.multiple;var m=a.value;m!=null?Qi(n,!!a.multiple,m,!1):h!==!!a.multiple&&(a.defaultValue!=null?Qi(n,!!a.multiple,a.defaultValue,!0):Qi(n,!!a.multiple,a.multiple?[]:"",!1))}n[Vl]=a}catch(p){Lt(e,e.return,p)}}break;case 6:if(Ls(t,e),en(e),s&4){if(e.stateNode===null)throw Error(Se(162));n=e.stateNode,a=e.memoizedProps;try{n.nodeValue=a}catch(p){Lt(e,e.return,p)}}break;case 3:if(Ls(t,e),en(e),s&4&&r!==null&&r.memoizedState.isDehydrated)try{Ml(t.containerInfo)}catch(p){Lt(e,e.return,p)}break;case 4:Ls(t,e),en(e);break;case 13:Ls(t,e),en(e),n=e.child,n.flags&8192&&(a=n.memoizedState!==null,n.stateNode.isHidden=a,!a||n.alternate!==null&&n.alternate.memoizedState!==null||(kp=Vt())),s&4&&wv(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(Nr=(u=Nr)||d,Ls(t,e),Nr=u):Ls(t,e),en(e),s&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!d&&e.mode&1)for(Oe=e,d=e.child;d!==null;){for(f=Oe=d;Oe!==null;){switch(h=Oe,m=h.child,h.tag){case 0:case 11:case 14:case 15:pl(4,h,h.return);break;case 1:$i(h,h.return);var x=h.stateNode;if(typeof x.componentWillUnmount=="function"){s=h,r=h.return;try{t=s,x.props=t.memoizedProps,x.state=t.memoizedState,x.componentWillUnmount()}catch(p){Lt(s,r,p)}}break;case 5:$i(h,h.return);break;case 22:if(h.memoizedState!==null){_v(f);continue}}m!==null?(m.return=h,Oe=m):_v(f)}d=d.sibling}e:for(d=null,f=e;;){if(f.tag===5){if(d===null){d=f;try{n=f.stateNode,u?(a=n.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(l=f.stateNode,c=f.memoizedProps.style,i=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=l2("display",i))}catch(p){Lt(e,e.return,p)}}}else if(f.tag===6){if(d===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(p){Lt(e,e.return,p)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Ls(t,e),en(e),s&4&&wv(e);break;case 21:break;default:Ls(t,e),en(e)}}function en(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(Ib(r)){var s=r;break e}r=r.return}throw Error(Se(160))}switch(s.tag){case 5:var n=s.stateNode;s.flags&32&&(Il(n,""),s.flags&=-33);var a=yv(e);Ih(e,a,n);break;case 3:case 4:var i=s.stateNode.containerInfo,l=yv(e);Rh(e,l,i);break;default:throw Error(Se(161))}}catch(c){Lt(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function v4(e,t,r){Oe=e,Lb(e)}function Lb(e,t,r){for(var s=(e.mode&1)!==0;Oe!==null;){var n=Oe,a=n.child;if(n.tag===22&&s){var i=n.memoizedState!==null||nu;if(!i){var l=n.alternate,c=l!==null&&l.memoizedState!==null||Nr;l=nu;var u=Nr;if(nu=i,(Nr=c)&&!u)for(Oe=n;Oe!==null;)i=Oe,c=i.child,i.tag===22&&i.memoizedState!==null?Sv(n):c!==null?(c.return=i,Oe=c):Sv(n);for(;a!==null;)Oe=a,Lb(a),a=a.sibling;Oe=n,nu=l,Nr=u}bv(e)}else n.subtreeFlags&8772&&a!==null?(a.return=n,Oe=a):bv(e)}}function bv(e){for(;Oe!==null;){var t=Oe;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Nr||Jd(5,t);break;case 1:var s=t.stateNode;if(t.flags&4&&!Nr)if(r===null)s.componentDidMount();else{var n=t.elementType===t.type?r.memoizedProps:zs(t.type,r.memoizedProps);s.componentDidUpdate(n,r.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&av(t,a,s);break;case 3:var i=t.updateQueue;if(i!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}av(t,i,r)}break;case 5:var l=t.stateNode;if(r===null&&t.flags&4){r=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var f=d.dehydrated;f!==null&&Ml(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Se(163))}Nr||t.flags&512&&Ph(t)}catch(h){Lt(t,t.return,h)}}if(t===e){Oe=null;break}if(r=t.sibling,r!==null){r.return=t.return,Oe=r;break}Oe=t.return}}function _v(e){for(;Oe!==null;){var t=Oe;if(t===e){Oe=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Oe=r;break}Oe=t.return}}function Sv(e){for(;Oe!==null;){var t=Oe;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Jd(4,t)}catch(c){Lt(t,r,c)}break;case 1:var s=t.stateNode;if(typeof s.componentDidMount=="function"){var n=t.return;try{s.componentDidMount()}catch(c){Lt(t,n,c)}}var a=t.return;try{Ph(t)}catch(c){Lt(t,a,c)}break;case 5:var i=t.return;try{Ph(t)}catch(c){Lt(t,i,c)}}}catch(c){Lt(t,t.return,c)}if(t===e){Oe=null;break}var l=t.sibling;if(l!==null){l.return=t.return,Oe=l;break}Oe=t.return}}var y4=Math.ceil,md=On.ReactCurrentDispatcher,_p=On.ReactCurrentOwner,As=On.ReactCurrentBatchConfig,ot=0,ur=null,Jt=null,gr=0,rs=0,Vi=xa(0),sr=0,Xl=null,ei=0,Zd=0,Sp=0,xl=null,qr=null,kp=0,xo=1/0,gn=null,pd=!1,Oh=null,sa=null,au=!1,Xn=null,xd=0,gl=0,Dh=null,Uu=-1,zu=0;function Ur(){return ot&6?Vt():Uu!==-1?Uu:Uu=Vt()}function na(e){return e.mode&1?ot&2&&gr!==0?gr&-gr:r4.transition!==null?(zu===0&&(zu=b2()),zu):(e=mt,e!==0||(e=window.event,e=e===void 0?16:T2(e.type)),e):1}function Qs(e,t,r,s){if(50<gl)throw gl=0,Dh=null,Error(Se(185));Sc(e,r,s),(!(ot&2)||e!==ur)&&(e===ur&&(!(ot&2)&&(Zd|=r),sr===4&&Hn(e,gr)),Qr(e,s),r===1&&ot===0&&!(t.mode&1)&&(xo=Vt()+500,Xd&&ga()))}function Qr(e,t){var r=e.callbackNode;rT(e,t);var s=Zu(e,e===ur?gr:0);if(s===0)r!==null&&Pg(r),e.callbackNode=null,e.callbackPriority=0;else if(t=s&-s,e.callbackPriority!==t){if(r!=null&&Pg(r),t===1)e.tag===0?t4(kv.bind(null,e)):G2(kv.bind(null,e)),YT(function(){!(ot&6)&&ga()}),r=null;else{switch(_2(s)){case 1:r=Qm;break;case 4:r=y2;break;case 16:r=Ju;break;case 536870912:r=w2;break;default:r=Ju}r=qb(r,Mb.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function Mb(e,t){if(Uu=-1,zu=0,ot&6)throw Error(Se(327));var r=e.callbackNode;if(to()&&e.callbackNode!==r)return null;var s=Zu(e,e===ur?gr:0);if(s===0)return null;if(s&30||s&e.expiredLanes||t)t=gd(e,s);else{t=s;var n=ot;ot|=2;var a=Ub();(ur!==e||gr!==t)&&(gn=null,xo=Vt()+500,Va(e,t));do try{_4();break}catch(l){Bb(e,l)}while(!0);cp(),md.current=a,ot=n,Jt!==null?t=0:(ur=null,gr=0,t=sr)}if(t!==0){if(t===2&&(n=ch(e),n!==0&&(s=n,t=Lh(e,n))),t===1)throw r=Xl,Va(e,0),Hn(e,s),Qr(e,Vt()),r;if(t===6)Hn(e,s);else{if(n=e.current.alternate,!(s&30)&&!w4(n)&&(t=gd(e,s),t===2&&(a=ch(e),a!==0&&(s=a,t=Lh(e,a))),t===1))throw r=Xl,Va(e,0),Hn(e,s),Qr(e,Vt()),r;switch(e.finishedWork=n,e.finishedLanes=s,t){case 0:case 1:throw Error(Se(345));case 2:Ca(e,qr,gn);break;case 3:if(Hn(e,s),(s&130023424)===s&&(t=kp+500-Vt(),10<t)){if(Zu(e,0)!==0)break;if(n=e.suspendedLanes,(n&s)!==s){Ur(),e.pingedLanes|=e.suspendedLanes&n;break}e.timeoutHandle=gh(Ca.bind(null,e,qr,gn),t);break}Ca(e,qr,gn);break;case 4:if(Hn(e,s),(s&4194240)===s)break;for(t=e.eventTimes,n=-1;0<s;){var i=31-Xs(s);a=1<<i,i=t[i],i>n&&(n=i),s&=~a}if(s=n,s=Vt()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*y4(s/1960))-s,10<s){e.timeoutHandle=gh(Ca.bind(null,e,qr,gn),s);break}Ca(e,qr,gn);break;case 5:Ca(e,qr,gn);break;default:throw Error(Se(329))}}}return Qr(e,Vt()),e.callbackNode===r?Mb.bind(null,e):null}function Lh(e,t){var r=xl;return e.current.memoizedState.isDehydrated&&(Va(e,t).flags|=256),e=gd(e,t),e!==2&&(t=qr,qr=r,t!==null&&Mh(t)),e}function Mh(e){qr===null?qr=e:qr.push.apply(qr,e)}function w4(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var s=0;s<r.length;s++){var n=r[s],a=n.getSnapshot;n=n.value;try{if(!Zs(a(),n))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Hn(e,t){for(t&=~Sp,t&=~Zd,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Xs(t),s=1<<r;e[r]=-1,t&=~s}}function kv(e){if(ot&6)throw Error(Se(327));to();var t=Zu(e,0);if(!(t&1))return Qr(e,Vt()),null;var r=gd(e,t);if(e.tag!==0&&r===2){var s=ch(e);s!==0&&(t=s,r=Lh(e,s))}if(r===1)throw r=Xl,Va(e,0),Hn(e,t),Qr(e,Vt()),r;if(r===6)throw Error(Se(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ca(e,qr,gn),Qr(e,Vt()),null}function Np(e,t){var r=ot;ot|=1;try{return e(t)}finally{ot=r,ot===0&&(xo=Vt()+500,Xd&&ga())}}function ti(e){Xn!==null&&Xn.tag===0&&!(ot&6)&&to();var t=ot;ot|=1;var r=As.transition,s=mt;try{if(As.transition=null,mt=1,e)return e()}finally{mt=s,As.transition=r,ot=t,!(ot&6)&&ga()}}function Ep(){rs=Vi.current,bt(Vi)}function Va(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,QT(r)),Jt!==null)for(r=Jt.return;r!==null;){var s=r;switch(ip(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&nd();break;case 3:mo(),bt(Kr),bt(Fr),pp();break;case 5:mp(s);break;case 4:mo();break;case 13:bt(At);break;case 19:bt(At);break;case 10:up(s.type._context);break;case 22:case 23:Ep()}r=r.return}if(ur=e,Jt=e=aa(e.current,null),gr=rs=t,sr=0,Xl=null,Sp=Zd=ei=0,qr=xl=null,La!==null){for(t=0;t<La.length;t++)if(r=La[t],s=r.interleaved,s!==null){r.interleaved=null;var n=s.next,a=r.pending;if(a!==null){var i=a.next;a.next=n,s.next=i}r.pending=s}La=null}return e}function Bb(e,t){do{var r=Jt;try{if(cp(),Lu.current=hd,fd){for(var s=It.memoizedState;s!==null;){var n=s.queue;n!==null&&(n.pending=null),s=s.next}fd=!1}if(Za=0,or=er=It=null,ml=!1,Hl=0,_p.current=null,r===null||r.return===null){sr=1,Xl=t,Jt=null;break}e:{var a=e,i=r.return,l=r,c=t;if(t=gr,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=l,f=d.tag;if(!(d.mode&1)&&(f===0||f===11||f===15)){var h=d.alternate;h?(d.updateQueue=h.updateQueue,d.memoizedState=h.memoizedState,d.lanes=h.lanes):(d.updateQueue=null,d.memoizedState=null)}var m=dv(i);if(m!==null){m.flags&=-257,fv(m,i,l,a,t),m.mode&1&&uv(a,u,t),t=m,c=u;var x=t.updateQueue;if(x===null){var p=new Set;p.add(c),t.updateQueue=p}else x.add(c);break e}else{if(!(t&1)){uv(a,u,t),jp();break e}c=Error(Se(426))}}else if(kt&&l.mode&1){var g=dv(i);if(g!==null){!(g.flags&65536)&&(g.flags|=256),fv(g,i,l,a,t),op(po(c,l));break e}}a=c=po(c,l),sr!==4&&(sr=2),xl===null?xl=[a]:xl.push(a),a=i;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var w=_b(a,c,t);nv(a,w);break e;case 1:l=c;var v=a.type,y=a.stateNode;if(!(a.flags&128)&&(typeof v.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(sa===null||!sa.has(y)))){a.flags|=65536,t&=-t,a.lanes|=t;var b=Sb(a,l,t);nv(a,b);break e}}a=a.return}while(a!==null)}$b(r)}catch(S){t=S,Jt===r&&r!==null&&(Jt=r=r.return);continue}break}while(!0)}function Ub(){var e=md.current;return md.current=hd,e===null?hd:e}function jp(){(sr===0||sr===3||sr===2)&&(sr=4),ur===null||!(ei&268435455)&&!(Zd&268435455)||Hn(ur,gr)}function gd(e,t){var r=ot;ot|=2;var s=Ub();(ur!==e||gr!==t)&&(gn=null,Va(e,t));do try{b4();break}catch(n){Bb(e,n)}while(!0);if(cp(),ot=r,md.current=s,Jt!==null)throw Error(Se(261));return ur=null,gr=0,sr}function b4(){for(;Jt!==null;)zb(Jt)}function _4(){for(;Jt!==null&&!Gj();)zb(Jt)}function zb(e){var t=Wb(e.alternate,e,rs);e.memoizedProps=e.pendingProps,t===null?$b(e):Jt=t,_p.current=null}function $b(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=p4(r,t),r!==null){r.flags&=32767,Jt=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{sr=6,Jt=null;return}}else if(r=m4(r,t,rs),r!==null){Jt=r;return}if(t=t.sibling,t!==null){Jt=t;return}Jt=t=e}while(t!==null);sr===0&&(sr=5)}function Ca(e,t,r){var s=mt,n=As.transition;try{As.transition=null,mt=1,S4(e,t,r,s)}finally{As.transition=n,mt=s}return null}function S4(e,t,r,s){do to();while(Xn!==null);if(ot&6)throw Error(Se(327));r=e.finishedWork;var n=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Se(177));e.callbackNode=null,e.callbackPriority=0;var a=r.lanes|r.childLanes;if(sT(e,a),e===ur&&(Jt=ur=null,gr=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||au||(au=!0,qb(Ju,function(){return to(),null})),a=(r.flags&15990)!==0,r.subtreeFlags&15990||a){a=As.transition,As.transition=null;var i=mt;mt=1;var l=ot;ot|=4,_p.current=null,g4(e,r),Db(r,e),VT(ph),ed=!!mh,ph=mh=null,e.current=r,v4(r),Kj(),ot=l,mt=i,As.transition=a}else e.current=r;if(au&&(au=!1,Xn=e,xd=n),a=e.pendingLanes,a===0&&(sa=null),Yj(r.stateNode),Qr(e,Vt()),t!==null)for(s=e.onRecoverableError,r=0;r<t.length;r++)n=t[r],s(n.value,{componentStack:n.stack,digest:n.digest});if(pd)throw pd=!1,e=Oh,Oh=null,e;return xd&1&&e.tag!==0&&to(),a=e.pendingLanes,a&1?e===Dh?gl++:(gl=0,Dh=e):gl=0,ga(),null}function to(){if(Xn!==null){var e=_2(xd),t=As.transition,r=mt;try{if(As.transition=null,mt=16>e?16:e,Xn===null)var s=!1;else{if(e=Xn,Xn=null,xd=0,ot&6)throw Error(Se(331));var n=ot;for(ot|=4,Oe=e.current;Oe!==null;){var a=Oe,i=a.child;if(Oe.flags&16){var l=a.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(Oe=u;Oe!==null;){var d=Oe;switch(d.tag){case 0:case 11:case 15:pl(8,d,a)}var f=d.child;if(f!==null)f.return=d,Oe=f;else for(;Oe!==null;){d=Oe;var h=d.sibling,m=d.return;if(Rb(d),d===u){Oe=null;break}if(h!==null){h.return=m,Oe=h;break}Oe=m}}}var x=a.alternate;if(x!==null){var p=x.child;if(p!==null){x.child=null;do{var g=p.sibling;p.sibling=null,p=g}while(p!==null)}}Oe=a}}if(a.subtreeFlags&2064&&i!==null)i.return=a,Oe=i;else e:for(;Oe!==null;){if(a=Oe,a.flags&2048)switch(a.tag){case 0:case 11:case 15:pl(9,a,a.return)}var w=a.sibling;if(w!==null){w.return=a.return,Oe=w;break e}Oe=a.return}}var v=e.current;for(Oe=v;Oe!==null;){i=Oe;var y=i.child;if(i.subtreeFlags&2064&&y!==null)y.return=i,Oe=y;else e:for(i=v;Oe!==null;){if(l=Oe,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Jd(9,l)}}catch(S){Lt(l,l.return,S)}if(l===i){Oe=null;break e}var b=l.sibling;if(b!==null){b.return=l.return,Oe=b;break e}Oe=l.return}}if(ot=n,ga(),cn&&typeof cn.onPostCommitFiberRoot=="function")try{cn.onPostCommitFiberRoot(Wd,e)}catch{}s=!0}return s}finally{mt=r,As.transition=t}}return!1}function Nv(e,t,r){t=po(r,t),t=_b(e,t,1),e=ra(e,t,1),t=Ur(),e!==null&&(Sc(e,1,t),Qr(e,t))}function Lt(e,t,r){if(e.tag===3)Nv(e,e,r);else for(;t!==null;){if(t.tag===3){Nv(t,e,r);break}else if(t.tag===1){var s=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(sa===null||!sa.has(s))){e=po(r,e),e=Sb(t,e,1),t=ra(t,e,1),e=Ur(),t!==null&&(Sc(t,1,e),Qr(t,e));break}}t=t.return}}function k4(e,t,r){var s=e.pingCache;s!==null&&s.delete(t),t=Ur(),e.pingedLanes|=e.suspendedLanes&r,ur===e&&(gr&r)===r&&(sr===4||sr===3&&(gr&130023424)===gr&&500>Vt()-kp?Va(e,0):Sp|=r),Qr(e,t)}function Vb(e,t){t===0&&(e.mode&1?(t=Xc,Xc<<=1,!(Xc&130023424)&&(Xc=4194304)):t=1);var r=Ur();e=An(e,t),e!==null&&(Sc(e,t,r),Qr(e,r))}function N4(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),Vb(e,r)}function E4(e,t){var r=0;switch(e.tag){case 13:var s=e.stateNode,n=e.memoizedState;n!==null&&(r=n.retryLane);break;case 19:s=e.stateNode;break;default:throw Error(Se(314))}s!==null&&s.delete(t),Vb(e,r)}var Wb;Wb=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Kr.current)Hr=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Hr=!1,h4(e,t,r);Hr=!!(e.flags&131072)}else Hr=!1,kt&&t.flags&1048576&&K2(t,od,t.index);switch(t.lanes=0,t.tag){case 2:var s=t.type;Bu(e,t),e=t.pendingProps;var n=uo(t,Fr.current);eo(t,r),n=gp(null,t,s,e,n,r);var a=vp();return t.flags|=1,typeof n=="object"&&n!==null&&typeof n.render=="function"&&n.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Xr(s)?(a=!0,ad(t)):a=!1,t.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,fp(t),n.updater=Yd,t.stateNode=n,n._reactInternals=t,kh(t,s,e,r),t=jh(null,t,s,!0,a,r)):(t.tag=0,kt&&a&&ap(t),Or(null,t,n,r),t=t.child),t;case 16:s=t.elementType;e:{switch(Bu(e,t),e=t.pendingProps,n=s._init,s=n(s._payload),t.type=s,n=t.tag=T4(s),e=zs(s,e),n){case 0:t=Eh(null,t,s,e,r);break e;case 1:t=pv(null,t,s,e,r);break e;case 11:t=hv(null,t,s,e,r);break e;case 14:t=mv(null,t,s,zs(s.type,e),r);break e}throw Error(Se(306,s,""))}return t;case 0:return s=t.type,n=t.pendingProps,n=t.elementType===s?n:zs(s,n),Eh(e,t,s,n,r);case 1:return s=t.type,n=t.pendingProps,n=t.elementType===s?n:zs(s,n),pv(e,t,s,n,r);case 3:e:{if(jb(t),e===null)throw Error(Se(387));s=t.pendingProps,a=t.memoizedState,n=a.element,eb(e,t),ud(t,s,null,r);var i=t.memoizedState;if(s=i.element,a.isDehydrated)if(a={element:s,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){n=po(Error(Se(423)),t),t=xv(e,t,s,r,n);break e}else if(s!==n){n=po(Error(Se(424)),t),t=xv(e,t,s,r,n);break e}else for(cs=ta(t.stateNode.containerInfo.firstChild),us=t,kt=!0,qs=null,r=J2(t,null,s,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(fo(),s===n){t=Fn(e,t,r);break e}Or(e,t,s,r)}t=t.child}return t;case 5:return tb(t),e===null&&bh(t),s=t.type,n=t.pendingProps,a=e!==null?e.memoizedProps:null,i=n.children,xh(s,n)?i=null:a!==null&&xh(s,a)&&(t.flags|=32),Eb(e,t),Or(e,t,i,r),t.child;case 6:return e===null&&bh(t),null;case 13:return Tb(e,t,r);case 4:return hp(t,t.stateNode.containerInfo),s=t.pendingProps,e===null?t.child=ho(t,null,s,r):Or(e,t,s,r),t.child;case 11:return s=t.type,n=t.pendingProps,n=t.elementType===s?n:zs(s,n),hv(e,t,s,n,r);case 7:return Or(e,t,t.pendingProps,r),t.child;case 8:return Or(e,t,t.pendingProps.children,r),t.child;case 12:return Or(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(s=t.type._context,n=t.pendingProps,a=t.memoizedProps,i=n.value,vt(ld,s._currentValue),s._currentValue=i,a!==null)if(Zs(a.value,i)){if(a.children===n.children&&!Kr.current){t=Fn(e,t,r);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var l=a.dependencies;if(l!==null){i=a.child;for(var c=l.firstContext;c!==null;){if(c.context===s){if(a.tag===1){c=kn(-1,r&-r),c.tag=2;var u=a.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}a.lanes|=r,c=a.alternate,c!==null&&(c.lanes|=r),_h(a.return,r,t),l.lanes|=r;break}c=c.next}}else if(a.tag===10)i=a.type===t.type?null:a.child;else if(a.tag===18){if(i=a.return,i===null)throw Error(Se(341));i.lanes|=r,l=i.alternate,l!==null&&(l.lanes|=r),_h(i,r,t),i=a.sibling}else i=a.child;if(i!==null)i.return=a;else for(i=a;i!==null;){if(i===t){i=null;break}if(a=i.sibling,a!==null){a.return=i.return,i=a;break}i=i.return}a=i}Or(e,t,n.children,r),t=t.child}return t;case 9:return n=t.type,s=t.pendingProps.children,eo(t,r),n=Rs(n),s=s(n),t.flags|=1,Or(e,t,s,r),t.child;case 14:return s=t.type,n=zs(s,t.pendingProps),n=zs(s.type,n),mv(e,t,s,n,r);case 15:return kb(e,t,t.type,t.pendingProps,r);case 17:return s=t.type,n=t.pendingProps,n=t.elementType===s?n:zs(s,n),Bu(e,t),t.tag=1,Xr(s)?(e=!0,ad(t)):e=!1,eo(t,r),bb(t,s,n),kh(t,s,n,r),jh(null,t,s,!0,e,r);case 19:return Cb(e,t,r);case 22:return Nb(e,t,r)}throw Error(Se(156,t.tag))};function qb(e,t){return v2(e,t)}function j4(e,t,r,s){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ts(e,t,r,s){return new j4(e,t,r,s)}function Tp(e){return e=e.prototype,!(!e||!e.isReactComponent)}function T4(e){if(typeof e=="function")return Tp(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Gm)return 11;if(e===Km)return 14}return 2}function aa(e,t){var r=e.alternate;return r===null?(r=Ts(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function $u(e,t,r,s,n,a){var i=2;if(s=e,typeof e=="function")Tp(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case Ri:return Wa(r.children,n,a,t);case Hm:i=8,n|=8;break;case Kf:return e=Ts(12,r,t,n|2),e.elementType=Kf,e.lanes=a,e;case Xf:return e=Ts(13,r,t,n),e.elementType=Xf,e.lanes=a,e;case Qf:return e=Ts(19,r,t,n),e.elementType=Qf,e.lanes=a,e;case t2:return e0(r,n,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Zw:i=10;break e;case e2:i=9;break e;case Gm:i=11;break e;case Km:i=14;break e;case Vn:i=16,s=null;break e}throw Error(Se(130,e==null?e:typeof e,""))}return t=Ts(i,r,t,n),t.elementType=e,t.type=s,t.lanes=a,t}function Wa(e,t,r,s){return e=Ts(7,e,s,t),e.lanes=r,e}function e0(e,t,r,s){return e=Ts(22,e,s,t),e.elementType=t2,e.lanes=r,e.stateNode={isHidden:!1},e}function ef(e,t,r){return e=Ts(6,e,null,t),e.lanes=r,e}function tf(e,t,r){return t=Ts(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function C4(e,t,r,s,n){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=O0(0),this.expirationTimes=O0(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=O0(0),this.identifierPrefix=s,this.onRecoverableError=n,this.mutableSourceEagerHydrationData=null}function Cp(e,t,r,s,n,a,i,l,c){return e=new C4(e,t,r,l,c),t===1?(t=1,a===!0&&(t|=8)):t=0,a=Ts(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:s,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},fp(a),e}function A4(e,t,r){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Pi,key:s==null?null:""+s,children:e,containerInfo:t,implementation:r}}function Hb(e){if(!e)return oa;e=e._reactInternals;e:{if(di(e)!==e||e.tag!==1)throw Error(Se(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Xr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Se(171))}if(e.tag===1){var r=e.type;if(Xr(r))return H2(e,r,t)}return t}function Gb(e,t,r,s,n,a,i,l,c){return e=Cp(r,s,!0,e,n,a,i,l,c),e.context=Hb(null),r=e.current,s=Ur(),n=na(r),a=kn(s,n),a.callback=t??null,ra(r,a,n),e.current.lanes=n,Sc(e,n,s),Qr(e,s),e}function t0(e,t,r,s){var n=t.current,a=Ur(),i=na(n);return r=Hb(r),t.context===null?t.context=r:t.pendingContext=r,t=kn(a,i),t.payload={element:e},s=s===void 0?null:s,s!==null&&(t.callback=s),e=ra(n,t,i),e!==null&&(Qs(e,n,i,a),Du(e,n,i)),i}function vd(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Ev(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Ap(e,t){Ev(e,t),(e=e.alternate)&&Ev(e,t)}function F4(){return null}var Kb=typeof reportError=="function"?reportError:function(e){console.error(e)};function Fp(e){this._internalRoot=e}r0.prototype.render=Fp.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Se(409));t0(e,t,null,null)};r0.prototype.unmount=Fp.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;ti(function(){t0(null,e,null,null)}),t[Cn]=null}};function r0(e){this._internalRoot=e}r0.prototype.unstable_scheduleHydration=function(e){if(e){var t=N2();e={blockedOn:null,target:e,priority:t};for(var r=0;r<qn.length&&t!==0&&t<qn[r].priority;r++);qn.splice(r,0,e),r===0&&j2(e)}};function Pp(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function s0(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function jv(){}function P4(e,t,r,s,n){if(n){if(typeof s=="function"){var a=s;s=function(){var u=vd(i);a.call(u)}}var i=Gb(t,s,e,0,null,!1,!1,"",jv);return e._reactRootContainer=i,e[Cn]=i.current,zl(e.nodeType===8?e.parentNode:e),ti(),i}for(;n=e.lastChild;)e.removeChild(n);if(typeof s=="function"){var l=s;s=function(){var u=vd(c);l.call(u)}}var c=Cp(e,0,!1,null,null,!1,!1,"",jv);return e._reactRootContainer=c,e[Cn]=c.current,zl(e.nodeType===8?e.parentNode:e),ti(function(){t0(t,c,r,s)}),c}function n0(e,t,r,s,n){var a=r._reactRootContainer;if(a){var i=a;if(typeof n=="function"){var l=n;n=function(){var c=vd(i);l.call(c)}}t0(t,i,e,n)}else i=P4(r,t,e,n,s);return vd(i)}S2=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=rl(t.pendingLanes);r!==0&&(Ym(t,r|1),Qr(t,Vt()),!(ot&6)&&(xo=Vt()+500,ga()))}break;case 13:ti(function(){var s=An(e,1);if(s!==null){var n=Ur();Qs(s,e,1,n)}}),Ap(e,1)}};Jm=function(e){if(e.tag===13){var t=An(e,134217728);if(t!==null){var r=Ur();Qs(t,e,134217728,r)}Ap(e,134217728)}};k2=function(e){if(e.tag===13){var t=na(e),r=An(e,t);if(r!==null){var s=Ur();Qs(r,e,t,s)}Ap(e,t)}};N2=function(){return mt};E2=function(e,t){var r=mt;try{return mt=e,t()}finally{mt=r}};ih=function(e,t,r){switch(t){case"input":if(Zf(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var s=r[t];if(s!==e&&s.form===e.form){var n=Kd(s);if(!n)throw Error(Se(90));s2(s),Zf(s,n)}}}break;case"textarea":a2(e,r);break;case"select":t=r.value,t!=null&&Qi(e,!!r.multiple,t,!1)}};f2=Np;h2=ti;var R4={usingClientEntryPoint:!1,Events:[Nc,Li,Kd,u2,d2,Np]},Yo={findFiberByHostInstance:Da,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},I4={bundleType:Yo.bundleType,version:Yo.version,rendererPackageName:Yo.rendererPackageName,rendererConfig:Yo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:On.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=x2(e),e===null?null:e.stateNode},findFiberByHostInstance:Yo.findFiberByHostInstance||F4,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var iu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!iu.isDisabled&&iu.supportsFiber)try{Wd=iu.inject(I4),cn=iu}catch{}}hs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=R4;hs.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Pp(t))throw Error(Se(200));return A4(e,t,null,r)};hs.createRoot=function(e,t){if(!Pp(e))throw Error(Se(299));var r=!1,s="",n=Kb;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(n=t.onRecoverableError)),t=Cp(e,1,!1,null,null,r,!1,s,n),e[Cn]=t.current,zl(e.nodeType===8?e.parentNode:e),new Fp(t)};hs.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Se(188)):(e=Object.keys(e).join(","),Error(Se(268,e)));return e=x2(t),e=e===null?null:e.stateNode,e};hs.flushSync=function(e){return ti(e)};hs.hydrate=function(e,t,r){if(!s0(t))throw Error(Se(200));return n0(null,e,t,!0,r)};hs.hydrateRoot=function(e,t,r){if(!Pp(e))throw Error(Se(405));var s=r!=null&&r.hydratedSources||null,n=!1,a="",i=Kb;if(r!=null&&(r.unstable_strictMode===!0&&(n=!0),r.identifierPrefix!==void 0&&(a=r.identifierPrefix),r.onRecoverableError!==void 0&&(i=r.onRecoverableError)),t=Gb(t,null,e,1,r??null,n,!1,a,i),e[Cn]=t.current,zl(e),s)for(e=0;e<s.length;e++)r=s[e],n=r._getVersion,n=n(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,n]:t.mutableSourceEagerHydrationData.push(r,n);return new r0(t)};hs.render=function(e,t,r){if(!s0(t))throw Error(Se(200));return n0(null,e,t,!1,r)};hs.unmountComponentAtNode=function(e){if(!s0(e))throw Error(Se(40));return e._reactRootContainer?(ti(function(){n0(null,null,e,!1,function(){e._reactRootContainer=null,e[Cn]=null})}),!0):!1};hs.unstable_batchedUpdates=Np;hs.unstable_renderSubtreeIntoContainer=function(e,t,r,s){if(!s0(r))throw Error(Se(200));if(e==null||e._reactInternals===void 0)throw Error(Se(38));return n0(e,t,r,!1,s)};hs.version="18.3.1-next-f1338f8080-20240426";function Xb(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Xb)}catch(e){console.error(e)}}Xb(),Xw.exports=hs;var O4=Xw.exports,Tv=O4;Hf.createRoot=Tv.createRoot,Hf.hydrateRoot=Tv.hydrateRoot;const Rp=j.createContext({});function Ip(e){const t=j.useRef(null);return t.current===null&&(t.current=e()),t.current}const Op=typeof window<"u",Qb=Op?j.useLayoutEffect:j.useEffect,a0=j.createContext(null);function Dp(e,t){e.indexOf(t)===-1&&e.push(t)}function Lp(e,t){const r=e.indexOf(t);r>-1&&e.splice(r,1)}const Pn=(e,t,r)=>r>t?t:r<e?e:r;let Mp=()=>{};const Rn={},Yb=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e);function Jb(e){return typeof e=="object"&&e!==null}const Zb=e=>/^0[^.\s]+$/u.test(e);function Bp(e){let t;return()=>(t===void 0&&(t=e()),t)}const Fs=e=>e,D4=(e,t)=>r=>t(e(r)),jc=(...e)=>e.reduce(D4),Ql=(e,t,r)=>{const s=t-e;return s===0?1:(r-e)/s};class Up{constructor(){this.subscriptions=[]}add(t){return Dp(this.subscriptions,t),()=>Lp(this.subscriptions,t)}notify(t,r,s){const n=this.subscriptions.length;if(n)if(n===1)this.subscriptions[0](t,r,s);else for(let a=0;a<n;a++){const i=this.subscriptions[a];i&&i(t,r,s)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const dn=e=>e*1e3,Cs=e=>e/1e3;function e_(e,t){return t?e*(1e3/t):0}const t_=(e,t,r)=>(((1-3*r+3*t)*e+(3*r-6*t))*e+3*t)*e,L4=1e-7,M4=12;function B4(e,t,r,s,n){let a,i,l=0;do i=t+(r-t)/2,a=t_(i,s,n)-e,a>0?r=i:t=i;while(Math.abs(a)>L4&&++l<M4);return i}function Tc(e,t,r,s){if(e===t&&r===s)return Fs;const n=a=>B4(a,0,1,e,r);return a=>a===0||a===1?a:t_(n(a),t,s)}const r_=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,s_=e=>t=>1-e(1-t),n_=Tc(.33,1.53,.69,.99),zp=s_(n_),a_=r_(zp),i_=e=>(e*=2)<1?.5*zp(e):.5*(2-Math.pow(2,-10*(e-1))),$p=e=>1-Math.sin(Math.acos(e)),o_=s_($p),l_=r_($p),U4=Tc(.42,0,1,1),z4=Tc(0,0,.58,1),c_=Tc(.42,0,.58,1),$4=e=>Array.isArray(e)&&typeof e[0]!="number",u_=e=>Array.isArray(e)&&typeof e[0]=="number",V4={linear:Fs,easeIn:U4,easeInOut:c_,easeOut:z4,circIn:$p,circInOut:l_,circOut:o_,backIn:zp,backInOut:a_,backOut:n_,anticipate:i_},W4=e=>typeof e=="string",Cv=e=>{if(u_(e)){Mp(e.length===4);const[t,r,s,n]=e;return Tc(t,r,s,n)}else if(W4(e))return V4[e];return e},ou=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function q4(e,t){let r=new Set,s=new Set,n=!1,a=!1;const i=new WeakSet;let l={delta:0,timestamp:0,isProcessing:!1};function c(d){i.has(d)&&(u.schedule(d),e()),d(l)}const u={schedule:(d,f=!1,h=!1)=>{const x=h&&n?r:s;return f&&i.add(d),x.has(d)||x.add(d),d},cancel:d=>{s.delete(d),i.delete(d)},process:d=>{if(l=d,n){a=!0;return}n=!0,[r,s]=[s,r],r.forEach(c),r.clear(),n=!1,a&&(a=!1,u.process(d))}};return u}const H4=40;function d_(e,t){let r=!1,s=!0;const n={delta:0,timestamp:0,isProcessing:!1},a=()=>r=!0,i=ou.reduce((y,b)=>(y[b]=q4(a),y),{}),{setup:l,read:c,resolveKeyframes:u,preUpdate:d,update:f,preRender:h,render:m,postRender:x}=i,p=()=>{const y=Rn.useManualTiming?n.timestamp:performance.now();r=!1,Rn.useManualTiming||(n.delta=s?1e3/60:Math.max(Math.min(y-n.timestamp,H4),1)),n.timestamp=y,n.isProcessing=!0,l.process(n),c.process(n),u.process(n),d.process(n),f.process(n),h.process(n),m.process(n),x.process(n),n.isProcessing=!1,r&&t&&(s=!1,e(p))},g=()=>{r=!0,s=!0,n.isProcessing||e(p)};return{schedule:ou.reduce((y,b)=>{const S=i[b];return y[b]=(k,_=!1,N=!1)=>(r||g(),S.schedule(k,_,N)),y},{}),cancel:y=>{for(let b=0;b<ou.length;b++)i[ou[b]].cancel(y)},state:n,steps:i}}const{schedule:Nt,cancel:la,state:mr,steps:rf}=d_(typeof requestAnimationFrame<"u"?requestAnimationFrame:Fs,!0);let Vu;function G4(){Vu=void 0}const Gr={now:()=>(Vu===void 0&&Gr.set(mr.isProcessing||Rn.useManualTiming?mr.timestamp:performance.now()),Vu),set:e=>{Vu=e,queueMicrotask(G4)}},f_=e=>t=>typeof t=="string"&&t.startsWith(e),Vp=f_("--"),K4=f_("var(--"),Wp=e=>K4(e)?X4.test(e.split("/*")[0].trim()):!1,X4=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,Co={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},Yl={...Co,transform:e=>Pn(0,1,e)},lu={...Co,default:1},vl=e=>Math.round(e*1e5)/1e5,qp=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function Q4(e){return e==null}const Y4=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,Hp=(e,t)=>r=>!!(typeof r=="string"&&Y4.test(r)&&r.startsWith(e)||t&&!Q4(r)&&Object.prototype.hasOwnProperty.call(r,t)),h_=(e,t,r)=>s=>{if(typeof s!="string")return s;const[n,a,i,l]=s.match(qp);return{[e]:parseFloat(n),[t]:parseFloat(a),[r]:parseFloat(i),alpha:l!==void 0?parseFloat(l):1}},J4=e=>Pn(0,255,e),sf={...Co,transform:e=>Math.round(J4(e))},Ba={test:Hp("rgb","red"),parse:h_("red","green","blue"),transform:({red:e,green:t,blue:r,alpha:s=1})=>"rgba("+sf.transform(e)+", "+sf.transform(t)+", "+sf.transform(r)+", "+vl(Yl.transform(s))+")"};function Z4(e){let t="",r="",s="",n="";return e.length>5?(t=e.substring(1,3),r=e.substring(3,5),s=e.substring(5,7),n=e.substring(7,9)):(t=e.substring(1,2),r=e.substring(2,3),s=e.substring(3,4),n=e.substring(4,5),t+=t,r+=r,s+=s,n+=n),{red:parseInt(t,16),green:parseInt(r,16),blue:parseInt(s,16),alpha:n?parseInt(n,16)/255:1}}const Bh={test:Hp("#"),parse:Z4,transform:Ba.transform},Cc=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),$n=Cc("deg"),fn=Cc("%"),We=Cc("px"),eC=Cc("vh"),tC=Cc("vw"),Av={...fn,parse:e=>fn.parse(e)/100,transform:e=>fn.transform(e*100)},Wi={test:Hp("hsl","hue"),parse:h_("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:r,alpha:s=1})=>"hsla("+Math.round(e)+", "+fn.transform(vl(t))+", "+fn.transform(vl(r))+", "+vl(Yl.transform(s))+")"},Yt={test:e=>Ba.test(e)||Bh.test(e)||Wi.test(e),parse:e=>Ba.test(e)?Ba.parse(e):Wi.test(e)?Wi.parse(e):Bh.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?Ba.transform(e):Wi.transform(e),getAnimatableNone:e=>{const t=Yt.parse(e);return t.alpha=0,Yt.transform(t)}},rC=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function sC(e){var t,r;return isNaN(e)&&typeof e=="string"&&(((t=e.match(qp))==null?void 0:t.length)||0)+(((r=e.match(rC))==null?void 0:r.length)||0)>0}const m_="number",p_="color",nC="var",aC="var(",Fv="${}",iC=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Jl(e){const t=e.toString(),r=[],s={color:[],number:[],var:[]},n=[];let a=0;const l=t.replace(iC,c=>(Yt.test(c)?(s.color.push(a),n.push(p_),r.push(Yt.parse(c))):c.startsWith(aC)?(s.var.push(a),n.push(nC),r.push(c)):(s.number.push(a),n.push(m_),r.push(parseFloat(c))),++a,Fv)).split(Fv);return{values:r,split:l,indexes:s,types:n}}function x_(e){return Jl(e).values}function g_(e){const{split:t,types:r}=Jl(e),s=t.length;return n=>{let a="";for(let i=0;i<s;i++)if(a+=t[i],n[i]!==void 0){const l=r[i];l===m_?a+=vl(n[i]):l===p_?a+=Yt.transform(n[i]):a+=n[i]}return a}}const oC=e=>typeof e=="number"?0:Yt.test(e)?Yt.getAnimatableNone(e):e;function lC(e){const t=x_(e);return g_(e)(t.map(oC))}const ca={test:sC,parse:x_,createTransformer:g_,getAnimatableNone:lC};function nf(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+(t-e)*6*r:r<1/2?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function cC({hue:e,saturation:t,lightness:r,alpha:s}){e/=360,t/=100,r/=100;let n=0,a=0,i=0;if(!t)n=a=i=r;else{const l=r<.5?r*(1+t):r+t-r*t,c=2*r-l;n=nf(c,l,e+1/3),a=nf(c,l,e),i=nf(c,l,e-1/3)}return{red:Math.round(n*255),green:Math.round(a*255),blue:Math.round(i*255),alpha:s}}function yd(e,t){return r=>r>0?t:e}const Ft=(e,t,r)=>e+(t-e)*r,af=(e,t,r)=>{const s=e*e,n=r*(t*t-s)+s;return n<0?0:Math.sqrt(n)},uC=[Bh,Ba,Wi],dC=e=>uC.find(t=>t.test(e));function Pv(e){const t=dC(e);if(!t)return!1;let r=t.parse(e);return t===Wi&&(r=cC(r)),r}const Rv=(e,t)=>{const r=Pv(e),s=Pv(t);if(!r||!s)return yd(e,t);const n={...r};return a=>(n.red=af(r.red,s.red,a),n.green=af(r.green,s.green,a),n.blue=af(r.blue,s.blue,a),n.alpha=Ft(r.alpha,s.alpha,a),Ba.transform(n))},Uh=new Set(["none","hidden"]);function fC(e,t){return Uh.has(e)?r=>r<=0?e:t:r=>r>=1?t:e}function hC(e,t){return r=>Ft(e,t,r)}function Gp(e){return typeof e=="number"?hC:typeof e=="string"?Wp(e)?yd:Yt.test(e)?Rv:xC:Array.isArray(e)?v_:typeof e=="object"?Yt.test(e)?Rv:mC:yd}function v_(e,t){const r=[...e],s=r.length,n=e.map((a,i)=>Gp(a)(a,t[i]));return a=>{for(let i=0;i<s;i++)r[i]=n[i](a);return r}}function mC(e,t){const r={...e,...t},s={};for(const n in r)e[n]!==void 0&&t[n]!==void 0&&(s[n]=Gp(e[n])(e[n],t[n]));return n=>{for(const a in s)r[a]=s[a](n);return r}}function pC(e,t){const r=[],s={color:0,var:0,number:0};for(let n=0;n<t.values.length;n++){const a=t.types[n],i=e.indexes[a][s[a]],l=e.values[i]??0;r[n]=l,s[a]++}return r}const xC=(e,t)=>{const r=ca.createTransformer(t),s=Jl(e),n=Jl(t);return s.indexes.var.length===n.indexes.var.length&&s.indexes.color.length===n.indexes.color.length&&s.indexes.number.length>=n.indexes.number.length?Uh.has(e)&&!n.values.length||Uh.has(t)&&!s.values.length?fC(e,t):jc(v_(pC(s,n),n.values),r):yd(e,t)};function y_(e,t,r){return typeof e=="number"&&typeof t=="number"&&typeof r=="number"?Ft(e,t,r):Gp(e)(e,t)}const gC=e=>{const t=({timestamp:r})=>e(r);return{start:(r=!0)=>Nt.update(t,r),stop:()=>la(t),now:()=>mr.isProcessing?mr.timestamp:Gr.now()}},w_=(e,t,r=10)=>{let s="";const n=Math.max(Math.round(t/r),2);for(let a=0;a<n;a++)s+=Math.round(e(a/(n-1))*1e4)/1e4+", ";return`linear(${s.substring(0,s.length-2)})`},wd=2e4;function Kp(e){let t=0;const r=50;let s=e.next(t);for(;!s.done&&t<wd;)t+=r,s=e.next(t);return t>=wd?1/0:t}function vC(e,t=100,r){const s=r({...e,keyframes:[0,t]}),n=Math.min(Kp(s),wd);return{type:"keyframes",ease:a=>s.next(n*a).value/t,duration:Cs(n)}}const yC=5;function b_(e,t,r){const s=Math.max(t-yC,0);return e_(r-e(s),t-s)}const Dt={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},of=.001;function wC({duration:e=Dt.duration,bounce:t=Dt.bounce,velocity:r=Dt.velocity,mass:s=Dt.mass}){let n,a,i=1-t;i=Pn(Dt.minDamping,Dt.maxDamping,i),e=Pn(Dt.minDuration,Dt.maxDuration,Cs(e)),i<1?(n=u=>{const d=u*i,f=d*e,h=d-r,m=zh(u,i),x=Math.exp(-f);return of-h/m*x},a=u=>{const f=u*i*e,h=f*r+r,m=Math.pow(i,2)*Math.pow(u,2)*e,x=Math.exp(-f),p=zh(Math.pow(u,2),i);return(-n(u)+of>0?-1:1)*((h-m)*x)/p}):(n=u=>{const d=Math.exp(-u*e),f=(u-r)*e+1;return-of+d*f},a=u=>{const d=Math.exp(-u*e),f=(r-u)*(e*e);return d*f});const l=5/e,c=_C(n,a,l);if(e=dn(e),isNaN(c))return{stiffness:Dt.stiffness,damping:Dt.damping,duration:e};{const u=Math.pow(c,2)*s;return{stiffness:u,damping:i*2*Math.sqrt(s*u),duration:e}}}const bC=12;function _C(e,t,r){let s=r;for(let n=1;n<bC;n++)s=s-e(s)/t(s);return s}function zh(e,t){return e*Math.sqrt(1-t*t)}const SC=["duration","bounce"],kC=["stiffness","damping","mass"];function Iv(e,t){return t.some(r=>e[r]!==void 0)}function NC(e){let t={velocity:Dt.velocity,stiffness:Dt.stiffness,damping:Dt.damping,mass:Dt.mass,isResolvedFromDuration:!1,...e};if(!Iv(e,kC)&&Iv(e,SC))if(e.visualDuration){const r=e.visualDuration,s=2*Math.PI/(r*1.2),n=s*s,a=2*Pn(.05,1,1-(e.bounce||0))*Math.sqrt(n);t={...t,mass:Dt.mass,stiffness:n,damping:a}}else{const r=wC(e);t={...t,...r,mass:Dt.mass},t.isResolvedFromDuration=!0}return t}function bd(e=Dt.visualDuration,t=Dt.bounce){const r=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:s,restDelta:n}=r;const a=r.keyframes[0],i=r.keyframes[r.keyframes.length-1],l={done:!1,value:a},{stiffness:c,damping:u,mass:d,duration:f,velocity:h,isResolvedFromDuration:m}=NC({...r,velocity:-Cs(r.velocity||0)}),x=h||0,p=u/(2*Math.sqrt(c*d)),g=i-a,w=Cs(Math.sqrt(c/d)),v=Math.abs(g)<5;s||(s=v?Dt.restSpeed.granular:Dt.restSpeed.default),n||(n=v?Dt.restDelta.granular:Dt.restDelta.default);let y;if(p<1){const S=zh(w,p);y=k=>{const _=Math.exp(-p*w*k);return i-_*((x+p*w*g)/S*Math.sin(S*k)+g*Math.cos(S*k))}}else if(p===1)y=S=>i-Math.exp(-w*S)*(g+(x+w*g)*S);else{const S=w*Math.sqrt(p*p-1);y=k=>{const _=Math.exp(-p*w*k),N=Math.min(S*k,300);return i-_*((x+p*w*g)*Math.sinh(N)+S*g*Math.cosh(N))/S}}const b={calculatedDuration:m&&f||null,next:S=>{const k=y(S);if(m)l.done=S>=f;else{let _=S===0?x:0;p<1&&(_=S===0?dn(x):b_(y,S,k));const N=Math.abs(_)<=s,C=Math.abs(i-k)<=n;l.done=N&&C}return l.value=l.done?i:k,l},toString:()=>{const S=Math.min(Kp(b),wd),k=w_(_=>b.next(S*_).value,S,30);return S+"ms "+k},toTransition:()=>{}};return b}bd.applyToOptions=e=>{const t=vC(e,100,bd);return e.ease=t.ease,e.duration=dn(t.duration),e.type="keyframes",e};function $h({keyframes:e,velocity:t=0,power:r=.8,timeConstant:s=325,bounceDamping:n=10,bounceStiffness:a=500,modifyTarget:i,min:l,max:c,restDelta:u=.5,restSpeed:d}){const f=e[0],h={done:!1,value:f},m=N=>l!==void 0&&N<l||c!==void 0&&N>c,x=N=>l===void 0?c:c===void 0||Math.abs(l-N)<Math.abs(c-N)?l:c;let p=r*t;const g=f+p,w=i===void 0?g:i(g);w!==g&&(p=w-f);const v=N=>-p*Math.exp(-N/s),y=N=>w+v(N),b=N=>{const C=v(N),B=y(N);h.done=Math.abs(C)<=u,h.value=h.done?w:B};let S,k;const _=N=>{m(h.value)&&(S=N,k=bd({keyframes:[h.value,x(h.value)],velocity:b_(y,N,h.value),damping:n,stiffness:a,restDelta:u,restSpeed:d}))};return _(0),{calculatedDuration:null,next:N=>{let C=!1;return!k&&S===void 0&&(C=!0,b(N),_(N)),S!==void 0&&N>=S?k.next(N-S):(!C&&b(N),h)}}}function EC(e,t,r){const s=[],n=r||Rn.mix||y_,a=e.length-1;for(let i=0;i<a;i++){let l=n(e[i],e[i+1]);if(t){const c=Array.isArray(t)?t[i]||Fs:t;l=jc(c,l)}s.push(l)}return s}function jC(e,t,{clamp:r=!0,ease:s,mixer:n}={}){const a=e.length;if(Mp(a===t.length),a===1)return()=>t[0];if(a===2&&t[0]===t[1])return()=>t[1];const i=e[0]===e[1];e[0]>e[a-1]&&(e=[...e].reverse(),t=[...t].reverse());const l=EC(t,s,n),c=l.length,u=d=>{if(i&&d<e[0])return t[0];let f=0;if(c>1)for(;f<e.length-2&&!(d<e[f+1]);f++);const h=Ql(e[f],e[f+1],d);return l[f](h)};return r?d=>u(Pn(e[0],e[a-1],d)):u}function TC(e,t){const r=e[e.length-1];for(let s=1;s<=t;s++){const n=Ql(0,t,s);e.push(Ft(r,1,n))}}function CC(e){const t=[0];return TC(t,e.length-1),t}function AC(e,t){return e.map(r=>r*t)}function FC(e,t){return e.map(()=>t||c_).splice(0,e.length-1)}function yl({duration:e=300,keyframes:t,times:r,ease:s="easeInOut"}){const n=$4(s)?s.map(Cv):Cv(s),a={done:!1,value:t[0]},i=AC(r&&r.length===t.length?r:CC(t),e),l=jC(i,t,{ease:Array.isArray(n)?n:FC(t,n)});return{calculatedDuration:e,next:c=>(a.value=l(c),a.done=c>=e,a)}}const PC=e=>e!==null;function Xp(e,{repeat:t,repeatType:r="loop"},s,n=1){const a=e.filter(PC),l=n<0||t&&r!=="loop"&&t%2===1?0:a.length-1;return!l||s===void 0?a[l]:s}const RC={decay:$h,inertia:$h,tween:yl,keyframes:yl,spring:bd};function __(e){typeof e.type=="string"&&(e.type=RC[e.type])}class Qp{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(t=>{this.resolve=t})}notifyFinished(){this.resolve()}then(t,r){return this.finished.then(t,r)}}const IC=e=>e/100;class Yp extends Qp{constructor(t){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var s,n;const{motionValue:r}=this.options;r&&r.updatedAt!==Gr.now()&&this.tick(Gr.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),(n=(s=this.options).onStop)==null||n.call(s))},this.options=t,this.initAnimation(),this.play(),t.autoplay===!1&&this.pause()}initAnimation(){const{options:t}=this;__(t);const{type:r=yl,repeat:s=0,repeatDelay:n=0,repeatType:a,velocity:i=0}=t;let{keyframes:l}=t;const c=r||yl;c!==yl&&typeof l[0]!="number"&&(this.mixKeyframes=jc(IC,y_(l[0],l[1])),l=[0,100]);const u=c({...t,keyframes:l});a==="mirror"&&(this.mirroredGenerator=c({...t,keyframes:[...l].reverse(),velocity:-i})),u.calculatedDuration===null&&(u.calculatedDuration=Kp(u));const{calculatedDuration:d}=u;this.calculatedDuration=d,this.resolvedDuration=d+n,this.totalDuration=this.resolvedDuration*(s+1)-n,this.generator=u}updateTime(t){const r=Math.round(t-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=r}tick(t,r=!1){const{generator:s,totalDuration:n,mixKeyframes:a,mirroredGenerator:i,resolvedDuration:l,calculatedDuration:c}=this;if(this.startTime===null)return s.next(0);const{delay:u=0,keyframes:d,repeat:f,repeatType:h,repeatDelay:m,type:x,onUpdate:p,finalKeyframe:g}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-n/this.speed,this.startTime)),r?this.currentTime=t:this.updateTime(t);const w=this.currentTime-u*(this.playbackSpeed>=0?1:-1),v=this.playbackSpeed>=0?w<0:w>n;this.currentTime=Math.max(w,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=n);let y=this.currentTime,b=s;if(f){const N=Math.min(this.currentTime,n)/l;let C=Math.floor(N),B=N%1;!B&&N>=1&&(B=1),B===1&&C--,C=Math.min(C,f+1),!!(C%2)&&(h==="reverse"?(B=1-B,m&&(B-=m/l)):h==="mirror"&&(b=i)),y=Pn(0,1,B)*l}const S=v?{done:!1,value:d[0]}:b.next(y);a&&(S.value=a(S.value));let{done:k}=S;!v&&c!==null&&(k=this.playbackSpeed>=0?this.currentTime>=n:this.currentTime<=0);const _=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&k);return _&&x!==$h&&(S.value=Xp(d,this.options,g,this.speed)),p&&p(S.value),_&&this.finish(),S}then(t,r){return this.finished.then(t,r)}get duration(){return Cs(this.calculatedDuration)}get iterationDuration(){const{delay:t=0}=this.options||{};return this.duration+Cs(t)}get time(){return Cs(this.currentTime)}set time(t){var r;t=dn(t),this.currentTime=t,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.playbackSpeed),(r=this.driver)==null||r.start(!1)}get speed(){return this.playbackSpeed}set speed(t){this.updateTime(Gr.now());const r=this.playbackSpeed!==t;this.playbackSpeed=t,r&&(this.time=Cs(this.currentTime))}play(){var n,a;if(this.isStopped)return;const{driver:t=gC,startTime:r}=this.options;this.driver||(this.driver=t(i=>this.tick(i))),(a=(n=this.options).onPlay)==null||a.call(n);const s=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=s):this.holdTime!==null?this.startTime=s-this.holdTime:this.startTime||(this.startTime=r??s),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(Gr.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){var t,r;this.notifyFinished(),this.teardown(),this.state="finished",(r=(t=this.options).onComplete)==null||r.call(t)}cancel(){var t,r;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),(r=(t=this.options).onCancel)==null||r.call(t)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}attachTimeline(t){var r;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),(r=this.driver)==null||r.stop(),t.observe(this)}}function OC(e){for(let t=1;t<e.length;t++)e[t]??(e[t]=e[t-1])}const Ua=e=>e*180/Math.PI,Vh=e=>{const t=Ua(Math.atan2(e[1],e[0]));return Wh(t)},DC={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:Vh,rotateZ:Vh,skewX:e=>Ua(Math.atan(e[1])),skewY:e=>Ua(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},Wh=e=>(e=e%360,e<0&&(e+=360),e),Ov=Vh,Dv=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),Lv=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),LC={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:Dv,scaleY:Lv,scale:e=>(Dv(e)+Lv(e))/2,rotateX:e=>Wh(Ua(Math.atan2(e[6],e[5]))),rotateY:e=>Wh(Ua(Math.atan2(-e[2],e[0]))),rotateZ:Ov,rotate:Ov,skewX:e=>Ua(Math.atan(e[4])),skewY:e=>Ua(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function qh(e){return e.includes("scale")?1:0}function Hh(e,t){if(!e||e==="none")return qh(t);const r=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let s,n;if(r)s=LC,n=r;else{const l=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);s=DC,n=l}if(!n)return qh(t);const a=s[t],i=n[1].split(",").map(BC);return typeof a=="function"?a(i):i[a]}const MC=(e,t)=>{const{transform:r="none"}=getComputedStyle(e);return Hh(r,t)};function BC(e){return parseFloat(e.trim())}const Ao=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Fo=new Set(Ao),Mv=e=>e===Co||e===We,UC=new Set(["x","y","z"]),zC=Ao.filter(e=>!UC.has(e));function $C(e){const t=[];return zC.forEach(r=>{const s=e.getValue(r);s!==void 0&&(t.push([r,s.get()]),s.set(r.startsWith("scale")?1:0))}),t}const qa={width:({x:e},{paddingLeft:t="0",paddingRight:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),height:({y:e},{paddingTop:t="0",paddingBottom:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:(e,{transform:t})=>Hh(t,"x"),y:(e,{transform:t})=>Hh(t,"y")};qa.translateX=qa.x;qa.translateY=qa.y;const Ha=new Set;let Gh=!1,Kh=!1,Xh=!1;function S_(){if(Kh){const e=Array.from(Ha).filter(s=>s.needsMeasurement),t=new Set(e.map(s=>s.element)),r=new Map;t.forEach(s=>{const n=$C(s);n.length&&(r.set(s,n),s.render())}),e.forEach(s=>s.measureInitialState()),t.forEach(s=>{s.render();const n=r.get(s);n&&n.forEach(([a,i])=>{var l;(l=s.getValue(a))==null||l.set(i)})}),e.forEach(s=>s.measureEndState()),e.forEach(s=>{s.suspendedScrollY!==void 0&&window.scrollTo(0,s.suspendedScrollY)})}Kh=!1,Gh=!1,Ha.forEach(e=>e.complete(Xh)),Ha.clear()}function k_(){Ha.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(Kh=!0)})}function VC(){Xh=!0,k_(),S_(),Xh=!1}class Jp{constructor(t,r,s,n,a,i=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...t],this.onComplete=r,this.name=s,this.motionValue=n,this.element=a,this.isAsync=i}scheduleResolve(){this.state="scheduled",this.isAsync?(Ha.add(this),Gh||(Gh=!0,Nt.read(k_),Nt.resolveKeyframes(S_))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:r,element:s,motionValue:n}=this;if(t[0]===null){const a=n==null?void 0:n.get(),i=t[t.length-1];if(a!==void 0)t[0]=a;else if(s&&r){const l=s.readValue(r,i);l!=null&&(t[0]=l)}t[0]===void 0&&(t[0]=i),n&&a===void 0&&n.set(t[0])}OC(t)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(t=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,t),Ha.delete(this)}cancel(){this.state==="scheduled"&&(Ha.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const WC=e=>e.startsWith("--");function qC(e,t,r){WC(t)?e.style.setProperty(t,r):e.style[t]=r}const HC=Bp(()=>window.ScrollTimeline!==void 0),GC={};function KC(e,t){const r=Bp(e);return()=>GC[t]??r()}const N_=KC(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),nl=([e,t,r,s])=>`cubic-bezier(${e}, ${t}, ${r}, ${s})`,Bv={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:nl([0,.65,.55,1]),circOut:nl([.55,0,1,.45]),backIn:nl([.31,.01,.66,-.59]),backOut:nl([.33,1.53,.69,.99])};function E_(e,t){if(e)return typeof e=="function"?N_()?w_(e,t):"ease-out":u_(e)?nl(e):Array.isArray(e)?e.map(r=>E_(r,t)||Bv.easeOut):Bv[e]}function XC(e,t,r,{delay:s=0,duration:n=300,repeat:a=0,repeatType:i="loop",ease:l="easeOut",times:c}={},u=void 0){const d={[t]:r};c&&(d.offset=c);const f=E_(l,n);Array.isArray(f)&&(d.easing=f);const h={delay:s,duration:n,easing:Array.isArray(f)?"linear":f,fill:"both",iterations:a+1,direction:i==="reverse"?"alternate":"normal"};return u&&(h.pseudoElement=u),e.animate(d,h)}function j_(e){return typeof e=="function"&&"applyToOptions"in e}function QC({type:e,...t}){return j_(e)&&N_()?e.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}class YC extends Qp{constructor(t){if(super(),this.finishedTime=null,this.isStopped=!1,!t)return;const{element:r,name:s,keyframes:n,pseudoElement:a,allowFlatten:i=!1,finalKeyframe:l,onComplete:c}=t;this.isPseudoElement=!!a,this.allowFlatten=i,this.options=t,Mp(typeof t.type!="string");const u=QC(t);this.animation=XC(r,s,n,u,a),u.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!a){const d=Xp(n,this.options,l,this.speed);this.updateMotionValue?this.updateMotionValue(d):qC(r,s,d),this.animation.cancel()}c==null||c(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var t,r;(r=(t=this.animation).finish)==null||r.call(t)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:t}=this;t==="idle"||t==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var t,r;this.isPseudoElement||(r=(t=this.animation).commitStyles)==null||r.call(t)}get duration(){var r,s;const t=((s=(r=this.animation.effect)==null?void 0:r.getComputedTiming)==null?void 0:s.call(r).duration)||0;return Cs(Number(t))}get iterationDuration(){const{delay:t=0}=this.options||{};return this.duration+Cs(t)}get time(){return Cs(Number(this.animation.currentTime)||0)}set time(t){this.finishedTime=null,this.animation.currentTime=dn(t)}get speed(){return this.animation.playbackRate}set speed(t){t<0&&(this.finishedTime=null),this.animation.playbackRate=t}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(t){this.animation.startTime=t}attachTimeline({timeline:t,observe:r}){var s;return this.allowFlatten&&((s=this.animation.effect)==null||s.updateTiming({easing:"linear"})),this.animation.onfinish=null,t&&HC()?(this.animation.timeline=t,Fs):r(this)}}const T_={anticipate:i_,backInOut:a_,circInOut:l_};function JC(e){return e in T_}function ZC(e){typeof e.ease=="string"&&JC(e.ease)&&(e.ease=T_[e.ease])}const Uv=10;class e3 extends YC{constructor(t){ZC(t),__(t),super(t),t.startTime&&(this.startTime=t.startTime),this.options=t}updateMotionValue(t){const{motionValue:r,onUpdate:s,onComplete:n,element:a,...i}=this.options;if(!r)return;if(t!==void 0){r.set(t);return}const l=new Yp({...i,autoplay:!1}),c=dn(this.finishedTime??this.time);r.setWithVelocity(l.sample(c-Uv).value,l.sample(c).value,Uv),l.stop()}}const zv=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(ca.test(e)||e==="0")&&!e.startsWith("url("));function t3(e){const t=e[0];if(e.length===1)return!0;for(let r=0;r<e.length;r++)if(e[r]!==t)return!0}function r3(e,t,r,s){const n=e[0];if(n===null)return!1;if(t==="display"||t==="visibility")return!0;const a=e[e.length-1],i=zv(n,t),l=zv(a,t);return!i||!l?!1:t3(e)||(r==="spring"||j_(r))&&s}function Qh(e){e.duration=0,e.type="keyframes"}const s3=new Set(["opacity","clipPath","filter","transform"]),n3=Bp(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function a3(e){var d;const{motionValue:t,name:r,repeatDelay:s,repeatType:n,damping:a,type:i}=e;if(!(((d=t==null?void 0:t.owner)==null?void 0:d.current)instanceof HTMLElement))return!1;const{onUpdate:c,transformTemplate:u}=t.owner.getProps();return n3()&&r&&s3.has(r)&&(r!=="transform"||!u)&&!c&&!s&&n!=="mirror"&&a!==0&&i!=="inertia"}const i3=40;class o3 extends Qp{constructor({autoplay:t=!0,delay:r=0,type:s="keyframes",repeat:n=0,repeatDelay:a=0,repeatType:i="loop",keyframes:l,name:c,motionValue:u,element:d,...f}){var x;super(),this.stop=()=>{var p,g;this._animation&&(this._animation.stop(),(p=this.stopTimeline)==null||p.call(this)),(g=this.keyframeResolver)==null||g.cancel()},this.createdAt=Gr.now();const h={autoplay:t,delay:r,type:s,repeat:n,repeatDelay:a,repeatType:i,name:c,motionValue:u,element:d,...f},m=(d==null?void 0:d.KeyframeResolver)||Jp;this.keyframeResolver=new m(l,(p,g,w)=>this.onKeyframesResolved(p,g,h,!w),c,u,d),(x=this.keyframeResolver)==null||x.scheduleResolve()}onKeyframesResolved(t,r,s,n){this.keyframeResolver=void 0;const{name:a,type:i,velocity:l,delay:c,isHandoff:u,onUpdate:d}=s;this.resolvedAt=Gr.now(),r3(t,a,i,l)||((Rn.instantAnimations||!c)&&(d==null||d(Xp(t,s,r))),t[0]=t[t.length-1],Qh(s),s.repeat=0);const h={startTime:n?this.resolvedAt?this.resolvedAt-this.createdAt>i3?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:r,...s,keyframes:t},m=!u&&a3(h)?new e3({...h,element:h.motionValue.owner.current}):new Yp(h);m.finished.then(()=>this.notifyFinished()).catch(Fs),this.pendingTimeline&&(this.stopTimeline=m.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=m}get finished(){return this._animation?this.animation.finished:this._finished}then(t,r){return this.finished.finally(t).then(()=>{})}get animation(){var t;return this._animation||((t=this.keyframeResolver)==null||t.resume(),VC()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(t){this.animation.time=t}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(t){this.animation.speed=t}get startTime(){return this.animation.startTime}attachTimeline(t){return this._animation?this.stopTimeline=this.animation.attachTimeline(t):this.pendingTimeline=t,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var t;this._animation&&this.animation.cancel(),(t=this.keyframeResolver)==null||t.cancel()}}const l3=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function c3(e){const t=l3.exec(e);if(!t)return[,];const[,r,s,n]=t;return[`--${r??s}`,n]}function C_(e,t,r=1){const[s,n]=c3(e);if(!s)return;const a=window.getComputedStyle(t).getPropertyValue(s);if(a){const i=a.trim();return Yb(i)?parseFloat(i):i}return Wp(n)?C_(n,t,r+1):n}function Zp(e,t){return(e==null?void 0:e[t])??(e==null?void 0:e.default)??e}const A_=new Set(["width","height","top","left","right","bottom",...Ao]),u3={test:e=>e==="auto",parse:e=>e},F_=e=>t=>t.test(e),P_=[Co,We,fn,$n,tC,eC,u3],$v=e=>P_.find(F_(e));function d3(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||Zb(e):!0}const f3=new Set(["brightness","contrast","saturate","opacity"]);function h3(e){const[t,r]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[s]=r.match(qp)||[];if(!s)return e;const n=r.replace(s,"");let a=f3.has(t)?1:0;return s!==r&&(a*=100),t+"("+a+n+")"}const m3=/\b([a-z-]*)\(.*?\)/gu,Yh={...ca,getAnimatableNone:e=>{const t=e.match(m3);return t?t.map(h3).join(" "):e}},Vv={...Co,transform:Math.round},p3={rotate:$n,rotateX:$n,rotateY:$n,rotateZ:$n,scale:lu,scaleX:lu,scaleY:lu,scaleZ:lu,skew:$n,skewX:$n,skewY:$n,distance:We,translateX:We,translateY:We,translateZ:We,x:We,y:We,z:We,perspective:We,transformPerspective:We,opacity:Yl,originX:Av,originY:Av,originZ:We},ex={borderWidth:We,borderTopWidth:We,borderRightWidth:We,borderBottomWidth:We,borderLeftWidth:We,borderRadius:We,radius:We,borderTopLeftRadius:We,borderTopRightRadius:We,borderBottomRightRadius:We,borderBottomLeftRadius:We,width:We,maxWidth:We,height:We,maxHeight:We,top:We,right:We,bottom:We,left:We,padding:We,paddingTop:We,paddingRight:We,paddingBottom:We,paddingLeft:We,margin:We,marginTop:We,marginRight:We,marginBottom:We,marginLeft:We,backgroundPositionX:We,backgroundPositionY:We,...p3,zIndex:Vv,fillOpacity:Yl,strokeOpacity:Yl,numOctaves:Vv},x3={...ex,color:Yt,backgroundColor:Yt,outlineColor:Yt,fill:Yt,stroke:Yt,borderColor:Yt,borderTopColor:Yt,borderRightColor:Yt,borderBottomColor:Yt,borderLeftColor:Yt,filter:Yh,WebkitFilter:Yh},R_=e=>x3[e];function I_(e,t){let r=R_(e);return r!==Yh&&(r=ca),r.getAnimatableNone?r.getAnimatableNone(t):void 0}const g3=new Set(["auto","none","0"]);function v3(e,t,r){let s=0,n;for(;s<e.length&&!n;){const a=e[s];typeof a=="string"&&!g3.has(a)&&Jl(a).values.length&&(n=e[s]),s++}if(n&&r)for(const a of t)e[a]=I_(r,n)}class y3 extends Jp{constructor(t,r,s,n,a){super(t,r,s,n,a,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:r,name:s}=this;if(!r||!r.current)return;super.readKeyframes();for(let c=0;c<t.length;c++){let u=t[c];if(typeof u=="string"&&(u=u.trim(),Wp(u))){const d=C_(u,r.current);d!==void 0&&(t[c]=d),c===t.length-1&&(this.finalKeyframe=u)}}if(this.resolveNoneKeyframes(),!A_.has(s)||t.length!==2)return;const[n,a]=t,i=$v(n),l=$v(a);if(i!==l)if(Mv(i)&&Mv(l))for(let c=0;c<t.length;c++){const u=t[c];typeof u=="string"&&(t[c]=parseFloat(u))}else qa[s]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:r}=this,s=[];for(let n=0;n<t.length;n++)(t[n]===null||d3(t[n]))&&s.push(n);s.length&&v3(t,s,r)}measureInitialState(){const{element:t,unresolvedKeyframes:r,name:s}=this;if(!t||!t.current)return;s==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=qa[s](t.measureViewportBox(),window.getComputedStyle(t.current)),r[0]=this.measuredOrigin;const n=r[r.length-1];n!==void 0&&t.getValue(s,n).jump(n,!1)}measureEndState(){var l;const{element:t,name:r,unresolvedKeyframes:s}=this;if(!t||!t.current)return;const n=t.getValue(r);n&&n.jump(this.measuredOrigin,!1);const a=s.length-1,i=s[a];s[a]=qa[r](t.measureViewportBox(),window.getComputedStyle(t.current)),i!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=i),(l=this.removedTransforms)!=null&&l.length&&this.removedTransforms.forEach(([c,u])=>{t.getValue(c).set(u)}),this.resolveNoneKeyframes()}}function w3(e,t,r){if(e instanceof EventTarget)return[e];if(typeof e=="string"){let s=document;const n=(r==null?void 0:r[e])??s.querySelectorAll(e);return n?Array.from(n):[]}return Array.from(e)}const O_=(e,t)=>t&&typeof e=="number"?t.transform(e):e;function D_(e){return Jb(e)&&"offsetHeight"in e}const Wv=30,b3=e=>!isNaN(parseFloat(e));class _3{constructor(t,r={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=s=>{var a;const n=Gr.now();if(this.updatedAt!==n&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(s),this.current!==this.prev&&((a=this.events.change)==null||a.notify(this.current),this.dependents))for(const i of this.dependents)i.dirty()},this.hasAnimated=!1,this.setCurrent(t),this.owner=r.owner}setCurrent(t){this.current=t,this.updatedAt=Gr.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=b3(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,r){this.events[t]||(this.events[t]=new Up);const s=this.events[t].add(r);return t==="change"?()=>{s(),Nt.read(()=>{this.events.change.getSize()||this.stop()})}:s}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,r){this.passiveEffect=t,this.stopPassiveEffect=r}set(t){this.passiveEffect?this.passiveEffect(t,this.updateAndNotify):this.updateAndNotify(t)}setWithVelocity(t,r,s){this.set(r),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-s}jump(t,r=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,r&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var t;(t=this.events.change)==null||t.notify(this.current)}addDependent(t){this.dependents||(this.dependents=new Set),this.dependents.add(t)}removeDependent(t){this.dependents&&this.dependents.delete(t)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=Gr.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>Wv)return 0;const r=Math.min(this.updatedAt-this.prevUpdatedAt,Wv);return e_(parseFloat(this.current)-parseFloat(this.prevFrameValue),r)}start(t){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=t(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var t,r;(t=this.dependents)==null||t.clear(),(r=this.events.destroy)==null||r.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function go(e,t){return new _3(e,t)}const{schedule:tx}=d_(queueMicrotask,!1),Us={x:!1,y:!1};function L_(){return Us.x||Us.y}function S3(e){return e==="x"||e==="y"?Us[e]?null:(Us[e]=!0,()=>{Us[e]=!1}):Us.x||Us.y?null:(Us.x=Us.y=!0,()=>{Us.x=Us.y=!1})}function M_(e,t){const r=w3(e),s=new AbortController,n={passive:!0,...t,signal:s.signal};return[r,n,()=>s.abort()]}function qv(e){return!(e.pointerType==="touch"||L_())}function k3(e,t,r={}){const[s,n,a]=M_(e,r),i=l=>{if(!qv(l))return;const{target:c}=l,u=t(c,l);if(typeof u!="function"||!c)return;const d=f=>{qv(f)&&(u(f),c.removeEventListener("pointerleave",d))};c.addEventListener("pointerleave",d,n)};return s.forEach(l=>{l.addEventListener("pointerenter",i,n)}),a}const B_=(e,t)=>t?e===t?!0:B_(e,t.parentElement):!1,rx=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1,N3=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function E3(e){return N3.has(e.tagName)||e.tabIndex!==-1}const Wu=new WeakSet;function Hv(e){return t=>{t.key==="Enter"&&e(t)}}function lf(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const j3=(e,t)=>{const r=e.currentTarget;if(!r)return;const s=Hv(()=>{if(Wu.has(r))return;lf(r,"down");const n=Hv(()=>{lf(r,"up")}),a=()=>lf(r,"cancel");r.addEventListener("keyup",n,t),r.addEventListener("blur",a,t)});r.addEventListener("keydown",s,t),r.addEventListener("blur",()=>r.removeEventListener("keydown",s),t)};function Gv(e){return rx(e)&&!L_()}function T3(e,t,r={}){const[s,n,a]=M_(e,r),i=l=>{const c=l.currentTarget;if(!Gv(l))return;Wu.add(c);const u=t(c,l),d=(m,x)=>{window.removeEventListener("pointerup",f),window.removeEventListener("pointercancel",h),Wu.has(c)&&Wu.delete(c),Gv(m)&&typeof u=="function"&&u(m,{success:x})},f=m=>{d(m,c===window||c===document||r.useGlobalTarget||B_(c,m.target))},h=m=>{d(m,!1)};window.addEventListener("pointerup",f,n),window.addEventListener("pointercancel",h,n)};return s.forEach(l=>{(r.useGlobalTarget?window:l).addEventListener("pointerdown",i,n),D_(l)&&(l.addEventListener("focus",u=>j3(u,n)),!E3(l)&&!l.hasAttribute("tabindex")&&(l.tabIndex=0))}),a}function U_(e){return Jb(e)&&"ownerSVGElement"in e}function C3(e){return U_(e)&&e.tagName==="svg"}const Tr=e=>!!(e&&e.getVelocity),A3=[...P_,Yt,ca],F3=e=>A3.find(F_(e)),sx=j.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});function Kv(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function P3(...e){return t=>{let r=!1;const s=e.map(n=>{const a=Kv(n,t);return!r&&typeof a=="function"&&(r=!0),a});if(r)return()=>{for(let n=0;n<s.length;n++){const a=s[n];typeof a=="function"?a():Kv(e[n],null)}}}}function R3(...e){return j.useCallback(P3(...e),e)}class I3 extends j.Component{getSnapshotBeforeUpdate(t){const r=this.props.childRef.current;if(r&&t.isPresent&&!this.props.isPresent){const s=r.offsetParent,n=D_(s)&&s.offsetWidth||0,a=this.props.sizeRef.current;a.height=r.offsetHeight||0,a.width=r.offsetWidth||0,a.top=r.offsetTop,a.left=r.offsetLeft,a.right=n-a.width-a.left}return null}componentDidUpdate(){}render(){return this.props.children}}function O3({children:e,isPresent:t,anchorX:r,root:s}){const n=j.useId(),a=j.useRef(null),i=j.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:l}=j.useContext(sx),c=R3(a,e==null?void 0:e.ref);return j.useInsertionEffect(()=>{const{width:u,height:d,top:f,left:h,right:m}=i.current;if(t||!a.current||!u||!d)return;const x=r==="left"?`left: ${h}`:`right: ${m}`;a.current.dataset.motionPopId=n;const p=document.createElement("style");l&&(p.nonce=l);const g=s??document.head;return g.appendChild(p),p.sheet&&p.sheet.insertRule(`
          [data-motion-pop-id="${n}"] {
            position: absolute !important;
            width: ${u}px !important;
            height: ${d}px !important;
            ${x}px !important;
            top: ${f}px !important;
          }
        `),()=>{g.contains(p)&&g.removeChild(p)}},[t]),o.jsx(I3,{isPresent:t,childRef:a,sizeRef:i,children:j.cloneElement(e,{ref:c})})}const D3=({children:e,initial:t,isPresent:r,onExitComplete:s,custom:n,presenceAffectsLayout:a,mode:i,anchorX:l,root:c})=>{const u=Ip(L3),d=j.useId();let f=!0,h=j.useMemo(()=>(f=!1,{id:d,initial:t,isPresent:r,custom:n,onExitComplete:m=>{u.set(m,!0);for(const x of u.values())if(!x)return;s&&s()},register:m=>(u.set(m,!1),()=>u.delete(m))}),[r,u,s]);return a&&f&&(h={...h}),j.useMemo(()=>{u.forEach((m,x)=>u.set(x,!1))},[r]),j.useEffect(()=>{!r&&!u.size&&s&&s()},[r]),i==="popLayout"&&(e=o.jsx(O3,{isPresent:r,anchorX:l,root:c,children:e})),o.jsx(a0.Provider,{value:h,children:e})};function L3(){return new Map}function z_(e=!0){const t=j.useContext(a0);if(t===null)return[!0,null];const{isPresent:r,onExitComplete:s,register:n}=t,a=j.useId();j.useEffect(()=>{if(e)return n(a)},[e]);const i=j.useCallback(()=>e&&s&&s(a),[a,s,e]);return!r&&s?[!1,i]:[!0]}const cu=e=>e.key||"";function Xv(e){const t=[];return j.Children.forEach(e,r=>{j.isValidElement(r)&&t.push(r)}),t}const nx=({children:e,custom:t,initial:r=!0,onExitComplete:s,presenceAffectsLayout:n=!0,mode:a="sync",propagate:i=!1,anchorX:l="left",root:c})=>{const[u,d]=z_(i),f=j.useMemo(()=>Xv(e),[e]),h=i&&!u?[]:f.map(cu),m=j.useRef(!0),x=j.useRef(f),p=Ip(()=>new Map),[g,w]=j.useState(f),[v,y]=j.useState(f);Qb(()=>{m.current=!1,x.current=f;for(let k=0;k<v.length;k++){const _=cu(v[k]);h.includes(_)?p.delete(_):p.get(_)!==!0&&p.set(_,!1)}},[v,h.length,h.join("-")]);const b=[];if(f!==g){let k=[...f];for(let _=0;_<v.length;_++){const N=v[_],C=cu(N);h.includes(C)||(k.splice(_,0,N),b.push(N))}return a==="wait"&&b.length&&(k=b),y(Xv(k)),w(f),null}const{forceRender:S}=j.useContext(Rp);return o.jsx(o.Fragment,{children:v.map(k=>{const _=cu(k),N=i&&!u?!1:f===v||h.includes(_),C=()=>{if(p.has(_))p.set(_,!0);else return;let B=!0;p.forEach(H=>{H||(B=!1)}),B&&(S==null||S(),y(x.current),i&&(d==null||d()),s&&s())};return o.jsx(D3,{isPresent:N,initial:!m.current||r?void 0:!1,custom:t,presenceAffectsLayout:n,mode:a,root:c,onExitComplete:N?void 0:C,anchorX:l,children:k},_)})})},$_=j.createContext({strict:!1}),Qv={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},vo={};for(const e in Qv)vo[e]={isEnabled:t=>Qv[e].some(r=>!!t[r])};function M3(e){for(const t in e)vo[t]={...vo[t],...e[t]}}const B3=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function _d(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||B3.has(e)}let V_=e=>!_d(e);function U3(e){typeof e=="function"&&(V_=t=>t.startsWith("on")?!_d(t):e(t))}try{U3(require("@emotion/is-prop-valid").default)}catch{}function z3(e,t,r){const s={};for(const n in e)n==="values"&&typeof e.values=="object"||(V_(n)||r===!0&&_d(n)||!t&&!_d(n)||e.draggable&&n.startsWith("onDrag"))&&(s[n]=e[n]);return s}const i0=j.createContext({});function o0(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}function Zl(e){return typeof e=="string"||Array.isArray(e)}const ax=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],ix=["initial",...ax];function l0(e){return o0(e.animate)||ix.some(t=>Zl(e[t]))}function W_(e){return!!(l0(e)||e.variants)}function $3(e,t){if(l0(e)){const{initial:r,animate:s}=e;return{initial:r===!1||Zl(r)?r:void 0,animate:Zl(s)?s:void 0}}return e.inherit!==!1?t:{}}function V3(e){const{initial:t,animate:r}=$3(e,j.useContext(i0));return j.useMemo(()=>({initial:t,animate:r}),[Yv(t),Yv(r)])}function Yv(e){return Array.isArray(e)?e.join(" "):e}const ec={};function W3(e){for(const t in e)ec[t]=e[t],Vp(t)&&(ec[t].isCSSVariable=!0)}function q_(e,{layout:t,layoutId:r}){return Fo.has(e)||e.startsWith("origin")||(t||r!==void 0)&&(!!ec[e]||e==="opacity")}const q3={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},H3=Ao.length;function G3(e,t,r){let s="",n=!0;for(let a=0;a<H3;a++){const i=Ao[a],l=e[i];if(l===void 0)continue;let c=!0;if(typeof l=="number"?c=l===(i.startsWith("scale")?1:0):c=parseFloat(l)===0,!c||r){const u=O_(l,ex[i]);if(!c){n=!1;const d=q3[i]||i;s+=`${d}(${u}) `}r&&(t[i]=u)}}return s=s.trim(),r?s=r(t,n?"":s):n&&(s="none"),s}function ox(e,t,r){const{style:s,vars:n,transformOrigin:a}=e;let i=!1,l=!1;for(const c in t){const u=t[c];if(Fo.has(c)){i=!0;continue}else if(Vp(c)){n[c]=u;continue}else{const d=O_(u,ex[c]);c.startsWith("origin")?(l=!0,a[c]=d):s[c]=d}}if(t.transform||(i||r?s.transform=G3(t,e.transform,r):s.transform&&(s.transform="none")),l){const{originX:c="50%",originY:u="50%",originZ:d=0}=a;s.transformOrigin=`${c} ${u} ${d}`}}const lx=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function H_(e,t,r){for(const s in t)!Tr(t[s])&&!q_(s,r)&&(e[s]=t[s])}function K3({transformTemplate:e},t){return j.useMemo(()=>{const r=lx();return ox(r,t,e),Object.assign({},r.vars,r.style)},[t])}function X3(e,t){const r=e.style||{},s={};return H_(s,r,e),Object.assign(s,K3(e,t)),s}function Q3(e,t){const r={},s=X3(e,t);return e.drag&&e.dragListener!==!1&&(r.draggable=!1,s.userSelect=s.WebkitUserSelect=s.WebkitTouchCallout="none",s.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(r.tabIndex=0),r.style=s,r}const Y3={offset:"stroke-dashoffset",array:"stroke-dasharray"},J3={offset:"strokeDashoffset",array:"strokeDasharray"};function Z3(e,t,r=1,s=0,n=!0){e.pathLength=1;const a=n?Y3:J3;e[a.offset]=We.transform(-s);const i=We.transform(t),l=We.transform(r);e[a.array]=`${i} ${l}`}function G_(e,{attrX:t,attrY:r,attrScale:s,pathLength:n,pathSpacing:a=1,pathOffset:i=0,...l},c,u,d){if(ox(e,l,u),c){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:f,style:h}=e;f.transform&&(h.transform=f.transform,delete f.transform),(h.transform||f.transformOrigin)&&(h.transformOrigin=f.transformOrigin??"50% 50%",delete f.transformOrigin),h.transform&&(h.transformBox=(d==null?void 0:d.transformBox)??"fill-box",delete f.transformBox),t!==void 0&&(f.x=t),r!==void 0&&(f.y=r),s!==void 0&&(f.scale=s),n!==void 0&&Z3(f,n,a,i,!1)}const K_=()=>({...lx(),attrs:{}}),X_=e=>typeof e=="string"&&e.toLowerCase()==="svg";function eA(e,t,r,s){const n=j.useMemo(()=>{const a=K_();return G_(a,t,X_(s),e.transformTemplate,e.style),{...a.attrs,style:{...a.style}}},[t]);if(e.style){const a={};H_(a,e.style,e),n.style={...a,...n.style}}return n}const tA=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function cx(e){return typeof e!="string"||e.includes("-")?!1:!!(tA.indexOf(e)>-1||/[A-Z]/u.test(e))}function rA(e,t,r,{latestValues:s},n,a=!1){const l=(cx(e)?eA:Q3)(t,s,n,e),c=z3(t,typeof e=="string",a),u=e!==j.Fragment?{...c,...l,ref:r}:{},{children:d}=t,f=j.useMemo(()=>Tr(d)?d.get():d,[d]);return j.createElement(e,{...u,children:f})}function Jv(e){const t=[{},{}];return e==null||e.values.forEach((r,s)=>{t[0][s]=r.get(),t[1][s]=r.getVelocity()}),t}function ux(e,t,r,s){if(typeof t=="function"){const[n,a]=Jv(s);t=t(r!==void 0?r:e.custom,n,a)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[n,a]=Jv(s);t=t(r!==void 0?r:e.custom,n,a)}return t}function qu(e){return Tr(e)?e.get():e}function sA({scrapeMotionValuesFromProps:e,createRenderState:t},r,s,n){return{latestValues:nA(r,s,n,e),renderState:t()}}function nA(e,t,r,s){const n={},a=s(e,{});for(const h in a)n[h]=qu(a[h]);let{initial:i,animate:l}=e;const c=l0(e),u=W_(e);t&&u&&!c&&e.inherit!==!1&&(i===void 0&&(i=t.initial),l===void 0&&(l=t.animate));let d=r?r.initial===!1:!1;d=d||i===!1;const f=d?l:i;if(f&&typeof f!="boolean"&&!o0(f)){const h=Array.isArray(f)?f:[f];for(let m=0;m<h.length;m++){const x=ux(e,h[m]);if(x){const{transitionEnd:p,transition:g,...w}=x;for(const v in w){let y=w[v];if(Array.isArray(y)){const b=d?y.length-1:0;y=y[b]}y!==null&&(n[v]=y)}for(const v in p)n[v]=p[v]}}}return n}const Q_=e=>(t,r)=>{const s=j.useContext(i0),n=j.useContext(a0),a=()=>sA(e,t,s,n);return r?a():Ip(a)};function dx(e,t,r){var a;const{style:s}=e,n={};for(const i in s)(Tr(s[i])||t.style&&Tr(t.style[i])||q_(i,e)||((a=r==null?void 0:r.getValue(i))==null?void 0:a.liveStyle)!==void 0)&&(n[i]=s[i]);return n}const aA=Q_({scrapeMotionValuesFromProps:dx,createRenderState:lx});function Y_(e,t,r){const s=dx(e,t,r);for(const n in e)if(Tr(e[n])||Tr(t[n])){const a=Ao.indexOf(n)!==-1?"attr"+n.charAt(0).toUpperCase()+n.substring(1):n;s[a]=e[n]}return s}const iA=Q_({scrapeMotionValuesFromProps:Y_,createRenderState:K_}),oA=Symbol.for("motionComponentSymbol");function qi(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function lA(e,t,r){return j.useCallback(s=>{s&&e.onMount&&e.onMount(s),t&&(s?t.mount(s):t.unmount()),r&&(typeof r=="function"?r(s):qi(r)&&(r.current=s))},[t])}const fx=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),cA="framerAppearId",J_="data-"+fx(cA),Z_=j.createContext({});function uA(e,t,r,s,n){var p,g;const{visualElement:a}=j.useContext(i0),i=j.useContext($_),l=j.useContext(a0),c=j.useContext(sx).reducedMotion,u=j.useRef(null);s=s||i.renderer,!u.current&&s&&(u.current=s(e,{visualState:t,parent:a,props:r,presenceContext:l,blockInitialAnimation:l?l.initial===!1:!1,reducedMotionConfig:c}));const d=u.current,f=j.useContext(Z_);d&&!d.projection&&n&&(d.type==="html"||d.type==="svg")&&dA(u.current,r,n,f);const h=j.useRef(!1);j.useInsertionEffect(()=>{d&&h.current&&d.update(r,l)});const m=r[J_],x=j.useRef(!!m&&!((p=window.MotionHandoffIsComplete)!=null&&p.call(window,m))&&((g=window.MotionHasOptimisedAnimation)==null?void 0:g.call(window,m)));return Qb(()=>{d&&(h.current=!0,window.MotionIsMounted=!0,d.updateFeatures(),d.scheduleRenderMicrotask(),x.current&&d.animationState&&d.animationState.animateChanges())}),j.useEffect(()=>{d&&(!x.current&&d.animationState&&d.animationState.animateChanges(),x.current&&(queueMicrotask(()=>{var w;(w=window.MotionHandoffMarkAsComplete)==null||w.call(window,m)}),x.current=!1),d.enteringChildren=void 0)}),d}function dA(e,t,r,s){const{layoutId:n,layout:a,drag:i,dragConstraints:l,layoutScroll:c,layoutRoot:u,layoutCrossfade:d}=t;e.projection=new r(e.latestValues,t["data-framer-portal-id"]?void 0:eS(e.parent)),e.projection.setOptions({layoutId:n,layout:a,alwaysMeasureLayout:!!i||l&&qi(l),visualElement:e,animationType:typeof a=="string"?a:"both",initialPromotionConfig:s,crossfade:d,layoutScroll:c,layoutRoot:u})}function eS(e){if(e)return e.options.allowProjection!==!1?e.projection:eS(e.parent)}function cf(e,{forwardMotionProps:t=!1}={},r,s){r&&M3(r);const n=cx(e)?iA:aA;function a(l,c){let u;const d={...j.useContext(sx),...l,layoutId:fA(l)},{isStatic:f}=d,h=V3(l),m=n(l,f);if(!f&&Op){hA();const x=mA(d);u=x.MeasureLayout,h.visualElement=uA(e,m,d,s,x.ProjectionNode)}return o.jsxs(i0.Provider,{value:h,children:[u&&h.visualElement?o.jsx(u,{visualElement:h.visualElement,...d}):null,rA(e,l,lA(m,h.visualElement,c),m,f,t)]})}a.displayName=`motion.${typeof e=="string"?e:`create(${e.displayName??e.name??""})`}`;const i=j.forwardRef(a);return i[oA]=e,i}function fA({layoutId:e}){const t=j.useContext(Rp).id;return t&&e!==void 0?t+"-"+e:e}function hA(e,t){j.useContext($_).strict}function mA(e){const{drag:t,layout:r}=vo;if(!t&&!r)return{};const s={...t,...r};return{MeasureLayout:t!=null&&t.isEnabled(e)||r!=null&&r.isEnabled(e)?s.MeasureLayout:void 0,ProjectionNode:s.ProjectionNode}}function pA(e,t){if(typeof Proxy>"u")return cf;const r=new Map,s=(a,i)=>cf(a,i,e,t),n=(a,i)=>s(a,i);return new Proxy(n,{get:(a,i)=>i==="create"?s:(r.has(i)||r.set(i,cf(i,void 0,e,t)),r.get(i))})}function tS({top:e,left:t,right:r,bottom:s}){return{x:{min:t,max:r},y:{min:e,max:s}}}function xA({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function gA(e,t){if(!t)return e;const r=t({x:e.left,y:e.top}),s=t({x:e.right,y:e.bottom});return{top:r.y,left:r.x,bottom:s.y,right:s.x}}function uf(e){return e===void 0||e===1}function Jh({scale:e,scaleX:t,scaleY:r}){return!uf(e)||!uf(t)||!uf(r)}function Aa(e){return Jh(e)||rS(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function rS(e){return Zv(e.x)||Zv(e.y)}function Zv(e){return e&&e!=="0%"}function Sd(e,t,r){const s=e-r,n=t*s;return r+n}function ey(e,t,r,s,n){return n!==void 0&&(e=Sd(e,n,s)),Sd(e,r,s)+t}function Zh(e,t=0,r=1,s,n){e.min=ey(e.min,t,r,s,n),e.max=ey(e.max,t,r,s,n)}function sS(e,{x:t,y:r}){Zh(e.x,t.translate,t.scale,t.originPoint),Zh(e.y,r.translate,r.scale,r.originPoint)}const ty=.999999999999,ry=1.0000000000001;function vA(e,t,r,s=!1){const n=r.length;if(!n)return;t.x=t.y=1;let a,i;for(let l=0;l<n;l++){a=r[l],i=a.projectionDelta;const{visualElement:c}=a.options;c&&c.props.style&&c.props.style.display==="contents"||(s&&a.options.layoutScroll&&a.scroll&&a!==a.root&&Gi(e,{x:-a.scroll.offset.x,y:-a.scroll.offset.y}),i&&(t.x*=i.x.scale,t.y*=i.y.scale,sS(e,i)),s&&Aa(a.latestValues)&&Gi(e,a.latestValues))}t.x<ry&&t.x>ty&&(t.x=1),t.y<ry&&t.y>ty&&(t.y=1)}function Hi(e,t){e.min=e.min+t,e.max=e.max+t}function sy(e,t,r,s,n=.5){const a=Ft(e.min,e.max,n);Zh(e,t,r,a,s)}function Gi(e,t){sy(e.x,t.x,t.scaleX,t.scale,t.originX),sy(e.y,t.y,t.scaleY,t.scale,t.originY)}function nS(e,t){return tS(gA(e.getBoundingClientRect(),t))}function yA(e,t,r){const s=nS(e,r),{scroll:n}=t;return n&&(Hi(s.x,n.offset.x),Hi(s.y,n.offset.y)),s}const ny=()=>({translate:0,scale:1,origin:0,originPoint:0}),Ki=()=>({x:ny(),y:ny()}),ay=()=>({min:0,max:0}),$t=()=>({x:ay(),y:ay()}),em={current:null},aS={current:!1};function wA(){if(aS.current=!0,!!Op)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>em.current=e.matches;e.addEventListener("change",t),t()}else em.current=!1}const bA=new WeakMap;function _A(e,t,r){for(const s in t){const n=t[s],a=r[s];if(Tr(n))e.addValue(s,n);else if(Tr(a))e.addValue(s,go(n,{owner:e}));else if(a!==n)if(e.hasValue(s)){const i=e.getValue(s);i.liveStyle===!0?i.jump(n):i.hasAnimated||i.set(n)}else{const i=e.getStaticValue(s);e.addValue(s,go(i!==void 0?i:n,{owner:e}))}}for(const s in r)t[s]===void 0&&e.removeValue(s);return t}const iy=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class SA{scrapeMotionValuesFromProps(t,r,s){return{}}constructor({parent:t,props:r,presenceContext:s,reducedMotionConfig:n,blockInitialAnimation:a,visualState:i},l={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=Jp,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const h=Gr.now();this.renderScheduledAt<h&&(this.renderScheduledAt=h,Nt.render(this.render,!1,!0))};const{latestValues:c,renderState:u}=i;this.latestValues=c,this.baseTarget={...c},this.initialValues=r.initial?{...c}:{},this.renderState=u,this.parent=t,this.props=r,this.presenceContext=s,this.depth=t?t.depth+1:0,this.reducedMotionConfig=n,this.options=l,this.blockInitialAnimation=!!a,this.isControllingVariants=l0(r),this.isVariantNode=W_(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:d,...f}=this.scrapeMotionValuesFromProps(r,{},this);for(const h in f){const m=f[h];c[h]!==void 0&&Tr(m)&&m.set(c[h])}}mount(t){var r;this.current=t,bA.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((s,n)=>this.bindToMotionValue(n,s)),aS.current||wA(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:em.current,(r=this.parent)==null||r.addChild(this),this.update(this.props,this.presenceContext)}unmount(){var t;this.projection&&this.projection.unmount(),la(this.notifyUpdate),la(this.render),this.valueSubscriptions.forEach(r=>r()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),(t=this.parent)==null||t.removeChild(this);for(const r in this.events)this.events[r].clear();for(const r in this.features){const s=this.features[r];s&&(s.unmount(),s.isMounted=!1)}this.current=null}addChild(t){this.children.add(t),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(t)}removeChild(t){this.children.delete(t),this.enteringChildren&&this.enteringChildren.delete(t)}bindToMotionValue(t,r){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const s=Fo.has(t);s&&this.onBindTransform&&this.onBindTransform();const n=r.on("change",i=>{this.latestValues[t]=i,this.props.onUpdate&&Nt.preRender(this.notifyUpdate),s&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,t,r)),this.valueSubscriptions.set(t,()=>{n(),a&&a(),r.owner&&r.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in vo){const r=vo[t];if(!r)continue;const{isEnabled:s,Feature:n}=r;if(!this.features[t]&&n&&s(this.props)&&(this.features[t]=new n(this)),this.features[t]){const a=this.features[t];a.isMounted?a.update():(a.mount(),a.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):$t()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,r){this.latestValues[t]=r}update(t,r){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let s=0;s<iy.length;s++){const n=iy[s];this.propEventSubscriptions[n]&&(this.propEventSubscriptions[n](),delete this.propEventSubscriptions[n]);const a="on"+n,i=t[a];i&&(this.propEventSubscriptions[n]=this.on(n,i))}this.prevMotionValues=_A(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(t),()=>r.variantChildren.delete(t)}addValue(t,r){const s=this.values.get(t);r!==s&&(s&&this.removeValue(t),this.bindToMotionValue(t,r),this.values.set(t,r),this.latestValues[t]=r.get())}removeValue(t){this.values.delete(t);const r=this.valueSubscriptions.get(t);r&&(r(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,r){if(this.props.values&&this.props.values[t])return this.props.values[t];let s=this.values.get(t);return s===void 0&&r!==void 0&&(s=go(r===null?void 0:r,{owner:this}),this.addValue(t,s)),s}readValue(t,r){let s=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:this.getBaseTargetFromProps(this.props,t)??this.readValueFromInstance(this.current,t,this.options);return s!=null&&(typeof s=="string"&&(Yb(s)||Zb(s))?s=parseFloat(s):!F3(s)&&ca.test(r)&&(s=I_(t,r)),this.setBaseTarget(t,Tr(s)?s.get():s)),Tr(s)?s.get():s}setBaseTarget(t,r){this.baseTarget[t]=r}getBaseTarget(t){var a;const{initial:r}=this.props;let s;if(typeof r=="string"||typeof r=="object"){const i=ux(this.props,r,(a=this.presenceContext)==null?void 0:a.custom);i&&(s=i[t])}if(r&&s!==void 0)return s;const n=this.getBaseTargetFromProps(this.props,t);return n!==void 0&&!Tr(n)?n:this.initialValues[t]!==void 0&&s===void 0?void 0:this.baseTarget[t]}on(t,r){return this.events[t]||(this.events[t]=new Up),this.events[t].add(r)}notify(t,...r){this.events[t]&&this.events[t].notify(...r)}scheduleRenderMicrotask(){tx.render(this.render)}}class iS extends SA{constructor(){super(...arguments),this.KeyframeResolver=y3}sortInstanceNodePosition(t,r){return t.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(t,r){return t.style?t.style[r]:void 0}removeValueFromRenderState(t,{vars:r,style:s}){delete r[t],delete s[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;Tr(t)&&(this.childSubscription=t.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}}function oS(e,{style:t,vars:r},s,n){const a=e.style;let i;for(i in t)a[i]=t[i];n==null||n.applyProjectionStyles(a,s);for(i in r)a.setProperty(i,r[i])}function kA(e){return window.getComputedStyle(e)}class NA extends iS{constructor(){super(...arguments),this.type="html",this.renderInstance=oS}readValueFromInstance(t,r){var s;if(Fo.has(r))return(s=this.projection)!=null&&s.isProjecting?qh(r):MC(t,r);{const n=kA(t),a=(Vp(r)?n.getPropertyValue(r):n[r])||0;return typeof a=="string"?a.trim():a}}measureInstanceViewportBox(t,{transformPagePoint:r}){return nS(t,r)}build(t,r,s){ox(t,r,s.transformTemplate)}scrapeMotionValuesFromProps(t,r,s){return dx(t,r,s)}}const lS=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function EA(e,t,r,s){oS(e,t,void 0,s);for(const n in t.attrs)e.setAttribute(lS.has(n)?n:fx(n),t.attrs[n])}class jA extends iS{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=$t}getBaseTargetFromProps(t,r){return t[r]}readValueFromInstance(t,r){if(Fo.has(r)){const s=R_(r);return s&&s.default||0}return r=lS.has(r)?r:fx(r),t.getAttribute(r)}scrapeMotionValuesFromProps(t,r,s){return Y_(t,r,s)}build(t,r,s){G_(t,r,this.isSVGTag,s.transformTemplate,s.style)}renderInstance(t,r,s,n){EA(t,r,s,n)}mount(t){this.isSVGTag=X_(t.tagName),super.mount(t)}}const TA=(e,t)=>cx(e)?new jA(t):new NA(t,{allowProjection:e!==j.Fragment});function ro(e,t,r){const s=e.getProps();return ux(s,t,r!==void 0?r:s.custom,e)}const tm=e=>Array.isArray(e);function CA(e,t,r){e.hasValue(t)?e.getValue(t).set(r):e.addValue(t,go(r))}function AA(e){return tm(e)?e[e.length-1]||0:e}function FA(e,t){const r=ro(e,t);let{transitionEnd:s={},transition:n={},...a}=r||{};a={...a,...s};for(const i in a){const l=AA(a[i]);CA(e,i,l)}}function PA(e){return!!(Tr(e)&&e.add)}function rm(e,t){const r=e.getValue("willChange");if(PA(r))return r.add(t);if(!r&&Rn.WillChange){const s=new Rn.WillChange("auto");e.addValue("willChange",s),s.add(t)}}function cS(e){return e.props[J_]}const RA=e=>e!==null;function IA(e,{repeat:t,repeatType:r="loop"},s){const n=e.filter(RA),a=t&&r!=="loop"&&t%2===1?0:n.length-1;return n[a]}const OA={type:"spring",stiffness:500,damping:25,restSpeed:10},DA=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),LA={type:"keyframes",duration:.8},MA={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},BA=(e,{keyframes:t})=>t.length>2?LA:Fo.has(e)?e.startsWith("scale")?DA(t[1]):OA:MA;function UA({when:e,delay:t,delayChildren:r,staggerChildren:s,staggerDirection:n,repeat:a,repeatType:i,repeatDelay:l,from:c,elapsed:u,...d}){return!!Object.keys(d).length}const hx=(e,t,r,s={},n,a)=>i=>{const l=Zp(s,e)||{},c=l.delay||s.delay||0;let{elapsed:u=0}=s;u=u-dn(c);const d={keyframes:Array.isArray(r)?r:[null,r],ease:"easeOut",velocity:t.getVelocity(),...l,delay:-u,onUpdate:h=>{t.set(h),l.onUpdate&&l.onUpdate(h)},onComplete:()=>{i(),l.onComplete&&l.onComplete()},name:e,motionValue:t,element:a?void 0:n};UA(l)||Object.assign(d,BA(e,d)),d.duration&&(d.duration=dn(d.duration)),d.repeatDelay&&(d.repeatDelay=dn(d.repeatDelay)),d.from!==void 0&&(d.keyframes[0]=d.from);let f=!1;if((d.type===!1||d.duration===0&&!d.repeatDelay)&&(Qh(d),d.delay===0&&(f=!0)),(Rn.instantAnimations||Rn.skipAnimations)&&(f=!0,Qh(d),d.delay=0),d.allowFlatten=!l.type&&!l.ease,f&&!a&&t.get()!==void 0){const h=IA(d.keyframes,l);if(h!==void 0){Nt.update(()=>{d.onUpdate(h),d.onComplete()});return}}return l.isSync?new Yp(d):new o3(d)};function zA({protectedKeys:e,needsAnimating:t},r){const s=e.hasOwnProperty(r)&&t[r]!==!0;return t[r]=!1,s}function uS(e,t,{delay:r=0,transitionOverride:s,type:n}={}){let{transition:a=e.getDefaultTransition(),transitionEnd:i,...l}=t;s&&(a=s);const c=[],u=n&&e.animationState&&e.animationState.getState()[n];for(const d in l){const f=e.getValue(d,e.latestValues[d]??null),h=l[d];if(h===void 0||u&&zA(u,d))continue;const m={delay:r,...Zp(a||{},d)},x=f.get();if(x!==void 0&&!f.isAnimating&&!Array.isArray(h)&&h===x&&!m.velocity)continue;let p=!1;if(window.MotionHandoffAnimation){const w=cS(e);if(w){const v=window.MotionHandoffAnimation(w,d,Nt);v!==null&&(m.startTime=v,p=!0)}}rm(e,d),f.start(hx(d,f,h,e.shouldReduceMotion&&A_.has(d)?{type:!1}:m,e,p));const g=f.animation;g&&c.push(g)}return i&&Promise.all(c).then(()=>{Nt.update(()=>{i&&FA(e,i)})}),c}function dS(e,t,r,s=0,n=1){const a=Array.from(e).sort((u,d)=>u.sortNodePosition(d)).indexOf(t),i=e.size,l=(i-1)*s;return typeof r=="function"?r(a,i):n===1?a*s:l-a*s}function sm(e,t,r={}){var c;const s=ro(e,t,r.type==="exit"?(c=e.presenceContext)==null?void 0:c.custom:void 0);let{transition:n=e.getDefaultTransition()||{}}=s||{};r.transitionOverride&&(n=r.transitionOverride);const a=s?()=>Promise.all(uS(e,s,r)):()=>Promise.resolve(),i=e.variantChildren&&e.variantChildren.size?(u=0)=>{const{delayChildren:d=0,staggerChildren:f,staggerDirection:h}=n;return $A(e,t,u,d,f,h,r)}:()=>Promise.resolve(),{when:l}=n;if(l){const[u,d]=l==="beforeChildren"?[a,i]:[i,a];return u().then(()=>d())}else return Promise.all([a(),i(r.delay)])}function $A(e,t,r=0,s=0,n=0,a=1,i){const l=[];for(const c of e.variantChildren)c.notify("AnimationStart",t),l.push(sm(c,t,{...i,delay:r+(typeof s=="function"?0:s)+dS(e.variantChildren,c,s,n,a)}).then(()=>c.notify("AnimationComplete",t)));return Promise.all(l)}function VA(e,t,r={}){e.notify("AnimationStart",t);let s;if(Array.isArray(t)){const n=t.map(a=>sm(e,a,r));s=Promise.all(n)}else if(typeof t=="string")s=sm(e,t,r);else{const n=typeof t=="function"?ro(e,t,r.custom):t;s=Promise.all(uS(e,n,r))}return s.then(()=>{e.notify("AnimationComplete",t)})}function fS(e,t){if(!Array.isArray(t))return!1;const r=t.length;if(r!==e.length)return!1;for(let s=0;s<r;s++)if(t[s]!==e[s])return!1;return!0}const WA=ix.length;function hS(e){if(!e)return;if(!e.isControllingVariants){const r=e.parent?hS(e.parent)||{}:{};return e.props.initial!==void 0&&(r.initial=e.props.initial),r}const t={};for(let r=0;r<WA;r++){const s=ix[r],n=e.props[s];(Zl(n)||n===!1)&&(t[s]=n)}return t}const qA=[...ax].reverse(),HA=ax.length;function GA(e){return t=>Promise.all(t.map(({animation:r,options:s})=>VA(e,r,s)))}function KA(e){let t=GA(e),r=oy(),s=!0;const n=c=>(u,d)=>{var h;const f=ro(e,d,c==="exit"?(h=e.presenceContext)==null?void 0:h.custom:void 0);if(f){const{transition:m,transitionEnd:x,...p}=f;u={...u,...p,...x}}return u};function a(c){t=c(e)}function i(c){const{props:u}=e,d=hS(e.parent)||{},f=[],h=new Set;let m={},x=1/0;for(let g=0;g<HA;g++){const w=qA[g],v=r[w],y=u[w]!==void 0?u[w]:d[w],b=Zl(y),S=w===c?v.isActive:null;S===!1&&(x=g);let k=y===d[w]&&y!==u[w]&&b;if(k&&s&&e.manuallyAnimateOnMount&&(k=!1),v.protectedKeys={...m},!v.isActive&&S===null||!y&&!v.prevProp||o0(y)||typeof y=="boolean")continue;const _=XA(v.prevProp,y);let N=_||w===c&&v.isActive&&!k&&b||g>x&&b,C=!1;const B=Array.isArray(y)?y:[y];let H=B.reduce(n(w),{});S===!1&&(H={});const{prevResolvedValues:V={}}=v,K={...V,...H},Y=ie=>{N=!0,h.has(ie)&&(C=!0,h.delete(ie)),v.needsAnimating[ie]=!0;const W=e.getValue(ie);W&&(W.liveStyle=!1)};for(const ie in K){const W=H[ie],U=V[ie];if(m.hasOwnProperty(ie))continue;let he=!1;tm(W)&&tm(U)?he=!fS(W,U):he=W!==U,he?W!=null?Y(ie):h.add(ie):W!==void 0&&h.has(ie)?Y(ie):v.protectedKeys[ie]=!0}v.prevProp=y,v.prevResolvedValues=H,v.isActive&&(m={...m,...H}),s&&e.blockInitialAnimation&&(N=!1);const q=k&&_;N&&(!q||C)&&f.push(...B.map(ie=>{const W={type:w};if(typeof ie=="string"&&s&&!q&&e.manuallyAnimateOnMount&&e.parent){const{parent:U}=e,he=ro(U,ie);if(U.enteringChildren&&he){const{delayChildren:be}=he.transition||{};W.delay=dS(U.enteringChildren,e,be)}}return{animation:ie,options:W}}))}if(h.size){const g={};if(typeof u.initial!="boolean"){const w=ro(e,Array.isArray(u.initial)?u.initial[0]:u.initial);w&&w.transition&&(g.transition=w.transition)}h.forEach(w=>{const v=e.getBaseTarget(w),y=e.getValue(w);y&&(y.liveStyle=!0),g[w]=v??null}),f.push({animation:g})}let p=!!f.length;return s&&(u.initial===!1||u.initial===u.animate)&&!e.manuallyAnimateOnMount&&(p=!1),s=!1,p?t(f):Promise.resolve()}function l(c,u){var f;if(r[c].isActive===u)return Promise.resolve();(f=e.variantChildren)==null||f.forEach(h=>{var m;return(m=h.animationState)==null?void 0:m.setActive(c,u)}),r[c].isActive=u;const d=i(c);for(const h in r)r[h].protectedKeys={};return d}return{animateChanges:i,setActive:l,setAnimateFunction:a,getState:()=>r,reset:()=>{r=oy()}}}function XA(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!fS(t,e):!1}function Na(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function oy(){return{animate:Na(!0),whileInView:Na(),whileHover:Na(),whileTap:Na(),whileDrag:Na(),whileFocus:Na(),exit:Na()}}class va{constructor(t){this.isMounted=!1,this.node=t}update(){}}class QA extends va{constructor(t){super(t),t.animationState||(t.animationState=KA(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();o0(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:r}=this.node.prevProps||{};t!==r&&this.updateAnimationControlsSubscription()}unmount(){var t;this.node.animationState.reset(),(t=this.unmountControls)==null||t.call(this)}}let YA=0;class JA extends va{constructor(){super(...arguments),this.id=YA++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:r}=this.node.presenceContext,{isPresent:s}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===s)return;const n=this.node.animationState.setActive("exit",!t);r&&!t&&n.then(()=>{r(this.id)})}mount(){const{register:t,onExitComplete:r}=this.node.presenceContext||{};r&&r(this.id),t&&(this.unmount=t(this.id))}unmount(){}}const ZA={animation:{Feature:QA},exit:{Feature:JA}};function tc(e,t,r,s={passive:!0}){return e.addEventListener(t,r,s),()=>e.removeEventListener(t,r)}function Ac(e){return{point:{x:e.pageX,y:e.pageY}}}const e6=e=>t=>rx(t)&&e(t,Ac(t));function wl(e,t,r,s){return tc(e,t,e6(r),s)}const mS=1e-4,t6=1-mS,r6=1+mS,pS=.01,s6=0-pS,n6=0+pS;function Br(e){return e.max-e.min}function a6(e,t,r){return Math.abs(e-t)<=r}function ly(e,t,r,s=.5){e.origin=s,e.originPoint=Ft(t.min,t.max,e.origin),e.scale=Br(r)/Br(t),e.translate=Ft(r.min,r.max,e.origin)-e.originPoint,(e.scale>=t6&&e.scale<=r6||isNaN(e.scale))&&(e.scale=1),(e.translate>=s6&&e.translate<=n6||isNaN(e.translate))&&(e.translate=0)}function bl(e,t,r,s){ly(e.x,t.x,r.x,s?s.originX:void 0),ly(e.y,t.y,r.y,s?s.originY:void 0)}function cy(e,t,r){e.min=r.min+t.min,e.max=e.min+Br(t)}function i6(e,t,r){cy(e.x,t.x,r.x),cy(e.y,t.y,r.y)}function uy(e,t,r){e.min=t.min-r.min,e.max=e.min+Br(t)}function _l(e,t,r){uy(e.x,t.x,r.x),uy(e.y,t.y,r.y)}function _s(e){return[e("x"),e("y")]}const xS=({current:e})=>e?e.ownerDocument.defaultView:null,dy=(e,t)=>Math.abs(e-t);function o6(e,t){const r=dy(e.x,t.x),s=dy(e.y,t.y);return Math.sqrt(r**2+s**2)}class gS{constructor(t,r,{transformPagePoint:s,contextWindow:n=window,dragSnapToOrigin:a=!1,distanceThreshold:i=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const h=ff(this.lastMoveEventInfo,this.history),m=this.startEvent!==null,x=o6(h.offset,{x:0,y:0})>=this.distanceThreshold;if(!m&&!x)return;const{point:p}=h,{timestamp:g}=mr;this.history.push({...p,timestamp:g});const{onStart:w,onMove:v}=this.handlers;m||(w&&w(this.lastMoveEvent,h),this.startEvent=this.lastMoveEvent),v&&v(this.lastMoveEvent,h)},this.handlePointerMove=(h,m)=>{this.lastMoveEvent=h,this.lastMoveEventInfo=df(m,this.transformPagePoint),Nt.update(this.updatePoint,!0)},this.handlePointerUp=(h,m)=>{this.end();const{onEnd:x,onSessionEnd:p,resumeAnimation:g}=this.handlers;if(this.dragSnapToOrigin&&g&&g(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const w=ff(h.type==="pointercancel"?this.lastMoveEventInfo:df(m,this.transformPagePoint),this.history);this.startEvent&&x&&x(h,w),p&&p(h,w)},!rx(t))return;this.dragSnapToOrigin=a,this.handlers=r,this.transformPagePoint=s,this.distanceThreshold=i,this.contextWindow=n||window;const l=Ac(t),c=df(l,this.transformPagePoint),{point:u}=c,{timestamp:d}=mr;this.history=[{...u,timestamp:d}];const{onSessionStart:f}=r;f&&f(t,ff(c,this.history)),this.removeListeners=jc(wl(this.contextWindow,"pointermove",this.handlePointerMove),wl(this.contextWindow,"pointerup",this.handlePointerUp),wl(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),la(this.updatePoint)}}function df(e,t){return t?{point:t(e.point)}:e}function fy(e,t){return{x:e.x-t.x,y:e.y-t.y}}function ff({point:e},t){return{point:e,delta:fy(e,vS(t)),offset:fy(e,l6(t)),velocity:c6(t,.1)}}function l6(e){return e[0]}function vS(e){return e[e.length-1]}function c6(e,t){if(e.length<2)return{x:0,y:0};let r=e.length-1,s=null;const n=vS(e);for(;r>=0&&(s=e[r],!(n.timestamp-s.timestamp>dn(t)));)r--;if(!s)return{x:0,y:0};const a=Cs(n.timestamp-s.timestamp);if(a===0)return{x:0,y:0};const i={x:(n.x-s.x)/a,y:(n.y-s.y)/a};return i.x===1/0&&(i.x=0),i.y===1/0&&(i.y=0),i}function u6(e,{min:t,max:r},s){return t!==void 0&&e<t?e=s?Ft(t,e,s.min):Math.max(e,t):r!==void 0&&e>r&&(e=s?Ft(r,e,s.max):Math.min(e,r)),e}function hy(e,t,r){return{min:t!==void 0?e.min+t:void 0,max:r!==void 0?e.max+r-(e.max-e.min):void 0}}function d6(e,{top:t,left:r,bottom:s,right:n}){return{x:hy(e.x,r,n),y:hy(e.y,t,s)}}function my(e,t){let r=t.min-e.min,s=t.max-e.max;return t.max-t.min<e.max-e.min&&([r,s]=[s,r]),{min:r,max:s}}function f6(e,t){return{x:my(e.x,t.x),y:my(e.y,t.y)}}function h6(e,t){let r=.5;const s=Br(e),n=Br(t);return n>s?r=Ql(t.min,t.max-s,e.min):s>n&&(r=Ql(e.min,e.max-n,t.min)),Pn(0,1,r)}function m6(e,t){const r={};return t.min!==void 0&&(r.min=t.min-e.min),t.max!==void 0&&(r.max=t.max-e.min),r}const nm=.35;function p6(e=nm){return e===!1?e=0:e===!0&&(e=nm),{x:py(e,"left","right"),y:py(e,"top","bottom")}}function py(e,t,r){return{min:xy(e,t),max:xy(e,r)}}function xy(e,t){return typeof e=="number"?e:e[t]||0}const x6=new WeakMap;class g6{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=$t(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=t}start(t,{snapToCursor:r=!1,distanceThreshold:s}={}){const{presenceContext:n}=this.visualElement;if(n&&n.isPresent===!1)return;const a=f=>{const{dragSnapToOrigin:h}=this.getProps();h?this.pauseAnimation():this.stopAnimation(),r&&this.snapToCursor(Ac(f).point)},i=(f,h)=>{const{drag:m,dragPropagation:x,onDragStart:p}=this.getProps();if(m&&!x&&(this.openDragLock&&this.openDragLock(),this.openDragLock=S3(m),!this.openDragLock))return;this.latestPointerEvent=f,this.latestPanInfo=h,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),_s(w=>{let v=this.getAxisMotionValue(w).get()||0;if(fn.test(v)){const{projection:y}=this.visualElement;if(y&&y.layout){const b=y.layout.layoutBox[w];b&&(v=Br(b)*(parseFloat(v)/100))}}this.originPoint[w]=v}),p&&Nt.postRender(()=>p(f,h)),rm(this.visualElement,"transform");const{animationState:g}=this.visualElement;g&&g.setActive("whileDrag",!0)},l=(f,h)=>{this.latestPointerEvent=f,this.latestPanInfo=h;const{dragPropagation:m,dragDirectionLock:x,onDirectionLock:p,onDrag:g}=this.getProps();if(!m&&!this.openDragLock)return;const{offset:w}=h;if(x&&this.currentDirection===null){this.currentDirection=v6(w),this.currentDirection!==null&&p&&p(this.currentDirection);return}this.updateAxis("x",h.point,w),this.updateAxis("y",h.point,w),this.visualElement.render(),g&&g(f,h)},c=(f,h)=>{this.latestPointerEvent=f,this.latestPanInfo=h,this.stop(f,h),this.latestPointerEvent=null,this.latestPanInfo=null},u=()=>_s(f=>{var h;return this.getAnimationState(f)==="paused"&&((h=this.getAxisMotionValue(f).animation)==null?void 0:h.play())}),{dragSnapToOrigin:d}=this.getProps();this.panSession=new gS(t,{onSessionStart:a,onStart:i,onMove:l,onSessionEnd:c,resumeAnimation:u},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:d,distanceThreshold:s,contextWindow:xS(this.visualElement)})}stop(t,r){const s=t||this.latestPointerEvent,n=r||this.latestPanInfo,a=this.isDragging;if(this.cancel(),!a||!n||!s)return;const{velocity:i}=n;this.startAnimation(i);const{onDragEnd:l}=this.getProps();l&&Nt.postRender(()=>l(s,n))}cancel(){this.isDragging=!1;const{projection:t,animationState:r}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:s}=this.getProps();!s&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(t,r,s){const{drag:n}=this.getProps();if(!s||!uu(t,n,this.currentDirection))return;const a=this.getAxisMotionValue(t);let i=this.originPoint[t]+s[t];this.constraints&&this.constraints[t]&&(i=u6(i,this.constraints[t],this.elastic[t])),a.set(i)}resolveConstraints(){var a;const{dragConstraints:t,dragElastic:r}=this.getProps(),s=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(a=this.visualElement.projection)==null?void 0:a.layout,n=this.constraints;t&&qi(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&s?this.constraints=d6(s.layoutBox,t):this.constraints=!1,this.elastic=p6(r),n!==this.constraints&&s&&this.constraints&&!this.hasMutatedConstraints&&_s(i=>{this.constraints!==!1&&this.getAxisMotionValue(i)&&(this.constraints[i]=m6(s.layoutBox[i],this.constraints[i]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:r}=this.getProps();if(!t||!qi(t))return!1;const s=t.current,{projection:n}=this.visualElement;if(!n||!n.layout)return!1;const a=yA(s,n.root,this.visualElement.getTransformPagePoint());let i=f6(n.layout.layoutBox,a);if(r){const l=r(xA(i));this.hasMutatedConstraints=!!l,l&&(i=tS(l))}return i}startAnimation(t){const{drag:r,dragMomentum:s,dragElastic:n,dragTransition:a,dragSnapToOrigin:i,onDragTransitionEnd:l}=this.getProps(),c=this.constraints||{},u=_s(d=>{if(!uu(d,r,this.currentDirection))return;let f=c&&c[d]||{};i&&(f={min:0,max:0});const h=n?200:1e6,m=n?40:1e7,x={type:"inertia",velocity:s?t[d]:0,bounceStiffness:h,bounceDamping:m,timeConstant:750,restDelta:1,restSpeed:10,...a,...f};return this.startAxisValueAnimation(d,x)});return Promise.all(u).then(l)}startAxisValueAnimation(t,r){const s=this.getAxisMotionValue(t);return rm(this.visualElement,t),s.start(hx(t,s,0,r,this.visualElement,!1))}stopAnimation(){_s(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){_s(t=>{var r;return(r=this.getAxisMotionValue(t).animation)==null?void 0:r.pause()})}getAnimationState(t){var r;return(r=this.getAxisMotionValue(t).animation)==null?void 0:r.state}getAxisMotionValue(t){const r=`_drag${t.toUpperCase()}`,s=this.visualElement.getProps(),n=s[r];return n||this.visualElement.getValue(t,(s.initial?s.initial[t]:void 0)||0)}snapToCursor(t){_s(r=>{const{drag:s}=this.getProps();if(!uu(r,s,this.currentDirection))return;const{projection:n}=this.visualElement,a=this.getAxisMotionValue(r);if(n&&n.layout){const{min:i,max:l}=n.layout.layoutBox[r];a.set(t[r]-Ft(i,l,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:r}=this.getProps(),{projection:s}=this.visualElement;if(!qi(r)||!s||!this.constraints)return;this.stopAnimation();const n={x:0,y:0};_s(i=>{const l=this.getAxisMotionValue(i);if(l&&this.constraints!==!1){const c=l.get();n[i]=h6({min:c,max:c},this.constraints[i])}});const{transformTemplate:a}=this.visualElement.getProps();this.visualElement.current.style.transform=a?a({},""):"none",s.root&&s.root.updateScroll(),s.updateLayout(),this.resolveConstraints(),_s(i=>{if(!uu(i,t,null))return;const l=this.getAxisMotionValue(i),{min:c,max:u}=this.constraints[i];l.set(Ft(c,u,n[i]))})}addListeners(){if(!this.visualElement.current)return;x6.set(this.visualElement,this);const t=this.visualElement.current,r=wl(t,"pointerdown",c=>{const{drag:u,dragListener:d=!0}=this.getProps();u&&d&&this.start(c)}),s=()=>{const{dragConstraints:c}=this.getProps();qi(c)&&c.current&&(this.constraints=this.resolveRefConstraints())},{projection:n}=this.visualElement,a=n.addEventListener("measure",s);n&&!n.layout&&(n.root&&n.root.updateScroll(),n.updateLayout()),Nt.read(s);const i=tc(window,"resize",()=>this.scalePositionWithinConstraints()),l=n.addEventListener("didUpdate",({delta:c,hasLayoutChanged:u})=>{this.isDragging&&u&&(_s(d=>{const f=this.getAxisMotionValue(d);f&&(this.originPoint[d]+=c[d].translate,f.set(f.get()+c[d].translate))}),this.visualElement.render())});return()=>{i(),r(),a(),l&&l()}}getProps(){const t=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:s=!1,dragPropagation:n=!1,dragConstraints:a=!1,dragElastic:i=nm,dragMomentum:l=!0}=t;return{...t,drag:r,dragDirectionLock:s,dragPropagation:n,dragConstraints:a,dragElastic:i,dragMomentum:l}}}function uu(e,t,r){return(t===!0||t===e)&&(r===null||r===e)}function v6(e,t=10){let r=null;return Math.abs(e.y)>t?r="y":Math.abs(e.x)>t&&(r="x"),r}class y6 extends va{constructor(t){super(t),this.removeGroupControls=Fs,this.removeListeners=Fs,this.controls=new g6(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Fs}unmount(){this.removeGroupControls(),this.removeListeners()}}const gy=e=>(t,r)=>{e&&Nt.postRender(()=>e(t,r))};class w6 extends va{constructor(){super(...arguments),this.removePointerDownListener=Fs}onPointerDown(t){this.session=new gS(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:xS(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:r,onPan:s,onPanEnd:n}=this.node.getProps();return{onSessionStart:gy(t),onStart:gy(r),onMove:s,onEnd:(a,i)=>{delete this.session,n&&Nt.postRender(()=>n(a,i))}}}mount(){this.removePointerDownListener=wl(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const Hu={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function vy(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const Jo={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(We.test(e))e=parseFloat(e);else return e;const r=vy(e,t.target.x),s=vy(e,t.target.y);return`${r}% ${s}%`}},b6={correct:(e,{treeScale:t,projectionDelta:r})=>{const s=e,n=ca.parse(e);if(n.length>5)return s;const a=ca.createTransformer(e),i=typeof n[0]!="number"?1:0,l=r.x.scale*t.x,c=r.y.scale*t.y;n[0+i]/=l,n[1+i]/=c;const u=Ft(l,c,.5);return typeof n[2+i]=="number"&&(n[2+i]/=u),typeof n[3+i]=="number"&&(n[3+i]/=u),a(n)}};let hf=!1;class _6 extends j.Component{componentDidMount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:s,layoutId:n}=this.props,{projection:a}=t;W3(S6),a&&(r.group&&r.group.add(a),s&&s.register&&n&&s.register(a),hf&&a.root.didUpdate(),a.addEventListener("animationComplete",()=>{this.safeToRemove()}),a.setOptions({...a.options,onExitComplete:()=>this.safeToRemove()})),Hu.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:r,visualElement:s,drag:n,isPresent:a}=this.props,{projection:i}=s;return i&&(i.isPresent=a,hf=!0,n||t.layoutDependency!==r||r===void 0||t.isPresent!==a?i.willUpdate():this.safeToRemove(),t.isPresent!==a&&(a?i.promote():i.relegate()||Nt.postRender(()=>{const l=i.getStack();(!l||!l.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),tx.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:s}=this.props,{projection:n}=t;hf=!0,n&&(n.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(n),s&&s.deregister&&s.deregister(n))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function yS(e){const[t,r]=z_(),s=j.useContext(Rp);return o.jsx(_6,{...e,layoutGroup:s,switchLayoutGroup:j.useContext(Z_),isPresent:t,safeToRemove:r})}const S6={borderRadius:{...Jo,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Jo,borderTopRightRadius:Jo,borderBottomLeftRadius:Jo,borderBottomRightRadius:Jo,boxShadow:b6};function k6(e,t,r){const s=Tr(e)?e:go(e);return s.start(hx("",s,t,r)),s.animation}const N6=(e,t)=>e.depth-t.depth;class E6{constructor(){this.children=[],this.isDirty=!1}add(t){Dp(this.children,t),this.isDirty=!0}remove(t){Lp(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(N6),this.isDirty=!1,this.children.forEach(t)}}function j6(e,t){const r=Gr.now(),s=({timestamp:n})=>{const a=n-r;a>=t&&(la(s),e(a-t))};return Nt.setup(s,!0),()=>la(s)}const wS=["TopLeft","TopRight","BottomLeft","BottomRight"],T6=wS.length,yy=e=>typeof e=="string"?parseFloat(e):e,wy=e=>typeof e=="number"||We.test(e);function C6(e,t,r,s,n,a){n?(e.opacity=Ft(0,r.opacity??1,A6(s)),e.opacityExit=Ft(t.opacity??1,0,F6(s))):a&&(e.opacity=Ft(t.opacity??1,r.opacity??1,s));for(let i=0;i<T6;i++){const l=`border${wS[i]}Radius`;let c=by(t,l),u=by(r,l);if(c===void 0&&u===void 0)continue;c||(c=0),u||(u=0),c===0||u===0||wy(c)===wy(u)?(e[l]=Math.max(Ft(yy(c),yy(u),s),0),(fn.test(u)||fn.test(c))&&(e[l]+="%")):e[l]=u}(t.rotate||r.rotate)&&(e.rotate=Ft(t.rotate||0,r.rotate||0,s))}function by(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const A6=bS(0,.5,o_),F6=bS(.5,.95,Fs);function bS(e,t,r){return s=>s<e?0:s>t?1:r(Ql(e,t,s))}function _y(e,t){e.min=t.min,e.max=t.max}function gs(e,t){_y(e.x,t.x),_y(e.y,t.y)}function Sy(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function ky(e,t,r,s,n){return e-=t,e=Sd(e,1/r,s),n!==void 0&&(e=Sd(e,1/n,s)),e}function P6(e,t=0,r=1,s=.5,n,a=e,i=e){if(fn.test(t)&&(t=parseFloat(t),t=Ft(i.min,i.max,t/100)-i.min),typeof t!="number")return;let l=Ft(a.min,a.max,s);e===a&&(l-=t),e.min=ky(e.min,t,r,l,n),e.max=ky(e.max,t,r,l,n)}function Ny(e,t,[r,s,n],a,i){P6(e,t[r],t[s],t[n],t.scale,a,i)}const R6=["x","scaleX","originX"],I6=["y","scaleY","originY"];function Ey(e,t,r,s){Ny(e.x,t,R6,r?r.x:void 0,s?s.x:void 0),Ny(e.y,t,I6,r?r.y:void 0,s?s.y:void 0)}function jy(e){return e.translate===0&&e.scale===1}function _S(e){return jy(e.x)&&jy(e.y)}function Ty(e,t){return e.min===t.min&&e.max===t.max}function O6(e,t){return Ty(e.x,t.x)&&Ty(e.y,t.y)}function Cy(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function SS(e,t){return Cy(e.x,t.x)&&Cy(e.y,t.y)}function Ay(e){return Br(e.x)/Br(e.y)}function Fy(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class D6{constructor(){this.members=[]}add(t){Dp(this.members,t),t.scheduleRender()}remove(t){if(Lp(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(t){const r=this.members.findIndex(n=>t===n);if(r===0)return!1;let s;for(let n=r;n>=0;n--){const a=this.members[n];if(a.isPresent!==!1){s=a;break}}return s?(this.promote(s),!0):!1}promote(t,r){const s=this.lead;if(t!==s&&(this.prevLead=s,this.lead=t,t.show(),s)){s.instance&&s.scheduleRender(),t.scheduleRender(),t.resumeFrom=s,r&&(t.resumeFrom.preserveOpacity=!0),s.snapshot&&(t.snapshot=s.snapshot,t.snapshot.latestValues=s.animationValues||s.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:n}=t.options;n===!1&&s.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:r,resumingFrom:s}=t;r.onExitComplete&&r.onExitComplete(),s&&s.options.onExitComplete&&s.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function L6(e,t,r){let s="";const n=e.x.translate/t.x,a=e.y.translate/t.y,i=(r==null?void 0:r.z)||0;if((n||a||i)&&(s=`translate3d(${n}px, ${a}px, ${i}px) `),(t.x!==1||t.y!==1)&&(s+=`scale(${1/t.x}, ${1/t.y}) `),r){const{transformPerspective:u,rotate:d,rotateX:f,rotateY:h,skewX:m,skewY:x}=r;u&&(s=`perspective(${u}px) ${s}`),d&&(s+=`rotate(${d}deg) `),f&&(s+=`rotateX(${f}deg) `),h&&(s+=`rotateY(${h}deg) `),m&&(s+=`skewX(${m}deg) `),x&&(s+=`skewY(${x}deg) `)}const l=e.x.scale*t.x,c=e.y.scale*t.y;return(l!==1||c!==1)&&(s+=`scale(${l}, ${c})`),s||"none"}const mf=["","X","Y","Z"],M6=1e3;let B6=0;function pf(e,t,r,s){const{latestValues:n}=t;n[e]&&(r[e]=n[e],t.setStaticValue(e,0),s&&(s[e]=0))}function kS(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const r=cS(t);if(window.MotionHasOptimisedAnimation(r,"transform")){const{layout:n,layoutId:a}=e.options;window.MotionCancelOptimisedAnimation(r,"transform",Nt,!(n||a))}const{parent:s}=e;s&&!s.hasCheckedOptimisedAppear&&kS(s)}function NS({attachResizeListener:e,defaultParent:t,measureScroll:r,checkIsScrollRoot:s,resetTransform:n}){return class{constructor(i={},l=t==null?void 0:t()){this.id=B6++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach($6),this.nodes.forEach(H6),this.nodes.forEach(G6),this.nodes.forEach(V6)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=i,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new E6)}addEventListener(i,l){return this.eventHandlers.has(i)||this.eventHandlers.set(i,new Up),this.eventHandlers.get(i).add(l)}notifyListeners(i,...l){const c=this.eventHandlers.get(i);c&&c.notify(...l)}hasListeners(i){return this.eventHandlers.has(i)}mount(i){if(this.instance)return;this.isSVG=U_(i)&&!C3(i),this.instance=i;const{layoutId:l,layout:c,visualElement:u}=this.options;if(u&&!u.current&&u.mount(i),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(c||l)&&(this.isLayoutDirty=!0),e){let d,f=0;const h=()=>this.root.updateBlockedByResize=!1;Nt.read(()=>{f=window.innerWidth}),e(i,()=>{const m=window.innerWidth;m!==f&&(f=m,this.root.updateBlockedByResize=!0,d&&d(),d=j6(h,250),Hu.hasAnimatedSinceResize&&(Hu.hasAnimatedSinceResize=!1,this.nodes.forEach(Iy)))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&u&&(l||c)&&this.addEventListener("didUpdate",({delta:d,hasLayoutChanged:f,hasRelativeLayoutChanged:h,layout:m})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const x=this.options.transition||u.getDefaultTransition()||J6,{onLayoutAnimationStart:p,onLayoutAnimationComplete:g}=u.getProps(),w=!this.targetLayout||!SS(this.targetLayout,m),v=!f&&h;if(this.options.layoutRoot||this.resumeFrom||v||f&&(w||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const y={...Zp(x,"layout"),onPlay:p,onComplete:g};(u.shouldReduceMotion||this.options.layoutRoot)&&(y.delay=0,y.type=!1),this.startAnimation(y),this.setAnimationOrigin(d,v)}else f||Iy(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=m})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const i=this.getStack();i&&i.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),la(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(K6),this.animationId++)}getTransformTemplate(){const{visualElement:i}=this.options;return i&&i.getProps().transformTemplate}willUpdate(i=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&kS(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let d=0;d<this.path.length;d++){const f=this.path[d];f.shouldResetTransform=!0,f.updateScroll("snapshot"),f.options.layoutRoot&&f.willUpdate(!1)}const{layoutId:l,layout:c}=this.options;if(l===void 0&&!c)return;const u=this.getTransformTemplate();this.prevTransformTemplateValue=u?u(this.latestValues,""):void 0,this.updateSnapshot(),i&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(Py);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(Ry);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(q6),this.nodes.forEach(U6),this.nodes.forEach(z6)):this.nodes.forEach(Ry),this.clearAllSnapshots();const l=Gr.now();mr.delta=Pn(0,1e3/60,l-mr.timestamp),mr.timestamp=l,mr.isProcessing=!0,rf.update.process(mr),rf.preRender.process(mr),rf.render.process(mr),mr.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,tx.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(W6),this.sharedNodes.forEach(X6)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Nt.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Nt.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!Br(this.snapshot.measuredBox.x)&&!Br(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const i=this.layout;this.layout=this.measure(!1),this.layoutCorrected=$t(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:l}=this.options;l&&l.notify("LayoutMeasure",this.layout.layoutBox,i?i.layoutBox:void 0)}updateScroll(i="measure"){let l=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===i&&(l=!1),l&&this.instance){const c=s(this.instance);this.scroll={animationId:this.root.animationId,phase:i,isRoot:c,offset:r(this.instance),wasRoot:this.scroll?this.scroll.isRoot:c}}}resetTransform(){if(!n)return;const i=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,l=this.projectionDelta&&!_S(this.projectionDelta),c=this.getTransformTemplate(),u=c?c(this.latestValues,""):void 0,d=u!==this.prevTransformTemplateValue;i&&this.instance&&(l||Aa(this.latestValues)||d)&&(n(this.instance,u),this.shouldResetTransform=!1,this.scheduleRender())}measure(i=!0){const l=this.measurePageBox();let c=this.removeElementScroll(l);return i&&(c=this.removeTransform(c)),Z6(c),{animationId:this.root.animationId,measuredBox:l,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){var u;const{visualElement:i}=this.options;if(!i)return $t();const l=i.measureViewportBox();if(!(((u=this.scroll)==null?void 0:u.wasRoot)||this.path.some(eF))){const{scroll:d}=this.root;d&&(Hi(l.x,d.offset.x),Hi(l.y,d.offset.y))}return l}removeElementScroll(i){var c;const l=$t();if(gs(l,i),(c=this.scroll)!=null&&c.wasRoot)return l;for(let u=0;u<this.path.length;u++){const d=this.path[u],{scroll:f,options:h}=d;d!==this.root&&f&&h.layoutScroll&&(f.wasRoot&&gs(l,i),Hi(l.x,f.offset.x),Hi(l.y,f.offset.y))}return l}applyTransform(i,l=!1){const c=$t();gs(c,i);for(let u=0;u<this.path.length;u++){const d=this.path[u];!l&&d.options.layoutScroll&&d.scroll&&d!==d.root&&Gi(c,{x:-d.scroll.offset.x,y:-d.scroll.offset.y}),Aa(d.latestValues)&&Gi(c,d.latestValues)}return Aa(this.latestValues)&&Gi(c,this.latestValues),c}removeTransform(i){const l=$t();gs(l,i);for(let c=0;c<this.path.length;c++){const u=this.path[c];if(!u.instance||!Aa(u.latestValues))continue;Jh(u.latestValues)&&u.updateSnapshot();const d=$t(),f=u.measurePageBox();gs(d,f),Ey(l,u.latestValues,u.snapshot?u.snapshot.layoutBox:void 0,d)}return Aa(this.latestValues)&&Ey(l,this.latestValues),l}setTargetDelta(i){this.targetDelta=i,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(i){this.options={...this.options,...i,crossfade:i.crossfade!==void 0?i.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==mr.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(i=!1){var h;const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const c=!!this.resumingFrom||this!==l;if(!(i||c&&this.isSharedProjectionDirty||this.isProjectionDirty||(h=this.parent)!=null&&h.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:d,layoutId:f}=this.options;if(!(!this.layout||!(d||f))){if(this.resolvedRelativeTargetAt=mr.timestamp,!this.targetDelta&&!this.relativeTarget){const m=this.getClosestProjectingParent();m&&m.layout&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=$t(),this.relativeTargetOrigin=$t(),_l(this.relativeTargetOrigin,this.layout.layoutBox,m.layout.layoutBox),gs(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=$t(),this.targetWithTransforms=$t()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),i6(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):gs(this.target,this.layout.layoutBox),sS(this.target,this.targetDelta)):gs(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const m=this.getClosestProjectingParent();m&&!!m.resumingFrom==!!this.resumingFrom&&!m.options.layoutScroll&&m.target&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=$t(),this.relativeTargetOrigin=$t(),_l(this.relativeTargetOrigin,this.target,m.target),gs(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||Jh(this.parent.latestValues)||rS(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var x;const i=this.getLead(),l=!!this.resumingFrom||this!==i;let c=!0;if((this.isProjectionDirty||(x=this.parent)!=null&&x.isProjectionDirty)&&(c=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),this.resolvedRelativeTargetAt===mr.timestamp&&(c=!1),c)return;const{layout:u,layoutId:d}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(u||d))return;gs(this.layoutCorrected,this.layout.layoutBox);const f=this.treeScale.x,h=this.treeScale.y;vA(this.layoutCorrected,this.treeScale,this.path,l),i.layout&&!i.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(i.target=i.layout.layoutBox,i.targetWithTransforms=$t());const{target:m}=i;if(!m){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(Sy(this.prevProjectionDelta.x,this.projectionDelta.x),Sy(this.prevProjectionDelta.y,this.projectionDelta.y)),bl(this.projectionDelta,this.layoutCorrected,m,this.latestValues),(this.treeScale.x!==f||this.treeScale.y!==h||!Fy(this.projectionDelta.x,this.prevProjectionDelta.x)||!Fy(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",m))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(i=!0){var l;if((l=this.options.visualElement)==null||l.scheduleRender(),i){const c=this.getStack();c&&c.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Ki(),this.projectionDelta=Ki(),this.projectionDeltaWithTransform=Ki()}setAnimationOrigin(i,l=!1){const c=this.snapshot,u=c?c.latestValues:{},d={...this.latestValues},f=Ki();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!l;const h=$t(),m=c?c.source:void 0,x=this.layout?this.layout.source:void 0,p=m!==x,g=this.getStack(),w=!g||g.members.length<=1,v=!!(p&&!w&&this.options.crossfade===!0&&!this.path.some(Y6));this.animationProgress=0;let y;this.mixTargetDelta=b=>{const S=b/1e3;Oy(f.x,i.x,S),Oy(f.y,i.y,S),this.setTargetDelta(f),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(_l(h,this.layout.layoutBox,this.relativeParent.layout.layoutBox),Q6(this.relativeTarget,this.relativeTargetOrigin,h,S),y&&O6(this.relativeTarget,y)&&(this.isProjectionDirty=!1),y||(y=$t()),gs(y,this.relativeTarget)),p&&(this.animationValues=d,C6(d,u,this.latestValues,S,v,w)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=S},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(i){var l,c,u;this.notifyListeners("animationStart"),(l=this.currentAnimation)==null||l.stop(),(u=(c=this.resumingFrom)==null?void 0:c.currentAnimation)==null||u.stop(),this.pendingAnimation&&(la(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Nt.update(()=>{Hu.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=go(0)),this.currentAnimation=k6(this.motionValue,[0,1e3],{...i,velocity:0,isSync:!0,onUpdate:d=>{this.mixTargetDelta(d),i.onUpdate&&i.onUpdate(d)},onStop:()=>{},onComplete:()=>{i.onComplete&&i.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const i=this.getStack();i&&i.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(M6),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const i=this.getLead();let{targetWithTransforms:l,target:c,layout:u,latestValues:d}=i;if(!(!l||!c||!u)){if(this!==i&&this.layout&&u&&ES(this.options.animationType,this.layout.layoutBox,u.layoutBox)){c=this.target||$t();const f=Br(this.layout.layoutBox.x);c.x.min=i.target.x.min,c.x.max=c.x.min+f;const h=Br(this.layout.layoutBox.y);c.y.min=i.target.y.min,c.y.max=c.y.min+h}gs(l,c),Gi(l,d),bl(this.projectionDeltaWithTransform,this.layoutCorrected,l,d)}}registerSharedNode(i,l){this.sharedNodes.has(i)||this.sharedNodes.set(i,new D6),this.sharedNodes.get(i).add(l);const u=l.options.initialPromotionConfig;l.promote({transition:u?u.transition:void 0,preserveFollowOpacity:u&&u.shouldPreserveFollowOpacity?u.shouldPreserveFollowOpacity(l):void 0})}isLead(){const i=this.getStack();return i?i.lead===this:!0}getLead(){var l;const{layoutId:i}=this.options;return i?((l=this.getStack())==null?void 0:l.lead)||this:this}getPrevLead(){var l;const{layoutId:i}=this.options;return i?(l=this.getStack())==null?void 0:l.prevLead:void 0}getStack(){const{layoutId:i}=this.options;if(i)return this.root.sharedNodes.get(i)}promote({needsReset:i,transition:l,preserveFollowOpacity:c}={}){const u=this.getStack();u&&u.promote(this,c),i&&(this.projectionDelta=void 0,this.needsReset=!0),l&&this.setOptions({transition:l})}relegate(){const i=this.getStack();return i?i.relegate(this):!1}resetSkewAndRotation(){const{visualElement:i}=this.options;if(!i)return;let l=!1;const{latestValues:c}=i;if((c.z||c.rotate||c.rotateX||c.rotateY||c.rotateZ||c.skewX||c.skewY)&&(l=!0),!l)return;const u={};c.z&&pf("z",i,u,this.animationValues);for(let d=0;d<mf.length;d++)pf(`rotate${mf[d]}`,i,u,this.animationValues),pf(`skew${mf[d]}`,i,u,this.animationValues);i.render();for(const d in u)i.setStaticValue(d,u[d]),this.animationValues&&(this.animationValues[d]=u[d]);i.scheduleRender()}applyProjectionStyles(i,l){if(!this.instance||this.isSVG)return;if(!this.isVisible){i.visibility="hidden";return}const c=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,i.visibility="",i.opacity="",i.pointerEvents=qu(l==null?void 0:l.pointerEvents)||"",i.transform=c?c(this.latestValues,""):"none";return}const u=this.getLead();if(!this.projectionDelta||!this.layout||!u.target){this.options.layoutId&&(i.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,i.pointerEvents=qu(l==null?void 0:l.pointerEvents)||""),this.hasProjected&&!Aa(this.latestValues)&&(i.transform=c?c({},""):"none",this.hasProjected=!1);return}i.visibility="";const d=u.animationValues||u.latestValues;this.applyTransformsToTarget();let f=L6(this.projectionDeltaWithTransform,this.treeScale,d);c&&(f=c(d,f)),i.transform=f;const{x:h,y:m}=this.projectionDelta;i.transformOrigin=`${h.origin*100}% ${m.origin*100}% 0`,u.animationValues?i.opacity=u===this?d.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:d.opacityExit:i.opacity=u===this?d.opacity!==void 0?d.opacity:"":d.opacityExit!==void 0?d.opacityExit:0;for(const x in ec){if(d[x]===void 0)continue;const{correct:p,applyTo:g,isCSSVariable:w}=ec[x],v=f==="none"?d[x]:p(d[x],u);if(g){const y=g.length;for(let b=0;b<y;b++)i[g[b]]=v}else w?this.options.visualElement.renderState.vars[x]=v:i[x]=v}this.options.layoutId&&(i.pointerEvents=u===this?qu(l==null?void 0:l.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(i=>{var l;return(l=i.currentAnimation)==null?void 0:l.stop()}),this.root.nodes.forEach(Py),this.root.sharedNodes.clear()}}}function U6(e){e.updateLayout()}function z6(e){var r;const t=((r=e.resumeFrom)==null?void 0:r.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&t&&e.hasListeners("didUpdate")){const{layoutBox:s,measuredBox:n}=e.layout,{animationType:a}=e.options,i=t.source!==e.layout.source;a==="size"?_s(f=>{const h=i?t.measuredBox[f]:t.layoutBox[f],m=Br(h);h.min=s[f].min,h.max=h.min+m}):ES(a,t.layoutBox,s)&&_s(f=>{const h=i?t.measuredBox[f]:t.layoutBox[f],m=Br(s[f]);h.max=h.min+m,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[f].max=e.relativeTarget[f].min+m)});const l=Ki();bl(l,s,t.layoutBox);const c=Ki();i?bl(c,e.applyTransform(n,!0),t.measuredBox):bl(c,s,t.layoutBox);const u=!_S(l);let d=!1;if(!e.resumeFrom){const f=e.getClosestProjectingParent();if(f&&!f.resumeFrom){const{snapshot:h,layout:m}=f;if(h&&m){const x=$t();_l(x,t.layoutBox,h.layoutBox);const p=$t();_l(p,s,m.layoutBox),SS(x,p)||(d=!0),f.options.layoutRoot&&(e.relativeTarget=p,e.relativeTargetOrigin=x,e.relativeParent=f)}}}e.notifyListeners("didUpdate",{layout:s,snapshot:t,delta:c,layoutDelta:l,hasLayoutChanged:u,hasRelativeLayoutChanged:d})}else if(e.isLead()){const{onExitComplete:s}=e.options;s&&s()}e.options.transition=void 0}function $6(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function V6(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function W6(e){e.clearSnapshot()}function Py(e){e.clearMeasurements()}function Ry(e){e.isLayoutDirty=!1}function q6(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function Iy(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function H6(e){e.resolveTargetDelta()}function G6(e){e.calcProjection()}function K6(e){e.resetSkewAndRotation()}function X6(e){e.removeLeadSnapshot()}function Oy(e,t,r){e.translate=Ft(t.translate,0,r),e.scale=Ft(t.scale,1,r),e.origin=t.origin,e.originPoint=t.originPoint}function Dy(e,t,r,s){e.min=Ft(t.min,r.min,s),e.max=Ft(t.max,r.max,s)}function Q6(e,t,r,s){Dy(e.x,t.x,r.x,s),Dy(e.y,t.y,r.y,s)}function Y6(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const J6={duration:.45,ease:[.4,0,.1,1]},Ly=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),My=Ly("applewebkit/")&&!Ly("chrome/")?Math.round:Fs;function By(e){e.min=My(e.min),e.max=My(e.max)}function Z6(e){By(e.x),By(e.y)}function ES(e,t,r){return e==="position"||e==="preserve-aspect"&&!a6(Ay(t),Ay(r),.2)}function eF(e){var t;return e!==e.root&&((t=e.scroll)==null?void 0:t.wasRoot)}const tF=NS({attachResizeListener:(e,t)=>tc(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),xf={current:void 0},jS=NS({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!xf.current){const e=new tF({});e.mount(window),e.setOptions({layoutScroll:!0}),xf.current=e}return xf.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),rF={pan:{Feature:w6},drag:{Feature:y6,ProjectionNode:jS,MeasureLayout:yS}};function Uy(e,t,r){const{props:s}=e;e.animationState&&s.whileHover&&e.animationState.setActive("whileHover",r==="Start");const n="onHover"+r,a=s[n];a&&Nt.postRender(()=>a(t,Ac(t)))}class sF extends va{mount(){const{current:t}=this.node;t&&(this.unmount=k3(t,(r,s)=>(Uy(this.node,s,"Start"),n=>Uy(this.node,n,"End"))))}unmount(){}}class nF extends va{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=jc(tc(this.node.current,"focus",()=>this.onFocus()),tc(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function zy(e,t,r){const{props:s}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&s.whileTap&&e.animationState.setActive("whileTap",r==="Start");const n="onTap"+(r==="End"?"":r),a=s[n];a&&Nt.postRender(()=>a(t,Ac(t)))}class aF extends va{mount(){const{current:t}=this.node;t&&(this.unmount=T3(t,(r,s)=>(zy(this.node,s,"Start"),(n,{success:a})=>zy(this.node,n,a?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const am=new WeakMap,gf=new WeakMap,iF=e=>{const t=am.get(e.target);t&&t(e)},oF=e=>{e.forEach(iF)};function lF({root:e,...t}){const r=e||document;gf.has(r)||gf.set(r,{});const s=gf.get(r),n=JSON.stringify(t);return s[n]||(s[n]=new IntersectionObserver(oF,{root:e,...t})),s[n]}function cF(e,t,r){const s=lF(t);return am.set(e,r),s.observe(e),()=>{am.delete(e),s.unobserve(e)}}const uF={some:0,all:1};class dF extends va{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:r,margin:s,amount:n="some",once:a}=t,i={root:r?r.current:void 0,rootMargin:s,threshold:typeof n=="number"?n:uF[n]},l=c=>{const{isIntersecting:u}=c;if(this.isInView===u||(this.isInView=u,a&&!u&&this.hasEnteredView))return;u&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",u);const{onViewportEnter:d,onViewportLeave:f}=this.node.getProps(),h=u?d:f;h&&h(c)};return cF(this.node.current,i,l)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:r}=this.node;["amount","margin","root"].some(fF(t,r))&&this.startObserver()}unmount(){}}function fF({viewport:e={}},{viewport:t={}}={}){return r=>e[r]!==t[r]}const hF={inView:{Feature:dF},tap:{Feature:aF},focus:{Feature:nF},hover:{Feature:sF}},mF={layout:{ProjectionNode:jS,MeasureLayout:yS}},pF={...ZA,...hF,...rF,...mF},rc=pA(pF,TA);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var xF={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gF=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Fe=(e,t)=>{const r=j.forwardRef(({color:s="currentColor",size:n=24,strokeWidth:a=2,absoluteStrokeWidth:i,className:l="",children:c,...u},d)=>j.createElement("svg",{ref:d,...xF,width:n,height:n,stroke:s,strokeWidth:i?Number(a)*24/Number(n):a,className:["lucide",`lucide-${gF(e)}`,l].join(" "),...u},[...t.map(([f,h])=>j.createElement(f,h)),...Array.isArray(c)?c:[c]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $y=Fe("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Je=Fe("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _n=Fe("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Po=Fe("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gu=Fe("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vf=Fe("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TS=Fe("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vF=Fe("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yF=Fe("BookDashed",[["path",{d:"M20 22h-2",key:"1rpnb6"}],["path",{d:"M20 15v2h-2",key:"fph276"}],["path",{d:"M4 19.5V15",key:"6gr39e"}],["path",{d:"M20 8v3",key:"deu0bs"}],["path",{d:"M18 2h2v2",key:"180o53"}],["path",{d:"M4 11V9",key:"v3xsx8"}],["path",{d:"M12 2h2",key:"cvn524"}],["path",{d:"M12 22h2",key:"kn7ki6"}],["path",{d:"M12 17h2",key:"13u4lk"}],["path",{d:"M8 22H6.5a2.5 2.5 0 0 1 0-5H8",key:"fiseg2"}],["path",{d:"M4 5v-.5A2.5 2.5 0 0 1 6.5 2H8",key:"wywhs9"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wF=Fe("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yo=Fe("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CS=Fe("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const im=Fe("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tr=Fe("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vy=Fe("CheckSquare",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mx=Fe("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ri=Fe("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AS=Fe("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fc=Fe("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bF=Fe("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wy=Fe("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _F=Fe("ClipboardCheck",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c0=Fe("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SF=Fe("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FS=Fe("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fi=Fe("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const om=Fe("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kF=Fe("FileCheck",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NF=Fe("FileDown",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lm=Fe("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yr=Fe("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qy=Fe("FileUp",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"m15 15-3-3-3 3",key:"15xj92"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PS=Fe("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EF=Fe("Flame",[["path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z",key:"96xj49"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jF=Fe("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TF=Fe("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CF=Fe("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AF=Fe("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wo=Fe("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FF=Fe("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PF=Fe("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cm=Fe("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RF=Fe("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const js=Fe("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IF=Fe("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RS=Fe("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OF=Fe("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DF=Fe("MoreHorizontal",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LF=Fe("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IS=Fe("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ku=Fe("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u0=Fe("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const px=Fe("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cr=Fe("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const um=Fe("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kd=Fe("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MF=Fe("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dm=Fe("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BF=Fe("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sc=Fe("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d0=Fe("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hy=Fe("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UF=Fe("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zF=Fe("Table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fm=Fe("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bo=Fe("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const si=Fe("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hm=Fe("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xx=Fe("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OS=Fe("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yf=Fe("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const so=Fe("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ps=Fe("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $F=Fe("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);var mm=function(e,t){return mm=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,s){r.__proto__=s}||function(r,s){for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(r[n]=s[n])},mm(e,t)};function DS(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");mm(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var Nd=function(){return Nd=Object.assign||function(t){for(var r,s=1,n=arguments.length;s<n;s++){r=arguments[s];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a])}return t},Nd.apply(this,arguments)};function Ro(e,t){var r={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(r[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(e);n<s.length;n++)t.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(e,s[n])&&(r[s[n]]=e[s[n]]);return r}function LS(e,t,r,s){var n=arguments.length,a=n<3?t:s===null?s=Object.getOwnPropertyDescriptor(t,r):s,i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(e,t,r,s);else for(var l=e.length-1;l>=0;l--)(i=e[l])&&(a=(n<3?i(a):n>3?i(t,r,a):i(t,r))||a);return n>3&&a&&Object.defineProperty(t,r,a),a}function MS(e,t){return function(r,s){t(r,s,e)}}function BS(e,t,r,s,n,a){function i(w){if(w!==void 0&&typeof w!="function")throw new TypeError("Function expected");return w}for(var l=s.kind,c=l==="getter"?"get":l==="setter"?"set":"value",u=!t&&e?s.static?e:e.prototype:null,d=t||(u?Object.getOwnPropertyDescriptor(u,s.name):{}),f,h=!1,m=r.length-1;m>=0;m--){var x={};for(var p in s)x[p]=p==="access"?{}:s[p];for(var p in s.access)x.access[p]=s.access[p];x.addInitializer=function(w){if(h)throw new TypeError("Cannot add initializers after decoration has completed");a.push(i(w||null))};var g=(0,r[m])(l==="accessor"?{get:d.get,set:d.set}:d[c],x);if(l==="accessor"){if(g===void 0)continue;if(g===null||typeof g!="object")throw new TypeError("Object expected");(f=i(g.get))&&(d.get=f),(f=i(g.set))&&(d.set=f),(f=i(g.init))&&n.unshift(f)}else(f=i(g))&&(l==="field"?n.unshift(f):d[c]=f)}u&&Object.defineProperty(u,s.name,d),h=!0}function US(e,t,r){for(var s=arguments.length>2,n=0;n<t.length;n++)r=s?t[n].call(e,r):t[n].call(e);return s?r:void 0}function zS(e){return typeof e=="symbol"?e:"".concat(e)}function $S(e,t,r){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function VS(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function De(e,t,r,s){function n(a){return a instanceof r?a:new r(function(i){i(a)})}return new(r||(r=Promise))(function(a,i){function l(d){try{u(s.next(d))}catch(f){i(f)}}function c(d){try{u(s.throw(d))}catch(f){i(f)}}function u(d){d.done?a(d.value):n(d.value).then(l,c)}u((s=s.apply(e,t||[])).next())})}function WS(e,t){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},s,n,a,i=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function l(u){return function(d){return c([u,d])}}function c(u){if(s)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(r=0)),r;)try{if(s=1,n&&(a=u[0]&2?n.return:u[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,u[1])).done)return a;switch(n=0,a&&(u=[u[0]&2,a.value]),u[0]){case 0:case 1:a=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,n=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!a||u[1]>a[0]&&u[1]<a[3])){r.label=u[1];break}if(u[0]===6&&r.label<a[1]){r.label=a[1],a=u;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(u);break}a[2]&&r.ops.pop(),r.trys.pop();continue}u=t.call(e,r)}catch(d){u=[6,d],n=0}finally{s=a=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}var f0=Object.create?function(e,t,r,s){s===void 0&&(s=r);var n=Object.getOwnPropertyDescriptor(t,r);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,s,n)}:function(e,t,r,s){s===void 0&&(s=r),e[s]=t[r]};function qS(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&f0(t,e,r)}function Ed(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],s=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&s>=e.length&&(e=void 0),{value:e&&e[s++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function gx(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var s=r.call(e),n,a=[],i;try{for(;(t===void 0||t-- >0)&&!(n=s.next()).done;)a.push(n.value)}catch(l){i={error:l}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return a}function HS(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(gx(arguments[t]));return e}function GS(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var s=Array(e),n=0,t=0;t<r;t++)for(var a=arguments[t],i=0,l=a.length;i<l;i++,n++)s[n]=a[i];return s}function KS(e,t,r){if(r||arguments.length===2)for(var s=0,n=t.length,a;s<n;s++)(a||!(s in t))&&(a||(a=Array.prototype.slice.call(t,0,s)),a[s]=t[s]);return e.concat(a||Array.prototype.slice.call(t))}function _o(e){return this instanceof _o?(this.v=e,this):new _o(e)}function XS(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=r.apply(e,t||[]),n,a=[];return n=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),l("next"),l("throw"),l("return",i),n[Symbol.asyncIterator]=function(){return this},n;function i(m){return function(x){return Promise.resolve(x).then(m,f)}}function l(m,x){s[m]&&(n[m]=function(p){return new Promise(function(g,w){a.push([m,p,g,w])>1||c(m,p)})},x&&(n[m]=x(n[m])))}function c(m,x){try{u(s[m](x))}catch(p){h(a[0][3],p)}}function u(m){m.value instanceof _o?Promise.resolve(m.value.v).then(d,f):h(a[0][2],m)}function d(m){c("next",m)}function f(m){c("throw",m)}function h(m,x){m(x),a.shift(),a.length&&c(a[0][0],a[0][1])}}function QS(e){var t,r;return t={},s("next"),s("throw",function(n){throw n}),s("return"),t[Symbol.iterator]=function(){return this},t;function s(n,a){t[n]=e[n]?function(i){return(r=!r)?{value:_o(e[n](i)),done:!1}:a?a(i):i}:a}}function YS(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof Ed=="function"?Ed(e):e[Symbol.iterator](),r={},s("next"),s("throw"),s("return"),r[Symbol.asyncIterator]=function(){return this},r);function s(a){r[a]=e[a]&&function(i){return new Promise(function(l,c){i=e[a](i),n(l,c,i.done,i.value)})}}function n(a,i,l,c){Promise.resolve(c).then(function(u){a({value:u,done:l})},i)}}function JS(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var VF=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t},pm=function(e){return pm=Object.getOwnPropertyNames||function(t){var r=[];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(r[r.length]=s);return r},pm(e)};function ZS(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r=pm(e),s=0;s<r.length;s++)r[s]!=="default"&&f0(t,e,r[s]);return VF(t,e),t}function ek(e){return e&&e.__esModule?e:{default:e}}function tk(e,t,r,s){if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?s:r==="a"?s.call(e):s?s.value:t.get(e)}function rk(e,t,r,s,n){if(s==="m")throw new TypeError("Private method is not writable");if(s==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return s==="a"?n.call(e,r):n?n.value=r:t.set(e,r),r}function sk(e,t){if(t===null||typeof t!="object"&&typeof t!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof e=="function"?t===e:e.has(t)}function nk(e,t,r){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var s,n;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");s=t[Symbol.asyncDispose]}if(s===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");s=t[Symbol.dispose],r&&(n=s)}if(typeof s!="function")throw new TypeError("Object not disposable.");n&&(s=function(){try{n.call(this)}catch(a){return Promise.reject(a)}}),e.stack.push({value:t,dispose:s,async:r})}else r&&e.stack.push({async:!0});return t}var WF=typeof SuppressedError=="function"?SuppressedError:function(e,t,r){var s=new Error(r);return s.name="SuppressedError",s.error=e,s.suppressed=t,s};function ak(e){function t(a){e.error=e.hasError?new WF(a,e.error,"An error was suppressed during disposal."):a,e.hasError=!0}var r,s=0;function n(){for(;r=e.stack.pop();)try{if(!r.async&&s===1)return s=0,e.stack.push(r),Promise.resolve().then(n);if(r.dispose){var a=r.dispose.call(r.value);if(r.async)return s|=2,Promise.resolve(a).then(n,function(i){return t(i),n()})}else s|=1}catch(i){t(i)}if(s===1)return e.hasError?Promise.reject(e.error):Promise.resolve();if(e.hasError)throw e.error}return n()}function ik(e,t){return typeof e=="string"&&/^\.\.?\//.test(e)?e.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(r,s,n,a,i){return s?t?".jsx":".js":n&&(!a||!i)?r:n+a+"."+i.toLowerCase()+"js"}):e}const qF={__extends:DS,__assign:Nd,__rest:Ro,__decorate:LS,__param:MS,__esDecorate:BS,__runInitializers:US,__propKey:zS,__setFunctionName:$S,__metadata:VS,__awaiter:De,__generator:WS,__createBinding:f0,__exportStar:qS,__values:Ed,__read:gx,__spread:HS,__spreadArrays:GS,__spreadArray:KS,__await:_o,__asyncGenerator:XS,__asyncDelegator:QS,__asyncValues:YS,__makeTemplateObject:JS,__importStar:ZS,__importDefault:ek,__classPrivateFieldGet:tk,__classPrivateFieldSet:rk,__classPrivateFieldIn:sk,__addDisposableResource:nk,__disposeResources:ak,__rewriteRelativeImportExtension:ik},HF=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:nk,get __assign(){return Nd},__asyncDelegator:QS,__asyncGenerator:XS,__asyncValues:YS,__await:_o,__awaiter:De,__classPrivateFieldGet:tk,__classPrivateFieldIn:sk,__classPrivateFieldSet:rk,__createBinding:f0,__decorate:LS,__disposeResources:ak,__esDecorate:BS,__exportStar:qS,__extends:DS,__generator:WS,__importDefault:ek,__importStar:ZS,__makeTemplateObject:JS,__metadata:VS,__param:MS,__propKey:zS,__read:gx,__rest:Ro,__rewriteRelativeImportExtension:ik,__runInitializers:US,__setFunctionName:$S,__spread:HS,__spreadArray:KS,__spreadArrays:GS,__values:Ed,default:qF},Symbol.toStringTag,{value:"Module"})),GF=e=>e?(...t)=>e(...t):(...t)=>fetch(...t);class vx extends Error{constructor(t,r="FunctionsError",s){super(t),this.name=r,this.context=s}}class KF extends vx{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class Gy extends vx{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class Ky extends vx{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var xm;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(xm||(xm={}));class XF{constructor(t,{headers:r={},customFetch:s,region:n=xm.Any}={}){this.url=t,this.headers=r,this.region=n,this.fetch=GF(s)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return De(this,arguments,void 0,function*(r,s={}){var n;let a,i;try{const{headers:l,method:c,body:u,signal:d,timeout:f}=s;let h={},{region:m}=s;m||(m=this.region);const x=new URL(`${this.url}/${r}`);m&&m!=="any"&&(h["x-region"]=m,x.searchParams.set("forceFunctionRegion",m));let p;u&&(l&&!Object.prototype.hasOwnProperty.call(l,"Content-Type")||!l)?typeof Blob<"u"&&u instanceof Blob||u instanceof ArrayBuffer?(h["Content-Type"]="application/octet-stream",p=u):typeof u=="string"?(h["Content-Type"]="text/plain",p=u):typeof FormData<"u"&&u instanceof FormData?p=u:(h["Content-Type"]="application/json",p=JSON.stringify(u)):p=u;let g=d;f&&(i=new AbortController,a=setTimeout(()=>i.abort(),f),d?(g=i.signal,d.addEventListener("abort",()=>i.abort())):g=i.signal);const w=yield this.fetch(x.toString(),{method:c||"POST",headers:Object.assign(Object.assign(Object.assign({},h),this.headers),l),body:p,signal:g}).catch(S=>{throw new KF(S)}),v=w.headers.get("x-relay-error");if(v&&v==="true")throw new Gy(w);if(!w.ok)throw new Ky(w);let y=((n=w.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),b;return y==="application/json"?b=yield w.json():y==="application/octet-stream"||y==="application/pdf"?b=yield w.blob():y==="text/event-stream"?b=w:y==="multipart/form-data"?b=yield w.formData():b=yield w.text(),{data:b,error:null,response:w}}catch(l){return{data:null,error:l,response:l instanceof Ky||l instanceof Gy?l.context:void 0}}finally{a&&clearTimeout(a)}})}}var Mr={};const Io=lj(HF);var du={},fu={},hu={},mu={},pu={},xu={},Xy;function ok(){if(Xy)return xu;Xy=1,Object.defineProperty(xu,"__esModule",{value:!0});class e extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}}return xu.default=e,xu}var Qy;function lk(){if(Qy)return pu;Qy=1,Object.defineProperty(pu,"__esModule",{value:!0});const t=Io.__importDefault(ok());class r{constructor(n){var a,i;this.shouldThrowOnError=!1,this.method=n.method,this.url=n.url,this.headers=new Headers(n.headers),this.schema=n.schema,this.body=n.body,this.shouldThrowOnError=(a=n.shouldThrowOnError)!==null&&a!==void 0?a:!1,this.signal=n.signal,this.isMaybeSingle=(i=n.isMaybeSingle)!==null&&i!==void 0?i:!1,n.fetch?this.fetch=n.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(n,a){return this.headers=new Headers(this.headers),this.headers.set(n,a),this}then(n,a){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const i=this.fetch;let l=i(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async c=>{var u,d,f,h;let m=null,x=null,p=null,g=c.status,w=c.statusText;if(c.ok){if(this.method!=="HEAD"){const S=await c.text();S===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((u=this.headers.get("Accept"))===null||u===void 0)&&u.includes("application/vnd.pgrst.plan+text"))?x=S:x=JSON.parse(S))}const y=(d=this.headers.get("Prefer"))===null||d===void 0?void 0:d.match(/count=(exact|planned|estimated)/),b=(f=c.headers.get("content-range"))===null||f===void 0?void 0:f.split("/");y&&b&&b.length>1&&(p=parseInt(b[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(x)&&(x.length>1?(m={code:"PGRST116",details:`Results contain ${x.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},x=null,p=null,g=406,w="Not Acceptable"):x.length===1?x=x[0]:x=null)}else{const y=await c.text();try{m=JSON.parse(y),Array.isArray(m)&&c.status===404&&(x=[],m=null,g=200,w="OK")}catch{c.status===404&&y===""?(g=204,w="No Content"):m={message:y}}if(m&&this.isMaybeSingle&&(!((h=m==null?void 0:m.details)===null||h===void 0)&&h.includes("0 rows"))&&(m=null,g=200,w="OK"),m&&this.shouldThrowOnError)throw new t.default(m)}return{error:m,data:x,count:p,status:g,statusText:w}});return this.shouldThrowOnError||(l=l.catch(c=>{var u,d,f,h,m,x;let p="";const g=c==null?void 0:c.cause;if(g){const w=(u=g==null?void 0:g.message)!==null&&u!==void 0?u:"",v=(d=g==null?void 0:g.code)!==null&&d!==void 0?d:"";p=`${(f=c==null?void 0:c.name)!==null&&f!==void 0?f:"FetchError"}: ${c==null?void 0:c.message}`,p+=`

Caused by: ${(h=g==null?void 0:g.name)!==null&&h!==void 0?h:"Error"}: ${w}`,v&&(p+=` (${v})`),g!=null&&g.stack&&(p+=`
${g.stack}`)}else p=(m=c==null?void 0:c.stack)!==null&&m!==void 0?m:"";return{error:{message:`${(x=c==null?void 0:c.name)!==null&&x!==void 0?x:"FetchError"}: ${c==null?void 0:c.message}`,details:p,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),l.then(n,a)}returns(){return this}overrideTypes(){return this}}return pu.default=r,pu}var Yy;function ck(){if(Yy)return mu;Yy=1,Object.defineProperty(mu,"__esModule",{value:!0});const t=Io.__importDefault(lk());class r extends t.default{select(n){let a=!1;const i=(n??"*").split("").map(l=>/\s/.test(l)&&!a?"":(l==='"'&&(a=!a),l)).join("");return this.url.searchParams.set("select",i),this.headers.append("Prefer","return=representation"),this}order(n,{ascending:a=!0,nullsFirst:i,foreignTable:l,referencedTable:c=l}={}){const u=c?`${c}.order`:"order",d=this.url.searchParams.get(u);return this.url.searchParams.set(u,`${d?`${d},`:""}${n}.${a?"asc":"desc"}${i===void 0?"":i?".nullsfirst":".nullslast"}`),this}limit(n,{foreignTable:a,referencedTable:i=a}={}){const l=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(l,`${n}`),this}range(n,a,{foreignTable:i,referencedTable:l=i}={}){const c=typeof l>"u"?"offset":`${l}.offset`,u=typeof l>"u"?"limit":`${l}.limit`;return this.url.searchParams.set(c,`${n}`),this.url.searchParams.set(u,`${a-n+1}`),this}abortSignal(n){return this.signal=n,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:n=!1,verbose:a=!1,settings:i=!1,buffers:l=!1,wal:c=!1,format:u="text"}={}){var d;const f=[n?"analyze":null,a?"verbose":null,i?"settings":null,l?"buffers":null,c?"wal":null].filter(Boolean).join("|"),h=(d=this.headers.get("Accept"))!==null&&d!==void 0?d:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${u}; for="${h}"; options=${f};`),u==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(n){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${n}`),this}}return mu.default=r,mu}var Jy;function yx(){if(Jy)return hu;Jy=1,Object.defineProperty(hu,"__esModule",{value:!0});const t=Io.__importDefault(ck()),r=new RegExp("[,()]");class s extends t.default{eq(a,i){return this.url.searchParams.append(a,`eq.${i}`),this}neq(a,i){return this.url.searchParams.append(a,`neq.${i}`),this}gt(a,i){return this.url.searchParams.append(a,`gt.${i}`),this}gte(a,i){return this.url.searchParams.append(a,`gte.${i}`),this}lt(a,i){return this.url.searchParams.append(a,`lt.${i}`),this}lte(a,i){return this.url.searchParams.append(a,`lte.${i}`),this}like(a,i){return this.url.searchParams.append(a,`like.${i}`),this}likeAllOf(a,i){return this.url.searchParams.append(a,`like(all).{${i.join(",")}}`),this}likeAnyOf(a,i){return this.url.searchParams.append(a,`like(any).{${i.join(",")}}`),this}ilike(a,i){return this.url.searchParams.append(a,`ilike.${i}`),this}ilikeAllOf(a,i){return this.url.searchParams.append(a,`ilike(all).{${i.join(",")}}`),this}ilikeAnyOf(a,i){return this.url.searchParams.append(a,`ilike(any).{${i.join(",")}}`),this}regexMatch(a,i){return this.url.searchParams.append(a,`match.${i}`),this}regexIMatch(a,i){return this.url.searchParams.append(a,`imatch.${i}`),this}is(a,i){return this.url.searchParams.append(a,`is.${i}`),this}isDistinct(a,i){return this.url.searchParams.append(a,`isdistinct.${i}`),this}in(a,i){const l=Array.from(new Set(i)).map(c=>typeof c=="string"&&r.test(c)?`"${c}"`:`${c}`).join(",");return this.url.searchParams.append(a,`in.(${l})`),this}contains(a,i){return typeof i=="string"?this.url.searchParams.append(a,`cs.${i}`):Array.isArray(i)?this.url.searchParams.append(a,`cs.{${i.join(",")}}`):this.url.searchParams.append(a,`cs.${JSON.stringify(i)}`),this}containedBy(a,i){return typeof i=="string"?this.url.searchParams.append(a,`cd.${i}`):Array.isArray(i)?this.url.searchParams.append(a,`cd.{${i.join(",")}}`):this.url.searchParams.append(a,`cd.${JSON.stringify(i)}`),this}rangeGt(a,i){return this.url.searchParams.append(a,`sr.${i}`),this}rangeGte(a,i){return this.url.searchParams.append(a,`nxl.${i}`),this}rangeLt(a,i){return this.url.searchParams.append(a,`sl.${i}`),this}rangeLte(a,i){return this.url.searchParams.append(a,`nxr.${i}`),this}rangeAdjacent(a,i){return this.url.searchParams.append(a,`adj.${i}`),this}overlaps(a,i){return typeof i=="string"?this.url.searchParams.append(a,`ov.${i}`):this.url.searchParams.append(a,`ov.{${i.join(",")}}`),this}textSearch(a,i,{config:l,type:c}={}){let u="";c==="plain"?u="pl":c==="phrase"?u="ph":c==="websearch"&&(u="w");const d=l===void 0?"":`(${l})`;return this.url.searchParams.append(a,`${u}fts${d}.${i}`),this}match(a){return Object.entries(a).forEach(([i,l])=>{this.url.searchParams.append(i,`eq.${l}`)}),this}not(a,i,l){return this.url.searchParams.append(a,`not.${i}.${l}`),this}or(a,{foreignTable:i,referencedTable:l=i}={}){const c=l?`${l}.or`:"or";return this.url.searchParams.append(c,`(${a})`),this}filter(a,i,l){return this.url.searchParams.append(a,`${i}.${l}`),this}}return hu.default=s,hu}var Zy;function uk(){if(Zy)return fu;Zy=1,Object.defineProperty(fu,"__esModule",{value:!0});const t=Io.__importDefault(yx());class r{constructor(n,{headers:a={},schema:i,fetch:l}){this.url=n,this.headers=new Headers(a),this.schema=i,this.fetch=l}select(n,a){const{head:i=!1,count:l}=a??{},c=i?"HEAD":"GET";let u=!1;const d=(n??"*").split("").map(f=>/\s/.test(f)&&!u?"":(f==='"'&&(u=!u),f)).join("");return this.url.searchParams.set("select",d),l&&this.headers.append("Prefer",`count=${l}`),new t.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(n,{count:a,defaultToNull:i=!0}={}){var l;const c="POST";if(a&&this.headers.append("Prefer",`count=${a}`),i||this.headers.append("Prefer","missing=default"),Array.isArray(n)){const u=n.reduce((d,f)=>d.concat(Object.keys(f)),[]);if(u.length>0){const d=[...new Set(u)].map(f=>`"${f}"`);this.url.searchParams.set("columns",d.join(","))}}return new t.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}upsert(n,{onConflict:a,ignoreDuplicates:i=!1,count:l,defaultToNull:c=!0}={}){var u;const d="POST";if(this.headers.append("Prefer",`resolution=${i?"ignore":"merge"}-duplicates`),a!==void 0&&this.url.searchParams.set("on_conflict",a),l&&this.headers.append("Prefer",`count=${l}`),c||this.headers.append("Prefer","missing=default"),Array.isArray(n)){const f=n.reduce((h,m)=>h.concat(Object.keys(m)),[]);if(f.length>0){const h=[...new Set(f)].map(m=>`"${m}"`);this.url.searchParams.set("columns",h.join(","))}}return new t.default({method:d,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:(u=this.fetch)!==null&&u!==void 0?u:fetch})}update(n,{count:a}={}){var i;const l="PATCH";return a&&this.headers.append("Prefer",`count=${a}`),new t.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}delete({count:n}={}){var a;const i="DELETE";return n&&this.headers.append("Prefer",`count=${n}`),new t.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}}return fu.default=r,fu}var e1;function QF(){if(e1)return du;e1=1,Object.defineProperty(du,"__esModule",{value:!0});const e=Io,t=e.__importDefault(uk()),r=e.__importDefault(yx());class s{constructor(a,{headers:i={},schema:l,fetch:c}={}){this.url=a,this.headers=new Headers(i),this.schemaName=l,this.fetch=c}from(a){if(!a||typeof a!="string"||a.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");const i=new URL(`${this.url}/${a}`);return new t.default(i,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(a){return new s(this.url,{headers:this.headers,schema:a,fetch:this.fetch})}rpc(a,i={},{head:l=!1,get:c=!1,count:u}={}){var d;let f;const h=new URL(`${this.url}/rpc/${a}`);let m;l||c?(f=l?"HEAD":"GET",Object.entries(i).filter(([p,g])=>g!==void 0).map(([p,g])=>[p,Array.isArray(g)?`{${g.join(",")}}`:`${g}`]).forEach(([p,g])=>{h.searchParams.append(p,g)})):(f="POST",m=i);const x=new Headers(this.headers);return u&&x.set("Prefer",`count=${u}`),new r.default({method:f,url:h,headers:x,schema:this.schemaName,body:m,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}}return du.default=s,du}Object.defineProperty(Mr,"__esModule",{value:!0});var dk=Mr.PostgrestError=bk=Mr.PostgrestBuilder=yk=Mr.PostgrestTransformBuilder=gk=Mr.PostgrestFilterBuilder=pk=Mr.PostgrestQueryBuilder=hk=Mr.PostgrestClient=void 0;const Oo=Io,fk=Oo.__importDefault(QF());var hk=Mr.PostgrestClient=fk.default;const mk=Oo.__importDefault(uk());var pk=Mr.PostgrestQueryBuilder=mk.default;const xk=Oo.__importDefault(yx());var gk=Mr.PostgrestFilterBuilder=xk.default;const vk=Oo.__importDefault(ck());var yk=Mr.PostgrestTransformBuilder=vk.default;const wk=Oo.__importDefault(lk());var bk=Mr.PostgrestBuilder=wk.default;const _k=Oo.__importDefault(ok());dk=Mr.PostgrestError=_k.default;var Sk=Mr.default={PostgrestClient:fk.default,PostgrestQueryBuilder:mk.default,PostgrestFilterBuilder:xk.default,PostgrestTransformBuilder:vk.default,PostgrestBuilder:wk.default,PostgrestError:_k.default};const YF=ij({__proto__:null,get PostgrestBuilder(){return bk},get PostgrestClient(){return hk},get PostgrestError(){return dk},get PostgrestFilterBuilder(){return gk},get PostgrestQueryBuilder(){return pk},get PostgrestTransformBuilder(){return yk},default:Sk},[Mr]),{PostgrestClient:JF,PostgrestQueryBuilder:dW,PostgrestFilterBuilder:fW,PostgrestTransformBuilder:hW,PostgrestBuilder:mW,PostgrestError:pW}=Sk||YF;class ZF{constructor(){}static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const s=r.node,n=parseInt(s.replace(/^v/,"").split(".")[0]);return n>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${n} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${n} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const s=this.getWebSocketConstructor();return new s(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const eP="2.84.0",tP=`realtime-js/${eP}`,kk="1.0.0",rP="2.0.0",t1=kk,gm=1e4,sP=1e3,nP=100;var Pa;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(Pa||(Pa={}));var Zt;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Zt||(Zt={}));var Ws;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Ws||(Ws={}));var vm;(function(e){e.websocket="websocket"})(vm||(vm={}));var Ra;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Ra||(Ra={}));class aP{constructor(){this.HEADER_LENGTH=1,this.META_LENGTH=4,this.USER_BROADCAST_PUSH_META_LENGTH=5,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast"}encode(t,r){if(t.event===this.BROADCAST_EVENT&&!(t.payload instanceof ArrayBuffer)&&typeof t.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(t));let s=[t.join_ref,t.ref,t.topic,t.event,t.payload];return r(JSON.stringify(s))}_binaryEncodeUserBroadcastPush(t){var r;return this._isArrayBuffer((r=t.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(t):this._encodeJsonUserBroadcastPush(t)}_encodeBinaryUserBroadcastPush(t){var r,s,n,a;const i=t.topic,l=(r=t.ref)!==null&&r!==void 0?r:"",c=(s=t.join_ref)!==null&&s!==void 0?s:"",u=t.payload.event,d=(a=(n=t.payload)===null||n===void 0?void 0:n.payload)!==null&&a!==void 0?a:new ArrayBuffer(0),f=this.USER_BROADCAST_PUSH_META_LENGTH+c.length+l.length+i.length+u.length,h=new ArrayBuffer(this.HEADER_LENGTH+f);let m=new DataView(h),x=0;m.setUint8(x++,this.KINDS.userBroadcastPush),m.setUint8(x++,c.length),m.setUint8(x++,l.length),m.setUint8(x++,i.length),m.setUint8(x++,u.length),m.setUint8(x++,this.BINARY_ENCODING),Array.from(c,g=>m.setUint8(x++,g.charCodeAt(0))),Array.from(l,g=>m.setUint8(x++,g.charCodeAt(0))),Array.from(i,g=>m.setUint8(x++,g.charCodeAt(0))),Array.from(u,g=>m.setUint8(x++,g.charCodeAt(0)));var p=new Uint8Array(h.byteLength+d.byteLength);return p.set(new Uint8Array(h),0),p.set(new Uint8Array(d),h.byteLength),p.buffer}_encodeJsonUserBroadcastPush(t){var r,s,n,a;const i=t.topic,l=(r=t.ref)!==null&&r!==void 0?r:"",c=(s=t.join_ref)!==null&&s!==void 0?s:"",u=t.payload.event,d=(a=(n=t.payload)===null||n===void 0?void 0:n.payload)!==null&&a!==void 0?a:{},h=new TextEncoder().encode(JSON.stringify(d)).buffer,m=this.USER_BROADCAST_PUSH_META_LENGTH+c.length+l.length+i.length+u.length,x=new ArrayBuffer(this.HEADER_LENGTH+m);let p=new DataView(x),g=0;p.setUint8(g++,this.KINDS.userBroadcastPush),p.setUint8(g++,c.length),p.setUint8(g++,l.length),p.setUint8(g++,i.length),p.setUint8(g++,u.length),p.setUint8(g++,this.JSON_ENCODING),Array.from(c,v=>p.setUint8(g++,v.charCodeAt(0))),Array.from(l,v=>p.setUint8(g++,v.charCodeAt(0))),Array.from(i,v=>p.setUint8(g++,v.charCodeAt(0))),Array.from(u,v=>p.setUint8(g++,v.charCodeAt(0)));var w=new Uint8Array(x.byteLength+h.byteLength);return w.set(new Uint8Array(x),0),w.set(new Uint8Array(h),x.byteLength),w.buffer}decode(t,r){if(this._isArrayBuffer(t)){let s=this._binaryDecode(t);return r(s)}if(typeof t=="string"){const s=JSON.parse(t),[n,a,i,l,c]=s;return r({join_ref:n,ref:a,topic:i,event:l,payload:c})}return r({})}_binaryDecode(t){const r=new DataView(t),s=r.getUint8(0),n=new TextDecoder;switch(s){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(t,r,n)}}_decodeUserBroadcast(t,r,s){const n=r.getUint8(1),a=r.getUint8(2),i=r.getUint8(3),l=r.getUint8(4);let c=this.HEADER_LENGTH+4;const u=s.decode(t.slice(c,c+n));c=c+n;const d=s.decode(t.slice(c,c+a));c=c+a;const f=s.decode(t.slice(c,c+i));c=c+i;const h=t.slice(c,t.byteLength),m=l===this.JSON_ENCODING?JSON.parse(s.decode(h)):h,x={type:this.BROADCAST_EVENT,event:d,payload:m};return i>0&&(x.meta=JSON.parse(f)),{join_ref:null,ref:null,topic:u,event:this.BROADCAST_EVENT,payload:x}}_isArrayBuffer(t){var r;return t instanceof ArrayBuffer||((r=t==null?void 0:t.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}}class Nk{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var gt;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(gt||(gt={}));const r1=(e,t,r={})=>{var s;const n=(s=r.skipTypes)!==null&&s!==void 0?s:[];return t?Object.keys(t).reduce((a,i)=>(a[i]=iP(i,e,t,n),a),{}):{}},iP=(e,t,r,s)=>{const n=t.find(l=>l.name===e),a=n==null?void 0:n.type,i=r[e];return a&&!s.includes(a)?Ek(a,i):ym(i)},Ek=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return uP(t,r)}switch(e){case gt.bool:return oP(t);case gt.float4:case gt.float8:case gt.int2:case gt.int4:case gt.int8:case gt.numeric:case gt.oid:return lP(t);case gt.json:case gt.jsonb:return cP(t);case gt.timestamp:return dP(t);case gt.abstime:case gt.date:case gt.daterange:case gt.int4range:case gt.int8range:case gt.money:case gt.reltime:case gt.text:case gt.time:case gt.timestamptz:case gt.timetz:case gt.tsrange:case gt.tstzrange:return ym(t);default:return ym(t)}},ym=e=>e,oP=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},lP=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},cP=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},uP=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,s=e[r];if(e[0]==="{"&&s==="}"){let a;const i=e.slice(1,r);try{a=JSON.parse("["+i+"]")}catch{a=i?i.split(","):[]}return a.map(l=>Ek(t,l))}return e},dP=e=>typeof e=="string"?e.replace(" ","T"):e,jk=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class wf{constructor(t,r,s={},n=gm){this.channel=t,this.event=r,this.payload=s,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var s;return this._hasReceived(t)&&r((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(s=>s.status===t).forEach(s=>s.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var s1;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(s1||(s1={}));class Sl{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},n=>{const{onJoin:a,onLeave:i,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Sl.syncState(this.state,n,a,i),this.pendingDiffs.forEach(c=>{this.state=Sl.syncDiff(this.state,c,a,i)}),this.pendingDiffs=[],l()}),this.channel._on(s.diff,{},n=>{const{onJoin:a,onLeave:i,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=Sl.syncDiff(this.state,n,a,i),l())}),this.onJoin((n,a,i)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:a,newPresences:i})}),this.onLeave((n,a,i)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:a,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,s,n){const a=this.cloneDeep(t),i=this.transformState(r),l={},c={};return this.map(a,(u,d)=>{i[u]||(c[u]=d)}),this.map(i,(u,d)=>{const f=a[u];if(f){const h=d.map(g=>g.presence_ref),m=f.map(g=>g.presence_ref),x=d.filter(g=>m.indexOf(g.presence_ref)<0),p=f.filter(g=>h.indexOf(g.presence_ref)<0);x.length>0&&(l[u]=x),p.length>0&&(c[u]=p)}else l[u]=d}),this.syncDiff(a,{joins:l,leaves:c},s,n)}static syncDiff(t,r,s,n){const{joins:a,leaves:i}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return s||(s=()=>{}),n||(n=()=>{}),this.map(a,(l,c)=>{var u;const d=(u=t[l])!==null&&u!==void 0?u:[];if(t[l]=this.cloneDeep(c),d.length>0){const f=t[l].map(m=>m.presence_ref),h=d.filter(m=>f.indexOf(m.presence_ref)<0);t[l].unshift(...h)}s(l,d,c)}),this.map(i,(l,c)=>{let u=t[l];if(!u)return;const d=c.map(f=>f.presence_ref);u=u.filter(f=>d.indexOf(f.presence_ref)<0),t[l]=u,n(l,u,c),u.length===0&&delete t[l]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(s=>r(s,t[s]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,s)=>{const n=t[s];return"metas"in n?r[s]=n.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):r[s]=n,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var n1;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(n1||(n1={}));var kl;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(kl||(kl={}));var vn;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(vn||(vn={}));class wx{constructor(t,r={config:{}},s){var n,a;if(this.topic=t,this.params=r,this.socket=s,this.bindings={},this.state=Zt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new wf(this,Ws.join,this.params,this.timeout),this.rejoinTimer=new Nk(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Zt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Zt.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=Zt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Zt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=Zt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Ws.reply,{},(i,l)=>{this._trigger(this._replyEventName(l),i)}),this.presence=new Sl(this),this.broadcastEndpointURL=jk(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((a=(n=this.params.config)===null||n===void 0?void 0:n.broadcast)===null||a===void 0)&&a.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var s,n,a;if(this.socket.isConnected()||this.socket.connect(),this.state==Zt.closed){const{config:{broadcast:i,presence:l,private:c}}=this.params,u=(n=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(m=>m.filter))!==null&&n!==void 0?n:[],d=!!this.bindings[kl.PRESENCE]&&this.bindings[kl.PRESENCE].length>0||((a=this.params.config.presence)===null||a===void 0?void 0:a.enabled)===!0,f={},h={broadcast:i,presence:Object.assign(Object.assign({},l),{enabled:d}),postgres_changes:u,private:c};this.socket.accessTokenValue&&(f.access_token=this.socket.accessTokenValue),this._onError(m=>t==null?void 0:t(vn.CHANNEL_ERROR,m)),this._onClose(()=>t==null?void 0:t(vn.CLOSED)),this.updateJoinPayload(Object.assign({config:h},f)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:m})=>{var x;if(this.socket.setAuth(),m===void 0){t==null||t(vn.SUBSCRIBED);return}else{const p=this.bindings.postgres_changes,g=(x=p==null?void 0:p.length)!==null&&x!==void 0?x:0,w=[];for(let v=0;v<g;v++){const y=p[v],{filter:{event:b,schema:S,table:k,filter:_}}=y,N=m&&m[v];if(N&&N.event===b&&N.schema===S&&N.table===k&&N.filter===_)w.push(Object.assign(Object.assign({},y),{id:N.id}));else{this.unsubscribe(),this.state=Zt.errored,t==null||t(vn.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=w,t&&t(vn.SUBSCRIBED);return}}).receive("error",m=>{this.state=Zt.errored,t==null||t(vn.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(m).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(vn.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,s){return this.state===Zt.joined&&t===kl.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,r,s)}async httpSend(t,r,s={}){var n;const a=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(r==null)return Promise.reject("Payload is required for httpSend()");const i={method:"POST",headers:{Authorization:a,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:r,private:this.private}]})},l=await this._fetchWithTimeout(this.broadcastEndpointURL,i,(n=s.timeout)!==null&&n!==void 0?n:this.timeout);if(l.status===202)return{success:!0};let c=l.statusText;try{const u=await l.json();c=u.error||u.message||c}catch{}return Promise.reject(new Error(c))}async send(t,r={}){var s,n;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:a,payload:i}=t,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:i,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(s=r.timeout)!==null&&s!==void 0?s:this.timeout);return await((n=u.body)===null||n===void 0?void 0:n.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(a=>{var i,l,c;const u=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((c=(l=(i=this.params)===null||i===void 0?void 0:i.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&a("ok"),u.receive("ok",()=>a("ok")),u.receive("error",()=>a("error")),u.receive("timeout",()=>a("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Zt.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Ws.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(n=>{s=new wf(this,Ws.leave,{},t),s.receive("ok",()=>{r(),n("ok")}).receive("timeout",()=>{r(),n("timed out")}).receive("error",()=>{n("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s==null||s.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Zt.closed,this.bindings={}}async _fetchWithTimeout(t,r,s){const n=new AbortController,a=setTimeout(()=>n.abort(),s),i=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:n.signal}));return clearTimeout(a),i}_push(t,r,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new wf(this,t,r,s);return this._canPush()?n.send():this._addToPushBuffer(n),n}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>nP){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,s){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,s){var n,a;const i=t.toLocaleLowerCase(),{close:l,error:c,leave:u,join:d}=Ws;if(s&&[l,c,u,d].indexOf(i)>=0&&s!==this._joinRef())return;let h=this._onMessage(i,r,s);if(r&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(m=>{var x,p,g;return((x=m.filter)===null||x===void 0?void 0:x.event)==="*"||((g=(p=m.filter)===null||p===void 0?void 0:p.event)===null||g===void 0?void 0:g.toLocaleLowerCase())===i}).map(m=>m.callback(h,s)):(a=this.bindings[i])===null||a===void 0||a.filter(m=>{var x,p,g,w,v,y;if(["broadcast","presence","postgres_changes"].includes(i))if("id"in m){const b=m.id,S=(x=m.filter)===null||x===void 0?void 0:x.event;return b&&((p=r.ids)===null||p===void 0?void 0:p.includes(b))&&(S==="*"||(S==null?void 0:S.toLocaleLowerCase())===((g=r.data)===null||g===void 0?void 0:g.type.toLocaleLowerCase()))}else{const b=(v=(w=m==null?void 0:m.filter)===null||w===void 0?void 0:w.event)===null||v===void 0?void 0:v.toLocaleLowerCase();return b==="*"||b===((y=r==null?void 0:r.event)===null||y===void 0?void 0:y.toLocaleLowerCase())}else return m.type.toLocaleLowerCase()===i}).map(m=>{if(typeof h=="object"&&"ids"in h){const x=h.data,{schema:p,table:g,commit_timestamp:w,type:v,errors:y}=x;h=Object.assign(Object.assign({},{schema:p,table:g,commit_timestamp:w,eventType:v,new:{},old:{},errors:y}),this._getPayloadRecords(x))}m.callback(h,s)})}_isClosed(){return this.state===Zt.closed}_isJoined(){return this.state===Zt.joined}_isJoining(){return this.state===Zt.joining}_isLeaving(){return this.state===Zt.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,s){const n=t.toLocaleLowerCase(),a={type:n,filter:r,callback:s};return this.bindings[n]?this.bindings[n].push(a):this.bindings[n]=[a],this}_off(t,r){const s=t.toLocaleLowerCase();return this.bindings[s]&&(this.bindings[s]=this.bindings[s].filter(n=>{var a;return!(((a=n.type)===null||a===void 0?void 0:a.toLocaleLowerCase())===s&&wx.isEqual(n.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const s in t)if(t[s]!==r[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Ws.close,{},t)}_onError(t){this._on(Ws.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Zt.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=r1(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=r1(t.columns,t.old_record)),r}}const bf=()=>{},gu={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},fP=[1e3,2e3,5e3,1e4],hP=1e4,mP=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class pP{constructor(t,r){var s;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=gm,this.transport=null,this.heartbeatIntervalMs=gu.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=bf,this.ref=0,this.reconnectTimer=null,this.vsn=t1,this.logger=bf,this.conn=null,this.sendBuffer=[],this.serializer=new aP,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=n=>n?(...a)=>n(...a):(...a)=>fetch(...a),!(!((s=r==null?void 0:r.params)===null||s===void 0)&&s.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${vm.websocket}`,this.httpEndpoint=jk(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=ZF.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const s=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(s),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(t?this.conn.close(t,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,s){this.logger(t,r,s)}connectionState(){switch(this.conn&&this.conn.readyState){case Pa.connecting:return Ra.Connecting;case Pa.open:return Ra.Open;case Pa.closing:return Ra.Closing;default:return Ra.Closed}}isConnected(){return this.connectionState()===Ra.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const s=`realtime:${t}`,n=this.getChannels().find(a=>a.topic===s);if(n)return n;{const a=new wx(`realtime:${t}`,r,this);return this.channels.push(a),a}}push(t){const{topic:r,event:s,payload:n,ref:a}=t,i=()=>{this.encode(t,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${r} ${s} (${a})`,n),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(sP,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},gu.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(s=>s.topic===t&&(s._isJoined()||s._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(u){this.log("error","error in heartbeat callback",u)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:s,event:n,payload:a,ref:i}=r,l=i?`(${i})`:"",c=a.status||"";this.log("receive",`${c} ${s} ${n} ${l}`.trim(),a),this.channels.filter(u=>u._isMember(s)).forEach(u=>u._trigger(n,a,i)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){if(this.conn){if(this.conn.readyState===Pa.open||this.conn.readyState===Pa.connecting)try{this.conn.close()}catch(t){this.log("error","Error closing connection",t)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(Ws.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const s=t.match(/\?/)?"&":"?",n=new URLSearchParams(r);return`${t}${s}${n}`}_workerObjectUrl(t){let r;if(t)r=t;else{const s=new Blob([mP],{type:"application/javascript"});r=URL.createObjectURL(s)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r;t?r=t:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(s=>{const n={access_token:r,version:tP};r&&s.updateJoinPayload(n),s.joinedOnce&&s._isJoined()&&s._push(Ws.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(s=>{try{s(r)}catch(n){this.log("error",`error in ${t} callback`,n)}})}catch(s){this.log("error",`error triggering ${t} callbacks`,s)}}_setupReconnectionTimer(){this.reconnectTimer=new Nk(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},gu.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,s,n,a,i,l,c,u,d,f,h,m;switch(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(s=t==null?void 0:t.timeout)!==null&&s!==void 0?s:gm,this.heartbeatIntervalMs=(n=t==null?void 0:t.heartbeatIntervalMs)!==null&&n!==void 0?n:gu.HEARTBEAT_INTERVAL,this.worker=(a=t==null?void 0:t.worker)!==null&&a!==void 0?a:!1,this.accessToken=(i=t==null?void 0:t.accessToken)!==null&&i!==void 0?i:null,this.heartbeatCallback=(l=t==null?void 0:t.heartbeatCallback)!==null&&l!==void 0?l:bf,this.vsn=(c=t==null?void 0:t.vsn)!==null&&c!==void 0?c:t1,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(u=t==null?void 0:t.reconnectAfterMs)!==null&&u!==void 0?u:x=>fP[x-1]||hP,this.vsn){case kk:this.encode=(d=t==null?void 0:t.encode)!==null&&d!==void 0?d:(x,p)=>p(JSON.stringify(x)),this.decode=(f=t==null?void 0:t.decode)!==null&&f!==void 0?f:(x,p)=>p(JSON.parse(x));break;case rP:this.encode=(h=t==null?void 0:t.encode)!==null&&h!==void 0?h:this.serializer.encode.bind(this.serializer),this.decode=(m=t==null?void 0:t.decode)!==null&&m!==void 0?m:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}class bx extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function Ct(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class xP extends bx{constructor(t,r,s){super(t),this.name="StorageApiError",this.status=r,this.statusCode=s}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class wm extends bx{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}const _x=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),gP=()=>Response,bm=e=>{if(Array.isArray(e))return e.map(r=>bm(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,s])=>{const n=r.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""));t[n]=bm(s)}),t},vP=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},_f=e=>{var t;return e.msg||e.message||e.error_description||(typeof e.error=="string"?e.error:(t=e.error)===null||t===void 0?void 0:t.message)||JSON.stringify(e)},yP=(e,t,r)=>De(void 0,void 0,void 0,function*(){const s=yield gP();e instanceof s&&!(r!=null&&r.noResolveJson)?e.json().then(n=>{const a=e.status||500,i=(n==null?void 0:n.statusCode)||a+"";t(new xP(_f(n),a,i))}).catch(n=>{t(new wm(_f(n),n))}):t(new wm(_f(e),e))}),wP=(e,t,r,s)=>{const n={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||!s?n:(vP(s)?(n.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),n.body=JSON.stringify(s)):n.body=s,t!=null&&t.duplex&&(n.duplex=t.duplex),Object.assign(Object.assign({},n),r))};function Pc(e,t,r,s,n,a){return De(this,void 0,void 0,function*(){return new Promise((i,l)=>{e(r,wP(t,s,n,a)).then(c=>{if(!c.ok)throw c;return s!=null&&s.noResolveJson?c:c.json()}).then(c=>i(c)).catch(c=>yP(c,l,s))})})}function nc(e,t,r,s){return De(this,void 0,void 0,function*(){return Pc(e,"GET",t,r,s)})}function $s(e,t,r,s,n){return De(this,void 0,void 0,function*(){return Pc(e,"POST",t,s,n,r)})}function _m(e,t,r,s,n){return De(this,void 0,void 0,function*(){return Pc(e,"PUT",t,s,n,r)})}function bP(e,t,r,s){return De(this,void 0,void 0,function*(){return Pc(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),s)})}function Sx(e,t,r,s,n){return De(this,void 0,void 0,function*(){return Pc(e,"DELETE",t,s,n,r)})}class _P{constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r}then(t,r){return this.execute().then(t,r)}execute(){return De(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Ct(t))return{data:null,error:t};throw t}})}}var Tk;class SP{constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r,this[Tk]="BlobDownloadBuilder",this.promise=null}asStream(){return new _P(this.downloadFn,this.shouldThrowOnError)}then(t,r){return this.getPromise().then(t,r)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return De(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Ct(t))return{data:null,error:t};throw t}})}}Tk=Symbol.toStringTag;const kP={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},a1={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class NP{constructor(t,r={},s,n){this.shouldThrowOnError=!1,this.url=t,this.headers=r,this.bucketId=s,this.fetch=_x(n)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(t,r,s,n){return De(this,void 0,void 0,function*(){try{let a;const i=Object.assign(Object.assign({},a1),n);let l=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(i.upsert)});const c=i.metadata;typeof Blob<"u"&&s instanceof Blob?(a=new FormData,a.append("cacheControl",i.cacheControl),c&&a.append("metadata",this.encodeMetadata(c)),a.append("",s)):typeof FormData<"u"&&s instanceof FormData?(a=s,a.has("cacheControl")||a.append("cacheControl",i.cacheControl),c&&!a.has("metadata")&&a.append("metadata",this.encodeMetadata(c))):(a=s,l["cache-control"]=`max-age=${i.cacheControl}`,l["content-type"]=i.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c))),(typeof ReadableStream<"u"&&a instanceof ReadableStream||a&&typeof a=="object"&&"pipe"in a&&typeof a.pipe=="function")&&!i.duplex&&(i.duplex="half")),n!=null&&n.headers&&(l=Object.assign(Object.assign({},l),n.headers));const u=this._removeEmptyFolders(r),d=this._getFinalPath(u),f=yield(t=="PUT"?_m:$s)(this.fetch,`${this.url}/object/${d}`,a,Object.assign({headers:l},i!=null&&i.duplex?{duplex:i.duplex}:{}));return{data:{path:u,id:f.Id,fullPath:f.Key},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Ct(a))return{data:null,error:a};throw a}})}upload(t,r,s){return De(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,s)})}uploadToSignedUrl(t,r,s,n){return De(this,void 0,void 0,function*(){const a=this._removeEmptyFolders(t),i=this._getFinalPath(a),l=new URL(this.url+`/object/upload/sign/${i}`);l.searchParams.set("token",r);try{let c;const u=Object.assign({upsert:a1.upsert},n),d=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&s instanceof Blob?(c=new FormData,c.append("cacheControl",u.cacheControl),c.append("",s)):typeof FormData<"u"&&s instanceof FormData?(c=s,c.append("cacheControl",u.cacheControl)):(c=s,d["cache-control"]=`max-age=${u.cacheControl}`,d["content-type"]=u.contentType);const f=yield _m(this.fetch,l.toString(),c,{headers:d});return{data:{path:a,fullPath:f.Key},error:null}}catch(c){if(this.shouldThrowOnError)throw c;if(Ct(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(t,r){return De(this,void 0,void 0,function*(){try{let s=this._getFinalPath(t);const n=Object.assign({},this.headers);r!=null&&r.upsert&&(n["x-upsert"]="true");const a=yield $s(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:n}),i=new URL(this.url+a.url),l=i.searchParams.get("token");if(!l)throw new bx("No token returned by API");return{data:{signedUrl:i.toString(),path:t,token:l},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Ct(s))return{data:null,error:s};throw s}})}update(t,r,s){return De(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,s)})}move(t,r,s){return De(this,void 0,void 0,function*(){try{return{data:yield $s(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ct(n))return{data:null,error:n};throw n}})}copy(t,r,s){return De(this,void 0,void 0,function*(){try{return{data:{path:(yield $s(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers})).Key},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ct(n))return{data:null,error:n};throw n}})}createSignedUrl(t,r,s){return De(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t),a=yield $s(this.fetch,`${this.url}/object/sign/${n}`,Object.assign({expiresIn:r},s!=null&&s.transform?{transform:s.transform}:{}),{headers:this.headers});const i=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return a={signedUrl:encodeURI(`${this.url}${a.signedURL}${i}`)},{data:a,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ct(n))return{data:null,error:n};throw n}})}createSignedUrls(t,r,s){return De(this,void 0,void 0,function*(){try{const n=yield $s(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),a=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return{data:n.map(i=>Object.assign(Object.assign({},i),{signedUrl:i.signedURL?encodeURI(`${this.url}${i.signedURL}${a}`):null})),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ct(n))return{data:null,error:n};throw n}})}download(t,r){const n=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",a=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),i=a?`?${a}`:"",l=this._getFinalPath(t),c=()=>nc(this.fetch,`${this.url}/${n}/${l}${i}`,{headers:this.headers,noResolveJson:!0});return new SP(c,this.shouldThrowOnError)}info(t){return De(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const s=yield nc(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:bm(s),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Ct(s))return{data:null,error:s};throw s}})}exists(t){return De(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield bP(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Ct(s)&&s instanceof wm){const n=s.originalError;if([400,404].includes(n==null?void 0:n.status))return{data:!1,error:s}}throw s}})}getPublicUrl(t,r){const s=this._getFinalPath(t),n=[],a=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";a!==""&&n.push(a);const l=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});c!==""&&n.push(c);let u=n.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${s}${u}`)}}}remove(t){return De(this,void 0,void 0,function*(){try{return{data:yield Sx(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ct(r))return{data:null,error:r};throw r}})}list(t,r,s){return De(this,void 0,void 0,function*(){try{const n=Object.assign(Object.assign(Object.assign({},kP),r),{prefix:t||""});return{data:yield $s(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},s),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ct(n))return{data:null,error:n};throw n}})}listV2(t,r){return De(this,void 0,void 0,function*(){try{const s=Object.assign({},t);return{data:yield $s(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,s,{headers:this.headers},r),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Ct(s))return{data:null,error:s};throw s}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const Ck="2.84.0",Ak={"X-Client-Info":`storage-js/${Ck}`};class EP{constructor(t,r={},s,n){this.shouldThrowOnError=!1;const a=new URL(t);n!=null&&n.useNewHostname&&/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase.")),this.url=a.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Ak),r),this.fetch=_x(s)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(t){return De(this,void 0,void 0,function*(){try{const r=this.listBucketOptionsToQueryString(t);return{data:yield nc(this.fetch,`${this.url}/bucket${r}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ct(r))return{data:null,error:r};throw r}})}getBucket(t){return De(this,void 0,void 0,function*(){try{return{data:yield nc(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ct(r))return{data:null,error:r};throw r}})}createBucket(t){return De(this,arguments,void 0,function*(r,s={public:!1}){try{return{data:yield $s(this.fetch,`${this.url}/bucket`,{id:r,name:r,type:s.type,public:s.public,file_size_limit:s.fileSizeLimit,allowed_mime_types:s.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ct(n))return{data:null,error:n};throw n}})}updateBucket(t,r){return De(this,void 0,void 0,function*(){try{return{data:yield _m(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Ct(s))return{data:null,error:s};throw s}})}emptyBucket(t){return De(this,void 0,void 0,function*(){try{return{data:yield $s(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ct(r))return{data:null,error:r};throw r}})}deleteBucket(t){return De(this,void 0,void 0,function*(){try{return{data:yield Sx(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ct(r))return{data:null,error:r};throw r}})}listBucketOptionsToQueryString(t){const r={};return t&&("limit"in t&&(r.limit=String(t.limit)),"offset"in t&&(r.offset=String(t.offset)),t.search&&(r.search=t.search),t.sortColumn&&(r.sortColumn=t.sortColumn),t.sortOrder&&(r.sortOrder=t.sortOrder)),Object.keys(r).length>0?"?"+new URLSearchParams(r).toString():""}}class jP{constructor(t,r={},s){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Ak),r),this.fetch=_x(s)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return De(this,void 0,void 0,function*(){try{return{data:yield $s(this.fetch,`${this.url}/bucket`,{name:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ct(r))return{data:null,error:r};throw r}})}listBuckets(t){return De(this,void 0,void 0,function*(){try{const r=new URLSearchParams;(t==null?void 0:t.limit)!==void 0&&r.set("limit",t.limit.toString()),(t==null?void 0:t.offset)!==void 0&&r.set("offset",t.offset.toString()),t!=null&&t.sortColumn&&r.set("sortColumn",t.sortColumn),t!=null&&t.sortOrder&&r.set("sortOrder",t.sortOrder),t!=null&&t.search&&r.set("search",t.search);const s=r.toString(),n=s?`${this.url}/bucket?${s}`:`${this.url}/bucket`;return{data:yield nc(this.fetch,n,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ct(r))return{data:null,error:r};throw r}})}deleteBucket(t){return De(this,void 0,void 0,function*(){try{return{data:yield Sx(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ct(r))return{data:null,error:r};throw r}})}}const kx={"X-Client-Info":`storage-js/${Ck}`,"Content-Type":"application/json"};class Fk extends Error{constructor(t){super(t),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function as(e){return typeof e=="object"&&e!==null&&"__isStorageVectorsError"in e}class Sf extends Fk{constructor(t,r,s){super(t),this.name="StorageVectorsApiError",this.status=r,this.statusCode=s}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class TP extends Fk{constructor(t,r){super(t),this.name="StorageVectorsUnknownError",this.originalError=r}}var i1;(function(e){e.InternalError="InternalError",e.S3VectorConflictException="S3VectorConflictException",e.S3VectorNotFoundException="S3VectorNotFoundException",e.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",e.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",e.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(i1||(i1={}));const Nx=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),CP=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},o1=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),AP=(e,t,r)=>De(void 0,void 0,void 0,function*(){if(e&&typeof e=="object"&&"status"in e&&"ok"in e&&typeof e.status=="number"&&!(r!=null&&r.noResolveJson)){const n=e.status||500,a=e;if(typeof a.json=="function")a.json().then(i=>{const l=(i==null?void 0:i.statusCode)||(i==null?void 0:i.code)||n+"";t(new Sf(o1(i),n,l))}).catch(()=>{const i=n+"",l=a.statusText||`HTTP ${n} error`;t(new Sf(l,n,i))});else{const i=n+"",l=a.statusText||`HTTP ${n} error`;t(new Sf(l,n,i))}}else t(new TP(o1(e),e))}),FP=(e,t,r,s)=>{const n={method:e,headers:(t==null?void 0:t.headers)||{}};return s?(CP(s)?(n.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),n.body=JSON.stringify(s)):n.body=s,Object.assign(Object.assign({},n),r)):n};function PP(e,t,r,s,n,a){return De(this,void 0,void 0,function*(){return new Promise((i,l)=>{e(r,FP(t,s,n,a)).then(c=>{if(!c.ok)throw c;if(s!=null&&s.noResolveJson)return c;const u=c.headers.get("content-type");return!u||!u.includes("application/json")?{}:c.json()}).then(c=>i(c)).catch(c=>AP(c,l,s))})})}function is(e,t,r,s,n){return De(this,void 0,void 0,function*(){return PP(e,"POST",t,s,n,r)})}class RP{constructor(t,r={},s){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},kx),r),this.fetch=Nx(s)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(t){return De(this,void 0,void 0,function*(){try{return{data:(yield is(this.fetch,`${this.url}/CreateIndex`,t,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(as(r))return{data:null,error:r};throw r}})}getIndex(t,r){return De(this,void 0,void 0,function*(){try{return{data:yield is(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:t,indexName:r},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(as(s))return{data:null,error:s};throw s}})}listIndexes(t){return De(this,void 0,void 0,function*(){try{return{data:yield is(this.fetch,`${this.url}/ListIndexes`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(as(r))return{data:null,error:r};throw r}})}deleteIndex(t,r){return De(this,void 0,void 0,function*(){try{return{data:(yield is(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:t,indexName:r},{headers:this.headers}))||{},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(as(s))return{data:null,error:s};throw s}})}}class IP{constructor(t,r={},s){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},kx),r),this.fetch=Nx(s)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(t){return De(this,void 0,void 0,function*(){try{if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield is(this.fetch,`${this.url}/PutVectors`,t,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(as(r))return{data:null,error:r};throw r}})}getVectors(t){return De(this,void 0,void 0,function*(){try{return{data:yield is(this.fetch,`${this.url}/GetVectors`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(as(r))return{data:null,error:r};throw r}})}listVectors(t){return De(this,void 0,void 0,function*(){try{if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return{data:yield is(this.fetch,`${this.url}/ListVectors`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(as(r))return{data:null,error:r};throw r}})}queryVectors(t){return De(this,void 0,void 0,function*(){try{return{data:yield is(this.fetch,`${this.url}/QueryVectors`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(as(r))return{data:null,error:r};throw r}})}deleteVectors(t){return De(this,void 0,void 0,function*(){try{if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield is(this.fetch,`${this.url}/DeleteVectors`,t,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(as(r))return{data:null,error:r};throw r}})}}class OP{constructor(t,r={},s){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},kx),r),this.fetch=Nx(s)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return De(this,void 0,void 0,function*(){try{return{data:(yield is(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(as(r))return{data:null,error:r};throw r}})}getBucket(t){return De(this,void 0,void 0,function*(){try{return{data:yield is(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(as(r))return{data:null,error:r};throw r}})}listBuckets(){return De(this,arguments,void 0,function*(t={}){try{return{data:yield is(this.fetch,`${this.url}/ListVectorBuckets`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(as(r))return{data:null,error:r};throw r}})}deleteBucket(t){return De(this,void 0,void 0,function*(){try{return{data:(yield is(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(as(r))return{data:null,error:r};throw r}})}}class DP extends OP{constructor(t,r={}){super(t,r.headers||{},r.fetch)}from(t){return new LP(this.url,this.headers,t,this.fetch)}}class LP extends RP{constructor(t,r,s,n){super(t,r,n),this.vectorBucketName=s}createIndex(t){const r=Object.create(null,{createIndex:{get:()=>super.createIndex}});return De(this,void 0,void 0,function*(){return r.createIndex.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const t=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return De(this,arguments,void 0,function*(r={}){return t.listIndexes.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName}))})}getIndex(t){const r=Object.create(null,{getIndex:{get:()=>super.getIndex}});return De(this,void 0,void 0,function*(){return r.getIndex.call(this,this.vectorBucketName,t)})}deleteIndex(t){const r=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return De(this,void 0,void 0,function*(){return r.deleteIndex.call(this,this.vectorBucketName,t)})}index(t){return new MP(this.url,this.headers,this.vectorBucketName,t,this.fetch)}}class MP extends IP{constructor(t,r,s,n,a){super(t,r,a),this.vectorBucketName=s,this.indexName=n}putVectors(t){const r=Object.create(null,{putVectors:{get:()=>super.putVectors}});return De(this,void 0,void 0,function*(){return r.putVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(t){const r=Object.create(null,{getVectors:{get:()=>super.getVectors}});return De(this,void 0,void 0,function*(){return r.getVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const t=Object.create(null,{listVectors:{get:()=>super.listVectors}});return De(this,arguments,void 0,function*(r={}){return t.listVectors.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(t){const r=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return De(this,void 0,void 0,function*(){return r.queryVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(t){const r=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return De(this,void 0,void 0,function*(){return r.deleteVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class BP extends EP{constructor(t,r={},s,n){super(t,r,s,n)}from(t){return new NP(this.url,this.headers,t,this.fetch)}get vectors(){return new DP(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new jP(this.url+"/iceberg",this.headers,this.fetch)}}const UP="2.84.0";let al="";typeof Deno<"u"?al="deno":typeof document<"u"?al="web":typeof navigator<"u"&&navigator.product==="ReactNative"?al="react-native":al="node";const zP={"X-Client-Info":`supabase-js-${al}/${UP}`},$P={headers:zP},VP={schema:"public"},WP={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},qP={},HP=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),GP=()=>Headers,KP=(e,t,r)=>{const s=HP(r),n=GP();return async(a,i)=>{var l;const c=(l=await t())!==null&&l!==void 0?l:e;let u=new n(i==null?void 0:i.headers);return u.has("apikey")||u.set("apikey",e),u.has("Authorization")||u.set("Authorization",`Bearer ${c}`),s(a,Object.assign(Object.assign({},i),{headers:u}))}};function XP(e){return e.endsWith("/")?e:e+"/"}function QP(e,t){var r,s;const{db:n,auth:a,realtime:i,global:l}=e,{db:c,auth:u,realtime:d,global:f}=t,h={db:Object.assign(Object.assign({},c),n),auth:Object.assign(Object.assign({},u),a),realtime:Object.assign(Object.assign({},d),i),storage:{},global:Object.assign(Object.assign(Object.assign({},f),l),{headers:Object.assign(Object.assign({},(r=f==null?void 0:f.headers)!==null&&r!==void 0?r:{}),(s=l==null?void 0:l.headers)!==null&&s!==void 0?s:{})}),accessToken:async()=>""};return e.accessToken?h.accessToken=e.accessToken:delete h.accessToken,h}function YP(e){const t=e==null?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(XP(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const Pk="2.84.0",Ci=30*1e3,Sm=3,kf=Sm*Ci,JP="http://localhost:9999",ZP="supabase.auth.token",e5={"X-Client-Info":`gotrue-js/${Pk}`},km="X-Supabase-Api-Version",Rk={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},t5=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,r5=10*60*1e3;class ac extends Error{constructor(t,r,s){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=s}}function Le(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class s5 extends ac{constructor(t,r,s){super(t,r,s),this.name="AuthApiError",this.status=r,this.code=s}}function n5(e){return Le(e)&&e.name==="AuthApiError"}class Ia extends ac{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class ya extends ac{constructor(t,r,s,n){super(t,s,n),this.name=r,this.status=s}}class ts extends ya{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function a5(e){return Le(e)&&e.name==="AuthSessionMissingError"}class bi extends ya{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class vu extends ya{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class yu extends ya{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function i5(e){return Le(e)&&e.name==="AuthImplicitGrantRedirectError"}class l1 extends ya{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Nm extends ya{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function Nf(e){return Le(e)&&e.name==="AuthRetryableFetchError"}class c1 extends ya{constructor(t,r,s){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=s}}class Em extends ya{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const jd="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),u1=` 	
\r=`.split(""),o5=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<u1.length;t+=1)e[u1[t].charCodeAt(0)]=-2;for(let t=0;t<jd.length;t+=1)e[jd[t].charCodeAt(0)]=t;return e})();function d1(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const s=t.queue>>t.queuedBits-6&63;r(jd[s]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const s=t.queue>>t.queuedBits-6&63;r(jd[s]),t.queuedBits-=6}}function Ik(e,t,r){const s=o5[e];if(s>-1)for(t.queue=t.queue<<6|s,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function f1(e){const t=[],r=i=>{t.push(String.fromCodePoint(i))},s={utf8seq:0,codepoint:0},n={queue:0,queuedBits:0},a=i=>{u5(i,s,r)};for(let i=0;i<e.length;i+=1)Ik(e.charCodeAt(i),n,a);return t.join("")}function l5(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function c5(e,t){for(let r=0;r<e.length;r+=1){let s=e.charCodeAt(r);if(s>55295&&s<=56319){const n=(s-55296)*1024&65535;s=(e.charCodeAt(r+1)-56320&65535|n)+65536,r+=1}l5(s,t)}}function u5(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let s=1;s<6;s+=1)if(!(e>>7-s&1)){t.utf8seq=s;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function no(e){const t=[],r={queue:0,queuedBits:0},s=n=>{t.push(n)};for(let n=0;n<e.length;n+=1)Ik(e.charCodeAt(n),r,s);return new Uint8Array(t)}function d5(e){const t=[];return c5(e,r=>t.push(r)),new Uint8Array(t)}function za(e){const t=[],r={queue:0,queuedBits:0},s=n=>{t.push(n)};return e.forEach(n=>d1(n,r,s)),d1(null,r,s),t.join("")}function f5(e){return Math.round(Date.now()/1e3)+e}function h5(){return Symbol("auth-callback")}const dr=()=>typeof window<"u"&&typeof document<"u",Ea={tested:!1,writable:!1},Ok=()=>{if(!dr())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Ea.tested)return Ea.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Ea.tested=!0,Ea.writable=!0}catch{Ea.tested=!0,Ea.writable=!1}return Ea.writable};function m5(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((n,a)=>{t[a]=n})}catch{}return r.searchParams.forEach((s,n)=>{t[n]=s}),t}const Dk=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),p5=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",Ai=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},ja=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Un=async(e,t)=>{await e.removeItem(t)};class h0{constructor(){this.promise=new h0.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}h0.promiseConstructor=Promise;function Ef(e){const t=e.split(".");if(t.length!==3)throw new Em("Invalid JWT structure");for(let s=0;s<t.length;s++)if(!t5.test(t[s]))throw new Em("JWT not in base64url format");return{header:JSON.parse(f1(t[0])),payload:JSON.parse(f1(t[1])),signature:no(t[2]),raw:{header:t[0],payload:t[1]}}}async function x5(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function g5(e,t){return new Promise((s,n)=>{(async()=>{for(let a=0;a<1/0;a++)try{const i=await e(a);if(!t(a,null,i)){s(i);return}}catch(i){if(!t(a,i)){n(i);return}}})()})}function v5(e){return("0"+e.toString(16)).substr(-2)}function y5(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=r.length;let n="";for(let a=0;a<56;a++)n+=r.charAt(Math.floor(Math.random()*s));return n}return crypto.getRandomValues(t),Array.from(t,v5).join("")}async function w5(e){const r=new TextEncoder().encode(e),s=await crypto.subtle.digest("SHA-256",r),n=new Uint8Array(s);return Array.from(n).map(a=>String.fromCharCode(a)).join("")}async function b5(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await w5(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function _i(e,t,r=!1){const s=y5();let n=s;r&&(n+="/PASSWORD_RECOVERY"),await Ai(e,`${t}-code-verifier`,n);const a=await b5(s);return[a,s===a?"plain":"s256"]}const _5=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function S5(e){const t=e.headers.get(km);if(!t||!t.match(_5))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function k5(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function N5(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const E5=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Si(e){if(!E5.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function jf(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const s=r.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function j5(e,t){return new Proxy(e,{get:(r,s,n)=>{if(s==="__isInsecureUserWarningProxy")return!0;if(typeof s=="symbol"){const a=s.toString();if(a==="Symbol(Symbol.toPrimitive)"||a==="Symbol(Symbol.toStringTag)"||a==="Symbol(util.inspect.custom)"||a==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,s,n)}return!t.value&&typeof s=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(r,s,n)}})}function h1(e){return JSON.parse(JSON.stringify(e))}const Fa=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),T5=[502,503,504];async function m1(e){var t;if(!p5(e))throw new Nm(Fa(e),0);if(T5.includes(e.status))throw new Nm(Fa(e),e.status);let r;try{r=await e.json()}catch(a){throw new Ia(Fa(a),a)}let s;const n=S5(e);if(n&&n.getTime()>=Rk["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?s=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(s=r.error_code),s){if(s==="weak_password")throw new c1(Fa(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(s==="session_not_found")throw new ts}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((a,i)=>a&&typeof i=="string",!0))throw new c1(Fa(r),e.status,r.weak_password.reasons);throw new s5(Fa(r),e.status||500,s)}const C5=(e,t,r,s)=>{const n={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),n.body=JSON.stringify(s),Object.assign(Object.assign({},n),r))};async function ze(e,t,r,s){var n;const a=Object.assign({},s==null?void 0:s.headers);a[km]||(a[km]=Rk["2024-01-01"].name),s!=null&&s.jwt&&(a.Authorization=`Bearer ${s.jwt}`);const i=(n=s==null?void 0:s.query)!==null&&n!==void 0?n:{};s!=null&&s.redirectTo&&(i.redirect_to=s.redirectTo);const l=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",c=await A5(e,t,r+l,{headers:a,noResolveJson:s==null?void 0:s.noResolveJson},{},s==null?void 0:s.body);return s!=null&&s.xform?s==null?void 0:s.xform(c):{data:Object.assign({},c),error:null}}async function A5(e,t,r,s,n,a){const i=C5(t,s,n,a);let l;try{l=await e(r,Object.assign({},i))}catch(c){throw console.error(c),new Nm(Fa(c),0)}if(l.ok||await m1(l),s!=null&&s.noResolveJson)return l;try{return await l.json()}catch(c){await m1(c)}}function Bs(e){var t;let r=null;R5(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=f5(e.expires_in)));const s=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:s},error:null}}function p1(e){const t=Bs(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,s)=>r&&typeof s=="string",!0)&&(t.data.weak_password=e.weak_password),t}function Gn(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function F5(e){return{data:e,error:null}}function P5(e){const{action_link:t,email_otp:r,hashed_token:s,redirect_to:n,verification_type:a}=e,i=Ro(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:t,email_otp:r,hashed_token:s,redirect_to:n,verification_type:a},c=Object.assign({},i);return{data:{properties:l,user:c},error:null}}function x1(e){return e}function R5(e){return e.access_token&&e.refresh_token&&e.expires_in}const Tf=["global","local","others"];class I5{constructor({url:t="",headers:r={},fetch:s}){this.url=t,this.headers=r,this.fetch=Dk(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=Tf[0]){if(Tf.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Tf.join(", ")}`);try{return await ze(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(s){if(Le(s))return{data:null,error:s};throw s}}async inviteUserByEmail(t,r={}){try{return await ze(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Gn})}catch(s){if(Le(s))return{data:{user:null},error:s};throw s}}async generateLink(t){try{const{options:r}=t,s=Ro(t,["options"]),n=Object.assign(Object.assign({},s),r);return"newEmail"in s&&(n.new_email=s==null?void 0:s.newEmail,delete n.newEmail),await ze(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:P5,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(Le(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await ze(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Gn})}catch(r){if(Le(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,s,n,a,i,l,c;try{const u={nextPage:null,lastPage:0,total:0},d=await ze(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:"",per_page:(a=(n=t==null?void 0:t.perPage)===null||n===void 0?void 0:n.toString())!==null&&a!==void 0?a:""},xform:x1});if(d.error)throw d.error;const f=await d.json(),h=(i=d.headers.get("x-total-count"))!==null&&i!==void 0?i:0,m=(c=(l=d.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return m.length>0&&(m.forEach(x=>{const p=parseInt(x.split(";")[0].split("=")[1].substring(0,1)),g=JSON.parse(x.split(";")[1].split("=")[1]);u[`${g}Page`]=p}),u.total=parseInt(h)),{data:Object.assign(Object.assign({},f),u),error:null}}catch(u){if(Le(u))return{data:{users:[]},error:u};throw u}}async getUserById(t){Si(t);try{return await ze(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Gn})}catch(r){if(Le(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){Si(t);try{return await ze(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:Gn})}catch(s){if(Le(s))return{data:{user:null},error:s};throw s}}async deleteUser(t,r=!1){Si(t);try{return await ze(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:Gn})}catch(s){if(Le(s))return{data:{user:null},error:s};throw s}}async _listFactors(t){Si(t.userId);try{const{data:r,error:s}=await ze(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:r,error:s}}catch(r){if(Le(r))return{data:null,error:r};throw r}}async _deleteFactor(t){Si(t.userId),Si(t.id);try{return{data:await ze(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Le(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,s,n,a,i,l,c;try{const u={nextPage:null,lastPage:0,total:0},d=await ze(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:"",per_page:(a=(n=t==null?void 0:t.perPage)===null||n===void 0?void 0:n.toString())!==null&&a!==void 0?a:""},xform:x1});if(d.error)throw d.error;const f=await d.json(),h=(i=d.headers.get("x-total-count"))!==null&&i!==void 0?i:0,m=(c=(l=d.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return m.length>0&&(m.forEach(x=>{const p=parseInt(x.split(";")[0].split("=")[1].substring(0,1)),g=JSON.parse(x.split(";")[1].split("=")[1]);u[`${g}Page`]=p}),u.total=parseInt(h)),{data:Object.assign(Object.assign({},f),u),error:null}}catch(u){if(Le(u))return{data:{clients:[]},error:u};throw u}}async _createOAuthClient(t){try{return await ze(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Le(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await ze(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Le(r))return{data:null,error:r};throw r}}async _updateOAuthClient(t,r){try{return await ze(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:r,headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(Le(s))return{data:null,error:s};throw s}}async _deleteOAuthClient(t){try{return await ze(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Le(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await ze(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Le(r))return{data:null,error:r};throw r}}}function g1(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const ki={debug:!!(globalThis&&Ok()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Lk extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class O5 extends Lk{}async function D5(e,t,r){ki.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const s=new globalThis.AbortController;return t>0&&setTimeout(()=>{s.abort(),ki.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async n=>{if(n){ki.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,n.name);try{return await r()}finally{ki.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,n.name)}}else{if(t===0)throw ki.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new O5(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(ki.debug)try{const a=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function L5(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function Mk(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function M5(e){return parseInt(e,16)}function B5(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,s=>s.toString(16).padStart(2,"0")).join("")}function U5(e){var t;const{chainId:r,domain:s,expirationTime:n,issuedAt:a=new Date,nonce:i,notBefore:l,requestId:c,resources:u,scheme:d,uri:f,version:h}=e;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!s)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(i&&i.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${i}`);if(!f)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(h!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${h}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const m=Mk(e.address),x=d?`${d}://${s}`:s,p=e.statement?`${e.statement}
`:"",g=`${x} wants you to sign in with your Ethereum account:
${m}

${p}`;let w=`URI: ${f}
Version: ${h}
Chain ID: ${r}${i?`
Nonce: ${i}`:""}
Issued At: ${a.toISOString()}`;if(n&&(w+=`
Expiration Time: ${n.toISOString()}`),l&&(w+=`
Not Before: ${l.toISOString()}`),c&&(w+=`
Request ID: ${c}`),u){let v=`
Resources:`;for(const y of u){if(!y||typeof y!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${y}`);v+=`
- ${y}`}w+=v}return`${g}
${w}`}class Qt extends Error{constructor({message:t,code:r,cause:s,name:n}){var a;super(t,{cause:s}),this.__isWebAuthnError=!0,this.name=(a=n??(s instanceof Error?s.name:void 0))!==null&&a!==void 0?a:"Unknown Error",this.code=r}}class Td extends Qt{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function z5({error:e,options:t}){var r,s,n;const{publicKey:a}=t;if(!a)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Qt({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((r=a.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new Qt({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((s=a.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new Qt({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((n=a.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new Qt({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new Qt({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new Qt({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return a.pubKeyCredParams.filter(l=>l.type==="public-key").length===0?new Qt({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new Qt({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const i=window.location.hostname;if(Bk(i)){if(a.rp.id!==i)return new Qt({message:`The RP ID "${a.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Qt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(a.user.id.byteLength<1||a.user.id.byteLength>64)return new Qt({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new Qt({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Qt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function $5({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Qt({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new Qt({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const s=window.location.hostname;if(Bk(s)){if(r.rpId!==s)return new Qt({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Qt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new Qt({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Qt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}class V5{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const W5=new V5;function q5(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:s}=e,n=Ro(e,["challenge","user","excludeCredentials"]),a=no(t).buffer,i=Object.assign(Object.assign({},r),{id:no(r.id).buffer}),l=Object.assign(Object.assign({},n),{challenge:a,user:i});if(s&&s.length>0){l.excludeCredentials=new Array(s.length);for(let c=0;c<s.length;c++){const u=s[c];l.excludeCredentials[c]=Object.assign(Object.assign({},u),{id:no(u.id).buffer,type:u.type||"public-key",transports:u.transports})}}return l}function H5(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,s=Ro(e,["challenge","allowCredentials"]),n=no(t).buffer,a=Object.assign(Object.assign({},s),{challenge:n});if(r&&r.length>0){a.allowCredentials=new Array(r.length);for(let i=0;i<r.length;i++){const l=r[i];a.allowCredentials[i]=Object.assign(Object.assign({},l),{id:no(l.id).buffer,type:l.type||"public-key",transports:l.transports})}}return a}function G5(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:za(new Uint8Array(e.response.attestationObject)),clientDataJSON:za(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function K5(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e,s=e.getClientExtensionResults(),n=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:za(new Uint8Array(n.authenticatorData)),clientDataJSON:za(new Uint8Array(n.clientDataJSON)),signature:za(new Uint8Array(n.signature)),userHandle:n.userHandle?za(new Uint8Array(n.userHandle)):void 0},type:"public-key",clientExtensionResults:s,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function Bk(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function v1(){var e,t;return!!(dr()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.get)=="function")}async function X5(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Td("Browser returned unexpected credential type",t)}:{data:null,error:new Td("Empty credential response",t)}}catch(t){return{data:null,error:z5({error:t,options:e})}}}async function Q5(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Td("Browser returned unexpected credential type",t)}:{data:null,error:new Td("Empty credential response",t)}}catch(t){return{data:null,error:$5({error:t,options:e})}}}const Y5={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},J5={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Cd(...e){const t=n=>n!==null&&typeof n=="object"&&!Array.isArray(n),r=n=>n instanceof ArrayBuffer||ArrayBuffer.isView(n),s={};for(const n of e)if(n)for(const a in n){const i=n[a];if(i!==void 0)if(Array.isArray(i))s[a]=i;else if(r(i))s[a]=i;else if(t(i)){const l=s[a];t(l)?s[a]=Cd(l,i):s[a]=Cd(i)}else s[a]=i}return s}function Z5(e,t){return Cd(Y5,e,t||{})}function eR(e,t){return Cd(J5,e,t||{})}class tR{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:s,signal:n},a){try{const{data:i,error:l}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!i)return{data:null,error:l};const c=n??W5.createNewAbortSignal();if(i.webauthn.type==="create"){const{user:u}=i.webauthn.credential_options.publicKey;u.name||(u.name=`${u.id}:${s}`),u.displayName||(u.displayName=u.name)}switch(i.webauthn.type){case"create":{const u=Z5(i.webauthn.credential_options.publicKey,a==null?void 0:a.create),{data:d,error:f}=await X5({publicKey:u,signal:c});return d?{data:{factorId:t,challengeId:i.id,webauthn:{type:i.webauthn.type,credential_response:d}},error:null}:{data:null,error:f}}case"request":{const u=eR(i.webauthn.credential_options.publicKey,a==null?void 0:a.request),{data:d,error:f}=await Q5(Object.assign(Object.assign({},i.webauthn.credential_options),{publicKey:u,signal:c}));return d?{data:{factorId:t,challengeId:i.id,webauthn:{type:i.webauthn.type,credential_response:d}},error:null}:{data:null,error:f}}}}catch(i){return Le(i)?{data:null,error:i}:{data:null,error:new Ia("Unexpected error in challenge",i)}}}async _verify({challengeId:t,factorId:r,webauthn:s}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:s})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:n}={}},a){if(!r)return{data:null,error:new ac("rpId is required for WebAuthn authentication")};try{if(!v1())return{data:null,error:new Ia("Browser does not support WebAuthn",null)};const{data:i,error:l}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:s},signal:n},{request:a});if(!i)return{data:null,error:l};const{webauthn:c}=i;return this._verify({factorId:t,challengeId:i.challengeId,webauthn:{type:c.type,rpId:r,rpOrigins:s,credential_response:c.credential_response}})}catch(i){return Le(i)?{data:null,error:i}:{data:null,error:new Ia("Unexpected error in authenticate",i)}}}async _register({friendlyName:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:n}={}},a){if(!r)return{data:null,error:new ac("rpId is required for WebAuthn registration")};try{if(!v1())return{data:null,error:new Ia("Browser does not support WebAuthn",null)};const{data:i,error:l}=await this._enroll({friendlyName:t});if(!i)return await this.client.mfa.listFactors().then(d=>{var f;return(f=d.data)===null||f===void 0?void 0:f.all.find(h=>h.factor_type==="webauthn"&&h.friendly_name===t&&h.status!=="unverified")}).then(d=>d?this.client.mfa.unenroll({factorId:d==null?void 0:d.id}):void 0),{data:null,error:l};const{data:c,error:u}=await this._challenge({factorId:i.id,friendlyName:i.friendly_name,webauthn:{rpId:r,rpOrigins:s},signal:n},{create:a});return c?this._verify({factorId:i.id,challengeId:c.challengeId,webauthn:{rpId:r,rpOrigins:s,type:c.webauthn.type,credential_response:c.webauthn.credential_response}}):{data:null,error:u}}catch(i){return Le(i)?{data:null,error:i}:{data:null,error:new Ia("Unexpected error in register",i)}}}}L5();const rR={url:JP,storageKey:ZP,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:e5,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function y1(e,t,r){return await r()}const Ni={};class ic{get jwks(){var t,r;return(r=(t=Ni[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){Ni[this.storageKey]=Object.assign(Object.assign({},Ni[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=Ni[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){Ni[this.storageKey]=Object.assign(Object.assign({},Ni[this.storageKey]),{cachedAt:t})}constructor(t){var r,s,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const a=Object.assign(Object.assign({},rR),t);if(this.storageKey=a.storageKey,this.instanceID=(r=ic.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,ic.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.instanceID>0&&dr()){const i=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(i),this.logDebugMessages&&console.trace(i)}if(this.persistSession=a.persistSession,this.autoRefreshToken=a.autoRefreshToken,this.admin=new I5({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=Dk(a.fetch),this.lock=a.lock||y1,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,this.throwOnError=a.throwOnError,a.lock?this.lock=a.lock:dr()&&(!((s=globalThis==null?void 0:globalThis.navigator)===null||s===void 0)&&s.locks)?this.lock=D5:this.lock=y1,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new tR(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:Ok()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=g1(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=g1(this.memoryStorage)),dr()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${Pk}) ${new Date().toISOString()}`}_debug(...t){return this.logDebugMessages&&this.logger(this._logPrefix(),...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let r={},s="none";if(dr()&&(r=m5(window.location.href),this._isImplicitGrantCallback(r)?s="implicit":await this._isPKCECallback(r)&&(s="pkce")),dr()&&this.detectSessionInUrl&&s!=="none"){const{data:n,error:a}=await this._getSessionFromURL(r,s);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),i5(a)){const c=(t=a.details)===null||t===void 0?void 0:t.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:a}}return await this._removeSession(),{error:a}}const{session:i,redirectType:l}=n;return this._debug("#_initialize()","detected session in URL",i,"redirect type",l),await this._saveSession(i),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Le(r)?this._returnResult({error:r}):this._returnResult({error:new Ia("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,s,n;try{const a=await ze(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(n=t==null?void 0:t.options)===null||n===void 0?void 0:n.captchaToken}},xform:Bs}),{data:i,error:l}=a;if(l||!i)return this._returnResult({data:{user:null,session:null},error:l});const c=i.session,u=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:u,session:c},error:null})}catch(a){if(Le(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signUp(t){var r,s,n;try{let a;if("email"in t){const{email:d,password:f,options:h}=t;let m=null,x=null;this.flowType==="pkce"&&([m,x]=await _i(this.storage,this.storageKey)),a=await ze(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h==null?void 0:h.emailRedirectTo,body:{email:d,password:f,data:(r=h==null?void 0:h.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:m,code_challenge_method:x},xform:Bs})}else if("phone"in t){const{phone:d,password:f,options:h}=t;a=await ze(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:f,data:(s=h==null?void 0:h.data)!==null&&s!==void 0?s:{},channel:(n=h==null?void 0:h.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:Bs})}else throw new vu("You must provide either an email or phone number and a password");const{data:i,error:l}=a;if(l||!i)return this._returnResult({data:{user:null,session:null},error:l});const c=i.session,u=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:u,session:c},error:null})}catch(a){if(Le(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithPassword(t){try{let r;if("email"in t){const{email:a,password:i,options:l}=t;r=await ze(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:a,password:i,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:p1})}else if("phone"in t){const{phone:a,password:i,options:l}=t;r=await ze(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:a,password:i,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:p1})}else throw new vu("You must provide either an email or phone number and a password");const{data:s,error:n}=r;if(n)return this._returnResult({data:{user:null,session:null},error:n});if(!s||!s.session||!s.user){const a=new bi;return this._returnResult({data:{user:null,session:null},error:a})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:n})}catch(r){if(Le(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(t){var r,s,n,a;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(s=t.options)===null||s===void 0?void 0:s.scopes,queryParams:(n=t.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(a=t.options)===null||a===void 0?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,s,n,a,i,l,c,u,d,f,h;let m,x;if("message"in t)m=t.message,x=t.signature;else{const{chain:p,wallet:g,statement:w,options:v}=t;let y;if(dr())if(typeof g=="object")y=g;else{const C=window;if("ethereum"in C&&typeof C.ethereum=="object"&&"request"in C.ethereum&&typeof C.ethereum.request=="function")y=C.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof g!="object"||!(v!=null&&v.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");y=g}const b=new URL((r=v==null?void 0:v.url)!==null&&r!==void 0?r:window.location.href),S=await y.request({method:"eth_requestAccounts"}).then(C=>C).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!S||S.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const k=Mk(S[0]);let _=(s=v==null?void 0:v.signInWithEthereum)===null||s===void 0?void 0:s.chainId;if(!_){const C=await y.request({method:"eth_chainId"});_=M5(C)}const N={domain:b.host,address:k,statement:w,uri:b.href,version:"1",chainId:_,nonce:(n=v==null?void 0:v.signInWithEthereum)===null||n===void 0?void 0:n.nonce,issuedAt:(i=(a=v==null?void 0:v.signInWithEthereum)===null||a===void 0?void 0:a.issuedAt)!==null&&i!==void 0?i:new Date,expirationTime:(l=v==null?void 0:v.signInWithEthereum)===null||l===void 0?void 0:l.expirationTime,notBefore:(c=v==null?void 0:v.signInWithEthereum)===null||c===void 0?void 0:c.notBefore,requestId:(u=v==null?void 0:v.signInWithEthereum)===null||u===void 0?void 0:u.requestId,resources:(d=v==null?void 0:v.signInWithEthereum)===null||d===void 0?void 0:d.resources};m=U5(N),x=await y.request({method:"personal_sign",params:[B5(m),k]})}try{const{data:p,error:g}=await ze(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:m,signature:x},!((f=t.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(h=t.options)===null||h===void 0?void 0:h.captchaToken}}:null),xform:Bs});if(g)throw g;if(!p||!p.session||!p.user){const w=new bi;return this._returnResult({data:{user:null,session:null},error:w})}return p.session&&(await this._saveSession(p.session),await this._notifyAllSubscribers("SIGNED_IN",p.session)),this._returnResult({data:Object.assign({},p),error:g})}catch(p){if(Le(p))return this._returnResult({data:{user:null,session:null},error:p});throw p}}async signInWithSolana(t){var r,s,n,a,i,l,c,u,d,f,h,m;let x,p;if("message"in t)x=t.message,p=t.signature;else{const{chain:g,wallet:w,statement:v,options:y}=t;let b;if(dr())if(typeof w=="object")b=w;else{const k=window;if("solana"in k&&typeof k.solana=="object"&&("signIn"in k.solana&&typeof k.solana.signIn=="function"||"signMessage"in k.solana&&typeof k.solana.signMessage=="function"))b=k.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof w!="object"||!(y!=null&&y.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");b=w}const S=new URL((r=y==null?void 0:y.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in b&&b.signIn){const k=await b.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},y==null?void 0:y.signInWithSolana),{version:"1",domain:S.host,uri:S.href}),v?{statement:v}:null));let _;if(Array.isArray(k)&&k[0]&&typeof k[0]=="object")_=k[0];else if(k&&typeof k=="object"&&"signedMessage"in k&&"signature"in k)_=k;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in _&&"signature"in _&&(typeof _.signedMessage=="string"||_.signedMessage instanceof Uint8Array)&&_.signature instanceof Uint8Array)x=typeof _.signedMessage=="string"?_.signedMessage:new TextDecoder().decode(_.signedMessage),p=_.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in b)||typeof b.signMessage!="function"||!("publicKey"in b)||typeof b!="object"||!b.publicKey||!("toBase58"in b.publicKey)||typeof b.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");x=[`${S.host} wants you to sign in with your Solana account:`,b.publicKey.toBase58(),...v?["",v,""]:[""],"Version: 1",`URI: ${S.href}`,`Issued At: ${(n=(s=y==null?void 0:y.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&n!==void 0?n:new Date().toISOString()}`,...!((a=y==null?void 0:y.signInWithSolana)===null||a===void 0)&&a.notBefore?[`Not Before: ${y.signInWithSolana.notBefore}`]:[],...!((i=y==null?void 0:y.signInWithSolana)===null||i===void 0)&&i.expirationTime?[`Expiration Time: ${y.signInWithSolana.expirationTime}`]:[],...!((l=y==null?void 0:y.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${y.signInWithSolana.chainId}`]:[],...!((c=y==null?void 0:y.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${y.signInWithSolana.nonce}`]:[],...!((u=y==null?void 0:y.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${y.signInWithSolana.requestId}`]:[],...!((f=(d=y==null?void 0:y.signInWithSolana)===null||d===void 0?void 0:d.resources)===null||f===void 0)&&f.length?["Resources",...y.signInWithSolana.resources.map(_=>`- ${_}`)]:[]].join(`
`);const k=await b.signMessage(new TextEncoder().encode(x),"utf8");if(!k||!(k instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");p=k}}try{const{data:g,error:w}=await ze(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:x,signature:za(p)},!((h=t.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(m=t.options)===null||m===void 0?void 0:m.captchaToken}}:null),xform:Bs});if(w)throw w;if(!g||!g.session||!g.user){const v=new bi;return this._returnResult({data:{user:null,session:null},error:v})}return g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),this._returnResult({data:Object.assign({},g),error:w})}catch(g){if(Le(g))return this._returnResult({data:{user:null,session:null},error:g});throw g}}async _exchangeCodeForSession(t){const r=await ja(this.storage,`${this.storageKey}-code-verifier`),[s,n]=(r??"").split("/");try{const{data:a,error:i}=await ze(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:s},xform:Bs});if(await Un(this.storage,`${this.storageKey}-code-verifier`),i)throw i;if(!a||!a.session||!a.user){const l=new bi;return this._returnResult({data:{user:null,session:null,redirectType:null},error:l})}return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),this._returnResult({data:Object.assign(Object.assign({},a),{redirectType:n??null}),error:i})}catch(a){if(Le(a))return this._returnResult({data:{user:null,session:null,redirectType:null},error:a});throw a}}async signInWithIdToken(t){try{const{options:r,provider:s,token:n,access_token:a,nonce:i}=t,l=await ze(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:n,access_token:a,nonce:i,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:Bs}),{data:c,error:u}=l;if(u)return this._returnResult({data:{user:null,session:null},error:u});if(!c||!c.session||!c.user){const d=new bi;return this._returnResult({data:{user:null,session:null},error:d})}return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),this._returnResult({data:c,error:u})}catch(r){if(Le(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(t){var r,s,n,a,i;try{if("email"in t){const{email:l,options:c}=t;let u=null,d=null;this.flowType==="pkce"&&([u,d]=await _i(this.storage,this.storageKey));const{error:f}=await ze(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(r=c==null?void 0:c.data)!==null&&r!==void 0?r:{},create_user:(s=c==null?void 0:c.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:u,code_challenge_method:d},redirectTo:c==null?void 0:c.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:f})}if("phone"in t){const{phone:l,options:c}=t,{data:u,error:d}=await ze(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(n=c==null?void 0:c.data)!==null&&n!==void 0?n:{},create_user:(a=c==null?void 0:c.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(i=c==null?void 0:c.channel)!==null&&i!==void 0?i:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:d})}throw new vu("You must provide either an email or phone number.")}catch(l){if(Le(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async verifyOtp(t){var r,s;try{let n,a;"options"in t&&(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo,a=(s=t.options)===null||s===void 0?void 0:s.captchaToken);const{data:i,error:l}=await ze(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:a}}),redirectTo:n,xform:Bs});if(l)throw l;if(!i)throw new Error("An error occurred on token verification.");const c=i.session,u=i.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),this._returnResult({data:{user:u,session:c},error:null})}catch(n){if(Le(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithSSO(t){var r,s,n,a,i;try{let l=null,c=null;this.flowType==="pkce"&&([l,c]=await _i(this.storage,this.storageKey));const u=await ze(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(s=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&s!==void 0?s:void 0}),!((n=t==null?void 0:t.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:c}),headers:this.headers,xform:F5});return!((a=u.data)===null||a===void 0)&&a.url&&dr()&&!(!((i=t.options)===null||i===void 0)&&i.skipBrowserRedirect)&&window.location.assign(u.data.url),this._returnResult(u)}catch(l){if(Le(l))return this._returnResult({data:null,error:l});throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:s}=t;if(s)throw s;if(!r)throw new ts;const{error:n}=await ze(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:n})})}catch(t){if(Le(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:s,type:n,options:a}=t,{error:i}=await ze(this.fetch,"POST",r,{headers:this.headers,body:{email:s,type:n,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},redirectTo:a==null?void 0:a.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:i})}else if("phone"in t){const{phone:s,type:n,options:a}=t,{data:i,error:l}=await ze(this.fetch,"POST",r,{headers:this.headers,body:{phone:s,type:n,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:i==null?void 0:i.message_id},error:l})}throw new vu("You must provide either an email or phone number and a type")}catch(r){if(Le(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await s,await r()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=r();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await ja(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const s=t.expires_at?t.expires_at*1e3-Date.now()<kf:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",t.expires_at),!s){if(this.userStorage){const i=await ja(this.userStorage,this.storageKey+"-user");i!=null&&i.user?t.user=i.user:t.user=jf()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const i={value:this.suppressGetSessionWarning};t.user=j5(t.user,i),i.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:n,error:a}=await this._callRefreshToken(t.refresh_token);return a?this._returnResult({data:{session:null},error:a}):this._returnResult({data:{session:n},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await ze(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Gn}):await this._useSession(async r=>{var s,n,a;const{data:i,error:l}=r;if(l)throw l;return!(!((s=i.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new ts}:await ze(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0,xform:Gn})})}catch(r){if(Le(r))return a5(r)&&(await this._removeSession(),await Un(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async s=>{const{data:n,error:a}=s;if(a)throw a;if(!n.session)throw new ts;const i=n.session;let l=null,c=null;this.flowType==="pkce"&&t.email!=null&&([l,c]=await _i(this.storage,this.storageKey));const{data:u,error:d}=await ze(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:l,code_challenge_method:c}),jwt:i.access_token,xform:Gn});if(d)throw d;return i.user=u.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),this._returnResult({data:{user:i.user},error:null})})}catch(s){if(Le(s))return this._returnResult({data:{user:null},error:s});throw s}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new ts;const r=Date.now()/1e3;let s=r,n=!0,a=null;const{payload:i}=Ef(t.access_token);if(i.exp&&(s=i.exp,n=s<=r),n){const{data:l,error:c}=await this._callRefreshToken(t.refresh_token);if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!l)return{data:{user:null,session:null},error:null};a=l}else{const{data:l,error:c}=await this._getUser(t.access_token);if(c)throw c;a={access_token:t.access_token,refresh_token:t.refresh_token,user:l.user,token_type:"bearer",expires_in:s-r,expires_at:s},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return this._returnResult({data:{user:a.user,session:a},error:null})}catch(r){if(Le(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var s;if(!t){const{data:i,error:l}=r;if(l)throw l;t=(s=i.session)!==null&&s!==void 0?s:void 0}if(!(t!=null&&t.refresh_token))throw new ts;const{data:n,error:a}=await this._callRefreshToken(t.refresh_token);return a?this._returnResult({data:{user:null,session:null},error:a}):n?this._returnResult({data:{user:n.user,session:n},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(Le(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(t,r){try{if(!dr())throw new yu("No browser detected.");if(t.error||t.error_description||t.error_code)throw new yu(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new l1("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new yu("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new l1("No code detected.");const{data:v,error:y}=await this._exchangeCodeForSession(t.code);if(y)throw y;const b=new URL(window.location.href);return b.searchParams.delete("code"),window.history.replaceState(window.history.state,"",b.toString()),{data:{session:v.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:n,access_token:a,refresh_token:i,expires_in:l,expires_at:c,token_type:u}=t;if(!a||!l||!i||!u)throw new yu("No session defined in URL");const d=Math.round(Date.now()/1e3),f=parseInt(l);let h=d+f;c&&(h=parseInt(c));const m=h-d;m*1e3<=Ci&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${m}s, should have been closer to ${f}s`);const x=h-f;d-x>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",x,h,d):d-x<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",x,h,d);const{data:p,error:g}=await this._getUser(a);if(g)throw g;const w={provider_token:s,provider_refresh_token:n,access_token:a,expires_in:f,expires_at:h,refresh_token:i,token_type:u,user:p.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:w,redirectType:t.type},error:null})}catch(s){if(Le(s))return this._returnResult({data:{session:null,redirectType:null},error:s});throw s}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await ja(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var s;const{data:n,error:a}=r;if(a)return this._returnResult({error:a});const i=(s=n.session)===null||s===void 0?void 0:s.access_token;if(i){const{error:l}=await this.admin.signOut(i,t);if(l&&!(n5(l)&&(l.status===404||l.status===401||l.status===403)))return this._returnResult({error:l})}return t!=="others"&&(await this._removeSession(),await Un(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const r=h5(),s={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:s}}}async _emitInitialSession(t){return await this._useSession(async r=>{var s,n;try{const{data:{session:a},error:i}=r;if(i)throw i;await((s=this.stateChangeEmitters.get(t))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",t,"session",a)}catch(a){await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",a),console.error(a)}})}async resetPasswordForEmail(t,r={}){let s=null,n=null;this.flowType==="pkce"&&([s,n]=await _i(this.storage,this.storageKey,!0));try{return await ze(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:s,code_challenge_method:n,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(a){if(Le(a))return this._returnResult({data:null,error:a});throw a}}async getUserIdentities(){var t;try{const{data:r,error:s}=await this.getUser();if(s)throw s;return this._returnResult({data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(r){if(Le(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:s,error:n}=await this._useSession(async a=>{var i,l,c,u,d;const{data:f,error:h}=a;if(h)throw h;const m=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(i=t.options)===null||i===void 0?void 0:i.redirectTo,scopes:(l=t.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=t.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await ze(this.fetch,"GET",m,{headers:this.headers,jwt:(d=(u=f.session)===null||u===void 0?void 0:u.access_token)!==null&&d!==void 0?d:void 0})});if(n)throw n;return dr()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(s==null?void 0:s.url),this._returnResult({data:{provider:t.provider,url:s==null?void 0:s.url},error:null})}catch(s){if(Le(s))return this._returnResult({data:{provider:t.provider,url:null},error:s});throw s}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var s;try{const{error:n,data:{session:a}}=r;if(n)throw n;const{options:i,provider:l,token:c,access_token:u,nonce:d}=t,f=await ze(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(s=a==null?void 0:a.access_token)!==null&&s!==void 0?s:void 0,body:{provider:l,id_token:c,access_token:u,nonce:d,link_identity:!0,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},xform:Bs}),{data:h,error:m}=f;return m?this._returnResult({data:{user:null,session:null},error:m}):!h||!h.session||!h.user?this._returnResult({data:{user:null,session:null},error:new bi}):(h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("USER_UPDATED",h.session)),this._returnResult({data:h,error:m}))}catch(n){if(Le(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var s,n;const{data:a,error:i}=r;if(i)throw i;return await ze(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(n=(s=a.session)===null||s===void 0?void 0:s.access_token)!==null&&n!==void 0?n:void 0})})}catch(r){if(Le(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const s=Date.now();return await g5(async n=>(n>0&&await x5(200*Math.pow(2,n-1)),this._debug(r,"refreshing attempt",n),await ze(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Bs})),(n,a)=>{const i=200*Math.pow(2,n);return a&&Nf(a)&&Date.now()+i-s<Ci})}catch(s){if(this._debug(r,"error",s),Le(s))return this._returnResult({data:{session:null,user:null},error:s});throw s}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const s=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",s),dr()&&!r.skipBrowserRedirect&&window.location.assign(s),{data:{provider:t,url:s},error:null}}async _recoverAndRefresh(){var t,r;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const n=await ja(this.storage,this.storageKey);if(n&&this.userStorage){let i=await ja(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!i&&(i={user:n.user},await Ai(this.userStorage,this.storageKey+"-user",i)),n.user=(t=i==null?void 0:i.user)!==null&&t!==void 0?t:jf()}else if(n&&!n.user&&!n.user){const i=await ja(this.storage,this.storageKey+"-user");i&&(i!=null&&i.user)?(n.user=i.user,await Un(this.storage,this.storageKey+"-user"),await Ai(this.storage,this.storageKey,n)):n.user=jf()}if(this._debug(s,"session from storage",n),!this._isValidSession(n)){this._debug(s,"session is not valid"),n!==null&&await this._removeSession();return}const a=((r=n.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<kf;if(this._debug(s,`session has${a?"":" not"} expired with margin of ${kf}s`),a){if(this.autoRefreshToken&&n.refresh_token){const{error:i}=await this._callRefreshToken(n.refresh_token);i&&(console.error(i),Nf(i)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else if(n.user&&n.user.__isUserNotAvailableProxy===!0)try{const{data:i,error:l}=await this._getUser(n.access_token);!l&&(i!=null&&i.user)?(n.user=i.user,await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(i){console.error("Error getting user data:",i),this._debug(s,"error getting user data, skipping SIGNED_IN notification",i)}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(s,"error",n),console.error(n);return}finally{this._debug(s,"end")}}async _callRefreshToken(t){var r,s;if(!t)throw new ts;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new h0;const{data:a,error:i}=await this._refreshAccessToken(t);if(i)throw i;if(!a.session)throw new ts;await this._saveSession(a.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const l={data:a.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(a){if(this._debug(n,"error",a),Le(a)){const i={data:null,error:a};return Nf(a)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(i),i}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(a),a}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(t,r,s=!0){const n=`#_notifyAllSubscribers(${t})`;this._debug(n,"begin",r,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:t,session:r});const a=[],i=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(t,r)}catch(c){a.push(c)}});if(await Promise.all(i),a.length>0){for(let l=0;l<a.length;l+=1)console.error(a[l]);throw a[0]}}finally{this._debug(n,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const r=Object.assign({},t),s=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!s&&r.user&&await Ai(this.userStorage,this.storageKey+"-user",{user:r.user});const n=Object.assign({},r);delete n.user;const a=h1(n);await Ai(this.storage,this.storageKey,a)}else{const n=h1(r);await Ai(this.storage,this.storageKey,n)}}async _removeSession(){this._debug("#_removeSession()"),await Un(this.storage,this.storageKey),await Un(this.storage,this.storageKey+"-code-verifier"),await Un(this.storage,this.storageKey+"-user"),this.userStorage&&await Un(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&dr()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Ci);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:s}}=r;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((s.expires_at*1e3-t)/Ci);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${Ci}ms, refresh threshold is ${Sm} ticks`),n<=Sm&&await this._callRefreshToken(s.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof Lk)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!dr()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,s){const n=[`provider=${encodeURIComponent(r)}`];if(s!=null&&s.redirectTo&&n.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s!=null&&s.scopes&&n.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[a,i]=await _i(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(i)}`});n.push(l.toString())}if(s!=null&&s.queryParams){const a=new URLSearchParams(s.queryParams);n.push(a.toString())}return s!=null&&s.skipBrowserRedirect&&n.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${t}?${n.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var s;const{data:n,error:a}=r;return a?this._returnResult({data:null,error:a}):await ze(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token})})}catch(r){if(Le(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(t){try{return await this._useSession(async r=>{var s,n;const{data:a,error:i}=r;if(i)return this._returnResult({data:null,error:i});const l=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:c,error:u}=await ze(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(s=a==null?void 0:a.session)===null||s===void 0?void 0:s.access_token});return u?this._returnResult({data:null,error:u}):(t.factorType==="totp"&&c.type==="totp"&&(!((n=c==null?void 0:c.totp)===null||n===void 0)&&n.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),this._returnResult({data:c,error:null}))})}catch(r){if(Le(r))return this._returnResult({data:null,error:r});throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var s;const{data:n,error:a}=r;if(a)return this._returnResult({data:null,error:a});const i=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?G5(t.webauthn.credential_response):K5(t.webauthn.credential_response)})}:{code:t.code}),{data:l,error:c}=await ze(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:i,headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token});return c?this._returnResult({data:null,error:c}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),this._returnResult({data:l,error:c}))})}catch(r){if(Le(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var s;const{data:n,error:a}=r;if(a)return this._returnResult({data:null,error:a});const i=await ze(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token});if(i.error)return i;const{data:l}=i;if(l.type!=="webauthn")return{data:l,error:null};switch(l.webauthn.type){case"create":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:q5(l.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:H5(l.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(Le(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(t){const{data:r,error:s}=await this._challenge({factorId:t.factorId});return s?this._returnResult({data:null,error:s}):await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:s}=await this.getUser();if(s)return{data:null,error:s};const n={all:[],phone:[],totp:[],webauthn:[]};for(const a of(t=r==null?void 0:r.factors)!==null&&t!==void 0?t:[])n.all.push(a),a.status==="verified"&&n[a.factor_type].push(a);return{data:n,error:null}}async _getAuthenticatorAssuranceLevel(){var t,r;const{data:{session:s},error:n}=await this.getSession();if(n)return this._returnResult({data:null,error:n});if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=Ef(s.access_token);let i=null;a.aal&&(i=a.aal);let l=i;((r=(t=s.user.factors)===null||t===void 0?void 0:t.filter(d=>d.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(l="aal2");const u=a.amr||[];return{data:{currentLevel:i,nextLevel:l,currentAuthenticationMethods:u},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async r=>{const{data:{session:s},error:n}=r;return n?this._returnResult({data:null,error:n}):s?await ze(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:s.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new ts})})}catch(r){if(Le(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(t,r){try{return await this._useSession(async s=>{const{data:{session:n},error:a}=s;if(a)return this._returnResult({data:null,error:a});if(!n)return this._returnResult({data:null,error:new ts});const i=await ze(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:n.access_token,body:{action:"approve"},xform:l=>({data:l,error:null})});return i.data&&i.data.redirect_url&&dr()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(i.data.redirect_url),i})}catch(s){if(Le(s))return this._returnResult({data:null,error:s});throw s}}async _denyAuthorization(t,r){try{return await this._useSession(async s=>{const{data:{session:n},error:a}=s;if(a)return this._returnResult({data:null,error:a});if(!n)return this._returnResult({data:null,error:new ts});const i=await ze(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:n.access_token,body:{action:"deny"},xform:l=>({data:l,error:null})});return i.data&&i.data.redirect_url&&dr()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(i.data.redirect_url),i})}catch(s){if(Le(s))return this._returnResult({data:null,error:s});throw s}}async _listOAuthGrants(){try{return await this._useSession(async t=>{const{data:{session:r},error:s}=t;return s?this._returnResult({data:null,error:s}):r?await ze(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:n=>({data:n,error:null})}):this._returnResult({data:null,error:new ts})})}catch(t){if(Le(t))return this._returnResult({data:null,error:t});throw t}}async _revokeOAuthGrant(t){try{return await this._useSession(async r=>{const{data:{session:s},error:n}=r;return n?this._returnResult({data:null,error:n}):s?await ze(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:s.access_token,query:{client_id:t.clientId},xform:()=>({data:{},error:null})}):this._returnResult({data:null,error:new ts})})}catch(r){if(Le(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(t,r={keys:[]}){let s=r.keys.find(l=>l.kid===t);if(s)return s;const n=Date.now();if(s=this.jwks.keys.find(l=>l.kid===t),s&&this.jwks_cached_at+r5>n)return s;const{data:a,error:i}=await ze(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;return!a.keys||a.keys.length===0||(this.jwks=a,this.jwks_cached_at=n,s=a.keys.find(l=>l.kid===t),!s)?null:s}async getClaims(t,r={}){try{let s=t;if(!s){const{data:m,error:x}=await this.getSession();if(x||!m.session)return this._returnResult({data:null,error:x});s=m.session.access_token}const{header:n,payload:a,signature:i,raw:{header:l,payload:c}}=Ef(s);r!=null&&r.allowExpired||k5(a.exp);const u=!n.alg||n.alg.startsWith("HS")||!n.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(n.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!u){const{error:m}=await this.getUser(s);if(m)throw m;return{data:{claims:a,header:n,signature:i},error:null}}const d=N5(n.alg),f=await crypto.subtle.importKey("jwk",u,d,!0,["verify"]);if(!await crypto.subtle.verify(d,f,i,d5(`${l}.${c}`)))throw new Em("Invalid JWT signature");return{data:{claims:a,header:n,signature:i},error:null}}catch(s){if(Le(s))return this._returnResult({data:null,error:s});throw s}}}ic.nextInstanceID={};const sR=ic;class nR extends sR{constructor(t){super(t)}}class aR{constructor(t,r,s){var n,a,i;this.supabaseUrl=t,this.supabaseKey=r;const l=YP(t);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,u={db:VP,realtime:qP,auth:Object.assign(Object.assign({},WP),{storageKey:c}),global:$P},d=QP(s??{},u);this.storageKey=(n=d.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(a=d.global.headers)!==null&&a!==void 0?a:{},d.accessToken?(this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(f,h)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(h)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((i=d.auth)!==null&&i!==void 0?i:{},this.headers,d.global.fetch),this.fetch=KP(r,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.accessToken&&this.accessToken().then(f=>this.realtime.setAuth(f)).catch(f=>console.warn("Failed to set initial Realtime auth token:",f)),this.rest=new JF(new URL("rest/v1",l).href,{headers:this.headers,schema:d.db.schema,fetch:this.fetch}),this.storage=new BP(this.storageUrl.href,this.headers,this.fetch,s==null?void 0:s.storage),d.accessToken||this._listenForAuthEvents()}get functions(){return new XF(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},s={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,r,s)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var t,r;if(this.accessToken)return await this.accessToken();const{data:s}=await this.auth.getSession();return(r=(t=s.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:s,storage:n,userStorage:a,storageKey:i,flowType:l,lock:c,debug:u,throwOnError:d},f,h){const m={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new nR({url:this.authUrl.href,headers:Object.assign(Object.assign({},m),f),storageKey:i,autoRefreshToken:t,persistSession:r,detectSessionInUrl:s,storage:n,userStorage:a,flowType:l,lock:c,debug:u,throwOnError:d,fetch:h,hasCustomAuthorizationHeader:Object.keys(this.headers).some(x=>x.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new pP(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,s)=>{this._handleTokenChanged(r,"CLIENT",s==null?void 0:s.access_token)})}_handleTokenChanged(t,r,s){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==s?(this.changedAccessToken=s,this.realtime.setAuth(s)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const iR=(e,t,r)=>new aR(e,t,r);function oR(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}oR()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const lR="https://cbankidsdfsvsgfygbzt.supabase.co",cR="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNiYW5raWRzZGZzdnNnZnlnYnp0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMzMTk3NDgsImV4cCI6MjA3ODg5NTc0OH0.SXgc-9ZamplKeJm5_nl8J2-UzO7A0f8KbAnPZEmsiSo",se=iR(lR,cR,{auth:{persistSession:!0,autoRefreshToken:!0}}),uR=["your-email@domain.com","backup@domain.com"];function Uk(e){return e?uR.includes(e.toLowerCase()):!1}async function dR(e,t,r,s){const{data:{session:n}}=await se.auth.getSession();if(!n||!Uk(n.user.email)){console.warn("Attempted admin action without super admin access");return}try{const{error:a}=await se.rpc("log_admin_action",{p_admin_email:n.user.email,p_action:e,p_target_type:t||null,p_target_id:r||null,p_details:s||{}});a&&console.error("Failed to log admin action:",a)}catch(a){console.error("Error logging admin action:",a)}}async function fR(){const{data:e,error:t}=await se.from("admin_organisations_dashboard").select("*").order("created_at",{ascending:!1});if(t)throw t;return e||[]}async function hR(e){let t=se.from("admin_global_quotes").select("*").order("created_at",{ascending:!1});const{data:r,error:s}=await t.limit(1e3);if(s)throw s;return r||[]}async function mR(e,t){const{data:{session:r}}=await se.auth.getSession();if(!(r!=null&&r.user.email))throw new Error("Not authenticated");const{data:s,error:n}=await se.rpc("admin_extend_trial",{p_admin_email:r.user.email,p_org_id:e,p_days:t});if(n)throw n;return{success:s.success,newTrialEndDate:s.new_trial_end_date}}async function pR(e,t){const{data:{session:r}}=await se.auth.getSession();if(!(r!=null&&r.user.email))throw new Error("Not authenticated");const{data:s,error:n}=await se.rpc("admin_update_subscription",{p_admin_email:r.user.email,p_org_id:e,p_new_status:t});if(n)throw n;return{success:s.success,newStatus:s.new_status}}async function xR(e){await dR("impersonate_org","organisation",e),localStorage.setItem("admin_impersonate_org",e),window.location.href="/dashboard"}async function gR(){localStorage.removeItem("admin_impersonate_org"),window.location.href="/admin/dashboard"}function vR(){return localStorage.getItem("admin_impersonate_org")}function yR(){return!!localStorage.getItem("admin_impersonate_org")}async function wR(e,t){const{data:{session:r}}=await se.auth.getSession();if(!(r!=null&&r.user.email))throw new Error("Not authenticated");const{data:s,error:n}=await se.rpc("admin_add_trade_license",{p_admin_email:r.user.email,p_org_id:e,p_trade:t});if(n)throw n;return{success:s.success,message:s.message,licensedTrades:s.licensed_trades}}async function bR(e,t){const{data:{session:r}}=await se.auth.getSession();if(!(r!=null&&r.user.email))throw new Error("Not authenticated");const{data:s,error:n}=await se.rpc("admin_remove_trade_license",{p_admin_email:r.user.email,p_org_id:e,p_trade:t});if(n)throw n;return{success:s.success,message:s.message,licensedTrades:s.licensed_trades}}const Ex={passive_fire:"PassiveFire Verify+",electrical:"Electrical Verify+",plumbing:"Plumbing Verify+",mechanical:"Mechanical Verify+",other:"Other"},Hs=[{value:"passive_fire",label:"PassiveFire Verify+",price:299,color:"orange"},{value:"electrical",label:"Electrical Verify+",price:349,color:"yellow"},{value:"plumbing",label:"Plumbing Verify+",price:329,color:"blue"},{value:"mechanical",label:"Mechanical Verify+",price:399,color:"green"}];function _R({currentTrades:e,subscriptionStatus:t,onDismiss:r}){const[s,n]=j.useState(!1);if(s||e.length>=4||t==="trial")return null;const a=Hs.filter(m=>!e.includes(m.value));if(a.length===0)return null;const i=()=>{const m=e.reduce((x,p)=>{const g=Hs.find(w=>w.value===p);return x+((g==null?void 0:g.price)||0)},0);return e.length===2?m*.85:e.length===3?m*.75:m},l=m=>{const x=e.length+m,p=e.reduce((g,w)=>{const v=Hs.find(y=>y.value===w);return g+((v==null?void 0:v.price)||0)},0)+a.slice(0,m).reduce((g,w)=>g+w.price,0);return x===2?p*.85:x===3?p*.75:x>=4?p*.65:p},c=i(),u=l(a.length),d=u-c,f=()=>{n(!0),r&&r()},h=()=>{alert(`Contact your account manager to add trades to your license.

Or email: support@verifyhub.com`)};return o.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 text-white px-6 py-4 shadow-lg",children:o.jsxs("div",{className:"max-w-7xl mx-auto flex items-center justify-between gap-4",children:[o.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[o.jsx("div",{className:"hidden md:flex items-center justify-center w-12 h-12 bg-white/20 rounded-full",children:o.jsx(si,{size:24})}),o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"font-bold text-lg mb-1",children:["Unlock ",a.length," More Trade",a.length>1?"s":""]}),o.jsxs("div",{className:"text-blue-100 text-sm",children:["Add ",a.slice(0,3).map(m=>{var x;return(x=Ex[m.value])==null?void 0:x.replace(" Verify+","")}).join(", "),a.length>3&&` + ${a.length-3} more`," ","for only ",o.jsxs("span",{className:"font-bold text-white",children:["$",Math.round(d),"/mo more"]})," "," Total $",Math.round(u),"/mo",e.length+a.length>=4&&o.jsx("span",{className:"ml-1",children:"(35% bundle discount)"})]})]})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("button",{onClick:h,className:"px-6 py-2 bg-white text-blue-700 rounded-md hover:bg-blue-50 font-semibold transition-colors whitespace-nowrap",children:"Upgrade Now"}),o.jsx("button",{onClick:f,className:"p-2 hover:bg-white/10 rounded transition-colors",title:"Dismiss",children:o.jsx(ps,{size:20})})]})]})})}const zk=j.createContext(void 0);function SR({children:e}){const[t,r]=j.useState(null),[s,n]=j.useState([]),[a,i]=j.useState(!0);j.useEffect(()=>{l()},[]);const l=async()=>{i(!0);const{data:{user:f}}=await se.auth.getUser();if(!f){i(!1);return}const h=vR();if(h){const{data:x}=await se.from("organisations").select("*").eq("id",h).single();if(x){n([x]),r(x),i(!1);return}}const{data:m}=await se.from("organisation_members").select("organisation_id, organisations(*)").eq("user_id",f.id);if(m){const x=m.map(g=>g.organisations).filter(Boolean);n(x);const p=localStorage.getItem("passivefire_current_organisation_id");if(p){const g=x.find(w=>w.id===p);g?r(g):x.length>0&&(r(x[0]),localStorage.setItem("passivefire_current_organisation_id",x[0].id))}else x.length>0&&(r(x[0]),localStorage.setItem("passivefire_current_organisation_id",x[0].id))}i(!1)},c=async()=>{await l()},u=f=>{r(f),f?localStorage.setItem("passivefire_current_organisation_id",f.id):localStorage.removeItem("passivefire_current_organisation_id")},d=f=>!0;return o.jsx(zk.Provider,{value:{currentOrganisation:t,organisations:s,loading:a,setCurrentOrganisation:u,refreshOrganisations:c,hasPermission:d},children:e})}function wa(){const e=j.useContext(zk);if(e===void 0)throw new Error("useOrganisation must be used within an OrganisationProvider");return e}const kR=[{id:"dashboard",label:"Project Dashboard",icon:cm},{id:"quotes",label:"Import Quotes",icon:Yr},{id:"review",label:"Review & Clean",icon:_F},{id:"quoteintel",label:"Quote Intelligence",icon:d0},{id:"scope",label:"Scope Matrix",icon:CF},{id:"reports",label:"Reports",icon:TS},{id:"contract",label:"Contract Manager",icon:wF},{id:"settings",label:"Settings",icon:dm,requiresManagePermission:!0}];function NR({activeTab:e,onTabChange:t,projectId:r}){const[s,n]=j.useState(!1),{hasPermission:a}=wa();return o.jsxs("div",{className:`${s?"w-20":"w-64"} bg-white border-r border-gray-200 flex flex-col transition-all duration-200 relative`,children:[o.jsx("div",{className:"p-4 border-b border-gray-200",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-8 h-8 bg-brand-primary rounded-lg flex items-center justify-center flex-shrink-0",children:o.jsx(EF,{className:"w-5 h-5 text-white"})}),!s&&o.jsxs("div",{children:[o.jsx("h1",{className:"text-[14px] font-bold brand-navy leading-tight",children:"PassiveFire"}),o.jsx("p",{className:"text-[11px] text-gray-600",children:"Verify+"})]})]})}),o.jsx("nav",{className:"flex-1 p-2 space-y-0.5",children:kR.map(i=>{if(i.requiresManagePermission&&!a("manage"))return null;const l=i.icon,c=e===i.id;return o.jsxs("button",{onClick:()=>t(i.id),className:`
                w-full flex items-center gap-3 px-3 py-2 rounded-md text-[14px] font-medium transition-all
                ${c?"bg-orange-50 brand-primary":"text-gray-700 hover:bg-gray-50"}
                ${s?"justify-center":""}
              `,title:s?i.label:void 0,children:[o.jsx(l,{size:18,className:"flex-shrink-0"}),!s&&o.jsx("span",{children:i.label})]},i.id)})}),o.jsx("button",{onClick:()=>n(!s),className:"absolute -right-3 top-20 w-6 h-6 bg-white border border-gray-200 rounded-full flex items-center justify-center hover:bg-gray-50 transition-colors shadow-sm",children:s?o.jsx(Fc,{size:14}):o.jsx(AS,{size:14})})]})}function ER({currentProjectId:e,currentProjectName:t,onProjectChange:r,onBackToDashboard:s,notificationCount:n=0,onNavigateToAccount:a,onSwitchOrganisation:i}){const[l,c]=j.useState([]),[u,d]=j.useState(!1),[f,h]=j.useState(!1),[m,x]=j.useState(""),{currentOrganisation:p}=wa();j.useEffect(()=>{g(),w()},[p]);const g=async()=>{if(!p)return;const{data:y}=await se.from("projects").select("id, name, client, reference").eq("organisation_id",p.id).order("updated_at",{ascending:!1});y&&c(y)},w=async()=>{const{data:y}=await se.auth.getUser();y.user&&x(y.user.email||"")},v=async()=>{await se.auth.signOut(),window.location.href="/"};return o.jsx("header",{className:"bg-white border-b border-gray-200 px-6 py-4",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"PassiveFire Verify+"}),p&&o.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[o.jsx(yo,{size:16}),o.jsx("span",{children:p.name})]}),e&&o.jsxs("div",{className:"relative",children:[o.jsxs("button",{onClick:()=>d(!u),className:"flex items-center gap-2 px-3 py-2 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:[o.jsx("span",{className:"font-medium",children:t||"Select Project"}),o.jsx(ri,{size:16})]}),u&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>d(!1)}),o.jsx("div",{className:"absolute top-full left-0 mt-2 w-64 bg-white rounded-lg shadow-lg border border-gray-200 z-20 max-h-96 overflow-y-auto",children:o.jsxs("div",{className:"p-2",children:[o.jsx("button",{onClick:()=>{s(),d(!1)},className:"w-full text-left px-3 py-2 hover:bg-gray-100 rounded-lg text-sm font-medium text-blue-600",children:"All Projects"}),o.jsx("div",{className:"border-t border-gray-200 my-2"}),l.map(y=>o.jsxs("button",{onClick:()=>{r(y.id),d(!1)},className:`w-full text-left px-3 py-2 hover:bg-gray-100 rounded-lg text-sm ${y.id===e?"bg-blue-50 text-blue-600":""}`,children:[o.jsx("div",{className:"font-medium",children:y.name}),y.client&&o.jsx("div",{className:"text-xs text-gray-500",children:y.client})]},y.id))]})})]})]})]}),o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsxs("button",{className:"relative p-2 hover:bg-gray-100 rounded-lg transition-colors",children:[o.jsx(vF,{size:20}),n>0&&o.jsx("span",{className:"absolute top-1 right-1 w-4 h-4 bg-red-500 text-white text-xs rounded-full flex items-center justify-center",children:n})]}),o.jsxs("div",{className:"relative",children:[o.jsxs("button",{onClick:()=>h(!f),className:"flex items-center gap-2 p-2 hover:bg-gray-100 rounded-lg transition-colors",children:[o.jsx(xx,{size:20}),o.jsx(ri,{size:16})]}),f&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>h(!1)}),o.jsxs("div",{className:"absolute top-full right-0 mt-2 w-64 bg-white rounded-lg shadow-lg border border-gray-200 z-20",children:[o.jsxs("div",{className:"p-4 border-b border-gray-200",children:[o.jsx("div",{className:"text-sm font-medium text-gray-900",children:m}),p&&o.jsx("div",{className:"text-xs text-gray-500 mt-1",children:p.name})]}),o.jsxs("div",{className:"p-2",children:[o.jsx("button",{onClick:()=>{a(),h(!1)},className:"w-full text-left px-3 py-2 hover:bg-gray-100 rounded-lg text-sm",children:"Account Settings"}),o.jsx("button",{onClick:()=>{i(),h(!1)},className:"w-full text-left px-3 py-2 hover:bg-gray-100 rounded-lg text-sm",children:"Switch Organisation"}),o.jsx("div",{className:"border-t border-gray-200 my-2"}),o.jsx("button",{onClick:v,className:"w-full text-left px-3 py-2 hover:bg-gray-100 rounded-lg text-sm text-red-600",children:"Sign Out"})]})]})]})]})]})]})})}function ua({title:e,subtitle:t,metadata:r}){return o.jsxs("div",{className:"flex items-start justify-between mb-3",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-[30px] font-bold text-gray-900 mb-1",children:e}),o.jsx("p",{className:"text-[14px] text-gray-600",children:t})]}),r&&r.length>0&&o.jsx("div",{className:"flex items-center gap-2",children:r.map((s,n)=>o.jsxs("div",{className:"px-3 py-1.5 rounded-full bg-gray-100 border border-gray-200 text-xs",children:[o.jsxs("span",{className:"text-gray-600",children:[s.label,":"]})," ",o.jsx("span",{className:"font-medium text-gray-900",children:s.value})]},n))})]})}const $k=[{id:"import",name:"Import Quotes",route:"quotes",description:"Import quotes from suppliers"},{id:"review",name:"Review & Clean",route:"review-clean",description:"Review and clean imported data"},{id:"matrix",name:"Scope Matrix",route:"scope-matrix",description:"Build and analyze scope matrix"},{id:"intelligence",name:"Quote Intelligence",route:"quote-intelligence",description:"AI-powered quote analysis"},{id:"reports",name:"Reports",route:"reports",description:"Generate award and analysis reports"}],w1=$k.length;function tn({projectId:e,projectName:t,allProjects:r,onProjectSelect:s,onCreateProject:n,onNavigateToQuotes:a,onNavigateToMatrix:i,onNavigateToReports:l}){const{currentOrganisation:c}=wa(),[u,d]=j.useState(!1),[f,h]=j.useState(""),[m,x]=j.useState(""),[p,g]=j.useState(""),[w,v]=j.useState(!1),[y,b]=j.useState(!0),[S,k]=j.useState({quoteCount:0,supplierCount:0,systemsDetected:0,systemsCovered:0,coveragePercent:0,completedSteps:0,totalSteps:w1,hasQuotes:!1,hasReviewedItems:!1,hasScopeMatrix:!1,hasReports:!1}),[_,N]=j.useState([]);j.useEffect(()=>{e?C():b(!1)},[e]);const C=async()=>{if(e){b(!0);try{const{data:q}=await se.from("quotes").select("id, supplier_name").eq("project_id",e),X=(q==null?void 0:q.length)||0,ie=new Set(q==null?void 0:q.map(ge=>ge.supplier_name)).size,{data:W}=await se.from("quote_items").select("system_id, quote_id").in("quote_id",(q==null?void 0:q.map(ge=>ge.id))||[]),U=(W==null?void 0:W.filter(ge=>ge.system_id).map(ge=>ge.system_id))||[],be=new Set(U).size,M=new Set((W==null?void 0:W.filter(ge=>ge.system_id).map(ge=>ge.system_id))||[]).size,O=be>0?Math.round(M/be*100):0,{data:z}=await se.from("project_settings").select("*").eq("project_id",e).maybeSingle(),{data:J}=await se.from("award_reports").select("id").eq("project_id",e).eq("status","ready"),pe={quoteCount:X,supplierCount:ie,systemsDetected:be,systemsCovered:M,coveragePercent:O,completedSteps:0,totalSteps:w1,hasQuotes:X>0,hasReviewedItems:(z==null?void 0:z.review_clean_completed)||!1,hasScopeMatrix:(z==null?void 0:z.scope_matrix_completed)||!1,hasReports:((J==null?void 0:J.length)||0)>0};k(pe),B(pe)}catch(q){console.error("Error loading project data:",q)}finally{b(!1)}}},B=q=>{const X=$k.map(W=>{let U="not_started";switch(W.id){case"import":U=q.hasQuotes?"completed":"not_started";break;case"review":U=q.hasReviewedItems?"completed":q.hasQuotes?"in_progress":"not_started";break;case"matrix":U=q.hasScopeMatrix?"completed":q.hasReviewedItems?"in_progress":"not_started";break;case"intelligence":U=q.hasReviewedItems?"completed":"not_started";break;case"reports":U=q.hasReports?"completed":"not_started";break}return{id:W.id,name:W.name,status:U,route:W.route}}),ie=X.filter(W=>W.status==="completed").length;k(W=>({...W,completedSteps:ie})),N(X)},H=q=>{switch(q){case"quotes":a();break;case"scope-matrix":i();break;case"reports":l();break;default:console.log("Navigation to",q,"not yet implemented")}},V=()=>{d(!0)},K=()=>{d(!1),h(""),x(""),g("")},Y=async q=>{if(q.preventDefault(),!f.trim())return;v(!0);const X=await n(f,m,p);v(!1),X&&K()};return o.jsx("div",{className:"min-h-screen bg-gray-50",children:o.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-6",children:[e&&o.jsx("div",{className:"mb-3",children:o.jsxs("div",{className:"text-xs text-gray-500 mb-1",children:["Projects > ",t]})}),o.jsx(ua,{title:e?t||"Project Dashboard":"All Projects",subtitle:e?"Manage your quote analysis workflow":"Select or create a project"}),e?y?o.jsx("div",{className:"flex items-center justify-center py-12",children:o.jsx("div",{className:"text-gray-400",children:"Loading project dashboard..."})}):o.jsxs("div",{className:"mt-3 space-y-3",children:[o.jsxs("div",{className:"flex items-center justify-between py-2 px-4 bg-white border-b border-gray-200",children:[o.jsxs("div",{className:"flex items-center gap-2 text-[13px] text-gray-600",children:[o.jsx(yo,{size:14}),o.jsx("span",{children:(c==null?void 0:c.name)||"Loading..."})]}),o.jsxs("div",{className:"flex items-center gap-2 text-[13px] text-gray-500",children:[o.jsx(c0,{size:13}),o.jsxs("span",{children:["Last updated: ",new Date().toLocaleDateString()]})]})]}),o.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3",children:[o.jsxs("div",{className:"flex items-center gap-3 py-2 px-3 bg-gray-50 rounded-lg",children:[o.jsx("div",{className:"p-2 bg-blue-50 rounded",children:o.jsx(Yr,{className:"text-blue-600",size:18})}),o.jsxs("div",{children:[o.jsx("div",{className:"text-[13px] text-gray-600 font-medium",children:"Quotes Imported"}),o.jsx("div",{className:"text-2xl font-bold text-gray-900",children:S.quoteCount}),o.jsxs("div",{className:"text-[11px] text-gray-500",children:["from ",S.supplierCount," ",S.supplierCount===1?"supplier":"suppliers"]})]})]}),o.jsxs("div",{className:"flex items-center gap-3 py-2 px-3 bg-gray-50 rounded-lg",children:[o.jsx("div",{className:"p-2 bg-violet-50 rounded",children:o.jsx(PF,{className:"text-violet-600",size:18})}),o.jsxs("div",{children:[o.jsx("div",{className:"text-[13px] text-gray-600 font-medium",children:"Systems Detected"}),o.jsx("div",{className:"text-2xl font-bold text-gray-900",children:S.systemsDetected}),o.jsx("div",{className:"text-[11px] text-gray-500",children:"Unique systems in project"})]})]}),o.jsxs("div",{className:"flex items-center gap-3 py-2 px-3 bg-gray-50 rounded-lg",children:[o.jsx("div",{className:`p-2 rounded ${S.coveragePercent>=80?"bg-green-50":S.coveragePercent>=50?"bg-amber-50":"bg-red-50"}`,children:o.jsx(fm,{className:S.coveragePercent>=80?"text-green-600":S.coveragePercent>=50?"text-amber-600":"text-red-600",size:18})}),o.jsxs("div",{children:[o.jsx("div",{className:"text-[13px] text-gray-600 font-medium",children:"Coverage"}),o.jsxs("div",{className:`text-2xl font-bold ${S.coveragePercent>=80?"text-green-600":S.coveragePercent>=50?"text-amber-600":"text-red-600"}`,children:[S.coveragePercent,"%"]}),o.jsxs("div",{className:"text-[11px] text-gray-500",children:[S.systemsCovered,"/",S.systemsDetected," systems covered"]})]})]}),o.jsxs("div",{className:"flex items-center gap-3 py-2 px-3 bg-gray-50 rounded-lg",children:[o.jsx("div",{className:"p-2 bg-blue-50 rounded",children:o.jsx(tr,{className:"text-blue-600",size:18})}),o.jsxs("div",{children:[o.jsx("div",{className:"text-[13px] text-gray-600 font-medium",children:"Progress"}),o.jsxs("div",{className:"text-2xl font-bold text-gray-900",children:[S.completedSteps,"/",S.totalSteps]}),o.jsx("div",{className:"text-[11px] text-gray-500",children:"Steps completed"})]})]})]})}),o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200",children:[o.jsx("div",{className:"px-4 py-3 border-b border-gray-200",children:o.jsx("h2",{className:"text-[20px] font-semibold text-gray-900",children:"Project Workflow"})}),o.jsx("div",{children:_.map((q,X)=>{const ie=q.status==="completed",W=!ie;return o.jsxs("div",{onClick:W?()=>H(q.route):void 0,className:`w-full flex items-center gap-3 py-3 px-4 border-b border-gray-100 last:border-b-0 ${W?"cursor-pointer hover:bg-gray-50 group":"cursor-default"} transition-colors`,children:[ie?o.jsx(tr,{size:16,className:"text-green-600 flex-shrink-0"}):o.jsx("div",{className:"flex items-center justify-center w-6 h-6 rounded-full bg-gray-100 text-[11px] font-semibold text-gray-600 group-hover:bg-blue-100 group-hover:text-blue-600 transition-colors flex-shrink-0",children:X+1}),o.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[q.status==="in_progress"?o.jsx(Wy,{className:"text-blue-600 fill-blue-100 flex-shrink-0",size:18}):q.status==="not_started"?o.jsx(Wy,{className:"text-gray-400 flex-shrink-0",size:18}):null,o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:"font-medium text-gray-900 text-[15px]",children:q.name}),o.jsx("div",{className:"text-[11px] text-gray-500 capitalize",children:q.status.replace("_"," ")})]})]}),W&&o.jsx(Gu,{className:"text-gray-400 group-hover:text-blue-600 transition-colors flex-shrink-0",size:14})]},q.id)})})]})]}):o.jsxs("div",{className:"mt-6",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[o.jsxs("button",{onClick:V,className:"p-6 border-2 border-dashed border-gray-300 rounded-xl hover:border-blue-500 hover:bg-blue-50 transition-colors",children:[o.jsx(u0,{className:"mx-auto mb-2 text-gray-400",size:32}),o.jsx("div",{className:"font-medium",children:"Create New Project"})]}),r.map(q=>o.jsxs("button",{onClick:()=>s(q.id),className:"p-6 bg-white border border-gray-200 rounded-xl hover:border-blue-500 hover:shadow-lg transition-all text-left",children:[o.jsx(jF,{className:"mb-2 text-blue-600",size:24}),o.jsx("div",{className:"font-semibold text-gray-900 mb-1",children:q.name}),o.jsx("div",{className:"text-sm text-gray-500",children:q.client_reference})]},q.id))]}),u&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 w-full max-w-md",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Create New Project"}),o.jsx("button",{onClick:K,className:"text-gray-400 hover:text-gray-600 transition-colors",children:o.jsx(ps,{size:24})})]}),o.jsxs("form",{onSubmit:Y,children:[o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsxs("label",{htmlFor:"projectName",className:"block text-sm font-medium text-gray-700 mb-1",children:["Project Name ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{id:"projectName",type:"text",value:f,onChange:q=>h(q.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white text-gray-900",placeholder:"Enter project name",required:!0,autoFocus:!0})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"projectClient",className:"block text-sm font-medium text-gray-700 mb-1",children:"Client Name"}),o.jsx("input",{id:"projectClient",type:"text",value:m,onChange:q=>x(q.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white text-gray-900",placeholder:"Enter client name"})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"projectReference",className:"block text-sm font-medium text-gray-700 mb-1",children:"Project Reference"}),o.jsx("input",{id:"projectReference",type:"text",value:p,onChange:q=>g(q.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white text-gray-900",placeholder:"Enter project reference"})]})]}),o.jsxs("div",{className:"flex gap-3 mt-6",children:[o.jsx("button",{type:"button",onClick:K,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",disabled:w,children:"Cancel"}),o.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed",disabled:w||!f.trim(),children:w?"Creating...":"Create Project"})]})]})]})})]})]})})}async function jR(e){return console.log("PDF Parser not fully implemented",e.name),{pages:[],text:"",metadata:{}}}async function TR(e){return console.log("Excel Parser not fully implemented",e.name),{sheets:[],data:[]}}async function CR(e){return console.log("CSV Parser not fully implemented",e.name),{data:[]}}function AR({value:e,onChange:t,error:r}){return o.jsxs("div",{className:"w-full",children:[o.jsx("input",{type:"text",value:e,onChange:s=>t(s.target.value),placeholder:"Supplier name...",className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 bg-white text-gray-900 ${r?"border-red-500":"border-gray-300"}`}),r&&o.jsx("p",{className:"text-sm text-red-500 mt-1",children:r})]})}const FR=[{name:"Electrical Services",enabled:!0,count:0},{name:"Fire Protection Services",enabled:!0,count:0},{name:"Hydraulics Services",enabled:!0,count:0},{name:"Mechanical Services",enabled:!0,count:0},{name:"Structural Penetrations",enabled:!0,count:0},{name:"Passive Fire (General)",enabled:!0,count:0},{name:"Optional Extras",enabled:!1,count:0},{name:"Excluded",enabled:!1,count:0},{name:"Summary Blocks",enabled:!1,count:0},{name:"Admin / Notes / T&Cs",enabled:!1,count:0}];function PR({projectId:e,lines:t,summaryBlocks:r,supplierName:s,onSupplierNameChange:n,onLineUpdate:a,onSave:i,onCancel:l,isSaving:c=!1,demoMode:u=!1}){console.log("[ImportPreviewNew] Rendering with",t.length,"lines"),console.log("[ImportPreviewNew] Supplier name:",s);const[d,f]=j.useState(()=>{const K=new Set(t.map(Y=>Y.section));return console.log("[ImportPreviewNew] All unique sections in lines:",Array.from(K)),console.log("[ImportPreviewNew] Lines sample:",t.slice(0,5).map(Y=>({section:Y.section,desc:Y.description.substring(0,50)}))),FR.map(Y=>{const q=t.filter(X=>X.section===Y.name).length;return console.log(`[ImportPreviewNew] Section "${Y.name}": ${q} items`),{...Y,count:q}})}),[h,m]=j.useState(!1),[x,p]=j.useState(null),[g,w]=j.useState({}),[v,y]=j.useState(!0),b=j.useMemo(()=>{let K=t.filter(Y=>{const q=d.find(X=>X.name===Y.section);return(q==null?void 0:q.enabled)??!1});return h&&(K=K.filter(Y=>Y.flags.length>0)),K.sort((Y,q)=>Y.flags.length>0&&q.flags.length===0?-1:Y.flags.length===0&&q.flags.length>0?1:0)},[t,d,h]),S=j.useMemo(()=>{const K=t.filter(ie=>ie.flags.length===0).length,Y=t.filter(ie=>ie.flags.length>0).length,q=t.filter(ie=>!ie.unit||!ie.size||!ie.qty).length,X=b.reduce((ie,W)=>ie+(W.total||0),0);return{detectedLines:K,flaggedLines:Y,gapLines:q,selectedCount:b.length,selectedSum:X}},[t,b]),k=K=>{f(Y=>Y.map(q=>q.name===K?{...q,enabled:!q.enabled}:q))},_=()=>{f(K=>K.map(Y=>({...Y,enabled:!0})))},N=()=>{f(K=>K.map(Y=>({...Y,enabled:!1})))},C=K=>{p(K.id),w({...K})},B=()=>{x&&g&&(a(x,g),p(null),w({}))},H=()=>{p(null),w({})},V=()=>{i(b)};return o.jsxs("div",{className:"flex gap-6 h-[calc(100vh-12rem)]",children:[o.jsxs("div",{className:"w-64 flex-shrink-0 bg-white rounded-lg shadow-sm border border-gray-200 p-4 overflow-y-auto",children:[o.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-4",children:"Include in schedule"}),o.jsx("div",{className:"space-y-2",children:d.map(K=>o.jsxs("label",{className:"flex items-center justify-between p-2 hover:bg-gray-50 rounded cursor-pointer group",children:[o.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[o.jsx("input",{type:"checkbox",checked:K.enabled,onChange:()=>k(K.name),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500 flex-shrink-0"}),o.jsx("span",{className:"text-xs text-gray-700 truncate",title:K.name,children:K.name})]}),o.jsx("span",{className:"text-xs font-medium text-gray-500 ml-2 flex-shrink-0",children:K.count})]},K.name))})]}),o.jsxs("div",{className:"flex-1 flex flex-col min-w-0 gap-4",children:[o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:[o.jsx("div",{className:"flex items-center justify-between mb-4",children:o.jsx("div",{className:"flex-1 max-w-md",children:o.jsx(AR,{projectId:e,value:s,onChange:n,error:!s.trim()&&b.length>0?"Supplier name is required":void 0})})}),o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-green-50 border border-green-200 rounded-md",children:[o.jsx(tr,{size:16,className:"text-green-600"}),o.jsxs("span",{className:"text-sm font-medium text-green-900",children:[S.detectedLines," Detected"]})]}),o.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-amber-50 border border-amber-200 rounded-md",children:[o.jsx(Je,{size:16,className:"text-amber-600"}),o.jsxs("span",{className:"text-sm font-medium text-amber-900",children:[S.flaggedLines," Flagged"]})]}),o.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-blue-50 border border-blue-200 rounded-md",children:[o.jsx(PS,{size:16,className:"text-blue-600"}),o.jsxs("span",{className:"text-sm font-medium text-blue-900",children:[S.gapLines," Gaps"]})]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("button",{onClick:_,className:"px-3 py-1.5 text-xs font-medium text-blue-600 hover:bg-blue-50 rounded-md transition-colors",children:"Select All"}),o.jsx("button",{onClick:N,className:"px-3 py-1.5 text-xs font-medium text-gray-600 hover:bg-gray-50 rounded-md transition-colors",children:"Select None"}),o.jsx("button",{onClick:()=>m(!h),className:`px-3 py-1.5 text-xs font-medium rounded-md transition-colors ${h?"bg-amber-100 text-amber-900":"text-gray-600 hover:bg-gray-50"}`,children:"Show Flagged Only"})]})]})]}),o.jsx("div",{className:"flex-1 bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden flex flex-col",children:o.jsx("div",{className:"flex-1 overflow-auto",children:o.jsxs("table",{className:"w-full",children:[o.jsx("thead",{className:"bg-gray-50 border-b border-gray-200 sticky top-0",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Section"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Description"}),o.jsx("th",{className:"px-3 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Qty"}),o.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Unit"}),o.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Rate"}),o.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Total"}),o.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Flags"}),o.jsx("th",{className:"px-3 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),o.jsx("tbody",{className:"divide-y divide-gray-200",children:b.map(K=>o.jsx("tr",{className:`${K.flags.length>0?"bg-amber-50":""} ${x===K.id?"bg-blue-50":""}`,children:x===K.id?o.jsxs(o.Fragment,{children:[o.jsx("td",{className:"px-3 py-2",children:o.jsx("input",{type:"text",value:g.section||"",onChange:Y=>w({...g,section:Y.target.value}),className:"w-full px-2 py-1 border border-gray-300 rounded text-xs"})}),o.jsx("td",{className:"px-4 py-2",children:o.jsx("input",{type:"text",value:g.description||"",onChange:Y=>w({...g,description:Y.target.value}),className:"w-full px-2 py-1 border border-gray-300 rounded text-xs"})}),o.jsx("td",{className:"px-3 py-2",children:o.jsx("input",{type:"number",value:g.qty||"",onChange:Y=>w({...g,qty:parseFloat(Y.target.value)||void 0}),className:"w-16 px-2 py-1 border border-gray-300 rounded text-xs text-right"})}),o.jsx("td",{className:"px-3 py-2",children:o.jsx("input",{type:"text",value:g.unit||"",onChange:Y=>w({...g,unit:Y.target.value}),className:"w-16 px-2 py-1 border border-gray-300 rounded text-xs"})}),o.jsx("td",{className:"px-4 py-2",children:o.jsx("input",{type:"number",value:g.rate||"",onChange:Y=>w({...g,rate:parseFloat(Y.target.value)||void 0}),className:"w-20 px-2 py-1 border border-gray-300 rounded text-xs text-right"})}),o.jsx("td",{className:"px-4 py-2",children:o.jsx("input",{type:"number",value:g.total||"",onChange:Y=>w({...g,total:parseFloat(Y.target.value)||void 0}),className:"w-20 px-2 py-1 border border-gray-300 rounded text-xs text-right"})}),o.jsx("td",{className:"px-3 py-2"}),o.jsx("td",{className:"px-3 py-2",children:o.jsxs("div",{className:"flex items-center justify-center gap-1",children:[o.jsx("button",{onClick:B,className:"p-1 text-green-600 hover:bg-green-50 rounded",title:"Save",children:o.jsx(um,{size:14})}),o.jsx("button",{onClick:H,className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"Cancel",children:o.jsx(ps,{size:14})})]})})]}):o.jsxs(o.Fragment,{children:[o.jsx("td",{className:"px-3 py-2 text-xs text-gray-600",children:K.section}),o.jsx("td",{className:"px-4 py-2 text-xs text-gray-900",children:K.description}),o.jsx("td",{className:"px-3 py-2 text-xs text-gray-900 text-right",children:K.qty||"-"}),o.jsx("td",{className:"px-3 py-2 text-xs text-gray-600",children:K.unit||"-"}),o.jsx("td",{className:"px-4 py-2 text-xs text-gray-900 text-right",children:K.rate?`$${K.rate.toFixed(2)}`:"-"}),o.jsx("td",{className:"px-4 py-2 text-xs text-gray-900 text-right font-medium",children:K.total?`$${K.total.toFixed(2)}`:"-"}),o.jsx("td",{className:"px-3 py-2",children:o.jsx("div",{className:"flex flex-wrap gap-1",children:K.flags.map((Y,q)=>o.jsx("span",{className:"px-1.5 py-0.5 text-[10px] font-medium bg-amber-100 text-amber-800 rounded",children:Y},q))})}),o.jsx("td",{className:"px-3 py-2",children:o.jsx("button",{onClick:()=>C(K),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",title:"Edit",children:o.jsx(IS,{size:14})})})]})},K.id))})]})})}),o.jsxs("div",{className:"flex items-center justify-between bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:[o.jsxs("div",{className:"flex items-center gap-6",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-xs text-gray-500",children:"Selected Lines"}),o.jsx("p",{className:"text-lg font-bold text-gray-900",children:S.selectedCount})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-xs text-gray-500",children:"Selected Sum"}),o.jsxs("p",{className:"text-lg font-bold text-green-600",children:["$",S.selectedSum.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("button",{onClick:l,className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 transition-colors",children:"Cancel"}),o.jsxs("button",{onClick:V,disabled:!s.trim()||b.length===0||c||u,className:"flex items-center gap-2 px-8 py-3 bg-gradient-to-r from-green-600 to-green-500 text-white text-lg font-bold rounded-lg hover:from-green-700 hover:to-green-600 shadow-lg hover:shadow-xl transition-all disabled:bg-gray-400 disabled:cursor-not-allowed transform hover:scale-105",children:[o.jsx(mx,{size:20}),c?"Saving...":u?"Demo Mode":"Proceed with Mapping"]})]})]})]}),r.length>0&&o.jsxs("div",{className:"w-64 flex-shrink-0 bg-white rounded-lg shadow-sm border border-gray-200 p-4 overflow-y-auto",children:[o.jsxs("button",{onClick:()=>y(!v),className:"flex items-center justify-between w-full mb-3",children:[o.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Quote Summary"}),v?o.jsx(ri,{size:16}):o.jsx(Fc,{size:16})]}),v&&o.jsx("div",{className:"space-y-2",children:r.map((K,Y)=>o.jsxs("div",{className:`flex justify-between items-center py-2 px-3 rounded ${K.type==="grand_total"?"bg-blue-50 border border-blue-200":"bg-gray-50"}`,children:[o.jsx("span",{className:`text-xs ${K.type==="grand_total"?"font-semibold text-gray-900":"text-gray-600"}`,children:K.label}),o.jsxs("span",{className:`text-xs font-medium ${K.type==="grand_total"?"text-blue-900":"text-gray-900"}`,children:["$",K.value.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]},Y))})]})]})}function RR({projectId:e,onJobCompleted:t}){const[r,s]=j.useState([]),[n,a]=j.useState(!0),[i,l]=j.useState(new Set);j.useEffect(()=>{c();const b=se.channel("parsing_jobs_changes").on("postgres_changes",{event:"*",schema:"public",table:"parsing_jobs",filter:`project_id=eq.${e}`},k=>{if(k.eventType==="INSERT")s(_=>[k.new,..._]);else if(k.eventType==="UPDATE"){const _=k.new;s(N=>N.map(C=>C.id===_.id?_:C)),_.status==="completed"&&_.quote_id&&(t==null||t(_.id,_.quote_id))}else k.eventType==="DELETE"&&s(_=>_.filter(N=>N.id!==k.old.id))}).subscribe(),S=setInterval(()=>{r.some(_=>_.status==="pending"||_.status==="processing")&&c()},3e3);return()=>{b.unsubscribe(),clearInterval(S)}},[e,r]);const c=async()=>{try{const{data:b,error:S}=await se.from("parsing_jobs").select("*").eq("project_id",e).order("created_at",{ascending:!1}).limit(20);!S&&b&&s(b)}catch(b){console.error("Error loading parsing jobs:",b)}finally{a(!1)}},u=b=>{if(b.status!=="processing")return!1;const S=new Date(b.updated_at);return(new Date().getTime()-S.getTime())/1e3/60>5},d=async b=>{l(S=>new Set(S).add(b));try{const S=await fetch("https://cbankidsdfsvsgfygbzt.supabase.co/functions/v1/resume_parsing_job",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNiYW5raWRzZGZzdnNnZnlnYnp0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMzMTk3NDgsImV4cCI6MjA3ODg5NTc0OH0.SXgc-9ZamplKeJm5_nl8J2-UzO7A0f8KbAnPZEmsiSo"},body:JSON.stringify({jobId:b})}),k=await S.json();if(!S.ok)throw new Error(k.error||"Failed to resume job");k.success&&k.quoteId?(t==null||t(b,k.quoteId),alert(k.message||`Successfully recovered ${k.recoveredItems} items`)):alert(k.message||"Job was too incomplete to recover"),await c()}catch(S){console.error("Error resuming job:",S),alert(`Failed to resume job: ${S instanceof Error?S.message:"Unknown error"}`)}finally{l(S=>{const k=new Set(S);return k.delete(b),k})}},f=()=>{const b=[],S=[],k=[],_=[];return r.forEach(N=>{var C,B;if(N.status==="pending"||N.status==="processing")_.push(N);else if(N.status==="completed"){const H=((C=N.parsed_lines)==null?void 0:C.length)||0,V=((B=N.error_message)==null?void 0:B.includes("chunks failed"))||!1;H===0?k.push(N):V?S.push(N):b.push(N)}else N.status==="failed"&&k.push(N)}),{successful:b,partial:S,failed:k,active:_}},h=b=>new Date(b).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0});if(n)return o.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:o.jsxs("div",{className:"flex items-center justify-center",children:[o.jsx(js,{className:"w-5 h-5 text-gray-400 animate-spin"}),o.jsx("span",{className:"ml-2 text-sm text-gray-600",children:"Loading jobs..."})]})});if(r.length===0)return null;const{successful:m,partial:x,failed:p,active:g}=f(),w=m.length,v=x.length,y=p.length;return o.jsxs("div",{className:"space-y-6 mb-6",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsx("div",{className:"bg-white rounded-2xl border border-gray-200 p-5 hover:shadow-md transition-shadow",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Successfully Imported"}),o.jsx("div",{className:"text-3xl font-bold text-gray-900",children:w})]}),o.jsx("div",{className:"w-12 h-12 bg-green-50 rounded-xl flex items-center justify-center",children:o.jsx(tr,{className:"text-green-600",size:24})})]})}),o.jsx("div",{className:"bg-white rounded-2xl border border-gray-200 p-5 hover:shadow-md transition-shadow",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Partial Imports"}),o.jsx("div",{className:"text-3xl font-bold text-gray-900",children:v})]}),o.jsx("div",{className:"w-12 h-12 bg-yellow-50 rounded-xl flex items-center justify-center",children:o.jsx(_n,{className:"text-yellow-600",size:24})})]})}),o.jsx("div",{className:"bg-white rounded-2xl border border-gray-200 p-5 hover:shadow-md transition-shadow",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Failed Imports"}),o.jsx("div",{className:"text-3xl font-bold text-gray-900",children:y})]}),o.jsx("div",{className:"w-12 h-12 bg-red-50 rounded-xl flex items-center justify-center",children:o.jsx(so,{className:"text-red-600",size:24})})]})})]}),g.length>0&&o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-5",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Processing"}),o.jsx("div",{className:"space-y-2",children:g.map(b=>o.jsxs("div",{className:"flex items-center gap-3 py-2 px-3 bg-blue-50 rounded-lg border border-blue-200",children:[o.jsx(js,{className:"w-4 h-4 text-blue-600 animate-spin flex-shrink-0"}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:"font-semibold text-gray-900 text-sm",children:b.supplier_name}),o.jsxs("div",{className:"text-xs text-gray-500 mt-0.5",children:["File: ",b.file_name]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-24 bg-gray-200 rounded-full h-2",children:o.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${b.progress}%`}})}),o.jsxs("span",{className:"text-xs text-gray-600 w-10 text-right",children:[b.progress,"%"]}),u(b)&&o.jsxs("button",{onClick:()=>d(b.id),disabled:i.has(b.id),className:"flex items-center gap-1 px-2 py-1 text-xs font-medium text-orange-700 bg-orange-100 hover:bg-orange-200 rounded disabled:opacity-50",children:[i.has(b.id)?o.jsx(js,{className:"w-3 h-3 animate-spin"}):o.jsx(Cr,{className:"w-3 h-3"}),"Resume"]})]})]},b.id))})]}),m.length>0&&o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-5",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Successfully Imported Quotes"}),o.jsx("div",{className:"space-y-2",children:m.map(b=>{var S;return o.jsxs("div",{className:"flex items-center gap-3 py-2 px-3 hover:bg-gray-50 rounded-lg transition-colors",children:[o.jsx(tr,{className:"w-4 h-4 text-green-600 flex-shrink-0"}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:"font-semibold text-gray-900 text-sm",children:b.supplier_name}),o.jsxs("div",{className:"text-xs text-gray-500 mt-0.5",children:[((S=b.parsed_lines)==null?void 0:S.length)||0," items  File: ",b.file_name,"  Imported ",h(b.updated_at)]})]})]},b.id)})})]}),(x.length>0||p.length>0)&&o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-5",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Quotes With Issues"}),x.length>0&&o.jsxs("div",{className:"mb-4",children:[o.jsxs("h4",{className:"text-sm font-semibold text-yellow-900 mb-2 flex items-center gap-2",children:[o.jsx(_n,{size:16}),"Partial Imports (",x.length,")"]}),o.jsx("div",{className:"space-y-2",children:x.map(b=>{var _,N,C;const S=((_=b.parsed_lines)==null?void 0:_.length)||0,k=((C=(N=b.error_message)==null?void 0:N.match(/(\d+) chunks? failed/))==null?void 0:C[1])||"0";return o.jsx("div",{className:"border border-yellow-300 rounded-lg p-3 bg-yellow-50",children:o.jsxs("div",{className:"flex items-start justify-between",children:[o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[o.jsx(_n,{className:"w-4 h-4 text-yellow-600"}),o.jsx("span",{className:"text-sm font-semibold text-gray-900",children:b.supplier_name})]}),o.jsxs("div",{className:"text-xs text-gray-700 mb-1",children:[S," items extracted, ",k," chunks failed"]}),o.jsxs("div",{className:"text-xs text-gray-500",children:["File: ",b.file_name]})]}),o.jsxs("button",{onClick:()=>d(b.id),disabled:i.has(b.id),className:"flex items-center gap-1 px-3 py-1.5 text-xs font-medium text-yellow-700 bg-yellow-100 hover:bg-yellow-200 rounded disabled:opacity-50 border border-yellow-300",children:[i.has(b.id)?o.jsx(js,{className:"w-3 h-3 animate-spin"}):o.jsx(Cr,{className:"w-3 h-3"}),"Retry Failed"]})]})},b.id)})})]}),p.length>0&&o.jsxs("div",{children:[o.jsxs("h4",{className:"text-sm font-semibold text-red-900 mb-2 flex items-center gap-2",children:[o.jsx(so,{size:16}),"Failed Imports (",p.length,")"]}),o.jsx("div",{className:"space-y-2",children:p.map(b=>{var _;const k=(((_=b.parsed_lines)==null?void 0:_.length)||0)===0&&b.status==="completed"?"Parsed successfully but returned 0 line items":b.error_message||"Could not extract tables";return o.jsx("div",{className:"border border-red-300 rounded-lg p-3 bg-red-50",children:o.jsxs("div",{className:"flex items-start justify-between",children:[o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[o.jsx(so,{className:"w-4 h-4 text-red-600"}),o.jsx("span",{className:"text-sm font-semibold text-gray-900",children:b.supplier_name||"Unknown Supplier"})]}),o.jsxs("div",{className:"text-xs text-gray-700 mb-1",children:["Reason: ",k]}),o.jsxs("div",{className:"text-xs text-gray-500",children:["File: ",b.file_name]})]}),o.jsxs("button",{onClick:()=>d(b.id),disabled:i.has(b.id),className:"flex items-center gap-1 px-3 py-1.5 text-xs font-medium text-red-700 bg-red-100 hover:bg-red-200 rounded disabled:opacity-50 border border-red-300",children:[i.has(b.id)?o.jsx(js,{className:"w-3 h-3 animate-spin"}):o.jsx(Cr,{className:"w-3 h-3"}),"Try Again"]})]})},b.id)})})]})]})]})}function IR(e){return console.log("Quote Adapter not fully implemented"),e}function OR({projectId:e,onQuotesImported:t,onNavigateToDashboard:r}){const[s,n]=j.useState([]),[a,i]=j.useState(!1),[l,c]=j.useState(!0),[u,d]=j.useState([]),[f,h]=j.useState([]),[m,x]=j.useState([]),[p,g]=j.useState(""),[w,v]=j.useState(!1),[y,b]=j.useState(null),[S,k]=j.useState(!1),[_,N]=j.useState(null),[C,B]=j.useState(0),[H,V]=j.useState(!0),[K,Y]=j.useState(null),q=j.useRef(null);j.useEffect(()=>{e?X():V(!1)},[e]);const X=async()=>{if(e){V(!0);try{const{data:ne}=await se.from("projects").select("id, name, client, updated_at").eq("id",e).maybeSingle();if(ne){N(ne);const{data:ae,error:Ce}=await se.from("quotes").select("supplier_name").eq("project_id",e);if(!Ce&&ae){const P=new Set(ae.map(ce=>ce.supplier_name));B(P.size)}}}catch(ne){console.error("Error loading project info:",ne)}finally{V(!1)}}},ie=[".pdf",".xlsx",".xls",".csv","application/pdf","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","text/csv"],W=ne=>{ne.preventDefault(),k(!0)},U=()=>{k(!1)},he=async ne=>{ne.preventDefault(),k(!1);const ae=Array.from(ne.dataTransfer.files);await R(ae)},be=async ne=>{const ae=ne.target.files;ae&&ae.length>0&&await R(Array.from(ae))},R=async ne=>{const ae=ne.filter(P=>{var ue;const ce="."+((ue=P.name.split(".").pop())==null?void 0:ue.toLowerCase());return ie.includes(ce)||ie.includes(P.type)});if(ae.length===0){b({type:"error",text:"No valid files selected. Please upload PDF, Excel, or CSV files."});return}n(ae);const Ce=ae.find(P=>P.name.toLowerCase().endsWith(".pdf"));b(Ce?{type:"success",text:`PDF file attached: ${Ce.name}. Enter supplier name and click "Parse Quote" to process with external extractor.`}:{type:"success",text:'File attached. Enter supplier name and click "Parse Quote" to continue.'})},M=async ne=>{if(!e||!p.trim()){b({type:"error",text:"Please provide a supplier name."});return}i(!0),b(null);try{const{data:{session:ae}}=await se.auth.getSession();if(!ae)throw new Error("No active session");for(const Ce of ne){if(Ce.name.toLowerCase().endsWith(".pdf")){console.log(`PDF detected: ${Ce.name}, trying external extractor first...`);const me=new FormData;me.append("file",Ce),me.append("projectId",e),me.append("supplierName",p.trim());const fe="https://cbankidsdfsvsgfygbzt.supabase.co/functions/v1/parse_quote_with_extractor",oe={Authorization:`Bearer ${ae.access_token}`};try{const ke=await fetch(fe,{method:"POST",headers:oe,body:me}),we=await ke.json();if(ke.ok&&we.success){console.log("Extractor  Import Quotes:",we),b({type:"success",text:`${Ce.name} successfully parsed using external extractor! Found ${we.itemsCount} items. Redirecting to review...`}),n([]),g(""),await X(),t(),setTimeout(()=>{r&&r()},1500);continue}else if(we.fallback_required)console.log("Extractor failed, falling back to background job...");else throw new Error(we.error||"Extractor failed")}catch(ke){console.error("External extractor error, falling back to background job:",ke),b({type:"info",text:`External extractor unavailable for ${Ce.name}, using background parser...`})}}const ue=new FormData;ue.append("file",Ce),ue.append("projectId",e),ue.append("supplierName",p.trim());const Ee="https://cbankidsdfsvsgfygbzt.supabase.co/functions/v1/start_parsing_job",T={Authorization:`Bearer ${ae.access_token}`},G=await fetch(Ee,{method:"POST",headers:T,body:ue});if(!G.ok){const me=await G.json();throw new Error(me.error||"Failed to start parsing job")}const Q=await G.json();b({type:"success",text:`${Ce.name} is being parsed in the background. You can navigate away and it will continue processing.`})}n([]),g("")}catch(ae){console.error("Background parsing error:",ae),b({type:"error",text:ae.message||"Failed to start background parsing"})}finally{i(!1)}},O=async ne=>{var ae;i(!0),b(null),d([]);try{const Ce=[];for(const P of ne){const ce=(ae=P.name.split(".").pop())==null?void 0:ae.toLowerCase();let ue=[];try{if(ce==="pdf"?(b({type:"info",text:`Parsing PDF: ${P.name}...`}),ue=await jR(P)):ce==="xlsx"||ce==="xls"?(b({type:"info",text:`Parsing Excel: ${P.name}...`}),ue=await TR(P)):ce==="csv"&&(b({type:"info",text:`Parsing CSV: ${P.name}...`}),ue=await CR(P)),ue.length>0){const Ee=crypto.randomUUID();ue.forEach(T=>{T.supplierId=Ee,T.supplierName=p.trim()}),Ce.push(...ue)}}catch(Ee){console.error(`Error parsing ${P.name}:`,Ee),b({type:"error",text:`Failed to parse ${P.name}. The file format may not be supported or the content is unreadable.`})}}if(Ce.length>0){d(Ce);const P=IR(Ce);h(P),x([]),b({type:"success",text:`Successfully parsed ${Ce.length} line items from ${p}`})}else b({type:"error",text:"No data could be extracted from the files. Please check the file format and content."})}catch(Ce){console.error("Parsing error:",Ce),b({type:"error",text:"An error occurred while parsing the files."})}finally{i(!1)}},z=(ne,ae)=>{h(Ce=>Ce.map(P=>P.id===ne?{...P,...ae}:P))},J=async()=>{if(!e||!p.trim()){b({type:"error",text:"Please provide a supplier name."});return}v(!0),b(null);try{const ne=f.filter(Ee=>Ee.include!==!1);if(ne.length===0){b({type:"error",text:"No items selected for import."}),v(!1);return}const{data:{session:ae}}=await se.auth.getSession();if(!ae)throw new Error("No active session");let Ce=K;if(!Ce){const Ee=`https://cbankidsdfsvsgfygbzt.supabase.co/functions/v1/upload_quote/projects/${e}/quotes/upload`,T={Authorization:`Bearer ${ae.access_token}`},G=new FormData;if(s&&s.length>0)G.append("file",s[0]);else{const fe=new File([""],"quote.pdf",{type:"application/pdf"});G.append("file",fe)}G.append("vendorName",p);const Q=await fetch(Ee,{method:"POST",headers:T,body:G});if(!Q.ok){const fe=await Q.json();throw new Error(`Failed to create quote: ${fe.error||Q.statusText}`)}Ce=(await Q.json()).quoteId,Y(Ce)}const P=`https://cbankidsdfsvsgfygbzt.supabase.co/functions/v1/apply_selections/projects/${e}/selections/apply`,ce={Authorization:`Bearer ${ae.access_token}`,"Content-Type":"application/json"},ue=await fetch(P,{method:"POST",headers:ce,body:JSON.stringify({quoteId:Ce,items:ne.map(Ee=>({lineId:Ee.id,mapKey:Ee.normalised_key||"",description:Ee.description,qty:Ee.qty||0,unit:Ee.unit||"",unitPrice:Ee.unit_price||0,total:Ee.total||0}))})});if(!ue.ok){const Ee=await ue.json();throw new Error(`Failed to apply selections: ${Ee.error||ue.statusText}`)}b({type:"success",text:`Successfully saved ${ne.length} items!`}),n([]),d([]),h([]),x([]),g(""),Y(null),await X(),t(),setTimeout(()=>{r&&r()},1500)}catch(ne){console.error("Save error:",ne),b({type:"error",text:ne instanceof Error?ne.message:"Failed to save selections"})}finally{v(!1)}},pe=()=>{n([]),d([]),h([]),x([]),g(""),b(null)};if(H)return o.jsx("div",{className:"flex items-center justify-center min-h-96",children:o.jsx("div",{className:"text-gray-600",children:"Loading project information..."})});if(u.length>0)return o.jsxs("div",{className:"p-6 max-w-full",children:[o.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-5 mb-6",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-10 h-10 rounded-full bg-orange-50 flex items-center justify-center",children:o.jsx(qy,{className:"text-brand-primary",size:20})}),o.jsxs("div",{children:[o.jsx("h2",{className:"text-lg font-bold text-gray-900",children:"Import Preview"}),o.jsx("p",{className:"text-sm text-gray-600",children:p||"No supplier name provided"})]})]}),o.jsx("button",{onClick:pe,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",title:"Cancel and start over",children:o.jsx(ps,{size:20})})]})}),y&&o.jsx("div",{className:`p-4 rounded-xl mb-6 ${y.type==="success"?"bg-green-50 border border-green-200":y.type==="error"?"bg-red-50 border border-red-200":"bg-blue-50 border border-blue-200"}`,children:o.jsxs("div",{className:"flex items-start gap-2",children:[o.jsx(Je,{size:18,className:`mt-0.5 flex-shrink-0 ${y.type==="success"?"text-green-600":y.type==="error"?"text-red-600":"text-blue-600"}`}),o.jsx("span",{className:y.type==="success"?"text-green-800":y.type==="error"?"text-red-800":"text-blue-800",children:y.text})]})}),o.jsx(PR,{projectId:e||"",lines:f,summaryBlocks:m,supplierName:p,onSupplierNameChange:g,onLineUpdate:z,onSave:J,onCancel:pe,isSaving:w,demoMode:!1})]});if(!e||!_)return o.jsx("div",{className:"flex items-center justify-center min-h-96",children:o.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-8 text-center max-w-md",children:[o.jsx(Je,{className:"mx-auto mb-4 text-yellow-500",size:48}),o.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:"No Project Selected"}),o.jsx("p",{className:"text-gray-600 mb-6",children:"You need to select or create a project before importing quotes."}),o.jsx("button",{onClick:r,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm font-medium inline-flex items-center gap-2",children:"Go to Project Dashboard"})]})});const ge=[{label:"Project",value:_.name},{label:"Suppliers",value:C.toString()},{label:"Last Updated",value:new Date(_.updated_at).toLocaleDateString()}];return o.jsxs("div",{className:"p-6 max-w-full",children:[o.jsx(ua,{title:"Quotes",subtitle:"Import supplier quotes and prepare them for analysis.",metadata:ge}),e&&o.jsx(RR,{projectId:e,onJobCompleted:X}),y&&o.jsx("div",{className:`p-4 rounded-xl mb-6 ${y.type==="success"?"bg-green-50 border border-green-200":y.type==="error"?"bg-red-50 border border-red-200":"bg-blue-50 border border-blue-200"}`,children:o.jsxs("div",{className:"flex items-start gap-2",children:[y.type==="success"?o.jsx(tr,{size:18,className:"mt-0.5 flex-shrink-0 text-green-600"}):o.jsx(Je,{size:18,className:"mt-0.5 flex-shrink-0 text-blue-600"}),o.jsx("span",{className:y.type==="success"?"text-green-800":y.type==="error"?"text-red-800":"text-blue-800",children:y.text})]})}),o.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 mb-6",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[o.jsx("div",{className:"w-10 h-10 rounded-full bg-orange-50 flex items-center justify-center",children:o.jsx(hm,{className:"text-brand-primary",size:20})}),o.jsxs("div",{children:[o.jsx("h2",{className:"text-lg font-bold text-gray-900",children:"Import Quotes"}),o.jsx("p",{className:"text-sm text-gray-600",children:"Upload PDF, Excel, or CSV files from suppliers."})]})]}),o.jsxs("div",{className:"mb-6",children:[o.jsx("label",{htmlFor:"supplier-name-input",className:"block text-sm font-medium text-gray-700 mb-2",children:"Supplier Name"}),o.jsx("input",{id:"supplier-name-input",type:"text",value:p,onChange:ne=>g(ne.target.value),placeholder:"Enter supplier name...",className:"w-full max-w-md px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#0A66C2] focus:border-[#0A66C2] transition bg-white text-gray-900"}),o.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"This name will be displayed throughout the analysis instead of the file name"})]}),o.jsx("div",{onDragOver:W,onDragLeave:U,onDrop:he,className:`rounded-xl p-12 text-center transition-all border-2 border-dashed ${S?"border-brand-primary bg-orange-50":s.length>0?"border-green-300 bg-green-50":"border-gray-300 bg-gray-50 hover:border-gray-400"}`,children:s.length>0?o.jsxs("div",{children:[o.jsx(tr,{className:"mx-auto mb-4 text-green-600",size:48}),o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"File Attached"}),o.jsx("p",{className:"text-sm text-gray-600 mb-4",children:s[0].name}),o.jsxs("div",{className:"flex items-center justify-center gap-3",children:[o.jsx("button",{onClick:()=>{n([]),b(null)},className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors text-sm font-medium",children:"Remove File"}),o.jsxs("button",{onClick:()=>{if(!p.trim()){b({type:"error",text:"Please enter a supplier name first."});return}l?M(s):O(s)},disabled:a||!p.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed inline-flex items-center gap-2",children:[a&&o.jsx(js,{className:"animate-spin",size:18}),a?"Starting Parse...":"Parse Quote (Background)"]})]})]}):o.jsxs(o.Fragment,{children:[o.jsx(qy,{className:`mx-auto mb-4 ${S?"text-brand-primary":"text-gray-400"}`,size:48}),o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:S?"Drop file here":"Drag and drop file here"}),o.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"or click to browse"}),o.jsx("input",{ref:q,type:"file",accept:".pdf,.xlsx,.xls,.csv",multiple:!1,onChange:be,className:"hidden"}),o.jsx("button",{onClick:()=>{var ne;return(ne=q.current)==null?void 0:ne.click()},disabled:a,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:"Attach File"}),o.jsx("p",{className:"text-xs text-gray-500 mt-4",children:"Supported formats: PDF, Excel (.xlsx, .xls), CSV"})]})})]}),a&&o.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-xl mb-6 p-4",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(js,{className:"animate-spin text-blue-600 flex-shrink-0",size:20}),o.jsxs("div",{children:[o.jsx("div",{className:"font-medium text-blue-900",children:"Processing Quote..."}),o.jsx("div",{className:"text-sm text-blue-700 mt-0.5",children:"Extracting and analyzing quote data. This may take a minute for complex documents."})]})]})}),o.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[o.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Import Engine Features"}),o.jsxs("ul",{className:"text-sm text-gray-600 space-y-2",children:[o.jsxs("li",{className:"flex items-start gap-2",children:[o.jsx(tr,{size:16,className:"text-green-600 mt-0.5 flex-shrink-0"}),o.jsx("span",{children:"Automatic table detection for most supplier quote formats"})]}),o.jsxs("li",{className:"flex items-start gap-2",children:[o.jsx(tr,{size:16,className:"text-green-600 mt-0.5 flex-shrink-0"}),o.jsx("span",{children:"Fallback text parsing when tables can't be detected"})]}),o.jsxs("li",{className:"flex items-start gap-2",children:[o.jsx(tr,{size:16,className:"text-green-600 mt-0.5 flex-shrink-0"}),o.jsx("span",{children:"Support for multiple files per supplier"})]})]})]})]})}function DR(e){return o.jsx(OR,{...e})}const LR=[{normalized:"ea",displayName:"Each",aliases:[/^ea$/i,/^each$/i,/^nr$/i,/^no\.?$/i,/^number$/i,/^per$/i,/^item$/i,/^unit$/i,/^pce$/i,/^piece$/i]},{normalized:"m",displayName:"Square Meters",aliases:[/^m$/i,/^m2$/i,/^sqm$/i,/^sq\.?\s*m$/i,/^square\s*m(eter)?s?$/i,/^msq$/i]},{normalized:"m",displayName:"Linear Meters",aliases:[/^m$/i,/^lm$/i,/^lin\.?\s*m$/i,/^linear\s*m(eter)?s?$/i,/^metre?s?$/i,/^meter?s?$/i,/^mtrs?$/i,/^per\s*m(etre)?$/i,/^running\s*m(etre)?$/i]},{normalized:"L",displayName:"Liters",aliases:[/^l$/i,/^litre?s?$/i]},{normalized:"m",displayName:"Cubic Meters",aliases:[/^m$/i,/^m3$/i,/^cum$/i,/^cu\.?\s*m$/i,/^cubic\s*m(eter)?s?$/i]},{normalized:"hr",displayName:"Hours",aliases:[/^hr$/i,/^hrs?$/i,/^hour?s?$/i]},{normalized:"kg",displayName:"Kilograms",aliases:[/^kg$/i,/^kgs?$/i,/^kilogram?s?$/i]},{normalized:"t",displayName:"Tons",aliases:[/^t$/i,/^ton?s?$/i,/^tonne?s?$/i]},{normalized:"sum",displayName:"Sum",aliases:[/^sum$/i,/^p\.?s\.?$/i,/^prov\.?\s*sum$/i]}];function b1(e){if(!e)return{original:"",normalized:"ea",displayName:"Each",confidence:.5};const t=e.trim();if(t.length===0)return{original:e,normalized:"ea",displayName:"Each",confidence:.5};for(const r of LR)for(const s of r.aliases)if(s.test(t))return{original:e,normalized:r.normalized,displayName:r.displayName,confidence:1};return{original:e,normalized:t.toLowerCase(),displayName:t,confidence:.3}}function Cf(e){if(typeof e=="number")return e;if(typeof e=="string"){const t=parseFloat(e.replace(/[^0-9.-]/g,""));return isNaN(t)?null:t}return null}function MR(e,t){return e&&t&&e!==0?t/e:null}function BR(e,t){return e&&t?e*t:null}function _1(e){if(!e||typeof e!="string")return{confidence:0};const t=e.toLowerCase();let r=0;const s={confidence:0};return s.size=UR(e),s.size&&r++,s.frr=zR(e),s.frr&&r++,s.service=$R(t),s.service&&r++,s.subclass=VR(t),s.subclass&&r++,s.material=WR(t),s.material&&r++,s.confidence=r/5,s}function UR(e){const t=[/(\d+(?:\.\d+)?)\s*(?:mm|millimeter|millimetre)/gi,/(\d+(?:\.\d+)?)\s*(?:inch|in|")/gi,/(\d+(?:\.\d+)?)\s*x\s*(\d+(?:\.\d+)?)\s*(?:mm|millimeter|millimetre|inch|in|")?/gi,/(\d+(?:\.\d+)?)\s*(?:mm|inch|in|")?\s*(?:dia|diameter||)/gi,/DN\s*(\d+)/gi,/NB\s*(\d+)/gi];for(const r of t){const s=e.match(r);if(s)return s[0].trim()}}function zR(e){const t=[/FRL\s*[-/]?\s*(\d+)(?:\s*[-/]\s*(\d+)(?:\s*[-/]\s*(\d+))?)?/gi,/(\d+)\s*[-/]\s*(\d+)\s*[-/]\s*(\d+)/g,/(\d+)\s*min(?:ute)?s?\s*fire\s*rat(?:ing|ed)/gi,/fire\s*rat(?:ing|ed)?\s*(?:of|:)?\s*(\d+)/gi,/-\/(\d+)\/(\d+)/g];for(const r of t){const s=e.match(r);if(s)return s[0].trim()}}function $R(e){const t={Electrical:["electrical","electric","power","cable","wiring","conduit"],Mechanical:["mechanical","hvac","duct","ducting","ventilation","air conditioning"],Fire:["fire","sprinkler","fire protection"],Plumbing:["plumbing","pipe","piping","water","drainage","sewer"],Data:["data","telecom","communication","network","fibre","fiber"],Gas:["gas","natural gas","lpg"]};for(const[r,s]of Object.entries(t))if(s.some(n=>e.includes(n)))return r}function VR(e){const t={Cables:["cable","cabling","wire","wiring"],Conduit:["conduit","trunking"],Ducts:["duct","ducting"],Pipes:["pipe","piping"],Tray:["tray","cable tray","ladder"],Penetration:["penetration","opening","hole","aperture"],Seal:["seal","sealing","sealant","firestop"],Batt:["batt","blanket","wrap"],Board:["board","panel"],Collar:["collar","wrap"],Block:["block","brick"],Damper:["damper","fire damper"]};for(const[r,s]of Object.entries(t))if(s.some(n=>e.includes(n)))return r}function WR(e){const t={Steel:["steel","galvanised","galvanized"],PVC:["pvc","polyvinyl"],Copper:["copper","cu"],Aluminium:["aluminium","aluminum"],Concrete:["concrete"],Plasterboard:["plasterboard","gypsum","drywall"],Ceramic:["ceramic","fibre","fiber"],Intumescent:["intumescent"],"Mineral Wool":["mineral wool","rockwool","rock wool"]};for(const[r,s]of Object.entries(t))if(s.some(n=>e.includes(n)))return r}function S1(e){let t=0;return e.qty&&e.rate&&(t+=40),e.unit&&(t+=20),e.description&&e.description.length>10&&(t+=20),e.system_id&&(t+=20),Math.min(t,100)}function qR(e){return e>=80?"text-green-600":e>=60?"text-amber-600":"text-red-600"}function HR(e){return e>=80?"High":e>=60?"Medium":"Low"}const Vk=[{id:"ELEC_CABLE_120_SM",label:"Electrical Cables - Small (FRL 120)",service:"Electrical",frr:120,size_min:0,size_max:50,subclass:"Cables"},{id:"ELEC_CABLE_120_MD",label:"Electrical Cables - Medium (FRL 120)",service:"Electrical",frr:120,size_min:51,size_max:150,subclass:"Cables"},{id:"ELEC_CABLE_120_LG",label:"Electrical Cables - Large (FRL 120)",service:"Electrical",frr:120,size_min:151,size_max:300,subclass:"Cables"},{id:"ELEC_CABLE_90_SM",label:"Electrical Cables - Small (FRL 90)",service:"Electrical",frr:90,size_min:0,size_max:50,subclass:"Cables"},{id:"ELEC_CABLE_90_MD",label:"Electrical Cables - Medium (FRL 90)",service:"Electrical",frr:90,size_min:51,size_max:150,subclass:"Cables"},{id:"ELEC_CABLE_90_LG",label:"Electrical Cables - Large (FRL 90)",service:"Electrical",frr:90,size_min:151,size_max:300,subclass:"Cables"},{id:"ELEC_CONDUIT_120_SM",label:"Electrical Conduit - Small (FRL 120)",service:"Electrical",frr:120,size_min:0,size_max:40,subclass:"Conduit"},{id:"ELEC_CONDUIT_120_MD",label:"Electrical Conduit - Medium (FRL 120)",service:"Electrical",frr:120,size_min:41,size_max:100,subclass:"Conduit"},{id:"ELEC_CONDUIT_120_LG",label:"Electrical Conduit - Large (FRL 120)",service:"Electrical",frr:120,size_min:101,size_max:200,subclass:"Conduit"},{id:"MECH_DUCT_120_SM",label:"Mechanical Duct - Small (FRL 120)",service:"Mechanical",frr:120,size_min:0,size_max:200,subclass:"Ducts"},{id:"MECH_DUCT_120_MD",label:"Mechanical Duct - Medium (FRL 120)",service:"Mechanical",frr:120,size_min:201,size_max:500,subclass:"Ducts"},{id:"MECH_DUCT_120_LG",label:"Mechanical Duct - Large (FRL 120)",service:"Mechanical",frr:120,size_min:501,size_max:1e3,subclass:"Ducts"},{id:"MECH_DUCT_90_SM",label:"Mechanical Duct - Small (FRL 90)",service:"Mechanical",frr:90,size_min:0,size_max:200,subclass:"Ducts"},{id:"MECH_DUCT_90_MD",label:"Mechanical Duct - Medium (FRL 90)",service:"Mechanical",frr:90,size_min:201,size_max:500,subclass:"Ducts"},{id:"MECH_DUCT_90_LG",label:"Mechanical Duct - Large (FRL 90)",service:"Mechanical",frr:90,size_min:501,size_max:1e3,subclass:"Ducts"},{id:"PLUMB_PIPE_120_SM",label:"Plumbing Pipe - Small (FRL 120)",service:"Plumbing",frr:120,size_min:0,size_max:50,subclass:"Pipes"},{id:"PLUMB_PIPE_120_MD",label:"Plumbing Pipe - Medium (FRL 120)",service:"Plumbing",frr:120,size_min:51,size_max:150,subclass:"Pipes"},{id:"PLUMB_PIPE_120_LG",label:"Plumbing Pipe - Large (FRL 120)",service:"Plumbing",frr:120,size_min:151,size_max:300,subclass:"Pipes"},{id:"PLUMB_PIPE_90_SM",label:"Plumbing Pipe - Small (FRL 90)",service:"Plumbing",frr:90,size_min:0,size_max:50,subclass:"Pipes"},{id:"PLUMB_PIPE_90_MD",label:"Plumbing Pipe - Medium (FRL 90)",service:"Plumbing",frr:90,size_min:51,size_max:150,subclass:"Pipes"},{id:"PLUMB_PIPE_90_LG",label:"Plumbing Pipe - Large (FRL 90)",service:"Plumbing",frr:90,size_min:151,size_max:300,subclass:"Pipes"},{id:"DATA_CABLE_120_SM",label:"Data Cables - Small (FRL 120)",service:"Data",frr:120,size_min:0,size_max:50,subclass:"Cables"},{id:"DATA_CABLE_120_MD",label:"Data Cables - Medium (FRL 120)",service:"Data",frr:120,size_min:51,size_max:150,subclass:"Cables"},{id:"DATA_CABLE_120_LG",label:"Data Cables - Large (FRL 120)",service:"Data",frr:120,size_min:151,size_max:300,subclass:"Cables"},{id:"FIRE_SPRINK_120_SM",label:"Fire Sprinkler Pipe - Small (FRL 120)",service:"Fire",frr:120,size_min:0,size_max:50,subclass:"Pipes"},{id:"FIRE_SPRINK_120_MD",label:"Fire Sprinkler Pipe - Medium (FRL 120)",service:"Fire",frr:120,size_min:51,size_max:150,subclass:"Pipes"},{id:"FIRE_SPRINK_120_LG",label:"Fire Sprinkler Pipe - Large (FRL 120)",service:"Fire",frr:120,size_min:151,size_max:300,subclass:"Pipes"},{id:"GAS_PIPE_120_SM",label:"Gas Pipe - Small (FRL 120)",service:"Gas",frr:120,size_min:0,size_max:50,subclass:"Pipes"},{id:"GAS_PIPE_120_MD",label:"Gas Pipe - Medium (FRL 120)",service:"Gas",frr:120,size_min:51,size_max:100,subclass:"Pipes"},{id:"CABLE_TRAY_120",label:"Cable Tray (FRL 120)",service:"Electrical",frr:120,size_min:100,size_max:600,subclass:"Tray"},{id:"CABLE_TRAY_90",label:"Cable Tray (FRL 90)",service:"Electrical",frr:90,size_min:100,size_max:600,subclass:"Tray"},{id:"PEN_SEAL_120_SM",label:"Penetration Seal - Small (FRL 120)",frr:120,size_min:0,size_max:75,subclass:"Seal"},{id:"PEN_SEAL_120_MD",label:"Penetration Seal - Medium (FRL 120)",frr:120,size_min:76,size_max:200,subclass:"Seal"},{id:"PEN_SEAL_120_LG",label:"Penetration Seal - Large (FRL 120)",frr:120,size_min:201,size_max:500,subclass:"Seal"},{id:"PEN_SEAL_90_SM",label:"Penetration Seal - Small (FRL 90)",frr:90,size_min:0,size_max:75,subclass:"Seal"},{id:"PEN_SEAL_90_MD",label:"Penetration Seal - Medium (FRL 90)",frr:90,size_min:76,size_max:200,subclass:"Seal"},{id:"PEN_SEAL_90_LG",label:"Penetration Seal - Large (FRL 90)",frr:90,size_min:201,size_max:500,subclass:"Seal"},{id:"LINEAR_JOINT_120",label:"Linear Joint - Control Joint (FRL 120)",frr:120,size_min:10,size_max:50,subclass:"Seal"},{id:"LINEAR_JOINT_90",label:"Linear Joint - Control Joint (FRL 90)",frr:90,size_min:10,size_max:50,subclass:"Seal"},{id:"FIRE_DAMPER_120",label:"Fire Damper (FRL 120)",service:"Mechanical",frr:120,size_min:100,size_max:1e3,subclass:"Damper"},{id:"FIRE_DAMPER_90",label:"Fire Damper (FRL 90)",service:"Mechanical",frr:90,size_min:100,size_max:1e3,subclass:"Damper"},{id:"COLLAR_120_SM",label:"Fire Collar - Small (FRL 120)",frr:120,size_min:0,size_max:100,subclass:"Collar"},{id:"COLLAR_120_MD",label:"Fire Collar - Medium (FRL 120)",frr:120,size_min:101,size_max:200,subclass:"Collar"},{id:"COLLAR_120_LG",label:"Fire Collar - Large (FRL 120)",frr:120,size_min:201,size_max:400,subclass:"Collar"},{id:"BATT_WRAP_120",label:"Fire Batt/Wrap (FRL 120)",frr:120,subclass:"Batt"},{id:"BATT_WRAP_90",label:"Fire Batt/Wrap (FRL 90)",frr:90,subclass:"Batt"},{id:"BOARD_120",label:"Fire Rated Board (FRL 120)",frr:120,subclass:"Board"},{id:"BOARD_90",label:"Fire Rated Board (FRL 90)",frr:90,subclass:"Board"}];function GR(e){if(!e||!e.description)return{systemId:null,systemLabel:null,confidence:0,needsReview:!0,matchedFactors:[],missedFactors:["No description provided"]};const t=[],r=[];let s=null,n=0;for(const l of Vk){let c=0;const u=[];if(e.service&&l.service&&(e.service.toLowerCase().includes(l.service.toLowerCase())||l.service.toLowerCase().includes(e.service.toLowerCase()))&&(c+=30,u.push(`Service: ${e.service}`)),e.size&&l.size_min!==void 0&&l.size_max!==void 0){const d=parseFloat(e.size.replace(/[^\d.]/g,""));!isNaN(d)&&d>=l.size_min&&d<=l.size_max&&(c+=25,u.push(`Size: ${e.size}`))}if(e.frr&&l.frr){const d=parseInt(e.frr.replace(/[^\d]/g,""));!isNaN(d)&&d===l.frr&&(c+=20,u.push(`FRR: ${e.frr}`))}e.subclass&&l.label.toLowerCase().includes(e.subclass.toLowerCase())&&(c+=15,u.push(`Type: ${e.subclass}`)),c>n&&(n=c,s={template:l,score:c},t.length=0,t.push(...u))}if(e.service||r.push("Service type not identified"),e.size||r.push("Size not found"),e.frr||r.push("FRR not specified"),!s||n<20)return{systemId:null,systemLabel:null,confidence:0,needsReview:!0,matchedFactors:t,missedFactors:r.length>0?r:["No matching system template found"]};const a=Math.min(n/90,1),i=a<.7;return{systemId:s.template.id,systemLabel:s.template.label,confidence:a,needsReview:i,matchedFactors:t,missedFactors:r}}function m0({currentStep:e,totalSteps:t=5,onBack:r,onNext:s,backLabel:n,nextLabel:a,disabledNext:i=!1}){return o.jsx("div",{className:"border-t border-gray-200 bg-white px-8 py-4",children:o.jsxs("div",{className:"flex items-center justify-between max-w-7xl mx-auto",children:[o.jsx("div",{className:"flex-1",children:r&&o.jsxs("button",{onClick:r,className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:[o.jsx(AS,{size:16}),n||"Back"]})}),o.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:["Step ",e+1," of ",t]}),o.jsx("div",{className:"flex-1 flex justify-end",children:s&&o.jsxs("button",{onClick:s,disabled:i,className:`inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-white rounded-lg transition-colors ${i?"bg-gray-300 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:[a||"Next step",o.jsx(Fc,{size:16})]})})]})})}function jx(e){return e.quantity===null||e.quantity===void 0||e.quantity===0}function KR(e){return e.toLowerCase().replace(/\s+/g," ").replace(/(\d+(\.\d+)?\s*mm)/g,"").replace(/fc\s*\d+/g,"").replace(/[-,]/g," ").trim()}function XR(e){return e.replace(/\s+/g," ").split(" ").slice(0,8).join(" ")}const Af={ea:"No",each:"No",nr:"No",no:"No",m:"lm","linear meter":"lm","lineal meter":"lm",meter:"lm",metres:"lm",meters:"lm"};function QR({rawUnit:e,normalizedUnit:t,canonicalUnit:r}){const s=t||r,n=s||Af[e.toLowerCase()]||e,a=s?s.toLowerCase()!==e.toLowerCase():Af[e.toLowerCase()]&&Af[e.toLowerCase()]!==e;return o.jsxs("div",{className:"flex flex-col text-sm",children:[o.jsx("span",{className:"font-medium text-gray-900",children:n}),a&&o.jsxs("span",{className:"text-[10px] text-slate-500",children:['normalised from "',e,'"']})]})}function YR({rawDescription:e,normalizedDescription:t}){const r=t||e,s=t&&t.trim()!==e.trim();return o.jsxs("div",{className:"flex flex-col text-sm max-w-xs",children:[o.jsx("span",{className:"font-medium text-gray-900 truncate",title:r,children:r}),s&&o.jsxs("span",{className:"text-[11px] text-slate-500 truncate",title:e,children:["original: ",e]})]})}function JR({mappedServiceType:e,mappedSystem:t,mappedPenetration:r,mappingConfidence:s,size:n,frr:a,service:i,subclass:l,material:c}){const u=e||t||r;return o.jsx("div",{className:"text-xs space-y-1",children:u?o.jsxs("div",{className:"flex flex-wrap gap-1",children:[e&&o.jsx("span",{className:"px-2 py-0.5 rounded-full bg-blue-100 text-blue-900 font-semibold",children:e}),t&&o.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-100 text-emerald-900 font-semibold",children:t}),r&&o.jsx("span",{className:"px-2 py-0.5 rounded-full bg-pink-100 text-pink-900 font-semibold",children:r}),typeof s=="number"&&o.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-gray-200 text-gray-900 font-semibold",children:[(s*100).toFixed(0),"%"]})]}):o.jsxs(o.Fragment,{children:[n&&o.jsxs("div",{className:"text-gray-900 font-medium",children:["Size: ",o.jsx("span",{className:"font-semibold",children:n})]}),a&&o.jsxs("div",{className:"text-gray-900 font-medium",children:["FRR: ",o.jsx("span",{className:"font-semibold",children:a})]}),i&&o.jsxs("div",{className:"text-blue-800 font-medium",children:["Service: ",o.jsx("span",{className:"font-semibold",children:i})]}),l&&o.jsxs("div",{className:"text-gray-900 font-medium",children:["Type: ",o.jsx("span",{className:"font-semibold",children:l})]}),c&&o.jsxs("div",{className:"text-gray-900 font-medium",children:["Material: ",o.jsx("span",{className:"font-semibold",children:c})]})]})})}function ZR({projectId:e,onNavigateBack:t,onNavigateNext:r}){const[s,n]=j.useState([]),[a,i]=j.useState([]),[l,c]=j.useState(null),[u,d]=j.useState([]),[f,h]=j.useState(null),[m,x]=j.useState({}),[p,g]=j.useState(!0),[w,v]=j.useState(!1),[y,b]=j.useState(!1),[S,k]=j.useState(!1),[_,N]=j.useState(!1),[C,B]=j.useState(null),[H,V]=j.useState(null),[K,Y]=j.useState(null),q=Vk,X=async()=>{await se.from("projects").update({updated_at:new Date().toISOString()}).eq("id",e)},ie=async()=>{try{await se.from("project_settings").upsert({project_id:e,review_clean_completed:!0,updated_at:new Date().toISOString()},{onConflict:"project_id"})}catch(T){console.error("Error marking Review & Clean as complete:",T)}};j.useEffect(()=>{W()},[e]),j.useEffect(()=>{l&&U(l)},[l]);const W=async()=>{g(!0);const{data:T,error:G}=await se.from("quotes").select("*").eq("project_id",e).order("import_date",{ascending:!1});if(!G&&T){n(T);const{data:Q}=await se.from("parsing_jobs").select("quote_id, status, error_message, parsed_lines").eq("project_id",e),me=new Map;Q&&Q.forEach(oe=>{oe.quote_id&&me.set(oe.quote_id,oe)});const fe=T.filter(oe=>{var Pe;const ke=me.get(oe.id);if((oe.items_count||0)===0)return!1;if(ke){const Ue=((Pe=ke.error_message)==null?void 0:Pe.includes("chunks failed"))||!1;if(ke.status==="failed"||Ue)return!1}return!0});i(fe),fe.length>0&&!l?c(fe[0].id):fe.length===0?c(null):l&&!fe.find(oe=>oe.id===l)&&c(fe[0].id)}g(!1)},U=async T=>{const{data:G,error:Q}=await se.from("quote_items").select("*").eq("quote_id",T).order("created_at",{ascending:!0});!Q&&G&&d(G)},he=async T=>{if(!l){console.error("normaliseAllItems: No selectedQuote");return}v(!0),B({type:"info",text:"Normalising items..."});const G=T||u;console.log("normaliseAllItems: Processing",G.length,"items");try{const Q=G.map(fe=>{const oe=Cf(fe.quantity),ke=Cf(fe.unit_price);let we=Cf(fe.total_price);const Pe=MR(we,oe),Ue=BR(oe,ke),et=ke||Pe,nt=we||Ue,He=b1(fe.unit),Be=_1(fe.description),{confidence:xe,issues:Xe}=S1(fe.description,oe,fe.unit,He.canonical,et,nt,Be.confidence);return{id:fe.id,quantity:oe||fe.quantity,unit_price:et||fe.unit_price,total_price:nt||fe.total_price,canonical_unit:He.canonical||"",size:Be.size||"",frr:Be.frr||"",service:Be.service||"",subclass:Be.subclass||"",material:Be.material||"",confidence:xe,issues:JSON.stringify(Xe)}});console.log("normaliseAllItems: Saving",Q.length,"updates to database");for(const fe of Q){const{id:oe,...ke}=fe,{error:we}=await se.from("quote_items").update(ke).eq("id",oe);we&&console.error("normaliseAllItems: Error updating item",oe,we)}await X(),await U(l),await W();const me=Q.filter(fe=>fe.confidence<.6).length;console.log("normaliseAllItems: Complete!",Q.length,"items,",me,"low confidence"),B({type:"success",text:`Normalisation complete! ${Q.length} items processed. ${me} items need review.`})}catch(Q){console.error("Normalisation error:",Q),B({type:"error",text:"Failed to normalise items. Please try again."})}finally{v(!1)}},be=async T=>{if(!l){console.error("mapAllItemsToSystems: No selectedQuote");return}b(!0),B({type:"info",text:"Mapping items to systems..."});const G=T||u;console.log("mapAllItemsToSystems: Processing",G.length,"items");try{const Q=G.map(Pe=>{const Ue=GR({description:Pe.description,size:Pe.size,frr:Pe.frr,service:Pe.service,subclass:Pe.subclass,material:Pe.material});return{id:Pe.id,system_id:Ue.systemId||null,system_label:Ue.systemLabel||null,system_confidence:Ue.confidence,system_needs_review:Ue.needsReview,system_manual_override:!1,matched_factors:JSON.stringify(Ue.matchedFactors),missed_factors:JSON.stringify(Ue.missedFactors)}});console.log("mapAllItemsToSystems: Saving",Q.length,"updates to database"),console.log("mapAllItemsToSystems: Sample update:",Q[0]);const me=Q.filter(Pe=>Pe.system_id);console.log("mapAllItemsToSystems: Items with system_id:",me.length,"/",Q.length);for(const Pe of Q){const{id:Ue,...et}=Pe,{error:nt}=await se.from("quote_items").update(et).eq("id",Ue);nt&&console.error("mapAllItemsToSystems: Error updating item",Ue,nt)}console.log("mapAllItemsToSystems: Database updates complete. Verifying...");const{data:fe,error:oe}=await se.from("quote_items").select("id, description, system_id, system_label, size, frr, service, subclass").eq("quote_id",l).limit(5);if(fe){console.log("mapAllItemsToSystems: Verification - Sample saved items:",fe);const Pe=fe.filter(Ue=>Ue.system_id);console.log("mapAllItemsToSystems: Verification - Items with system_id:",Pe.length,"/",fe.length)}await X(),await U(l),await ie();const ke=Q.filter(Pe=>Pe.system_needs_review).length,we=Q.filter(Pe=>Pe.system_id).length;console.log("mapAllItemsToSystems: Complete!",we,"/",Q.length,"mapped,",ke,"need review"),B({type:"success",text:`Mapping complete! ${we}/${Q.length} items mapped. ${ke} need review.`})}catch(Q){console.error("Mapping error:",Q),B({type:"error",text:"Failed to map items to systems. Please try again."})}finally{b(!1)}},R=async T=>{if(!l||w||y||S)return;k(!0),B({type:"info",text:"Step 1/2: Normalising items..."});const G=T||u;try{let Q=!0;try{await he(G)}catch(oe){console.error("Normalise step failed:",oe),B({type:"error",text:"Normalise failed  please try again."}),Q=!1}if(!Q)return;B({type:"info",text:"Step 2/2: Mapping items to systems..."}),await new Promise(oe=>setTimeout(oe,200));const{data:me}=await se.from("quote_items").select("*").eq("quote_id",l).order("created_at",{ascending:!0});let fe=!0;try{await be(me||G)}catch(oe){console.error("Mapping step failed:",oe),B({type:"error",text:"System mapping failed  please review items."}),fe=!1}if(!fe)return;B({type:"success",text:"Smart Clean complete! All items normalised and mapped."})}catch(Q){console.error("Smart Clean error:",Q),B({type:"error",text:"Smart Clean failed. Please try individual steps."})}finally{k(!1)}},M=async()=>{if(!l||w||y||S)return;const T=s.find(G=>G.id===l);if(T){k(!0),B({type:"info",text:`Processing "${T.supplier_name}"...`});try{await se.from("quotes").update({status:"processing",processing_started_at:new Date().toISOString()}).eq("id",l),await R(u),await se.from("quotes").update({status:"ready",processing_completed_at:new Date().toISOString()}).eq("id",l),await W(),B({type:"success",text:`"${T.supplier_name}" processed successfully!`})}catch(G){console.error("Clean & Map error:",G),await se.from("quotes").update({status:"error",processing_error:G instanceof Error?G.message:"Unknown error",processing_completed_at:new Date().toISOString()}).eq("id",l),await W(),B({type:"error",text:`Failed to process "${T.supplier_name}"`})}finally{k(!1)}}},O=async()=>{if(w||y||S||_)return;const T=a.filter(G=>G.status==="imported"||G.status==="pending"||G.status==="error");if(T.length===0){B({type:"info",text:"No pending quotes to process."});return}console.log("========== PROCESS PENDING QUOTES STARTED =========="),console.log("Processing",T.length,"pending quotes"),N(!0);try{for(let G=0;G<T.length;G++){const Q=T[G];console.log(`
--- Processing quote ${G+1}/${T.length}: ${Q.supplier_name} ---`),B({type:"info",text:`Processing quote ${G+1}/${T.length}: ${Q.supplier_name}`}),c(Q.id),await se.from("quotes").update({status:"processing",processing_started_at:new Date().toISOString()}).eq("id",Q.id);const{data:me}=await se.from("quote_items").select("*").eq("quote_id",Q.id).order("created_at",{ascending:!0});if(!me||me.length===0){console.warn(`No items found for quote ${Q.supplier_name}`),await se.from("quotes").update({status:"error",processing_error:"No items found"}).eq("id",Q.id);continue}console.log("Loaded",me.length,"items for quote",Q.supplier_name),d(me);try{await R(me),await se.from("quotes").update({status:"ready",processing_completed_at:new Date().toISOString()}).eq("id",Q.id),console.log("Successfully processed quote:",Q.supplier_name)}catch(fe){console.error(`Processing failed for quote ${Q.supplier_name}:`,fe),await se.from("quotes").update({status:"error",processing_error:fe instanceof Error?fe.message:"Unknown error",processing_completed_at:new Date().toISOString()}).eq("id",Q.id)}}console.log(`
========== PROCESS PENDING QUOTES COMPLETE ==========`),l&&await U(l),await W(),B({type:"success",text:`All ${T.length} pending quotes processed.`})}catch(G){console.error("Process All Pending error:",G),B({type:"error",text:"Failed to process all quotes. Some quotes may have been processed."})}finally{N(!1)}},z=async(T,G)=>{const Q=q.find(fe=>fe.id===G);if(!Q)return;const{error:me}=await se.from("quote_items").update({system_id:G,system_label:Q.label,system_manual_override:!0,system_needs_review:!1}).eq("id",T);!me&&l&&(await X(),U(l))},J=T=>{h(T.id),x({description:T.description,quantity:T.quantity,unit:T.unit,unit_price:T.unit_price,canonical_unit:T.canonical_unit,size:T.size,frr:T.frr,service:T.service,subclass:T.subclass,material:T.material})},pe=()=>{h(null),x({})},ge=async T=>{const G=(m.quantity||0)*(m.unit_price||0),Q=b1(m.unit),me=_1(m.description||""),{confidence:fe,issues:oe}=S1(m.description,m.quantity,m.unit,m.canonical_unit||Q.canonical,m.unit_price,G,me.confidence),{error:ke}=await se.from("quote_items").update({...m,total_price:G,canonical_unit:m.canonical_unit||Q.canonical||"",confidence:fe,issues:JSON.stringify(oe)}).eq("id",T);ke||(await X(),h(null),x({}),U(l),W())},ne=async(T,G)=>{const{error:Q}=await se.from("quote_items").update({is_excluded:!G}).eq("id",T);!Q&&l&&(await X(),U(l))},ae=async T=>{if(!confirm("Are you sure you want to delete this item?"))return;const{error:G}=await se.from("quote_items").delete().eq("id",T);!G&&l&&(await X(),U(l),W())},Ce=async T=>{if(!confirm("Are you sure you want to delete this entire quote?"))return;const{error:G}=await se.from("quotes").delete().eq("id",T);G||(l===T&&(c(null),d([])),W())},P=T=>{if(T===void 0||T===0)return o.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-medium rounded-full bg-gray-100 text-gray-600",children:"Not analysed"});const G=qR(T),Q=HR(T),me={green:"bg-green-100 text-green-800",amber:"bg-yellow-100 text-yellow-800",red:"bg-red-100 text-red-800"};return o.jsxs("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${me[G]}`,children:[Q," (",Math.round(T*100),"%)"]})},ce=T=>{if(!T)return[];if(typeof T=="string")try{return JSON.parse(T)}catch{return[]}return Array.isArray(T)?T:[]};if(p)return o.jsx("div",{className:"flex items-center justify-center h-64",children:o.jsx("div",{className:"text-gray-500",children:"Loading quotes..."})});if(s.length===0)return o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center",children:[o.jsx("p",{className:"text-gray-500 text-lg",children:"No quotes imported yet."}),o.jsx("p",{className:"text-gray-400 mt-2",children:"Go to Import Quotes to add your first quote."})]});const ue=s.find(T=>T.id===l),Ee=(ue==null?void 0:ue.reconciliation_status)==="failed";return o.jsxs("div",{className:"space-y-6",children:[Ee&&ue&&o.jsx("div",{className:"bg-red-50 border-2 border-red-400 rounded-lg p-4",children:o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx(Je,{size:24,className:"text-red-600 flex-shrink-0 mt-0.5"}),o.jsxs("div",{className:"flex-1",children:[o.jsx("h4",{className:"font-bold text-red-900 text-lg",children:" Totals Reconciliation Failed"}),o.jsx("p",{className:"text-red-800 mt-1",children:ue.reconciliation_notes}),o.jsxs("p",{className:"text-red-700 mt-2 text-sm",children:[o.jsx("strong",{children:"Variance:"})," ",((ue.reconciliation_variance||0)*100).toFixed(2),"%",ue.quoted_total&&o.jsxs(o.Fragment,{children:[" | ",o.jsx("strong",{children:"PDF Total:"})," $",ue.quoted_total.toLocaleString()," | ",o.jsx("strong",{children:"Extracted Total:"})," $",ue.total_amount.toLocaleString()]})]}),o.jsx("p",{className:"text-red-800 mt-3 font-medium",children:"This quote requires manual review. Possible causes: column swap, missing items, or incorrect extraction."})]})]})}),C&&o.jsx("div",{className:`p-4 rounded-md ${C.type==="success"?"bg-green-50 text-green-800":C.type==="error"?"bg-red-50 text-red-800":"bg-blue-50 text-blue-800"}`,children:o.jsxs("div",{className:"flex items-start gap-2",children:[o.jsx(Je,{size:18,className:"mt-0.5 flex-shrink-0"}),o.jsx("span",{children:C.text})]})}),a.length===0&&!p?o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-12 text-center",children:[o.jsx(Je,{className:"mx-auto text-gray-400 mb-4",size:48}),o.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"No quotes ready to clean"}),o.jsx("p",{className:"text-gray-600 mb-6",children:"Import supplier quotes or fix failed imports on the Import Quotes page before continuing."}),o.jsx("button",{onClick:()=>window.location.href="#/import",className:"px-6 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-md font-medium transition-colors",children:"Go to Import Quotes"}),o.jsx("p",{className:"text-xs text-gray-500 mt-4",children:"Only successfully imported quotes with line items will appear here."})]}):o.jsxs("div",{className:"grid grid-cols-12 gap-6",children:[o.jsx("div",{className:"col-span-3",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[o.jsx("div",{className:"p-4 border-b border-gray-200",children:o.jsx("h3",{className:"font-semibold text-gray-900",children:"Quotes"})}),o.jsx("div",{className:"divide-y divide-gray-200",children:a.map(T=>o.jsx("div",{className:`p-4 cursor-pointer hover:bg-gray-50 transition-colors ${l===T.id?"bg-gray-50 border-l-4 border-blue-600":""}`,onClick:()=>c(T.id),children:o.jsxs("div",{className:"flex items-start justify-between",children:[o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("p",{className:"font-semibold text-gray-900 text-sm truncate",children:T.supplier_name}),o.jsx("p",{className:"text-xs text-gray-500 truncate mt-0.5",children:T.quote_reference||"No reference"}),o.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[o.jsxs("span",{className:"text-sm font-medium text-gray-900",children:["$",T.total_amount.toLocaleString()]}),o.jsx("span",{className:"inline-flex px-2 py-0.5 text-xs font-medium rounded-full bg-green-100 text-green-800 border border-green-300",children:"Ready to clean"})]})]}),o.jsx("button",{onClick:G=>{G.stopPropagation(),Ce(T.id)},className:"p-1 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded",children:o.jsx(bo,{size:14})})]})},T.id))})]})}),o.jsx("div",{className:"col-span-9",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[o.jsx("div",{className:"p-4 border-b border-gray-200",children:o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsxs("div",{children:[o.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:["Review & Clean ",ue&&` ${ue.supplier_name}`]}),o.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Normalise, clean and map items for this supplier quote."})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("button",{onClick:M,disabled:S||w||y||!l||u.length===0,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed text-sm font-medium",title:"Run normalisation and mapping for this quote",children:[o.jsx(Ku,{size:16}),S?"Processing...":"Clean & Map Quote"]}),o.jsxs("button",{onClick:O,disabled:_||w||y||S||a.length===0,className:"flex items-center gap-2 px-3 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 transition-colors disabled:bg-gray-100 disabled:cursor-not-allowed text-sm",title:"Process all pending/error quotes",children:[o.jsx($F,{size:14}),_?"Processing...":"Run for All Pending"]})]})]})}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full",children:[o.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Description"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Qty"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Unit"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Rate"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Total"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Attributes"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Suggest System"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Confidence"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),o.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),o.jsx("tbody",{className:"divide-y divide-gray-200",children:u.map(T=>{const G=ce(T.issues);return o.jsx("tr",{className:T.is_excluded?"bg-gray-50 opacity-60":"",children:f===T.id?o.jsxs(o.Fragment,{children:[o.jsx("td",{className:"px-4 py-3",children:o.jsx("input",{type:"text",value:m.description||"",onChange:Q=>x({...m,description:Q.target.value}),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm text-gray-900"})}),o.jsx("td",{className:"px-4 py-3",children:o.jsx("input",{type:"number",value:m.quantity||"",onChange:Q=>x({...m,quantity:parseFloat(Q.target.value)||0}),className:"w-20 px-2 py-1 border border-gray-300 rounded text-sm text-gray-900",step:"0.01"})}),o.jsx("td",{className:"px-4 py-3",children:o.jsx("input",{type:"text",value:m.unit||"",onChange:Q=>x({...m,unit:Q.target.value}),className:"w-20 px-2 py-1 border border-gray-300 rounded text-sm text-gray-900"})}),o.jsx("td",{className:"px-4 py-3",children:o.jsx("input",{type:"number",value:m.unit_price||"",onChange:Q=>x({...m,unit_price:parseFloat(Q.target.value)||0}),className:"w-24 px-2 py-1 border border-gray-300 rounded text-sm text-gray-900",step:"0.01"})}),o.jsxs("td",{className:"px-4 py-3 text-sm text-gray-900",children:["$",((m.quantity||0)*(m.unit_price||0)).toFixed(2)]}),o.jsx("td",{className:"px-4 py-3",children:o.jsxs("div",{className:"text-xs space-y-1",children:[m.canonical_unit&&o.jsxs("div",{children:["Unit: ",m.canonical_unit]}),m.service&&o.jsxs("div",{children:["Service: ",m.service]})]})}),o.jsx("td",{className:"px-4 py-3",children:o.jsx("span",{className:"text-sm text-gray-500",children:"Editing..."})}),o.jsx("td",{className:"px-4 py-3",children:o.jsx("span",{className:"text-sm text-gray-500",children:"Editing"})}),o.jsx("td",{className:"px-4 py-3",children:o.jsx("span",{className:"text-sm text-gray-500",children:"-"})}),o.jsx("td",{className:"px-4 py-3 text-right",children:o.jsxs("div",{className:"flex items-center justify-end gap-2",children:[o.jsx("button",{onClick:()=>ge(T.id),className:"p-1 text-green-600 hover:bg-green-50 rounded",children:o.jsx(mx,{size:18})}),o.jsx("button",{onClick:pe,className:"p-1 text-red-600 hover:bg-red-50 rounded",children:o.jsx(ps,{size:18})})]})})]}):o.jsxs(o.Fragment,{children:[o.jsx("td",{className:"px-4 py-3 max-w-xs",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(YR,{rawDescription:T.raw_description||T.description,normalizedDescription:T.normalized_description}),jx(T)&&o.jsx("span",{className:"inline-flex px-2 py-0.5 text-xs font-medium rounded-full bg-yellow-100 text-yellow-800 whitespace-nowrap",children:"Needs quantity"})]})}),o.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:T.quantity}),o.jsx("td",{className:"px-4 py-3",children:o.jsx(QR,{rawUnit:T.raw_unit||T.unit,normalizedUnit:T.normalized_unit,canonicalUnit:T.canonical_unit})}),o.jsxs("td",{className:"px-4 py-3 text-sm text-gray-900",children:["$",T.unit_price.toFixed(2)]}),o.jsxs("td",{className:"px-4 py-3 text-sm text-gray-900",children:["$",T.total_price.toFixed(2)]}),o.jsx("td",{className:"px-4 py-3",children:o.jsx(JR,{mappedServiceType:T.mapped_service_type,mappedSystem:T.mapped_system,mappedPenetration:T.mapped_penetration,mappingConfidence:T.mapping_confidence,size:T.size,frr:T.frr,service:T.service,subclass:T.subclass,material:T.material})}),o.jsx("td",{className:"px-4 py-3",children:T.system_label?o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex items-start gap-2",children:[o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:"text-xs font-medium text-gray-900 truncate",title:T.system_label,children:T.system_label}),o.jsx("div",{className:"text-xs text-gray-500",children:T.system_id}),T.system_manual_override&&o.jsx("div",{className:"text-xs text-blue-600 mt-0.5",children:"Manual override"})]}),T.system_confidence!==void 0&&o.jsxs("span",{className:`inline-flex px-1.5 py-0.5 text-xs font-medium rounded ${T.system_confidence>=.7?"bg-green-100 text-green-800":T.system_confidence>=.5?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:[Math.round(T.system_confidence*100),"%"]})]}),o.jsxs("select",{value:T.system_id||"",onChange:Q=>z(T.id,Q.target.value),className:"w-full text-xs border border-gray-300 rounded px-2 py-1 focus:ring-2 focus:ring-blue-500 focus:border-transparent text-gray-900",children:[o.jsx("option",{value:"",children:"-- Change System --"}),q.map(Q=>o.jsx("option",{value:Q.id,children:Q.label},Q.id))]}),(T.matched_factors||T.missed_factors)&&o.jsxs("button",{onClick:()=>Y(K===T.id?null:T.id),className:"text-xs text-blue-600 hover:text-blue-800 flex items-center gap-1",children:[o.jsx(Je,{size:12}),"Match details"]}),K===T.id&&o.jsxs("div",{className:"mt-1 p-2 bg-gray-50 rounded text-xs",children:[T.matched_factors&&JSON.parse(T.matched_factors).length>0&&o.jsxs("div",{className:"mb-2",children:[o.jsx("div",{className:"font-medium text-green-700 mb-1",children:"Matched:"}),o.jsx("ul",{className:"list-disc list-inside text-green-600 space-y-0.5",children:JSON.parse(T.matched_factors).map((Q,me)=>o.jsx("li",{children:Q},me))})]}),T.missed_factors&&JSON.parse(T.missed_factors).length>0&&o.jsxs("div",{children:[o.jsx("div",{className:"font-medium text-red-700 mb-1",children:"Missed:"}),o.jsx("ul",{className:"list-disc list-inside text-red-600 space-y-0.5",children:JSON.parse(T.missed_factors).map((Q,me)=>o.jsx("li",{children:Q},me))})]})]})]}):o.jsx("div",{className:"text-xs text-gray-400",children:"Not mapped"})}),o.jsxs("td",{className:"px-4 py-3",children:[o.jsxs("div",{className:"space-y-1",children:[P(T.confidence),G.length>0&&o.jsxs("button",{onClick:()=>V(H===T.id?null:T.id),className:"text-xs text-red-600 hover:text-red-800 flex items-center gap-1",children:[o.jsx(Je,{size:12}),G.length," issue",G.length!==1?"s":""]})]}),H===T.id&&G.length>0&&o.jsx("div",{className:"mt-2 p-2 bg-red-50 rounded text-xs text-red-800",children:o.jsx("ul",{className:"list-disc list-inside space-y-1",children:G.map((Q,me)=>o.jsx("li",{children:Q},me))})})]}),o.jsx("td",{className:"px-4 py-3",children:o.jsx("button",{onClick:()=>ne(T.id,T.is_excluded),className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${T.is_excluded?"bg-red-100 text-red-800 hover:bg-red-200":"bg-green-100 text-green-800 hover:bg-green-200"}`,children:T.is_excluded?"Excluded":"Included"})}),o.jsx("td",{className:"px-4 py-3 text-right",children:o.jsxs("div",{className:"flex items-center justify-end gap-2",children:[o.jsx("button",{onClick:()=>J(T),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",children:o.jsx(IS,{size:16})}),o.jsx("button",{onClick:()=>ae(T.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",children:o.jsx(bo,{size:16})})]})})]})},T.id)})})]})})]})})]}),o.jsx(m0,{currentStep:2,onBack:t,onNext:r,backLabel:"Back: Import Quotes",nextLabel:"Next: Quote Intelligence"})]})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Ad={};Ad.version="0.18.5";var Wk=1252,eI=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Tx={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Cx=function(e){eI.indexOf(e)!=-1&&(Wk=Tx[0]=e)};function tI(){Cx(1252)}var Gs=function(e){Cx(e)};function Ax(){Gs(1200),tI()}function k1(e){for(var t=[],r=0,s=e.length;r<s;++r)t[r]=e.charCodeAt(r);return t}function rI(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function qk(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var il=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?rI(e.slice(2)):t==254&&r==255?qk(e.slice(2)):t==65279?e.slice(1):e},wu=function(t){return String.fromCharCode(t)},N1=function(t){return String.fromCharCode(t)},oc,Qn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function lc(e){for(var t="",r=0,s=0,n=0,a=0,i=0,l=0,c=0,u=0;u<e.length;)r=e.charCodeAt(u++),a=r>>2,s=e.charCodeAt(u++),i=(r&3)<<4|s>>4,n=e.charCodeAt(u++),l=(s&15)<<2|n>>6,c=n&63,isNaN(s)?l=c=64:isNaN(n)&&(c=64),t+=Qn.charAt(a)+Qn.charAt(i)+Qn.charAt(l)+Qn.charAt(c);return t}function fs(e){var t="",r=0,s=0,n=0,a=0,i=0,l=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)a=Qn.indexOf(e.charAt(u++)),i=Qn.indexOf(e.charAt(u++)),r=a<<2|i>>4,t+=String.fromCharCode(r),l=Qn.indexOf(e.charAt(u++)),s=(i&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(s)),c=Qn.indexOf(e.charAt(u++)),n=(l&3)<<6|c,c!==64&&(t+=String.fromCharCode(n));return t}var Ze=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Dn=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function da(e){return Ze?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function E1(e){return Ze?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var os=function(t){return Ze?Dn(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function p0(e){if(typeof ArrayBuffer>"u")return os(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),s=0;s!=e.length;++s)r[s]=e.charCodeAt(s)&255;return t}function ba(e){if(Array.isArray(e))return e.map(function(s){return String.fromCharCode(s)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function sI(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function Fx(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Fx(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var lr=Ze?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Dn(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var s=new Uint8Array(r),n=0;for(t=0,r=0;t<e.length;r+=n,++t)if(n=e[t].length,e[t]instanceof Uint8Array)s.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";s.set(new Uint8Array(e[t]),r)}return s}return[].concat.apply([],e.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function nI(e){for(var t=[],r=0,s=e.length+250,n=da(e.length+255),a=0;a<e.length;++a){var i=e.charCodeAt(a);if(i<128)n[r++]=i;else if(i<2048)n[r++]=192|i>>6&31,n[r++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var l=e.charCodeAt(++a)&1023;n[r++]=240|i>>8&7,n[r++]=128|i>>2&63,n[r++]=128|l>>6&15|(i&3)<<4,n[r++]=128|l&63}else n[r++]=224|i>>12&15,n[r++]=128|i>>6&63,n[r++]=128|i&63;r>s&&(t.push(n.slice(0,r)),r=0,n=da(65535),s=65530)}return t.push(n.slice(0,r)),lr(t)}var zr=/\u0000/g,ol=/[\u0001-\u0006]/g;function ao(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Ks(e,t){var r=""+e;return r.length>=t?r:Mt("0",t-r.length)+r}function Px(e,t){var r=""+e;return r.length>=t?r:Mt(" ",t-r.length)+r}function Fd(e,t){var r=""+e;return r.length>=t?r:r+Mt(" ",t-r.length)}function aI(e,t){var r=""+Math.round(e);return r.length>=t?r:Mt("0",t-r.length)+r}function iI(e,t){var r=""+e;return r.length>=t?r:Mt("0",t-r.length)+r}var j1=Math.pow(2,32);function Ei(e,t){if(e>j1||e<-j1)return aI(e,t);var r=Math.round(e);return iI(r,t)}function Pd(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var T1=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Ff=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function oI(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var $e={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},C1={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},lI={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Rd(e,t,r){for(var s=e<0?-1:1,n=e*s,a=0,i=1,l=0,c=1,u=0,d=0,f=Math.floor(n);u<t&&(f=Math.floor(n),l=f*i+a,d=f*u+c,!(n-f<5e-8));)n=1/(n-f),a=i,i=l,c=u,u=d;if(d>t&&(u>t?(d=c,l=a):(d=u,l=i)),!r)return[0,s*l,d];var h=Math.floor(s*l/d);return[h,s*l-h*d,d]}function $a(e,t,r){if(e>2958465||e<0)return null;var s=e|0,n=Math.floor(86400*(e-s)),a=0,i=[],l={D:s,T:n,u:86400*(e-s)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(s+=1462),l.u>.9999&&(l.u=0,++n==86400&&(l.T=n=0,++s,++l.D)),s===60)i=r?[1317,10,29]:[1900,2,29],a=3;else if(s===0)i=r?[1317,8,29]:[1900,1,0],a=6;else{s>60&&--s;var c=new Date(1900,0,1);c.setDate(c.getDate()+s-1),i=[c.getFullYear(),c.getMonth()+1,c.getDate()],a=c.getDay(),s<60&&(a=(a+6)%7),r&&(a=mI(c,i))}return l.y=i[0],l.m=i[1],l.d=i[2],l.S=n%60,n=Math.floor(n/60),l.M=n%60,n=Math.floor(n/60),l.H=n,l.q=a,l}var Hk=new Date(1899,11,31,0,0,0),cI=Hk.getTime(),uI=new Date(1900,2,1,0,0,0);function Gk(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=uI&&(r+=24*60*60*1e3),(r-(cI+(e.getTimezoneOffset()-Hk.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Rx(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function dI(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function fI(e){var t=e<0?12:11,r=Rx(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function hI(e){var t=Rx(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function cc(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=fI(e):t===10?r=e.toFixed(10).substr(0,12):r=hI(e),Rx(dI(r.toUpperCase()))}function ni(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):cc(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Os(14,Gk(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function mI(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function pI(e,t,r,s){var n="",a=0,i=0,l=r.y,c,u=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:c=l%100,u=2;break;default:c=l%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,u=t.length;break;case 3:return Ff[r.m-1][1];case 5:return Ff[r.m-1][0];default:return Ff[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,u=t.length;break;case 3:return T1[r.q][0];default:return T1[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Ks(r.S,t.length):(s>=2?i=s===3?1e3:100:i=s===1?10:1,a=Math.round(i*(r.S+r.u)),a>=60*i&&(a=0),t==="s"?a===0?"0":""+a/i:(n=Ks(a,2+s),t==="ss"?n.substr(0,2):"."+n.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:c=l,u=1;break}var d=u>0?Ks(c,u):"";return d}function Yn(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,s=e.substr(0,r);r!=e.length;r+=t)s+=(s.length>0?",":"")+e.substr(r,t);return s}var Kk=/%/g;function xI(e,t,r){var s=t.replace(Kk,""),n=t.length-s.length;return Nn(e,s,r*Math.pow(10,2*n))+Mt("%",n)}function gI(e,t,r){for(var s=t.length-1;t.charCodeAt(s-1)===44;)--s;return Nn(e,t.substr(0,s),r/Math.pow(10,3*(t.length-s)))}function Xk(e,t){var r,s=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Xk(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%n;if(a<0&&(a+=n),r=(t/Math.pow(10,a)).toPrecision(s+1+(n+a)%n),r.indexOf("e")===-1){var i=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,n)+"."+r.substr(2+n),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,d){return c+u+d.substr(0,(n+a)%n)+"."+d.substr(a)+"E"})}else r=t.toExponential(s);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var Qk=/# (\?+)( ?)\/( ?)(\d+)/;function vI(e,t,r){var s=parseInt(e[4],10),n=Math.round(t*s),a=Math.floor(n/s),i=n-a*s,l=s;return r+(a===0?"":""+a)+" "+(i===0?Mt(" ",e[1].length+1+e[4].length):Px(i,e[1].length)+e[2]+"/"+e[3]+Ks(l,e[4].length))}function yI(e,t,r){return r+(t===0?"":""+t)+Mt(" ",e[1].length+2+e[4].length)}var Yk=/^#*0*\.([0#]+)/,Jk=/\).*[0#]/,Zk=/\(###\) ###\\?-####/;function Dr(e){for(var t="",r,s=0;s!=e.length;++s)switch(r=e.charCodeAt(s)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function A1(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function F1(e,t){var r=e-Math.floor(e),s=Math.pow(10,t);return t<(""+Math.round(r*s)).length?0:Math.round(r*s)}function wI(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function bI(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function ys(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Jk)){var s=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ys("n",s,r):"("+ys("n",s,-r)+")"}if(t.charCodeAt(t.length-1)===44)return gI(e,t,r);if(t.indexOf("%")!==-1)return xI(e,t,r);if(t.indexOf("E")!==-1)return Xk(t,r);if(t.charCodeAt(0)===36)return"$"+ys(e,t.substr(t.charAt(1)==" "?2:1),r);var n,a,i,l,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Ei(c,t.length);if(t.match(/^[#?]+$/))return n=Ei(r,0),n==="0"&&(n=""),n.length>t.length?n:Dr(t.substr(0,t.length-n.length))+n;if(a=t.match(Qk))return vI(a,c,u);if(t.match(/^#+0+$/))return u+Ei(c,t.length-t.indexOf("0"));if(a=t.match(Yk))return n=A1(r,a[1].length).replace(/^([^\.]+)$/,"$1."+Dr(a[1])).replace(/\.$/,"."+Dr(a[1])).replace(/\.(\d*)$/,function(x,p){return"."+p+Mt("0",Dr(a[1]).length-p.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return u+A1(c,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return u+Yn(Ei(c,0));if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ys(e,t,-r):Yn(""+(Math.floor(r)+wI(r,a[1].length)))+"."+Ks(F1(r,a[1].length),a[1].length);if(a=t.match(/^#,#*,#0/))return ys(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=ao(ys(e,t.replace(/[\\-]/g,""),r)),i=0,ao(ao(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return i<n.length?n.charAt(i++):x==="0"?"0":""}));if(t.match(Zk))return n=ys(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var d="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),l=Rd(c,Math.pow(10,i)-1,!1),n=""+u,d=Nn("n",a[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),n+=d+a[2]+"/"+a[3],d=Fd(l[2],i),d.length<a[4].length&&(d=Dr(a[4].substr(a[4].length-d.length))+d),n+=d,n;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),l=Rd(c,Math.pow(10,i)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Px(l[1],i)+a[2]+"/"+a[3]+Fd(l[2],i):Mt(" ",2*i+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return n=Ei(r,0),t.length<=n.length?n:Dr(t.substr(0,t.length-n.length))+n;if(a=t.match(/^([#0?]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=n.indexOf(".");var f=t.indexOf(".")-i,h=t.length-n.length-f;return Dr(t.substr(0,f)+n+t.substr(t.length-h))}if(a=t.match(/^00,000\.([#0]*0)$/))return i=F1(r,a[1].length),r<0?"-"+ys(e,t,-r):Yn(bI(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?Ks(0,3-x.length):"")+x})+"."+Ks(i,a[1].length);switch(t){case"###,##0.00":return ys(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var m=Yn(Ei(c,0));return m!=="0"?u+m:"";case"###,###.00":return ys(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return ys(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function _I(e,t,r){for(var s=t.length-1;t.charCodeAt(s-1)===44;)--s;return Nn(e,t.substr(0,s),r/Math.pow(10,3*(t.length-s)))}function SI(e,t,r){var s=t.replace(Kk,""),n=t.length-s.length;return Nn(e,s,r*Math.pow(10,2*n))+Mt("%",n)}function eN(e,t){var r,s=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+eN(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%n;if(a<0&&(a+=n),r=(t/Math.pow(10,a)).toPrecision(s+1+(n+a)%n),!r.match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,d){return c+u+d.substr(0,(n+a)%n)+"."+d.substr(a)+"E"})}else r=t.toExponential(s);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function sn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Jk)){var s=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?sn("n",s,r):"("+sn("n",s,-r)+")"}if(t.charCodeAt(t.length-1)===44)return _I(e,t,r);if(t.indexOf("%")!==-1)return SI(e,t,r);if(t.indexOf("E")!==-1)return eN(t,r);if(t.charCodeAt(0)===36)return"$"+sn(e,t.substr(t.charAt(1)==" "?2:1),r);var n,a,i,l,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Ks(c,t.length);if(t.match(/^[#?]+$/))return n=""+r,r===0&&(n=""),n.length>t.length?n:Dr(t.substr(0,t.length-n.length))+n;if(a=t.match(Qk))return yI(a,c,u);if(t.match(/^#+0+$/))return u+Ks(c,t.length-t.indexOf("0"));if(a=t.match(Yk))return n=(""+r).replace(/^([^\.]+)$/,"$1."+Dr(a[1])).replace(/\.$/,"."+Dr(a[1])),n=n.replace(/\.(\d*)$/,function(x,p){return"."+p+Mt("0",Dr(a[1]).length-p.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return u+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return u+Yn(""+c);if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+sn(e,t,-r):Yn(""+r)+"."+Mt("0",a[1].length);if(a=t.match(/^#,#*,#0/))return sn(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=ao(sn(e,t.replace(/[\\-]/g,""),r)),i=0,ao(ao(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return i<n.length?n.charAt(i++):x==="0"?"0":""}));if(t.match(Zk))return n=sn(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var d="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),l=Rd(c,Math.pow(10,i)-1,!1),n=""+u,d=Nn("n",a[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),n+=d+a[2]+"/"+a[3],d=Fd(l[2],i),d.length<a[4].length&&(d=Dr(a[4].substr(a[4].length-d.length))+d),n+=d,n;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),l=Rd(c,Math.pow(10,i)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Px(l[1],i)+a[2]+"/"+a[3]+Fd(l[2],i):Mt(" ",2*i+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return n=""+r,t.length<=n.length?n:Dr(t.substr(0,t.length-n.length))+n;if(a=t.match(/^([#0]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=n.indexOf(".");var f=t.indexOf(".")-i,h=t.length-n.length-f;return Dr(t.substr(0,f)+n+t.substr(t.length-h))}if(a=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+sn(e,t,-r):Yn(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?Ks(0,3-x.length):"")+x})+"."+Ks(0,a[1].length);switch(t){case"###,###":case"##,###":case"#,###":var m=Yn(""+c);return m!=="0"?u+m:"";default:if(t.match(/\.[0#?]*$/))return sn(e,t.slice(0,t.lastIndexOf(".")),r)+Dr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Nn(e,t,r){return(r|0)===r?sn(e,t,r):ys(e,t,r)}function kI(e){for(var t=[],r=!1,s=0,n=0;s<e.length;++s)switch(e.charCodeAt(s)){case 34:r=!r;break;case 95:case 42:case 92:++s;break;case 59:t[t.length]=e.substr(n,s-n),n=s+1}if(t[t.length]=e.substr(n),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var tN=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Do(e){for(var t=0,r="",s="";t<e.length;)switch(r=e.charAt(t)){case"G":Pd(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(s=r;e.charAt(t++)!=="]"&&t<e.length;)s+=e.charAt(t);if(s.match(tN))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function NI(e,t,r,s){for(var n=[],a="",i=0,l="",c="t",u,d,f,h="H";i<e.length;)switch(l=e.charAt(i)){case"G":if(!Pd(e,i))throw new Error("unrecognized character "+l+" in "+e);n[n.length]={t:"G",v:"General"},i+=7;break;case'"':for(a="";(f=e.charCodeAt(++i))!==34&&i<e.length;)a+=String.fromCharCode(f);n[n.length]={t:"t",v:a},++i;break;case"\\":var m=e.charAt(++i),x=m==="("||m===")"?m:"t";n[n.length]={t:x,v:m},++i;break;case"_":n[n.length]={t:"t",v:" "},i+=2;break;case"@":n[n.length]={t:"T",v:t},++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2"){if(u==null&&(u=$a(t,r,e.charAt(i+1)==="2"),u==null))return"";n[n.length]={t:"X",v:e.substr(i,2)},c=l,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=$a(t,r),u==null))return"";for(a=l;++i<e.length&&e.charAt(i).toLowerCase()===l;)a+=l;l==="m"&&c.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=h),n[n.length]={t:l,v:a},c=l;break;case"A":case"a":case"":var p={t:l,v:l};if(u==null&&(u=$a(t,r)),e.substr(i,3).toUpperCase()==="A/P"?(u!=null&&(p.v=u.H>=12?"P":"A"),p.t="T",h="h",i+=3):e.substr(i,5).toUpperCase()==="AM/PM"?(u!=null&&(p.v=u.H>=12?"PM":"AM"),p.t="T",i+=5,h="h"):e.substr(i,5).toUpperCase()==="/"?(u!=null&&(p.v=u.H>=12?"":""),p.t="T",i+=5,h="h"):(p.t="t",++i),u==null&&p.t==="T")return"";n[n.length]=p,c=l;break;case"[":for(a=l;e.charAt(i++)!=="]"&&i<e.length;)a+=e.charAt(i);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(tN)){if(u==null&&(u=$a(t,r),u==null))return"";n[n.length]={t:"Z",v:a.toLowerCase()},c=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",Do(e)||(n[n.length]={t:"t",v:a}));break;case".":if(u!=null){for(a=l;++i<e.length&&(l=e.charAt(i))==="0";)a+=l;n[n.length]={t:"s",v:a};break}case"0":case"#":for(a=l;++i<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(i))>-1;)a+=l;n[n.length]={t:"n",v:a};break;case"?":for(a=l;e.charAt(++i)===l;)a+=l;n[n.length]={t:l,v:a},c=l;break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":n[n.length]={t:s===1?"t":l,v:l},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=l;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;)a+=e.charAt(i);n[n.length]={t:"D",v:a};break;case" ":n[n.length]={t:l,v:l},++i;break;case"$":n[n.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);n[n.length]={t:"t",v:l},++i;break}var g=0,w=0,v;for(i=n.length-1,c="t";i>=0;--i)switch(n[i].t){case"h":case"H":n[i].t=h,c="h",g<1&&(g=1);break;case"s":(v=n[i].v.match(/\.0+$/))&&(w=Math.max(w,v[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":c=n[i].t;break;case"m":c==="s"&&(n[i].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&n[i].v.match(/[Hh]/)&&(g=1),g<2&&n[i].v.match(/[Mm]/)&&(g=2),g<3&&n[i].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var y="",b;for(i=0;i<n.length;++i)switch(n[i].t){case"t":case"T":case" ":case"D":break;case"X":n[i].v="",n[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":n[i].v=pI(n[i].t.charCodeAt(0),n[i].v,u,w),n[i].t="t";break;case"n":case"?":for(b=i+1;n[b]!=null&&((l=n[b].t)==="?"||l==="D"||(l===" "||l==="t")&&n[b+1]!=null&&(n[b+1].t==="?"||n[b+1].t==="t"&&n[b+1].v==="/")||n[i].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(n[b].v==="/"||n[b].v===" "&&n[b+1]!=null&&n[b+1].t=="?"));)n[i].v+=n[b].v,n[b]={v:"",t:";"},++b;y+=n[i].v,i=b-1;break;case"G":n[i].t="t",n[i].v=ni(t,r);break}var S="",k,_;if(y.length>0){y.charCodeAt(0)==40?(k=t<0&&y.charCodeAt(0)===45?-t:t,_=Nn("n",y,k)):(k=t<0&&s>1?-t:t,_=Nn("n",y,k),k<0&&n[0]&&n[0].t=="t"&&(_=_.substr(1),n[0].v="-"+n[0].v)),b=_.length-1;var N=n.length;for(i=0;i<n.length;++i)if(n[i]!=null&&n[i].t!="t"&&n[i].v.indexOf(".")>-1){N=i;break}var C=n.length;if(N===n.length&&_.indexOf("E")===-1){for(i=n.length-1;i>=0;--i)n[i]==null||"n?".indexOf(n[i].t)===-1||(b>=n[i].v.length-1?(b-=n[i].v.length,n[i].v=_.substr(b+1,n[i].v.length)):b<0?n[i].v="":(n[i].v=_.substr(0,b+1),b=-1),n[i].t="t",C=i);b>=0&&C<n.length&&(n[C].v=_.substr(0,b+1)+n[C].v)}else if(N!==n.length&&_.indexOf("E")===-1){for(b=_.indexOf(".")-1,i=N;i>=0;--i)if(!(n[i]==null||"n?".indexOf(n[i].t)===-1)){for(d=n[i].v.indexOf(".")>-1&&i===N?n[i].v.indexOf(".")-1:n[i].v.length-1,S=n[i].v.substr(d+1);d>=0;--d)b>=0&&(n[i].v.charAt(d)==="0"||n[i].v.charAt(d)==="#")&&(S=_.charAt(b--)+S);n[i].v=S,n[i].t="t",C=i}for(b>=0&&C<n.length&&(n[C].v=_.substr(0,b+1)+n[C].v),b=_.indexOf(".")+1,i=N;i<n.length;++i)if(!(n[i]==null||"n?(".indexOf(n[i].t)===-1&&i!==N)){for(d=n[i].v.indexOf(".")>-1&&i===N?n[i].v.indexOf(".")+1:0,S=n[i].v.substr(0,d);d<n[i].v.length;++d)b<_.length&&(S+=_.charAt(b++));n[i].v=S,n[i].t="t",C=i}}}for(i=0;i<n.length;++i)n[i]!=null&&"n?".indexOf(n[i].t)>-1&&(k=s>1&&t<0&&i>0&&n[i-1].v==="-"?-t:t,n[i].v=Nn(n[i].t,n[i].v,k),n[i].t="t");var B="";for(i=0;i!==n.length;++i)n[i]!=null&&(B+=n[i].v);return B}var P1=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function R1(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function EI(e,t){var r=kI(e),s=r.length,n=r[s-1].indexOf("@");if(s<4&&n>-1&&--s,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||n>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=n>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=n>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=n>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[s,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var i=r[0].match(P1),l=r[1].match(P1);return R1(t,i)?[s,r[0]]:R1(t,l)?[s,r[1]]:[s,r[i!=null&&l!=null?2:1]]}return[s,a]}function Os(e,t,r){r==null&&(r={});var s="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?s=r.dateNF:s=e;break;case"number":e==14&&r.dateNF?s=r.dateNF:s=(r.table!=null?r.table:$e)[e],s==null&&(s=r.table&&r.table[C1[e]]||$e[C1[e]]),s==null&&(s=lI[e]||"General");break}if(Pd(s,0))return ni(t,r);t instanceof Date&&(t=Gk(t,r.date1904));var n=EI(s,t);if(Pd(n[1]))return ni(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return NI(n[1],t,r,n[0])}function En(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if($e[r]==null){t<0&&(t=r);continue}if($e[r]==e){t=r;break}}t<0&&(t=391)}return $e[t]=e,t}function x0(e){for(var t=0;t!=392;++t)e[t]!==void 0&&En(e[t],t)}function Lo(){$e=oI()}var jI={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},rN=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function TI(e){var t=typeof e=="number"?$e[e]:e;return t=t.replace(rN,"(\\d+)"),new RegExp("^"+t+"$")}function CI(e,t,r){var s=-1,n=-1,a=-1,i=-1,l=-1,c=-1;(t.match(rN)||[]).forEach(function(f,h){var m=parseInt(r[h+1],10);switch(f.toLowerCase().charAt(0)){case"y":s=m;break;case"d":a=m;break;case"h":i=m;break;case"s":c=m;break;case"m":i>=0?l=m:n=m;break}}),c>=0&&l==-1&&n>=0&&(l=n,n=-1);var u=(""+(s>=0?s:new Date().getFullYear())).slice(-4)+"-"+("00"+(n>=1?n:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var d=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return i==-1&&l==-1&&c==-1?u:s==-1&&n==-1&&a==-1?d:u+"T"+d}var AI=function(){var e={};e.version="1.2.0";function t(){for(var _=0,N=new Array(256),C=0;C!=256;++C)_=C,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,N[C]=_;return typeof Int32Array<"u"?new Int32Array(N):N}var r=t();function s(_){var N=0,C=0,B=0,H=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(B=0;B!=256;++B)H[B]=_[B];for(B=0;B!=256;++B)for(C=_[B],N=256+B;N<4096;N+=256)C=H[N]=C>>>8^_[C&255];var V=[];for(B=1;B!=16;++B)V[B-1]=typeof Int32Array<"u"?H.subarray(B*256,B*256+256):H.slice(B*256,B*256+256);return V}var n=s(r),a=n[0],i=n[1],l=n[2],c=n[3],u=n[4],d=n[5],f=n[6],h=n[7],m=n[8],x=n[9],p=n[10],g=n[11],w=n[12],v=n[13],y=n[14];function b(_,N){for(var C=N^-1,B=0,H=_.length;B<H;)C=C>>>8^r[(C^_.charCodeAt(B++))&255];return~C}function S(_,N){for(var C=N^-1,B=_.length-15,H=0;H<B;)C=y[_[H++]^C&255]^v[_[H++]^C>>8&255]^w[_[H++]^C>>16&255]^g[_[H++]^C>>>24]^p[_[H++]]^x[_[H++]]^m[_[H++]]^h[_[H++]]^f[_[H++]]^d[_[H++]]^u[_[H++]]^c[_[H++]]^l[_[H++]]^i[_[H++]]^a[_[H++]]^r[_[H++]];for(B+=15;H<B;)C=C>>>8^r[(C^_[H++])&255];return~C}function k(_,N){for(var C=N^-1,B=0,H=_.length,V=0,K=0;B<H;)V=_.charCodeAt(B++),V<128?C=C>>>8^r[(C^V)&255]:V<2048?(C=C>>>8^r[(C^(192|V>>6&31))&255],C=C>>>8^r[(C^(128|V&63))&255]):V>=55296&&V<57344?(V=(V&1023)+64,K=_.charCodeAt(B++)&1023,C=C>>>8^r[(C^(240|V>>8&7))&255],C=C>>>8^r[(C^(128|V>>2&63))&255],C=C>>>8^r[(C^(128|K>>6&15|(V&3)<<4))&255],C=C>>>8^r[(C^(128|K&63))&255]):(C=C>>>8^r[(C^(224|V>>12&15))&255],C=C>>>8^r[(C^(128|V>>6&63))&255],C=C>>>8^r[(C^(128|V&63))&255]);return~C}return e.table=r,e.bstr=b,e.buf=S,e.str=k,e}(),Me=function(){var t={};t.version="1.2.1";function r(E,I){for(var A=E.split("/"),F=I.split("/"),D=0,L=0,ee=Math.min(A.length,F.length);D<ee;++D){if(L=A[D].length-F[D].length)return L;if(A[D]!=F[D])return A[D]<F[D]?-1:1}return A.length-F.length}function s(E){if(E.charAt(E.length-1)=="/")return E.slice(0,-1).indexOf("/")===-1?E:s(E.slice(0,-1));var I=E.lastIndexOf("/");return I===-1?E:E.slice(0,I+1)}function n(E){if(E.charAt(E.length-1)=="/")return n(E.slice(0,-1));var I=E.lastIndexOf("/");return I===-1?E:E.slice(I+1)}function a(E,I){typeof I=="string"&&(I=new Date(I));var A=I.getHours();A=A<<6|I.getMinutes(),A=A<<5|I.getSeconds()>>>1,E.write_shift(2,A);var F=I.getFullYear()-1980;F=F<<4|I.getMonth()+1,F=F<<5|I.getDate(),E.write_shift(2,F)}function i(E){var I=E.read_shift(2)&65535,A=E.read_shift(2)&65535,F=new Date,D=A&31;A>>>=5;var L=A&15;A>>>=4,F.setMilliseconds(0),F.setFullYear(A+1980),F.setMonth(L-1),F.setDate(D);var ee=I&31;I>>>=5;var de=I&63;return I>>>=6,F.setHours(I),F.setMinutes(de),F.setSeconds(ee<<1),F}function l(E){pr(E,0);for(var I={},A=0;E.l<=E.length-4;){var F=E.read_shift(2),D=E.read_shift(2),L=E.l+D,ee={};switch(F){case 21589:A=E.read_shift(1),A&1&&(ee.mtime=E.read_shift(4)),D>5&&(A&2&&(ee.atime=E.read_shift(4)),A&4&&(ee.ctime=E.read_shift(4))),ee.mtime&&(ee.mt=new Date(ee.mtime*1e3));break}E.l=L,I[F]=ee}return I}var c;function u(){return c||(c={})}function d(E,I){if(E[0]==80&&E[1]==75)return xs(E,I);if((E[0]|32)==109&&(E[1]|32)==105)return Uo(E,I);if(E.length<512)throw new Error("CFB file size "+E.length+" < 512");var A=3,F=512,D=0,L=0,ee=0,de=0,Z=0,te=[],re=E.slice(0,512);pr(re,0);var _e=f(re);switch(A=_e[0],A){case 3:F=512;break;case 4:F=4096;break;case 0:if(_e[1]==0)return xs(E,I);default:throw new Error("Major Version: Expected 3 or 4 saw "+A)}F!==512&&(re=E.slice(0,F),pr(re,28));var Ae=E.slice(0,F);h(re,A);var Ie=re.read_shift(4,"i");if(A===3&&Ie!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ie);re.l+=4,ee=re.read_shift(4,"i"),re.l+=4,re.chk("00100000","Mini Stream Cutoff Size: "),de=re.read_shift(4,"i"),D=re.read_shift(4,"i"),Z=re.read_shift(4,"i"),L=re.read_shift(4,"i");for(var Ne=-1,Re=0;Re<109&&(Ne=re.read_shift(4,"i"),!(Ne<0));++Re)te[Re]=Ne;var Ge=m(E,F);g(Z,L,Ge,F,te);var jt=v(Ge,ee,te,F);jt[ee].name="!Directory",D>0&&de!==K&&(jt[de].name="!MiniFAT"),jt[te[0]].name="!FAT",jt.fat_addrs=te,jt.ssz=F;var Tt={},yr=[],zo=[],$o=[];y(ee,jt,Ge,yr,D,Tt,zo,de),x(zo,$o,yr),yr.shift();var Vo={FileIndex:zo,FullPaths:$o};return I&&I.raw&&(Vo.raw={header:Ae,sectors:Ge}),Vo}function f(E){if(E[E.l]==80&&E[E.l+1]==75)return[0,0];E.chk(Y,"Header Signature: "),E.l+=16;var I=E.read_shift(2,"u");return[E.read_shift(2,"u"),I]}function h(E,I){var A=9;switch(E.l+=2,A=E.read_shift(2)){case 9:if(I!=3)throw new Error("Sector Shift: Expected 9 saw "+A);break;case 12:if(I!=4)throw new Error("Sector Shift: Expected 12 saw "+A);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+A)}E.chk("0600","Mini Sector Shift: "),E.chk("000000000000","Reserved: ")}function m(E,I){for(var A=Math.ceil(E.length/I)-1,F=[],D=1;D<A;++D)F[D-1]=E.slice(D*I,(D+1)*I);return F[A-1]=E.slice(A*I),F}function x(E,I,A){for(var F=0,D=0,L=0,ee=0,de=0,Z=A.length,te=[],re=[];F<Z;++F)te[F]=re[F]=F,I[F]=A[F];for(;de<re.length;++de)F=re[de],D=E[F].L,L=E[F].R,ee=E[F].C,te[F]===F&&(D!==-1&&te[D]!==D&&(te[F]=te[D]),L!==-1&&te[L]!==L&&(te[F]=te[L])),ee!==-1&&(te[ee]=F),D!==-1&&F!=te[F]&&(te[D]=te[F],re.lastIndexOf(D)<de&&re.push(D)),L!==-1&&F!=te[F]&&(te[L]=te[F],re.lastIndexOf(L)<de&&re.push(L));for(F=1;F<Z;++F)te[F]===F&&(L!==-1&&te[L]!==L?te[F]=te[L]:D!==-1&&te[D]!==D&&(te[F]=te[D]));for(F=1;F<Z;++F)if(E[F].type!==0){if(de=F,de!=te[de])do de=te[de],I[F]=I[de]+"/"+I[F];while(de!==0&&te[de]!==-1&&de!=te[de]);te[F]=-1}for(I[0]+="/",F=1;F<Z;++F)E[F].type!==2&&(I[F]+="/")}function p(E,I,A){for(var F=E.start,D=E.size,L=[],ee=F;A&&D>0&&ee>=0;)L.push(I.slice(ee*V,ee*V+V)),D-=V,ee=Oa(A,ee*4);return L.length===0?le(0):lr(L).slice(0,E.size)}function g(E,I,A,F,D){var L=K;if(E===K){if(I!==0)throw new Error("DIFAT chain shorter than expected")}else if(E!==-1){var ee=A[E],de=(F>>>2)-1;if(!ee)return;for(var Z=0;Z<de&&(L=Oa(ee,Z*4))!==K;++Z)D.push(L);g(Oa(ee,F-4),I-1,A,F,D)}}function w(E,I,A,F,D){var L=[],ee=[];D||(D=[]);var de=F-1,Z=0,te=0;for(Z=I;Z>=0;){D[Z]=!0,L[L.length]=Z,ee.push(E[Z]);var re=A[Math.floor(Z*4/F)];if(te=Z*4&de,F<4+te)throw new Error("FAT boundary crossed: "+Z+" 4 "+F);if(!E[re])break;Z=Oa(E[re],te)}return{nodes:L,data:q1([ee])}}function v(E,I,A,F){var D=E.length,L=[],ee=[],de=[],Z=[],te=F-1,re=0,_e=0,Ae=0,Ie=0;for(re=0;re<D;++re)if(de=[],Ae=re+I,Ae>=D&&(Ae-=D),!ee[Ae]){Z=[];var Ne=[];for(_e=Ae;_e>=0;){Ne[_e]=!0,ee[_e]=!0,de[de.length]=_e,Z.push(E[_e]);var Re=A[Math.floor(_e*4/F)];if(Ie=_e*4&te,F<4+Ie)throw new Error("FAT boundary crossed: "+_e+" 4 "+F);if(!E[Re]||(_e=Oa(E[Re],Ie),Ne[_e]))break}L[Ae]={nodes:de,data:q1([Z])}}return L}function y(E,I,A,F,D,L,ee,de){for(var Z=0,te=F.length?2:0,re=I[E].data,_e=0,Ae=0,Ie;_e<re.length;_e+=128){var Ne=re.slice(_e,_e+128);pr(Ne,64),Ae=Ne.read_shift(2),Ie=Ux(Ne,0,Ae-te),F.push(Ie);var Re={name:Ie,type:Ne.read_shift(1),color:Ne.read_shift(1),L:Ne.read_shift(4,"i"),R:Ne.read_shift(4,"i"),C:Ne.read_shift(4,"i"),clsid:Ne.read_shift(16),state:Ne.read_shift(4,"i"),start:0,size:0},Ge=Ne.read_shift(2)+Ne.read_shift(2)+Ne.read_shift(2)+Ne.read_shift(2);Ge!==0&&(Re.ct=b(Ne,Ne.l-8));var jt=Ne.read_shift(2)+Ne.read_shift(2)+Ne.read_shift(2)+Ne.read_shift(2);jt!==0&&(Re.mt=b(Ne,Ne.l-8)),Re.start=Ne.read_shift(4,"i"),Re.size=Ne.read_shift(4,"i"),Re.size<0&&Re.start<0&&(Re.size=Re.type=0,Re.start=K,Re.name=""),Re.type===5?(Z=Re.start,D>0&&Z!==K&&(I[Z].name="!StreamData")):Re.size>=4096?(Re.storage="fat",I[Re.start]===void 0&&(I[Re.start]=w(A,Re.start,I.fat_addrs,I.ssz)),I[Re.start].name=Re.name,Re.content=I[Re.start].data.slice(0,Re.size)):(Re.storage="minifat",Re.size<0?Re.size=0:Z!==K&&Re.start!==K&&I[Z]&&(Re.content=p(Re,I[Z].data,(I[de]||{}).data))),Re.content&&pr(Re.content,0),L[Ie]=Re,ee.push(Re)}}function b(E,I){return new Date((ns(E,I+4)/1e7*Math.pow(2,32)+ns(E,I)/1e7-11644473600)*1e3)}function S(E,I){return u(),d(c.readFileSync(E),I)}function k(E,I){var A=I&&I.type;switch(A||Ze&&Buffer.isBuffer(E)&&(A="buffer"),A||"base64"){case"file":return S(E,I);case"base64":return d(os(fs(E)),I);case"binary":return d(os(E),I)}return d(E,I)}function _(E,I){var A=I||{},F=A.root||"Root Entry";if(E.FullPaths||(E.FullPaths=[]),E.FileIndex||(E.FileIndex=[]),E.FullPaths.length!==E.FileIndex.length)throw new Error("inconsistent CFB structure");E.FullPaths.length===0&&(E.FullPaths[0]=F+"/",E.FileIndex[0]={name:F,type:5}),A.CLSID&&(E.FileIndex[0].clsid=A.CLSID),N(E)}function N(E){var I="Sh33tJ5";if(!Me.find(E,"/"+I)){var A=le(4);A[0]=55,A[1]=A[3]=50,A[2]=54,E.FileIndex.push({name:I,type:2,content:A,size:4,L:69,R:69,C:69}),E.FullPaths.push(E.FullPaths[0]+I),C(E)}}function C(E,I){_(E);for(var A=!1,F=!1,D=E.FullPaths.length-1;D>=0;--D){var L=E.FileIndex[D];switch(L.type){case 0:F?A=!0:(E.FileIndex.pop(),E.FullPaths.pop());break;case 1:case 2:case 5:F=!0,isNaN(L.R*L.L*L.C)&&(A=!0),L.R>-1&&L.L>-1&&L.R==L.L&&(A=!0);break;default:A=!0;break}}if(!(!A&&!I)){var ee=new Date(1987,1,19),de=0,Z=Object.create?Object.create(null):{},te=[];for(D=0;D<E.FullPaths.length;++D)Z[E.FullPaths[D]]=!0,E.FileIndex[D].type!==0&&te.push([E.FullPaths[D],E.FileIndex[D]]);for(D=0;D<te.length;++D){var re=s(te[D][0]);F=Z[re],F||(te.push([re,{name:n(re).replace("/",""),type:1,clsid:X,ct:ee,mt:ee,content:null}]),Z[re]=!0)}for(te.sort(function(Ie,Ne){return r(Ie[0],Ne[0])}),E.FullPaths=[],E.FileIndex=[],D=0;D<te.length;++D)E.FullPaths[D]=te[D][0],E.FileIndex[D]=te[D][1];for(D=0;D<te.length;++D){var _e=E.FileIndex[D],Ae=E.FullPaths[D];if(_e.name=n(Ae).replace("/",""),_e.L=_e.R=_e.C=-(_e.color=1),_e.size=_e.content?_e.content.length:0,_e.start=0,_e.clsid=_e.clsid||X,D===0)_e.C=te.length>1?1:-1,_e.size=0,_e.type=5;else if(Ae.slice(-1)=="/"){for(de=D+1;de<te.length&&s(E.FullPaths[de])!=Ae;++de);for(_e.C=de>=te.length?-1:de,de=D+1;de<te.length&&s(E.FullPaths[de])!=s(Ae);++de);_e.R=de>=te.length?-1:de,_e.type=1}else s(E.FullPaths[D+1]||"")==s(Ae)&&(_e.R=D+1),_e.type=2}}}function B(E,I){var A=I||{};if(A.fileType=="mad")return gg(E,A);switch(C(E),A.fileType){case"zip":return es(E,A)}var F=function(Ie){for(var Ne=0,Re=0,Ge=0;Ge<Ie.FileIndex.length;++Ge){var jt=Ie.FileIndex[Ge];if(jt.content){var Tt=jt.content.length;Tt>0&&(Tt<4096?Ne+=Tt+63>>6:Re+=Tt+511>>9)}}for(var yr=Ie.FullPaths.length+3>>2,zo=Ne+7>>3,$o=Ne+127>>7,Vo=zo+Re+yr+$o,ka=Vo+127>>7,T0=ka<=109?0:Math.ceil((ka-109)/127);Vo+ka+T0+127>>7>ka;)T0=++ka<=109?0:Math.ceil((ka-109)/127);var xn=[1,T0,ka,$o,yr,Re,Ne,0];return Ie.FileIndex[0].size=Ne<<6,xn[7]=(Ie.FileIndex[0].start=xn[0]+xn[1]+xn[2]+xn[3]+xn[4]+xn[5])+(xn[6]+7>>3),xn}(E),D=le(F[7]<<9),L=0,ee=0;{for(L=0;L<8;++L)D.write_shift(1,q[L]);for(L=0;L<8;++L)D.write_shift(2,0);for(D.write_shift(2,62),D.write_shift(2,3),D.write_shift(2,65534),D.write_shift(2,9),D.write_shift(2,6),L=0;L<3;++L)D.write_shift(2,0);for(D.write_shift(4,0),D.write_shift(4,F[2]),D.write_shift(4,F[0]+F[1]+F[2]+F[3]-1),D.write_shift(4,0),D.write_shift(4,4096),D.write_shift(4,F[3]?F[0]+F[1]+F[2]-1:K),D.write_shift(4,F[3]),D.write_shift(-4,F[1]?F[0]-1:K),D.write_shift(4,F[1]),L=0;L<109;++L)D.write_shift(-4,L<F[2]?F[1]+L:-1)}if(F[1])for(ee=0;ee<F[1];++ee){for(;L<236+ee*127;++L)D.write_shift(-4,L<F[2]?F[1]+L:-1);D.write_shift(-4,ee===F[1]-1?K:ee+1)}var de=function(Ie){for(ee+=Ie;L<ee-1;++L)D.write_shift(-4,L+1);Ie&&(++L,D.write_shift(-4,K))};for(ee=L=0,ee+=F[1];L<ee;++L)D.write_shift(-4,ie.DIFSECT);for(ee+=F[2];L<ee;++L)D.write_shift(-4,ie.FATSECT);de(F[3]),de(F[4]);for(var Z=0,te=0,re=E.FileIndex[0];Z<E.FileIndex.length;++Z)re=E.FileIndex[Z],re.content&&(te=re.content.length,!(te<4096)&&(re.start=ee,de(te+511>>9)));for(de(F[6]+7>>3);D.l&511;)D.write_shift(-4,ie.ENDOFCHAIN);for(ee=L=0,Z=0;Z<E.FileIndex.length;++Z)re=E.FileIndex[Z],re.content&&(te=re.content.length,!(!te||te>=4096)&&(re.start=ee,de(te+63>>6)));for(;D.l&511;)D.write_shift(-4,ie.ENDOFCHAIN);for(L=0;L<F[4]<<2;++L){var _e=E.FullPaths[L];if(!_e||_e.length===0){for(Z=0;Z<17;++Z)D.write_shift(4,0);for(Z=0;Z<3;++Z)D.write_shift(4,-1);for(Z=0;Z<12;++Z)D.write_shift(4,0);continue}re=E.FileIndex[L],L===0&&(re.start=re.size?re.start-1:K);var Ae=L===0&&A.root||re.name;if(te=2*(Ae.length+1),D.write_shift(64,Ae,"utf16le"),D.write_shift(2,te),D.write_shift(1,re.type),D.write_shift(1,re.color),D.write_shift(-4,re.L),D.write_shift(-4,re.R),D.write_shift(-4,re.C),re.clsid)D.write_shift(16,re.clsid,"hex");else for(Z=0;Z<4;++Z)D.write_shift(4,0);D.write_shift(4,re.state||0),D.write_shift(4,0),D.write_shift(4,0),D.write_shift(4,0),D.write_shift(4,0),D.write_shift(4,re.start),D.write_shift(4,re.size),D.write_shift(4,0)}for(L=1;L<E.FileIndex.length;++L)if(re=E.FileIndex[L],re.size>=4096)if(D.l=re.start+1<<9,Ze&&Buffer.isBuffer(re.content))re.content.copy(D,D.l,0,re.size),D.l+=re.size+511&-512;else{for(Z=0;Z<re.size;++Z)D.write_shift(1,re.content[Z]);for(;Z&511;++Z)D.write_shift(1,0)}for(L=1;L<E.FileIndex.length;++L)if(re=E.FileIndex[L],re.size>0&&re.size<4096)if(Ze&&Buffer.isBuffer(re.content))re.content.copy(D,D.l,0,re.size),D.l+=re.size+63&-64;else{for(Z=0;Z<re.size;++Z)D.write_shift(1,re.content[Z]);for(;Z&63;++Z)D.write_shift(1,0)}if(Ze)D.l=D.length;else for(;D.l<D.length;)D.write_shift(1,0);return D}function H(E,I){var A=E.FullPaths.map(function(Z){return Z.toUpperCase()}),F=A.map(function(Z){var te=Z.split("/");return te[te.length-(Z.slice(-1)=="/"?2:1)]}),D=!1;I.charCodeAt(0)===47?(D=!0,I=A[0].slice(0,-1)+I):D=I.indexOf("/")!==-1;var L=I.toUpperCase(),ee=D===!0?A.indexOf(L):F.indexOf(L);if(ee!==-1)return E.FileIndex[ee];var de=!L.match(ol);for(L=L.replace(zr,""),de&&(L=L.replace(ol,"!")),ee=0;ee<A.length;++ee)if((de?A[ee].replace(ol,"!"):A[ee]).replace(zr,"")==L||(de?F[ee].replace(ol,"!"):F[ee]).replace(zr,"")==L)return E.FileIndex[ee];return null}var V=64,K=-2,Y="d0cf11e0a1b11ae1",q=[208,207,17,224,161,177,26,225],X="00000000000000000000000000000000",ie={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:K,FREESECT:-1,HEADER_SIGNATURE:Y,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:X,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function W(E,I,A){u();var F=B(E,A);c.writeFileSync(I,F)}function U(E){for(var I=new Array(E.length),A=0;A<E.length;++A)I[A]=String.fromCharCode(E[A]);return I.join("")}function he(E,I){var A=B(E,I);switch(I&&I.type||"buffer"){case"file":return u(),c.writeFileSync(I.filename,A),A;case"binary":return typeof A=="string"?A:U(A);case"base64":return lc(typeof A=="string"?A:U(A));case"buffer":if(Ze)return Buffer.isBuffer(A)?A:Dn(A);case"array":return typeof A=="string"?os(A):A}return A}var be;function R(E){try{var I=E.InflateRaw,A=new I;if(A._processChunk(new Uint8Array([3,0]),A._finishFlushFlag),A.bytesRead)be=E;else throw new Error("zlib does not expose bytesRead")}catch(F){console.error("cannot use native zlib: "+(F.message||F))}}function M(E,I){if(!be)return Ir(E,I);var A=be.InflateRaw,F=new A,D=F._processChunk(E.slice(E.l),F._finishFlushFlag);return E.l+=F.bytesRead,D}function O(E){return be?be.deflateRawSync(E):xe(E)}var z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],J=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],pe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ge(E){var I=(E<<1|E<<11)&139536|(E<<5|E<<15)&558144;return(I>>16|I>>8|I)&255}for(var ne=typeof Uint8Array<"u",ae=ne?new Uint8Array(256):[],Ce=0;Ce<256;++Ce)ae[Ce]=ge(Ce);function P(E,I){var A=ae[E&255];return I<=8?A>>>8-I:(A=A<<8|ae[E>>8&255],I<=16?A>>>16-I:(A=A<<8|ae[E>>16&255],A>>>24-I))}function ce(E,I){var A=I&7,F=I>>>3;return(E[F]|(A<=6?0:E[F+1]<<8))>>>A&3}function ue(E,I){var A=I&7,F=I>>>3;return(E[F]|(A<=5?0:E[F+1]<<8))>>>A&7}function Ee(E,I){var A=I&7,F=I>>>3;return(E[F]|(A<=4?0:E[F+1]<<8))>>>A&15}function T(E,I){var A=I&7,F=I>>>3;return(E[F]|(A<=3?0:E[F+1]<<8))>>>A&31}function G(E,I){var A=I&7,F=I>>>3;return(E[F]|(A<=1?0:E[F+1]<<8))>>>A&127}function Q(E,I,A){var F=I&7,D=I>>>3,L=(1<<A)-1,ee=E[D]>>>F;return A<8-F||(ee|=E[D+1]<<8-F,A<16-F)||(ee|=E[D+2]<<16-F,A<24-F)||(ee|=E[D+3]<<24-F),ee&L}function me(E,I,A){var F=I&7,D=I>>>3;return F<=5?E[D]|=(A&7)<<F:(E[D]|=A<<F&255,E[D+1]=(A&7)>>8-F),I+3}function fe(E,I,A){var F=I&7,D=I>>>3;return A=(A&1)<<F,E[D]|=A,I+1}function oe(E,I,A){var F=I&7,D=I>>>3;return A<<=F,E[D]|=A&255,A>>>=8,E[D+1]=A,I+8}function ke(E,I,A){var F=I&7,D=I>>>3;return A<<=F,E[D]|=A&255,A>>>=8,E[D+1]=A&255,E[D+2]=A>>>8,I+16}function we(E,I){var A=E.length,F=2*A>I?2*A:I+5,D=0;if(A>=I)return E;if(Ze){var L=E1(F);if(E.copy)E.copy(L);else for(;D<E.length;++D)L[D]=E[D];return L}else if(ne){var ee=new Uint8Array(F);if(ee.set)ee.set(E);else for(;D<A;++D)ee[D]=E[D];return ee}return E.length=F,E}function Pe(E){for(var I=new Array(E),A=0;A<E;++A)I[A]=0;return I}function Ue(E,I,A){var F=1,D=0,L=0,ee=0,de=0,Z=E.length,te=ne?new Uint16Array(32):Pe(32);for(L=0;L<32;++L)te[L]=0;for(L=Z;L<A;++L)E[L]=0;Z=E.length;var re=ne?new Uint16Array(Z):Pe(Z);for(L=0;L<Z;++L)te[D=E[L]]++,F<D&&(F=D),re[L]=0;for(te[0]=0,L=1;L<=F;++L)te[L+16]=de=de+te[L-1]<<1;for(L=0;L<Z;++L)de=E[L],de!=0&&(re[L]=te[de+16]++);var _e=0;for(L=0;L<Z;++L)if(_e=E[L],_e!=0)for(de=P(re[L],F)>>F-_e,ee=(1<<F+4-_e)-1;ee>=0;--ee)I[de|ee<<_e]=_e&15|L<<4;return F}var et=ne?new Uint16Array(512):Pe(512),nt=ne?new Uint16Array(32):Pe(32);if(!ne){for(var He=0;He<512;++He)et[He]=0;for(He=0;He<32;++He)nt[He]=0}(function(){for(var E=[],I=0;I<32;I++)E.push(5);Ue(E,nt,32);var A=[];for(I=0;I<=143;I++)A.push(8);for(;I<=255;I++)A.push(9);for(;I<=279;I++)A.push(7);for(;I<=287;I++)A.push(8);Ue(A,et,288)})();var Be=function(){for(var I=ne?new Uint8Array(32768):[],A=0,F=0;A<pe.length-1;++A)for(;F<pe[A+1];++F)I[F]=A;for(;F<32768;++F)I[F]=29;var D=ne?new Uint8Array(259):[];for(A=0,F=0;A<J.length-1;++A)for(;F<J[A+1];++F)D[F]=A;function L(de,Z){for(var te=0;te<de.length;){var re=Math.min(65535,de.length-te),_e=te+re==de.length;for(Z.write_shift(1,+_e),Z.write_shift(2,re),Z.write_shift(2,~re&65535);re-- >0;)Z[Z.l++]=de[te++]}return Z.l}function ee(de,Z){for(var te=0,re=0,_e=ne?new Uint16Array(32768):[];re<de.length;){var Ae=Math.min(65535,de.length-re);if(Ae<10){for(te=me(Z,te,+(re+Ae==de.length)),te&7&&(te+=8-(te&7)),Z.l=te/8|0,Z.write_shift(2,Ae),Z.write_shift(2,~Ae&65535);Ae-- >0;)Z[Z.l++]=de[re++];te=Z.l*8;continue}te=me(Z,te,+(re+Ae==de.length)+2);for(var Ie=0;Ae-- >0;){var Ne=de[re];Ie=(Ie<<5^Ne)&32767;var Re=-1,Ge=0;if((Re=_e[Ie])&&(Re|=re&-32768,Re>re&&(Re-=32768),Re<re))for(;de[Re+Ge]==de[re+Ge]&&Ge<250;)++Ge;if(Ge>2){Ne=D[Ge],Ne<=22?te=oe(Z,te,ae[Ne+1]>>1)-1:(oe(Z,te,3),te+=5,oe(Z,te,ae[Ne-23]>>5),te+=3);var jt=Ne<8?0:Ne-4>>2;jt>0&&(ke(Z,te,Ge-J[Ne]),te+=jt),Ne=I[re-Re],te=oe(Z,te,ae[Ne]>>3),te-=3;var Tt=Ne<4?0:Ne-2>>1;Tt>0&&(ke(Z,te,re-Re-pe[Ne]),te+=Tt);for(var yr=0;yr<Ge;++yr)_e[Ie]=re&32767,Ie=(Ie<<5^de[re])&32767,++re;Ae-=Ge-1}else Ne<=143?Ne=Ne+48:te=fe(Z,te,1),te=oe(Z,te,ae[Ne]),_e[Ie]=re&32767,++re}te=oe(Z,te,0)-1}return Z.l=(te+7)/8|0,Z.l}return function(Z,te){return Z.length<8?L(Z,te):ee(Z,te)}}();function xe(E){var I=le(50+Math.floor(E.length*1.1)),A=Be(E,I);return I.slice(0,A)}var Xe=ne?new Uint16Array(32768):Pe(32768),pt=ne?new Uint16Array(32768):Pe(32768),tt=ne?new Uint16Array(128):Pe(128),ar=1,ve=1;function Ye(E,I){var A=T(E,I)+257;I+=5;var F=T(E,I)+1;I+=5;var D=Ee(E,I)+4;I+=4;for(var L=0,ee=ne?new Uint8Array(19):Pe(19),de=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Z=1,te=ne?new Uint8Array(8):Pe(8),re=ne?new Uint8Array(8):Pe(8),_e=ee.length,Ae=0;Ae<D;++Ae)ee[z[Ae]]=L=ue(E,I),Z<L&&(Z=L),te[L]++,I+=3;var Ie=0;for(te[0]=0,Ae=1;Ae<=Z;++Ae)re[Ae]=Ie=Ie+te[Ae-1]<<1;for(Ae=0;Ae<_e;++Ae)(Ie=ee[Ae])!=0&&(de[Ae]=re[Ie]++);var Ne=0;for(Ae=0;Ae<_e;++Ae)if(Ne=ee[Ae],Ne!=0){Ie=ae[de[Ae]]>>8-Ne;for(var Re=(1<<7-Ne)-1;Re>=0;--Re)tt[Ie|Re<<Ne]=Ne&7|Ae<<3}var Ge=[];for(Z=1;Ge.length<A+F;)switch(Ie=tt[G(E,I)],I+=Ie&7,Ie>>>=3){case 16:for(L=3+ce(E,I),I+=2,Ie=Ge[Ge.length-1];L-- >0;)Ge.push(Ie);break;case 17:for(L=3+ue(E,I),I+=3;L-- >0;)Ge.push(0);break;case 18:for(L=11+G(E,I),I+=7;L-- >0;)Ge.push(0);break;default:Ge.push(Ie),Z<Ie&&(Z=Ie);break}var jt=Ge.slice(0,A),Tt=Ge.slice(A);for(Ae=A;Ae<286;++Ae)jt[Ae]=0;for(Ae=F;Ae<30;++Ae)Tt[Ae]=0;return ar=Ue(jt,Xe,286),ve=Ue(Tt,pt,30),I}function Et(E,I){if(E[0]==3&&!(E[1]&3))return[da(I),2];for(var A=0,F=0,D=E1(I||1<<18),L=0,ee=D.length>>>0,de=0,Z=0;!(F&1);){if(F=ue(E,A),A+=3,F>>>1)F>>1==1?(de=9,Z=5):(A=Ye(E,A),de=ar,Z=ve);else{A&7&&(A+=8-(A&7));var te=E[A>>>3]|E[(A>>>3)+1]<<8;if(A+=32,te>0)for(!I&&ee<L+te&&(D=we(D,L+te),ee=D.length);te-- >0;)D[L++]=E[A>>>3],A+=8;continue}for(;;){!I&&ee<L+32767&&(D=we(D,L+32767),ee=D.length);var re=Q(E,A,de),_e=F>>>1==1?et[re]:Xe[re];if(A+=_e&15,_e>>>=4,!(_e>>>8&255))D[L++]=_e;else{if(_e==256)break;_e-=257;var Ae=_e<8?0:_e-4>>2;Ae>5&&(Ae=0);var Ie=L+J[_e];Ae>0&&(Ie+=Q(E,A,Ae),A+=Ae),re=Q(E,A,Z),_e=F>>>1==1?nt[re]:pt[re],A+=_e&15,_e>>>=4;var Ne=_e<4?0:_e-2>>1,Re=pe[_e];for(Ne>0&&(Re+=Q(E,A,Ne),A+=Ne),!I&&ee<Ie&&(D=we(D,Ie+100),ee=D.length);L<Ie;)D[L]=D[L-Re],++L}}}return I?[D,A+7>>>3]:[D.slice(0,L),A+7>>>3]}function Ir(E,I){var A=E.slice(E.l||0),F=Et(A,I);return E.l+=F[1],F[0]}function Ht(E,I){if(E)typeof console<"u"&&console.error(I);else throw new Error(I)}function xs(E,I){var A=E;pr(A,0);var F=[],D=[],L={FileIndex:F,FullPaths:D};_(L,{root:I.root});for(var ee=A.length-4;(A[ee]!=80||A[ee+1]!=75||A[ee+2]!=5||A[ee+3]!=6)&&ee>=0;)--ee;A.l=ee+4,A.l+=4;var de=A.read_shift(2);A.l+=6;var Z=A.read_shift(4);for(A.l=Z,ee=0;ee<de;++ee){A.l+=20;var te=A.read_shift(4),re=A.read_shift(4),_e=A.read_shift(2),Ae=A.read_shift(2),Ie=A.read_shift(2);A.l+=8;var Ne=A.read_shift(4),Re=l(A.slice(A.l+_e,A.l+_e+Ae));A.l+=_e+Ae+Ie;var Ge=A.l;A.l=Ne+4,pn(A,te,re,L,Re),A.l=Ge}return L}function pn(E,I,A,F,D){E.l+=2;var L=E.read_shift(2),ee=E.read_shift(2),de=i(E);if(L&8257)throw new Error("Unsupported ZIP encryption");for(var Z=E.read_shift(4),te=E.read_shift(4),re=E.read_shift(4),_e=E.read_shift(2),Ae=E.read_shift(2),Ie="",Ne=0;Ne<_e;++Ne)Ie+=String.fromCharCode(E[E.l++]);if(Ae){var Re=l(E.slice(E.l,E.l+Ae));(Re[21589]||{}).mt&&(de=Re[21589].mt),((D||{})[21589]||{}).mt&&(de=D[21589].mt)}E.l+=Ae;var Ge=E.slice(E.l,E.l+te);switch(ee){case 8:Ge=M(E,re);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ee)}var jt=!1;L&8&&(Z=E.read_shift(4),Z==134695760&&(Z=E.read_shift(4),jt=!0),te=E.read_shift(4),re=E.read_shift(4)),te!=I&&Ht(jt,"Bad compressed size: "+I+" != "+te),re!=A&&Ht(jt,"Bad uncompressed size: "+A+" != "+re),$c(F,Ie,Ge,{unsafe:!0,mt:de})}function es(E,I){var A=I||{},F=[],D=[],L=le(1),ee=A.compression?8:0,de=0,Z=0,te=0,re=0,_e=0,Ae=E.FullPaths[0],Ie=Ae,Ne=E.FileIndex[0],Re=[],Ge=0;for(Z=1;Z<E.FullPaths.length;++Z)if(Ie=E.FullPaths[Z].slice(Ae.length),Ne=E.FileIndex[Z],!(!Ne.size||!Ne.content||Ie=="Sh33tJ5")){var jt=re,Tt=le(Ie.length);for(te=0;te<Ie.length;++te)Tt.write_shift(1,Ie.charCodeAt(te)&127);Tt=Tt.slice(0,Tt.l),Re[_e]=AI.buf(Ne.content,0);var yr=Ne.content;ee==8&&(yr=O(yr)),L=le(30),L.write_shift(4,67324752),L.write_shift(2,20),L.write_shift(2,de),L.write_shift(2,ee),Ne.mt?a(L,Ne.mt):L.write_shift(4,0),L.write_shift(-4,Re[_e]),L.write_shift(4,yr.length),L.write_shift(4,Ne.content.length),L.write_shift(2,Tt.length),L.write_shift(2,0),re+=L.length,F.push(L),re+=Tt.length,F.push(Tt),re+=yr.length,F.push(yr),L=le(46),L.write_shift(4,33639248),L.write_shift(2,0),L.write_shift(2,20),L.write_shift(2,de),L.write_shift(2,ee),L.write_shift(4,0),L.write_shift(-4,Re[_e]),L.write_shift(4,yr.length),L.write_shift(4,Ne.content.length),L.write_shift(2,Tt.length),L.write_shift(2,0),L.write_shift(2,0),L.write_shift(2,0),L.write_shift(2,0),L.write_shift(4,0),L.write_shift(4,jt),Ge+=L.l,D.push(L),Ge+=Tt.length,D.push(Tt),++_e}return L=le(22),L.write_shift(4,101010256),L.write_shift(2,0),L.write_shift(2,0),L.write_shift(2,_e),L.write_shift(2,_e),L.write_shift(4,Ge),L.write_shift(4,re),L.write_shift(2,0),lr([lr(F),lr(D),L])}var at={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function yi(E,I){if(E.ctype)return E.ctype;var A=E.name||"",F=A.match(/\.([^\.]+)$/);return F&&at[F[1]]||I&&(F=(A=I).match(/[\.\\]([^\.\\])+$/),F&&at[F[1]])?at[F[1]]:"application/octet-stream"}function k0(E){for(var I=lc(E),A=[],F=0;F<I.length;F+=76)A.push(I.slice(F,F+76));return A.join(`\r
`)+`\r
`}function N0(E){var I=E.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(te){var re=te.charCodeAt(0).toString(16).toUpperCase();return"="+(re.length==1?"0"+re:re)});I=I.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),I.charAt(0)==`
`&&(I="=0D"+I.slice(1)),I=I.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var A=[],F=I.split(`\r
`),D=0;D<F.length;++D){var L=F[D];if(L.length==0){A.push("");continue}for(var ee=0;ee<L.length;){var de=76,Z=L.slice(ee,ee+de);Z.charAt(de-1)=="="?de--:Z.charAt(de-2)=="="?de-=2:Z.charAt(de-3)=="="&&(de-=3),Z=L.slice(ee,ee+de),ee+=de,ee<L.length&&(Z+="="),A.push(Z)}}return A.join(`\r
`)}function zc(E){for(var I=[],A=0;A<E.length;++A){for(var F=E[A];A<=E.length&&F.charAt(F.length-1)=="=";)F=F.slice(0,F.length-1)+E[++A];I.push(F)}for(var D=0;D<I.length;++D)I[D]=I[D].replace(/[=][0-9A-Fa-f]{2}/g,function(L){return String.fromCharCode(parseInt(L.slice(1),16))});return os(I.join(`\r
`))}function E0(E,I,A){for(var F="",D="",L="",ee,de=0;de<10;++de){var Z=I[de];if(!Z||Z.match(/^\s*$/))break;var te=Z.match(/^(.*?):\s*([^\s].*)$/);if(te)switch(te[1].toLowerCase()){case"content-location":F=te[2].trim();break;case"content-type":L=te[2].trim();break;case"content-transfer-encoding":D=te[2].trim();break}}switch(++de,D.toLowerCase()){case"base64":ee=os(fs(I.slice(de).join("")));break;case"quoted-printable":ee=zc(I.slice(de));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+D)}var re=$c(E,F.slice(A.length),ee,{unsafe:!0});L&&(re.ctype=L)}function Uo(E,I){if(U(E.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var A=I&&I.root||"",F=(Ze&&Buffer.isBuffer(E)?E.toString("binary"):U(E)).split(`\r
`),D=0,L="";for(D=0;D<F.length;++D)if(L=F[D],!!/^Content-Location:/i.test(L)&&(L=L.slice(L.indexOf("file")),A||(A=L.slice(0,L.lastIndexOf("/")+1)),L.slice(0,A.length)!=A))for(;A.length>0&&(A=A.slice(0,A.length-1),A=A.slice(0,A.lastIndexOf("/")+1),L.slice(0,A.length)!=A););var ee=(F[1]||"").match(/boundary="(.*?)"/);if(!ee)throw new Error("MAD cannot find boundary");var de="--"+(ee[1]||""),Z=[],te=[],re={FileIndex:Z,FullPaths:te};_(re);var _e,Ae=0;for(D=0;D<F.length;++D){var Ie=F[D];Ie!==de&&Ie!==de+"--"||(Ae++&&E0(re,F.slice(_e,D),A),_e=D)}return re}function gg(E,I){var A=I||{},F=A.boundary||"SheetJS";F="------="+F;for(var D=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+F.slice(2)+'"',"","",""],L=E.FullPaths[0],ee=L,de=E.FileIndex[0],Z=1;Z<E.FullPaths.length;++Z)if(ee=E.FullPaths[Z].slice(L.length),de=E.FileIndex[Z],!(!de.size||!de.content||ee=="Sh33tJ5")){ee=ee.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ge){return"_x"+Ge.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ge){return"_u"+Ge.charCodeAt(0).toString(16)+"_"});for(var te=de.content,re=Ze&&Buffer.isBuffer(te)?te.toString("binary"):U(te),_e=0,Ae=Math.min(1024,re.length),Ie=0,Ne=0;Ne<=Ae;++Ne)(Ie=re.charCodeAt(Ne))>=32&&Ie<128&&++_e;var Re=_e>=Ae*4/5;D.push(F),D.push("Content-Location: "+(A.root||"file:///C:/SheetJS/")+ee),D.push("Content-Transfer-Encoding: "+(Re?"quoted-printable":"base64")),D.push("Content-Type: "+yi(de,ee)),D.push(""),D.push(Re?N0(re):k0(re))}return D.push(F+`--\r
`),D.join(`\r
`)}function vg(E){var I={};return _(I,E),I}function $c(E,I,A,F){var D=F&&F.unsafe;D||_(E);var L=!D&&Me.find(E,I);if(!L){var ee=E.FullPaths[0];I.slice(0,ee.length)==ee?ee=I:(ee.slice(-1)!="/"&&(ee+="/"),ee=(ee+I).replace("//","/")),L={name:n(I),type:2},E.FileIndex.push(L),E.FullPaths.push(ee),D||Me.utils.cfb_gc(E)}return L.content=A,L.size=A?A.length:0,F&&(F.CLSID&&(L.clsid=F.CLSID),F.mt&&(L.mt=F.mt),F.ct&&(L.ct=F.ct)),L}function yg(E,I){_(E);var A=Me.find(E,I);if(A){for(var F=0;F<E.FileIndex.length;++F)if(E.FileIndex[F]==A)return E.FileIndex.splice(F,1),E.FullPaths.splice(F,1),!0}return!1}function j0(E,I,A){_(E);var F=Me.find(E,I);if(F){for(var D=0;D<E.FileIndex.length;++D)if(E.FileIndex[D]==F)return E.FileIndex[D].name=n(A),E.FullPaths[D]=A,!0}return!1}function Vc(E){C(E,!0)}return t.find=H,t.read=k,t.parse=d,t.write=he,t.writeFile=W,t.utils={cfb_new:vg,cfb_add:$c,cfb_del:yg,cfb_mov:j0,cfb_gc:Vc,ReadShift:Nl,CheckField:kN,prep_blob:pr,bconcat:lr,use_zlib:R,_deflateRaw:xe,_inflateRaw:Ir,consts:ie},t}();function FI(e){return typeof e=="string"?p0(e):Array.isArray(e)?sI(e):e}function Rc(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=p0(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var s=r=="utf8"?ln(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(s,e);if(typeof Blob<"u"){var n=new Blob([FI(s)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(n,e);if(typeof saveAs<"u")return saveAs(n,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var a=URL.createObjectURL(n);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),chrome.downloads.download({url:a,filename:e,saveAs:!0});var i=document.createElement("a");if(i.download!=null)return i.download=e,i.href=a,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),a}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(e);return l.open("w"),l.encoding="binary",Array.isArray(t)&&(t=ba(t)),l.write(t),l.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function PI(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(s){if(!s.message||!s.message.match(/onstruct/))throw s}throw new Error("Cannot access file "+e)}function Ut(e){for(var t=Object.keys(e),r=[],s=0;s<t.length;++s)Object.prototype.hasOwnProperty.call(e,t[s])&&r.push(t[s]);return r}function I1(e,t){for(var r=[],s=Ut(e),n=0;n!==s.length;++n)r[e[s[n]][t]]==null&&(r[e[s[n]][t]]=s[n]);return r}function g0(e){for(var t=[],r=Ut(e),s=0;s!==r.length;++s)t[e[r[s]]]=r[s];return t}function v0(e){for(var t=[],r=Ut(e),s=0;s!==r.length;++s)t[e[r[s]]]=parseInt(r[s],10);return t}function RI(e){for(var t=[],r=Ut(e),s=0;s!==r.length;++s)t[e[r[s]]]==null&&(t[e[r[s]]]=[]),t[e[r[s]]].push(r[s]);return t}var Id=new Date(1899,11,30,0,0,0);function nr(e,t){var r=e.getTime(),s=Id.getTime()+(e.getTimezoneOffset()-Id.getTimezoneOffset())*6e4;return(r-s)/(24*60*60*1e3)}var sN=new Date,II=Id.getTime()+(sN.getTimezoneOffset()-Id.getTimezoneOffset())*6e4,O1=sN.getTimezoneOffset();function y0(e){var t=new Date;return t.setTime(e*24*60*60*1e3+II),t.getTimezoneOffset()!==O1&&t.setTime(t.getTime()+(t.getTimezoneOffset()-O1)*6e4),t}function OI(e){var t=0,r=0,s=!1,n=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!n)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var a=1;a!=n.length;++a)if(n[a]){switch(r=1,a>3&&(s=!0),n[a].slice(n[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+n[a].slice(n[a].length-1));case"D":r*=24;case"H":r*=60;case"M":if(s)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(n[a],10)}return t}var D1=new Date("2017-02-19T19:06:09.000Z"),nN=isNaN(D1.getFullYear())?new Date("2/19/17"):D1,DI=nN.getFullYear()==2017;function _t(e,t){var r=new Date(e);if(DI)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(nN.getFullYear()==1917&&!isNaN(r.getFullYear())){var s=r.getFullYear();return e.indexOf(""+s)>-1||r.setFullYear(r.getFullYear()+100),r}var n=e.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function ai(e,t){if(Ze&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return ln(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return ln(qk(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return ln(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return ln(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(a){return r[a]||a})}catch{}for(var s=[],n=0;n!=e.length;++n)s.push(String.fromCharCode(e[n]));return s.join("")}function St(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=St(e[r]));return t}function Mt(e,t){for(var r="";r.length<t;)r+=e;return r}function Ys(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,s=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(s))||(s=s.replace(/[(](.*)[)]/,function(n,a){return r=-r,a}),!isNaN(t=Number(s)))?t/r:t}var LI=["january","february","march","april","may","june","july","august","september","october","november","december"];function So(e){var t=new Date(e),r=new Date(NaN),s=t.getYear(),n=t.getMonth(),a=t.getDate();if(isNaN(a))return r;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&LI.indexOf(i)==-1)return r}else if(i.match(/[a-z]/))return r;return s<0||s>8099?r:(n>0||a>1)&&s!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var MI=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,s,n){if(e||typeof s=="string")return r.split(s);for(var a=r.split(s),i=[a[0]],l=1;l<a.length;++l)i.push(n),i.push(a[l]);return i}}();function aN(e){return e?e.content&&e.type?ai(e.content,!0):e.data?il(e.data):e.asNodeBuffer&&Ze?il(e.asNodeBuffer().toString("binary")):e.asBinary?il(e.asBinary()):e._data&&e._data.getContent?il(ai(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function iN(e){if(!e)return null;if(e.data)return k1(e.data);if(e.asNodeBuffer&&Ze)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?k1(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function BI(e){return e&&e.name.slice(-4)===".bin"?iN(e):aN(e)}function Ss(e,t){for(var r=e.FullPaths||Ut(e.files),s=t.toLowerCase().replace(/[\/]/g,"\\"),n=s.replace(/\\/g,"/"),a=0;a<r.length;++a){var i=r[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(s==i||n==i)return e.files?e.files[r[a]]:e.FileIndex[a]}return null}function Ix(e,t){var r=Ss(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Kt(e,t,r){if(!r)return BI(Ix(e,t));if(!t)return null;try{return Kt(e,t)}catch{return null}}function ls(e,t,r){if(!r)return aN(Ix(e,t));if(!t)return null;try{return ls(e,t)}catch{return null}}function UI(e,t,r){return iN(Ix(e,t))}function L1(e){for(var t=e.FullPaths||Ut(e.files),r=[],s=0;s<t.length;++s)t[s].slice(-1)!="/"&&r.push(t[s].replace(/^Root Entry[\/]/,""));return r.sort()}function Qe(e,t,r){if(e.FullPaths){if(typeof r=="string"){var s;return Ze?s=Dn(r):s=nI(r),Me.utils.cfb_add(e,t,s)}Me.utils.cfb_add(e,t,r)}else e.file(t,r)}function Ox(){return Me.utils.cfb_new()}function oN(e,t){switch(t.type){case"base64":return Me.read(e,{type:"base64"});case"binary":return Me.read(e,{type:"binary"});case"buffer":case"array":return Me.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function ll(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var s=e.split("/");s.length!==0;){var n=s.shift();n===".."?r.pop():n!=="."&&r.push(n)}return r.join("/")}var qt=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,zI=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,M1=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,$I=/<[^>]*>/g,Rr=qt.match(M1)?M1:$I,VI=/<\w*:/,WI=/<(\/?)\w+:/;function qe(e,t,r){for(var s={},n=0,a=0;n!==e.length&&!((a=e.charCodeAt(n))===32||a===10||a===13);++n);if(t||(s[0]=e.slice(0,n)),n===e.length)return s;var i=e.match(zI),l=0,c="",u=0,d="",f="",h=1;if(i)for(u=0;u!=i.length;++u){for(f=i[u],a=0;a!=f.length&&f.charCodeAt(a)!==61;++a);for(d=f.slice(0,a).trim();f.charCodeAt(a+1)==32;)++a;for(h=(n=f.charCodeAt(a+1))==34||n==39?1:0,c=f.slice(a+1+h,f.length-h),l=0;l!=d.length&&d.charCodeAt(l)!==58;++l);if(l===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),s[d]=c,s[d.toLowerCase()]=c;else{var m=(l===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(l+1);if(s[m]&&d.slice(l-3,l)=="ext")continue;s[m]=c,s[m.toLowerCase()]=c}}return s}function hn(e){return e.replace(WI,"<$1")}var lN={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Dx=g0(lN),lt=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(s){var n=s+"",a=n.indexOf("<![CDATA[");if(a==-1)return n.replace(e,function(l,c){return lN[l]||String.fromCharCode(parseInt(c,l.indexOf("x")>-1?16:10))||l}).replace(t,function(l,c){return String.fromCharCode(parseInt(c,16))});var i=n.indexOf("]]>");return r(n.slice(0,a))+n.slice(a+9,i)+r(n.slice(i+3))}}(),Lx=/[&<>'"]/g,qI=/[\u0000-\u0008\u000b-\u001f]/g;function ht(e){var t=e+"";return t.replace(Lx,function(r){return Dx[r]}).replace(qI,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function B1(e){return ht(e).replace(/ /g,"_x0020_")}var cN=/[\u0000-\u001f]/g;function Mx(e){var t=e+"";return t.replace(Lx,function(r){return Dx[r]}).replace(/\n/g,"<br/>").replace(cN,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function HI(e){var t=e+"";return t.replace(Lx,function(r){return Dx[r]}).replace(cN,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var U1=function(){var e=/&#(\d+);/g;function t(r,s){return String.fromCharCode(parseInt(s,10))}return function(s){return s.replace(e,t)}}();function GI(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function wt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Pf(e){for(var t="",r=0,s=0,n=0,a=0,i=0,l=0;r<e.length;){if(s=e.charCodeAt(r++),s<128){t+=String.fromCharCode(s);continue}if(n=e.charCodeAt(r++),s>191&&s<224){i=(s&31)<<6,i|=n&63,t+=String.fromCharCode(i);continue}if(a=e.charCodeAt(r++),s<240){t+=String.fromCharCode((s&15)<<12|(n&63)<<6|a&63);continue}i=e.charCodeAt(r++),l=((s&7)<<18|(n&63)<<12|(a&63)<<6|i&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function z1(e){var t=da(2*e.length),r,s,n=1,a=0,i=0,l;for(s=0;s<e.length;s+=n)n=1,(l=e.charCodeAt(s))<128?r=l:l<224?(r=(l&31)*64+(e.charCodeAt(s+1)&63),n=2):l<240?(r=(l&15)*4096+(e.charCodeAt(s+1)&63)*64+(e.charCodeAt(s+2)&63),n=3):(n=4,r=(l&7)*262144+(e.charCodeAt(s+1)&63)*4096+(e.charCodeAt(s+2)&63)*64+(e.charCodeAt(s+3)&63),r-=65536,i=55296+(r>>>10&1023),r=56320+(r&1023)),i!==0&&(t[a++]=i&255,t[a++]=i>>>8,i=0),t[a++]=r%256,t[a++]=r>>>8;return t.slice(0,a).toString("ucs2")}function $1(e){return Dn(e,"binary").toString("utf8")}var bu="foo bar baz",xt=Ze&&($1(bu)==Pf(bu)&&$1||z1(bu)==Pf(bu)&&z1)||Pf,ln=Ze?function(e){return Dn(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,s=0,n=0;r<e.length;)switch(s=e.charCodeAt(r++),!0){case s<128:t.push(String.fromCharCode(s));break;case s<2048:t.push(String.fromCharCode(192+(s>>6))),t.push(String.fromCharCode(128+(s&63)));break;case(s>=55296&&s<57344):s-=55296,n=e.charCodeAt(r++)-56320+(s<<10),t.push(String.fromCharCode(240+(n>>18&7))),t.push(String.fromCharCode(144+(n>>12&63))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)));break;default:t.push(String.fromCharCode(224+(s>>12))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)))}return t.join("")},uc=function(){var e={};return function(r,s){var n=r+"|"+(s||"");return e[n]?e[n]:e[n]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",s||"")}}(),uN=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var s=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),n=0;n<e.length;++n)s=s.replace(e[n][0],e[n][1]);return s}}(),KI=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),XI=/<\/?(?:vt:)?variant>/g,QI=/<(?:vt:)([^>]*)>([\s\S]*)</;function V1(e,t){var r=qe(e),s=e.match(KI(r.baseType))||[],n=[];if(s.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+s.length+" != "+r.size);return n}return s.forEach(function(a){var i=a.replace(XI,"").match(QI);i&&n.push({v:xt(i[2]),t:i[1]})}),n}var dN=/(^\s|\s$|\n)/;function xr(e,t){return"<"+e+(t.match(dN)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function dc(e){return Ut(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function je(e,t,r){return"<"+e+(r!=null?dc(r):"")+(t!=null?(t.match(dN)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function jm(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function YI(e,t){switch(typeof e){case"string":var r=je("vt:lpwstr",ht(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return je((e|0)==e?"vt:i4":"vt:r8",ht(String(e)));case"boolean":return je("vt:bool",e?"true":"false")}if(e instanceof Date)return je("vt:filetime",jm(e));throw new Error("Unable to serialize "+e)}function Bx(e){if(Ze&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return xt(ba(Fx(e)));throw new Error("Bad input format: expected Buffer or string")}var fc=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,rr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},hi=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],ss={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function JI(e,t){for(var r=1-2*(e[t+7]>>>7),s=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),n=e[t+6]&15,a=5;a>=0;--a)n=n*256+e[t+a];return s==2047?n==0?r*(1/0):NaN:(s==0?s=-1022:(s-=1023,n+=Math.pow(2,52)),r*Math.pow(2,s-52)*n)}function ZI(e,t,r){var s=(t<0||1/t==-1/0?1:0)<<7,n=0,a=0,i=s?-t:t;isFinite(i)?i==0?n=a=0:(n=Math.floor(Math.log(i)/Math.LN2),a=i*Math.pow(2,52-n),n<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?n=-1022:(a-=Math.pow(2,52),n+=1023)):(n=2047,a=isNaN(t)?26985:0);for(var l=0;l<=5;++l,a/=256)e[r+l]=a&255;e[r+6]=(n&15)<<4|a&15,e[r+7]=n>>4|s}var W1=function(e){for(var t=[],r=10240,s=0;s<e[0].length;++s)if(e[0][s])for(var n=0,a=e[0][s].length;n<a;n+=r)t.push.apply(t,e[0][s].slice(n,n+r));return t},q1=Ze?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Dn(t)})):W1(e)}:W1,H1=function(e,t,r){for(var s=[],n=t;n<r;n+=2)s.push(String.fromCharCode(Sn(e,n)));return s.join("").replace(zr,"")},Ux=Ze?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(zr,""):H1(e,t,r)}:H1,G1=function(e,t,r){for(var s=[],n=t;n<t+r;++n)s.push(("0"+e[n].toString(16)).slice(-2));return s.join("")},fN=Ze?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):G1(e,t,r)}:G1,K1=function(e,t,r){for(var s=[],n=t;n<r;n++)s.push(String.fromCharCode(Fi(e,n)));return s.join("")},Ic=Ze?function(t,r,s){return Buffer.isBuffer(t)?t.toString("utf8",r,s):K1(t,r,s)}:K1,hN=function(e,t){var r=ns(e,t);return r>0?Ic(e,t+4,t+4+r-1):""},mN=hN,pN=function(e,t){var r=ns(e,t);return r>0?Ic(e,t+4,t+4+r-1):""},xN=pN,gN=function(e,t){var r=2*ns(e,t);return r>0?Ic(e,t+4,t+4+r-1):""},vN=gN,yN=function(t,r){var s=ns(t,r);return s>0?Ux(t,r+4,r+4+s):""},wN=yN,bN=function(e,t){var r=ns(e,t);return r>0?Ic(e,t+4,t+4+r):""},_N=bN,SN=function(e,t){return JI(e,t)},Od=SN,zx=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Ze&&(mN=function(t,r){if(!Buffer.isBuffer(t))return hN(t,r);var s=t.readUInt32LE(r);return s>0?t.toString("utf8",r+4,r+4+s-1):""},xN=function(t,r){if(!Buffer.isBuffer(t))return pN(t,r);var s=t.readUInt32LE(r);return s>0?t.toString("utf8",r+4,r+4+s-1):""},vN=function(t,r){if(!Buffer.isBuffer(t))return gN(t,r);var s=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+s-1)},wN=function(t,r){if(!Buffer.isBuffer(t))return yN(t,r);var s=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+s)},_N=function(t,r){if(!Buffer.isBuffer(t))return bN(t,r);var s=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+s)},Od=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):SN(t,r)},zx=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Fi=function(e,t){return e[t]},Sn=function(e,t){return e[t+1]*256+e[t]},eO=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},ns=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Oa=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},tO=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Nl(e,t){var r="",s,n,a=[],i,l,c,u;switch(t){case"dbcs":if(u=this.l,Ze&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(Sn(this,u)),u+=2;e*=2;break;case"utf8":r=Ic(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Ux(this,this.l,this.l+e);break;case"wstr":return Nl.call(this,e,"dbcs");case"lpstr-ansi":r=mN(this,this.l),e=4+ns(this,this.l);break;case"lpstr-cp":r=xN(this,this.l),e=4+ns(this,this.l);break;case"lpwstr":r=vN(this,this.l),e=4+2*ns(this,this.l);break;case"lpp4":e=4+ns(this,this.l),r=wN(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+ns(this,this.l),r=_N(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(i=Fi(this,this.l+e++))!==0;)a.push(wu(i));r=a.join("");break;case"_wstr":for(e=0,r="";(i=Sn(this,this.l+e))!==0;)a.push(wu(i)),e+=2;e+=2,r=a.join("");break;case"dbcs-cont":for(r="",u=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return i=Fi(this,u),this.l=u+1,l=Nl.call(this,e-c,i?"dbcs-cont":"sbcs-cont"),a.join("")+l;a.push(wu(Sn(this,u))),u+=2}r=a.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return i=Fi(this,u),this.l=u+1,l=Nl.call(this,e-c,i?"dbcs-cont":"sbcs-cont"),a.join("")+l;a.push(wu(Fi(this,u))),u+=1}r=a.join("");break;default:switch(e){case 1:return s=Fi(this,this.l),this.l++,s;case 2:return s=(t==="i"?eO:Sn)(this,this.l),this.l+=2,s;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(s=(e>0?Oa:tO)(this,this.l),this.l+=4,s):(n=ns(this,this.l),this.l+=4,n);case 8:case-8:if(t==="f")return e==8?n=Od(this,this.l):n=Od([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;e=8;case 16:r=fN(this,this.l,e);break}}return this.l+=e,r}var rO=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},sO=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},nO=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function aO(e,t,r){var s=0,n=0;if(r==="dbcs"){for(n=0;n!=t.length;++n)nO(this,t.charCodeAt(n),this.l+2*n);s=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=t.length;++n)this[this.l+n]=t.charCodeAt(n)&255;s=t.length}else if(r==="hex"){for(;n<e;++n)this[this.l++]=parseInt(t.slice(2*n,2*n+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+e,this.length);for(n=0;n<Math.min(t.length,e);++n){var i=t.charCodeAt(n);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(e){case 1:s=1,this[this.l]=t&255;break;case 2:s=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:s=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:s=4,rO(this,t,this.l);break;case 8:if(s=8,r==="f"){ZI(this,t,this.l);break}case 16:break;case-4:s=4,sO(this,t,this.l);break}return this.l+=s,this}function kN(e,t){var r=fN(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function pr(e,t){e.l=t,e.read_shift=Nl,e.chk=kN,e.write_shift=aO}function Pr(e,t){e.l+=t}function le(e){var t=da(e);return pr(t,0),t}function Ln(e,t,r){if(e){var s,n,a;pr(e,e.l||0);for(var i=e.length,l=0,c=0;e.l<i;){l=e.read_shift(1),l&128&&(l=(l&127)+((e.read_shift(1)&127)<<7));var u=vc[l]||vc[65535];for(s=e.read_shift(1),a=s&127,n=1;n<4&&s&128;++n)a+=((s=e.read_shift(1))&127)<<7*n;c=e.l+a;var d=u.f&&u.f(e,a,r);if(e.l=c,t(d,u,l))return}}}function Jr(){var e=[],t=Ze?256:2048,r=function(u){var d=le(u);return pr(d,0),d},s=r(t),n=function(){s&&(s.length>s.l&&(s=s.slice(0,s.l),s.l=s.length),s.length>0&&e.push(s),s=null)},a=function(u){return s&&u<s.length-s.l?s:(n(),s=r(Math.max(u+1,t)))},i=function(){return n(),lr(e)},l=function(u){n(),s=u,s.l==null&&(s.l=s.length),a(t)};return{next:a,push:l,end:i,_bufs:e}}function ye(e,t,r,s){var n=+t,a;if(!isNaN(n)){s||(s=vc[n].p||(r||[]).length||0),a=1+(n>=128?1:0)+1,s>=128&&++a,s>=16384&&++a,s>=2097152&&++a;var i=e.next(a);n<=127?i.write_shift(1,n):(i.write_shift(1,(n&127)+128),i.write_shift(1,n>>7));for(var l=0;l!=4;++l)if(s>=128)i.write_shift(1,(s&127)+128),s>>=7;else{i.write_shift(1,s);break}s>0&&zx(r)&&e.push(r)}}function El(e,t,r){var s=St(e);if(t.s?(s.cRel&&(s.c+=t.s.c),s.rRel&&(s.r+=t.s.r)):(s.cRel&&(s.c+=t.c),s.rRel&&(s.r+=t.r)),!r||r.biff<12){for(;s.c>=256;)s.c-=256;for(;s.r>=65536;)s.r-=65536}return s}function X1(e,t,r){var s=St(e);return s.s=El(s.s,t.s,r),s.e=El(s.e,t.s,r),s}function jl(e,t){if(e.cRel&&e.c<0)for(e=St(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=St(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Ve(e);return!e.cRel&&e.cRel!=null&&(r=lO(r)),!e.rRel&&e.rRel!=null&&(r=iO(r)),r}function Rf(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Pt(e.s.c)+":"+(e.e.cRel?"":"$")+Pt(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Wt(e.s.r)+":"+(e.e.rRel?"":"$")+Wt(e.e.r):jl(e.s,t.biff)+":"+jl(e.e,t.biff)}function $x(e){return parseInt(oO(e),10)-1}function Wt(e){return""+(e+1)}function iO(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function oO(e){return e.replace(/\$(\d+)$/,"$1")}function Vx(e){for(var t=cO(e),r=0,s=0;s!==t.length;++s)r=26*r+t.charCodeAt(s)-64;return r-1}function Pt(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function lO(e){return e.replace(/^([A-Z])/,"$$$1")}function cO(e){return e.replace(/^\$([A-Z])/,"$1")}function uO(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Rt(e){for(var t=0,r=0,s=0;s<e.length;++s){var n=e.charCodeAt(s);n>=48&&n<=57?t=10*t+(n-48):n>=65&&n<=90&&(r=26*r+(n-64))}return{c:r-1,r:t-1}}function Ve(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Zr(e){var t=e.indexOf(":");return t==-1?{s:Rt(e),e:Rt(e)}:{s:Rt(e.slice(0,t)),e:Rt(e.slice(t+1))}}function Ke(e,t){return typeof t>"u"||typeof t=="number"?Ke(e.s,e.e):(typeof e!="string"&&(e=Ve(e)),typeof t!="string"&&(t=Ve(t)),e==t?e:e+":"+t)}function ct(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,s=0,n=0,a=e.length;for(r=0;s<a&&!((n=e.charCodeAt(s)-64)<1||n>26);++s)r=26*r+n;for(t.s.c=--r,r=0;s<a&&!((n=e.charCodeAt(s)-48)<0||n>9);++s)r=10*r+n;if(t.s.r=--r,s===a||n!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++s,r=0;s!=a&&!((n=e.charCodeAt(s)-64)<1||n>26);++s)r=26*r+n;for(t.e.c=--r,r=0;s!=a&&!((n=e.charCodeAt(s)-48)<0||n>9);++s)r=10*r+n;return t.e.r=--r,t}function Q1(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Os(e.z,r?nr(t):t)}catch{}try{return e.w=Os((e.XF||{}).numFmtId||(r?14:0),r?nr(t):t)}catch{return""+t}}function In(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Mn[e.v]||e.v:t==null?Q1(e,e.v):Q1(e,t))}function _a(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",s={};return s[r]=e,{SheetNames:[r],Sheets:s}}function NN(e,t,r){var s=r||{},n=e?Array.isArray(e):s.dense,a=e||(n?[]:{}),i=0,l=0;if(a&&s.origin!=null){if(typeof s.origin=="number")i=s.origin;else{var c=typeof s.origin=="string"?Rt(s.origin):s.origin;i=c.r,l=c.c}a["!ref"]||(a["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var d=ct(a["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),i==-1&&(u.e.r=i=d.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[f].length;++h)if(!(typeof t[f][h]>"u")){var m={v:t[f][h]},x=i+f,p=l+h;if(u.s.r>x&&(u.s.r=x),u.s.c>p&&(u.s.c=p),u.e.r<x&&(u.e.r=x),u.e.c<p&&(u.e.c=p),t[f][h]&&typeof t[f][h]=="object"&&!Array.isArray(t[f][h])&&!(t[f][h]instanceof Date))m=t[f][h];else if(Array.isArray(m.v)&&(m.f=t[f][h][1],m.v=m.v[0]),m.v===null)if(m.f)m.t="n";else if(s.nullError)m.t="e",m.v=0;else if(s.sheetStubs)m.t="z";else continue;else typeof m.v=="number"?m.t="n":typeof m.v=="boolean"?m.t="b":m.v instanceof Date?(m.z=s.dateNF||$e[14],s.cellDates?(m.t="d",m.w=Os(m.z,nr(m.v))):(m.t="n",m.v=nr(m.v),m.w=Os(m.z,m.v))):m.t="s";if(n)a[x]||(a[x]=[]),a[x][p]&&a[x][p].z&&(m.z=a[x][p].z),a[x][p]=m;else{var g=Ve({c:p,r:x});a[g]&&a[g].z&&(m.z=a[g].z),a[g]=m}}}return u.s.c<1e7&&(a["!ref"]=Ke(u)),a}function Mo(e,t){return NN(null,e,t)}function dO(e){return e.read_shift(4,"i")}function Js(e,t){return t||(t=le(4)),t.write_shift(4,e),t}function Ar(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function cr(e,t){var r=!1;return t==null&&(r=!0,t=le(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function fO(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function hO(e,t){return t||(t=le(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Wx(e,t){var r=e.l,s=e.read_shift(1),n=Ar(e),a=[],i={t:n,h:n};if(s&1){for(var l=e.read_shift(4),c=0;c!=l;++c)a.push(fO(e));i.r=a}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}function mO(e,t){var r=!1;return t==null&&(r=!0,t=le(15+4*e.t.length)),t.write_shift(1,0),cr(e.t,t),r?t.slice(0,t.l):t}var pO=Wx;function xO(e,t){var r=!1;return t==null&&(r=!0,t=le(23+4*e.t.length)),t.write_shift(1,1),cr(e.t,t),t.write_shift(4,1),hO({},t),r?t.slice(0,t.l):t}function Ds(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function mi(e,t){return t==null&&(t=le(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function pi(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function xi(e,t){return t==null&&(t=le(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var gO=Ar,EN=cr;function qx(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Dd(e,t){var r=!1;return t==null&&(r=!0,t=le(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var vO=Ar,Tm=qx,Hx=Dd;function Gx(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,s=t[0]&2;e.l+=4;var n=s===0?Od([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Oa(t,0)>>2;return r?n/100:n}function jN(e,t){t==null&&(t=le(4));var r=0,s=0,n=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?s=1:n==(n|0)&&n>=-536870912&&n<1<<29&&(s=1,r=1),s)t.write_shift(-4,((r?n:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function TN(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function yO(e,t){return t||(t=le(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var gi=TN,Bo=yO;function jr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function ii(e,t){return(t||le(8)).write_shift(8,e,"f")}function wO(e){var t={},r=e.read_shift(1),s=r>>>1,n=e.read_shift(1),a=e.read_shift(2,"i"),i=e.read_shift(1),l=e.read_shift(1),c=e.read_shift(1);switch(e.l++,s){case 0:t.auto=1;break;case 1:t.index=n;var u=Ga[n];u&&(t.rgb=mc(u));break;case 2:t.rgb=mc([i,l,c]);break;case 3:t.theme=n;break}return a!=0&&(t.tint=a>0?a/32767:a/32768),t}function Ld(e,t){if(t||(t=le(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var s=e.rgb||"FFFFFF";typeof s=="number"&&(s=("000000"+s.toString(16)).slice(-6)),t.write_shift(1,parseInt(s.slice(0,2),16)),t.write_shift(1,parseInt(s.slice(2,4),16)),t.write_shift(1,parseInt(s.slice(4,6),16)),t.write_shift(1,255)}return t}function bO(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function _O(e,t){t||(t=le(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function CN(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},s=e.read_shift(4);switch(s){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(s>400)throw new Error("Unsupported Clipboard: "+s.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function SO(e){return CN(e,1)}function kO(e){return CN(e,2)}var Kx=2,Wr=3,_u=11,Y1=12,Md=19,Su=64,NO=65,EO=71,jO=4108,TO=4126,ir=80,AN=81,CO=[ir,AN],Cm={1:{n:"CodePage",t:Kx},2:{n:"Category",t:ir},3:{n:"PresentationFormat",t:ir},4:{n:"ByteCount",t:Wr},5:{n:"LineCount",t:Wr},6:{n:"ParagraphCount",t:Wr},7:{n:"SlideCount",t:Wr},8:{n:"NoteCount",t:Wr},9:{n:"HiddenCount",t:Wr},10:{n:"MultimediaClipCount",t:Wr},11:{n:"ScaleCrop",t:_u},12:{n:"HeadingPairs",t:jO},13:{n:"TitlesOfParts",t:TO},14:{n:"Manager",t:ir},15:{n:"Company",t:ir},16:{n:"LinksUpToDate",t:_u},17:{n:"CharacterCount",t:Wr},19:{n:"SharedDoc",t:_u},22:{n:"HyperlinksChanged",t:_u},23:{n:"AppVersion",t:Wr,p:"version"},24:{n:"DigSig",t:NO},26:{n:"ContentType",t:ir},27:{n:"ContentStatus",t:ir},28:{n:"Language",t:ir},29:{n:"Version",t:ir},255:{},2147483648:{n:"Locale",t:Md},2147483651:{n:"Behavior",t:Md},1919054434:{}},Am={1:{n:"CodePage",t:Kx},2:{n:"Title",t:ir},3:{n:"Subject",t:ir},4:{n:"Author",t:ir},5:{n:"Keywords",t:ir},6:{n:"Comments",t:ir},7:{n:"Template",t:ir},8:{n:"LastAuthor",t:ir},9:{n:"RevNumber",t:ir},10:{n:"EditTime",t:Su},11:{n:"LastPrinted",t:Su},12:{n:"CreatedDate",t:Su},13:{n:"ModifiedDate",t:Su},14:{n:"PageCount",t:Wr},15:{n:"WordCount",t:Wr},16:{n:"CharCount",t:Wr},17:{n:"Thumbnail",t:EO},18:{n:"Application",t:ir},19:{n:"DocSecurity",t:Wr},255:{},2147483648:{n:"Locale",t:Md},2147483651:{n:"Behavior",t:Md},1919054434:{}},J1={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},AO=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function FO(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var PO=FO([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Ga=St(PO),Mn={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},FN={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Fm={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},ku={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Xx(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function RO(e){var t=Xx();if(!e||!e.match)return t;var r={};if((e.match(Rr)||[]).forEach(function(s){var n=qe(s);switch(n[0].replace(VI,"<")){case"<?xml":break;case"<Types":t.xmlns=n["xmlns"+(n[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[n.Extension]=n.ContentType;break;case"<Override":t[Fm[n.ContentType]]!==void 0&&t[Fm[n.ContentType]].push(n.PartName);break}}),t.xmlns!==rr.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function PN(e,t){var r=RI(Fm),s=[],n;s[s.length]=qt,s[s.length]=je("Types",null,{xmlns:rr.CT,"xmlns:xsd":rr.xsd,"xmlns:xsi":rr.xsi}),s=s.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return je("Default",null,{Extension:c[0],ContentType:c[1]})}));var a=function(c){e[c]&&e[c].length>0&&(n=e[c][0],s[s.length]=je("Override",null,{PartName:(n[0]=="/"?"":"/")+n,ContentType:ku[c][t.bookType]||ku[c].xlsx}))},i=function(c){(e[c]||[]).forEach(function(u){s[s.length]=je("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:ku[c][t.bookType]||ku[c].xlsx})})},l=function(c){(e[c]||[]).forEach(function(u){s[s.length]=je("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[c][0]})})};return a("workbooks"),i("sheets"),i("charts"),l("themes"),["strs","styles"].forEach(a),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),i("metadata"),l("people"),s.length>2&&(s[s.length]="</Types>",s[1]=s[1].replace("/>",">")),s.join("")}var rt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function hc(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Tl(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var s={};return(e.match(Rr)||[]).forEach(function(n){var a=qe(n);if(a[0]==="<Relationship"){var i={};i.Type=a.Type,i.Target=a.Target,i.Id=a.Id,a.TargetMode&&(i.TargetMode=a.TargetMode);var l=a.TargetMode==="External"?a.Target:ll(a.Target,t);r[l]=i,s[a.Id]=i}}),r["!id"]=s,r}function io(e){var t=[qt,je("Relationships",null,{xmlns:rr.RELS})];return Ut(e["!id"]).forEach(function(r){t[t.length]=je("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function ft(e,t,r,s,n,a){if(n||(n={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,n.Id="rId"+t,n.Type=s,n.Target=r,[rt.HLINK,rt.XPATH,rt.XMISS].indexOf(n.Type)>-1&&(n.TargetMode="External"),e["!id"][n.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][n.Id]=n,e[("/"+n.Target).replace("//","/")]=n,t}var IO="application/vnd.oasis.opendocument.spreadsheet";function OO(e,t){for(var r=Bx(e),s,n;s=fc.exec(r);)switch(s[3]){case"manifest":break;case"file-entry":if(n=qe(s[0],!1),n.path=="/"&&n.type!==IO)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw s}}function DO(e){var t=[qt];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function Z1(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function LO(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function MO(e){var t=[qt];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(Z1(e[r][0],e[r][1])),t.push(LO("",e[r][0]));return t.push(Z1("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function RN(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Ad.version+"</meta:generator></office:meta></office:document-meta>"}var Ps=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],BO=function(){for(var e=new Array(Ps.length),t=0;t<Ps.length;++t){var r=Ps[t],s="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+s+"[^>]*>([\\s\\S]*?)</"+s+">")}return e}();function IN(e){var t={};e=xt(e);for(var r=0;r<Ps.length;++r){var s=Ps[r],n=e.match(BO[r]);n!=null&&n.length>0&&(t[s[1]]=lt(n[1])),s[2]==="date"&&t[s[1]]&&(t[s[1]]=_t(t[s[1]]))}return t}function If(e,t,r,s,n){n[e]!=null||t==null||t===""||(n[e]=t,t=ht(t),s[s.length]=r?je(e,t,r):xr(e,t))}function ON(e,t){var r=t||{},s=[qt,je("cp:coreProperties",null,{"xmlns:cp":rr.CORE_PROPS,"xmlns:dc":rr.dc,"xmlns:dcterms":rr.dcterms,"xmlns:dcmitype":rr.dcmitype,"xmlns:xsi":rr.xsi})],n={};if(!e&&!r.Props)return s.join("");e&&(e.CreatedDate!=null&&If("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:jm(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},s,n),e.ModifiedDate!=null&&If("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:jm(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},s,n));for(var a=0;a!=Ps.length;++a){var i=Ps[a],l=r.Props&&r.Props[i[1]]!=null?r.Props[i[1]]:e?e[i[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&If(i[0],l,null,s,n)}return s.length>2&&(s[s.length]="</cp:coreProperties>",s[1]=s[1].replace("/>",">")),s.join("")}var Ka=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],DN=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function LN(e,t,r,s){var n=[];if(typeof e=="string")n=V1(e,s);else for(var a=0;a<e.length;++a)n=n.concat(e[a].map(function(d){return{v:d}}));var i=typeof t=="string"?V1(t,s).map(function(d){return d.v}):t,l=0,c=0;if(i.length>0)for(var u=0;u!==n.length;u+=2){switch(c=+n[u+1].v,n[u].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=i.slice(l,l+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=c,r.DefinedNames=i.slice(l,l+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=i.slice(l,l+c);break}l+=c}}function UO(e,t,r){var s={};return t||(t={}),e=xt(e),Ka.forEach(function(n){var a=(e.match(uc(n[0]))||[])[1];switch(n[2]){case"string":a&&(t[n[1]]=lt(a));break;case"bool":t[n[1]]=a==="true";break;case"raw":var i=e.match(new RegExp("<"+n[0]+"[^>]*>([\\s\\S]*?)</"+n[0]+">"));i&&i.length>0&&(s[n[1]]=i[1]);break}}),s.HeadingPairs&&s.TitlesOfParts&&LN(s.HeadingPairs,s.TitlesOfParts,t,r),t}function MN(e){var t=[],r=je;return e||(e={}),e.Application="SheetJS",t[t.length]=qt,t[t.length]=je("Properties",null,{xmlns:rr.EXT_PROPS,"xmlns:vt":rr.vt}),Ka.forEach(function(s){if(e[s[1]]!==void 0){var n;switch(s[2]){case"string":n=ht(String(e[s[1]]));break;case"bool":n=e[s[1]]?"true":"false";break}n!==void 0&&(t[t.length]=r(s[0],n))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(s){return"<vt:lpstr>"+ht(s)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var zO=/<[^>]+>[^<]*/g;function $O(e,t){var r={},s="",n=e.match(zO);if(n)for(var a=0;a!=n.length;++a){var i=n[a],l=qe(i);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":s=lt(l.name);break;case"</property>":s=null;break;default:if(i.indexOf("<vt:")===0){var c=i.split(">"),u=c[0].slice(4),d=c[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[s]=lt(d);break;case"bool":r[s]=wt(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[s]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[s]=parseFloat(d);break;case"filetime":case"date":r[s]=_t(d);break;case"cy":case"error":r[s]=lt(d);break;default:if(u.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",i,u,c)}}else if(i.slice(0,2)!=="</"){if(t.WTF)throw new Error(i)}}}return r}function BN(e){var t=[qt,je("Properties",null,{xmlns:rr.CUST_PROPS,"xmlns:vt":rr.vt})];if(!e)return t.join("");var r=1;return Ut(e).forEach(function(n){++r,t[t.length]=je("property",YI(e[n]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:ht(n)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Pm={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Of;function VO(e,t,r){Of||(Of=g0(Pm)),t=Of[t]||t,e[t]=r}function WO(e,t){var r=[];return Ut(Pm).map(function(s){for(var n=0;n<Ps.length;++n)if(Ps[n][1]==s)return Ps[n];for(n=0;n<Ka.length;++n)if(Ka[n][1]==s)return Ka[n];throw s}).forEach(function(s){if(e[s[1]]!=null){var n=t&&t.Props&&t.Props[s[1]]!=null?t.Props[s[1]]:e[s[1]];switch(s[2]){case"date":n=new Date(n).toISOString().replace(/\.\d*Z/,"Z");break}typeof n=="number"?n=String(n):n===!0||n===!1?n=n?"1":"0":n instanceof Date&&(n=new Date(n).toISOString().replace(/\.\d*Z/,"")),r.push(xr(Pm[s[1]]||s[1],n))}}),je("DocumentProperties",r.join(""),{xmlns:ss.o})}function qO(e,t){var r=["Worksheets","SheetNames"],s="CustomDocumentProperties",n=[];return e&&Ut(e).forEach(function(a){if(Object.prototype.hasOwnProperty.call(e,a)){for(var i=0;i<Ps.length;++i)if(a==Ps[i][1])return;for(i=0;i<Ka.length;++i)if(a==Ka[i][1])return;for(i=0;i<r.length;++i)if(a==r[i])return;var l=e[a],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l=String(l),n.push(je(B1(a),l,{"dt:dt":c}))}}),t&&Ut(t).forEach(function(a){if(Object.prototype.hasOwnProperty.call(t,a)&&!(e&&Object.prototype.hasOwnProperty.call(e,a))){var i=t[a],l="string";typeof i=="number"?(l="float",i=String(i)):i===!0||i===!1?(l="boolean",i=i?"1":"0"):i instanceof Date?(l="dateTime.tz",i=i.toISOString()):i=String(i),n.push(je(B1(a),i,{"dt:dt":l}))}}),"<"+s+' xmlns="'+ss.o+'">'+n.join("")+"</"+s+">"}function Qx(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function HO(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,s=r%Math.pow(2,32),n=(r-s)/Math.pow(2,32);s*=1e7,n*=1e7;var a=s/Math.pow(2,32)|0;a>0&&(s=s%Math.pow(2,32),n+=a);var i=le(8);return i.write_shift(4,s),i.write_shift(4,n),i}function UN(e,t,r){var s=e.l,n=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-s&3;)++e.l;return n}function zN(e,t,r){var s=e.read_shift(0,"lpwstr");return s}function $N(e,t,r){return t===31?zN(e):UN(e,t,r)}function Rm(e,t,r){return $N(e,t,r===!1?0:4)}function GO(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return $N(e,t,0)}function KO(e){for(var t=e.read_shift(4),r=[],s=0;s!=t;++s){var n=e.l;r[s]=e.read_shift(0,"lpwstr").replace(zr,""),e.l-n&2&&(e.l+=2)}return r}function XO(e){for(var t=e.read_shift(4),r=[],s=0;s!=t;++s)r[s]=e.read_shift(0,"lpstr-cp").replace(zr,"");return r}function QO(e){var t=e.l,r=Bd(e,AN);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var s=Bd(e,Wr);return[r,s]}function YO(e){for(var t=e.read_shift(4),r=[],s=0;s<t/2;++s)r.push(QO(e));return r}function ew(e,t){for(var r=e.read_shift(4),s={},n=0;n!=r;++n){var a=e.read_shift(4),i=e.read_shift(4);s[a]=e.read_shift(i,t===1200?"utf16le":"utf8").replace(zr,"").replace(ol,"!"),t===1200&&i%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),s}function VN(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function JO(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Bd(e,t,r){var s=e.read_shift(2),n,a=r||{};if(e.l+=2,t!==Y1&&s!==t&&CO.indexOf(t)===-1&&!((t&65534)==4126&&(s&65534)==4126))throw new Error("Expected type "+t+" saw "+s);switch(t===Y1?s:t){case 2:return n=e.read_shift(2,"i"),a.raw||(e.l+=2),n;case 3:return n=e.read_shift(4,"i"),n;case 11:return e.read_shift(4)!==0;case 19:return n=e.read_shift(4),n;case 30:return UN(e,s,4).replace(zr,"");case 31:return zN(e);case 64:return Qx(e);case 65:return VN(e);case 71:return JO(e);case 80:return Rm(e,s,!a.raw).replace(zr,"");case 81:return GO(e,s).replace(zr,"");case 4108:return YO(e);case 4126:case 4127:return s==4127?KO(e):XO(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+s)}}function tw(e,t){var r=le(4),s=le(4);switch(r.write_shift(4,e==80?31:e),e){case 3:s.write_shift(-4,t);break;case 5:s=le(8),s.write_shift(8,t,"f");break;case 11:s.write_shift(4,t?1:0);break;case 64:s=HO(t);break;case 31:case 80:for(s=le(4+2*(t.length+1)+(t.length%2?0:2)),s.write_shift(4,t.length+1),s.write_shift(0,t,"dbcs");s.l!=s.length;)s.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return lr([r,s])}function rw(e,t){var r=e.l,s=e.read_shift(4),n=e.read_shift(4),a=[],i=0,l=0,c=-1,u={};for(i=0;i!=n;++i){var d=e.read_shift(4),f=e.read_shift(4);a[i]=[d,f+r]}a.sort(function(v,y){return v[1]-y[1]});var h={};for(i=0;i!=n;++i){if(e.l!==a[i][1]){var m=!0;if(i>0&&t)switch(t[a[i-1][0]].t){case 2:e.l+2===a[i][1]&&(e.l+=2,m=!1);break;case 80:e.l<=a[i][1]&&(e.l=a[i][1],m=!1);break;case 4108:e.l<=a[i][1]&&(e.l=a[i][1],m=!1);break}if((!t||i==0)&&e.l<=a[i][1]&&(m=!1,e.l=a[i][1]),m)throw new Error("Read Error: Expected address "+a[i][1]+" at "+e.l+" :"+i)}if(t){var x=t[a[i][0]];if(h[x.n]=Bd(e,x.t,{raw:!0}),x.p==="version"&&(h[x.n]=String(h[x.n]>>16)+"."+("0000"+String(h[x.n]&65535)).slice(-4)),x.n=="CodePage")switch(h[x.n]){case 0:h[x.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Gs(l=h[x.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[x.n])}}else if(a[i][0]===1){if(l=h.CodePage=Bd(e,Kx),Gs(l),c!==-1){var p=e.l;e.l=a[c][1],u=ew(e,l),e.l=p}}else if(a[i][0]===0){if(l===0){c=i,e.l=a[i+1][1];continue}u=ew(e,l)}else{var g=u[a[i][0]],w;switch(e[e.l]){case 65:e.l+=4,w=VN(e);break;case 30:e.l+=4,w=Rm(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,w=Rm(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,w=e.read_shift(4,"i");break;case 19:e.l+=4,w=e.read_shift(4);break;case 5:e.l+=4,w=e.read_shift(8,"f");break;case 11:e.l+=4,w=zt(e,4);break;case 64:e.l+=4,w=_t(Qx(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[g]=w}}return e.l=r+s,h}var WN=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function ZO(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function sw(e,t,r){var s=le(8),n=[],a=[],i=8,l=0,c=le(8),u=le(8);if(c.write_shift(4,2),c.write_shift(4,1200),u.write_shift(4,1),a.push(c),n.push(u),i+=8+c.length,!t){u=le(8),u.write_shift(4,0),n.unshift(u);var d=[le(4)];for(d[0].write_shift(4,e.length),l=0;l<e.length;++l){var f=e[l][0];for(c=le(8+2*(f.length+1)+(f.length%2?0:2)),c.write_shift(4,l+2),c.write_shift(4,f.length+1),c.write_shift(0,f,"dbcs");c.l!=c.length;)c.write_shift(1,0);d.push(c)}c=lr(d),a.unshift(c),i+=8+c.length}for(l=0;l<e.length;++l)if(!(t&&!t[e[l][0]])&&!(WN.indexOf(e[l][0])>-1||DN.indexOf(e[l][0])>-1)&&e[l][1]!=null){var h=e[l][1],m=0;if(t){m=+t[e[l][0]];var x=r[m];if(x.p=="version"&&typeof h=="string"){var p=h.split(".");h=(+p[0]<<16)+(+p[1]||0)}c=tw(x.t,h)}else{var g=ZO(h);g==-1&&(g=31,h=String(h)),c=tw(g,h)}a.push(c),u=le(8),u.write_shift(4,t?m:2+l),n.push(u),i+=8+c.length}var w=8*(a.length+1);for(l=0;l<a.length;++l)n[l].write_shift(4,w),w+=a[l].length;return s.write_shift(4,i),s.write_shift(4,a.length),lr([s].concat(n).concat(a))}function nw(e,t,r){var s=e.content;if(!s)return{};pr(s,0);var n,a,i,l,c=0;s.chk("feff","Byte Order: "),s.read_shift(2);var u=s.read_shift(4),d=s.read_shift(16);if(d!==Me.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(n=s.read_shift(4),n!==1&&n!==2)throw new Error("Unrecognized #Sets: "+n);if(a=s.read_shift(16),l=s.read_shift(4),n===1&&l!==s.l)throw new Error("Length mismatch: "+l+" !== "+s.l);n===2&&(i=s.read_shift(16),c=s.read_shift(4));var f=rw(s,t),h={SystemIdentifier:u};for(var m in f)h[m]=f[m];if(h.FMTID=a,n===1)return h;if(c-s.l==2&&(s.l+=2),s.l!==c)throw new Error("Length mismatch 2: "+s.l+" !== "+c);var x;try{x=rw(s,null)}catch{}for(m in x)h[m]=x[m];return h.FMTID=[a,i],h}function aw(e,t,r,s,n,a){var i=le(n?68:48),l=[i];i.write_shift(2,65534),i.write_shift(2,0),i.write_shift(4,842412599),i.write_shift(16,Me.utils.consts.HEADER_CLSID,"hex"),i.write_shift(4,n?2:1),i.write_shift(16,t,"hex"),i.write_shift(4,n?68:48);var c=sw(e,r,s);if(l.push(c),n){var u=sw(n,null,null);i.write_shift(16,a,"hex"),i.write_shift(4,68+c.length),l.push(u)}return lr(l)}function zn(e,t){return e.read_shift(t),null}function eD(e,t){t||(t=le(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function tD(e,t,r){for(var s=[],n=e.l+t;e.l<n;)s.push(r(e,n-e.l));if(n!==e.l)throw new Error("Slurp error");return s}function zt(e,t){return e.read_shift(t)===1}function Lr(e,t){return t||(t=le(2)),t.write_shift(2,+!!e),t}function Xt(e){return e.read_shift(2,"u")}function ks(e,t){return t||(t=le(2)),t.write_shift(2,e),t}function qN(e,t){return tD(e,t,Xt)}function rD(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function HN(e,t,r){return r||(r=le(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function Oc(e,t,r){var s=e.read_shift(r&&r.biff>=12?2:1),n="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=e.read_shift(1);a&&(n="dbcs-cont")}else r.biff==12&&(n="wstr");r.biff>=2&&r.biff<=5&&(n="cpstr");var i=s?e.read_shift(s,n):"";return i}function sD(e){var t=e.read_shift(2),r=e.read_shift(1),s=r&4,n=r&8,a=1+(r&1),i=0,l,c={};n&&(i=e.read_shift(2)),s&&(l=e.read_shift(4));var u=a==2?"dbcs-cont":"sbcs-cont",d=t===0?"":e.read_shift(t,u);return n&&(e.l+=4*i),s&&(e.l+=l),c.t=d,n||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function nD(e){var t=e.t||"",r=le(3);r.write_shift(2,t.length),r.write_shift(1,1);var s=le(2*t.length);s.write_shift(2*t.length,t,"utf16le");var n=[r,s];return lr(n)}function oi(e,t,r){var s;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var n=e.read_shift(1);return n===0?s=e.read_shift(t,"sbcs-cont"):s=e.read_shift(t,"dbcs-cont"),s}function Dc(e,t,r){var s=e.read_shift(r&&r.biff==2?1:2);return s===0?(e.l++,""):oi(e,s,r)}function vi(e,t,r){if(r.biff>5)return Dc(e,t,r);var s=e.read_shift(1);return s===0?(e.l++,""):e.read_shift(s,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function GN(e,t,r){return r||(r=le(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function aD(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function iD(e){var t=e.read_shift(4),r=e.l,s=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(s=!0),e.l=r);var n=e.read_shift((s?t-24:t)>>1,"utf16le").replace(zr,"");return s&&(e.l+=24),n}function oD(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var s=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var n=e.read_shift(4);if(n===0)return r+s.replace(/\\/g,"/");var a=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=e.read_shift(a>>1,"utf16le").replace(zr,"");return r+i}function lD(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return iD(e);case"0303000000000000c000000000000046":return oD(e);default:throw new Error("Unsupported Moniker "+r)}}function Nu(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(zr,""):"";return r}function iw(e,t){t||(t=le(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function cD(e,t){var r=e.l+t,s=e.read_shift(4);if(s!==2)throw new Error("Unrecognized streamVersion: "+s);var n=e.read_shift(2);e.l+=2;var a,i,l,c,u="",d,f;n&16&&(a=Nu(e,r-e.l)),n&128&&(i=Nu(e,r-e.l)),(n&257)===257&&(l=Nu(e,r-e.l)),(n&257)===1&&(c=lD(e,r-e.l)),n&8&&(u=Nu(e,r-e.l)),n&32&&(d=e.read_shift(16)),n&64&&(f=Qx(e)),e.l=r;var h=i||l||c||"";h&&u&&(h+="#"+u),h||(h="#"+u),n&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var m={Target:h};return d&&(m.guid=d),f&&(m.time=f),a&&(m.Tooltip=a),m}function uD(e){var t=le(512),r=0,s=e.Target;s.slice(0,7)=="file://"&&(s=s.slice(7));var n=s.indexOf("#"),a=n>-1?31:23;switch(s.charAt(0)){case"#":a=28;break;case".":a&=-3;break}t.write_shift(4,2),t.write_shift(4,a);var i=[8,6815827,6619237,4849780,83];for(r=0;r<i.length;++r)t.write_shift(4,i[r]);if(a==28)s=s.slice(1),iw(s,t);else if(a&2){for(i="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));var l=n>-1?s.slice(0,n):s;for(t.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)t.write_shift(2,l.charCodeAt(r));t.write_shift(2,0),a&8&&iw(n>-1?s.slice(n+1):"",t)}else{for(i="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));for(var c=0;s.slice(c*3,c*3+3)=="../"||s.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,s.length-3*c+1),r=0;r<s.length-3*c;++r)t.write_shift(1,s.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function KN(e){var t=e.read_shift(1),r=e.read_shift(1),s=e.read_shift(1),n=e.read_shift(1);return[t,r,s,n]}function XN(e,t){var r=KN(e);return r[3]=0,r}function mn(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2);return{r:t,c:r,ixfe:s}}function li(e,t,r,s){return s||(s=le(6)),s.write_shift(2,e),s.write_shift(2,t),s.write_shift(2,r||0),s}function dD(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function fD(e,t,r){return t===0?"":vi(e,t,r)}function hD(e,t,r){var s=r.biff>8?4:2,n=e.read_shift(s),a=e.read_shift(s,"i"),i=e.read_shift(s,"i");return[n,a,i]}function QN(e){var t=e.read_shift(2),r=Gx(e);return[t,r]}function mD(e,t,r){e.l+=4,t-=4;var s=e.l+t,n=Oc(e,t,r),a=e.read_shift(2);if(s-=e.l,a!==s)throw new Error("Malformed AddinUdf: padding = "+s+" != "+a);return e.l+=a,n}function w0(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2),n=e.read_shift(2);return{s:{c:s,r:t},e:{c:n,r}}}function YN(e,t){return t||(t=le(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function JN(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(1),n=e.read_shift(1);return{s:{c:s,r:t},e:{c:n,r}}}var pD=JN;function ZN(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2);return e.l+=12,[r,t,s]}function xD(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function gD(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function _r(e){e.l+=2,e.l+=e.read_shift(2)}var vD={0:_r,4:_r,5:_r,6:_r,7:gD,8:_r,9:_r,10:_r,11:_r,12:_r,13:xD,14:_r,15:_r,16:_r,17:_r,18:_r,19:_r,20:_r,21:ZN};function yD(e,t){for(var r=e.l+t,s=[];e.l<r;){var n=e.read_shift(2);e.l-=2;try{s.push(vD[n](e,r-e.l))}catch{return e.l=r,s}}return e.l!=r&&(e.l=r),s}function Eu(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function Yx(e,t,r){var s=1536,n=16;switch(r.bookType){case"biff8":break;case"biff5":s=1280,n=8;break;case"biff4":s=4,n=6;break;case"biff3":s=3,n=6;break;case"biff2":s=2,n=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var a=le(n);return a.write_shift(2,s),a.write_shift(2,t),n>4&&a.write_shift(2,29282),n>6&&a.write_shift(2,1997),n>8&&(a.write_shift(2,49161),a.write_shift(2,1),a.write_shift(2,1798),a.write_shift(2,0)),a}function wD(e,t){return t===0||e.read_shift(2),1200}function bD(e,t,r){if(r.enc)return e.l+=t,"";var s=e.l,n=vi(e,0,r);return e.read_shift(t+s-e.l),n}function _D(e,t){var r=!t||t.biff==8,s=le(r?112:54);for(s.write_shift(t.biff==8?2:1,7),r&&s.write_shift(1,0),s.write_shift(4,859007059),s.write_shift(4,5458548|(r?0:536870912));s.l<s.length;)s.write_shift(1,r?0:32);return s}function SD(e,t,r){var s=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:s&16,fBelow:s&64,fRight:s&128}}function kD(e,t,r){var s=e.read_shift(4),n=e.read_shift(1)&3,a=e.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var i=Oc(e,0,r);return i.length===0&&(i="Sheet1"),{pos:s,hs:n,dt:a,name:i}}function ND(e,t){var r=!t||t.biff>=8?2:1,s=le(8+r*e.name.length);s.write_shift(4,e.pos),s.write_shift(1,e.hs||0),s.write_shift(1,e.dt),s.write_shift(1,e.name.length),t.biff>=8&&s.write_shift(1,1),s.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var n=s.slice(0,s.l);return n.l=s.l,n}function ED(e,t){for(var r=e.l+t,s=e.read_shift(4),n=e.read_shift(4),a=[],i=0;i!=n&&e.l<r;++i)a.push(sD(e));return a.Count=s,a.Unique=n,a}function jD(e,t){var r=le(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var s=[],n=0;n<e.length;++n)s[n]=nD(e[n]);var a=lr([r].concat(s));return a.parts=[r.length].concat(s.map(function(i){return i.length})),a}function TD(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function CD(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var s=e.read_shift(1);return e.l+=3,s&7&&(t.level=s&7),s&32&&(t.hidden=!0),s&64&&(t.hpt=r/20),t}function AD(e){var t=dD(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function FD(e){return e.read_shift(2),e.read_shift(4)}function ow(e,t,r){var s=0;r&&r.biff==2||(s=e.read_shift(2));var n=e.read_shift(2);r&&r.biff==2&&(s=1-(n>>15),n&=32767);var a={Unsynced:s&1,DyZero:(s&2)>>1,ExAsc:(s&4)>>2,ExDsc:(s&8)>>3};return[a,n]}function PD(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),u=e.read_shift(2);return{Pos:[t,r],Dim:[s,n],Flags:a,CurTab:i,FirstTab:l,Selected:c,TabRatio:u}}function RD(){var e=le(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function ID(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var s=e.read_shift(2);return{RTL:s&64}}function OD(e){var t=le(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function DD(){}function LD(e,t,r){var s={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return s.name=Oc(e,0,r),s}function MD(e,t){var r=e.name||"Arial",s=t&&t.biff==5,n=s?15+r.length:16+2*r.length,a=le(n);return a.write_shift(2,e.sz*20),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,r.length),s||a.write_shift(1,1),a.write_shift((s?1:2)*r.length,r,s?"sbcs":"utf16le"),a}function BD(e){var t=mn(e);return t.isst=e.read_shift(4),t}function UD(e,t,r,s){var n=le(10);return li(e,t,s,n),n.write_shift(4,r),n}function zD(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var s=e.l+t,n=mn(e);r.biff==2&&e.l++;var a=Dc(e,s-e.l,r);return n.val=a,n}function $D(e,t,r,s,n){var a=!n||n.biff==8,i=le(8+ +a+(1+a)*r.length);return li(e,t,s,i),i.write_shift(2,r.length),a&&i.write_shift(1,1),i.write_shift((1+a)*r.length,r,a?"utf16le":"sbcs"),i}function VD(e,t,r){var s=e.read_shift(2),n=vi(e,0,r);return[s,n]}function WD(e,t,r,s){var n=r&&r.biff==5;s||(s=le(n?3+t.length:5+2*t.length)),s.write_shift(2,e),s.write_shift(n?1:2,t.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*t.length,t,n?"sbcs":"utf16le");var a=s.length>s.l?s.slice(0,s.l):s;return a.l==null&&(a.l=a.length),a}var qD=vi;function lw(e,t,r){var s=e.l+t,n=r.biff==8||!r.biff?4:2,a=e.read_shift(n),i=e.read_shift(n),l=e.read_shift(2),c=e.read_shift(2);return e.l=s,{s:{r:a,c:l},e:{r:i,c}}}function HD(e,t){var r=t.biff==8||!t.biff?4:2,s=le(2*r+6);return s.write_shift(r,e.s.r),s.write_shift(r,e.e.r+1),s.write_shift(2,e.s.c),s.write_shift(2,e.e.c+1),s.write_shift(2,0),s}function GD(e){var t=e.read_shift(2),r=e.read_shift(2),s=QN(e);return{r:t,c:r,ixfe:s[0],rknum:s[1]}}function KD(e,t){for(var r=e.l+t-2,s=e.read_shift(2),n=e.read_shift(2),a=[];e.l<r;)a.push(QN(e));if(e.l!==r)throw new Error("MulRK read error");var i=e.read_shift(2);if(a.length!=i-n+1)throw new Error("MulRK length mismatch");return{r:s,c:n,C:i,rkrec:a}}function XD(e,t){for(var r=e.l+t-2,s=e.read_shift(2),n=e.read_shift(2),a=[];e.l<r;)a.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var i=e.read_shift(2);if(a.length!=i-n+1)throw new Error("MulBlank length mismatch");return{r:s,c:n,C:i,ixfe:a}}function QD(e,t,r,s){var n={},a=e.read_shift(4),i=e.read_shift(4),l=e.read_shift(4),c=e.read_shift(2);return n.patternType=AO[l>>26],s.cellStyles&&(n.alc=a&7,n.fWrap=a>>3&1,n.alcV=a>>4&7,n.fJustLast=a>>7&1,n.trot=a>>8&255,n.cIndent=a>>16&15,n.fShrinkToFit=a>>20&1,n.iReadOrder=a>>22&2,n.fAtrNum=a>>26&1,n.fAtrFnt=a>>27&1,n.fAtrAlc=a>>28&1,n.fAtrBdr=a>>29&1,n.fAtrPat=a>>30&1,n.fAtrProt=a>>31&1,n.dgLeft=i&15,n.dgRight=i>>4&15,n.dgTop=i>>8&15,n.dgBottom=i>>12&15,n.icvLeft=i>>16&127,n.icvRight=i>>23&127,n.grbitDiag=i>>30&3,n.icvTop=l&127,n.icvBottom=l>>7&127,n.icvDiag=l>>14&127,n.dgDiag=l>>21&15,n.icvFore=c&127,n.icvBack=c>>7&127,n.fsxButton=c>>14&1),n}function YD(e,t,r){var s={};return s.ifnt=e.read_shift(2),s.numFmtId=e.read_shift(2),s.flags=e.read_shift(2),s.fStyle=s.flags>>2&1,t-=6,s.data=QD(e,t,s.fStyle,r),s}function cw(e,t,r,s){var n=r&&r.biff==5;s||(s=le(n?16:20)),s.write_shift(2,0),e.style?(s.write_shift(2,e.numFmtId||0),s.write_shift(2,65524)):(s.write_shift(2,e.numFmtId||0),s.write_shift(2,t<<4));var a=0;return e.numFmtId>0&&n&&(a|=1024),s.write_shift(4,a),s.write_shift(4,0),n||s.write_shift(4,0),s.write_shift(2,0),s}function JD(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function ZD(e){var t=le(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function uw(e,t,r){var s=mn(e);(r.biff==2||t==9)&&++e.l;var n=rD(e);return s.val=n,s.t=n===!0||n===!1?"b":"e",s}function e8(e,t,r,s,n,a){var i=le(8);return li(e,t,s,i),HN(r,a,i),i}function t8(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var s=mn(e),n=jr(e);return s.val=n,s}function r8(e,t,r,s){var n=le(14);return li(e,t,s,n),ii(r,n),n}var dw=fD;function s8(e,t,r){var s=e.l+t,n=e.read_shift(2),a=e.read_shift(2);if(r.sbcch=a,a==1025||a==14849)return[a,n];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var i=oi(e,a),l=[];s>e.l;)l.push(Dc(e));return[a,n,i,l]}function fw(e,t,r){var s=e.read_shift(2),n,a={fBuiltIn:s&1,fWantAdvise:s>>>1&1,fWantPict:s>>>2&1,fOle:s>>>3&1,fOleLink:s>>>4&1,cf:s>>>5&1023,fIcon:s>>>15&1};return r.sbcch===14849&&(n=mD(e,t-2,r)),a.body=n||e.read_shift(t-2),typeof n=="string"&&(a.Name=n),a}var n8=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function hw(e,t,r){var s=e.l+t,n=e.read_shift(2),a=e.read_shift(1),i=e.read_shift(1),l=e.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),c=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var u=oi(e,i,r);n&32&&(u=n8[u.charCodeAt(0)]);var d=s-e.l;r&&r.biff==2&&--d;var f=s==e.l||l===0||!(d>0)?[]:y7(e,d,r,l);return{chKey:a,Name:u,itab:c,rgce:f}}function eE(e,t,r){if(r.biff<8)return a8(e,t,r);for(var s=[],n=e.l+t,a=e.read_shift(r.biff>8?4:2);a--!==0;)s.push(hD(e,r.biff>8?12:6,r));if(e.l!=n)throw new Error("Bad ExternSheet: "+e.l+" != "+n);return s}function a8(e,t,r){e[e.l+1]==3&&e[e.l]++;var s=Oc(e,t,r);return s.charCodeAt(0)==3?s.slice(1):s}function i8(e,t,r){if(r.biff<8){e.l+=t;return}var s=e.read_shift(2),n=e.read_shift(2),a=oi(e,s,r),i=oi(e,n,r);return[a,i]}function o8(e,t,r){var s=JN(e);e.l++;var n=e.read_shift(1);return t-=8,[w7(e,t,r),n,s]}function mw(e,t,r){var s=pD(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[s,g7(e,t,r)]}function l8(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,s=e.read_shift(4);return[t,r,s]}function c8(e,t,r){if(!(r.biff<8)){var s=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),l=vi(e,0,r);return r.biff<8&&e.read_shift(1),[{r:s,c:n},l,i,a]}}function u8(e,t,r){return c8(e,t,r)}function d8(e,t){for(var r=[],s=e.read_shift(2);s--;)r.push(w0(e));return r}function f8(e){var t=le(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)YN(e[r],t);return t}function h8(e,t,r){if(r&&r.biff<8)return p8(e,t,r);var s=ZN(e),n=yD(e,t-22,s[1]);return{cmo:s,ft:n}}var m8={8:function(e,t){var r=e.l+t;e.l+=10;var s=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var n=e.read_shift(1);return e.l+=n,e.l=r,{fmt:s}}};function p8(e,t,r){e.l+=4;var s=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var i=[];return i.push((m8[s]||Pr)(e,t,r)),{cmo:[n,s,a],ft:i}}function x8(e,t,r){var s=e.l,n="";try{e.l+=4;var a=(r.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(a)==-1?e.l+=6:i=aD(e,6,r);var l=e.read_shift(2);e.read_shift(2),Xt(e,2);var c=e.read_shift(2);e.l+=c;for(var u=1;u<e.lens.length-1;++u){if(e.l-s!=e.lens[u])throw new Error("TxO: bad continue record");var d=e[e.l],f=oi(e,e.lens[u+1]-e.lens[u]-1);if(n+=f,n.length>=(d?l:2*l))break}if(n.length!==l&&n.length!==l*2)throw new Error("cchText: "+l+" != "+n.length);return e.l=s+t,{t:n}}catch{return e.l=s+t,{t:n}}}function g8(e,t){var r=w0(e);e.l+=16;var s=cD(e,t-24);return[r,s]}function v8(e){var t=le(24),r=Rt(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var s="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<16;++n)t.write_shift(1,parseInt(s[n],16));return lr([t,uD(e[1])])}function y8(e,t){e.read_shift(2);var r=w0(e),s=e.read_shift((t-10)/2,"dbcs-cont");return s=s.replace(zr,""),[r,s]}function w8(e){var t=e[1].Tooltip,r=le(10+2*(t.length+1));r.write_shift(2,2048);var s=Rt(e[0]);r.write_shift(2,s.r),r.write_shift(2,s.r),r.write_shift(2,s.c),r.write_shift(2,s.c);for(var n=0;n<t.length;++n)r.write_shift(2,t.charCodeAt(n));return r.write_shift(2,0),r}function b8(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=J1[r]||r,r=e.read_shift(2),t[1]=J1[r]||r,t}function _8(e){return e||(e=le(4)),e.write_shift(2,1),e.write_shift(2,1),e}function S8(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(XN(e));return r}function k8(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(XN(e));return r}function N8(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function tE(e,t,r){if(!r.cellStyles)return Pr(e,t);var s=r&&r.biff>=12?4:2,n=e.read_shift(s),a=e.read_shift(s),i=e.read_shift(s),l=e.read_shift(s),c=e.read_shift(2);s==2&&(e.l+=2);var u={s:n,e:a,w:i,ixfe:l,flags:c};return(r.biff>=5||!r.biff)&&(u.level=c>>8&7),u}function E8(e,t){var r=le(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var s=0;return e.hidden&&(s|=1),r.write_shift(1,s),s=e.level||0,r.write_shift(1,s),r.write_shift(2,0),r}function j8(e,t){var r={};return t<32||(e.l+=16,r.header=jr(e),r.footer=jr(e),e.l+=2),r}function T8(e,t,r){var s={area:!1};if(r.biff!=5)return e.l+=t,s;var n=e.read_shift(1);return e.l+=3,n&16&&(s.area=!0),s}function C8(e){for(var t=le(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var A8=mn,F8=qN,P8=Dc;function R8(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(4),n={fmt:t,env:r,len:s,data:e.slice(e.l,e.l+s)};return e.l+=s,n}function I8(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var s=mn(e);++e.l;var n=vi(e,t-7,r);return s.t="str",s.val=n,s}function O8(e){var t=mn(e);++e.l;var r=jr(e);return t.t="n",t.val=r,t}function D8(e,t,r){var s=le(15);return Uc(s,e,t),s.write_shift(8,r,"f"),s}function L8(e){var t=mn(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function M8(e,t,r){var s=le(9);return Uc(s,e,t),s.write_shift(2,r),s}function B8(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function U8(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function z8(e,t,r){var s=e.l+t,n=mn(e),a=e.read_shift(2),i=oi(e,a,r);return e.l=s,n.t="str",n.val=i,n}var $8=[2,3,48,49,131,139,140,245],Im=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=g0({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,c){var u=[],d=da(1);switch(c.type){case"base64":d=os(fs(l));break;case"binary":d=os(l);break;case"buffer":case"array":d=l;break}pr(d,0);var f=d.read_shift(1),h=!!(f&136),m=!1,x=!1;switch(f){case 2:break;case 3:break;case 48:m=!0,h=!0;break;case 49:m=!0,h=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var p=0,g=521;f==2&&(p=d.read_shift(2)),d.l+=3,f!=2&&(p=d.read_shift(4)),p>1048576&&(p=1e6),f!=2&&(g=d.read_shift(2));var w=d.read_shift(2),v=c.codepage||1252;f!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(v=e[d[d.l]]),d.l+=1,d.l+=2),x&&(d.l+=36);for(var y=[],b={},S=Math.min(d.length,f==2?521:g-10-(m?264:0)),k=x?32:11;d.l<S&&d[d.l]!=13;)switch(b={},b.name=oc.utils.decode(v,d.slice(d.l,d.l+k)).replace(/[\u0000\r\n].*$/g,""),d.l+=k,b.type=String.fromCharCode(d.read_shift(1)),f!=2&&!x&&(b.offset=d.read_shift(4)),b.len=d.read_shift(1),f==2&&(b.offset=d.read_shift(2)),b.dec=d.read_shift(1),b.name.length&&y.push(b),f!=2&&(d.l+=x?13:14),b.type){case"B":(!m||b.len!=8)&&c.WTF&&console.log("Skipping "+b.name+":"+b.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+b.name+":"+b.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+b.type)}if(d[d.l]!==13&&(d.l=g-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=g;var _=0,N=0;for(u[0]=[],N=0;N!=y.length;++N)u[0][N]=y[N].name;for(;p-- >0;){if(d[d.l]===42){d.l+=w;continue}for(++d.l,u[++_]=[],N=0,N=0;N!=y.length;++N){var C=d.slice(d.l,d.l+y[N].len);d.l+=y[N].len,pr(C,0);var B=oc.utils.decode(v,C);switch(y[N].type){case"C":B.trim().length&&(u[_][N]=B.replace(/\s+$/,""));break;case"D":B.length===8?u[_][N]=new Date(+B.slice(0,4),+B.slice(4,6)-1,+B.slice(6,8)):u[_][N]=B;break;case"F":u[_][N]=parseFloat(B.trim());break;case"+":case"I":u[_][N]=x?C.read_shift(-4,"i")^2147483648:C.read_shift(4,"i");break;case"L":switch(B.trim().toUpperCase()){case"Y":case"T":u[_][N]=!0;break;case"N":case"F":u[_][N]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+B+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));u[_][N]="##MEMO##"+(x?parseInt(B.trim(),10):C.read_shift(4));break;case"N":B=B.replace(/\u0000/g,"").trim(),B&&B!="."&&(u[_][N]=+B||0);break;case"@":u[_][N]=new Date(C.read_shift(-8,"f")-621356832e5);break;case"T":u[_][N]=new Date((C.read_shift(4)-2440588)*864e5+C.read_shift(4));break;case"Y":u[_][N]=C.read_shift(4,"i")/1e4+C.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[_][N]=-C.read_shift(-8,"f");break;case"B":if(m&&y[N].len==8){u[_][N]=C.read_shift(8,"f");break}case"G":case"P":C.l+=y[N].len;break;case"0":if(y[N].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+y[N].type)}}}if(f!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=y,u}function s(l,c){var u=c||{};u.dateNF||(u.dateNF="yyyymmdd");var d=Mo(r(l,u),u);return d["!cols"]=u.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete u.DBF,d}function n(l,c){try{return _a(s(l,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function i(l,c){var u=c||{};if(+u.codepage>=0&&Gs(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var d=Jr(),f=$d(l,{header:1,raw:!0,cellDates:!0}),h=f[0],m=f.slice(1),x=l["!cols"]||[],p=0,g=0,w=0,v=1;for(p=0;p<h.length;++p){if(((x[p]||{}).DBF||{}).name){h[p]=x[p].DBF.name,++w;continue}if(h[p]!=null){if(++w,typeof h[p]=="number"&&(h[p]=h[p].toString(10)),typeof h[p]!="string")throw new Error("DBF Invalid column name "+h[p]+" |"+typeof h[p]+"|");if(h.indexOf(h[p])!==p){for(g=0;g<1024;++g)if(h.indexOf(h[p]+"_"+g)==-1){h[p]+="_"+g;break}}}}var y=ct(l["!ref"]),b=[],S=[],k=[];for(p=0;p<=y.e.c-y.s.c;++p){var _="",N="",C=0,B=[];for(g=0;g<m.length;++g)m[g][p]!=null&&B.push(m[g][p]);if(B.length==0||h[p]==null){b[p]="?";continue}for(g=0;g<B.length;++g){switch(typeof B[g]){case"number":N="B";break;case"string":N="C";break;case"boolean":N="L";break;case"object":N=B[g]instanceof Date?"D":"C";break;default:N="C"}C=Math.max(C,String(B[g]).length),_=_&&_!=N?"C":N}C>250&&(C=250),N=((x[p]||{}).DBF||{}).type,N=="C"&&x[p].DBF.len>C&&(C=x[p].DBF.len),_=="B"&&N=="N"&&(_="N",k[p]=x[p].DBF.dec,C=x[p].DBF.len),S[p]=_=="C"||N=="N"?C:a[_]||0,v+=S[p],b[p]=_}var H=d.next(32);for(H.write_shift(4,318902576),H.write_shift(4,m.length),H.write_shift(2,296+32*w),H.write_shift(2,v),p=0;p<4;++p)H.write_shift(4,0);for(H.write_shift(4,0|(+t[Wk]||3)<<8),p=0,g=0;p<h.length;++p)if(h[p]!=null){var V=d.next(32),K=(h[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);V.write_shift(1,K,"sbcs"),V.write_shift(1,b[p]=="?"?"C":b[p],"sbcs"),V.write_shift(4,g),V.write_shift(1,S[p]||a[b[p]]||0),V.write_shift(1,k[p]||0),V.write_shift(1,2),V.write_shift(4,0),V.write_shift(1,0),V.write_shift(4,0),V.write_shift(4,0),g+=S[p]||a[b[p]]||0}var Y=d.next(264);for(Y.write_shift(4,13),p=0;p<65;++p)Y.write_shift(4,0);for(p=0;p<m.length;++p){var q=d.next(v);for(q.write_shift(1,0),g=0;g<h.length;++g)if(h[g]!=null)switch(b[g]){case"L":q.write_shift(1,m[p][g]==null?63:m[p][g]?84:70);break;case"B":q.write_shift(8,m[p][g]||0,"f");break;case"N":var X="0";for(typeof m[p][g]=="number"&&(X=m[p][g].toFixed(k[g]||0)),w=0;w<S[g]-X.length;++w)q.write_shift(1,32);q.write_shift(1,X,"sbcs");break;case"D":m[p][g]?(q.write_shift(4,("0000"+m[p][g].getFullYear()).slice(-4),"sbcs"),q.write_shift(2,("00"+(m[p][g].getMonth()+1)).slice(-2),"sbcs"),q.write_shift(2,("00"+m[p][g].getDate()).slice(-2),"sbcs")):q.write_shift(8,"00000000","sbcs");break;case"C":var ie=String(m[p][g]!=null?m[p][g]:"").slice(0,S[g]);for(q.write_shift(1,ie,"sbcs"),w=0;w<S[g]-ie.length;++w)q.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:n,to_sheet:s,from_sheet:i}}(),rE=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Ut(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,m){var x=e[m];return typeof x=="number"?N1(x):x},s=function(h,m,x){var p=m.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return p==59?h:N1(p)};e["|"]=254;function n(h,m){switch(m.type){case"base64":return a(fs(h),m);case"binary":return a(h,m);case"buffer":return a(Ze&&Buffer.isBuffer(h)?h.toString("binary"):ba(h),m);case"array":return a(ai(h),m)}throw new Error("Unrecognized type "+m.type)}function a(h,m){var x=h.split(/[\n\r]+/),p=-1,g=-1,w=0,v=0,y=[],b=[],S=null,k={},_=[],N=[],C=[],B=0,H;for(+m.codepage>=0&&Gs(+m.codepage);w!==x.length;++w){B=0;var V=x[w].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,s).replace(t,r),K=V.replace(/;;/g,"\0").split(";").map(function(z){return z.replace(/\u0000/g,";")}),Y=K[0],q;if(V.length>0)switch(Y){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":K[1].charAt(0)=="P"&&b.push(V.slice(3).replace(/;;/g,";"));break;case"C":var X=!1,ie=!1,W=!1,U=!1,he=-1,be=-1;for(v=1;v<K.length;++v)switch(K[v].charAt(0)){case"A":break;case"X":g=parseInt(K[v].slice(1))-1,ie=!0;break;case"Y":for(p=parseInt(K[v].slice(1))-1,ie||(g=0),H=y.length;H<=p;++H)y[H]=[];break;case"K":q=K[v].slice(1),q.charAt(0)==='"'?q=q.slice(1,q.length-1):q==="TRUE"?q=!0:q==="FALSE"?q=!1:isNaN(Ys(q))?isNaN(So(q).getDate())||(q=_t(q)):(q=Ys(q),S!==null&&Do(S)&&(q=y0(q))),X=!0;break;case"E":U=!0;var R=oo(K[v].slice(1),{r:p,c:g});y[p][g]=[y[p][g],R];break;case"S":W=!0,y[p][g]=[y[p][g],"S5S"];break;case"G":break;case"R":he=parseInt(K[v].slice(1))-1;break;case"C":be=parseInt(K[v].slice(1))-1;break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+V)}if(X&&(y[p][g]&&y[p][g].length==2?y[p][g][0]=q:y[p][g]=q,S=null),W){if(U)throw new Error("SYLK shared formula cannot have own formula");var M=he>-1&&y[he][be];if(!M||!M[1])throw new Error("SYLK shared formula cannot find base");y[p][g][1]=wE(M[1],{r:p-he,c:g-be})}break;case"F":var O=0;for(v=1;v<K.length;++v)switch(K[v].charAt(0)){case"X":g=parseInt(K[v].slice(1))-1,++O;break;case"Y":for(p=parseInt(K[v].slice(1))-1,H=y.length;H<=p;++H)y[H]=[];break;case"M":B=parseInt(K[v].slice(1))/20;break;case"F":break;case"G":break;case"P":S=b[parseInt(K[v].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(C=K[v].slice(1).split(" "),H=parseInt(C[0],10);H<=parseInt(C[1],10);++H)B=parseInt(C[2],10),N[H-1]=B===0?{hidden:!0}:{wch:B},fa(N[H-1]);break;case"C":g=parseInt(K[v].slice(1))-1,N[g]||(N[g]={});break;case"R":p=parseInt(K[v].slice(1))-1,_[p]||(_[p]={}),B>0?(_[p].hpt=B,_[p].hpx=No(B)):B===0&&(_[p].hidden=!0);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+V)}O<1&&(S=null);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+V)}}return _.length>0&&(k["!rows"]=_),N.length>0&&(k["!cols"]=N),m&&m.sheetRows&&(y=y.slice(0,m.sheetRows)),[y,k]}function i(h,m){var x=n(h,m),p=x[0],g=x[1],w=Mo(p,m);return Ut(g).forEach(function(v){w[v]=g[v]}),w}function l(h,m){return _a(i(h,m),m)}function c(h,m,x,p){var g="C;Y"+(x+1)+";X"+(p+1)+";K";switch(h.t){case"n":g+=h.v||0,h.f&&!h.F&&(g+=";E"+sg(h.f,{r:x,c:p}));break;case"b":g+=h.v?"TRUE":"FALSE";break;case"e":g+=h.w||h.v;break;case"d":g+='"'+(h.w||h.v)+'"';break;case"s":g+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function u(h,m){m.forEach(function(x,p){var g="F;W"+(p+1)+" "+(p+1)+" ";x.hidden?g+="0":(typeof x.width=="number"&&!x.wpx&&(x.wpx=pc(x.width)),typeof x.wpx=="number"&&!x.wch&&(x.wch=xc(x.wpx)),typeof x.wch=="number"&&(g+=Math.round(x.wch))),g.charAt(g.length-1)!=" "&&h.push(g)})}function d(h,m){m.forEach(function(x,p){var g="F;";x.hidden?g+="M0;":x.hpt?g+="M"+20*x.hpt+";":x.hpx&&(g+="M"+20*gc(x.hpx)+";"),g.length>2&&h.push(g+"R"+(p+1))})}function f(h,m){var x=["ID;PWXL;N;E"],p=[],g=ct(h["!ref"]),w,v=Array.isArray(h),y=`\r
`;x.push("P;PGeneral"),x.push("F;P0;DG0G8;M255"),h["!cols"]&&u(x,h["!cols"]),h["!rows"]&&d(x,h["!rows"]),x.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var b=g.s.r;b<=g.e.r;++b)for(var S=g.s.c;S<=g.e.c;++S){var k=Ve({r:b,c:S});w=v?(h[b]||[])[S]:h[k],!(!w||w.v==null&&(!w.f||w.F))&&p.push(c(w,h,b,S))}return x.join(y)+y+p.join(y)+y+"E"+y}return{to_workbook:l,to_sheet:i,from_sheet:f}}(),sE=function(){function e(a,i){switch(i.type){case"base64":return t(fs(a),i);case"binary":return t(a,i);case"buffer":return t(Ze&&Buffer.isBuffer(a)?a.toString("binary"):ba(a),i);case"array":return t(ai(a),i)}throw new Error("Unrecognized type "+i.type)}function t(a,i){for(var l=a.split(`
`),c=-1,u=-1,d=0,f=[];d!==l.length;++d){if(l[d].trim()==="BOT"){f[++c]=[],u=0;continue}if(!(c<0)){var h=l[d].trim().split(","),m=h[0],x=h[1];++d;for(var p=l[d]||"";(p.match(/["]/g)||[]).length&1&&d<l.length-1;)p+=`
`+l[++d];switch(p=p.trim(),+m){case-1:if(p==="BOT"){f[++c]=[],u=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?f[c][u]=!0:p==="FALSE"?f[c][u]=!1:isNaN(Ys(x))?isNaN(So(x).getDate())?f[c][u]=x:f[c][u]=_t(x):f[c][u]=Ys(x),++u;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),f[c][u++]=p!==""?p:null;break}if(p==="EOD")break}}return i&&i.sheetRows&&(f=f.slice(0,i.sheetRows)),f}function r(a,i){return Mo(e(a,i),i)}function s(a,i){return _a(r(a,i),i)}var n=function(){var a=function(c,u,d,f,h){c.push(u),c.push(d+","+f),c.push('"'+h.replace(/"/g,'""')+'"')},i=function(c,u,d,f){c.push(u+","+d),c.push(u==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(c){var u=[],d=ct(c["!ref"]),f,h=Array.isArray(c);a(u,"TABLE",0,1,"sheetjs"),a(u,"VECTORS",0,d.e.r-d.s.r+1,""),a(u,"TUPLES",0,d.e.c-d.s.c+1,""),a(u,"DATA",0,0,"");for(var m=d.s.r;m<=d.e.r;++m){i(u,-1,0,"BOT");for(var x=d.s.c;x<=d.e.c;++x){var p=Ve({r:m,c:x});if(f=h?(c[m]||[])[x]:c[p],!f){i(u,1,0,"");continue}switch(f.t){case"n":var g=f.w;!g&&f.v!=null&&(g=f.v),g==null?f.f&&!f.F?i(u,1,0,"="+f.f):i(u,1,0,""):i(u,0,g,"V");break;case"b":i(u,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":i(u,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=Os(f.z||$e[14],nr(_t(f.v)))),i(u,0,f.w,"V");break;default:i(u,1,0,"")}}}i(u,-1,0,"EOD");var w=`\r
`,v=u.join(w);return v}}();return{to_workbook:s,to_sheet:r,from_sheet:n}}(),nE=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,h){for(var m=f.split(`
`),x=-1,p=-1,g=0,w=[];g!==m.length;++g){var v=m[g].trim().split(":");if(v[0]==="cell"){var y=Rt(v[1]);if(w.length<=y.r)for(x=w.length;x<=y.r;++x)w[x]||(w[x]=[]);switch(x=y.r,p=y.c,v[2]){case"t":w[x][p]=e(v[3]);break;case"v":w[x][p]=+v[3];break;case"vtf":var b=v[v.length-1];case"vtc":switch(v[3]){case"nl":w[x][p]=!!+v[4];break;default:w[x][p]=+v[4];break}v[2]=="vtf"&&(w[x][p]=[w[x][p],b])}}}return h&&h.sheetRows&&(w=w.slice(0,h.sheetRows)),w}function s(f,h){return Mo(r(f,h),h)}function n(f,h){return _a(s(f,h),h)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function u(f){if(!f||!f["!ref"])return"";for(var h=[],m=[],x,p="",g=Zr(f["!ref"]),w=Array.isArray(f),v=g.s.r;v<=g.e.r;++v)for(var y=g.s.c;y<=g.e.c;++y)if(p=Ve({r:v,c:y}),x=w?(f[v]||[])[y]:f[p],!(!x||x.v==null||x.t==="z")){switch(m=["cell",p,"t"],x.t){case"s":case"str":m.push(t(x.v));break;case"n":x.f?(m[2]="vtf",m[3]="n",m[4]=x.v,m[5]=t(x.f)):(m[2]="v",m[3]=x.v);break;case"b":m[2]="vt"+(x.f?"f":"c"),m[3]="nl",m[4]=x.v?"1":"0",m[5]=t(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var b=nr(_t(x.v));m[2]="vtc",m[3]="nd",m[4]=""+b,m[5]=x.w||Os(x.z||$e[14],b);break;case"e":continue}h.push(m.join(":"))}return h.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function d(f){return[a,i,l,i,u(f),c].join(`
`)}return{to_workbook:n,to_sheet:s,from_sheet:d}}(),ko=function(){function e(d,f,h,m,x){x.raw?f[h][m]=d:d===""||(d==="TRUE"?f[h][m]=!0:d==="FALSE"?f[h][m]=!1:isNaN(Ys(d))?isNaN(So(d).getDate())?f[h][m]=d:f[h][m]=_t(d):f[h][m]=Ys(d))}function t(d,f){var h=f||{},m=[];if(!d||d.length===0)return m;for(var x=d.split(/[\r\n]/),p=x.length-1;p>=0&&x[p].length===0;)--p;for(var g=10,w=0,v=0;v<=p;++v)w=x[v].indexOf(" "),w==-1?w=x[v].length:w++,g=Math.max(g,w);for(v=0;v<=p;++v){m[v]=[];var y=0;for(e(x[v].slice(0,g).trim(),m,v,y,h),y=1;y<=(x[v].length-g)/10+1;++y)e(x[v].slice(g+(y-1)*10,g+y*10).trim(),m,v,y,h)}return h.sheetRows&&(m=m.slice(0,h.sheetRows)),m}var r={44:",",9:"	",59:";",124:"|"},s={44:3,9:2,59:1,124:0};function n(d){for(var f={},h=!1,m=0,x=0;m<d.length;++m)(x=d.charCodeAt(m))==34?h=!h:!h&&x in r&&(f[x]=(f[x]||0)+1);x=[];for(m in f)Object.prototype.hasOwnProperty.call(f,m)&&x.push([f[m],m]);if(!x.length){f=s;for(m in f)Object.prototype.hasOwnProperty.call(f,m)&&x.push([f[m],m])}return x.sort(function(p,g){return p[0]-g[0]||s[p[1]]-s[g[1]]}),r[x.pop()[1]]||44}function a(d,f){var h=f||{},m="",x=h.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(m=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(m=d.charAt(4),d=d.slice(6)):m=n(d.slice(0,1024)):h&&h.FS?m=h.FS:m=n(d.slice(0,1024));var g=0,w=0,v=0,y=0,b=0,S=m.charCodeAt(0),k=!1,_=0,N=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var C=h.dateNF!=null?TI(h.dateNF):null;function B(){var H=d.slice(y,b),V={};if(H.charAt(0)=='"'&&H.charAt(H.length-1)=='"'&&(H=H.slice(1,-1).replace(/""/g,'"')),H.length===0)V.t="z";else if(h.raw)V.t="s",V.v=H;else if(H.trim().length===0)V.t="s",V.v=H;else if(H.charCodeAt(0)==61)H.charCodeAt(1)==34&&H.charCodeAt(H.length-1)==34?(V.t="s",V.v=H.slice(2,-1).replace(/""/g,'"')):s9(H)?(V.t="n",V.f=H.slice(1)):(V.t="s",V.v=H);else if(H=="TRUE")V.t="b",V.v=!0;else if(H=="FALSE")V.t="b",V.v=!1;else if(!isNaN(v=Ys(H)))V.t="n",h.cellText!==!1&&(V.w=H),V.v=v;else if(!isNaN(So(H).getDate())||C&&H.match(C)){V.z=h.dateNF||$e[14];var K=0;C&&H.match(C)&&(H=CI(H,h.dateNF,H.match(C)||[]),K=1),h.cellDates?(V.t="d",V.v=_t(H,K)):(V.t="n",V.v=nr(_t(H,K))),h.cellText!==!1&&(V.w=Os(V.z,V.v instanceof Date?nr(V.v):V.v)),h.cellNF||delete V.z}else V.t="s",V.v=H;if(V.t=="z"||(h.dense?(x[g]||(x[g]=[]),x[g][w]=V):x[Ve({c:w,r:g})]=V),y=b+1,N=d.charCodeAt(y),p.e.c<w&&(p.e.c=w),p.e.r<g&&(p.e.r=g),_==S)++w;else if(w=0,++g,h.sheetRows&&h.sheetRows<=g)return!0}e:for(;b<d.length;++b)switch(_=d.charCodeAt(b)){case 34:N===34&&(k=!k);break;case S:case 10:case 13:if(!k&&B())break e;break}return b-y>0&&B(),x["!ref"]=Ke(p),x}function i(d,f){return!(f&&f.PRN)||f.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?a(d,f):Mo(t(d,f),f)}function l(d,f){var h="",m=f.type=="string"?[0,0,0,0]:dg(d,f);switch(f.type){case"base64":h=fs(d);break;case"binary":h=d;break;case"buffer":f.codepage==65001?h=d.toString("utf8"):f.codepage&&typeof oc<"u"||(h=Ze&&Buffer.isBuffer(d)?d.toString("binary"):ba(d));break;case"array":h=ai(d);break;case"string":h=d;break;default:throw new Error("Unrecognized type "+f.type)}return m[0]==239&&m[1]==187&&m[2]==191?h=xt(h.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?h=xt(h):f.type=="binary"&&typeof oc<"u",h.slice(0,19)=="socialcalc:version:"?nE.to_sheet(f.type=="string"?h:xt(h),f):i(h,f)}function c(d,f){return _a(l(d,f),f)}function u(d){for(var f=[],h=ct(d["!ref"]),m,x=Array.isArray(d),p=h.s.r;p<=h.e.r;++p){for(var g=[],w=h.s.c;w<=h.e.c;++w){var v=Ve({r:p,c:w});if(m=x?(d[p]||[])[w]:d[v],!m||m.v==null){g.push("          ");continue}for(var y=(m.w||(In(m),m.w)||"").slice(0,10);y.length<10;)y+=" ";g.push(y+(w===0?" ":""))}f.push(g.join(""))}return f.join(`
`)}return{to_workbook:c,to_sheet:l,from_sheet:u}}();function V8(e,t){var r=t||{},s=!!r.WTF;r.WTF=!0;try{var n=rE.to_workbook(e,r);return r.WTF=s,n}catch(a){if(r.WTF=s,!a.message.match(/SYLK bad record ID/)&&s)throw a;return ko.to_workbook(e,t)}}var Xa=function(){function e(R,M,O){if(R){pr(R,R.l||0);for(var z=O.Enum||he;R.l<R.length;){var J=R.read_shift(2),pe=z[J]||z[65535],ge=R.read_shift(2),ne=R.l+ge,ae=pe.f&&pe.f(R,ge,O);if(R.l=ne,M(ae,pe,J))return}}}function t(R,M){switch(M.type){case"base64":return r(os(fs(R)),M);case"binary":return r(os(R),M);case"buffer":case"array":return r(R,M)}throw"Unsupported type "+M.type}function r(R,M){if(!R)return R;var O=M||{},z=O.dense?[]:{},J="Sheet1",pe="",ge=0,ne={},ae=[],Ce=[],P={s:{r:0,c:0},e:{r:0,c:0}},ce=O.sheetRows||0;if(R[2]==0&&(R[3]==8||R[3]==9)&&R.length>=16&&R[14]==5&&R[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(R[2]==2)O.Enum=he,e(R,function(G,Q,me){switch(me){case 0:O.vers=G,G>=4096&&(O.qpro=!0);break;case 6:P=G;break;case 204:G&&(pe=G);break;case 222:pe=G;break;case 15:case 51:O.qpro||(G[1].v=G[1].v.slice(1));case 13:case 14:case 16:me==14&&(G[2]&112)==112&&(G[2]&15)>1&&(G[2]&15)<15&&(G[1].z=O.dateNF||$e[14],O.cellDates&&(G[1].t="d",G[1].v=y0(G[1].v))),O.qpro&&G[3]>ge&&(z["!ref"]=Ke(P),ne[J]=z,ae.push(J),z=O.dense?[]:{},P={s:{r:0,c:0},e:{r:0,c:0}},ge=G[3],J=pe||"Sheet"+(ge+1),pe="");var fe=O.dense?(z[G[0].r]||[])[G[0].c]:z[Ve(G[0])];if(fe){fe.t=G[1].t,fe.v=G[1].v,G[1].z!=null&&(fe.z=G[1].z),G[1].f!=null&&(fe.f=G[1].f);break}O.dense?(z[G[0].r]||(z[G[0].r]=[]),z[G[0].r][G[0].c]=G[1]):z[Ve(G[0])]=G[1];break}},O);else if(R[2]==26||R[2]==14)O.Enum=be,R[2]==14&&(O.qpro=!0,R.l=0),e(R,function(G,Q,me){switch(me){case 204:J=G;break;case 22:G[1].v=G[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(G[3]>ge&&(z["!ref"]=Ke(P),ne[J]=z,ae.push(J),z=O.dense?[]:{},P={s:{r:0,c:0},e:{r:0,c:0}},ge=G[3],J="Sheet"+(ge+1)),ce>0&&G[0].r>=ce)break;O.dense?(z[G[0].r]||(z[G[0].r]=[]),z[G[0].r][G[0].c]=G[1]):z[Ve(G[0])]=G[1],P.e.c<G[0].c&&(P.e.c=G[0].c),P.e.r<G[0].r&&(P.e.r=G[0].r);break;case 27:G[14e3]&&(Ce[G[14e3][0]]=G[14e3][1]);break;case 1537:Ce[G[0]]=G[1],G[0]==ge&&(J=G[1]);break}},O);else throw new Error("Unrecognized LOTUS BOF "+R[2]);if(z["!ref"]=Ke(P),ne[pe||J]=z,ae.push(pe||J),!Ce.length)return{SheetNames:ae,Sheets:ne};for(var ue={},Ee=[],T=0;T<Ce.length;++T)ne[ae[T]]?(Ee.push(Ce[T]||ae[T]),ue[Ce[T]]=ne[Ce[T]]||ne[ae[T]]):(Ee.push(Ce[T]),ue[Ce[T]]={"!ref":"A1"});return{SheetNames:Ee,Sheets:ue}}function s(R,M){var O=M||{};if(+O.codepage>=0&&Gs(+O.codepage),O.type=="string")throw new Error("Cannot write WK1 to JS string");var z=Jr(),J=ct(R["!ref"]),pe=Array.isArray(R),ge=[];Te(z,0,a(1030)),Te(z,6,c(J));for(var ne=Math.min(J.e.r,8191),ae=J.s.r;ae<=ne;++ae)for(var Ce=Wt(ae),P=J.s.c;P<=J.e.c;++P){ae===J.s.r&&(ge[P]=Pt(P));var ce=ge[P]+Ce,ue=pe?(R[ae]||[])[P]:R[ce];if(!(!ue||ue.t=="z"))if(ue.t=="n")(ue.v|0)==ue.v&&ue.v>=-32768&&ue.v<=32767?Te(z,13,m(ae,P,ue.v)):Te(z,14,p(ae,P,ue.v));else{var Ee=In(ue);Te(z,15,f(ae,P,Ee.slice(0,239)))}}return Te(z,1),z.end()}function n(R,M){var O=M||{};if(+O.codepage>=0&&Gs(+O.codepage),O.type=="string")throw new Error("Cannot write WK3 to JS string");var z=Jr();Te(z,0,i(R));for(var J=0,pe=0;J<R.SheetNames.length;++J)(R.Sheets[R.SheetNames[J]]||{})["!ref"]&&Te(z,27,U(R.SheetNames[J],pe++));var ge=0;for(J=0;J<R.SheetNames.length;++J){var ne=R.Sheets[R.SheetNames[J]];if(!(!ne||!ne["!ref"])){for(var ae=ct(ne["!ref"]),Ce=Array.isArray(ne),P=[],ce=Math.min(ae.e.r,8191),ue=ae.s.r;ue<=ce;++ue)for(var Ee=Wt(ue),T=ae.s.c;T<=ae.e.c;++T){ue===ae.s.r&&(P[T]=Pt(T));var G=P[T]+Ee,Q=Ce?(ne[ue]||[])[T]:ne[G];if(!(!Q||Q.t=="z"))if(Q.t=="n")Te(z,23,B(ue,T,ge,Q.v));else{var me=In(Q);Te(z,22,_(ue,T,ge,me.slice(0,239)))}}++ge}}return Te(z,1),z.end()}function a(R){var M=le(2);return M.write_shift(2,R),M}function i(R){var M=le(26);M.write_shift(2,4096),M.write_shift(2,4),M.write_shift(4,0);for(var O=0,z=0,J=0,pe=0;pe<R.SheetNames.length;++pe){var ge=R.SheetNames[pe],ne=R.Sheets[ge];if(!(!ne||!ne["!ref"])){++J;var ae=Zr(ne["!ref"]);O<ae.e.r&&(O=ae.e.r),z<ae.e.c&&(z=ae.e.c)}}return O>8191&&(O=8191),M.write_shift(2,O),M.write_shift(1,J),M.write_shift(1,z),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(1,1),M.write_shift(1,2),M.write_shift(4,0),M.write_shift(4,0),M}function l(R,M,O){var z={s:{c:0,r:0},e:{c:0,r:0}};return M==8&&O.qpro?(z.s.c=R.read_shift(1),R.l++,z.s.r=R.read_shift(2),z.e.c=R.read_shift(1),R.l++,z.e.r=R.read_shift(2),z):(z.s.c=R.read_shift(2),z.s.r=R.read_shift(2),M==12&&O.qpro&&(R.l+=2),z.e.c=R.read_shift(2),z.e.r=R.read_shift(2),M==12&&O.qpro&&(R.l+=2),z.s.c==65535&&(z.s.c=z.e.c=z.s.r=z.e.r=0),z)}function c(R){var M=le(8);return M.write_shift(2,R.s.c),M.write_shift(2,R.s.r),M.write_shift(2,R.e.c),M.write_shift(2,R.e.r),M}function u(R,M,O){var z=[{c:0,r:0},{t:"n",v:0},0,0];return O.qpro&&O.vers!=20768?(z[0].c=R.read_shift(1),z[3]=R.read_shift(1),z[0].r=R.read_shift(2),R.l+=2):(z[2]=R.read_shift(1),z[0].c=R.read_shift(2),z[0].r=R.read_shift(2)),z}function d(R,M,O){var z=R.l+M,J=u(R,M,O);if(J[1].t="s",O.vers==20768){R.l++;var pe=R.read_shift(1);return J[1].v=R.read_shift(pe,"utf8"),J}return O.qpro&&R.l++,J[1].v=R.read_shift(z-R.l,"cstr"),J}function f(R,M,O){var z=le(7+O.length);z.write_shift(1,255),z.write_shift(2,M),z.write_shift(2,R),z.write_shift(1,39);for(var J=0;J<z.length;++J){var pe=O.charCodeAt(J);z.write_shift(1,pe>=128?95:pe)}return z.write_shift(1,0),z}function h(R,M,O){var z=u(R,M,O);return z[1].v=R.read_shift(2,"i"),z}function m(R,M,O){var z=le(7);return z.write_shift(1,255),z.write_shift(2,M),z.write_shift(2,R),z.write_shift(2,O,"i"),z}function x(R,M,O){var z=u(R,M,O);return z[1].v=R.read_shift(8,"f"),z}function p(R,M,O){var z=le(13);return z.write_shift(1,255),z.write_shift(2,M),z.write_shift(2,R),z.write_shift(8,O,"f"),z}function g(R,M,O){var z=R.l+M,J=u(R,M,O);if(J[1].v=R.read_shift(8,"f"),O.qpro)R.l=z;else{var pe=R.read_shift(2);b(R.slice(R.l,R.l+pe),J),R.l+=pe}return J}function w(R,M,O){var z=M&32768;return M&=-32769,M=(z?R:0)+(M>=8192?M-16384:M),(z?"":"$")+(O?Pt(M):Wt(M))}var v={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},y=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function b(R,M){pr(R,0);for(var O=[],z=0,J="",pe="",ge="",ne="";R.l<R.length;){var ae=R[R.l++];switch(ae){case 0:O.push(R.read_shift(8,"f"));break;case 1:pe=w(M[0].c,R.read_shift(2),!0),J=w(M[0].r,R.read_shift(2),!1),O.push(pe+J);break;case 2:{var Ce=w(M[0].c,R.read_shift(2),!0),P=w(M[0].r,R.read_shift(2),!1);pe=w(M[0].c,R.read_shift(2),!0),J=w(M[0].r,R.read_shift(2),!1),O.push(Ce+P+":"+pe+J)}break;case 3:if(R.l<R.length){console.error("WK1 premature formula end");return}break;case 4:O.push("("+O.pop()+")");break;case 5:O.push(R.read_shift(2));break;case 6:{for(var ce="";ae=R[R.l++];)ce+=String.fromCharCode(ae);O.push('"'+ce.replace(/"/g,'""')+'"')}break;case 8:O.push("-"+O.pop());break;case 23:O.push("+"+O.pop());break;case 22:O.push("NOT("+O.pop()+")");break;case 20:case 21:ne=O.pop(),ge=O.pop(),O.push(["AND","OR"][ae-20]+"("+ge+","+ne+")");break;default:if(ae<32&&y[ae])ne=O.pop(),ge=O.pop(),O.push(ge+y[ae]+ne);else if(v[ae]){if(z=v[ae][1],z==69&&(z=R[R.l++]),z>O.length){console.error("WK1 bad formula parse 0x"+ae.toString(16)+":|"+O.join("|")+"|");return}var ue=O.slice(-z);O.length-=z,O.push(v[ae][0]+"("+ue.join(",")+")")}else return ae<=7?console.error("WK1 invalid opcode "+ae.toString(16)):ae<=24?console.error("WK1 unsupported op "+ae.toString(16)):ae<=30?console.error("WK1 invalid opcode "+ae.toString(16)):ae<=115?console.error("WK1 unsupported function opcode "+ae.toString(16)):console.error("WK1 unrecognized opcode "+ae.toString(16))}}O.length==1?M[1].f=""+O[0]:console.error("WK1 bad formula parse |"+O.join("|")+"|")}function S(R){var M=[{c:0,r:0},{t:"n",v:0},0];return M[0].r=R.read_shift(2),M[3]=R[R.l++],M[0].c=R[R.l++],M}function k(R,M){var O=S(R);return O[1].t="s",O[1].v=R.read_shift(M-4,"cstr"),O}function _(R,M,O,z){var J=le(6+z.length);J.write_shift(2,R),J.write_shift(1,O),J.write_shift(1,M),J.write_shift(1,39);for(var pe=0;pe<z.length;++pe){var ge=z.charCodeAt(pe);J.write_shift(1,ge>=128?95:ge)}return J.write_shift(1,0),J}function N(R,M){var O=S(R);O[1].v=R.read_shift(2);var z=O[1].v>>1;if(O[1].v&1)switch(z&7){case 0:z=(z>>3)*5e3;break;case 1:z=(z>>3)*500;break;case 2:z=(z>>3)/20;break;case 3:z=(z>>3)/200;break;case 4:z=(z>>3)/2e3;break;case 5:z=(z>>3)/2e4;break;case 6:z=(z>>3)/16;break;case 7:z=(z>>3)/64;break}return O[1].v=z,O}function C(R,M){var O=S(R),z=R.read_shift(4),J=R.read_shift(4),pe=R.read_shift(2);if(pe==65535)return z===0&&J===3221225472?(O[1].t="e",O[1].v=15):z===0&&J===3489660928?(O[1].t="e",O[1].v=42):O[1].v=0,O;var ge=pe&32768;return pe=(pe&32767)-16446,O[1].v=(1-ge*2)*(J*Math.pow(2,pe+32)+z*Math.pow(2,pe)),O}function B(R,M,O,z){var J=le(14);if(J.write_shift(2,R),J.write_shift(1,O),J.write_shift(1,M),z==0)return J.write_shift(4,0),J.write_shift(4,0),J.write_shift(2,65535),J;var pe=0,ge=0,ne=0,ae=0;return z<0&&(pe=1,z=-z),ge=Math.log2(z)|0,z/=Math.pow(2,ge-31),ae=z>>>0,ae&2147483648||(z/=2,++ge,ae=z>>>0),z-=ae,ae|=2147483648,ae>>>=0,z*=Math.pow(2,32),ne=z>>>0,J.write_shift(4,ne),J.write_shift(4,ae),ge+=16383+(pe?32768:0),J.write_shift(2,ge),J}function H(R,M){var O=C(R);return R.l+=M-14,O}function V(R,M){var O=S(R),z=R.read_shift(4);return O[1].v=z>>6,O}function K(R,M){var O=S(R),z=R.read_shift(8,"f");return O[1].v=z,O}function Y(R,M){var O=K(R);return R.l+=M-10,O}function q(R,M){return R[R.l+M-1]==0?R.read_shift(M,"cstr"):""}function X(R,M){var O=R[R.l++];O>M-1&&(O=M-1);for(var z="";z.length<O;)z+=String.fromCharCode(R[R.l++]);return z}function ie(R,M,O){if(!(!O.qpro||M<21)){var z=R.read_shift(1);R.l+=17,R.l+=1,R.l+=2;var J=R.read_shift(M-21,"cstr");return[z,J]}}function W(R,M){for(var O={},z=R.l+M;R.l<z;){var J=R.read_shift(2);if(J==14e3){for(O[J]=[0,""],O[J][0]=R.read_shift(2);R[R.l];)O[J][1]+=String.fromCharCode(R[R.l]),R.l++;R.l++}}return O}function U(R,M){var O=le(5+R.length);O.write_shift(2,14e3),O.write_shift(2,M);for(var z=0;z<R.length;++z){var J=R.charCodeAt(z);O[O.l++]=J>127?95:J}return O[O.l++]=0,O}var he={0:{n:"BOF",f:Xt},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:x},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:q},222:{n:"SHEETNAMELP",f:X},65535:{n:""}},be={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:k},23:{n:"NUMBER17",f:C},24:{n:"NUMBER18",f:N},25:{n:"FORMULA19",f:H},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:W},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:V},38:{n:"??"},39:{n:"NUMBER27",f:K},40:{n:"FORMULA28",f:Y},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:q},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ie},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:s,book_to_wk3:n,to_workbook:t}}();function W8(e){var t={},r=e.match(Rr),s=0,n=!1;if(r)for(;s!=r.length;++s){var a=qe(r[s]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;t.cp=Tx[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=a.val;break;case"<sz":t.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":a.rgb&&(t.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(a[0].charCodeAt(1)!==47&&!n)throw new Error("Unrecognized rich format "+a[0])}}return t}var q8=function(){var e=uc("t"),t=uc("rPr");function r(a){var i=a.match(e);if(!i)return{t:"s",v:""};var l={t:"s",v:lt(i[1])},c=a.match(t);return c&&(l.s=W8(c[1])),l}var s=/<(?:\w+:)?r>/g,n=/<\/(?:\w+:)?r>/;return function(i){return i.replace(s,"").split(n).map(r).filter(function(l){return l.v})}}(),H8=function(){var t=/(\r\n|\n)/g;function r(n,a,i){var l=[];n.u&&l.push("text-decoration: underline;"),n.uval&&l.push("text-underline-style:"+n.uval+";"),n.sz&&l.push("font-size:"+n.sz+"pt;"),n.outline&&l.push("text-effect: outline;"),n.shadow&&l.push("text-shadow: auto;"),a.push('<span style="'+l.join("")+'">'),n.b&&(a.push("<b>"),i.push("</b>")),n.i&&(a.push("<i>"),i.push("</i>")),n.strike&&(a.push("<s>"),i.push("</s>"));var c=n.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(a.push("<"+c+">"),i.push("</"+c+">")),i.push("</span>"),n}function s(n){var a=[[],n.v,[]];return n.v?(n.s&&r(n.s,a[0],a[2]),a[0].join("")+a[1].replace(t,"<br/>")+a[2].join("")):""}return function(a){return a.map(s).join("")}}(),G8=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,K8=/<(?:\w+:)?r>/,X8=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Jx(e,t){var r=t?t.cellHTML:!0,s={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(s.t=lt(xt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),s.r=xt(e),r&&(s.h=Mx(s.t))):e.match(K8)&&(s.r=xt(e),s.t=lt(xt((e.replace(X8,"").match(G8)||[]).join("").replace(Rr,""))),r&&(s.h=H8(q8(s.r)))),s):{t:""}}var Q8=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,Y8=/<(?:\w+:)?(?:si|sstItem)>/g,J8=/<\/(?:\w+:)?(?:si|sstItem)>/;function Z8(e,t){var r=[],s="";if(!e)return r;var n=e.match(Q8);if(n){s=n[2].replace(Y8,"").split(J8);for(var a=0;a!=s.length;++a){var i=Jx(s[a].trim(),t);i!=null&&(r[r.length]=i)}n=qe(n[1]),r.Count=n.count,r.Unique=n.uniqueCount}return r}var eL=/^\s|\s$|[\t\n\r]/;function aE(e,t){if(!t.bookSST)return"";var r=[qt];r[r.length]=je("sst",null,{xmlns:hi[0],count:e.Count,uniqueCount:e.Unique});for(var s=0;s!=e.length;++s)if(e[s]!=null){var n=e[s],a="<si>";n.r?a+=n.r:(a+="<t",n.t||(n.t=""),n.t.match(eL)&&(a+=' xml:space="preserve"'),a+=">"+ht(n.t)+"</t>"),a+="</si>",r[r.length]=a}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function tL(e){return[e.read_shift(4),e.read_shift(4)]}function rL(e,t){var r=[],s=!1;return Ln(e,function(a,i,l){switch(l){case 159:r.Count=a[0],r.Unique=a[1];break;case 19:r.push(a);break;case 160:return!0;case 35:s=!0;break;case 36:s=!1;break;default:if(i.T,!s||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),r}function sL(e,t){return t||(t=le(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var nL=mO;function aL(e){var t=Jr();ye(t,159,sL(e));for(var r=0;r<e.length;++r)ye(t,19,nL(e[r]));return ye(t,160),t.end()}function iE(e){for(var t=[],r=e.split(""),s=0;s<r.length;++s)t[s]=r[s].charCodeAt(0);return t}function jn(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function iL(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=jn(e,4),t.U=jn(e,4),t.W=jn(e,4),t}function oL(e){for(var t=e.read_shift(4),r=e.l+t-4,s={},n=e.read_shift(4),a=[];n-- >0;)a.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(s.name=e.read_shift(0,"lpp4"),s.comps=a,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return s}function lL(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(oL(e));return t}function cL(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function uL(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=jn(e,4),t.U=jn(e,4),t.W=jn(e,4),t}function dL(e){var t=uL(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function oE(e,t){var r=e.l+t,s={};s.Flags=e.read_shift(4)&63,e.l+=4,s.AlgID=e.read_shift(4);var n=!1;switch(s.AlgID){case 26126:case 26127:case 26128:n=s.Flags==36;break;case 26625:n=s.Flags==4;break;case 0:n=s.Flags==16||s.Flags==4||s.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+s.AlgID}if(!n)throw new Error("Encryption Flags/AlgID mismatch");return s.AlgIDHash=e.read_shift(4),s.KeySize=e.read_shift(4),s.ProviderType=e.read_shift(4),e.l+=8,s.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,s}function lE(e,t){var r={},s=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,s),e.l=s,r}function fL(e){var t=jn(e);switch(t.Minor){case 2:return[t.Minor,hL(e)];case 3:return[t.Minor,mL()];case 4:return[t.Minor,pL(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function hL(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),s=oE(e,r),n=lE(e,e.length-e.l);return{t:"Std",h:s,v:n}}function mL(){throw new Error("File is password-protected: ECMA-376 Extensible")}function pL(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),s={};return r.replace(Rr,function(a){var i=qe(a);switch(hn(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(l){s[l]=i[l]});break;case"<dataIntegrity":s.encryptedHmacKey=i.encryptedHmacKey,s.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":s.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":s.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":s.encs.push(i);break;default:throw i[0]}}),s}function xL(e,t){var r={},s=r.EncryptionVersionInfo=jn(e,4);if(t-=4,s.Minor!=2)throw new Error("unrecognized minor version code: "+s.Minor);if(s.Major>4||s.Major<2)throw new Error("unrecognized major version code: "+s.Major);r.Flags=e.read_shift(4),t-=4;var n=e.read_shift(4);return t-=4,r.EncryptionHeader=oE(e,n),t-=n,r.EncryptionVerifier=lE(e,t),r}function gL(e){var t={},r=t.EncryptionVersionInfo=jn(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function Zx(e){var t=0,r,s=iE(e),n=s.length+1,a,i,l,c,u;for(r=da(n),r[0]=s.length,a=1;a!=n;++a)r[a]=s[a-1];for(a=n-1;a>=0;--a)i=r[a],l=t&16384?1:0,c=t<<1&32767,u=l|c,t=u^i;return t^52811}var cE=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],s=function(i){return(i/2|i*128)&255},n=function(i,l){return s(i^l)},a=function(i){for(var l=t[i.length-1],c=104,u=i.length-1;u>=0;--u)for(var d=i[u],f=0;f!=7;++f)d&64&&(l^=r[c]),d*=2,--c;return l};return function(i){for(var l=iE(i),c=a(l),u=l.length,d=da(16),f=0;f!=16;++f)d[f]=0;var h,m,x;for((u&1)===1&&(h=c>>8,d[u]=n(e[0],h),--u,h=c&255,m=l[l.length-1],d[u]=n(m,h));u>0;)--u,h=c>>8,d[u]=n(l[u],h),--u,h=c&255,d[u]=n(l[u],h);for(u=15,x=15-l.length;x>0;)h=c>>8,d[u]=n(e[x],h),--u,--x,h=c&255,d[u]=n(l[u],h),--u,--x;return d}}(),vL=function(e,t,r,s,n){n||(n=t),s||(s=cE(e));var a,i;for(a=0;a!=t.length;++a)i=t[a],i^=s[r],i=(i>>5|i<<3)&255,n[a]=i,++r;return[n,r,s]},yL=function(e){var t=0,r=cE(e);return function(s){var n=vL("",s,t,r);return t=n[1],n[0]}};function wL(e,t,r,s){var n={key:Xt(e),verificationBytes:Xt(e)};return r.password&&(n.verifier=Zx(r.password)),s.valid=n.verificationBytes===n.verifier,s.valid&&(s.insitu=yL(r.password)),n}function bL(e,t,r){var s=r||{};return s.Info=e.read_shift(2),e.l-=2,s.Info===1?s.Data=gL(e):s.Data=xL(e,t),s}function _L(e,t,r){var s={Type:r.biff>=8?e.read_shift(2):0};return s.Type?bL(e,t-2,s):wL(e,r.biff>=8?t:t-2,r,s),s}var uE=function(){function e(n,a){switch(a.type){case"base64":return t(fs(n),a);case"binary":return t(n,a);case"buffer":return t(Ze&&Buffer.isBuffer(n)?n.toString("binary"):ba(n),a);case"array":return t(ai(n),a)}throw new Error("Unrecognized type "+a.type)}function t(n,a){var i=a||{},l=i.dense?[]:{},c=n.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(d,f){Array.isArray(l)&&(l[f]=[]);for(var h=/\\\w+\b/g,m=0,x,p=-1;x=h.exec(d);){switch(x[0]){case"\\cell":var g=d.slice(m,h.lastIndex-x[0].length);if(g[0]==" "&&(g=g.slice(1)),++p,g.length){var w={v:g,t:"s"};Array.isArray(l)?l[f][p]=w:l[Ve({r:f,c:p})]=w}break}m=h.lastIndex}p>u.e.c&&(u.e.c=p)}),l["!ref"]=Ke(u),l}function r(n,a){return _a(e(n,a),a)}function s(n){for(var a=["{\\rtf1\\ansi"],i=ct(n["!ref"]),l,c=Array.isArray(n),u=i.s.r;u<=i.e.r;++u){a.push("\\trowd\\trautofit1");for(var d=i.s.c;d<=i.e.c;++d)a.push("\\cellx"+(d+1));for(a.push("\\pard\\intbl"),d=i.s.c;d<=i.e.c;++d){var f=Ve({r:u,c:d});l=c?(n[u]||[])[d]:n[f],!(!l||l.v==null&&(!l.f||l.F))&&(a.push(" "+(l.w||(In(l),l.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:s}}();function SL(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function mc(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function kL(e){var t=e[0]/255,r=e[1]/255,s=e[2]/255,n=Math.max(t,r,s),a=Math.min(t,r,s),i=n-a;if(i===0)return[0,0,t];var l=0,c=0,u=n+a;switch(c=i/(u>1?2-u:u),n){case t:l=((r-s)/i+6)%6;break;case r:l=(s-t)/i+2;break;case s:l=(t-r)/i+4;break}return[l/6,c,u/2]}function NL(e){var t=e[0],r=e[1],s=e[2],n=r*2*(s<.5?s:1-s),a=s-n/2,i=[a,a,a],l=6*t,c;if(r!==0)switch(l|0){case 0:case 6:c=n*l,i[0]+=n,i[1]+=c;break;case 1:c=n*(2-l),i[0]+=c,i[1]+=n;break;case 2:c=n*(l-2),i[1]+=n,i[2]+=c;break;case 3:c=n*(4-l),i[1]+=c,i[2]+=n;break;case 4:c=n*(l-4),i[2]+=n,i[0]+=c;break;case 5:c=n*(6-l),i[2]+=c,i[0]+=n;break}for(var u=0;u!=3;++u)i[u]=Math.round(i[u]*255);return i}function Ud(e,t){if(t===0)return e;var r=kL(SL(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),mc(NL(r))}var dE=6,EL=15,jL=1,Er=dE;function pc(e){return Math.floor((e+Math.round(128/Er)/256)*Er)}function xc(e){return Math.floor((e-5)/Er*100+.5)/100}function zd(e){return Math.round((e*Er+5)/Er*256)/256}function Df(e){return zd(xc(pc(e)))}function eg(e){var t=Math.abs(e-Df(e)),r=Er;if(t>.005)for(Er=jL;Er<EL;++Er)Math.abs(e-Df(e))<=t&&(t=Math.abs(e-Df(e)),r=Er);Er=r}function fa(e){e.width?(e.wpx=pc(e.width),e.wch=xc(e.wpx),e.MDW=Er):e.wpx?(e.wch=xc(e.wpx),e.width=zd(e.wch),e.MDW=Er):typeof e.wch=="number"&&(e.width=zd(e.wch),e.wpx=pc(e.width),e.MDW=Er),e.customWidth&&delete e.customWidth}var TL=96,fE=TL;function gc(e){return e*96/fE}function No(e){return e*fE/96}var CL={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function AL(e,t,r,s){t.Borders=[];var n={},a=!1;(e[0].match(Rr)||[]).forEach(function(i){var l=qe(i);switch(hn(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":n={},l.diagonalUp&&(n.diagonalUp=wt(l.diagonalUp)),l.diagonalDown&&(n.diagonalDown=wt(l.diagonalDown)),t.Borders.push(n);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(s&&s.WTF&&!a)throw new Error("unrecognized "+l[0]+" in borders")}})}function FL(e,t,r,s){t.Fills=[];var n={},a=!1;(e[0].match(Rr)||[]).forEach(function(i){var l=qe(i);switch(hn(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":n={},t.Fills.push(n);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(n),n={};break;case"<patternFill":case"<patternFill>":l.patternType&&(n.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":n.bgColor||(n.bgColor={}),l.indexed&&(n.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(n.bgColor.theme=parseInt(l.theme,10)),l.tint&&(n.bgColor.tint=parseFloat(l.tint)),l.rgb&&(n.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":n.fgColor||(n.fgColor={}),l.theme&&(n.fgColor.theme=parseInt(l.theme,10)),l.tint&&(n.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(n.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(s&&s.WTF&&!a)throw new Error("unrecognized "+l[0]+" in fills")}})}function PL(e,t,r,s){t.Fonts=[];var n={},a=!1;(e[0].match(Rr)||[]).forEach(function(i){var l=qe(i);switch(hn(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(n),n={};break;case"<name":l.val&&(n.name=xt(l.val));break;case"<name/>":case"</name>":break;case"<b":n.bold=l.val?wt(l.val):1;break;case"<b/>":n.bold=1;break;case"<i":n.italic=l.val?wt(l.val):1;break;case"<i/>":n.italic=1;break;case"<u":switch(l.val){case"none":n.underline=0;break;case"single":n.underline=1;break;case"double":n.underline=2;break;case"singleAccounting":n.underline=33;break;case"doubleAccounting":n.underline=34;break}break;case"<u/>":n.underline=1;break;case"<strike":n.strike=l.val?wt(l.val):1;break;case"<strike/>":n.strike=1;break;case"<outline":n.outline=l.val?wt(l.val):1;break;case"<outline/>":n.outline=1;break;case"<shadow":n.shadow=l.val?wt(l.val):1;break;case"<shadow/>":n.shadow=1;break;case"<condense":n.condense=l.val?wt(l.val):1;break;case"<condense/>":n.condense=1;break;case"<extend":n.extend=l.val?wt(l.val):1;break;case"<extend/>":n.extend=1;break;case"<sz":l.val&&(n.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(n.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(n.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(n.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=Tx[parseInt(l.val,10)];break;case"<color":if(n.color||(n.color={}),l.auto&&(n.color.auto=wt(l.auto)),l.rgb)n.color.rgb=l.rgb.slice(-6);else if(l.indexed){n.color.index=parseInt(l.indexed,10);var c=Ga[n.color.index];n.color.index==81&&(c=Ga[1]),c||(c=Ga[1]),n.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else l.theme&&(n.color.theme=parseInt(l.theme,10),l.tint&&(n.color.tint=parseFloat(l.tint)),l.theme&&r.themeElements&&r.themeElements.clrScheme&&(n.color.rgb=Ud(r.themeElements.clrScheme[n.color.theme].rgb,n.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(s&&s.WTF&&!a)throw new Error("unrecognized "+l[0]+" in fonts")}})}function RL(e,t,r){t.NumberFmt=[];for(var s=Ut($e),n=0;n<s.length;++n)t.NumberFmt[s[n]]=$e[s[n]];var a=e[0].match(Rr);if(a)for(n=0;n<a.length;++n){var i=qe(a[n]);switch(hn(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=lt(xt(i.formatCode)),c=parseInt(i.numFmtId,10);if(t.NumberFmt[c]=l,c>0){if(c>392){for(c=392;c>60&&t.NumberFmt[c]!=null;--c);t.NumberFmt[c]=l}En(l,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}function IL(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var s=r[0];s<=r[1];++s)e[s]!=null&&(t[t.length]=je("numFmt",null,{numFmtId:s,formatCode:ht(e[s])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=je("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var ju=["numFmtId","fillId","fontId","borderId","xfId"],Tu=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function OL(e,t,r){t.CellXf=[];var s,n=!1;(e[0].match(Rr)||[]).forEach(function(a){var i=qe(a),l=0;switch(hn(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(s=i,delete s[0],l=0;l<ju.length;++l)s[ju[l]]&&(s[ju[l]]=parseInt(s[ju[l]],10));for(l=0;l<Tu.length;++l)s[Tu[l]]&&(s[Tu[l]]=wt(s[Tu[l]]));if(t.NumberFmt&&s.numFmtId>392){for(l=392;l>60;--l)if(t.NumberFmt[s.numFmtId]==t.NumberFmt[l]){s.numFmtId=l;break}}t.CellXf.push(s);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};i.vertical&&(c.vertical=i.vertical),i.horizontal&&(c.horizontal=i.horizontal),i.textRotation!=null&&(c.textRotation=i.textRotation),i.indent&&(c.indent=i.indent),i.wrapText&&(c.wrapText=wt(i.wrapText)),s.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":n=!0;break;case"</AlternateContent>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(r&&r.WTF&&!n)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}function DL(e){var t=[];return t[t.length]=je("cellXfs",null),e.forEach(function(r){t[t.length]=je("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=je("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var LL=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,s=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,n=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,c,u){var d={};if(!l)return d;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=l.match(t))&&RL(f,d,u),(f=l.match(n))&&PL(f,d,c,u),(f=l.match(s))&&FL(f,d,c,u),(f=l.match(a))&&AL(f,d,c,u),(f=l.match(r))&&OL(f,d,u),d}}();function hE(e,t){var r=[qt,je("styleSheet",null,{xmlns:hi[0],"xmlns:vt":rr.vt})],s;return e.SSF&&(s=IL(e.SSF))!=null&&(r[r.length]=s),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(s=DL(t.cellXfs))&&(r[r.length]=s),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function ML(e,t){var r=e.read_shift(2),s=Ar(e);return[r,s]}function BL(e,t,r){r||(r=le(6+4*t.length)),r.write_shift(2,e),cr(t,r);var s=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),s}function UL(e,t,r){var s={};s.sz=e.read_shift(2)/20;var n=bO(e);n.fItalic&&(s.italic=1),n.fCondense&&(s.condense=1),n.fExtend&&(s.extend=1),n.fShadow&&(s.shadow=1),n.fOutline&&(s.outline=1),n.fStrikeout&&(s.strike=1);var a=e.read_shift(2);switch(a===700&&(s.bold=1),e.read_shift(2)){case 1:s.vertAlign="superscript";break;case 2:s.vertAlign="subscript";break}var i=e.read_shift(1);i!=0&&(s.underline=i);var l=e.read_shift(1);l>0&&(s.family=l);var c=e.read_shift(1);switch(c>0&&(s.charset=c),e.l++,s.color=wO(e),e.read_shift(1)){case 1:s.scheme="major";break;case 2:s.scheme="minor";break}return s.name=Ar(e),s}function zL(e,t){t||(t=le(25+4*32)),t.write_shift(2,e.sz*20),_O(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Ld(e.color,t);var s=0;return s=2,t.write_shift(1,s),cr(e.name,t),t.length>t.l?t.slice(0,t.l):t}var $L=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Lf,VL=Pr;function pw(e,t){t||(t=le(4*3+8*7+16*1)),Lf||(Lf=g0($L));var r=Lf[e.patternType];r==null&&(r=40),t.write_shift(4,r);var s=0;if(r!=40)for(Ld({auto:1},t),Ld({auto:1},t);s<12;++s)t.write_shift(4,0);else{for(;s<4;++s)t.write_shift(4,0);for(;s<12;++s)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function WL(e,t){var r=e.l+t,s=e.read_shift(2),n=e.read_shift(2);return e.l=r,{ixfe:s,numFmtId:n}}function mE(e,t,r){r||(r=le(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var s=0;return r.write_shift(1,s),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Zo(e,t){return t||(t=le(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var qL=Pr;function HL(e,t){return t||(t=le(51)),t.write_shift(1,0),Zo(null,t),Zo(null,t),Zo(null,t),Zo(null,t),Zo(null,t),t.length>t.l?t.slice(0,t.l):t}function GL(e,t){return t||(t=le(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),Dd(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function KL(e,t,r){var s=le(2052);return s.write_shift(4,e),Dd(t,s),Dd(r,s),s.length>s.l?s.slice(0,s.l):s}function XL(e,t,r){var s={};s.NumberFmt=[];for(var n in $e)s.NumberFmt[n]=$e[n];s.CellXf=[],s.Fonts=[];var a=[],i=!1;return Ln(e,function(c,u,d){switch(d){case 44:s.NumberFmt[c[0]]=c[1],En(c[1],c[0]);break;case 43:s.Fonts.push(c),c.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(c.color.rgb=Ud(t.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&s.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:a.push(d),i=!0;break;case 38:a.pop(),i=!1;break;default:if(u.T>0)a.push(d);else if(u.T<0)a.pop();else if(!i||r.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),s}function QL(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var n=s[0];n<=s[1];++n)t[n]!=null&&++r}),r!=0&&(ye(e,615,Js(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var n=s[0];n<=s[1];++n)t[n]!=null&&ye(e,44,BL(n,t[n]))}),ye(e,616))}}function YL(e){var t=1;ye(e,611,Js(t)),ye(e,43,zL({sz:12,color:{theme:1},name:"Calibri",family:2})),ye(e,612)}function JL(e){var t=2;ye(e,603,Js(t)),ye(e,45,pw({patternType:"none"})),ye(e,45,pw({patternType:"gray125"})),ye(e,604)}function ZL(e){var t=1;ye(e,613,Js(t)),ye(e,46,HL()),ye(e,614)}function eM(e){var t=1;ye(e,626,Js(t)),ye(e,47,mE({numFmtId:0},65535)),ye(e,627)}function tM(e,t){ye(e,617,Js(t.length)),t.forEach(function(r){ye(e,47,mE(r,0))}),ye(e,618)}function rM(e){var t=1;ye(e,619,Js(t)),ye(e,48,GL({xfId:0,name:"Normal"})),ye(e,620)}function sM(e){var t=0;ye(e,505,Js(t)),ye(e,506)}function nM(e){var t=0;ye(e,508,KL(t,"TableStyleMedium9","PivotStyleMedium4")),ye(e,509)}function aM(e,t){var r=Jr();return ye(r,278),QL(r,e.SSF),YL(r),JL(r),ZL(r),eM(r),tM(r,t.cellXfs),rM(r),sM(r),nM(r),ye(r,279),r.end()}var iM=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function oM(e,t,r){t.themeElements.clrScheme=[];var s={};(e[0].match(Rr)||[]).forEach(function(n){var a=qe(n);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":s.rgb=a.val;break;case"<a:sysClr":s.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(t.themeElements.clrScheme[iM.indexOf(a[0])]=s,s={}):s.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function lM(){}function cM(){}var uM=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,dM=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,fM=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function hM(e,t,r){t.themeElements={};var s;[["clrScheme",uM,oM],["fontScheme",dM,lM],["fmtScheme",fM,cM]].forEach(function(n){if(!(s=e.match(n[1])))throw new Error(n[0]+" not found in themeElements");n[2](s,t,r)})}var mM=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function pE(e,t){(!e||e.length===0)&&(e=tg());var r,s={};if(!(r=e.match(mM)))throw new Error("themeElements not found in theme");return hM(r[0],s,t),s.raw=e,s}function tg(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[qt];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function pM(e,t,r){var s=e.l+t,n=e.read_shift(4);if(n!==124226){if(!r.cellStyles){e.l=s;return}var a=e.slice(e.l);e.l=s;var i;try{i=oN(a,{type:"array"})}catch{return}var l=ls(i,"theme/theme/theme1.xml",!0);if(l)return pE(l,r)}}function xM(e){return e.read_shift(4)}function gM(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=vM(e,4);break;case 2:t.xclrValue=KN(e);break;case 3:t.xclrValue=xM(e);break;case 4:e.l+=4;break}return e.l+=8,t}function vM(e,t){return Pr(e,t)}function yM(e,t){return Pr(e,t)}function wM(e){var t=e.read_shift(2),r=e.read_shift(2)-4,s=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:s[1]=gM(e);break;case 6:s[1]=yM(e,r);break;case 14:case 15:s[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return s}function bM(e,t){var r=e.l+t;e.l+=2;var s=e.read_shift(2);e.l+=2;for(var n=e.read_shift(2),a=[];n-- >0;)a.push(wM(e,r-e.l));return{ixfe:s,ext:a}}function _M(e,t){t.forEach(function(r){switch(r[0]){}})}function SM(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Ar(e)}}function kM(e){var t=le(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),cr(e.name,t),t.slice(0,t.l)}function NM(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function EM(e){var t=le(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function jM(e,t){var r=le(8+2*t.length);return r.write_shift(4,e),cr(t,r),r.slice(0,r.l)}function TM(e){return e.l+=4,e.read_shift(4)!=0}function CM(e,t){var r=le(8);return r.write_shift(4,e),r.write_shift(4,1),r}function AM(e,t,r){var s={Types:[],Cell:[],Value:[]},n=r||{},a=[],i=!1,l=2;return Ln(e,function(c,u,d){switch(d){case 335:s.Types.push({name:c.name});break;case 51:c.forEach(function(f){l==1?s.Cell.push({type:s.Types[f[0]-1].name,index:f[1]}):l==0&&s.Value.push({type:s.Types[f[0]-1].name,index:f[1]})});break;case 337:l=c?1:0;break;case 338:l=2;break;case 35:a.push(d),i=!0;break;case 36:a.pop(),i=!1;break;default:if(!u.T){if(!i||n.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),s}function FM(){var e=Jr();return ye(e,332),ye(e,334,Js(1)),ye(e,335,kM({name:"XLDAPR",version:12e4,flags:3496657072})),ye(e,336),ye(e,339,jM(1,"XLDAPR")),ye(e,52),ye(e,35,Js(514)),ye(e,4096,Js(0)),ye(e,4097,ks(1)),ye(e,36),ye(e,53),ye(e,340),ye(e,337,CM(1)),ye(e,51,EM([[1,0]])),ye(e,338),ye(e,333),e.end()}function PM(e,t,r){var s={Types:[],Cell:[],Value:[]};if(!e)return s;var n=!1,a=2,i;return e.replace(Rr,function(l){var c=qe(l);switch(hn(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":s.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<s.Types.length;++u)s.Types[u].name==c.name&&(i=s.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?s.Cell.push({type:s.Types[c.t-1].name,index:+c.v}):a==0&&s.Value.push({type:s.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+c.i);break;default:if(!n&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return l}),s}function xE(){var e=[qt];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function RM(e){var t=[];if(!e)return t;var r=1;return(e.match(Rr)||[]).forEach(function(s){var n=qe(s);switch(n[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete n[0],n.i?r=n.i:n.i=r,t.push(n);break}}),t}function IM(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Ve(r);var s=e.read_shift(1);return s&2&&(t.l="1"),s&8&&(t.a="1"),t}function OM(e,t,r){var s=[];return Ln(e,function(a,i,l){switch(l){case 63:s.push(a);break;default:if(!i.T)throw new Error("Unexpected record 0x"+l.toString(16))}}),s}function DM(e,t,r,s){if(!e)return e;var n=s||{},a=!1;Ln(e,function(l,c,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!c.T){if(!a||n.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},n)}function LM(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var Xi=1024;function gE(e,t){for(var r=[21600,21600],s=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),n=[je("xml",null,{"xmlns:v":ss.v,"xmlns:o":ss.o,"xmlns:x":ss.x,"xmlns:mv":ss.mv}).replace(/\/>/,">"),je("o:shapelayout",je("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),je("v:shapetype",[je("v:stroke",null,{joinstyle:"miter"}),je("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:s})];Xi<e*1e3;)Xi+=1e3;return t.forEach(function(a){var i=Rt(a[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var c=l.type=="gradient"?je("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=je("v:fill",c,l),d={on:"t",obscured:"t"};++Xi,n=n.concat(["<v:shape"+dc({id:"_x0000_s"+Xi,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(a[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,je("v:shadow",null,d),je("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",xr("x:Anchor",[i.c+1,0,i.r+1,0,i.c+3,20,i.r+5,20].join(",")),xr("x:AutoFill","False"),xr("x:Row",String(i.r)),xr("x:Column",String(i.c)),a[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),n.push("</xml>"),n.join("")}function xw(e,t,r,s){var n=Array.isArray(e),a;t.forEach(function(i){var l=Rt(i.ref);if(n?(e[l.r]||(e[l.r]=[]),a=e[l.r][l.c]):a=e[i.ref],!a){a={t:"z"},n?e[l.r][l.c]=a:e[i.ref]=a;var c=ct(e["!ref"]||"BDWGO1000001:A1");c.s.r>l.r&&(c.s.r=l.r),c.e.r<l.r&&(c.e.r=l.r),c.s.c>l.c&&(c.s.c=l.c),c.e.c<l.c&&(c.e.c=l.c);var u=Ke(c);u!==e["!ref"]&&(e["!ref"]=u)}a.c||(a.c=[]);var d={a:i.author,t:i.t,r:i.r,T:r};i.h&&(d.h=i.h);for(var f=a.c.length-1;f>=0;--f){if(!r&&a.c[f].T)return;r&&!a.c[f].T&&a.c.splice(f,1)}if(r&&s){for(f=0;f<s.length;++f)if(d.a==s[f].id){d.a=s[f].name||d.a;break}}a.c.push(d)})}function MM(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],s=[],n=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);n&&n[1]&&n[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var l=i.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&r.push(l[1])}});var a=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var l=i.match(/<(?:\w+:)?comment[^>]*>/);if(l){var c=qe(l[0]),u={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},d=Rt(c.ref);if(!(t.sheetRows&&t.sheetRows<=d.r)){var f=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!f&&!!f[1]&&Jx(f[1])||{r:"",t:"",h:""};u.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),u.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(u.h=h.h),s.push(u)}}}}),s}function vE(e){var t=[qt,je("comments",null,{xmlns:hi[0]})],r=[];return t.push("<authors>"),e.forEach(function(s){s[1].forEach(function(n){var a=ht(n.a);r.indexOf(a)==-1&&(r.push(a),t.push("<author>"+a+"</author>")),n.T&&n.ID&&r.indexOf("tc="+n.ID)==-1&&(r.push("tc="+n.ID),t.push("<author>tc="+n.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(s){var n=0,a=[];if(s[1][0]&&s[1][0].T&&s[1][0].ID?n=r.indexOf("tc="+s[1][0].ID):s[1].forEach(function(c){c.a&&(n=r.indexOf(ht(c.a))),a.push(c.t||"")}),t.push('<comment ref="'+s[0]+'" authorId="'+n+'"><text>'),a.length<=1)t.push(xr("t",ht(a[0]||"")));else{for(var i=`Comment:
    `+a[0]+`
`,l=1;l<a.length;++l)i+=`Reply:
    `+a[l]+`
`;t.push(xr("t",ht(i)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function BM(e,t){var r=[],s=!1,n={},a=0;return e.replace(Rr,function(l,c){var u=qe(l);switch(hn(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":n={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":n.t!=null&&r.push(n);break;case"<text>":case"<text":a=c+l.length;break;case"</text>":n.t=e.slice(a,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":s=!0;break;case"</mentions>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(!s&&t.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return l}),r}function UM(e,t,r){var s=[qt,je("ThreadedComments",null,{xmlns:rr.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(n){var a="";(n[1]||[]).forEach(function(i,l){if(!i.T){delete i.ID;return}i.a&&t.indexOf(i.a)==-1&&t.push(i.a);var c={ref:n[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};l==0?a=c.id:c.parentId=a,i.ID=c.id,i.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(i.a)).slice(-12)+"}"),s.push(je("threadedComment",xr("text",i.t||""),c))})}),s.push("</ThreadedComments>"),s.join("")}function zM(e,t){var r=[],s=!1;return e.replace(Rr,function(a){var i=qe(a);switch(hn(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(!s&&t.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return a}),r}function $M(e){var t=[qt,je("personList",null,{xmlns:rr.TCMNT,"xmlns:x":hi[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,s){t.push(je("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+s).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function VM(e){var t={};t.iauthor=e.read_shift(4);var r=gi(e);return t.rfx=r.s,t.ref=Ve(r.s),e.l+=16,t}function WM(e,t){return t==null&&(t=le(36)),t.write_shift(4,e[1].iauthor),Bo(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var qM=Ar;function HM(e){return cr(e.slice(0,54))}function GM(e,t){var r=[],s=[],n={},a=!1;return Ln(e,function(l,c,u){switch(u){case 632:s.push(l);break;case 635:n=l;break;case 637:n.t=l.t,n.h=l.h,n.r=l.r;break;case 636:if(n.author=s[n.iauthor],delete n.iauthor,t.sheetRows&&n.rfx&&t.sheetRows<=n.rfx.r)break;n.t||(n.t=""),delete n.rfx,r.push(n);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!a||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}function KM(e){var t=Jr(),r=[];return ye(t,628),ye(t,630),e.forEach(function(s){s[1].forEach(function(n){r.indexOf(n.a)>-1||(r.push(n.a.slice(0,54)),ye(t,632,HM(n.a)))})}),ye(t,631),ye(t,633),e.forEach(function(s){s[1].forEach(function(n){n.iauthor=r.indexOf(n.a);var a={s:Rt(s[0]),e:Rt(s[0])};ye(t,635,WM([a,n])),n.t&&n.t.length>0&&ye(t,637,xO(n)),ye(t,636),delete n.iauthor})}),ye(t,634),ye(t,629),t.end()}var XM="application/vnd.ms-office.vbaProject";function QM(e){var t=Me.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,s){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var n=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Me.utils.cfb_add(t,n,e.FileIndex[s].content)}}),Me.write(t)}function YM(e,t){t.FullPaths.forEach(function(r,s){if(s!=0){var n=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");n.slice(-1)!=="/"&&Me.utils.cfb_add(e,n,t.FileIndex[s].content)}})}var yE=["xlsb","xlsm","xlam","biff8","xla"];function JM(){return{"!type":"dialog"}}function ZM(){return{"!type":"dialog"}}function e9(){return{"!type":"macro"}}function t9(){return{"!type":"macro"}}var oo=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(s,n,a,i){var l=!1,c=!1;a.length==0?c=!0:a.charAt(0)=="["&&(c=!0,a=a.slice(1,-1)),i.length==0?l=!0:i.charAt(0)=="["&&(l=!0,i=i.slice(1,-1));var u=a.length>0?parseInt(a,10)|0:0,d=i.length>0?parseInt(i,10)|0:0;return l?d+=t.c:--d,c?u+=t.r:--u,n+(l?"":"$")+Pt(d)+(c?"":"$")+Wt(u)}return function(n,a){return t=a,n.replace(e,r)}}(),rg=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,sg=function(){return function(t,r){return t.replace(rg,function(s,n,a,i,l,c){var u=Vx(i)-(a?0:r.c),d=$x(c)-(l?0:r.r),f=d==0?"":l?d+1:"["+d+"]",h=u==0?"":a?u+1:"["+u+"]";return n+"R"+f+"C"+h})}}();function wE(e,t){return e.replace(rg,function(r,s,n,a,i,l){return s+(n=="$"?n+a:Pt(Vx(a)+t.c))+(i=="$"?i+l:Wt($x(l)+t.r))})}function r9(e,t,r){var s=Zr(t),n=s.s,a=Rt(r),i={r:a.r-n.r,c:a.c-n.c};return wE(e,i)}function s9(e){return e.length!=1}function gw(e){return e.replace(/_xlfn\./g,"")}function Gt(e){e.l+=1}function ha(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function bE(e,t,r){var s=2;if(r){if(r.biff>=2&&r.biff<=5)return _E(e);r.biff==12&&(s=4)}var n=e.read_shift(s),a=e.read_shift(s),i=ha(e),l=ha(e);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:l[0],cRel:l[1],rRel:l[2]}}}function _E(e){var t=ha(e),r=ha(e),s=e.read_shift(1),n=e.read_shift(1);return{s:{r:t[0],c:s,cRel:t[1],rRel:t[2]},e:{r:r[0],c:n,cRel:r[1],rRel:r[2]}}}function n9(e,t,r){if(r.biff<8)return _E(e);var s=e.read_shift(r.biff==12?4:2),n=e.read_shift(r.biff==12?4:2),a=ha(e),i=ha(e);return{s:{r:s,c:a[0],cRel:a[1],rRel:a[2]},e:{r:n,c:i[0],cRel:i[1],rRel:i[2]}}}function SE(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return a9(e);var s=e.read_shift(r&&r.biff==12?4:2),n=ha(e);return{r:s,c:n[0],cRel:n[1],rRel:n[2]}}function a9(e){var t=ha(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function i9(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function o9(e,t,r){var s=r&&r.biff?r.biff:8;if(s>=2&&s<=5)return l9(e);var n=e.read_shift(s>=12?4:2),a=e.read_shift(2),i=(a&16384)>>14,l=(a&32768)>>15;if(a&=16383,l==1)for(;n>524287;)n-=1048576;if(i==1)for(;a>8191;)a=a-16384;return{r:n,c:a,cRel:i,rRel:l}}function l9(e){var t=e.read_shift(2),r=e.read_shift(1),s=(t&32768)>>15,n=(t&16384)>>14;return t&=16383,s==1&&t>=8192&&(t=t-16384),n==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:n,rRel:s}}function c9(e,t,r){var s=(e[e.l++]&96)>>5,n=bE(e,r.biff>=2&&r.biff<=5?6:8,r);return[s,n]}function u9(e,t,r){var s=(e[e.l++]&96)>>5,n=e.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}var i=bE(e,a,r);return[s,n,i]}function d9(e,t,r){var s=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[s]}function f9(e,t,r){var s=(e[e.l++]&96)>>5,n=e.read_shift(2),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}return e.l+=a,[s,n]}function h9(e,t,r){var s=(e[e.l++]&96)>>5,n=n9(e,t-1,r);return[s,n]}function m9(e,t,r){var s=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[s]}function vw(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function p9(e,t,r){e.l+=2;for(var s=e.read_shift(r&&r.biff==2?1:2),n=[],a=0;a<=s;++a)n.push(e.read_shift(r&&r.biff==2?1:2));return n}function x9(e,t,r){var s=e[e.l+1]&255?1:0;return e.l+=2,[s,e.read_shift(r&&r.biff==2?1:2)]}function g9(e,t,r){var s=e[e.l+1]&255?1:0;return e.l+=2,[s,e.read_shift(r&&r.biff==2?1:2)]}function v9(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function y9(e,t,r){var s=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[s]}function kE(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function w9(e){return e.read_shift(2),kE(e)}function b9(e){return e.read_shift(2),kE(e)}function _9(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var n=SE(e,0,r);return[s,n]}function S9(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var n=o9(e,0,r);return[s,n]}function k9(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var a=SE(e,0,r);return[s,n,a]}function N9(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(r&&r.biff<=3?1:2);return[T7[n],jE[n],s]}function E9(e,t,r){var s=e[e.l++],n=e.read_shift(1),a=r&&r.biff<=3?[s==88?-1:0,e.read_shift(1)]:j9(e);return[n,(a[0]===0?jE:j7)[a[1]]]}function j9(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function T9(e,t,r){e.l+=r&&r.biff==2?3:4}function C9(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var s=e.read_shift(2),n=e.read_shift(r&&r.biff==2?1:2);return[s,n]}function A9(e){return e.l++,Mn[e.read_shift(1)]}function F9(e){return e.l++,e.read_shift(2)}function P9(e){return e.l++,e.read_shift(1)!==0}function R9(e){return e.l++,jr(e)}function I9(e,t,r){return e.l++,Oc(e,t-1,r)}function O9(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=zt(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Mn[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=jr(e);break;case 2:r[1]=vi(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function D9(e,t,r){for(var s=e.read_shift(r.biff==12?4:2),n=[],a=0;a!=s;++a)n.push((r.biff==12?gi:w0)(e));return n}function L9(e,t,r){var s=0,n=0;r.biff==12?(s=e.read_shift(4),n=e.read_shift(4)):(n=1+e.read_shift(1),s=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--s,--n==0&&(n=256));for(var a=0,i=[];a!=s&&(i[a]=[]);++a)for(var l=0;l!=n;++l)i[a][l]=O9(e,r.biff);return i}function M9(e,t,r){var s=e.read_shift(1)>>>5&3,n=!r||r.biff>=8?4:2,a=e.read_shift(n);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[s,0,a]}function B9(e,t,r){if(r.biff==5)return U9(e);var s=e.read_shift(1)>>>5&3,n=e.read_shift(2),a=e.read_shift(4);return[s,n,a]}function U9(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var s=e.read_shift(2);return e.l+=12,[t,r,s]}function z9(e,t,r){var s=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var n=e.read_shift(r&&r.biff==2?1:2);return[s,n]}function $9(e,t,r){var s=e.read_shift(1)>>>5&3,n=e.read_shift(r&&r.biff==2?1:2);return[s,n]}function V9(e,t,r){var s=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[s]}function W9(e,t,r){var s=(e[e.l++]&96)>>5,n=e.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return e.l+=a,[s,n]}var q9=Pr,H9=Pr,G9=Pr;function Lc(e,t,r){return e.l+=2,[i9(e)]}function ng(e){return e.l+=6,[]}var K9=Lc,X9=ng,Q9=ng,Y9=Lc;function NE(e){return e.l+=2,[Xt(e),e.read_shift(2)&1]}var J9=Lc,Z9=NE,e7=ng,t7=Lc,r7=Lc,s7=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function n7(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(4),n=e.read_shift(2),a=e.read_shift(2),i=s7[r>>2&31];return{ixti:t,coltype:r&3,rt:i,idx:s,c:n,C:a}}function a7(e){return e.l+=2,[e.read_shift(4)]}function i7(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function o7(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function l7(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function c7(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function u7(e){return e.l+=4,[0,0]}var yw={1:{n:"PtgExp",f:C9},2:{n:"PtgTbl",f:G9},3:{n:"PtgAdd",f:Gt},4:{n:"PtgSub",f:Gt},5:{n:"PtgMul",f:Gt},6:{n:"PtgDiv",f:Gt},7:{n:"PtgPower",f:Gt},8:{n:"PtgConcat",f:Gt},9:{n:"PtgLt",f:Gt},10:{n:"PtgLe",f:Gt},11:{n:"PtgEq",f:Gt},12:{n:"PtgGe",f:Gt},13:{n:"PtgGt",f:Gt},14:{n:"PtgNe",f:Gt},15:{n:"PtgIsect",f:Gt},16:{n:"PtgUnion",f:Gt},17:{n:"PtgRange",f:Gt},18:{n:"PtgUplus",f:Gt},19:{n:"PtgUminus",f:Gt},20:{n:"PtgPercent",f:Gt},21:{n:"PtgParen",f:Gt},22:{n:"PtgMissArg",f:Gt},23:{n:"PtgStr",f:I9},26:{n:"PtgSheet",f:i7},27:{n:"PtgEndSheet",f:o7},28:{n:"PtgErr",f:A9},29:{n:"PtgBool",f:P9},30:{n:"PtgInt",f:F9},31:{n:"PtgNum",f:R9},32:{n:"PtgArray",f:m9},33:{n:"PtgFunc",f:N9},34:{n:"PtgFuncVar",f:E9},35:{n:"PtgName",f:M9},36:{n:"PtgRef",f:_9},37:{n:"PtgArea",f:c9},38:{n:"PtgMemArea",f:z9},39:{n:"PtgMemErr",f:q9},40:{n:"PtgMemNoMem",f:H9},41:{n:"PtgMemFunc",f:$9},42:{n:"PtgRefErr",f:V9},43:{n:"PtgAreaErr",f:d9},44:{n:"PtgRefN",f:S9},45:{n:"PtgAreaN",f:h9},46:{n:"PtgMemAreaN",f:l7},47:{n:"PtgMemNoMemN",f:c7},57:{n:"PtgNameX",f:B9},58:{n:"PtgRef3d",f:k9},59:{n:"PtgArea3d",f:u9},60:{n:"PtgRefErr3d",f:W9},61:{n:"PtgAreaErr3d",f:f9},255:{}},d7={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},f7={1:{n:"PtgElfLel",f:NE},2:{n:"PtgElfRw",f:t7},3:{n:"PtgElfCol",f:K9},6:{n:"PtgElfRwV",f:r7},7:{n:"PtgElfColV",f:Y9},10:{n:"PtgElfRadical",f:J9},11:{n:"PtgElfRadicalS",f:e7},13:{n:"PtgElfColS",f:X9},15:{n:"PtgElfColSV",f:Q9},16:{n:"PtgElfRadicalLel",f:Z9},25:{n:"PtgList",f:n7},29:{n:"PtgSxName",f:a7},255:{}},h7={0:{n:"PtgAttrNoop",f:u7},1:{n:"PtgAttrSemi",f:y9},2:{n:"PtgAttrIf",f:g9},4:{n:"PtgAttrChoose",f:p9},8:{n:"PtgAttrGoto",f:x9},16:{n:"PtgAttrSum",f:T9},32:{n:"PtgAttrBaxcel",f:vw},33:{n:"PtgAttrBaxcel",f:vw},64:{n:"PtgAttrSpace",f:w9},65:{n:"PtgAttrSpaceSemi",f:b9},128:{n:"PtgAttrIfError",f:v9},255:{}};function Mc(e,t,r,s){if(s.biff<8)return Pr(e,t);for(var n=e.l+t,a=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=L9(e,0,s),a.push(r[i][1]);break;case"PtgMemArea":r[i][2]=D9(e,r[i][1],s),a.push(r[i][2]);break;case"PtgExp":s&&s.biff==12&&(r[i][1][1]=e.read_shift(4),a.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return t=n-e.l,t!==0&&a.push(Pr(e,t)),a}function Bc(e,t,r){for(var s=e.l+t,n,a,i=[];s!=e.l;)t=s-e.l,a=e[e.l],n=yw[a]||yw[d7[a]],(a===24||a===25)&&(n=(a===24?f7:h7)[e[e.l+1]]),!n||!n.f?Pr(e,t):i.push([n.n,n.f(e,t,r)]);return i}function m7(e){for(var t=[],r=0;r<e.length;++r){for(var s=e[r],n=[],a=0;a<s.length;++a){var i=s[a];if(i)switch(i[0]){case 2:n.push('"'+i[1].replace(/"/g,'""')+'"');break;default:n.push(i[1])}else n.push("")}t.push(n.join(","))}return t.join(";")}var p7={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function x7(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function EE(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var s=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!s)return"SH33TJSERR1";var n="";if(r.biff>8)switch(e[s[0]][0]){case 357:return n=s[1]==-1?"#REF":e.SheetNames[s[1]],s[1]==s[2]?n:n+":"+e.SheetNames[s[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[s[0]][0];case 355:default:return"SH33TJSSRC"+e[s[0]][0]}switch(e[s[0]][0][0]){case 1025:return n=s[1]==-1?"#REF":e.SheetNames[s[1]]||"SH33TJSERR3",s[1]==s[2]?n:n+":"+e.SheetNames[s[2]];case 14849:return e[s[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return e[s[0]][0][3]?(n=s[1]==-1?"#REF":e[s[0]][0][3][s[1]]||"SH33TJSERR4",s[1]==s[2]?n:n+":"+e[s[0]][0][3][s[2]]):"SH33TJSERR2"}}function ww(e,t,r){var s=EE(e,t,r);return s=="#REF"?s:x7(s,r)}function kr(e,t,r,s,n){var a=n&&n.biff||8,i={s:{c:0,r:0}},l=[],c,u,d,f=0,h=0,m,x="";if(!e[0]||!e[0][0])return"";for(var p=-1,g="",w=0,v=e[0].length;w<v;++w){var y=e[0][w];switch(y[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=l.pop(),u=l.pop(),p>=0){switch(e[0][p][1][0]){case 0:g=Mt(" ",e[0][p][1][1]);break;case 1:g=Mt("\r",e[0][p][1][1]);break;default:if(g="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}u=u+g,p=-1}l.push(u+p7[y[0]]+c);break;case"PtgIsect":c=l.pop(),u=l.pop(),l.push(u+" "+c);break;case"PtgUnion":c=l.pop(),u=l.pop(),l.push(u+","+c);break;case"PtgRange":c=l.pop(),u=l.pop(),l.push(u+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=El(y[1][1],i,n),l.push(jl(d,a));break;case"PtgRefN":d=r?El(y[1][1],r,n):y[1][1],l.push(jl(d,a));break;case"PtgRef3d":f=y[1][1],d=El(y[1][2],i,n),x=ww(s,f,n),l.push(x+"!"+jl(d,a));break;case"PtgFunc":case"PtgFuncVar":var b=y[1][0],S=y[1][1];b||(b=0),b&=127;var k=b==0?[]:l.slice(-b);l.length-=b,S==="User"&&(S=k.shift()),l.push(S+"("+k.join(",")+")");break;case"PtgBool":l.push(y[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(y[1]);break;case"PtgNum":l.push(String(y[1]));break;case"PtgStr":l.push('"'+y[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(y[1]);break;case"PtgAreaN":m=X1(y[1][1],r?{s:r}:i,n),l.push(Rf(m,n));break;case"PtgArea":m=X1(y[1][1],i,n),l.push(Rf(m,n));break;case"PtgArea3d":f=y[1][1],m=y[1][2],x=ww(s,f,n),l.push(x+"!"+Rf(m,n));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=y[1][2];var _=(s.names||[])[h-1]||(s[0]||[])[h],N=_?_.Name:"SH33TJSNAME"+String(h);N&&N.slice(0,6)=="_xlfn."&&!n.xlfn&&(N=N.slice(6)),l.push(N);break;case"PtgNameX":var C=y[1][1];h=y[1][2];var B;if(n.biff<=5)C<0&&(C=-C),s[C]&&(B=s[C][h]);else{var H="";if(((s[C]||[])[0]||[])[0]==14849||(((s[C]||[])[0]||[])[0]==1025?s[C][h]&&s[C][h].itab>0&&(H=s.SheetNames[s[C][h].itab-1]+"!"):H=s.SheetNames[h-1]+"!"),s[C]&&s[C][h])H+=s[C][h].Name;else if(s[0]&&s[0][h])H+=s[0][h].Name;else{var V=(EE(s,C,n)||"").split(";;");V[h-1]?H=V[h-1]:H+="SH33TJSERRX"}l.push(H);break}B||(B={Name:"SH33TJSERRY"}),l.push(B.Name);break;case"PtgParen":var K="(",Y=")";if(p>=0){switch(g="",e[0][p][1][0]){case 2:K=Mt(" ",e[0][p][1][1])+K;break;case 3:K=Mt("\r",e[0][p][1][1])+K;break;case 4:Y=Mt(" ",e[0][p][1][1])+Y;break;case 5:Y=Mt("\r",e[0][p][1][1])+Y;break;default:if(n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}p=-1}l.push(K+l.pop()+Y);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":d={c:y[1][1],r:y[1][0]};var q={c:r.c,r:r.r};if(s.sharedf[Ve(d)]){var X=s.sharedf[Ve(d)];l.push(kr(X,i,q,s,n))}else{var ie=!1;for(c=0;c!=s.arrayf.length;++c)if(u=s.arrayf[c],!(d.c<u[0].s.c||d.c>u[0].e.c)&&!(d.r<u[0].s.r||d.r>u[0].e.r)){l.push(kr(u[1],i,q,s,n)),ie=!0;break}ie||l.push(y[1])}break;case"PtgArray":l.push("{"+m7(y[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=w;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+y[1].idx+"[#"+y[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(y));default:throw new Error("Unrecognized Formula Token: "+String(y))}var W=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(n.biff!=3&&p>=0&&W.indexOf(e[0][w][0])==-1){y=e[0][p];var U=!0;switch(y[1][0]){case 4:U=!1;case 0:g=Mt(" ",y[1][1]);break;case 5:U=!1;case 1:g=Mt("\r",y[1][1]);break;default:if(g="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+y[1][0])}l.push((U?g:"")+l.pop()+(U?"":g)),p=-1}}if(l.length>1&&n.WTF)throw new Error("bad formula stack");return l[0]}function g7(e,t,r){var s=e.l+t,n=r.biff==2?1:2,a,i=e.read_shift(n);if(i==65535)return[[],Pr(e,t-2)];var l=Bc(e,i,r);return t!==i+n&&(a=Mc(e,t-i-n,l,r)),e.l=s,[l,a]}function v7(e,t,r){var s=e.l+t,n=r.biff==2?1:2,a,i=e.read_shift(n);if(i==65535)return[[],Pr(e,t-2)];var l=Bc(e,i,r);return t!==i+n&&(a=Mc(e,t-i-n,l,r)),e.l=s,[l,a]}function y7(e,t,r,s){var n=e.l+t,a=Bc(e,s,r),i;return n!==e.l&&(i=Mc(e,n-e.l,a,r)),[a,i]}function w7(e,t,r){var s=e.l+t,n,a=e.read_shift(2),i=Bc(e,a,r);return a==65535?[[],Pr(e,t-2)]:(t!==a+2&&(n=Mc(e,s-a-2,i,r)),[i,n])}function b7(e){var t;if(Sn(e,e.l+6)!==65535)return[jr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function _7(e){if(e==null){var t=le(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return ii(e);return ii(0)}function Mf(e,t,r){var s=e.l+t,n=mn(e);r.biff==2&&++e.l;var a=b7(e),i=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var l=v7(e,s-e.l,r);return{cell:n,val:a[0],formula:l,shared:i>>3&1,tt:a[1]}}function S7(e,t,r,s,n){var a=li(t,r,n),i=_7(e.v),l=le(6),c=33;l.write_shift(2,c),l.write_shift(4,0);for(var u=le(e.bf.length),d=0;d<e.bf.length;++d)u[d]=e.bf[d];var f=lr([a,i,l,u]);return f}function b0(e,t,r){var s=e.read_shift(4),n=Bc(e,s,r),a=e.read_shift(4),i=a>0?Mc(e,a,n,r):null;return[n,i]}var k7=b0,_0=b0,N7=b0,E7=b0,j7={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},jE={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},T7={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function bw(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function C7(e){var t="of:="+e.replace(rg,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Bf(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function A7(e){return e.replace(/\./,"!")}var Cl={},lo={},Al=typeof Map<"u";function ag(e,t,r){var s=0,n=e.length;if(r){if(Al?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var a=Al?r.get(t):r[t];s<a.length;++s)if(e[a[s]].t===t)return e.Count++,a[s]}}else for(;s<n;++s)if(e[s].t===t)return e.Count++,s;return e[n]={t},e.Count++,e.Unique++,r&&(Al?(r.has(t)||r.set(t,[]),r.get(t).push(n)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(n))),n}function S0(e,t){var r={min:e+1,max:e+1},s=-1;return t.MDW&&(Er=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?s=xc(t.wpx):t.wch!=null&&(s=t.wch),s>-1?(r.width=zd(s),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function Qa(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Sa(e,t,r){var s=r.revssf[t.z!=null?t.z:"General"],n=60,a=e.length;if(s==null&&r.ssf){for(;n<392;++n)if(r.ssf[n]==null){En(t.z,n),r.ssf[n]=t.z,r.revssf[t.z]=s=n;break}}for(n=0;n!=a;++n)if(e[n].numFmtId===s)return n;return e[a]={numFmtId:s,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},a}function TE(e,t,r,s,n,a){try{s.cellNF&&(e.z=$e[t])}catch(l){if(s.WTF)throw l}if(!(e.t==="z"&&!s.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=_t(e.v)),(!s||s.cellText!==!1)&&e.t!=="z")try{if($e[t]==null&&En(jI[t]||"General",t),e.t==="e")e.w=e.w||Mn[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=cc(e.v);else if(e.t==="d"){var i=nr(e.v);(i|0)===i?e.w=i.toString(10):e.w=cc(i)}else{if(e.v===void 0)return"";e.w=ni(e.v,lo)}else e.t==="d"?e.w=Os(t,nr(e.v),lo):e.w=Os(t,e.v,lo)}catch(l){if(s.WTF)throw l}if(s.cellStyles&&r!=null)try{e.s=a.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Ud(n.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),s.WTF&&(e.s.fgColor.raw_rgb=n.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Ud(n.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),s.WTF&&(e.s.bgColor.raw_rgb=n.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(l){if(s.WTF&&a.Fills)throw l}}}function F7(e,t,r){if(e&&e["!ref"]){var s=ct(e["!ref"]);if(s.e.c<s.s.c||s.e.r<s.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function P7(e,t){var r=ct(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Ke(r))}var R7=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,I7=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,O7=/<(?:\w:)?hyperlink [^>]*>/mg,D7=/"(\w*:\w*)"/,L7=/<(?:\w:)?col\b[^>]*[\/]?>/g,M7=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,B7=/<(?:\w:)?pageMargins[^>]*\/>/g,CE=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,U7=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,z7=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function $7(e,t,r,s,n,a,i){if(!e)return e;s||(s={"!id":{}});var l=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",d="",f=e.match(I7);f?(u=e.slice(0,f.index),d=e.slice(f.index+f[0].length)):u=d=e;var h=u.match(CE);h?ig(h[0],l,n,r):(h=u.match(U7))&&W7(h[0],h[1]||"",l,n,r);var m=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(m>0){var x=u.slice(m,m+50).match(D7);x&&P7(l,x[1])}var p=u.match(z7);p&&p[1]&&sB(p[1],n);var g=[];if(t.cellStyles){var w=u.match(L7);w&&J7(g,w)}f&&iB(f[1],l,t,c,a,i);var v=d.match(M7);v&&(l["!autofilter"]=eB(v[0]));var y=[],b=d.match(R7);if(b)for(m=0;m!=b.length;++m)y[m]=ct(b[m].slice(b[m].indexOf('"')+1));var S=d.match(O7);S&&X7(l,S,s);var k=d.match(B7);if(k&&(l["!margins"]=Q7(qe(k[0]))),!l["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(l["!ref"]=Ke(c)),t.sheetRows>0&&l["!ref"]){var _=ct(l["!ref"]);t.sheetRows<=+_.e.r&&(_.e.r=t.sheetRows-1,_.e.r>c.e.r&&(_.e.r=c.e.r),_.e.r<_.s.r&&(_.s.r=_.e.r),_.e.c>c.e.c&&(_.e.c=c.e.c),_.e.c<_.s.c&&(_.s.c=_.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Ke(_))}return g.length>0&&(l["!cols"]=g),y.length>0&&(l["!merges"]=y),l}function V7(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Ke(e[r])+'"/>';return t+"</mergeCells>"}function ig(e,t,r,s){var n=qe(e);r.Sheets[s]||(r.Sheets[s]={}),n.codeName&&(r.Sheets[s].CodeName=lt(xt(n.codeName)))}function W7(e,t,r,s,n){ig(e.slice(0,e.indexOf(">")),r,s,n)}function q7(e,t,r,s,n){var a=!1,i={},l=null;if(s.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}a=!0,i.codeName=ln(ht(c))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),l=(l||"")+je("outlinePr",null,u)}!a&&!l||(n[n.length]=je("sheetPr",l,i))}var H7=["objects","scenarios","selectLockedCells","selectUnlockedCells"],G7=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function K7(e){var t={sheet:1};return H7.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),G7.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=Zx(e.password).toString(16).toUpperCase()),je("sheetProtection",null,t)}function X7(e,t,r){for(var s=Array.isArray(e),n=0;n!=t.length;++n){var a=qe(xt(t[n]),!0);if(!a.ref)return;var i=((r||{})["!id"]||[])[a.id];i?(a.Target=i.Target,a.location&&(a.Target+="#"+lt(a.location))):(a.Target="#"+lt(a.location),i={Target:a.Target,TargetMode:"Internal"}),a.Rel=i,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var l=ct(a.ref),c=l.s.r;c<=l.e.r;++c)for(var u=l.s.c;u<=l.e.c;++u){var d=Ve({c:u,r:c});s?(e[c]||(e[c]=[]),e[c][u]||(e[c][u]={t:"z",v:void 0}),e[c][u].l=a):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=a)}}}function Q7(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function Y7(e){return Qa(e),je("pageMargins",null,e)}function J7(e,t){for(var r=!1,s=0;s!=t.length;++s){var n=qe(t[s],!0);n.hidden&&(n.hidden=wt(n.hidden));var a=parseInt(n.min,10)-1,i=parseInt(n.max,10)-1;for(n.outlineLevel&&(n.level=+n.outlineLevel||0),delete n.min,delete n.max,n.width=+n.width,!r&&n.width&&(r=!0,eg(n.width)),fa(n);a<=i;)e[a++]=St(n)}}function Z7(e,t){for(var r=["<cols>"],s,n=0;n!=t.length;++n)(s=t[n])&&(r[r.length]=je("col",null,S0(n,s)));return r[r.length]="</cols>",r.join("")}function eB(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function tB(e,t,r,s){var n=typeof e.ref=="string"?e.ref:Ke(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,i=Zr(n);i.s.r==i.e.r&&(i.e.r=Zr(t["!ref"]).e.r,n=Ke(i));for(var l=0;l<a.length;++l){var c=a[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==s){c.Ref="'"+r.SheetNames[s]+"'!"+n;break}}return l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:s,Ref:"'"+r.SheetNames[s]+"'!"+n}),je("autoFilter",null,{ref:n})}var rB=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function sB(e,t){t.Views||(t.Views=[{}]),(e.match(rB)||[]).forEach(function(r,s){var n=qe(r);t.Views[s]||(t.Views[s]={}),+n.zoomScale&&(t.Views[s].zoom=+n.zoomScale),wt(n.rightToLeft)&&(t.Views[s].RTL=!0)})}function nB(e,t,r,s){var n={workbookViewId:"0"};return(((s||{}).Workbook||{}).Views||[])[0]&&(n.rightToLeft=s.Workbook.Views[0].RTL?"1":"0"),je("sheetViews",je("sheetView",null,n),{})}function aB(e,t,r,s){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var n="",a=e.t,i=e.v;if(e.t!=="z")switch(e.t){case"b":n=e.v?"1":"0";break;case"n":n=""+e.v;break;case"e":n=Mn[e.v];break;case"d":s&&s.cellDates?n=_t(e.v,-1).toISOString():(e=St(e),e.t="n",n=""+(e.v=nr(_t(e.v)))),typeof e.z>"u"&&(e.z=$e[14]);break;default:n=e.v;break}var l=xr("v",ht(n)),c={r:t},u=Sa(s.cellXfs,e,s);switch(u!==0&&(c.s=u),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(s&&s.bookSST){l=xr("v",""+ag(s.Strings,e.v,s.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=a&&(e.t=a,e.v=i),typeof e.f=="string"&&e.f){var d=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;l=je("f",ht(e.f),d)+(e.v!=null?l:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),je("c",l,c)}var iB=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,s=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,n=/ref=["']([^"']*)["']/,a=uc("v"),i=uc("f");return function(c,u,d,f,h,m){for(var x=0,p="",g=[],w=[],v=0,y=0,b=0,S="",k,_,N=0,C=0,B,H,V=0,K=0,Y=Array.isArray(m.CellXf),q,X=[],ie=[],W=Array.isArray(u),U=[],he={},be=!1,R=!!d.sheetStubs,M=c.split(t),O=0,z=M.length;O!=z;++O){p=M[O].trim();var J=p.length;if(J!==0){var pe=0;e:for(x=0;x<J;++x)switch(p[x]){case">":if(p[x-1]!="/"){++x;break e}if(d&&d.cellStyles){if(_=qe(p.slice(pe,x),!0),N=_.r!=null?parseInt(_.r,10):N+1,C=-1,d.sheetRows&&d.sheetRows<N)continue;he={},be=!1,_.ht&&(be=!0,he.hpt=parseFloat(_.ht),he.hpx=No(he.hpt)),_.hidden=="1"&&(be=!0,he.hidden=!0),_.outlineLevel!=null&&(be=!0,he.level=+_.outlineLevel),be&&(U[N-1]=he)}break;case"<":pe=x;break}if(pe>=x)break;if(_=qe(p.slice(pe,x),!0),N=_.r!=null?parseInt(_.r,10):N+1,C=-1,!(d.sheetRows&&d.sheetRows<N)){f.s.r>N-1&&(f.s.r=N-1),f.e.r<N-1&&(f.e.r=N-1),d&&d.cellStyles&&(he={},be=!1,_.ht&&(be=!0,he.hpt=parseFloat(_.ht),he.hpx=No(he.hpt)),_.hidden=="1"&&(be=!0,he.hidden=!0),_.outlineLevel!=null&&(be=!0,he.level=+_.outlineLevel),be&&(U[N-1]=he)),g=p.slice(x).split(e);for(var ge=0;ge!=g.length&&g[ge].trim().charAt(0)=="<";++ge);for(g=g.slice(ge),x=0;x!=g.length;++x)if(p=g[x].trim(),p.length!==0){if(w=p.match(r),v=x,y=0,b=0,p="<c "+(p.slice(0,1)=="<"?">":"")+p,w!=null&&w.length===2){for(v=0,S=w[1],y=0;y!=S.length&&!((b=S.charCodeAt(y)-64)<1||b>26);++y)v=26*v+b;--v,C=v}else++C;for(y=0;y!=p.length&&p.charCodeAt(y)!==62;++y);if(++y,_=qe(p.slice(0,y),!0),_.r||(_.r=Ve({r:N-1,c:C})),S=p.slice(y),k={t:""},(w=S.match(a))!=null&&w[1]!==""&&(k.v=lt(w[1])),d.cellFormula){if((w=S.match(i))!=null&&w[1]!==""){if(k.f=lt(xt(w[1])).replace(/\r\n/g,`
`),d.xlfn||(k.f=gw(k.f)),w[0].indexOf('t="array"')>-1)k.F=(S.match(n)||[])[1],k.F.indexOf(":")>-1&&X.push([ct(k.F),k.F]);else if(w[0].indexOf('t="shared"')>-1){H=qe(w[0]);var ne=lt(xt(w[1]));d.xlfn||(ne=gw(ne)),ie[parseInt(H.si,10)]=[H,ne,_.r]}}else(w=S.match(/<f[^>]*\/>/))&&(H=qe(w[0]),ie[H.si]&&(k.f=r9(ie[H.si][1],ie[H.si][2],_.r)));var ae=Rt(_.r);for(y=0;y<X.length;++y)ae.r>=X[y][0].s.r&&ae.r<=X[y][0].e.r&&ae.c>=X[y][0].s.c&&ae.c<=X[y][0].e.c&&(k.F=X[y][1])}if(_.t==null&&k.v===void 0)if(k.f||k.F)k.v=0,k.t="n";else if(R)k.t="z";else continue;else k.t=_.t||"n";switch(f.s.c>C&&(f.s.c=C),f.e.c<C&&(f.e.c=C),k.t){case"n":if(k.v==""||k.v==null){if(!R)continue;k.t="z"}else k.v=parseFloat(k.v);break;case"s":if(typeof k.v>"u"){if(!R)continue;k.t="z"}else B=Cl[parseInt(k.v,10)],k.v=B.t,k.r=B.r,d.cellHTML&&(k.h=B.h);break;case"str":k.t="s",k.v=k.v!=null?xt(k.v):"",d.cellHTML&&(k.h=Mx(k.v));break;case"inlineStr":w=S.match(s),k.t="s",w!=null&&(B=Jx(w[1]))?(k.v=B.t,d.cellHTML&&(k.h=B.h)):k.v="";break;case"b":k.v=wt(k.v);break;case"d":d.cellDates?k.v=_t(k.v,1):(k.v=nr(_t(k.v,1)),k.t="n");break;case"e":(!d||d.cellText!==!1)&&(k.w=k.v),k.v=FN[k.v];break}if(V=K=0,q=null,Y&&_.s!==void 0&&(q=m.CellXf[_.s],q!=null&&(q.numFmtId!=null&&(V=q.numFmtId),d.cellStyles&&q.fillId!=null&&(K=q.fillId))),TE(k,V,K,d,h,m),d.cellDates&&Y&&k.t=="n"&&Do($e[V])&&(k.t="d",k.v=y0(k.v)),_.cm&&d.xlmeta){var Ce=(d.xlmeta.Cell||[])[+_.cm-1];Ce&&Ce.type=="XLDAPR"&&(k.D=!0)}if(W){var P=Rt(_.r);u[P.r]||(u[P.r]=[]),u[P.r][P.c]=k}else u[_.r]=k}}}}U.length>0&&(u["!rows"]=U)}}();function oB(e,t,r,s){var n=[],a=[],i=ct(e["!ref"]),l="",c,u="",d=[],f=0,h=0,m=e["!rows"],x=Array.isArray(e),p={r:u},g,w=-1;for(h=i.s.c;h<=i.e.c;++h)d[h]=Pt(h);for(f=i.s.r;f<=i.e.r;++f){for(a=[],u=Wt(f),h=i.s.c;h<=i.e.c;++h){c=d[h]+u;var v=x?(e[f]||[])[h]:e[c];v!==void 0&&(l=aB(v,c,e,t))!=null&&a.push(l)}(a.length>0||m&&m[f])&&(p={r:u},m&&m[f]&&(g=m[f],g.hidden&&(p.hidden=1),w=-1,g.hpx?w=gc(g.hpx):g.hpt&&(w=g.hpt),w>-1&&(p.ht=w,p.customHeight=1),g.level&&(p.outlineLevel=g.level)),n[n.length]=je("row",a.join(""),p))}if(m)for(;f<m.length;++f)m&&m[f]&&(p={r:f+1},g=m[f],g.hidden&&(p.hidden=1),w=-1,g.hpx?w=gc(g.hpx):g.hpt&&(w=g.hpt),w>-1&&(p.ht=w,p.customHeight=1),g.level&&(p.outlineLevel=g.level),n[n.length]=je("row","",p));return n.join("")}function AE(e,t,r,s){var n=[qt,je("worksheet",null,{xmlns:hi[0],"xmlns:r":rr.r})],a=r.SheetNames[e],i=0,l="",c=r.Sheets[a];c==null&&(c={});var u=c["!ref"]||"A1",d=ct(u);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),u=Ke(d)}s||(s={}),c["!comments"]=[];var f=[];q7(c,r,e,t,n),n[n.length]=je("dimension",null,{ref:u}),n[n.length]=nB(c,t,e,r),t.sheetFormat&&(n[n.length]=je("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(n[n.length]=Z7(c,c["!cols"])),n[i=n.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(l=oB(c,t),l.length>0&&(n[n.length]=l)),n.length>i+1&&(n[n.length]="</sheetData>",n[i]=n[i].replace("/>",">")),c["!protect"]&&(n[n.length]=K7(c["!protect"])),c["!autofilter"]!=null&&(n[n.length]=tB(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(n[n.length]=V7(c["!merges"]));var h=-1,m,x=-1;return c["!links"].length>0&&(n[n.length]="<hyperlinks>",c["!links"].forEach(function(p){p[1].Target&&(m={ref:p[0]},p[1].Target.charAt(0)!="#"&&(x=ft(s,-1,ht(p[1].Target).replace(/#.*$/,""),rt.HLINK),m["r:id"]="rId"+x),(h=p[1].Target.indexOf("#"))>-1&&(m.location=ht(p[1].Target.slice(h+1))),p[1].Tooltip&&(m.tooltip=ht(p[1].Tooltip)),n[n.length]=je("hyperlink",null,m))}),n[n.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(n[n.length]=Y7(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(n[n.length]=xr("ignoredErrors",je("ignoredError",null,{numberStoredAsText:1,sqref:u}))),f.length>0&&(x=ft(s,-1,"../drawings/drawing"+(e+1)+".xml",rt.DRAW),n[n.length]=je("drawing",null,{"r:id":"rId"+x}),c["!drawing"]=f),c["!comments"].length>0&&(x=ft(s,-1,"../drawings/vmlDrawing"+(e+1)+".vml",rt.VML),n[n.length]=je("legacyDrawing",null,{"r:id":"rId"+x}),c["!legacy"]=x),n.length>1&&(n[n.length]="</worksheet>",n[1]=n[1].replace("/>",">")),n.join("")}function lB(e,t){var r={},s=e.l+t;r.r=e.read_shift(4),e.l+=4;var n=e.read_shift(2);e.l+=1;var a=e.read_shift(1);return e.l=s,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=n/20),r}function cB(e,t,r){var s=le(145),n=(r["!rows"]||[])[e]||{};s.write_shift(4,e),s.write_shift(4,0);var a=320;n.hpx?a=gc(n.hpx)*20:n.hpt&&(a=n.hpt*20),s.write_shift(2,a),s.write_shift(1,0);var i=0;n.level&&(i|=n.level),n.hidden&&(i|=16),(n.hpx||n.hpt)&&(i|=32),s.write_shift(1,i),s.write_shift(1,0);var l=0,c=s.l;s.l+=4;for(var u={r:e,c:0},d=0;d<16;++d)if(!(t.s.c>d+1<<10||t.e.c<d<<10)){for(var f=-1,h=-1,m=d<<10;m<d+1<<10;++m){u.c=m;var x=Array.isArray(r)?(r[u.r]||[])[u.c]:r[Ve(u)];x&&(f<0&&(f=m),h=m)}f<0||(++l,s.write_shift(4,f),s.write_shift(4,h))}var p=s.l;return s.l=c,s.write_shift(4,l),s.l=p,s.length>s.l?s.slice(0,s.l):s}function uB(e,t,r,s){var n=cB(s,r,t);(n.length>17||(t["!rows"]||[])[s])&&ye(e,0,n)}var dB=gi,fB=Bo;function hB(){}function mB(e,t){var r={},s=e[e.l];return++e.l,r.above=!(s&64),r.left=!(s&128),e.l+=18,r.name=gO(e),r}function pB(e,t,r){r==null&&(r=le(84+4*e.length));var s=192;t&&(t.above&&(s&=-65),t.left&&(s&=-129)),r.write_shift(1,s);for(var n=1;n<3;++n)r.write_shift(1,0);return Ld({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),EN(e,r),r.slice(0,r.l)}function xB(e){var t=Ds(e);return[t]}function gB(e,t,r){return r==null&&(r=le(8)),mi(t,r)}function vB(e){var t=pi(e);return[t]}function yB(e,t,r){return r==null&&(r=le(4)),xi(t,r)}function wB(e){var t=Ds(e),r=e.read_shift(1);return[t,r,"b"]}function bB(e,t,r){return r==null&&(r=le(9)),mi(t,r),r.write_shift(1,e.v?1:0),r}function _B(e){var t=pi(e),r=e.read_shift(1);return[t,r,"b"]}function SB(e,t,r){return r==null&&(r=le(5)),xi(t,r),r.write_shift(1,e.v?1:0),r}function kB(e){var t=Ds(e),r=e.read_shift(1);return[t,r,"e"]}function NB(e,t,r){return r==null&&(r=le(9)),mi(t,r),r.write_shift(1,e.v),r}function EB(e){var t=pi(e),r=e.read_shift(1);return[t,r,"e"]}function jB(e,t,r){return r==null&&(r=le(8)),xi(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function TB(e){var t=Ds(e),r=e.read_shift(4);return[t,r,"s"]}function CB(e,t,r){return r==null&&(r=le(12)),mi(t,r),r.write_shift(4,t.v),r}function AB(e){var t=pi(e),r=e.read_shift(4);return[t,r,"s"]}function FB(e,t,r){return r==null&&(r=le(8)),xi(t,r),r.write_shift(4,t.v),r}function PB(e){var t=Ds(e),r=jr(e);return[t,r,"n"]}function RB(e,t,r){return r==null&&(r=le(16)),mi(t,r),ii(e.v,r),r}function FE(e){var t=pi(e),r=jr(e);return[t,r,"n"]}function IB(e,t,r){return r==null&&(r=le(12)),xi(t,r),ii(e.v,r),r}function OB(e){var t=Ds(e),r=Gx(e);return[t,r,"n"]}function DB(e,t,r){return r==null&&(r=le(12)),mi(t,r),jN(e.v,r),r}function LB(e){var t=pi(e),r=Gx(e);return[t,r,"n"]}function MB(e,t,r){return r==null&&(r=le(8)),xi(t,r),jN(e.v,r),r}function BB(e){var t=Ds(e),r=Wx(e);return[t,r,"is"]}function UB(e){var t=Ds(e),r=Ar(e);return[t,r,"str"]}function zB(e,t,r){return r==null&&(r=le(12+4*e.v.length)),mi(t,r),cr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function $B(e){var t=pi(e),r=Ar(e);return[t,r,"str"]}function VB(e,t,r){return r==null&&(r=le(8+4*e.v.length)),xi(t,r),cr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function WB(e,t,r){var s=e.l+t,n=Ds(e);n.r=r["!row"];var a=e.read_shift(1),i=[n,a,"b"];if(r.cellFormula){e.l+=2;var l=_0(e,s-e.l,r);i[3]=kr(l,null,n,r.supbooks,r)}else e.l=s;return i}function qB(e,t,r){var s=e.l+t,n=Ds(e);n.r=r["!row"];var a=e.read_shift(1),i=[n,a,"e"];if(r.cellFormula){e.l+=2;var l=_0(e,s-e.l,r);i[3]=kr(l,null,n,r.supbooks,r)}else e.l=s;return i}function HB(e,t,r){var s=e.l+t,n=Ds(e);n.r=r["!row"];var a=jr(e),i=[n,a,"n"];if(r.cellFormula){e.l+=2;var l=_0(e,s-e.l,r);i[3]=kr(l,null,n,r.supbooks,r)}else e.l=s;return i}function GB(e,t,r){var s=e.l+t,n=Ds(e);n.r=r["!row"];var a=Ar(e),i=[n,a,"str"];if(r.cellFormula){e.l+=2;var l=_0(e,s-e.l,r);i[3]=kr(l,null,n,r.supbooks,r)}else e.l=s;return i}var KB=gi,XB=Bo;function QB(e,t){return t==null&&(t=le(4)),t.write_shift(4,e),t}function YB(e,t){var r=e.l+t,s=gi(e),n=qx(e),a=Ar(e),i=Ar(e),l=Ar(e);e.l=r;var c={rfx:s,relId:n,loc:a,display:l};return i&&(c.Tooltip=i),c}function JB(e,t){var r=le(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Bo({s:Rt(e[0]),e:Rt(e[0])},r),Hx("rId"+t,r);var s=e[1].Target.indexOf("#"),n=s==-1?"":e[1].Target.slice(s+1);return cr(n||"",r),cr(e[1].Tooltip||"",r),cr("",r),r.slice(0,r.l)}function ZB(){}function eU(e,t,r){var s=e.l+t,n=TN(e),a=e.read_shift(1),i=[n];if(i[2]=a,r.cellFormula){var l=k7(e,s-e.l,r);i[1]=l}else e.l=s;return i}function tU(e,t,r){var s=e.l+t,n=gi(e),a=[n];if(r.cellFormula){var i=E7(e,s-e.l,r);a[1]=i,e.l=s}else e.l=s;return a}function rU(e,t,r){r==null&&(r=le(18));var s=S0(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(s.width||10)*256),r.write_shift(4,0);var n=0;return t.hidden&&(n|=1),typeof s.width=="number"&&(n|=2),t.level&&(n|=t.level<<8),r.write_shift(2,n),r}var PE=["left","right","top","bottom","header","footer"];function sU(e){var t={};return PE.forEach(function(r){t[r]=jr(e)}),t}function nU(e,t){return t==null&&(t=le(6*8)),Qa(e),PE.forEach(function(r){ii(e[r],t)}),t}function aU(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function iU(e,t,r){r==null&&(r=le(30));var s=924;return(((t||{}).Views||[])[0]||{}).RTL&&(s|=32),r.write_shift(2,s),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function oU(e){var t=le(24);return t.write_shift(4,4),t.write_shift(4,1),Bo(e,t),t}function lU(e,t){return t==null&&(t=le(16*4+2)),t.write_shift(2,e.password?Zx(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function cU(){}function uU(){}function dU(e,t,r,s,n,a,i){if(!e)return e;var l=t||{};s||(s={"!id":{}});var c=l.dense?[]:{},u,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,h=!1,m,x,p,g,w,v,y,b,S,k=[];l.biff=12,l["!row"]=0;var _=0,N=!1,C=[],B={},H=l.supbooks||n.supbooks||[[]];if(H.sharedf=B,H.arrayf=C,H.SheetNames=n.SheetNames||n.Sheets.map(function(W){return W.name}),!l.supbooks&&(l.supbooks=H,n.Names))for(var V=0;V<n.Names.length;++V)H[0][V+1]=n.Names[V];var K=[],Y=[],q=!1;vc[16]={n:"BrtShortReal",f:FE};var X;if(Ln(e,function(U,he,be){if(!h)switch(be){case 148:u=U;break;case 0:m=U,l.sheetRows&&l.sheetRows<=m.r&&(h=!0),b=Wt(g=m.r),l["!row"]=m.r,(U.hidden||U.hpt||U.level!=null)&&(U.hpt&&(U.hpx=No(U.hpt)),Y[U.r]=U);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(x={t:U[2]},U[2]){case"n":x.v=U[1];break;case"s":y=Cl[U[1]],x.v=y.t,x.r=y.r;break;case"b":x.v=!!U[1];break;case"e":x.v=U[1],l.cellText!==!1&&(x.w=Mn[x.v]);break;case"str":x.t="s",x.v=U[1];break;case"is":x.t="s",x.v=U[1].t;break}if((p=i.CellXf[U[0].iStyleRef])&&TE(x,p.numFmtId,null,l,a,i),w=U[0].c==-1?w+1:U[0].c,l.dense?(c[g]||(c[g]=[]),c[g][w]=x):c[Pt(w)+b]=x,l.cellFormula){for(N=!1,_=0;_<C.length;++_){var R=C[_];m.r>=R[0].s.r&&m.r<=R[0].e.r&&w>=R[0].s.c&&w<=R[0].e.c&&(x.F=Ke(R[0]),N=!0)}!N&&U.length>3&&(x.f=U[3])}if(d.s.r>m.r&&(d.s.r=m.r),d.s.c>w&&(d.s.c=w),d.e.r<m.r&&(d.e.r=m.r),d.e.c<w&&(d.e.c=w),l.cellDates&&p&&x.t=="n"&&Do($e[p.numFmtId])){var M=$a(x.v);M&&(x.t="d",x.v=new Date(M.y,M.m-1,M.d,M.H,M.M,M.S,M.u))}X&&(X.type=="XLDAPR"&&(x.D=!0),X=void 0);break;case 1:case 12:if(!l.sheetStubs||f)break;x={t:"z",v:void 0},w=U[0].c==-1?w+1:U[0].c,l.dense?(c[g]||(c[g]=[]),c[g][w]=x):c[Pt(w)+b]=x,d.s.r>m.r&&(d.s.r=m.r),d.s.c>w&&(d.s.c=w),d.e.r<m.r&&(d.e.r=m.r),d.e.c<w&&(d.e.c=w),X&&(X.type=="XLDAPR"&&(x.D=!0),X=void 0);break;case 176:k.push(U);break;case 49:X=((l.xlmeta||{}).Cell||[])[U-1];break;case 494:var O=s["!id"][U.relId];for(O?(U.Target=O.Target,U.loc&&(U.Target+="#"+U.loc),U.Rel=O):U.relId==""&&(U.Target="#"+U.loc),g=U.rfx.s.r;g<=U.rfx.e.r;++g)for(w=U.rfx.s.c;w<=U.rfx.e.c;++w)l.dense?(c[g]||(c[g]=[]),c[g][w]||(c[g][w]={t:"z",v:void 0}),c[g][w].l=U):(v=Ve({c:w,r:g}),c[v]||(c[v]={t:"z",v:void 0}),c[v].l=U);break;case 426:if(!l.cellFormula)break;C.push(U),S=l.dense?c[g][w]:c[Pt(w)+b],S.f=kr(U[1],d,{r:m.r,c:w},H,l),S.F=Ke(U[0]);break;case 427:if(!l.cellFormula)break;B[Ve(U[0].s)]=U[1],S=l.dense?c[g][w]:c[Pt(w)+b],S.f=kr(U[1],d,{r:m.r,c:w},H,l);break;case 60:if(!l.cellStyles)break;for(;U.e>=U.s;)K[U.e--]={width:U.w/256,hidden:!!(U.flags&1),level:U.level},q||(q=!0,eg(U.w/256)),fa(K[U.e+1]);break;case 161:c["!autofilter"]={ref:Ke(U)};break;case 476:c["!margins"]=U;break;case 147:n.Sheets[r]||(n.Sheets[r]={}),U.name&&(n.Sheets[r].CodeName=U.name),(U.above||U.left)&&(c["!outline"]={above:U.above,left:U.left});break;case 137:n.Views||(n.Views=[{}]),n.Views[0]||(n.Views[0]={}),U.RTL&&(n.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!he.T){if(!f||l.WTF)throw new Error("Unexpected record 0x"+be.toString(16))}}},l),delete l.supbooks,delete l["!row"],!c["!ref"]&&(d.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(c["!ref"]=Ke(u||d)),l.sheetRows&&c["!ref"]){var ie=ct(c["!ref"]);l.sheetRows<=+ie.e.r&&(ie.e.r=l.sheetRows-1,ie.e.r>d.e.r&&(ie.e.r=d.e.r),ie.e.r<ie.s.r&&(ie.s.r=ie.e.r),ie.e.c>d.e.c&&(ie.e.c=d.e.c),ie.e.c<ie.s.c&&(ie.s.c=ie.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Ke(ie))}return k.length>0&&(c["!merges"]=k),K.length>0&&(c["!cols"]=K),Y.length>0&&(c["!rows"]=Y),c}function fU(e,t,r,s,n,a,i){if(t.v===void 0)return!1;var l="";switch(t.t){case"b":l=t.v?"1":"0";break;case"d":t=St(t),t.z=t.z||$e[14],t.v=nr(_t(t.v)),t.t="n";break;case"n":case"e":l=""+t.v;break;default:l=t.v;break}var c={r,c:s};switch(c.s=Sa(n.cellXfs,t,n),t.l&&a["!links"].push([Ve(c),t.l]),t.c&&a["!comments"].push([Ve(c),t.c]),t.t){case"s":case"str":return n.bookSST?(l=ag(n.Strings,t.v,n.revStrings),c.t="s",c.v=l,i?ye(e,18,FB(t,c)):ye(e,7,CB(t,c))):(c.t="str",i?ye(e,17,VB(t,c)):ye(e,6,zB(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?i?ye(e,13,MB(t,c)):ye(e,2,DB(t,c)):i?ye(e,16,IB(t,c)):ye(e,5,RB(t,c)),!0;case"b":return c.t="b",i?ye(e,15,SB(t,c)):ye(e,4,bB(t,c)),!0;case"e":return c.t="e",i?ye(e,14,jB(t,c)):ye(e,3,NB(t,c)),!0}return i?ye(e,12,yB(t,c)):ye(e,1,gB(t,c)),!0}function hU(e,t,r,s){var n=ct(t["!ref"]||"A1"),a,i="",l=[];ye(e,145);var c=Array.isArray(t),u=n.e.r;t["!rows"]&&(u=Math.max(n.e.r,t["!rows"].length-1));for(var d=n.s.r;d<=u;++d){i=Wt(d),uB(e,t,n,d);var f=!1;if(d<=n.e.r)for(var h=n.s.c;h<=n.e.c;++h){d===n.s.r&&(l[h]=Pt(h)),a=l[h]+i;var m=c?(t[d]||[])[h]:t[a];if(!m){f=!1;continue}f=fU(e,m,d,h,s,t,f)}}ye(e,146)}function mU(e,t){!t||!t["!merges"]||(ye(e,177,QB(t["!merges"].length)),t["!merges"].forEach(function(r){ye(e,176,XB(r))}),ye(e,178))}function pU(e,t){!t||!t["!cols"]||(ye(e,390),t["!cols"].forEach(function(r,s){r&&ye(e,60,rU(s,r))}),ye(e,391))}function xU(e,t){!t||!t["!ref"]||(ye(e,648),ye(e,649,oU(ct(t["!ref"]))),ye(e,650))}function gU(e,t,r){t["!links"].forEach(function(s){if(s[1].Target){var n=ft(r,-1,s[1].Target.replace(/#.*$/,""),rt.HLINK);ye(e,494,JB(s,n))}}),delete t["!links"]}function vU(e,t,r,s){if(t["!comments"].length>0){var n=ft(s,-1,"../drawings/vmlDrawing"+(r+1)+".vml",rt.VML);ye(e,551,Hx("rId"+n)),t["!legacy"]=n}}function yU(e,t,r,s){if(t["!autofilter"]){var n=t["!autofilter"],a=typeof n.ref=="string"?n.ref:Ke(n.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,l=Zr(a);l.s.r==l.e.r&&(l.e.r=Zr(t["!ref"]).e.r,a=Ke(l));for(var c=0;c<i.length;++c){var u=i[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==s){u.Ref="'"+r.SheetNames[s]+"'!"+a;break}}c==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:s,Ref:"'"+r.SheetNames[s]+"'!"+a}),ye(e,161,Bo(ct(a))),ye(e,162)}}function wU(e,t,r){ye(e,133),ye(e,137,iU(t,r)),ye(e,138),ye(e,134)}function bU(e,t){t["!protect"]&&ye(e,535,lU(t["!protect"]))}function _U(e,t,r,s){var n=Jr(),a=r.SheetNames[e],i=r.Sheets[a]||{},l=a;try{r&&r.Workbook&&(l=r.Workbook.Sheets[e].CodeName||l)}catch{}var c=ct(i["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return i["!links"]=[],i["!comments"]=[],ye(n,129),(r.vbaraw||i["!outline"])&&ye(n,147,pB(l,i["!outline"])),ye(n,148,fB(c)),wU(n,i,r.Workbook),pU(n,i),hU(n,i,e,t),bU(n,i),yU(n,i,r,e),mU(n,i),gU(n,i,s),i["!margins"]&&ye(n,476,nU(i["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&xU(n,i),vU(n,i,e,s),ye(n,130),n.end()}function SU(e){var t=[],r=e.match(/^<c:numCache>/),s;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var i=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(t[+i[1]]=r?+i[2]:i[2])});var n=lt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){s=a.replace(/<.*?>/g,"")}),[t,n,s]}function kU(e,t,r,s,n,a){var i=a||{"!type":"chart"};if(!e)return a;var l=0,c=0,u="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var h=SU(f);d.s.r=d.s.c=0,d.e.c=l,u=Pt(l),h[0].forEach(function(m,x){i[u+Wt(x)]={t:"n",v:m,z:h[1]},c=x}),d.e.r<c&&(d.e.r=c),++l}),l>0&&(i["!ref"]=Ke(d)),i}function NU(e,t,r,s,n){if(!e)return e;s||(s={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i,l=e.match(CE);return l&&ig(l[0],a,n,r),(i=e.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=i[1]),s["!id"][a["!rel"]]&&(a["!drawel"]=s["!id"][a["!rel"]]),a}function EU(e,t){e.l+=10;var r=Ar(e);return{name:r}}function jU(e,t,r,s,n){if(!e)return e;s||(s={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i=!1;return Ln(e,function(c,u,d){switch(d){case 550:a["!rel"]=c;break;case 651:n.Sheets[r]||(n.Sheets[r]={}),c.name&&(n.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!i||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},t),s["!id"][a["!rel"]]&&(a["!drawel"]=s["!id"][a["!rel"]]),a}var og=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],TU=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],CU=[],AU=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function _w(e,t){for(var r=0;r!=e.length;++r)for(var s=e[r],n=0;n!=t.length;++n){var a=t[n];if(s[a[0]]==null)s[a[0]]=a[1];else switch(a[2]){case"bool":typeof s[a[0]]=="string"&&(s[a[0]]=wt(s[a[0]]));break;case"int":typeof s[a[0]]=="string"&&(s[a[0]]=parseInt(s[a[0]],10));break}}}function Sw(e,t){for(var r=0;r!=t.length;++r){var s=t[r];if(e[s[0]]==null)e[s[0]]=s[1];else switch(s[2]){case"bool":typeof e[s[0]]=="string"&&(e[s[0]]=wt(e[s[0]]));break;case"int":typeof e[s[0]]=="string"&&(e[s[0]]=parseInt(e[s[0]],10));break}}}function RE(e){Sw(e.WBProps,og),Sw(e.CalcPr,AU),_w(e.WBView,TU),_w(e.Sheets,CU),lo.date1904=wt(e.WBProps.date1904)}function FU(e){return!e.Workbook||!e.Workbook.WBProps?"false":wt(e.Workbook.WBProps.date1904)?"true":"false"}var PU="][*?/\\".split("");function IE(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return PU.forEach(function(s){if(e.indexOf(s)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function RU(e,t,r){e.forEach(function(s,n){IE(s);for(var a=0;a<n;++a)if(s==e[a])throw new Error("Duplicate Sheet Name: "+s);if(r){var i=t&&t[n]&&t[n].CodeName||s;if(i.charCodeAt(0)==95&&i.length>22)throw new Error("Bad Code Name: Worksheet"+i)}})}function IU(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];RU(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)F7(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var OU=/<\w+:workbook/;function DU(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},s=!1,n="xmlns",a={},i=0;if(e.replace(Rr,function(c,u){var d=qe(c);switch(hn(d[0])){case"<?xml":break;case"<workbook":c.match(OU)&&(n="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=d[n];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":og.forEach(function(f){if(d[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=wt(d[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(d[f[0]],10);break;default:r.WBProps[f[0]]=d[f[0]]}}),d.codeName&&(r.WBProps.CodeName=xt(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=lt(xt(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":s=!0;break;case"</definedNames>":s=!1;break;case"<definedName":a={},a.Name=xt(d.name),d.comment&&(a.Comment=d.comment),d.localSheetId&&(a.Sheet=+d.localSheetId),wt(d.hidden||"0")&&(a.Hidden=!0),i=u+c.length;break;case"</definedName>":a.Ref=lt(xt(e.slice(i,u))),r.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":s=!0;break;case"</AlternateContent>":s=!1;break;case"<revisionPtr":break;default:if(!s&&t.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return c}),hi.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return RE(r),r}function OE(e){var t=[qt];t[t.length]=je("workbook",null,{xmlns:hi[0],"xmlns:r":rr.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,s={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(og.forEach(function(l){e.Workbook.WBProps[l[0]]!=null&&e.Workbook.WBProps[l[0]]!=l[1]&&(s[l[0]]=e.Workbook.WBProps[l[0]])}),e.Workbook.WBProps.CodeName&&(s.codeName=e.Workbook.WBProps.CodeName,delete s.CodeName)),t[t.length]=je("workbookPr",null,s);var n=e.Workbook&&e.Workbook.Sheets||[],a=0;if(n&&n[0]&&n[0].Hidden){for(t[t.length]="<bookViews>",a=0;a!=e.SheetNames.length&&!(!n[a]||!n[a].Hidden);++a);a==e.SheetNames.length&&(a=0),t[t.length]='<workbookView firstSheet="'+a+'" activeTab="'+a+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",a=0;a!=e.SheetNames.length;++a){var i={name:ht(e.SheetNames[a].slice(0,31))};if(i.sheetId=""+(a+1),i["r:id"]="rId"+(a+1),n[a])switch(n[a].Hidden){case 1:i.state="hidden";break;case 2:i.state="veryHidden";break}t[t.length]=je("sheet",null,i)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(l){var c={name:l.Name};l.Comment&&(c.comment=l.Comment),l.Sheet!=null&&(c.localSheetId=""+l.Sheet),l.Hidden&&(c.hidden="1"),l.Ref&&(t[t.length]=je("definedName",ht(l.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function LU(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Tm(e),r.name=Ar(e),r}function MU(e,t){return t||(t=le(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Hx(e.strRelID,t),cr(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function BU(e,t){var r={},s=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var n=t>8?Ar(e):"";return n.length>0&&(r.CodeName=n),r.autoCompressPictures=!!(s&65536),r.backupFile=!!(s&64),r.checkCompatibility=!!(s&4096),r.date1904=!!(s&1),r.filterPrivacy=!!(s&8),r.hidePivotFieldList=!!(s&1024),r.promptedSolutions=!!(s&16),r.publishItems=!!(s&2048),r.refreshAllConnections=!!(s&262144),r.saveExternalLinkValues=!!(s&128),r.showBorderUnselectedTables=!!(s&4),r.showInkAnnotation=!!(s&32),r.showObjects=["all","placeholders","none"][s>>13&3],r.showPivotChartFilter=!!(s&32768),r.updateLinks=["userSet","never","always"][s>>8&3],r}function UU(e,t){t||(t=le(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),EN(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function zU(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function $U(e,t,r){var s=e.l+t;e.l+=4,e.l+=1;var n=e.read_shift(4),a=vO(e),i=N7(e,0,r),l=qx(e);e.l=s;var c={Name:a,Ptg:i};return n<268435455&&(c.Sheet=n),l&&(c.Comment=l),c}function VU(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},s=[],n=!1;t||(t={}),t.biff=12;var a=[],i=[[]];return i.SheetNames=[],i.XTI=[],vc[16]={n:"BrtFRTArchID$",f:zU},Ln(e,function(c,u,d){switch(d){case 156:i.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(t.SID=c.Sheet),c.Ref=kr(c.Ptg,null,null,i,t),delete t.SID,delete c.Ptg,a.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([d,c]):i[0]=[d,c],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(c),i.XTI=i.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:s.push(d),n=!0;break;case 36:s.pop(),n=!1;break;case 37:s.push(d),n=!0;break;case 38:s.pop(),n=!1;break;case 16:break;default:if(!u.T){if(!n||t.WTF&&s[s.length-1]!=37&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},t),RE(r),r.Names=a,r.supbooks=i,r}function WU(e,t){ye(e,143);for(var r=0;r!=t.SheetNames.length;++r){var s=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,n={Hidden:s,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};ye(e,156,MU(n))}ye(e,144)}function qU(e,t){t||(t=le(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return cr("SheetJS",t),cr(Ad.version,t),cr(Ad.version,t),cr("7262",t),t.length>t.l?t.slice(0,t.l):t}function HU(e,t){t||(t=le(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function GU(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,s=0,n=-1,a=-1;s<r.length;++s)!r[s]||!r[s].Hidden&&n==-1?n=s:r[s].Hidden==1&&a==-1&&(a=s);a>n||(ye(e,135),ye(e,158,HU(n)),ye(e,136))}}function KU(e,t){var r=Jr();return ye(r,131),ye(r,128,qU()),ye(r,153,UU(e.Workbook&&e.Workbook.WBProps||null)),GU(r,e),WU(r,e),ye(r,132),r.end()}function XU(e,t,r){return t.slice(-4)===".bin"?VU(e,r):DU(e,r)}function QU(e,t,r,s,n,a,i,l){return t.slice(-4)===".bin"?dU(e,s,r,n,a,i,l):$7(e,s,r,n,a,i,l)}function YU(e,t,r,s,n,a,i,l){return t.slice(-4)===".bin"?jU(e,s,r,n,a):NU(e,s,r,n,a)}function JU(e,t,r,s,n,a,i,l){return t.slice(-4)===".bin"?e9():t9()}function ZU(e,t,r,s,n,a,i,l){return t.slice(-4)===".bin"?JM():ZM()}function ez(e,t,r,s){return t.slice(-4)===".bin"?XL(e,r,s):LL(e,r,s)}function tz(e,t,r){return pE(e,r)}function rz(e,t,r){return t.slice(-4)===".bin"?rL(e,r):Z8(e,r)}function sz(e,t,r){return t.slice(-4)===".bin"?GM(e,r):MM(e,r)}function nz(e,t,r){return t.slice(-4)===".bin"?OM(e):RM(e)}function az(e,t,r,s){return r.slice(-4)===".bin"?DM(e,t,r,s):void 0}function iz(e,t,r){return t.slice(-4)===".bin"?AM(e,t,r):PM(e,t,r)}function oz(e,t,r){return(t.slice(-4)===".bin"?KU:OE)(e)}function lz(e,t,r,s,n){return(t.slice(-4)===".bin"?_U:AE)(e,r,s,n)}function cz(e,t,r){return(t.slice(-4)===".bin"?aM:hE)(e,r)}function uz(e,t,r){return(t.slice(-4)===".bin"?aL:aE)(e,r)}function dz(e,t,r){return(t.slice(-4)===".bin"?KM:vE)(e)}function fz(e){return(e.slice(-4)===".bin"?FM:xE)()}var DE=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,LE=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Ms(e,t){var r=e.split(/\s+/),s=[];if(s[0]=r[0],r.length===1)return s;var n=e.match(DE),a,i,l,c;if(n)for(c=0;c!=n.length;++c)a=n[c].match(LE),(i=a[1].indexOf(":"))===-1?s[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?l="xmlns"+a[1].slice(6):l=a[1].slice(i+1),s[l]=a[2].slice(1,a[2].length-1));return s}function hz(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var s=e.match(DE),n,a,i,l;if(s)for(l=0;l!=s.length;++l)n=s[l].match(LE),(a=n[1].indexOf(":"))===-1?r[n[1]]=n[2].slice(1,n[2].length-1):(n[1].slice(0,6)==="xmlns:"?i="xmlns"+n[1].slice(6):i=n[1].slice(a+1),r[i]=n[2].slice(1,n[2].length-1));return r}var Fl;function mz(e,t){var r=Fl[e]||lt(e);return r==="General"?ni(t):Os(r,t)}function pz(e,t,r,s){var n=s;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":n=wt(s);break;case"i2":case"int":n=parseInt(s,10);break;case"r4":case"float":n=parseFloat(s);break;case"date":case"dateTime.tz":n=_t(s);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[lt(t)]=n}function xz(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Mn[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=cc(e.v):e.w=ni(e.v):e.w=mz(t||"General",e.v)}catch(a){if(r.WTF)throw a}try{var s=Fl[t]||t||"General";if(r.cellNF&&(e.z=s),r.cellDates&&e.t=="n"&&Do(s)){var n=$a(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}catch(a){if(r.WTF)throw a}}}function gz(e,t,r){if(r.cellStyles&&t.Interior){var s=t.Interior;s.Pattern&&(s.patternType=CL[s.Pattern]||s.Pattern)}e[t.ID]=t}function vz(e,t,r,s,n,a,i,l,c,u){var d="General",f=s.StyleID,h={};u=u||{};var m=[],x=0;for(f===void 0&&l&&(f=l.StyleID),f===void 0&&i&&(f=i.StyleID);a[f]!==void 0&&(a[f].nf&&(d=a[f].nf),a[f].Interior&&m.push(a[f].Interior),!!a[f].Parent);)f=a[f].Parent;switch(r.Type){case"Boolean":s.t="b",s.v=wt(e);break;case"String":s.t="s",s.r=U1(lt(e)),s.v=e.indexOf("<")>-1?lt(t||e).replace(/<.*?>/g,""):s.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),s.v=(_t(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),s.v!==s.v?s.v=lt(e):s.v<60&&(s.v=s.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":s.v===void 0&&(s.v=+e),s.t||(s.t="n");break;case"Error":s.t="e",s.v=FN[e],u.cellText!==!1&&(s.w=e);break;default:e==""&&t==""?s.t="z":(s.t="s",s.v=U1(t||e));break}if(xz(s,d,u),u.cellFormula!==!1)if(s.Formula){var p=lt(s.Formula);p.charCodeAt(0)==61&&(p=p.slice(1)),s.f=oo(p,n),delete s.Formula,s.ArrayRange=="RC"?s.F=oo("RC:RC",n):s.ArrayRange&&(s.F=oo(s.ArrayRange,n),c.push([ct(s.F),s.F]))}else for(x=0;x<c.length;++x)n.r>=c[x][0].s.r&&n.r<=c[x][0].e.r&&n.c>=c[x][0].s.c&&n.c<=c[x][0].e.c&&(s.F=c[x][1]);u.cellStyles&&(m.forEach(function(g){!h.patternType&&g.patternType&&(h.patternType=g.patternType)}),s.s=h),s.StyleID!==void 0&&(s.ixfe=s.StyleID)}function yz(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Uf(e,t){var r=t||{};Lo();var s=il(Bx(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(s=xt(s));var n=s.slice(0,1024).toLowerCase(),a=!1;if(n=n.replace(/".*?"/g,""),(n.indexOf(">")&1023)>Math.min(n.indexOf(",")&1023,n.indexOf(";")&1023)){var i=St(r);return i.type="string",ko.to_workbook(s,i)}if(n.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Q){n.indexOf("<"+Q)>=0&&(a=!0)}),a)return n$(s,r);Fl={"General Number":"General","General Date":$e[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":$e[15],"Short Date":$e[14],"Long Time":$e[19],"Medium Time":$e[18],"Short Time":$e[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:$e[2],Standard:$e[4],Percent:$e[10],Scientific:$e[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,c=[],u,d={},f=[],h=r.dense?[]:{},m="",x={},p={},g=Ms('<Data ss:Type="String">'),w=0,v=0,y=0,b={s:{r:2e6,c:2e6},e:{r:0,c:0}},S={},k={},_="",N=0,C=[],B={},H={},V=0,K=[],Y=[],q={},X=[],ie,W=!1,U=[],he=[],be={},R=0,M=0,O={Sheets:[],WBProps:{date1904:!1}},z={};fc.lastIndex=0,s=s.replace(/<!--([\s\S]*?)-->/mg,"");for(var J="";l=fc.exec(s);)switch(l[3]=(J=l[3]).toLowerCase()){case"data":if(J=="data"){if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break}if(c[c.length-1][1])break;l[1]==="/"?vz(s.slice(w,l.index),_,g,c[c.length-1][0]=="comment"?q:x,{c:v,r:y},S,X[v],p,U,r):(_="",g=Ms(l[0]),w=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(Y.length>0&&(x.c=Y),(!r.sheetRows||r.sheetRows>y)&&x.v!==void 0&&(r.dense?(h[y]||(h[y]=[]),h[y][v]=x):h[Pt(v)+Wt(y)]=x),x.HRef&&(x.l={Target:lt(x.HRef)},x.HRefScreenTip&&(x.l.Tooltip=x.HRefScreenTip),delete x.HRef,delete x.HRefScreenTip),(x.MergeAcross||x.MergeDown)&&(R=v+(parseInt(x.MergeAcross,10)|0),M=y+(parseInt(x.MergeDown,10)|0),C.push({s:{c:v,r:y},e:{c:R,r:M}})),!r.sheetStubs)x.MergeAcross?v=R+1:++v;else if(x.MergeAcross||x.MergeDown){for(var pe=v;pe<=R;++pe)for(var ge=y;ge<=M;++ge)(pe>v||ge>y)&&(r.dense?(h[ge]||(h[ge]=[]),h[ge][pe]={t:"z"}):h[Pt(pe)+Wt(ge)]={t:"z"});v=R+1}else++v;else x=hz(l[0]),x.Index&&(v=+x.Index-1),v<b.s.c&&(b.s.c=v),v>b.e.c&&(b.e.c=v),l[0].slice(-2)==="/>"&&++v,Y=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(y<b.s.r&&(b.s.r=y),y>b.e.r&&(b.e.r=y),l[0].slice(-2)==="/>"&&(p=Ms(l[0]),p.Index&&(y=+p.Index-1)),v=0,++y):(p=Ms(l[0]),p.Index&&(y=+p.Index-1),be={},(p.AutoFitHeight=="0"||p.Height)&&(be.hpx=parseInt(p.Height,10),be.hpt=gc(be.hpx),he[y]=be),p.Hidden=="1"&&(be.hidden=!0,he[y]=be));break;case"worksheet":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"));f.push(m),b.s.r<=b.e.r&&b.s.c<=b.e.c&&(h["!ref"]=Ke(b),r.sheetRows&&r.sheetRows<=b.e.r&&(h["!fullref"]=h["!ref"],b.e.r=r.sheetRows-1,h["!ref"]=Ke(b))),C.length&&(h["!merges"]=C),X.length>0&&(h["!cols"]=X),he.length>0&&(h["!rows"]=he),d[m]=h}else b={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=v=0,c.push([l[3],!1]),u=Ms(l[0]),m=lt(u.Name),h=r.dense?[]:{},C=[],U=[],he=[],z={name:m,Hidden:0},O.Sheets.push(z);break;case"table":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else{if(l[0].slice(-2)=="/>")break;c.push([l[3],!1]),X=[],W=!1}break;case"style":l[1]==="/"?gz(S,k,r):k=Ms(l[0]);break;case"numberformat":k.nf=lt(Ms(l[0]).Format||"General"),Fl[k.nf]&&(k.nf=Fl[k.nf]);for(var ne=0;ne!=392&&$e[ne]!=k.nf;++ne);if(ne==392){for(ne=57;ne!=392;++ne)if($e[ne]==null){En(k.nf,ne);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(ie=Ms(l[0]),ie.Hidden&&(ie.hidden=!0,delete ie.Hidden),ie.Width&&(ie.wpx=parseInt(ie.Width,10)),!W&&ie.wpx>10){W=!0,Er=dE;for(var ae=0;ae<X.length;++ae)X[ae]&&fa(X[ae])}W&&fa(ie),X[ie.Index-1||X.length]=ie;for(var Ce=0;Ce<+ie.Span;++Ce)X[X.length]=St(ie);break;case"namedrange":if(l[1]==="/")break;O.Names||(O.Names=[]);var P=qe(l[0]),ce={Name:P.Name,Ref:oo(P.RefersTo.slice(1),{r:0,c:0})};O.Sheets.length>0&&(ce.Sheet=O.Sheets.length-1),O.Names.push(ce);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?_+=s.slice(N,l.index):N=l.index+l[0].length;break;case"interior":if(!r.cellStyles)break;k.Interior=Ms(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?VO(B,J,s.slice(V,l.index)):V=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else c.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"));yz(q),Y.push(q)}else c.push([l[3],!1]),u=Ms(l[0]),q={a:u.Author};break;case"autofilter":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var ue=Ms(l[0]);h["!autofilter"]={ref:oo(ue.Range).replace(/\$/g,"")},c.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"null":break;default:if(c.length==0&&l[3]=="document"||c.length==0&&l[3]=="uof")return Tw(s,r);var Ee=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Ee=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Ee=!1}break;case"excelworkbook":switch(l[3]){case"date1904":O.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Ee=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:Ee=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(s.slice(V,l.index)){case"SheetHidden":z.Hidden=1;break;case"SheetVeryHidden":z.Hidden=2;break}else V=l.index+l[0].length;break;case"header":h["!margins"]||Qa(h["!margins"]={},"xlml"),isNaN(+qe(l[0]).Margin)||(h["!margins"].header=+qe(l[0]).Margin);break;case"footer":h["!margins"]||Qa(h["!margins"]={},"xlml"),isNaN(+qe(l[0]).Margin)||(h["!margins"].footer=+qe(l[0]).Margin);break;case"pagemargins":var T=qe(l[0]);h["!margins"]||Qa(h["!margins"]={},"xlml"),isNaN(+T.Top)||(h["!margins"].top=+T.Top),isNaN(+T.Left)||(h["!margins"].left=+T.Left),isNaN(+T.Right)||(h["!margins"].right=+T.Right),isNaN(+T.Bottom)||(h["!margins"].bottom=+T.Bottom);break;case"displayrighttoleft":O.Views||(O.Views=[]),O.Views[0]||(O.Views[0]={}),O.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Ee=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Ee=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Ee=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Ee=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Ee=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Ee=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Ee=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Ee=!1}break;case"smarttags":break;default:Ee=!1;break}if(Ee||l[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?pz(H,J,K,s.slice(V,l.index)):(K=l,V=l.index+l[0].length);break}if(r.WTF)throw"Unrecognized tag: "+l[3]+"|"+c.join("|")}var G={};return!r.bookSheets&&!r.bookProps&&(G.Sheets=d),G.SheetNames=f,G.Workbook=O,G.SSF=St($e),G.Props=B,G.Custprops=H,G}function Om(e,t){switch(cg(t=t||{}),t.type||"base64"){case"base64":return Uf(fs(e),t);case"binary":case"buffer":case"file":return Uf(e,t);case"array":return Uf(ba(e),t)}}function wz(e,t){var r=[];return e.Props&&r.push(WO(e.Props,t)),e.Custprops&&r.push(qO(e.Props,e.Custprops)),r.join("")}function bz(){return""}function _z(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(s,n){var a=[];a.push(je("NumberFormat",null,{"ss:Format":ht($e[s.numFmtId])}));var i={"ss:ID":"s"+(21+n)};r.push(je("Style",a.join(""),i))}),je("Styles",r.join(""))}function ME(e){return je("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+sg(e.Ref,{r:0,c:0})})}function Sz(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],s=0;s<t.length;++s){var n=t[s];n.Sheet==null&&(n.Name.match(/^_xlfn\./)||r.push(ME(n)))}return je("Names",r.join(""))}function kz(e,t,r,s){if(!e||!((s||{}).Workbook||{}).Names)return"";for(var n=s.Workbook.Names,a=[],i=0;i<n.length;++i){var l=n[i];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||a.push(ME(l)))}return a.join("")}function Nz(e,t,r,s){if(!e)return"";var n=[];if(e["!margins"]&&(n.push("<PageSetup>"),e["!margins"].header&&n.push(je("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&n.push(je("Footer",null,{"x:Margin":e["!margins"].footer})),n.push(je("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),n.push("</PageSetup>")),s&&s.Workbook&&s.Workbook.Sheets&&s.Workbook.Sheets[r])if(s.Workbook.Sheets[r].Hidden)n.push(je("Visible",s.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var a=0;a<r&&!(s.Workbook.Sheets[a]&&!s.Workbook.Sheets[a].Hidden);++a);a==r&&n.push("<Selected/>")}return((((s||{}).Workbook||{}).Views||[])[0]||{}).RTL&&n.push("<DisplayRightToLeft/>"),e["!protect"]&&(n.push(xr("ProtectContents","True")),e["!protect"].objects&&n.push(xr("ProtectObjects","True")),e["!protect"].scenarios&&n.push(xr("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?n.push(xr("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&n.push(xr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(i){e["!protect"][i[0]]&&n.push("<"+i[1]+"/>")})),n.length==0?"":je("WorksheetOptions",n.join(""),{xmlns:ss.x})}function Ez(e){return e.map(function(t){var r=GI(t.t||""),s=je("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return je("Comment",s,{"ss:Author":t.a})}).join("")}function jz(e,t,r,s,n,a,i){if(!e||e.v==null&&e.f==null)return"";var l={};if(e.f&&(l["ss:Formula"]="="+ht(sg(e.f,i))),e.F&&e.F.slice(0,t.length)==t){var c=Rt(e.F.slice(t.length+1));l["ss:ArrayRange"]="RC:R"+(c.r==i.r?"":"["+(c.r-i.r)+"]")+"C"+(c.c==i.c?"":"["+(c.c-i.c)+"]")}if(e.l&&e.l.Target&&(l["ss:HRef"]=ht(e.l.Target),e.l.Tooltip&&(l["x:HRefScreenTip"]=ht(e.l.Tooltip))),r["!merges"])for(var u=r["!merges"],d=0;d!=u.length;++d)u[d].s.c!=i.c||u[d].s.r!=i.r||(u[d].e.c>u[d].s.c&&(l["ss:MergeAcross"]=u[d].e.c-u[d].s.c),u[d].e.r>u[d].s.r&&(l["ss:MergeDown"]=u[d].e.r-u[d].s.r));var f="",h="";switch(e.t){case"z":if(!s.sheetStubs)return"";break;case"n":f="Number",h=String(e.v);break;case"b":f="Boolean",h=e.v?"1":"0";break;case"e":f="Error",h=Mn[e.v];break;case"d":f="DateTime",h=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||$e[14]);break;case"s":f="String",h=HI(e.v||"");break}var m=Sa(s.cellXfs,e,s);l["ss:StyleID"]="s"+(21+m),l["ss:Index"]=i.c+1;var x=e.v!=null?h:"",p=e.t=="z"?"":'<Data ss:Type="'+f+'">'+x+"</Data>";return(e.c||[]).length>0&&(p+=Ez(e.c)),je("Cell",p,l)}function Tz(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=No(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function Cz(e,t,r,s){if(!e["!ref"])return"";var n=ct(e["!ref"]),a=e["!merges"]||[],i=0,l=[];e["!cols"]&&e["!cols"].forEach(function(g,w){fa(g);var v=!!g.width,y=S0(w,g),b={"ss:Index":w+1};v&&(b["ss:Width"]=pc(y.width)),g.hidden&&(b["ss:Hidden"]="1"),l.push(je("Column",null,b))});for(var c=Array.isArray(e),u=n.s.r;u<=n.e.r;++u){for(var d=[Tz(u,(e["!rows"]||[])[u])],f=n.s.c;f<=n.e.c;++f){var h=!1;for(i=0;i!=a.length;++i)if(!(a[i].s.c>f)&&!(a[i].s.r>u)&&!(a[i].e.c<f)&&!(a[i].e.r<u)){(a[i].s.c!=f||a[i].s.r!=u)&&(h=!0);break}if(!h){var m={r:u,c:f},x=Ve(m),p=c?(e[u]||[])[f]:e[x];d.push(jz(p,x,e,t,r,s,m))}}d.push("</Row>"),d.length>2&&l.push(d.join(""))}return l.join("")}function Az(e,t,r){var s=[],n=r.SheetNames[e],a=r.Sheets[n],i=a?kz(a,t,e,r):"";return i.length>0&&s.push("<Names>"+i+"</Names>"),i=a?Cz(a,t,e,r):"",i.length>0&&s.push("<Table>"+i+"</Table>"),s.push(Nz(a,t,e,r)),s.join("")}function Fz(e,t){t||(t={}),e.SSF||(e.SSF=St($e)),e.SSF&&(Lo(),x0(e.SSF),t.revssf=v0(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Sa(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(wz(e,t)),r.push(bz()),r.push(""),r.push("");for(var s=0;s<e.SheetNames.length;++s)r.push(je("Worksheet",Az(s,t,e),{"ss:Name":ht(e.SheetNames[s])}));return r[2]=_z(e,t),r[3]=Sz(e),qt+je("Workbook",r.join(""),{xmlns:ss.ss,"xmlns:o":ss.o,"xmlns:x":ss.x,"xmlns:ss":ss.ss,"xmlns:dt":ss.dt,"xmlns:html":ss.html})}function Pz(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=SO(r),r.length-r.l<=4)return t;var s=r.read_shift(4);if(s==0||s>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(s=r.read_shift(4),s!==1907505652)||(t.UnicodeClipboardFormat=kO(r),s=r.read_shift(4),s==0||s>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var Rz=[60,1084,2066,2165,2175];function Iz(e,t,r,s,n){var a=s,i=[],l=r.slice(r.l,r.l+a);if(n&&n.enc&&n.enc.insitu&&l.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:n.enc.insitu(l)}i.push(l),r.l+=a;for(var c=Sn(r,r.l),u=Dm[c],d=0;u!=null&&Rz.indexOf(c)>-1;)a=Sn(r,r.l+2),d=r.l+4,c==2066?d+=4:(c==2165||c==2175)&&(d+=12),l=r.slice(d,r.l+4+a),i.push(l),r.l+=4+a,u=Dm[c=Sn(r,r.l)];var f=lr(i);pr(f,0);var h=0;f.lens=[];for(var m=0;m<i.length;++m)f.lens.push(h),h+=i[m].length;if(f.length<s)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+s;return t.f(f,f.length,n)}function rn(e,t,r){if(e.t!=="z"&&e.XF){var s=0;try{s=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=$e[s])}catch(a){if(t.WTF)throw a}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Mn[e.v]:s===0||s=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=cc(e.v):e.w=ni(e.v):e.w=Os(s,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(a){if(t.WTF)throw a}if(t.cellDates&&s&&e.t=="n"&&Do($e[s]||String(s))){var n=$a(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}}function Cu(e,t,r){return{v:e,ixfe:t,t:r}}function Oz(e,t){var r={opts:{}},s={},n=t.dense?[]:{},a={},i={},l=null,c=[],u="",d={},f,h="",m,x,p,g,w={},v=[],y,b,S=[],k=[],_={Sheets:[],WBProps:{date1904:!1},Views:[{}]},N={},C=function(xe){return xe<8?Ga[xe]:xe<64&&k[xe-8]||Ga[xe]},B=function(xe,Xe,pt){var tt=Xe.XF.data;if(!(!tt||!tt.patternType||!pt||!pt.cellStyles)){Xe.s={},Xe.s.patternType=tt.patternType;var ar;(ar=mc(C(tt.icvFore)))&&(Xe.s.fgColor={rgb:ar}),(ar=mc(C(tt.icvBack)))&&(Xe.s.bgColor={rgb:ar})}},H=function(xe,Xe,pt){if(!(be>1)&&!(pt.sheetRows&&xe.r>=pt.sheetRows)){if(pt.cellStyles&&Xe.XF&&Xe.XF.data&&B(xe,Xe,pt),delete Xe.ixfe,delete Xe.XF,f=xe,h=Ve(xe),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),xe.r<i.s.r&&(i.s.r=xe.r),xe.c<i.s.c&&(i.s.c=xe.c),xe.r+1>i.e.r&&(i.e.r=xe.r+1),xe.c+1>i.e.c&&(i.e.c=xe.c+1),pt.cellFormula&&Xe.f){for(var tt=0;tt<v.length;++tt)if(!(v[tt][0].s.c>xe.c||v[tt][0].s.r>xe.r)&&!(v[tt][0].e.c<xe.c||v[tt][0].e.r<xe.r)){Xe.F=Ke(v[tt][0]),(v[tt][0].s.c!=xe.c||v[tt][0].s.r!=xe.r)&&delete Xe.f,Xe.f&&(Xe.f=""+kr(v[tt][1],i,xe,U,V));break}}pt.dense?(n[xe.r]||(n[xe.r]=[]),n[xe.r][xe.c]=Xe):n[h]=Xe}},V={enc:!1,sbcch:0,snames:[],sharedf:w,arrayf:v,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(V.password=t.password);var K,Y=[],q=[],X=[],ie=[],W=!1,U=[];U.SheetNames=V.snames,U.sharedf=V.sharedf,U.arrayf=V.arrayf,U.names=[],U.XTI=[];var he=0,be=0,R=0,M=[],O=[],z;V.codepage=1200,Gs(1200);for(var J=!1;e.l<e.length-1;){var pe=e.l,ge=e.read_shift(2);if(ge===0&&he===10)break;var ne=e.l===e.length?0:e.read_shift(2),ae=Dm[ge];if(ae&&ae.f){if(t.bookSheets&&he===133&&ge!==133)break;if(he=ge,ae.r===2||ae.r==12){var Ce=e.read_shift(2);if(ne-=2,!V.enc&&Ce!==ge&&((Ce&255)<<8|Ce>>8)!==ge)throw new Error("rt mismatch: "+Ce+"!="+ge);ae.r==12&&(e.l+=10,ne-=10)}var P={};if(ge===10?P=ae.f(e,ne,V):P=Iz(ge,ae,e,ne,V),be==0&&[9,521,1033,2057].indexOf(he)===-1)continue;switch(ge){case 34:r.opts.Date1904=_.WBProps.date1904=P;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(V.enc||(e.l=0),V.enc=P,!t.password)throw new Error("File is password-protected");if(P.valid==null)throw new Error("Encryption scheme unsupported");if(!P.valid)throw new Error("Password is incorrect");break;case 92:V.lastuser=P;break;case 66:var ce=Number(P);switch(ce){case 21010:ce=1200;break;case 32768:ce=1e4;break;case 32769:ce=1252;break}Gs(V.codepage=ce),J=!0;break;case 317:V.rrtabid=P;break;case 25:V.winlocked=P;break;case 439:r.opts.RefreshAll=P;break;case 12:r.opts.CalcCount=P;break;case 16:r.opts.CalcDelta=P;break;case 17:r.opts.CalcIter=P;break;case 13:r.opts.CalcMode=P;break;case 14:r.opts.CalcPrecision=P;break;case 95:r.opts.CalcSaveRecalc=P;break;case 15:V.CalcRefMode=P;break;case 2211:r.opts.FullCalc=P;break;case 129:P.fDialog&&(n["!type"]="dialog"),P.fBelow||((n["!outline"]||(n["!outline"]={})).above=!0),P.fRight||((n["!outline"]||(n["!outline"]={})).left=!0);break;case 224:S.push(P);break;case 430:U.push([P]),U[U.length-1].XTI=[];break;case 35:case 547:U[U.length-1].push(P);break;case 24:case 536:z={Name:P.Name,Ref:kr(P.rgce,i,null,U,V)},P.itab>0&&(z.Sheet=P.itab-1),U.names.push(z),U[0]||(U[0]=[],U[0].XTI=[]),U[U.length-1].push(P),P.Name=="_xlnm._FilterDatabase"&&P.itab>0&&P.rgce&&P.rgce[0]&&P.rgce[0][0]&&P.rgce[0][0][0]=="PtgArea3d"&&(O[P.itab-1]={ref:Ke(P.rgce[0][0][1][2])});break;case 22:V.ExternCount=P;break;case 23:U.length==0&&(U[0]=[],U[0].XTI=[]),U[U.length-1].XTI=U[U.length-1].XTI.concat(P),U.XTI=U.XTI.concat(P);break;case 2196:if(V.biff<8)break;z!=null&&(z.Comment=P[1]);break;case 18:n["!protect"]=P;break;case 19:P!==0&&V.WTF&&console.error("Password verifier: "+P);break;case 133:a[P.pos]=P,V.snames.push(P.name);break;case 10:{if(--be)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,n["!ref"]=Ke(i),t.sheetRows&&t.sheetRows<=i.e.r){var ue=i.e.r;i.e.r=t.sheetRows-1,n["!fullref"]=n["!ref"],n["!ref"]=Ke(i),i.e.r=ue}i.e.r++,i.e.c++}Y.length>0&&(n["!merges"]=Y),q.length>0&&(n["!objects"]=q),X.length>0&&(n["!cols"]=X),ie.length>0&&(n["!rows"]=ie),_.Sheets.push(N)}u===""?d=n:s[u]=n,n=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(V.biff===8&&(V.biff={9:2,521:3,1033:4}[ge]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[P.BIFFVer]||8),V.biffguess=P.BIFFVer==0,P.BIFFVer==0&&P.dt==4096&&(V.biff=5,J=!0,Gs(V.codepage=28591)),V.biff==8&&P.BIFFVer==0&&P.dt==16&&(V.biff=2),be++)break;if(n=t.dense?[]:{},V.biff<8&&!J&&(J=!0,Gs(V.codepage=t.codepage||1252)),V.biff<5||P.BIFFVer==0&&P.dt==4096){u===""&&(u="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var Ee={pos:e.l-ne,name:u};a[Ee.pos]=Ee,V.snames.push(u)}else u=(a[pe]||{name:""}).name;P.dt==32&&(n["!type"]="chart"),P.dt==64&&(n["!type"]="macro"),Y=[],q=[],V.arrayf=v=[],X=[],ie=[],W=!1,N={Hidden:(a[pe]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:n["!type"]=="chart"&&(t.dense?(n[P.r]||[])[P.c]:n[Ve({c:P.c,r:P.r})])&&++P.c,y={ixfe:P.ixfe,XF:S[P.ixfe]||{},v:P.val,t:"n"},R>0&&(y.z=M[y.ixfe>>8&63]),rn(y,t,r.opts.Date1904),H({c:P.c,r:P.r},y,t);break;case 5:case 517:y={ixfe:P.ixfe,XF:S[P.ixfe],v:P.val,t:P.t},R>0&&(y.z=M[y.ixfe>>8&63]),rn(y,t,r.opts.Date1904),H({c:P.c,r:P.r},y,t);break;case 638:y={ixfe:P.ixfe,XF:S[P.ixfe],v:P.rknum,t:"n"},R>0&&(y.z=M[y.ixfe>>8&63]),rn(y,t,r.opts.Date1904),H({c:P.c,r:P.r},y,t);break;case 189:for(var T=P.c;T<=P.C;++T){var G=P.rkrec[T-P.c][0];y={ixfe:G,XF:S[G],v:P.rkrec[T-P.c][1],t:"n"},R>0&&(y.z=M[y.ixfe>>8&63]),rn(y,t,r.opts.Date1904),H({c:T,r:P.r},y,t)}break;case 6:case 518:case 1030:{if(P.val=="String"){l=P;break}if(y=Cu(P.val,P.cell.ixfe,P.tt),y.XF=S[y.ixfe],t.cellFormula){var Q=P.formula;if(Q&&Q[0]&&Q[0][0]&&Q[0][0][0]=="PtgExp"){var me=Q[0][0][1][0],fe=Q[0][0][1][1],oe=Ve({r:me,c:fe});w[oe]?y.f=""+kr(P.formula,i,P.cell,U,V):y.F=((t.dense?(n[me]||[])[fe]:n[oe])||{}).F}else y.f=""+kr(P.formula,i,P.cell,U,V)}R>0&&(y.z=M[y.ixfe>>8&63]),rn(y,t,r.opts.Date1904),H(P.cell,y,t),l=P}break;case 7:case 519:if(l)l.val=P,y=Cu(P,l.cell.ixfe,"s"),y.XF=S[y.ixfe],t.cellFormula&&(y.f=""+kr(l.formula,i,l.cell,U,V)),R>0&&(y.z=M[y.ixfe>>8&63]),rn(y,t,r.opts.Date1904),H(l.cell,y,t),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{v.push(P);var ke=Ve(P[0].s);if(m=t.dense?(n[P[0].s.r]||[])[P[0].s.c]:n[ke],t.cellFormula&&m){if(!l||!ke||!m)break;m.f=""+kr(P[1],i,P[0],U,V),m.F=Ke(P[0])}}break;case 1212:{if(!t.cellFormula)break;if(h){if(!l)break;w[Ve(l.cell)]=P[0],m=t.dense?(n[l.cell.r]||[])[l.cell.c]:n[Ve(l.cell)],(m||{}).f=""+kr(P[0],i,f,U,V)}}break;case 253:y=Cu(c[P.isst].t,P.ixfe,"s"),c[P.isst].h&&(y.h=c[P.isst].h),y.XF=S[y.ixfe],R>0&&(y.z=M[y.ixfe>>8&63]),rn(y,t,r.opts.Date1904),H({c:P.c,r:P.r},y,t);break;case 513:t.sheetStubs&&(y={ixfe:P.ixfe,XF:S[P.ixfe],t:"z"},R>0&&(y.z=M[y.ixfe>>8&63]),rn(y,t,r.opts.Date1904),H({c:P.c,r:P.r},y,t));break;case 190:if(t.sheetStubs)for(var we=P.c;we<=P.C;++we){var Pe=P.ixfe[we-P.c];y={ixfe:Pe,XF:S[Pe],t:"z"},R>0&&(y.z=M[y.ixfe>>8&63]),rn(y,t,r.opts.Date1904),H({c:we,r:P.r},y,t)}break;case 214:case 516:case 4:y=Cu(P.val,P.ixfe,"s"),y.XF=S[y.ixfe],R>0&&(y.z=M[y.ixfe>>8&63]),rn(y,t,r.opts.Date1904),H({c:P.c,r:P.r},y,t);break;case 0:case 512:be===1&&(i=P);break;case 252:c=P;break;case 1054:if(V.biff==4){M[R++]=P[1];for(var Ue=0;Ue<R+163&&$e[Ue]!=P[1];++Ue);Ue>=163&&En(P[1],R+163)}else En(P[1],P[0]);break;case 30:{M[R++]=P;for(var et=0;et<R+163&&$e[et]!=P;++et);et>=163&&En(P,R+163)}break;case 229:Y=Y.concat(P);break;case 93:q[P.cmo[0]]=V.lastobj=P;break;case 438:V.lastobj.TxO=P;break;case 127:V.lastobj.ImData=P;break;case 440:for(g=P[0].s.r;g<=P[0].e.r;++g)for(p=P[0].s.c;p<=P[0].e.c;++p)m=t.dense?(n[g]||[])[p]:n[Ve({c:p,r:g})],m&&(m.l=P[1]);break;case 2048:for(g=P[0].s.r;g<=P[0].e.r;++g)for(p=P[0].s.c;p<=P[0].e.c;++p)m=t.dense?(n[g]||[])[p]:n[Ve({c:p,r:g})],m&&m.l&&(m.l.Tooltip=P[1]);break;case 28:{if(V.biff<=5&&V.biff>=2)break;m=t.dense?(n[P[0].r]||[])[P[0].c]:n[Ve(P[0])];var nt=q[P[2]];m||(t.dense?(n[P[0].r]||(n[P[0].r]=[]),m=n[P[0].r][P[0].c]={t:"z"}):m=n[Ve(P[0])]={t:"z"},i.e.r=Math.max(i.e.r,P[0].r),i.s.r=Math.min(i.s.r,P[0].r),i.e.c=Math.max(i.e.c,P[0].c),i.s.c=Math.min(i.s.c,P[0].c)),m.c||(m.c=[]),x={a:P[1],t:nt.TxO.t},m.c.push(x)}break;case 2173:_M(S[P.ixfe],P.ext);break;case 125:{if(!V.cellStyles)break;for(;P.e>=P.s;)X[P.e--]={width:P.w/256,level:P.level||0,hidden:!!(P.flags&1)},W||(W=!0,eg(P.w/256)),fa(X[P.e+1])}break;case 520:{var He={};P.level!=null&&(ie[P.r]=He,He.level=P.level),P.hidden&&(ie[P.r]=He,He.hidden=!0),P.hpt&&(ie[P.r]=He,He.hpt=P.hpt,He.hpx=No(P.hpt))}break;case 38:case 39:case 40:case 41:n["!margins"]||Qa(n["!margins"]={}),n["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ge]]=P;break;case 161:n["!margins"]||Qa(n["!margins"]={}),n["!margins"].header=P.header,n["!margins"].footer=P.footer;break;case 574:P.RTL&&(_.Views[0].RTL=!0);break;case 146:k=P;break;case 2198:K=P;break;case 140:b=P;break;case 442:u?N.CodeName=P||N.name:_.WBProps.CodeName=P||"ThisWorkbook";break}}else ae||console.error("Missing Info for XLS Record 0x"+ge.toString(16)),e.l+=ne}return r.SheetNames=Ut(a).sort(function(Be,xe){return Number(Be)-Number(xe)}).map(function(Be){return a[Be].name}),t.bookSheets||(r.Sheets=s),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&O.forEach(function(Be,xe){r.Sheets[r.SheetNames[xe]]["!autofilter"]=Be}),r.Strings=c,r.SSF=St($e),V.enc&&(r.Encryption=V.enc),K&&(r.Themes=K),r.Metadata={},b!==void 0&&(r.Metadata.Country=b),U.names.length>0&&(_.Names=U.names),r.Workbook=_,r}var Pl={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Dz(e,t,r){var s=Me.find(e,"/!DocumentSummaryInformation");if(s&&s.size>0)try{var n=nw(s,Cm,Pl.DSI);for(var a in n)t[a]=n[a]}catch(u){if(r.WTF)throw u}var i=Me.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var l=nw(i,Am,Pl.SI);for(var c in l)t[c]==null&&(t[c]=l[c])}catch(u){if(r.WTF)throw u}t.HeadingPairs&&t.TitlesOfParts&&(LN(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function Lz(e,t){var r=[],s=[],n=[],a=0,i,l=I1(Cm,"n"),c=I1(Am,"n");if(e.Props)for(i=Ut(e.Props),a=0;a<i.length;++a)(Object.prototype.hasOwnProperty.call(l,i[a])?r:Object.prototype.hasOwnProperty.call(c,i[a])?s:n).push([i[a],e.Props[i[a]]]);if(e.Custprops)for(i=Ut(e.Custprops),a=0;a<i.length;++a)Object.prototype.hasOwnProperty.call(e.Props||{},i[a])||(Object.prototype.hasOwnProperty.call(l,i[a])?r:Object.prototype.hasOwnProperty.call(c,i[a])?s:n).push([i[a],e.Custprops[i[a]]]);var u=[];for(a=0;a<n.length;++a)WN.indexOf(n[a][0])>-1||DN.indexOf(n[a][0])>-1||n[a][1]!=null&&u.push(n[a]);s.length&&Me.utils.cfb_add(t,"/SummaryInformation",aw(s,Pl.SI,c,Am)),(r.length||u.length)&&Me.utils.cfb_add(t,"/DocumentSummaryInformation",aw(r,Pl.DSI,l,Cm,u.length?u:null,Pl.UDI))}function BE(e,t){t||(t={}),cg(t),Ax(),t.codepage&&Cx(t.codepage);var r,s;if(e.FullPaths){if(Me.find(e,"/encryption"))throw new Error("File is password-protected");r=Me.find(e,"!CompObj"),s=Me.find(e,"/Workbook")||Me.find(e,"/Book")}else{switch(t.type){case"base64":e=os(fs(e));break;case"binary":e=os(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}pr(e,0),s={content:e}}var n,a;if(r&&Pz(r),t.bookProps&&!t.bookSheets)n={};else{var i=Ze?"buffer":"array";if(s&&s.content)n=Oz(s.content,t);else if((a=Me.find(e,"PerfectOffice_MAIN"))&&a.content)n=Xa.to_workbook(a.content,(t.type=i,t));else if((a=Me.find(e,"NativeContent_MAIN"))&&a.content)n=Xa.to_workbook(a.content,(t.type=i,t));else throw(a=Me.find(e,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Me.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(n.vbaraw=QM(e))}var l={};return e.FullPaths&&Dz(e,l,t),n.Props=n.Custprops=l,t.bookFiles&&(n.cfb=e),n}function Mz(e,t){var r=t||{},s=Me.utils.cfb_new({root:"R"}),n="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":n="/Workbook",r.biff=8;break;case"biff5":n="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Me.utils.cfb_add(s,n,UE(e,r)),r.biff==8&&(e.Props||e.Custprops)&&Lz(e,s),r.biff==8&&e.vbaraw&&YM(s,Me.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),s}var vc={0:{f:lB},1:{f:xB},2:{f:OB},3:{f:kB},4:{f:wB},5:{f:PB},6:{f:UB},7:{f:TB},8:{f:GB},9:{f:HB},10:{f:WB},11:{f:qB},12:{f:vB},13:{f:LB},14:{f:EB},15:{f:_B},16:{f:FE},17:{f:$B},18:{f:AB},19:{f:Wx},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:$U},40:{},42:{},43:{f:UL},44:{f:ML},45:{f:VL},46:{f:qL},47:{f:WL},48:{},49:{f:dO},50:{},51:{f:NM},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:tE},62:{f:BB},63:{f:IM},64:{f:cU},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Pr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:aU},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:mB},148:{f:dB,p:16},151:{f:ZB},152:{},153:{f:BU},154:{},155:{},156:{f:LU},157:{},158:{},159:{T:1,f:tL},160:{T:-1},161:{T:1,f:gi},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:KB},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:SM},336:{T:-1},337:{f:TM,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Tm},357:{},358:{},359:{},360:{T:1},361:{},362:{f:eE},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:eU},427:{f:tU},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:sU},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:hB},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:YB},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Tm},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:qM},633:{T:1},634:{T:-1},635:{T:1,f:VM},636:{T:-1},637:{f:pO},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:EU},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:uU},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Dm={6:{f:Mf},10:{f:zn},12:{f:Xt},13:{f:Xt},14:{f:zt},15:{f:zt},16:{f:jr},17:{f:zt},18:{f:zt},19:{f:Xt},20:{f:dw},21:{f:dw},23:{f:eE},24:{f:hw},25:{f:zt},26:{},27:{},28:{f:u8},29:{},34:{f:zt},35:{f:fw},38:{f:jr},39:{f:jr},40:{f:jr},41:{f:jr},42:{f:zt},43:{f:zt},47:{f:_L},49:{f:LD},51:{f:Xt},60:{},61:{f:PD},64:{f:zt},65:{f:DD},66:{f:Xt},77:{},80:{},81:{},82:{},85:{f:Xt},89:{},90:{},91:{},92:{f:bD},93:{f:h8},94:{},95:{f:zt},96:{},97:{},99:{f:zt},125:{f:tE},128:{f:JD},129:{f:SD},130:{f:Xt},131:{f:zt},132:{f:zt},133:{f:kD},134:{},140:{f:b8},141:{f:Xt},144:{},146:{f:k8},151:{},152:{},153:{},154:{},155:{},156:{f:Xt},157:{},158:{},160:{f:F8},161:{f:j8},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:KD},190:{f:XD},193:{f:zn},197:{},198:{},199:{},200:{},201:{},202:{f:zt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Xt},220:{},221:{f:zt},222:{},224:{f:YD},225:{f:wD},226:{f:zn},227:{},229:{f:d8},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:ED},253:{f:BD},255:{f:TD},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:qN},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:zt},353:{f:zn},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:s8},431:{f:zt},432:{},433:{},434:{},437:{},438:{f:x8},439:{f:zt},440:{f:g8},441:{},442:{f:Dc},443:{},444:{f:Xt},445:{},446:{},448:{f:zn},449:{f:FD,r:2},450:{f:zn},512:{f:lw},513:{f:A8},515:{f:t8},516:{f:zD},517:{f:uw},519:{f:P8},520:{f:CD},523:{},545:{f:mw},549:{f:ow},566:{},574:{f:ID},638:{f:GD},659:{},1048:{},1054:{f:VD},1084:{},1212:{f:o8},2048:{f:y8},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Eu},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:zn},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:N8,r:12},2173:{f:bM,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:zt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:i8,r:12},2197:{},2198:{f:pM,r:12},2199:{},2200:{},2201:{},2202:{f:l8,r:12},2203:{f:zn},2204:{},2205:{},2206:{},2207:{},2211:{f:AD},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Xt},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:T8},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:S8},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:lw},1:{},2:{f:L8},3:{f:O8},4:{f:I8},5:{f:uw},7:{f:B8},8:{},9:{f:Eu},11:{},22:{f:Xt},30:{f:qD},31:{},32:{},33:{f:mw},36:{},37:{f:ow},50:{f:U8},62:{},52:{},67:{},68:{f:Xt},69:{},86:{},126:{},127:{f:R8},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:z8},223:{},234:{},354:{},421:{},518:{f:Mf},521:{f:Eu},536:{f:hw},547:{f:fw},561:{},579:{},1030:{f:Mf},1033:{f:Eu},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Te(e,t,r,s){var n=t;if(!isNaN(n)){var a=s||(r||[]).length||0,i=e.next(4);i.write_shift(2,n),i.write_shift(2,a),a>0&&zx(r)&&e.push(r)}}function Bz(e,t,r,s){var n=(r||[]).length||0;if(n<=8224)return Te(e,t,r,n);var a=t;if(!isNaN(a)){for(var i=r.parts||[],l=0,c=0,u=0;u+(i[l]||8224)<=8224;)u+=i[l]||8224,l++;var d=e.next(4);for(d.write_shift(2,a),d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u;c<n;){for(d=e.next(4),d.write_shift(2,60),u=0;u+(i[l]||8224)<=8224;)u+=i[l]||8224,l++;d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u}}}function Uc(e,t,r){return e||(e=le(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function Uz(e,t,r,s){var n=le(9);return Uc(n,e,t),HN(r,s||"b",n),n}function zz(e,t,r){var s=le(8+2*r.length);return Uc(s,e,t),s.write_shift(1,r.length),s.write_shift(r.length,r,"sbcs"),s.l<s.length?s.slice(0,s.l):s}function $z(e,t,r,s){if(t.v!=null)switch(t.t){case"d":case"n":var n=t.t=="d"?nr(_t(t.v)):t.v;n==(n|0)&&n>=0&&n<65536?Te(e,2,M8(r,s,n)):Te(e,3,D8(r,s,n));return;case"b":case"e":Te(e,5,Uz(r,s,t.v,t.t));return;case"s":case"str":Te(e,4,zz(r,s,(t.v||"").slice(0,255)));return}Te(e,1,Uc(null,r,s))}function Vz(e,t,r,s){var n=Array.isArray(t),a=ct(t["!ref"]||"A1"),i,l="",c=[];if(a.e.c>255||a.e.r>16383){if(s.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.c,16383),i=Ke(a)}for(var u=a.s.r;u<=a.e.r;++u){l=Wt(u);for(var d=a.s.c;d<=a.e.c;++d){u===a.s.r&&(c[d]=Pt(d)),i=c[d]+l;var f=n?(t[u]||[])[d]:t[i];f&&$z(e,f,u,d)}}}function Wz(e,t){for(var r=t||{},s=Jr(),n=0,a=0;a<e.SheetNames.length;++a)e.SheetNames[a]==r.sheet&&(n=a);if(n==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Te(s,r.biff==4?1033:r.biff==3?521:9,Yx(e,16,r)),Vz(s,e.Sheets[e.SheetNames[n]],n,r),Te(s,10),s.end()}function qz(e,t,r){Te(e,49,MD({sz:12,name:"Arial"},r))}function Hz(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var n=s[0];n<=s[1];++n)t[n]!=null&&Te(e,1054,WD(n,t[n],r))})}function Gz(e,t){var r=le(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Te(e,2151,r),r=le(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),YN(ct(t["!ref"]||"A1"),r),r.write_shift(4,4),Te(e,2152,r)}function Kz(e,t){for(var r=0;r<16;++r)Te(e,224,cw({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(s){Te(e,224,cw(s,0,t))})}function Xz(e,t){for(var r=0;r<t["!links"].length;++r){var s=t["!links"][r];Te(e,440,v8(s)),s[1].Tooltip&&Te(e,2048,w8(s))}delete t["!links"]}function Qz(e,t){if(t){var r=0;t.forEach(function(s,n){++r<=256&&s&&Te(e,125,E8(S0(n,s),n))})}}function Yz(e,t,r,s,n){var a=16+Sa(n.cellXfs,t,n);if(t.v==null&&!t.bf){Te(e,513,li(r,s,a));return}if(t.bf)Te(e,6,S7(t,r,s,n,a));else switch(t.t){case"d":case"n":var i=t.t=="d"?nr(_t(t.v)):t.v;Te(e,515,r8(r,s,i,a));break;case"b":case"e":Te(e,517,e8(r,s,t.v,a,n,t.t));break;case"s":case"str":if(n.bookSST){var l=ag(n.Strings,t.v,n.revStrings);Te(e,253,UD(r,s,l,a))}else Te(e,516,$D(r,s,(t.v||"").slice(0,255),a,n));break;default:Te(e,513,li(r,s,a))}}function Jz(e,t,r){var s=Jr(),n=r.SheetNames[e],a=r.Sheets[n]||{},i=(r||{}).Workbook||{},l=(i.Sheets||[])[e]||{},c=Array.isArray(a),u=t.biff==8,d,f="",h=[],m=ct(a["!ref"]||"A1"),x=u?65536:16384;if(m.e.c>255||m.e.r>=x){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");m.e.c=Math.min(m.e.c,255),m.e.r=Math.min(m.e.c,x-1)}Te(s,2057,Yx(r,16,t)),Te(s,13,ks(1)),Te(s,12,ks(100)),Te(s,15,Lr(!0)),Te(s,17,Lr(!1)),Te(s,16,ii(.001)),Te(s,95,Lr(!0)),Te(s,42,Lr(!1)),Te(s,43,Lr(!1)),Te(s,130,ks(1)),Te(s,128,ZD()),Te(s,131,Lr(!1)),Te(s,132,Lr(!1)),u&&Qz(s,a["!cols"]),Te(s,512,HD(m,t)),u&&(a["!links"]=[]);for(var p=m.s.r;p<=m.e.r;++p){f=Wt(p);for(var g=m.s.c;g<=m.e.c;++g){p===m.s.r&&(h[g]=Pt(g)),d=h[g]+f;var w=c?(a[p]||[])[g]:a[d];w&&(Yz(s,w,p,g,t),u&&w.l&&a["!links"].push([d,w.l]))}}var v=l.CodeName||l.name||n;return u&&Te(s,574,OD((i.Views||[])[0])),u&&(a["!merges"]||[]).length&&Te(s,229,f8(a["!merges"])),u&&Xz(s,a),Te(s,442,GN(v)),u&&Gz(s,a),Te(s,10),s.end()}function Zz(e,t,r){var s=Jr(),n=(e||{}).Workbook||{},a=n.Sheets||[],i=n.WBProps||{},l=r.biff==8,c=r.biff==5;if(Te(s,2057,Yx(e,5,r)),r.bookType=="xla"&&Te(s,135),Te(s,225,l?ks(1200):null),Te(s,193,eD(2)),c&&Te(s,191),c&&Te(s,192),Te(s,226),Te(s,92,_D("SheetJS",r)),Te(s,66,ks(l?1200:1252)),l&&Te(s,353,ks(0)),l&&Te(s,448),Te(s,317,C8(e.SheetNames.length)),l&&e.vbaraw&&Te(s,211),l&&e.vbaraw){var u=i.CodeName||"ThisWorkbook";Te(s,442,GN(u))}Te(s,156,ks(17)),Te(s,25,Lr(!1)),Te(s,18,Lr(!1)),Te(s,19,ks(0)),l&&Te(s,431,Lr(!1)),l&&Te(s,444,ks(0)),Te(s,61,RD()),Te(s,64,Lr(!1)),Te(s,141,ks(0)),Te(s,34,Lr(FU(e)=="true")),Te(s,14,Lr(!0)),l&&Te(s,439,Lr(!1)),Te(s,218,ks(0)),qz(s,e,r),Hz(s,e.SSF,r),Kz(s,r),l&&Te(s,352,Lr(!1));var d=s.end(),f=Jr();l&&Te(f,140,_8()),l&&r.Strings&&Bz(f,252,jD(r.Strings)),Te(f,10);var h=f.end(),m=Jr(),x=0,p=0;for(p=0;p<e.SheetNames.length;++p)x+=(l?12:11)+(l?2:1)*e.SheetNames[p].length;var g=d.length+x+h.length;for(p=0;p<e.SheetNames.length;++p){var w=a[p]||{};Te(m,133,ND({pos:g,hs:w.Hidden||0,dt:0,name:e.SheetNames[p]},r)),g+=t[p].length}var v=m.end();if(x!=v.length)throw new Error("BS8 "+x+" != "+v.length);var y=[];return d.length&&y.push(d),v.length&&y.push(v),h.length&&y.push(h),lr(y)}function e$(e,t){var r=t||{},s=[];e&&!e.SSF&&(e.SSF=St($e)),e&&e.SSF&&(Lo(),x0(e.SSF),r.revssf=v0(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,ug(r),r.cellXfs=[],Sa(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var n=0;n<e.SheetNames.length;++n)s[s.length]=Jz(n,r,e);return s.unshift(Zz(e,s,r)),lr(s)}function UE(e,t){for(var r=0;r<=e.SheetNames.length;++r){var s=e.Sheets[e.SheetNames[r]];if(!(!s||!s["!ref"])){var n=Zr(s["!ref"]);n.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var a=t||{};switch(a.biff||2){case 8:case 5:return e$(e,t);case 4:case 3:case 2:return Wz(e,t)}throw new Error("invalid type "+a.bookType+" for BIFF")}function kw(e,t){var r=t||{},s=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var n=e.match(/<table/i);if(!n)throw new Error("Invalid HTML: could not find <table>");var a=e.match(/<\/table/i),i=n.index,l=a&&a.index||e.length,c=MI(e.slice(i,l),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,d=0,f=0,h=0,m={s:{r:1e7,c:1e7},e:{r:0,c:0}},x=[];for(i=0;i<c.length;++i){var p=c[i].trim(),g=p.slice(0,3).toLowerCase();if(g=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}d=0;continue}if(!(g!="<td"&&g!="<th")){var w=p.split(/<\/t[dh]>/i);for(l=0;l<w.length;++l){var v=w[l].trim();if(v.match(/<t[dh]/i)){for(var y=v,b=0;y.charAt(0)=="<"&&(b=y.indexOf(">"))>-1;)y=y.slice(b+1);for(var S=0;S<x.length;++S){var k=x[S];k.s.c==d&&k.s.r<u&&u<=k.e.r&&(d=k.e.c+1,S=-1)}var _=qe(v.slice(0,v.indexOf(">")));h=_.colspan?+_.colspan:1,((f=+_.rowspan)>1||h>1)&&x.push({s:{r:u,c:d},e:{r:u+(f||1)-1,c:d+h-1}});var N=_.t||_["data-t"]||"";if(!y.length){d+=h;continue}if(y=uN(y),m.s.r>u&&(m.s.r=u),m.e.r<u&&(m.e.r=u),m.s.c>d&&(m.s.c=d),m.e.c<d&&(m.e.c=d),!y.length){d+=h;continue}var C={t:"s",v:y};r.raw||!y.trim().length||N=="s"||(y==="TRUE"?C={t:"b",v:!0}:y==="FALSE"?C={t:"b",v:!1}:isNaN(Ys(y))?isNaN(So(y).getDate())||(C={t:"d",v:_t(y)},r.cellDates||(C={t:"n",v:nr(C.v)}),C.z=r.dateNF||$e[14]):C={t:"n",v:Ys(y)}),r.dense?(s[u]||(s[u]=[]),s[u][d]=C):s[Ve({r:u,c:d})]=C,d+=h}}}}return s["!ref"]=Ke(m),x.length&&(s["!merges"]=x),s}function t$(e,t,r,s){for(var n=e["!merges"]||[],a=[],i=t.s.c;i<=t.e.c;++i){for(var l=0,c=0,u=0;u<n.length;++u)if(!(n[u].s.r>r||n[u].s.c>i)&&!(n[u].e.r<r||n[u].e.c<i)){if(n[u].s.r<r||n[u].s.c<i){l=-1;break}l=n[u].e.r-n[u].s.r+1,c=n[u].e.c-n[u].s.c+1;break}if(!(l<0)){var d=Ve({r,c:i}),f=s.dense?(e[r]||[])[i]:e[d],h=f&&f.v!=null&&(f.h||Mx(f.w||(In(f),f.w)||""))||"",m={};l>1&&(m.rowspan=l),c>1&&(m.colspan=c),s.editable?h='<span contenteditable="true">'+h+"</span>":f&&(m["data-t"]=f&&f.t||"z",f.v!=null&&(m["data-v"]=f.v),f.z!=null&&(m["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+f.l.Target+'">'+h+"</a>")),m.id=(s.id||"sjs")+"-"+d,a.push(je("td",h,m))}}var x="<tr>";return x+a.join("")+"</tr>"}var r$='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',s$="</body></html>";function n$(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return _a(kw(r[0],t),t);var s=mg();return r.forEach(function(n,a){pg(s,kw(n,t),"Sheet"+(a+1))}),s}function a$(e,t,r){var s=[];return s.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function zE(e,t){var r=t||{},s=r.header!=null?r.header:r$,n=r.footer!=null?r.footer:s$,a=[s],i=Zr(e["!ref"]);r.dense=Array.isArray(e),a.push(a$(e,i,r));for(var l=i.s.r;l<=i.e.r;++l)a.push(t$(e,i,l,r));return a.push("</table>"+n),a.join("")}function $E(e,t,r){var s=r||{},n=0,a=0;if(s.origin!=null)if(typeof s.origin=="number")n=s.origin;else{var i=typeof s.origin=="string"?Rt(s.origin):s.origin;n=i.r,a=i.c}var l=t.getElementsByTagName("tr"),c=Math.min(s.sheetRows||1e7,l.length),u={s:{r:0,c:0},e:{r:n,c:a}};if(e["!ref"]){var d=Zr(e["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),n==-1&&(u.e.r=n=d.e.r+1)}var f=[],h=0,m=e["!rows"]||(e["!rows"]=[]),x=0,p=0,g=0,w=0,v=0,y=0;for(e["!cols"]||(e["!cols"]=[]);x<l.length&&p<c;++x){var b=l[x];if(Nw(b)){if(s.display)continue;m[p]={hidden:!0}}var S=b.children;for(g=w=0;g<S.length;++g){var k=S[g];if(!(s.display&&Nw(k))){var _=k.hasAttribute("data-v")?k.getAttribute("data-v"):k.hasAttribute("v")?k.getAttribute("v"):uN(k.innerHTML),N=k.getAttribute("data-z")||k.getAttribute("z");for(h=0;h<f.length;++h){var C=f[h];C.s.c==w+a&&C.s.r<p+n&&p+n<=C.e.r&&(w=C.e.c+1-a,h=-1)}y=+k.getAttribute("colspan")||1,((v=+k.getAttribute("rowspan")||1)>1||y>1)&&f.push({s:{r:p+n,c:w+a},e:{r:p+n+(v||1)-1,c:w+a+(y||1)-1}});var B={t:"s",v:_},H=k.getAttribute("data-t")||k.getAttribute("t")||"";_!=null&&(_.length==0?B.t=H||"z":s.raw||_.trim().length==0||H=="s"||(_==="TRUE"?B={t:"b",v:!0}:_==="FALSE"?B={t:"b",v:!1}:isNaN(Ys(_))?isNaN(So(_).getDate())||(B={t:"d",v:_t(_)},s.cellDates||(B={t:"n",v:nr(B.v)}),B.z=s.dateNF||$e[14]):B={t:"n",v:Ys(_)})),B.z===void 0&&N!=null&&(B.z=N);var V="",K=k.getElementsByTagName("A");if(K&&K.length)for(var Y=0;Y<K.length&&!(K[Y].hasAttribute("href")&&(V=K[Y].getAttribute("href"),V.charAt(0)!="#"));++Y);V&&V.charAt(0)!="#"&&(B.l={Target:V}),s.dense?(e[p+n]||(e[p+n]=[]),e[p+n][w+a]=B):e[Ve({c:w+a,r:p+n})]=B,u.e.c<w+a&&(u.e.c=w+a),w+=y}}++p}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),u.e.r=Math.max(u.e.r,p-1+n),e["!ref"]=Ke(u),p>=c&&(e["!fullref"]=Ke((u.e.r=l.length-x+p-1+n,u))),e}function VE(e,t){var r=t||{},s=r.dense?[]:{};return $E(s,e,t)}function i$(e,t){return _a(VE(e,t),t)}function Nw(e){var t="",r=o$(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function o$(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function l$(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(s,n){return Array(parseInt(n,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=lt(t.replace(/<[^>]*>/g,""));return[r]}var Ew={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function WE(e,t){var r=t||{},s=Bx(e),n=[],a,i,l={name:""},c="",u=0,d,f,h={},m=[],x=r.dense?[]:{},p,g,w={value:""},v="",y=0,b=[],S=-1,k=-1,_={s:{r:1e6,c:1e7},e:{r:0,c:0}},N=0,C={},B=[],H={},V=0,K=0,Y=[],q=1,X=1,ie=[],W={Names:[]},U={},he=["",""],be=[],R={},M="",O=0,z=!1,J=!1,pe=0;for(fc.lastIndex=0,s=s.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");p=fc.exec(s);)switch(p[3]=p[3].replace(/_.*$/,"")){case"table":case"":p[1]==="/"?(_.e.c>=_.s.c&&_.e.r>=_.s.r?x["!ref"]=Ke(_):x["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=_.e.r&&(x["!fullref"]=x["!ref"],_.e.r=r.sheetRows-1,x["!ref"]=Ke(_)),B.length&&(x["!merges"]=B),Y.length&&(x["!rows"]=Y),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),m.push(d.name),h[d.name]=x,J=!1):p[0].charAt(p[0].length-2)!=="/"&&(d=qe(p[0],!1),S=k=-1,_.s.r=_.s.c=1e7,_.e.r=_.e.c=0,x=r.dense?[]:{},B=[],Y=[],J=!0);break;case"table-row-group":p[1]==="/"?--N:++N;break;case"table-row":case"":if(p[1]==="/"){S+=q,q=1;break}if(f=qe(p[0],!1),f.?S=f.-1:S==-1&&(S=0),q=+f["number-rows-repeated"]||1,q<10)for(pe=0;pe<q;++pe)N>0&&(Y[S+pe]={level:N});k=-1;break;case"covered-table-cell":p[1]!=="/"&&++k,r.sheetStubs&&(r.dense?(x[S]||(x[S]=[]),x[S][k]={t:"z"}):x[Ve({r:S,c:k})]={t:"z"}),v="",b=[];break;case"table-cell":case"":if(p[0].charAt(p[0].length-2)==="/")++k,w=qe(p[0],!1),X=parseInt(w["number-columns-repeated"]||"1",10),g={t:"z",v:null},w.formula&&r.cellFormula!=!1&&(g.f=bw(lt(w.formula))),(w.||w["value-type"])=="string"&&(g.t="s",g.v=lt(w["string-value"]||""),r.dense?(x[S]||(x[S]=[]),x[S][k]=g):x[Ve({r:S,c:k})]=g),k+=X-1;else if(p[1]!=="/"){++k,v="",y=0,b=[],X=1;var ge=q?S+q-1:S;if(k>_.e.c&&(_.e.c=k),k<_.s.c&&(_.s.c=k),S<_.s.r&&(_.s.r=S),ge>_.e.r&&(_.e.r=ge),w=qe(p[0],!1),be=[],R={},g={t:w.||w["value-type"],v:null},r.cellFormula)if(w.formula&&(w.formula=lt(w.formula)),w["number-matrix-columns-spanned"]&&w["number-matrix-rows-spanned"]&&(V=parseInt(w["number-matrix-rows-spanned"],10)||0,K=parseInt(w["number-matrix-columns-spanned"],10)||0,H={s:{r:S,c:k},e:{r:S+V-1,c:k+K-1}},g.F=Ke(H),ie.push([H,g.F])),w.formula)g.f=bw(w.formula);else for(pe=0;pe<ie.length;++pe)S>=ie[pe][0].s.r&&S<=ie[pe][0].e.r&&k>=ie[pe][0].s.c&&k<=ie[pe][0].e.c&&(g.F=ie[pe][1]);switch((w["number-columns-spanned"]||w["number-rows-spanned"])&&(V=parseInt(w["number-rows-spanned"],10)||0,K=parseInt(w["number-columns-spanned"],10)||0,H={s:{r:S,c:k},e:{r:S+V-1,c:k+K-1}},B.push(H)),w["number-columns-repeated"]&&(X=parseInt(w["number-columns-repeated"],10)),g.t){case"boolean":g.t="b",g.v=wt(w["boolean-value"]);break;case"float":g.t="n",g.v=parseFloat(w.value);break;case"percentage":g.t="n",g.v=parseFloat(w.value);break;case"currency":g.t="n",g.v=parseFloat(w.value);break;case"date":g.t="d",g.v=_t(w["date-value"]),r.cellDates||(g.t="n",g.v=nr(g.v)),g.z="m/d/yy";break;case"time":g.t="n",g.v=OI(w["time-value"])/86400,r.cellDates&&(g.t="d",g.v=y0(g.v)),g.z="HH:MM:SS";break;case"number":g.t="n",g.v=parseFloat(w.);break;default:if(g.t==="string"||g.t==="text"||!g.t)g.t="s",w["string-value"]!=null&&(v=lt(w["string-value"]),b=[]);else throw new Error("Unsupported value type "+g.t)}}else{if(z=!1,g.t==="s"&&(g.v=v||"",b.length&&(g.R=b),z=y==0),U.Target&&(g.l=U),be.length>0&&(g.c=be,be=[]),v&&r.cellText!==!1&&(g.w=v),z&&(g.t="z",delete g.v),(!z||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=S))for(var ne=0;ne<q;++ne){if(X=parseInt(w["number-columns-repeated"]||"1",10),r.dense)for(x[S+ne]||(x[S+ne]=[]),x[S+ne][k]=ne==0?g:St(g);--X>0;)x[S+ne][k+X]=St(g);else for(x[Ve({r:S+ne,c:k})]=g;--X>0;)x[Ve({r:S+ne,c:k+X})]=St(g);_.e.c<=k&&(_.e.c=k)}X=parseInt(w["number-columns-repeated"]||"1",10),k+=X-1,X=0,g={},v="",b=[]}U={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(p[1]==="/"){if((a=n.pop())[0]!==p[3])throw"Bad state: "+a}else p[0].charAt(p[0].length-2)!=="/"&&n.push([p[3],!0]);break;case"annotation":if(p[1]==="/"){if((a=n.pop())[0]!==p[3])throw"Bad state: "+a;R.t=v,b.length&&(R.R=b),R.a=M,be.push(R)}else p[0].charAt(p[0].length-2)!=="/"&&n.push([p[3],!1]);M="",O=0,v="",y=0,b=[];break;case"creator":p[1]==="/"?M=s.slice(O,p.index):O=p.index+p[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(p[1]==="/"){if((a=n.pop())[0]!==p[3])throw"Bad state: "+a}else p[0].charAt(p[0].length-2)!=="/"&&n.push([p[3],!1]);v="",y=0,b=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(p[1]==="/"){if(C[l.name]=c,(a=n.pop())[0]!==p[3])throw"Bad state: "+a}else p[0].charAt(p[0].length-2)!=="/"&&(c="",l=qe(p[0],!1),n.push([p[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(n[n.length-1][0]){case"time-style":case"date-style":i=qe(p[0],!1),c+=Ew[p[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(n[n.length-1][0]){case"time-style":case"date-style":i=qe(p[0],!1),c+=Ew[p[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(p[0].slice(-2)==="/>")break;if(p[1]==="/")switch(n[n.length-1][0]){case"number-style":case"date-style":case"time-style":c+=s.slice(u,p.index);break}else u=p.index+p[0].length;break;case"named-range":i=qe(p[0],!1),he=Bf(i["cell-range-address"]);var ae={Name:i.name,Ref:he[0]+"!"+he[1]};J&&(ae.Sheet=m.length),W.Names.push(ae);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(n[n.length-1][0])>-1)break;if(p[1]==="/"&&(!w||!w["string-value"])){var Ce=l$(s.slice(y,p.index));v=(v.length>0?v+`
`:"")+Ce[0]}else qe(p[0],!1),y=p.index+p[0].length;break;case"s":break;case"database-range":if(p[1]==="/")break;try{he=Bf(qe(p[0])["target-range-address"]),h[he[0]]["!autofilter"]={ref:he[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(p[1]!=="/"){if(U=qe(p[0],!1),!U.href)break;U.Target=lt(U.href),delete U.href,U.Target.charAt(0)=="#"&&U.Target.indexOf(".")>-1?(he=Bf(U.Target.slice(1)),U.Target="#"+he[0]+"!"+he[1]):U.Target.match(/^\.\.[\\\/]/)&&(U.Target=U.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(p[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(p)}}var P={Sheets:h,SheetNames:m,Workbook:W};return r.bookSheets&&delete P.Sheets,P}function jw(e,t){t=t||{},Ss(e,"META-INF/manifest.xml")&&OO(Kt(e,"META-INF/manifest.xml"),t);var r=ls(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var s=WE(xt(r),t);return Ss(e,"meta.xml")&&(s.Props=IN(Kt(e,"meta.xml"))),s}function Tw(e,t){return WE(e,t)}var c$=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+dc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return qt+t}}(),Cw=function(){var e=function(a){return ht(a).replace(/  +/g,function(i){return'<text:s text:c="'+i.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,s=function(a,i,l){var c=[];c.push('      <table:table table:name="'+ht(i.SheetNames[l])+`" table:style-name="ta1">
`);var u=0,d=0,f=Zr(a["!ref"]||"A1"),h=a["!merges"]||[],m=0,x=Array.isArray(a);if(a["!cols"])for(d=0;d<=f.e.c;++d)c.push("        <table:table-column"+(a["!cols"][d]?' table:style-name="co'+a["!cols"][d].ods+'"':"")+`></table:table-column>
`);var p="",g=a["!rows"]||[];for(u=0;u<f.s.r;++u)p=g[u]?' table:style-name="ro'+g[u].ods+'"':"",c.push("        <table:table-row"+p+`></table:table-row>
`);for(;u<=f.e.r;++u){for(p=g[u]?' table:style-name="ro'+g[u].ods+'"':"",c.push("        <table:table-row"+p+`>
`),d=0;d<f.s.c;++d)c.push(t);for(;d<=f.e.c;++d){var w=!1,v={},y="";for(m=0;m!=h.length;++m)if(!(h[m].s.c>d)&&!(h[m].s.r>u)&&!(h[m].e.c<d)&&!(h[m].e.r<u)){(h[m].s.c!=d||h[m].s.r!=u)&&(w=!0),v["table:number-columns-spanned"]=h[m].e.c-h[m].s.c+1,v["table:number-rows-spanned"]=h[m].e.r-h[m].s.r+1;break}if(w){c.push(r);continue}var b=Ve({r:u,c:d}),S=x?(a[u]||[])[d]:a[b];if(S&&S.f&&(v["table:formula"]=ht(C7(S.f)),S.F&&S.F.slice(0,b.length)==b)){var k=Zr(S.F);v["table:number-matrix-columns-spanned"]=k.e.c-k.s.c+1,v["table:number-matrix-rows-spanned"]=k.e.r-k.s.r+1}if(!S){c.push(t);continue}switch(S.t){case"b":y=S.v?"TRUE":"FALSE",v["office:value-type"]="boolean",v["office:boolean-value"]=S.v?"true":"false";break;case"n":y=S.w||String(S.v||0),v["office:value-type"]="float",v["office:value"]=S.v||0;break;case"s":case"str":y=S.v==null?"":S.v,v["office:value-type"]="string";break;case"d":y=S.w||_t(S.v).toISOString(),v["office:value-type"]="date",v["office:date-value"]=_t(S.v).toISOString(),v["table:style-name"]="ce1";break;default:c.push(t);continue}var _=e(y);if(S.l&&S.l.Target){var N=S.l.Target;N=N.charAt(0)=="#"?"#"+A7(N.slice(1)):N,N.charAt(0)!="#"&&!N.match(/^\w+:/)&&(N="../"+N),_=je("text:a",_,{"xlink:href":N.replace(/&/g,"&amp;")})}c.push("          "+je("table:table-cell",je("text:p",_,{}),v)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},n=function(a,i){a.push(` <office:automatic-styles>
`),a.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),a.push(`   <number:month number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:day number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:year/>
`),a.push(`  </number:date-style>
`);var l=0;i.SheetNames.map(function(u){return i.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var d=0;d<u["!cols"].length;++d)if(u["!cols"][d]){var f=u["!cols"][d];if(f.width==null&&f.wpx==null&&f.wch==null)continue;fa(f),f.ods=l;var h=u["!cols"][d].wpx+"px";a.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),a.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+h+`"/>
`),a.push(`  </style:style>
`),++l}}});var c=0;i.SheetNames.map(function(u){return i.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var d=0;d<u["!rows"].length;++d)if(u["!rows"][d]){u["!rows"][d].ods=c;var f=u["!rows"][d].hpx+"px";a.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),a.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),a.push(`  </style:style>
`),++c}}}),a.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),a.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),a.push(`  </style:style>
`),a.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),a.push(` </office:automatic-styles>
`)};return function(i,l){var c=[qt],u=dc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=dc({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(c.push("<office:document"+u+d+`>
`),c.push(RN().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+u+`>
`),n(c,i),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var f=0;f!=i.SheetNames.length;++f)c.push(s(i.Sheets[i.SheetNames[f]],i,f));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),l.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function qE(e,t){if(t.bookType=="fods")return Cw(e,t);var r=Ox(),s="",n=[],a=[];return s="mimetype",Qe(r,s,"application/vnd.oasis.opendocument.spreadsheet"),s="content.xml",Qe(r,s,Cw(e,t)),n.push([s,"text/xml"]),a.push([s,"ContentFile"]),s="styles.xml",Qe(r,s,c$(e,t)),n.push([s,"text/xml"]),a.push([s,"StylesFile"]),s="meta.xml",Qe(r,s,qt+RN()),n.push([s,"text/xml"]),a.push([s,"MetadataFile"]),s="manifest.rdf",Qe(r,s,MO(a)),n.push([s,"application/rdf+xml"]),s="META-INF/manifest.xml",Qe(r,s,DO(n)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function ci(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Lm(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):xt(ba(e))}function u$(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):os(ln(e))}function d$(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var s=0;s<t.length;++s)if(e[r+s]!=t[s])continue e;return!0}return!1}function ma(e){var t=e.reduce(function(n,a){return n+a.length},0),r=new Uint8Array(t),s=0;return e.forEach(function(n){r.set(n,s),s+=n.length}),r}function Aw(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function f$(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,s=e[t+14]&1,n=t+13;n>=t;--n)s=s*256+e[n];return(e[t+15]&128?-s:s)*Math.pow(10,r-6176)}function h$(e,t,r){var s=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,n=r/Math.pow(10,s-6176);e[t+15]|=s>>7,e[t+14]|=(s&127)<<1;for(var a=0;n>=1;++a,n/=256)e[t+a]=n&255;e[t+15]|=r>=0?0:128}function yc(e,t){var r=t?t[0]:0,s=e[r]&127;e:if(e[r++]>=128&&(s|=(e[r]&127)<<7,e[r++]<128||(s|=(e[r]&127)<<14,e[r++]<128)||(s|=(e[r]&127)<<21,e[r++]<128)||(s+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(s+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(s+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),s}function dt(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Bt(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function ut(e){for(var t=[],r=[0];r[0]<e.length;){var s=r[0],n=yc(e,r),a=n&7;n=Math.floor(n/8);var i=0,l;if(n==0)break;switch(a){case 0:{for(var c=r[0];e[r[0]++]>=128;);l=e.slice(c,r[0])}break;case 5:i=4,l=e.slice(r[0],r[0]+i),r[0]+=i;break;case 1:i=8,l=e.slice(r[0],r[0]+i),r[0]+=i;break;case 2:i=yc(e,r),l=e.slice(r[0],r[0]+i),r[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(n," at offset ").concat(s))}var u={data:l,type:a};t[n]==null?t[n]=[u]:t[n].push(u)}return t}function fr(e){var t=[];return e.forEach(function(r,s){r.forEach(function(n){n.data&&(t.push(dt(s*8+n.type)),n.type==2&&t.push(dt(n.data.length)),t.push(n.data))})}),ma(t)}function lg(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function ws(e){for(var t,r=[],s=[0];s[0]<e.length;){var n=yc(e,s),a=ut(e.slice(s[0],s[0]+n));s[0]+=n;var i={id:Bt(a[1][0].data),messages:[]};a[2].forEach(function(l){var c=ut(l.data),u=Bt(c[3][0].data);i.messages.push({meta:c,data:e.slice(s[0],s[0]+u)}),s[0]+=u}),(t=a[3])!=null&&t[0]&&(i.merge=Bt(a[3][0].data)>>>0>0),r.push(i)}return r}function ji(e){var t=[];return e.forEach(function(r){var s=[];s[1]=[{data:dt(r.id),type:0}],s[2]=[],r.merge!=null&&(s[3]=[{data:dt(+!!r.merge),type:0}]);var n=[];r.messages.forEach(function(i){n.push(i.data),i.meta[3]=[{type:0,data:dt(i.data.length)}],s[2].push({data:fr(i.meta),type:2})});var a=fr(s);t.push(dt(a.length)),t.push(a),n.forEach(function(i){return t.push(i)})}),ma(t)}function m$(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],s=yc(t,r),n=[];r[0]<t.length;){var a=t[r[0]]&3;if(a==0){var i=t[r[0]++]>>2;if(i<60)++i;else{var l=i-59;i=t[r[0]],l>1&&(i|=t[r[0]+1]<<8),l>2&&(i|=t[r[0]+2]<<16),l>3&&(i|=t[r[0]+3]<<24),i>>>=0,i++,r[0]+=l}n.push(t.slice(r[0],r[0]+i)),r[0]+=i;continue}else{var c=0,u=0;if(a==1?(u=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,a==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),n=[ma(n)],c==0)throw new Error("Invalid offset 0");if(c>n[0].length)throw new Error("Invalid offset beyond length");if(u>=c)for(n.push(n[0].slice(-c)),u-=c;u>=n[n.length-1].length;)n.push(n[n.length-1]),u-=n[n.length-1].length;n.push(n[0].slice(-c,-c+u))}}var d=ma(n);if(d.length!=s)throw new Error("Unexpected length: ".concat(d.length," != ").concat(s));return d}function bs(e){for(var t=[],r=0;r<e.length;){var s=e[r++],n=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(m$(s,e.slice(r,r+n))),r+=n}if(r!==e.length)throw new Error("data is not a valid framed stream!");return ma(t)}function Ti(e){for(var t=[],r=0;r<e.length;){var s=Math.min(e.length-r,268435455),n=new Uint8Array(4);t.push(n);var a=dt(s),i=a.length;t.push(a),s<=60?(i++,t.push(new Uint8Array([s-1<<2]))):s<=256?(i+=2,t.push(new Uint8Array([240,s-1&255]))):s<=65536?(i+=3,t.push(new Uint8Array([244,s-1&255,s-1>>8&255]))):s<=16777216?(i+=4,t.push(new Uint8Array([248,s-1&255,s-1>>8&255,s-1>>16&255]))):s<=4294967296&&(i+=5,t.push(new Uint8Array([252,s-1&255,s-1>>8&255,s-1>>16&255,s-1>>>24&255]))),t.push(e.slice(r,r+s)),i+=s,n[0]=0,n[1]=i&255,n[2]=i>>8&255,n[3]=i>>16&255,r+=s}return ma(t)}function p$(e,t,r,s){var n=ci(e),a=n.getUint32(4,!0),i=(s>1?12:8)+Aw(a&(s>1?3470:398))*4,l=-1,c=-1,u=NaN,d=new Date(2001,0,1);a&512&&(l=n.getUint32(i,!0),i+=4),i+=Aw(a&(s>1?12288:4096))*4,a&16&&(c=n.getUint32(i,!0),i+=4),a&32&&(u=n.getFloat64(i,!0),i+=8),a&64&&(d.setTime(d.getTime()+n.getFloat64(i,!0)*1e3),i+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:u};break;case 3:f={t:"s",v:t[c]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(l>-1)f={t:"s",v:r[l]};else if(c>-1)f={t:"s",v:t[c]};else if(!isNaN(u))f={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function x$(e,t,r){var s=ci(e),n=s.getUint32(8,!0),a=12,i=-1,l=-1,c=NaN,u=NaN,d=new Date(2001,0,1);n&1&&(c=f$(e,a),a+=16),n&2&&(u=s.getFloat64(a,!0),a+=8),n&4&&(d.setTime(d.getTime()+s.getFloat64(a,!0)*1e3),a+=8),n&8&&(l=s.getUint32(a,!0),a+=4),n&16&&(i=s.getUint32(a,!0),a+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:t[l]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(i>-1)f={t:"s",v:r[i]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)))}return f}function zf(e,t){var r=new Uint8Array(32),s=ci(r),n=12,a=0;switch(r[0]=5,e.t){case"n":r[1]=2,h$(r,n,e.v),a|=1,n+=16;break;case"b":r[1]=6,s.setFloat64(n,e.v?1:0,!0),a|=2,n+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,s.setUint32(n,t.indexOf(e.v),!0),a|=8,n+=4;break;default:throw"unsupported cell type "+e.t}return s.setUint32(8,a,!0),r.slice(0,n)}function $f(e,t){var r=new Uint8Array(32),s=ci(r),n=12,a=0;switch(r[0]=3,e.t){case"n":r[2]=2,s.setFloat64(n,e.v,!0),a|=32,n+=8;break;case"b":r[2]=6,s.setFloat64(n,e.v?1:0,!0),a|=32,n+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,s.setUint32(n,t.indexOf(e.v),!0),a|=16,n+=4;break;default:throw"unsupported cell type "+e.t}return s.setUint32(4,a,!0),r.slice(0,n)}function g$(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return p$(e,t,r,e[0]);case 5:return x$(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Sr(e){var t=ut(e);return yc(t[1][0].data)}function Fw(e,t){var r=ut(t.data),s=Bt(r[1][0].data),n=r[3],a=[];return(n||[]).forEach(function(i){var l=ut(i.data),c=Bt(l[1][0].data)>>>0;switch(s){case 1:a[c]=Lm(l[3][0].data);break;case 8:{var u=e[Sr(l[9][0].data)][0],d=ut(u.data),f=e[Sr(d[1][0].data)][0],h=Bt(f.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var m=ut(f.data);a[c]=m[3].map(function(x){return Lm(x.data)}).join("")}break}}),a}function v$(e,t){var r,s,n,a,i,l,c,u,d,f,h,m,x,p,g=ut(e),w=Bt(g[1][0].data)>>>0,v=Bt(g[2][0].data)>>>0,y=((s=(r=g[8])==null?void 0:r[0])==null?void 0:s.data)&&Bt(g[8][0].data)>0||!1,b,S;if((a=(n=g[7])==null?void 0:n[0])!=null&&a.data&&t!=0)b=(l=(i=g[7])==null?void 0:i[0])==null?void 0:l.data,S=(u=(c=g[6])==null?void 0:c[0])==null?void 0:u.data;else if((f=(d=g[4])==null?void 0:d[0])!=null&&f.data&&t!=1)b=(m=(h=g[4])==null?void 0:h[0])==null?void 0:m.data,S=(p=(x=g[3])==null?void 0:x[0])==null?void 0:p.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var k=y?4:1,_=ci(b),N=[],C=0;C<b.length/2;++C){var B=_.getUint16(C*2,!0);B<65535&&N.push([C,B])}if(N.length!=v)throw"Expected ".concat(v," cells, found ").concat(N.length);var H=[];for(C=0;C<N.length-1;++C)H[N[C][0]]=S.subarray(N[C][1]*k,N[C+1][1]*k);return N.length>=1&&(H[N[N.length-1][0]]=S.subarray(N[N.length-1][1]*k)),{R:w,cells:H}}function y$(e,t){var r,s=ut(t.data),n=(r=s==null?void 0:s[7])!=null&&r[0]?Bt(s[7][0].data)>>>0>0?1:0:-1,a=lg(s[5],function(i){return v$(i,n)});return{nrows:Bt(s[4][0].data)>>>0,data:a.reduce(function(i,l){return i[l.R]||(i[l.R]=[]),l.cells.forEach(function(c,u){if(i[l.R][u])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(u));i[l.R][u]=c}),i},[])}}function w$(e,t,r){var s,n=ut(t.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(Bt(n[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(n[6][0].data));if(a.e.c=(Bt(n[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(n[7][0].data));r["!ref"]=Ke(a);var i=ut(n[4][0].data),l=Fw(e,e[Sr(i[4][0].data)][0]),c=(s=i[17])!=null&&s[0]?Fw(e,e[Sr(i[17][0].data)][0]):[],u=ut(i[3][0].data),d=0;u[1].forEach(function(f){var h=ut(f.data),m=e[Sr(h[2][0].data)][0],x=Bt(m.meta[1][0].data);if(x!=6002)throw new Error("6001 unexpected reference to ".concat(x));var p=y$(e,m);p.data.forEach(function(g,w){g.forEach(function(v,y){var b=Ve({r:d+w,c:y}),S=g$(v,l,c);S&&(r[b]=S)})}),d+=p.nrows})}function b$(e,t){var r=ut(t.data),s={"!ref":"A1"},n=e[Sr(r[2][0].data)],a=Bt(n[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return w$(e,n[0],s),s}function _$(e,t){var r,s=ut(t.data),n={name:(r=s[1])!=null&&r[0]?Lm(s[1][0].data):"",sheets:[]},a=lg(s[2],Sr);return a.forEach(function(i){e[i].forEach(function(l){var c=Bt(l.meta[1][0].data);c==6e3&&n.sheets.push(b$(e,l))})}),n}function S$(e,t){var r=mg(),s=ut(t.data),n=lg(s[1],Sr);if(n.forEach(function(a){e[a].forEach(function(i){var l=Bt(i.meta[1][0].data);if(l==2){var c=_$(e,i);c.sheets.forEach(function(u,d){pg(r,u,d==0?c.name:c.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Vf(e){var t,r,s,n,a={},i=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var u;try{u=bs(c.content)}catch(f){return console.log("?? "+c.content.length+" "+(f.message||f))}var d;try{d=ws(u)}catch(f){return console.log("## "+(f.message||f))}d.forEach(function(f){a[f.id]=f.messages,i.push(f.id)})}}),!i.length)throw new Error("File has no messages");var l=((n=(s=(r=(t=a==null?void 0:a[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:s[1])==null?void 0:n[0].data)&&Bt(a[1][0].meta[1][0].data)==1&&a[1][0];if(l||i.forEach(function(c){a[c].forEach(function(u){var d=Bt(u.meta[1][0].data)>>>0;if(d==1)if(!l)l=u;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return S$(a,l)}function k$(e,t,r){var s,n,a,i;if(!((s=e[6])!=null&&s[0])||!((n=e[7])!=null&&n[0]))throw"Mutation only works on post-BNC storages!";var l=((i=(a=e[8])==null?void 0:a[0])==null?void 0:i.data)&&Bt(e[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var c=0,u=ci(e[7][0].data),d=0,f=[],h=ci(e[4][0].data),m=0,x=[],p=0;p<t.length;++p){if(t[p]==null){u.setUint16(p*2,65535,!0),h.setUint16(p*2,65535);continue}u.setUint16(p*2,d,!0),h.setUint16(p*2,m,!0);var g,w;switch(typeof t[p]){case"string":g=zf({t:"s",v:t[p]},r),w=$f({t:"s",v:t[p]},r);break;case"number":g=zf({t:"n",v:t[p]},r),w=$f({t:"n",v:t[p]},r);break;case"boolean":g=zf({t:"b",v:t[p]},r),w=$f({t:"b",v:t[p]},r);break;default:throw new Error("Unsupported value "+t[p])}f.push(g),d+=g.length,x.push(w),m+=w.length,++c}for(e[2][0].data=dt(c);p<e[7][0].data.length/2;++p)u.setUint16(p*2,65535,!0),h.setUint16(p*2,65535,!0);return e[6][0].data=ma(f),e[3][0].data=ma(x),c}function N$(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var s=Zr(r["!ref"]);s.s.r=s.s.c=0;var n=!1;s.e.c>9&&(n=!0,s.e.c=9),s.e.r>49&&(n=!0,s.e.r=49),n&&console.error("The Numbers writer is currently limited to ".concat(Ke(s)));var a=$d(r,{range:s,header:1}),i=["~Sh33tJ5~"];a.forEach(function(M){return M.forEach(function(O){typeof O=="string"&&i.push(O)})});var l={},c=[],u=Me.read(t.numbers,{type:"base64"});u.FileIndex.map(function(M,O){return[M,u.FullPaths[O]]}).forEach(function(M){var O=M[0],z=M[1];if(O.type==2&&O.name.match(/\.iwa/)){var J=O.content,pe=bs(J),ge=ws(pe);ge.forEach(function(ne){c.push(ne.id),l[ne.id]={deps:[],location:z,type:Bt(ne.messages[0].meta[1][0].data)}})}}),c.sort(function(M,O){return M-O});var d=c.filter(function(M){return M>1}).map(function(M){return[M,dt(M)]});u.FileIndex.map(function(M,O){return[M,u.FullPaths[O]]}).forEach(function(M){var O=M[0];if(M[1],!!O.name.match(/\.iwa/)){var z=ws(bs(O.content));z.forEach(function(J){J.messages.forEach(function(pe){d.forEach(function(ge){J.messages.some(function(ne){return Bt(ne.meta[1][0].data)!=11006&&d$(ne.data,ge[1])})&&l[ge[0]].deps.push(J.id)})})})}});for(var f=Me.find(u,l[1].location),h=ws(bs(f.content)),m,x=0;x<h.length;++x){var p=h[x];p.id==1&&(m=p)}var g=Sr(ut(m.messages[0].data)[1][0].data);for(f=Me.find(u,l[g].location),h=ws(bs(f.content)),x=0;x<h.length;++x)p=h[x],p.id==g&&(m=p);for(g=Sr(ut(m.messages[0].data)[2][0].data),f=Me.find(u,l[g].location),h=ws(bs(f.content)),x=0;x<h.length;++x)p=h[x],p.id==g&&(m=p);for(g=Sr(ut(m.messages[0].data)[2][0].data),f=Me.find(u,l[g].location),h=ws(bs(f.content)),x=0;x<h.length;++x)p=h[x],p.id==g&&(m=p);var w=ut(m.messages[0].data);{w[6][0].data=dt(s.e.r+1),w[7][0].data=dt(s.e.c+1);var v=Sr(w[46][0].data),y=Me.find(u,l[v].location),b=ws(bs(y.content));{for(var S=0;S<b.length&&b[S].id!=v;++S);if(b[S].id!=v)throw"Bad ColumnRowUIDMapArchive";var k=ut(b[S].messages[0].data);k[1]=[],k[2]=[],k[3]=[];for(var _=0;_<=s.e.c;++_){var N=[];N[1]=N[2]=[{type:0,data:dt(_+420690)}],k[1].push({type:2,data:fr(N)}),k[2].push({type:0,data:dt(_)}),k[3].push({type:0,data:dt(_)})}k[4]=[],k[5]=[],k[6]=[];for(var C=0;C<=s.e.r;++C)N=[],N[1]=N[2]=[{type:0,data:dt(C+726270)}],k[4].push({type:2,data:fr(N)}),k[5].push({type:0,data:dt(C)}),k[6].push({type:0,data:dt(C)});b[S].messages[0].data=fr(k)}y.content=Ti(ji(b)),y.size=y.content.length,delete w[46];var B=ut(w[4][0].data);{B[7][0].data=dt(s.e.r+1);var H=ut(B[1][0].data),V=Sr(H[2][0].data);y=Me.find(u,l[V].location),b=ws(bs(y.content));{if(b[0].id!=V)throw"Bad HeaderStorageBucket";var K=ut(b[0].messages[0].data);for(C=0;C<a.length;++C){var Y=ut(K[2][0].data);Y[1][0].data=dt(C),Y[4][0].data=dt(a[C].length),K[2][C]={type:K[2][0].type,data:fr(Y)}}b[0].messages[0].data=fr(K)}y.content=Ti(ji(b)),y.size=y.content.length;var q=Sr(B[2][0].data);y=Me.find(u,l[q].location),b=ws(bs(y.content));{if(b[0].id!=q)throw"Bad HeaderStorageBucket";for(K=ut(b[0].messages[0].data),_=0;_<=s.e.c;++_)Y=ut(K[2][0].data),Y[1][0].data=dt(_),Y[4][0].data=dt(s.e.r+1),K[2][_]={type:K[2][0].type,data:fr(Y)};b[0].messages[0].data=fr(K)}y.content=Ti(ji(b)),y.size=y.content.length;var X=Sr(B[4][0].data);(function(){for(var M=Me.find(u,l[X].location),O=ws(bs(M.content)),z,J=0;J<O.length;++J){var pe=O[J];pe.id==X&&(z=pe)}var ge=ut(z.messages[0].data);{ge[3]=[];var ne=[];i.forEach(function(P,ce){ne[1]=[{type:0,data:dt(ce)}],ne[2]=[{type:0,data:dt(1)}],ne[3]=[{type:2,data:u$(P)}],ge[3].push({type:2,data:fr(ne)})})}z.messages[0].data=fr(ge);var ae=ji(O),Ce=Ti(ae);M.content=Ce,M.size=M.content.length})();var ie=ut(B[3][0].data);{var W=ie[1][0];delete ie[2];var U=ut(W.data);{var he=Sr(U[2][0].data);(function(){for(var M=Me.find(u,l[he].location),O=ws(bs(M.content)),z,J=0;J<O.length;++J){var pe=O[J];pe.id==he&&(z=pe)}var ge=ut(z.messages[0].data);{delete ge[6],delete ie[7];var ne=new Uint8Array(ge[5][0].data);ge[5]=[];for(var ae=0,Ce=0;Ce<=s.e.r;++Ce){var P=ut(ne);ae+=k$(P,a[Ce],i),P[1][0].data=dt(Ce),ge[5].push({data:fr(P),type:2})}ge[1]=[{type:0,data:dt(s.e.c+1)}],ge[2]=[{type:0,data:dt(s.e.r+1)}],ge[3]=[{type:0,data:dt(ae)}],ge[4]=[{type:0,data:dt(s.e.r+1)}]}z.messages[0].data=fr(ge);var ce=ji(O),ue=Ti(ce);M.content=ue,M.size=M.content.length})()}W.data=fr(U)}B[3][0].data=fr(ie)}w[4][0].data=fr(B)}m.messages[0].data=fr(w);var be=ji(h),R=Ti(be);return f.content=R,f.size=f.content.length,u}function HE(e){return function(r){for(var s=0;s!=e.length;++s){var n=e[s];r[n[0]]===void 0&&(r[n[0]]=n[1]),n[2]==="n"&&(r[n[0]]=Number(r[n[0]]))}}}function cg(e){HE([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function ug(e){HE([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function E$(e){return rt.WS.indexOf(e)>-1?"sheet":e==rt.CS?"chart":e==rt.DS?"dialog":e==rt.MS?"macro":e&&e.length?e:"sheet"}function j$(e,t){if(!e)return 0;try{e=t.map(function(s){return s.id||(s.id=s.strRelID),[s.name,e["!id"][s.id].Target,E$(e["!id"][s.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function T$(e,t,r,s,n,a,i,l,c,u,d,f){try{a[s]=Tl(ls(e,r,!0),t);var h=Kt(e,t),m;switch(l){case"sheet":m=QU(h,t,n,c,a[s],u,d,f);break;case"chart":if(m=YU(h,t,n,c,a[s],u,d,f),!m||!m["!drawel"])break;var x=ll(m["!drawel"].Target,t),p=hc(x),g=LM(ls(e,x,!0),Tl(ls(e,p,!0),x)),w=ll(g,x),v=hc(w);m=kU(ls(e,w,!0),w,c,Tl(ls(e,v,!0),w),u,m);break;case"macro":m=JU(h,t,n,c,a[s],u,d,f);break;case"dialog":m=ZU(h,t,n,c,a[s],u,d,f);break;default:throw new Error("Unrecognized sheet type "+l)}i[s]=m;var y=[];a&&a[s]&&Ut(a[s]).forEach(function(b){var S="";if(a[s][b].Type==rt.CMNT){S=ll(a[s][b].Target,t);var k=sz(Kt(e,S,!0),S,c);if(!k||!k.length)return;xw(m,k,!1)}a[s][b].Type==rt.TCMNT&&(S=ll(a[s][b].Target,t),y=y.concat(BM(Kt(e,S,!0),c)))}),y&&y.length&&xw(m,y,!0,c.people||[])}catch(b){if(c.WTF)throw b}}function vs(e){return e.charAt(0)=="/"?e.slice(1):e}function C$(e,t){if(Lo(),t=t||{},cg(t),Ss(e,"META-INF/manifest.xml")||Ss(e,"objectdata.xml"))return jw(e,t);if(Ss(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Vf<"u"){if(e.FileIndex)return Vf(e);var r=Me.utils.cfb_new();return L1(e).forEach(function(Y){Qe(r,Y,UI(e,Y))}),Vf(r)}throw new Error("Unsupported NUMBERS file")}if(!Ss(e,"[Content_Types].xml"))throw Ss(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Ss(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var s=L1(e),n=RO(ls(e,"[Content_Types].xml")),a=!1,i,l;if(n.workbooks.length===0&&(l="xl/workbook.xml",Kt(e,l,!0)&&n.workbooks.push(l)),n.workbooks.length===0){if(l="xl/workbook.bin",!Kt(e,l,!0))throw new Error("Could not find workbook");n.workbooks.push(l),a=!0}n.workbooks[0].slice(-3)=="bin"&&(a=!0);var c={},u={};if(!t.bookSheets&&!t.bookProps){if(Cl=[],n.sst)try{Cl=rz(Kt(e,vs(n.sst)),n.sst,t)}catch(Y){if(t.WTF)throw Y}t.cellStyles&&n.themes.length&&(c=tz(ls(e,n.themes[0].replace(/^\//,""),!0)||"",n.themes[0],t)),n.style&&(u=ez(Kt(e,vs(n.style)),n.style,c,t))}n.links.map(function(Y){try{var q=Tl(ls(e,hc(vs(Y))),Y);return az(Kt(e,vs(Y)),q,Y,t)}catch{}});var d=XU(Kt(e,vs(n.workbooks[0])),n.workbooks[0],t),f={},h="";n.coreprops.length&&(h=Kt(e,vs(n.coreprops[0]),!0),h&&(f=IN(h)),n.extprops.length!==0&&(h=Kt(e,vs(n.extprops[0]),!0),h&&UO(h,f,t)));var m={};(!t.bookSheets||t.bookProps)&&n.custprops.length!==0&&(h=ls(e,vs(n.custprops[0]),!0),h&&(m=$O(h,t)));var x={};if((t.bookSheets||t.bookProps)&&(d.Sheets?i=d.Sheets.map(function(q){return q.name}):f.Worksheets&&f.SheetNames.length>0&&(i=f.SheetNames),t.bookProps&&(x.Props=f,x.Custprops=m),t.bookSheets&&typeof i<"u"&&(x.SheetNames=i),t.bookSheets?x.SheetNames:t.bookProps))return x;i={};var p={};t.bookDeps&&n.calcchain&&(p=nz(Kt(e,vs(n.calcchain)),n.calcchain));var g=0,w={},v,y;{var b=d.Sheets;f.Worksheets=b.length,f.SheetNames=[];for(var S=0;S!=b.length;++S)f.SheetNames[S]=b[S].name}var k=a?"bin":"xml",_=n.workbooks[0].lastIndexOf("/"),N=(n.workbooks[0].slice(0,_+1)+"_rels/"+n.workbooks[0].slice(_+1)+".rels").replace(/^\//,"");Ss(e,N)||(N="xl/_rels/workbook."+k+".rels");var C=Tl(ls(e,N,!0),N.replace(/_rels.*/,"s5s"));(n.metadata||[]).length>=1&&(t.xlmeta=iz(Kt(e,vs(n.metadata[0])),n.metadata[0],t)),(n.people||[]).length>=1&&(t.people=zM(Kt(e,vs(n.people[0])),t)),C&&(C=j$(C,d.Sheets));var B=Kt(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(g=0;g!=f.Worksheets;++g){var H="sheet";if(C&&C[g]?(v="xl/"+C[g][1].replace(/[\/]?xl\//,""),Ss(e,v)||(v=C[g][1]),Ss(e,v)||(v=N.replace(/_rels\/.*$/,"")+C[g][1]),H=C[g][2]):(v="xl/worksheets/sheet"+(g+1-B)+"."+k,v=v.replace(/sheet0\./,"sheet.")),y=v.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(g!=t.sheets)continue e;break;case"string":if(f.SheetNames[g].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var V=!1,K=0;K!=t.sheets.length;++K)typeof t.sheets[K]=="number"&&t.sheets[K]==g&&(V=1),typeof t.sheets[K]=="string"&&t.sheets[K].toLowerCase()==f.SheetNames[g].toLowerCase()&&(V=1);if(!V)continue e}}T$(e,v,y,f.SheetNames[g],g,w,i,H,t,d,c,u)}return x={Directory:n,Workbook:d,Props:f,Custprops:m,Deps:p,Sheets:i,SheetNames:f.SheetNames,Strings:Cl,Styles:u,Themes:c,SSF:St($e)},t&&t.bookFiles&&(e.files?(x.keys=s,x.files=e.files):(x.keys=[],x.files={},e.FullPaths.forEach(function(Y,q){Y=Y.replace(/^Root Entry[\/]/,""),x.keys.push(Y),x.files[Y]=e.FileIndex[q]}))),t&&t.bookVBA&&(n.vba.length>0?x.vbaraw=Kt(e,vs(n.vba[0]),!0):n.defaults&&n.defaults.bin===XM&&(x.vbaraw=Kt(e,"xl/vbaProject.bin",!0))),x}function A$(e,t){var r=t||{},s="Workbook",n=Me.find(e,s);try{if(s="/!DataSpaces/Version",n=Me.find(e,s),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);if(iL(n.content),s="/!DataSpaces/DataSpaceMap",n=Me.find(e,s),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);var a=lL(n.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+s);if(s="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",n=Me.find(e,s),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);var i=cL(n.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+s);if(s="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",n=Me.find(e,s),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);dL(n.content)}catch{}if(s="/EncryptionInfo",n=Me.find(e,s),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);var l=fL(n.content);if(s="/EncryptedPackage",n=Me.find(e,s),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);if(l[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(l[1],n.content,r.password||"",r);if(l[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(l[1],n.content,r.password||"",r);throw new Error("File is password-protected")}function F$(e,t){return t.bookType=="ods"?qE(e,t):t.bookType=="numbers"?N$(e,t):t.bookType=="xlsb"?P$(e,t):R$(e,t)}function P$(e,t){Xi=1024,e&&!e.SSF&&(e.SSF=St($e)),e&&e.SSF&&(Lo(),x0(e.SSF),t.revssf=v0(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Al?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",s=yE.indexOf(t.bookType)>-1,n=Xx();ug(t=t||{});var a=Ox(),i="",l=0;if(t.cellXfs=[],Sa(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",Qe(a,i,ON(e.Props,t)),n.coreprops.push(i),ft(t.rels,2,i,rt.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,Qe(a,i,MN(e.Props)),n.extprops.push(i),ft(t.rels,3,i,rt.EXT_PROPS),e.Custprops!==e.Props&&Ut(e.Custprops||{}).length>0&&(i="docProps/custom.xml",Qe(a,i,BN(e.Custprops)),n.custprops.push(i),ft(t.rels,4,i,rt.CUST_PROPS)),l=1;l<=e.SheetNames.length;++l){var d={"!id":{}},f=e.Sheets[e.SheetNames[l-1]],h=(f||{})["!type"]||"sheet";switch(h){case"chart":default:i="xl/worksheets/sheet"+l+"."+r,Qe(a,i,lz(l-1,i,t,e,d)),n.sheets.push(i),ft(t.wbrels,-1,"worksheets/sheet"+l+"."+r,rt.WS[0])}if(f){var m=f["!comments"],x=!1,p="";m&&m.length>0&&(p="xl/comments"+l+"."+r,Qe(a,p,dz(m,p)),n.comments.push(p),ft(d,-1,"../comments"+l+"."+r,rt.CMNT),x=!0),f["!legacy"]&&x&&Qe(a,"xl/drawings/vmlDrawing"+l+".vml",gE(l,f["!comments"])),delete f["!comments"],delete f["!legacy"]}d["!id"].rId1&&Qe(a,hc(i),io(d))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,Qe(a,i,uz(t.Strings,i,t)),n.strs.push(i),ft(t.wbrels,-1,"sharedStrings."+r,rt.SST)),i="xl/workbook."+r,Qe(a,i,oz(e,i)),n.workbooks.push(i),ft(t.rels,1,i,rt.WB),i="xl/theme/theme1.xml",Qe(a,i,tg(e.Themes,t)),n.themes.push(i),ft(t.wbrels,-1,"theme/theme1.xml",rt.THEME),i="xl/styles."+r,Qe(a,i,cz(e,i,t)),n.styles.push(i),ft(t.wbrels,-1,"styles."+r,rt.STY),e.vbaraw&&s&&(i="xl/vbaProject.bin",Qe(a,i,e.vbaraw),n.vba.push(i),ft(t.wbrels,-1,"vbaProject.bin",rt.VBA)),i="xl/metadata."+r,Qe(a,i,fz(i)),n.metadata.push(i),ft(t.wbrels,-1,"metadata."+r,rt.XLMETA),Qe(a,"[Content_Types].xml",PN(n,t)),Qe(a,"_rels/.rels",io(t.rels)),Qe(a,"xl/_rels/workbook."+r+".rels",io(t.wbrels)),delete t.revssf,delete t.ssf,a}function R$(e,t){Xi=1024,e&&!e.SSF&&(e.SSF=St($e)),e&&e.SSF&&(Lo(),x0(e.SSF),t.revssf=v0(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Al?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",s=yE.indexOf(t.bookType)>-1,n=Xx();ug(t=t||{});var a=Ox(),i="",l=0;if(t.cellXfs=[],Sa(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",Qe(a,i,ON(e.Props,t)),n.coreprops.push(i),ft(t.rels,2,i,rt.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,Qe(a,i,MN(e.Props)),n.extprops.push(i),ft(t.rels,3,i,rt.EXT_PROPS),e.Custprops!==e.Props&&Ut(e.Custprops||{}).length>0&&(i="docProps/custom.xml",Qe(a,i,BN(e.Custprops)),n.custprops.push(i),ft(t.rels,4,i,rt.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,l=1;l<=e.SheetNames.length;++l){var f={"!id":{}},h=e.Sheets[e.SheetNames[l-1]],m=(h||{})["!type"]||"sheet";switch(m){case"chart":default:i="xl/worksheets/sheet"+l+"."+r,Qe(a,i,AE(l-1,t,e,f)),n.sheets.push(i),ft(t.wbrels,-1,"worksheets/sheet"+l+"."+r,rt.WS[0])}if(h){var x=h["!comments"],p=!1,g="";if(x&&x.length>0){var w=!1;x.forEach(function(v){v[1].forEach(function(y){y.T==!0&&(w=!0)})}),w&&(g="xl/threadedComments/threadedComment"+l+"."+r,Qe(a,g,UM(x,d,t)),n.threadedcomments.push(g),ft(f,-1,"../threadedComments/threadedComment"+l+"."+r,rt.TCMNT)),g="xl/comments"+l+"."+r,Qe(a,g,vE(x)),n.comments.push(g),ft(f,-1,"../comments"+l+"."+r,rt.CMNT),p=!0}h["!legacy"]&&p&&Qe(a,"xl/drawings/vmlDrawing"+l+".vml",gE(l,h["!comments"])),delete h["!comments"],delete h["!legacy"]}f["!id"].rId1&&Qe(a,hc(i),io(f))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,Qe(a,i,aE(t.Strings,t)),n.strs.push(i),ft(t.wbrels,-1,"sharedStrings."+r,rt.SST)),i="xl/workbook."+r,Qe(a,i,OE(e)),n.workbooks.push(i),ft(t.rels,1,i,rt.WB),i="xl/theme/theme1.xml",Qe(a,i,tg(e.Themes,t)),n.themes.push(i),ft(t.wbrels,-1,"theme/theme1.xml",rt.THEME),i="xl/styles."+r,Qe(a,i,hE(e,t)),n.styles.push(i),ft(t.wbrels,-1,"styles."+r,rt.STY),e.vbaraw&&s&&(i="xl/vbaProject.bin",Qe(a,i,e.vbaraw),n.vba.push(i),ft(t.wbrels,-1,"vbaProject.bin",rt.VBA)),i="xl/metadata."+r,Qe(a,i,xE()),n.metadata.push(i),ft(t.wbrels,-1,"metadata."+r,rt.XLMETA),d.length>1&&(i="xl/persons/person.xml",Qe(a,i,$M(d)),n.people.push(i),ft(t.wbrels,-1,"persons/person.xml",rt.PEOPLE)),Qe(a,"[Content_Types].xml",PN(n,t)),Qe(a,"_rels/.rels",io(t.rels)),Qe(a,"xl/_rels/workbook."+r+".rels",io(t.wbrels)),delete t.revssf,delete t.ssf,a}function dg(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=fs(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function I$(e,t){return Me.find(e,"EncryptedPackage")?A$(e,t):BE(e,t)}function O$(e,t){var r,s=e,n=t||{};return n.type||(n.type=Ze&&Buffer.isBuffer(e)?"buffer":"base64"),r=oN(s,n),C$(r,n)}function GE(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Om(e.slice(r),t);default:break e}return ko.to_workbook(e,t)}function D$(e,t){var r="",s=dg(e,t);switch(t.type){case"base64":r=fs(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=ai(e);break;default:throw new Error("Unrecognized type "+t.type)}return s[0]==239&&s[1]==187&&s[2]==191&&(r=xt(r)),t.type="binary",GE(r,t)}function L$(e,t){var r=e;return t.type=="base64"&&(r=fs(r)),r=oc.utils.decode(1200,r.slice(2),"str"),t.type="binary",GE(r,t)}function M$(e){return e.match(/[^\x00-\x7F]/)?ln(e):e}function Wf(e,t,r,s){return s?(r.type="string",ko.to_workbook(e,r)):ko.to_workbook(t,r)}function wc(e,t){Ax();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return wc(new Uint8Array(e),(r=St(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var s=e,n=[0,0,0,0],a=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),lo={},r.dateNF&&(lo.dateNF=r.dateNF),r.type||(r.type=Ze&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Ze?"buffer":"binary",s=PI(e),typeof Uint8Array<"u"&&!Ze&&(r.type="array")),r.type=="string"&&(a=!0,r.type="binary",r.codepage=65001,s=M$(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),l=new Uint8Array(i);if(l.foo="bar",!l.foo)return r=St(r),r.type="array",wc(Fx(s),r)}switch((n=dg(s,r))[0]){case 208:if(n[1]===207&&n[2]===17&&n[3]===224&&n[4]===161&&n[5]===177&&n[6]===26&&n[7]===225)return I$(Me.read(s,r),r);break;case 9:if(n[1]<=8)return BE(s,r);break;case 60:return Om(s,r);case 73:if(n[1]===73&&n[2]===42&&n[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(n[1]===68)return V8(s,r);break;case 84:if(n[1]===65&&n[2]===66&&n[3]===76)return sE.to_workbook(s,r);break;case 80:return n[1]===75&&n[2]<9&&n[3]<9?O$(s,r):Wf(e,s,r,a);case 239:return n[3]===60?Om(s,r):Wf(e,s,r,a);case 255:if(n[1]===254)return L$(s,r);if(n[1]===0&&n[2]===2&&n[3]===0)return Xa.to_workbook(s,r);break;case 0:if(n[1]===0&&(n[2]>=2&&n[3]===0||n[2]===0&&(n[3]===8||n[3]===9)))return Xa.to_workbook(s,r);break;case 3:case 131:case 139:case 140:return Im.to_workbook(s,r);case 123:if(n[1]===92&&n[2]===114&&n[3]===116)return uE.to_workbook(s,r);break;case 10:case 13:case 32:return D$(s,r);case 137:if(n[1]===80&&n[2]===78&&n[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return $8.indexOf(n[0])>-1&&n[2]<=12&&n[3]<=31?Im.to_workbook(s,r):Wf(e,s,r,a)}function KE(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Rc(t.file,Me.write(e,{type:Ze?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Me.write(e,t)}function B$(e,t){var r=St(t||{}),s=F$(e,r);return U$(s,r)}function U$(e,t){var r={},s=Ze?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=s;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=s;break;default:throw new Error("Unrecognized type "+t.type)}var n=e.FullPaths?Me.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof n=="string"){if(t.type=="binary"||t.type=="base64")return n;n=new Uint8Array(p0(n))}return t.password&&typeof encrypt_agile<"u"?KE(encrypt_agile(n,t.password),t):t.type==="file"?Rc(t.file,n):t.type=="string"?xt(n):n}function z$(e,t){var r=t||{},s=Mz(e,r);return KE(s,r)}function nn(e,t,r){r||(r="");var s=r+e;switch(t.type){case"base64":return lc(ln(s));case"binary":return ln(s);case"string":return e;case"file":return Rc(t.file,s,"utf8");case"buffer":return Ze?Dn(s,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(s):nn(s,{type:"binary"}).split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function $$(e,t){switch(t.type){case"base64":return lc(e);case"binary":return e;case"string":return e;case"file":return Rc(t.file,e,"binary");case"buffer":return Ze?Dn(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Au(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",s=0;s<e.length;++s)r+=String.fromCharCode(e[s]);return t.type=="base64"?lc(r):t.type=="string"?xt(r):r;case"file":return Rc(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function XE(e,t){Ax(),IU(e);var r=St(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var s=XE(e,r);return r.type="array",p0(s)}var n=0;if(r.sheet&&(typeof r.sheet=="number"?n=r.sheet:n=e.SheetNames.indexOf(r.sheet),!e.SheetNames[n]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return nn(Fz(e,r),r);case"slk":case"sylk":return nn(rE.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"htm":case"html":return nn(zE(e.Sheets[e.SheetNames[n]],r),r);case"txt":return $$(QE(e.Sheets[e.SheetNames[n]],r),r);case"csv":return nn(hg(e.Sheets[e.SheetNames[n]],r),r,"\uFEFF");case"dif":return nn(sE.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"dbf":return Au(Im.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"prn":return nn(ko.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"rtf":return nn(uE.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"eth":return nn(nE.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"fods":return nn(qE(e,r),r);case"wk1":return Au(Xa.sheet_to_wk1(e.Sheets[e.SheetNames[n]],r),r);case"wk3":return Au(Xa.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Au(UE(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),z$(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return B$(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function V$(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function fg(e,t,r){var s={};return s.type="file",s.file=t,V$(s),XE(e,s)}function W$(e,t,r,s,n,a,i,l){var c=Wt(r),u=l.defval,d=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),f=!0,h=n===1?[]:{};if(n!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!i||e[r])for(var m=t.s.c;m<=t.e.c;++m){var x=i?e[r][m]:e[s[m]+c];if(x===void 0||x.t===void 0){if(u===void 0)continue;a[m]!=null&&(h[a[m]]=u);continue}var p=x.v;switch(x.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(a[m]!=null){if(p==null)if(x.t=="e"&&p===null)h[a[m]]=null;else if(u!==void 0)h[a[m]]=u;else if(d&&p===null)h[a[m]]=null;else continue;else h[a[m]]=d&&(x.t!=="n"||x.t==="n"&&l.rawNumbers!==!1)?p:In(x,p,l);p!=null&&(f=!1)}}return{row:h,isempty:f}}function $d(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},s=0,n=1,a=[],i=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},d=u.range!=null?u.range:e["!ref"];switch(u.header===1?s=1:u.header==="A"?s=2:Array.isArray(u.header)?s=3:u.header==null&&(s=0),typeof d){case"string":c=ct(d);break;case"number":c=ct(e["!ref"]),c.s.r=d;break;default:c=d}s>0&&(n=0);var f=Wt(c.s.r),h=[],m=[],x=0,p=0,g=Array.isArray(e),w=c.s.r,v=0,y={};g&&!e[w]&&(e[w]=[]);var b=u.skipHidden&&e["!cols"]||[],S=u.skipHidden&&e["!rows"]||[];for(v=c.s.c;v<=c.e.c;++v)if(!(b[v]||{}).hidden)switch(h[v]=Pt(v),r=g?e[w][v]:e[h[v]+f],s){case 1:a[v]=v-c.s.c;break;case 2:a[v]=h[v];break;case 3:a[v]=u.header[v-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=i=In(r,null,u),p=y[i]||0,!p)y[i]=1;else{do l=i+"_"+p++;while(y[l]);y[i]=p,y[l]=1}a[v]=l}for(w=c.s.r+n;w<=c.e.r;++w)if(!(S[w]||{}).hidden){var k=W$(e,c,w,h,s,a,g,u);(k.isempty===!1||(s===1?u.blankrows!==!1:u.blankrows))&&(m[x++]=k.row)}return m.length=x,m}var Pw=/"/g;function q$(e,t,r,s,n,a,i,l){for(var c=!0,u=[],d="",f=Wt(r),h=t.s.c;h<=t.e.c;++h)if(s[h]){var m=l.dense?(e[r]||[])[h]:e[s[h]+f];if(m==null)d="";else if(m.v!=null){c=!1,d=""+(l.rawNumbers&&m.t=="n"?m.v:In(m,null,l));for(var x=0,p=0;x!==d.length;++x)if((p=d.charCodeAt(x))===n||p===a||p===34||l.forceQuotes){d='"'+d.replace(Pw,'""')+'"';break}d=="ID"&&(d='"ID"')}else m.f!=null&&!m.F?(c=!1,d="="+m.f,d.indexOf(",")>=0&&(d='"'+d.replace(Pw,'""')+'"')):d="";u.push(d)}return l.blankrows===!1&&c?null:u.join(i)}function hg(e,t){var r=[],s=t??{};if(e==null||e["!ref"]==null)return"";var n=ct(e["!ref"]),a=s.FS!==void 0?s.FS:",",i=a.charCodeAt(0),l=s.RS!==void 0?s.RS:`
`,c=l.charCodeAt(0),u=new RegExp((a=="|"?"\\|":a)+"+$"),d="",f=[];s.dense=Array.isArray(e);for(var h=s.skipHidden&&e["!cols"]||[],m=s.skipHidden&&e["!rows"]||[],x=n.s.c;x<=n.e.c;++x)(h[x]||{}).hidden||(f[x]=Pt(x));for(var p=0,g=n.s.r;g<=n.e.r;++g)(m[g]||{}).hidden||(d=q$(e,n,g,f,i,c,a,s),d!=null&&(s.strip&&(d=d.replace(u,"")),(d||s.blankrows!==!1)&&r.push((p++?l:"")+d)));return delete s.dense,r.join("")}function QE(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=hg(e,t);return r}function H$(e){var t="",r,s="";if(e==null||e["!ref"]==null)return[];var n=ct(e["!ref"]),a="",i=[],l,c=[],u=Array.isArray(e);for(l=n.s.c;l<=n.e.c;++l)i[l]=Pt(l);for(var d=n.s.r;d<=n.e.r;++d)for(a=Wt(d),l=n.s.c;l<=n.e.c;++l)if(t=i[l]+a,r=u?(e[d]||[])[l]:e[t],s="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;s=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)s=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)s=""+r.v;else if(r.t=="b")s=r.v?"TRUE":"FALSE";else if(r.w!==void 0)s="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?s="'"+r.v:s=""+r.v}}c[c.length]=t+"="+s}return c}function YE(e,t,r){var s=r||{},n=+!s.skipHeader,a=e||{},i=0,l=0;if(a&&s.origin!=null)if(typeof s.origin=="number")i=s.origin;else{var c=typeof s.origin=="string"?Rt(s.origin):s.origin;i=c.r,l=c.c}var u,d={s:{c:0,r:0},e:{c:l,r:i+t.length-1+n}};if(a["!ref"]){var f=ct(a["!ref"]);d.e.c=Math.max(d.e.c,f.e.c),d.e.r=Math.max(d.e.r,f.e.r),i==-1&&(i=f.e.r+1,d.e.r=i+t.length-1+n)}else i==-1&&(i=0,d.e.r=t.length-1+n);var h=s.header||[],m=0;t.forEach(function(p,g){Ut(p).forEach(function(w){(m=h.indexOf(w))==-1&&(h[m=h.length]=w);var v=p[w],y="z",b="",S=Ve({c:l+m,r:i+g+n});u=bc(a,S),v&&typeof v=="object"&&!(v instanceof Date)?a[S]=v:(typeof v=="number"?y="n":typeof v=="boolean"?y="b":typeof v=="string"?y="s":v instanceof Date?(y="d",s.cellDates||(y="n",v=nr(v)),b=s.dateNF||$e[14]):v===null&&s.nullError&&(y="e",v=0),u?(u.t=y,u.v=v,delete u.w,delete u.R,b&&(u.z=b)):a[S]=u={t:y,v},b&&(u.z=b))})}),d.e.c=Math.max(d.e.c,l+h.length-1);var x=Wt(i);if(n)for(m=0;m<h.length;++m)a[Pt(m+l)+x]={t:"s",v:h[m]};return a["!ref"]=Ke(d),a}function G$(e,t){return YE(null,e,t)}function bc(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var s=Rt(t);return e[s.r]||(e[s.r]=[]),e[s.r][s.c]||(e[s.r][s.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?bc(e,Ve(t)):bc(e,Ve({r:t,c:r||0}))}function K$(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function mg(){return{SheetNames:[],Sheets:{}}}function pg(e,t,r,s){var n=1;if(!r)for(;n<=65535&&e.SheetNames.indexOf(r="Sheet"+n)!=-1;++n,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(s&&e.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);n=a&&+a[2]||0;var i=a&&a[1]||r;for(++n;n<=65535&&e.SheetNames.indexOf(r=i+n)!=-1;++n);}if(IE(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function X$(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var s=K$(e,t);switch(e.Workbook.Sheets[s]||(e.Workbook.Sheets[s]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[s].Hidden=r}function Q$(e,t){return e.z=t,e}function JE(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function Y$(e,t,r){return JE(e,"#"+t,r)}function J$(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function Z$(e,t,r,s){for(var n=typeof t!="string"?t:ct(t),a=typeof t=="string"?t:Ke(t),i=n.s.r;i<=n.e.r;++i)for(var l=n.s.c;l<=n.e.c;++l){var c=bc(e,i,l);c.t="n",c.F=a,delete c.v,i==n.s.r&&l==n.s.c&&(c.f=r,s&&(c.D=!0))}return e}var it={encode_col:Pt,encode_row:Wt,encode_cell:Ve,encode_range:Ke,decode_col:Vx,decode_row:$x,split_cell:uO,decode_cell:Rt,decode_range:Zr,format_cell:In,sheet_add_aoa:NN,sheet_add_json:YE,sheet_add_dom:$E,aoa_to_sheet:Mo,json_to_sheet:G$,table_to_sheet:VE,table_to_book:i$,sheet_to_csv:hg,sheet_to_txt:QE,sheet_to_json:$d,sheet_to_html:zE,sheet_to_formulae:H$,sheet_to_row_object_array:$d,sheet_get_cell:bc,book_new:mg,book_append_sheet:pg,book_set_sheet_visibility:X$,cell_set_number_format:Q$,cell_set_hyperlink:JE,cell_set_internal_link:Y$,cell_add_comment:J$,sheet_set_array_formula:Z$,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};async function eV(e,t){let r=se.from("quotes").select("*").eq("project_id",e);const{data:s,error:n}=await r;if(n)throw new Error(`Failed to fetch quotes: ${n.message}`);if(!s||s.length===0)return tV(e,t);const a=s,i=a.map(y=>y.id),{data:l,error:c}=await se.from("quote_items").select("*").in("quote_id",i).eq("is_excluded",!1);if(c)throw new Error(`Failed to fetch quote items: ${c.message}`);const u=l||[],d=a.map(y=>({quoteId:y.id,supplierName:y.supplier_name})),f=rV(a,u),h=sV(a,u),m=nV(a,u),x=aV(a,u),p=iV(a,u),g=oV(u),w=lV(a),v=cV(a,u);return{projectId:e,quoteIds:t,quotesAnalyzed:a.length,analyzedAt:new Date().toISOString(),summary:{totalRedFlags:f.length,criticalIssues:f.filter(y=>y.severity==="critical").length,coverageScore:p,averageQualityScore:g,bestValueSupplier:w,mostCompleteSupplier:v},redFlags:f,coverageGaps:h,systemsDetected:m,supplierInsights:x,normalizedItems:d}}function tV(e,t){return{projectId:e,quoteIds:t,quotesAnalyzed:0,analyzedAt:new Date().toISOString(),summary:{totalRedFlags:0,criticalIssues:0,coverageScore:0,averageQualityScore:0,bestValueSupplier:"N/A",mostCompleteSupplier:"N/A"},redFlags:[],coverageGaps:[],systemsDetected:[],supplierInsights:[],normalizedItems:[]}}function rV(e,t){const r=[];for(const s of e){const n=t.filter(f=>f.quote_id===s.id),a=n.reduce((f,h)=>f+(h.total_price||0),0),i=s.quoted_total||s.total_amount||0,l=Math.abs(a-i),c=i>0?l/i*100:0;c>10&&r.push({id:`price-discrepancy-${s.id}`,quoteId:s.id,severity:c>20?"critical":"high",category:"Pricing",title:"Significant Price Discrepancy",description:`Quote total ($${i.toLocaleString()}) differs from line items sum ($${a.toLocaleString()}) by ${c.toFixed(1)}%`,recommendation:"Verify quoted total matches line items. Check for missing items or calculation errors."}),n.length===0&&r.push({id:`no-items-${s.id}`,quoteId:s.id,severity:"critical",category:"Completeness",title:"No Line Items",description:"Quote contains no line items",recommendation:"Ensure quote has been properly imported with all line items."});const u=n.filter(f=>!f.unit_price||f.unit_price===0);u.length>0&&r.push({id:`missing-prices-${s.id}`,quoteId:s.id,severity:u.length>n.length*.1?"high":"medium",category:"Pricing",title:"Items Missing Unit Prices",description:`${u.length} items have no unit price specified`,recommendation:"Request unit prices for all items to enable accurate comparison."});const d=n.filter(f=>f.confidence!==null&&f.confidence<.7);d.length>n.length*.2&&r.push({id:`low-confidence-${s.id}`,quoteId:s.id,severity:"medium",category:"Data Quality",title:"Poor Data Normalization Quality",description:`${Math.round(d.length/n.length*100)}% of items have low confidence scores`,recommendation:"Review and manually correct items with low confidence scores for better comparison accuracy."}),(!s.contingency_amount||s.contingency_amount===0)&&r.push({id:`no-contingency-${s.id}`,quoteId:s.id,severity:"low",category:"Commercial",title:"No Contingency Specified",description:"Quote does not include a contingency amount",recommendation:"Confirm if contingency is included in pricing or needs to be added separately."})}return r}function sV(e,t){const r=[];if(e.length<2)return r;const s=new Map;for(const n of t){const a=n.scope_category||"Uncategorized";s.has(a)||s.set(a,new Map);const i=s.get(a);i.has(n.quote_id)||i.set(n.quote_id,new Set),i.get(n.quote_id).add(n.description.toLowerCase().trim())}for(const[n,a]of s){const i=Array.from(a.keys());if(i.length<e.length){const l=e.filter(c=>!i.includes(c.id));r.push({id:`missing-category-${n}`,gapType:"Missing Category",title:`Category "${n}" not quoted by all suppliers`,description:`${l.length} supplier(s) did not quote this category`,missingIn:l.map(c=>c.supplier_name),presentIn:e.filter(c=>i.includes(c.id)).map(c=>c.supplier_name),estimatedImpact:0,recommendation:"Request quotes for this category from suppliers who did not include it."})}}return r}function nV(e,t){const r=[],s=new Map;for(const n of t)if(n.system_label&&n.system_id){const a=`${n.quote_id}-${n.system_id}`;s.has(a)||s.set(a,{quoteId:n.quote_id,items:[]}),s.get(a).items.push(n)}for(const[n,{quoteId:a,items:i}]of s){const l=i.reduce((u,d)=>u+(d.total_price||0),0),c=i.reduce((u,d)=>u+(d.confidence||0),0)/i.length;r.push({id:n,quoteId:a,systemName:i[0].system_label,systemType:i[0].system_id.split("-")[0]||"Unknown",itemCount:i.length,totalValue:l,confidence:c})}return r.sort((n,a)=>a.totalValue-n.totalValue)}function aV(e,t){const r=[];for(const s of e){const n=t.filter(c=>c.quote_id===s.id);if(n.length===0)continue;n.reduce((c,u)=>c+(u.unit_price||0),0)/n.length,n.filter(c=>c.unit_price>0).length/n.length*100===100&&r.push({id:`complete-${s.id}`,supplierName:s.supplier_name,insightType:"Positive",title:"Complete Pricing",description:"All items have unit prices specified, enabling full comparison.",recommendation:"This supplier has provided comprehensive pricing information."});const i=new Set(n.map(c=>c.scope_category)).size;i>5&&r.push({id:`comprehensive-${s.id}`,supplierName:s.supplier_name,insightType:"Positive",title:"Comprehensive Quote",description:`Quote covers ${i} different scope categories.`,recommendation:"This supplier has provided broad coverage across multiple work areas."});const l=new Set(n.filter(c=>c.system_id).map(c=>c.system_id)).size;l>3&&r.push({id:`systems-${s.id}`,supplierName:s.supplier_name,insightType:"Positive",title:"Multiple Systems Identified",description:`${l} fire protection systems detected in quote.`,recommendation:"Items have been successfully mapped to fire protection systems."})}return r}function iV(e,t){if(e.length===0)return 0;const r=new Set(t.map(n=>n.scope_category||"Uncategorized"));let s=0;for(const n of e){const a=t.filter(c=>c.quote_id===n.id),l=new Set(a.map(c=>c.scope_category||"Uncategorized")).size/r.size*100;s+=l}return Math.round(s/e.length)}function oV(e){if(e.length===0)return 0;const t=e.filter(l=>l.unit_price>0).length,r=e.filter(l=>l.system_id).length,s=e.reduce((l,c)=>l+(c.confidence||0),0)/e.length,n=t/e.length*40,a=r/e.length*30,i=s*30;return Math.round(n+a+i)}function lV(e){return e.length===0?"N/A":e.reduce((r,s)=>s.total_amount<r.total_amount?s:r).supplier_name}function cV(e,t){if(e.length===0)return"N/A";let r=e[0],s=0;for(const n of e){const a=t.filter(l=>l.quote_id===n.id),i=a.length+a.filter(l=>l.unit_price>0).length*2+a.filter(l=>l.system_id).length;i>s&&(s=i,r=n)}return r.supplier_name}async function uV(e,t){return eV(e,t)}function dV({projectId:e,projectName:t,onNavigateBack:r,onNavigateNext:s}){const[n,a]=j.useState(null),[i,l]=j.useState(!0),[c,u]=j.useState(null);j.useEffect(()=>{d()},[e]);const d=async()=>{l(!0),u(null);try{const v=await uV(e);a(v)}catch(v){u(v instanceof Error?v.message:"Failed to analyze quotes"),console.error("Quote intelligence error:",v)}finally{l(!1)}},f=()=>{window.print()},h=()=>{window.print()},m=()=>{if(!n)return;const v=it.book_new(),y=[["Quote Intelligence Report"],["Project:",t||"Unknown"],["Generated:",new Date(n.analyzedAt).toLocaleString()],[],["Summary"],["Quotes Analyzed:",n.quotesAnalyzed],["Total Red Flags:",n.summary.totalRedFlags],["Critical Issues:",n.summary.criticalIssues],["Coverage Score:",`${n.summary.coverageScore}%`],["Average Quality Score:",`${n.summary.averageQualityScore}%`],["Best Value Supplier:",n.summary.bestValueSupplier],["Most Complete Supplier:",n.summary.mostCompleteSupplier]],b=it.aoa_to_sheet(y);it.book_append_sheet(v,b,"Summary");const S=[["Severity","Category","Title","Description","Supplier","Recommendation"],...n.redFlags.map(V=>{const K=n.normalizedItems.find(Y=>Y.quoteId===V.quoteId);return[V.severity,V.category,V.title,V.description,(K==null?void 0:K.supplierName)||"Unknown",V.recommendation]})],k=it.aoa_to_sheet(S);it.book_append_sheet(v,k,"Red Flags");const _=[["System Name","System Type","Supplier","Item Count","Total Value","Confidence"],...n.systemsDetected.map(V=>{const K=n.normalizedItems.find(Y=>Y.quoteId===V.quoteId);return[V.systemName,V.systemType,(K==null?void 0:K.supplierName)||"Unknown",V.itemCount,`$${V.totalValue.toLocaleString()}`,`${(V.confidence*100).toFixed(1)}%`]})],N=it.aoa_to_sheet(_);it.book_append_sheet(v,N,"Systems Detected");const C=[["Supplier","Type","Title","Description","Recommendation"],...n.supplierInsights.map(V=>[V.supplierName,V.insightType,V.title,V.description,V.recommendation])],B=it.aoa_to_sheet(C);it.book_append_sheet(v,B,"Supplier Insights");const H=`${t}_QuoteIntelligence.xlsx`;fg(v,H)},x=v=>({critical:v.filter(y=>y.severity==="critical"),high:v.filter(y=>y.severity==="high"),medium:v.filter(y=>y.severity==="medium"),low:v.filter(y=>y.severity==="low")}),p=()=>{if(!n)return[];const v=new Map;n.normalizedItems.forEach(b=>{v.has(b.quoteId)||v.set(b.quoteId,{name:b.supplierName,qualityScore:0,coverageScore:0,redFlags:0})}),n.redFlags.forEach(b=>{const S=v.get(b.quoteId);S&&S.redFlags++});const y=Array.from(v.values());return y.forEach(b=>{b.qualityScore=Math.max(0,100-b.redFlags*10),b.coverageScore=n.summary.coverageScore}),y.sort((b,S)=>S.qualityScore-b.qualityScore)};if(i)return o.jsx("div",{className:"flex items-center justify-center h-64",children:o.jsxs("div",{className:"text-center",children:[o.jsx(js,{className:"animate-spin mx-auto mb-4 text-blue-600",size:40}),o.jsx("p",{className:"text-lg font-medium text-gray-900",children:"Analyzing Quotes..."})]})});if(c||!n)return o.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx(_n,{className:"text-red-600 flex-shrink-0",size:24}),o.jsxs("div",{children:[o.jsx("h3",{className:"font-semibold text-red-900 mb-1",children:"Analysis Error"}),o.jsx("p",{className:"text-sm text-red-800",children:c||"No analysis data available"}),o.jsx("button",{onClick:d,className:"mt-3 px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 text-sm",children:"Retry Analysis"})]})]})});const g=x(n.redFlags),w=p();return o.jsxs("div",{className:"space-y-8",children:[o.jsx(m0,{currentStep:"quoteintel",onNavigateBack:r,onNavigateNext:s}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 print:shadow-none",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Quote Intelligence"}),o.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Automated analysis of supplier quotes"})]}),o.jsxs("div",{className:"flex gap-2 print:hidden",children:[o.jsxs("button",{onClick:m,className:"flex items-center gap-2 px-3 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 transition-colors text-sm",children:[o.jsx(fi,{size:16}),"Export Excel"]}),o.jsxs("button",{onClick:h,className:"flex items-center gap-2 px-3 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 transition-colors text-sm",children:[o.jsx(NF,{size:16}),"Export PDF"]}),o.jsxs("button",{onClick:f,className:"flex items-center gap-2 px-3 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 transition-colors text-sm",children:[o.jsx(px,{size:16}),"Print"]})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-6",children:[o.jsx("div",{className:"bg-white rounded-2xl border border-gray-200 p-5 hover:shadow-md transition-shadow",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Issues Found"}),o.jsx("div",{className:"text-3xl font-bold text-gray-900",children:n.summary.totalRedFlags})]}),o.jsx("div",{className:"w-12 h-12 bg-orange-50 rounded-xl flex items-center justify-center",children:o.jsx(_n,{className:"text-orange-600",size:24})})]})}),o.jsx("div",{className:"bg-white rounded-2xl border border-gray-200 p-5 hover:shadow-md transition-shadow",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Critical Risks"}),o.jsx("div",{className:"text-3xl font-bold text-gray-900",children:n.summary.criticalIssues})]}),o.jsx("div",{className:"w-12 h-12 bg-red-50 rounded-xl flex items-center justify-center",children:o.jsx(Je,{className:"text-red-600",size:24})})]})}),o.jsx("div",{className:"bg-white rounded-2xl border border-gray-200 p-5 hover:shadow-md transition-shadow",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Top Supplier"}),o.jsx("div",{className:"text-xl font-bold text-gray-900 truncate",children:n.summary.mostCompleteSupplier})]}),o.jsx("div",{className:"w-12 h-12 bg-blue-50 rounded-xl flex items-center justify-center",children:o.jsx(UF,{className:"text-blue-600",size:24})})]})})]})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 print:shadow-none",children:[o.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Supplier Comparison"}),w.length===0?o.jsx("p",{className:"text-gray-600 py-4",children:"No supplier data available."}):o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full",children:[o.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Supplier"}),o.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Quality Score"}),o.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Coverage Score"}),o.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Red Flags"})]})}),o.jsx("tbody",{className:"divide-y divide-gray-200",children:w.map((v,y)=>o.jsxs("tr",{className:"hover:bg-gray-50",children:[o.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:v.name}),o.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-2 max-w-[120px]",children:o.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${v.qualityScore}%`}})}),o.jsxs("span",{className:"font-medium",children:[v.qualityScore,"%"]})]})}),o.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-2 max-w-[120px]",children:o.jsx("div",{className:"bg-green-600 h-2 rounded-full",style:{width:`${v.coverageScore}%`}})}),o.jsxs("span",{className:"font-medium",children:[v.coverageScore,"%"]})]})}),o.jsx("td",{className:"px-4 py-3 text-sm",children:o.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${v.redFlags===0?"bg-green-100 text-green-800":v.redFlags<=2?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:v.redFlags})})]},y))})]})})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 print:shadow-none print:break-after-page",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[o.jsx(_n,{className:"text-red-600",size:24}),o.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Red Flags"})]}),n.redFlags.length===0?o.jsxs("div",{className:"text-center py-8",children:[o.jsx(tr,{className:"mx-auto text-green-600 mb-3",size:48}),o.jsx("p",{className:"text-gray-900 font-medium",children:"No red flags detected"}),o.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"All quotes passed automated quality checks"})]}):o.jsxs("div",{className:"space-y-6",children:[g.critical.length>0&&o.jsxs("div",{children:[o.jsxs("h3",{className:"text-lg font-semibold text-red-900 mb-3 flex items-center gap-2",children:[o.jsx(Je,{size:20}),"Critical (",g.critical.length,")"]}),o.jsx("div",{className:"space-y-3",children:g.critical.map(v=>{const y=n.normalizedItems.find(b=>b.quoteId===v.quoteId);return o.jsxs("div",{className:"border border-red-300 rounded-lg p-4 bg-red-50",children:[o.jsx("div",{className:"flex items-start justify-between mb-2",children:o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[o.jsx("span",{className:"text-xs font-bold uppercase px-2 py-1 bg-red-600 text-white rounded",children:v.severity}),o.jsx("span",{className:"text-sm font-medium text-red-900",children:v.category})]}),o.jsx("h4",{className:"font-semibold text-gray-900",children:v.title}),o.jsx("p",{className:"text-sm text-gray-700 mt-1",children:(y==null?void 0:y.supplierName)||"Unknown Supplier"})]})}),o.jsx("p",{className:"text-sm text-gray-800 mb-2",children:v.description}),v.recommendation&&o.jsxs("div",{className:"mt-3 pt-3 border-t border-red-200",children:[o.jsx("p",{className:"text-sm font-medium text-gray-900 mb-1",children:"Recommendation:"}),o.jsx("p",{className:"text-sm text-gray-700",children:v.recommendation})]})]},v.id)})})]}),g.high.length>0&&o.jsxs("div",{children:[o.jsxs("h3",{className:"text-lg font-semibold text-orange-900 mb-3 flex items-center gap-2",children:[o.jsx(_n,{size:20}),"High (",g.high.length,")"]}),o.jsx("div",{className:"space-y-3",children:g.high.map(v=>{const y=n.normalizedItems.find(b=>b.quoteId===v.quoteId);return o.jsxs("div",{className:"border border-orange-300 rounded-lg p-4 bg-orange-50",children:[o.jsx("div",{className:"flex items-start justify-between mb-2",children:o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[o.jsx("span",{className:"text-xs font-bold uppercase px-2 py-1 bg-orange-600 text-white rounded",children:v.severity}),o.jsx("span",{className:"text-sm font-medium text-orange-900",children:v.category})]}),o.jsx("h4",{className:"font-semibold text-gray-900",children:v.title}),o.jsx("p",{className:"text-sm text-gray-700 mt-1",children:(y==null?void 0:y.supplierName)||"Unknown Supplier"})]})}),o.jsx("p",{className:"text-sm text-gray-800 mb-2",children:v.description}),v.recommendation&&o.jsxs("div",{className:"mt-3 pt-3 border-t border-orange-200",children:[o.jsx("p",{className:"text-sm font-medium text-gray-900 mb-1",children:"Recommendation:"}),o.jsx("p",{className:"text-sm text-gray-700",children:v.recommendation})]})]},v.id)})})]}),g.medium.length>0&&o.jsxs("div",{children:[o.jsxs("h3",{className:"text-lg font-semibold text-yellow-900 mb-3",children:["Medium (",g.medium.length,")"]}),o.jsx("div",{className:"space-y-2",children:g.medium.map(v=>{const y=n.normalizedItems.find(b=>b.quoteId===v.quoteId);return o.jsxs("div",{className:"border border-yellow-300 rounded-lg p-3 bg-yellow-50",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[o.jsx("span",{className:"text-xs font-bold uppercase px-2 py-0.5 bg-yellow-600 text-white rounded",children:v.severity}),o.jsx("span",{className:"text-sm font-semibold text-gray-900",children:v.title}),o.jsxs("span",{className:"text-sm text-gray-600",children:[" ",(y==null?void 0:y.supplierName)||"Unknown"]})]}),o.jsx("p",{className:"text-sm text-gray-700",children:v.description})]},v.id)})})]}),g.low.length>0&&o.jsxs("div",{children:[o.jsxs("h3",{className:"text-lg font-semibold text-blue-900 mb-3",children:["Low (",g.low.length,")"]}),o.jsx("div",{className:"space-y-2",children:g.low.map(v=>{const y=n.normalizedItems.find(b=>b.quoteId===v.quoteId);return o.jsxs("div",{className:"border border-blue-200 rounded-lg p-3 bg-blue-50",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[o.jsx("span",{className:"text-xs font-bold uppercase px-2 py-0.5 bg-blue-600 text-white rounded",children:v.severity}),o.jsx("span",{className:"text-sm font-semibold text-gray-900",children:v.title}),o.jsxs("span",{className:"text-sm text-gray-600",children:[" ",(y==null?void 0:y.supplierName)||"Unknown"]})]}),o.jsx("p",{className:"text-sm text-gray-700",children:v.description})]},v.id)})})]})]})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 print:shadow-none",children:[o.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Recommended Actions"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:border-blue-300 hover:shadow-md transition-all",children:[o.jsxs("div",{className:"flex items-start justify-between mb-3",children:[o.jsx("div",{className:"w-10 h-10 bg-blue-50 rounded-lg flex items-center justify-center",children:o.jsx(fm,{className:"text-blue-600",size:20})}),o.jsx(Gu,{className:"text-gray-400",size:18})]}),o.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Normalise Remaining Items"}),o.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Ensure all line items have standardized units and attributes for accurate comparison."}),o.jsx("button",{onClick:r,className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:"Go to Review & Clean "})]}),o.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:border-green-300 hover:shadow-md transition-all",children:[o.jsxs("div",{className:"flex items-start justify-between mb-3",children:[o.jsx("div",{className:"w-10 h-10 bg-green-50 rounded-lg flex items-center justify-center",children:o.jsx(si,{className:"text-green-600",size:20})}),o.jsx(Gu,{className:"text-gray-400",size:18})]}),o.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Map Unmapped Systems"}),o.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Complete system mapping to improve coverage analysis and reporting accuracy."}),o.jsx("button",{onClick:r,className:"text-sm text-green-600 hover:text-green-700 font-medium",children:"Go to Review & Clean "})]}),o.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:border-purple-300 hover:shadow-md transition-all",children:[o.jsxs("div",{className:"flex items-start justify-between mb-3",children:[o.jsx("div",{className:"w-10 h-10 bg-purple-50 rounded-lg flex items-center justify-center",children:o.jsx(sc,{className:"text-purple-600",size:20})}),o.jsx(Gu,{className:"text-gray-400",size:18})]}),o.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Review Problematic Rows"}),o.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Address flagged items to improve quote quality before generating reports."}),o.jsx("button",{onClick:r,className:"text-sm text-purple-600 hover:text-purple-700 font-medium",children:"Go to Review & Clean "})]})]})]}),n.coverageGaps&&n.coverageGaps.length>0&&o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 print:shadow-none print:break-after-page",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[o.jsx(fm,{className:"text-orange-600",size:24}),o.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Coverage Gaps"})]}),o.jsx("div",{className:"space-y-3",children:n.coverageGaps.map(v=>o.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50",children:[o.jsx("div",{className:"flex items-start justify-between mb-2",children:o.jsxs("div",{className:"flex-1",children:[o.jsx("div",{className:"flex items-center gap-2 mb-1",children:o.jsx("span",{className:"text-xs font-medium uppercase px-2 py-1 bg-gray-600 text-white rounded",children:v.gapType})}),o.jsx("h4",{className:"font-semibold text-gray-900",children:v.title})]})}),o.jsx("p",{className:"text-sm text-gray-700 mb-2",children:v.description}),v.recommendation&&o.jsxs("div",{className:"mt-2 pt-2 border-t border-gray-300",children:[o.jsx("p",{className:"text-sm font-medium text-gray-900 mb-1",children:"Recommendation:"}),o.jsx("p",{className:"text-sm text-gray-700",children:v.recommendation})]})]},v.id))})]})]})}function fV(e){return o.jsx(dV,{...e})}async function hV(e){return{}}async function mV(e,t){return null}function xg(e){return{loadSettings:async()=>{console.log("ModelRateProvider: loadSettings called for project",e)},getModelRate:t=>{const{data:r}={data:{rate:null,componentCount:null}};return r},getRate:async t=>mV(),getRates:async()=>hV()}}async function ZE(e,t,r){console.log("compareAgainstModelHybrid: Processing",e.length,"lines"),console.log("compareAgainstModelHybrid: Mappings:",t.length),console.log("compareAgainstModelHybrid: Sample mapping:",t[0]);const s=[];let n=0,a=0;for(const i of e){const l=t.find(x=>x.quoteItemId===i.quoteItemId);if(!l){console.warn("compareAgainstModelHybrid: No mapping found for quote item:",i.quoteItemId),n++,s.push({quoteId:i.quoteId,quoteItemId:i.quoteItemId,supplier:i.supplier,systemId:"UNMAPPED",systemLabel:"Unmapped Items",section:i.section,service:i.service||i.serviceType,subclass:i.subclass,frr:i.frr,sizeBucket:i.size,quantity:i.quantity,unitRate:i.rate,total:i.total,modelRate:null,componentCount:null,variancePct:null,flag:"NA"});continue}if(!l.systemId){n<3&&console.warn("compareAgainstModelHybrid: Mapping has no systemId:",{quoteItemId:l.quoteItemId,systemId:l.systemId,systemLabel:l.systemLabel}),n++,s.push({quoteId:i.quoteId,quoteItemId:i.quoteItemId,supplier:i.supplier,systemId:"UNMAPPED",systemLabel:"Unmapped Items",section:i.section,service:i.service||i.serviceType,subclass:i.subclass,frr:i.frr,sizeBucket:i.size,quantity:i.quantity,unitRate:i.rate,total:i.total,modelRate:null,componentCount:null,variancePct:null,flag:"NA"});continue}a++;const c={systemId:l.systemId,section:i.section,service:i.service||i.serviceType,subclass:i.subclass,frr:i.frr,size:i.size},u=r(c),d=(u==null?void 0:u.rate)||null,f=(u==null?void 0:u.componentCount)||null;let h=null,m="NA";d!==null&&i.rate>0&&(h=(i.rate-d)/d*100,Math.abs(h)<=10?m="GREEN":Math.abs(h)<=25?m="AMBER":m="RED"),s.push({quoteId:i.quoteId,quoteItemId:i.quoteItemId,supplier:i.supplier,systemId:l.systemId,systemLabel:l.systemLabel||"",section:i.section,service:i.service||i.serviceType,subclass:i.subclass,frr:i.frr,sizeBucket:i.size,quantity:i.quantity,unitRate:i.rate,total:i.total,modelRate:d,componentCount:f,variancePct:h,flag:m})}return console.log("compareAgainstModelHybrid: Generated",s.length,"comparison rows"),console.log("compareAgainstModelHybrid: Mapped items:",a),console.log("compareAgainstModelHybrid: Unmapped items:",n),s.length>0&&console.log("compareAgainstModelHybrid: Sample comparison row:",s[0]),s}function pV(e){const[t,r]=j.useState([]),[s,n]=j.useState(!0),[a,i]=j.useState(null),l=async()=>{if(!e){n(!1);return}n(!0),i(null);try{const{data:c}=await se.from("quotes").select("id, supplier_name").eq("project_id",e);if(!c||c.length===0){r([]),n(!1);return}const u=c.map(g=>g.id),{data:d,error:f}=await se.from("quote_items").select("id, description, unit_price, system_id, quantity, quote_id").in("quote_id",u);if(f)throw f;if(!d||d.length===0){r([]),n(!1);return}const m=d.map(g=>{const w=c.find(v=>v.id===g.quote_id);return{...g,supplier_name:(w==null?void 0:w.supplier_name)||"Unknown"}}).filter(g=>jx(g)?!1:!g.system_id||g.system_id===""||g.system_id==="unknown"),x=new Map;m.forEach(g=>{const w=KR(g.description);w&&(x.has(w)||x.set(w,[]),x.get(w).push(g))});const p=[];x.forEach((g,w)=>{if(g.length<2)return;const v=[...new Set(g.map(N=>N.supplier_name))],y=g.map(N=>N.unit_price).filter(N=>N>0),b=y.length>0?Math.min(...y):0,S=y.length>0?Math.max(...y):0,k=g[0].description,_=XR(k);p.push({key:w,defaultName:_,exampleDescription:k,suppliers:v,count:g.length,rateMin:b,rateMax:S,itemIds:g.map(N=>N.id)})}),p.sort((g,w)=>w.count-g.count),r(p)}catch(c){console.error("Error loading suggested systems:",c),i(c instanceof Error?c.message:"Failed to load suggestions")}finally{n(!1)}};return j.useEffect(()=>{l()},[e]),{suggestions:t,loading:s,error:a,reload:l}}function xV(){return null}const gV=e=>{switch(e){case"GREEN":return"bg-green-100 text-green-900 border-green-300";case"AMBER":return"bg-amber-100 text-amber-900 border-amber-300";case"RED":return"bg-red-100 text-red-900 border-red-300";default:return"bg-gray-100 text-gray-600 border-gray-300"}};function qf(e){return e.parse_status==="completed"&&e.items_count>0}function vV({projectId:e,onNavigateBack:t,onNavigateNext:r}){const[s,n]=j.useState([]),[a,i]=j.useState([]),[l,c]=j.useState([]),[u,d]=j.useState(!1),[f,h]=j.useState(!1),[m,x]=j.useState(new Set),[p,g]=j.useState(!1),[w,v]=j.useState(!1),{currentOrganisation:y}=wa(),b=(y==null?void 0:y.id)||"",{suggestions:S}=pV(e),[k,_]=j.useState([]),[N,C]=j.useState([]),[B,H]=j.useState(!1),[V,K]=j.useState(!1),[Y,q]=j.useState(!0),[X,ie]=j.useState(null),[W,U]=j.useState({}),[he,be]=j.useState({sections:[],services:[],subclasses:[],frrs:[],sizeBuckets:[]});console.log("========== SCOPE MATRIX DEBUG =========="),console.log("ScopeMatrix render:",{projectId:e,comparisonDataLength:s.length,matrixRowsLength:a.length,suppliersCount:l.length,loading:u,hasFilters:Object.keys(W).length>0}),j.useEffect(()=>{R()},[e]),j.useEffect(()=>{pe()},[s,W]);const R=async()=>{q(!0);try{const{data:T}=await se.from("quotes").select("id, supplier_name, quote_reference, total_amount, items_count").eq("project_id",e).order("supplier_name");if(T){const G=await Promise.all(T.map(async Q=>{var et;const{data:me}=await se.from("parsing_jobs").select("status, error_message, parsed_lines").eq("quote_id",Q.id).order("created_at",{ascending:!1}).limit(1).maybeSingle(),{count:fe}=await se.from("quote_items").select("*",{count:"exact",head:!0}).eq("quote_id",Q.id),{count:oe}=await se.from("quote_items").select("*",{count:"exact",head:!0}).eq("quote_id",Q.id).not("system_id","is",null),ke=fe||0,we=oe||0,Pe=((et=me==null?void 0:me.error_message)==null?void 0:et.includes("chunks failed"))||!1;let Ue="completed";return me&&(me.status==="completed"&&ke===0?Ue="failed":me.status==="completed"&&Pe?Ue="partial":me.status==="failed"?Ue="failed":Ue=me.status),{id:Q.id,supplier_name:Q.supplier_name,quote_reference:Q.quote_reference,total_amount:Q.total_amount,items_count:ke,mapped_items_count:we,parse_status:Ue,has_failed_chunks:Pe}}));console.log("=== LOADED QUOTES WITH STATUS ==="),G.forEach(Q=>{console.log(`${Q.supplier_name}:`,{items_count:Q.items_count,mapped_items_count:Q.mapped_items_count,parse_status:Q.parse_status,has_failed_chunks:Q.has_failed_chunks})}),console.log("================================="),_(G)}}catch(T){console.error("Error loading quotes:",T)}finally{q(!1)}},M=async()=>{N.length!==0&&(console.log("=== SCOPE MATRIX GENERATION START ==="),console.log("Selected Quote IDs:",N),console.log("Project ID:",e),H(!0),await z(),K(!0),H(!1),console.log("=== SCOPE MATRIX GENERATION END ==="))},O=(T,G)=>{const Q={},me={},fe={};for(const we of T)Q[we.quote_id]=(Q[we.quote_id]||0)+1,we.system_id&&(me[we.quote_id]=(me[we.quote_id]||0)+1,fe[we.system_id]||(fe[we.system_id]=new Set),fe[we.system_id].add(we.quote_id));const oe=Object.entries(fe).filter(([,we])=>we.size>=2).map(([we])=>we);let ke="success";return T.length===0?ke="no_items":Object.values(me).every(we=>we===0)?ke="no_mapped_items":oe.length===0&&(ke="no_overlap"),{totalItems:T.length,itemsByQuote:Q,itemsWithSystemByQuote:me,overlappingSystemsCount:oe.length,overlappingSystems:oe,selectedQuoteIds:G,reason:ke}},z=async()=>{var T,G;d(!0);try{const Q=N.length>0?N:k.map(xe=>xe.id),{data:me}=await se.from("quotes").select("id, supplier_name").in("id",Q).order("supplier_name");if(!me||me.length===0){d(!1);return}const fe=me.map(xe=>xe.id),{data:oe}=await se.from("quote_items").select("*").in("quote_id",fe);if(!oe){console.error("ScopeMatrix: No items data returned from database"),d(!1);return}const ke=O(oe,fe);ie(ke),console.log("=== SCOPE MATRIX DIAGNOSTICS ==="),console.log("Total Items:",ke.totalItems),console.log("Items by Quote:",ke.itemsByQuote),console.log("Items with System by Quote:",ke.itemsWithSystemByQuote),console.log("Overlapping Systems Count:",ke.overlappingSystemsCount),console.log("Overlapping Systems:",ke.overlappingSystems),console.log("Reason:",ke.reason),console.log("================================"),console.log("ScopeMatrix: Loading data for project",e),console.log("ScopeMatrix: Found",me.length,"quotes and",oe.length,"items");const we=oe.filter(xe=>xe.system_id);if(console.log("ScopeMatrix: Items with system_id:",we.length),oe.length>0){const xe=oe[0];console.log("ScopeMatrix: Sample item data:",{id:xe.id,description:(T=xe.description)==null?void 0:T.substring(0,50),system_id:xe.system_id,system_label:xe.system_label,service:xe.service,subclass:xe.subclass,frr:xe.frr,size:xe.size,quantity:xe.quantity,unit_price:xe.unit_price,canonical_unit:xe.canonical_unit})}we.length===0?(console.warn("ScopeMatrix: WARNING - No items have system_id mapped! Matrix will be empty."),console.warn("ScopeMatrix: Make sure you have completed Review & Clean > Smart Clean or mapping step.")):console.log("ScopeMatrix: Sample mapped item:",{system_id:we[0].system_id,system_label:we[0].system_label,description:(G=we[0].description)==null?void 0:G.substring(0,50)});const Pe=new Set(oe.filter(xe=>jx(xe)).map(xe=>xe.id));x(Pe);const Ue=oe.map(xe=>{const Xe=me.find(ve=>ve.id===xe.quote_id),pt=xe.service||xe.mapped_service_type||xe.serviceType,tt=xe.mapped_system||xe.systemType,ar=xe.mapped_penetration||xe.penetrationType;return{quoteId:xe.quote_id,quoteItemId:xe.id,supplier:(Xe==null?void 0:Xe.supplier_name)||"Unknown",originalDescription:xe.description,quantity:xe.quantity||1,rate:xe.unit_price,total:xe.total_price,section:xe.section,service:pt,serviceType:pt,subclass:xe.subclass,frr:xe.frr,size:xe.size,systemType:tt,penetrationType:ar}});console.log("ScopeMatrix: Normalised",Ue.length,"lines"),console.log("ScopeMatrix: Sample item:",Ue[0]);const et=oe.map(xe=>({quoteItemId:xe.id,systemId:xe.system_id,systemLabel:xe.system_label}));console.log("ScopeMatrix: Created",et.length,"mappings"),console.log("ScopeMatrix: Sample mappings:",et.slice(0,3));const nt=et.filter(xe=>xe.systemId);console.log("ScopeMatrix: Mappings with system_id:",nt.length,"/",et.length),nt.length>0?console.log("ScopeMatrix: Sample mapped item:",nt[0]):(console.warn("ScopeMatrix: NO MAPPINGS FOUND! Items are not mapped to systems."),console.warn("ScopeMatrix: Sample unmapped item:",et[0]));const He=xg(e);await He.loadSettings(),console.log("ScopeMatrix: Model rate provider loaded");const Be=await ZE(Ue,et,xe=>He.getModelRate(xe));if(console.log("ScopeMatrix: Generated",Be.length,"comparison rows"),Be.length>0){console.log("ScopeMatrix: Sample comparison:",Be[0]);const xe=Array.from(new Set(Be.map(Xe=>Xe.supplier)));console.log("ScopeMatrix: Unique suppliers in comparisons:",xe)}else console.error("ScopeMatrix: ERROR - compareAgainstModelHybrid returned 0 rows!"),console.log("ScopeMatrix: Check if items have system_id and if model rates are configured");n(Be),J(Be),console.log("ScopeMatrix: comparisonData state set with",Be.length,"rows"),await se.from("project_settings").upsert({project_id:e,scope_matrix_completed:!0,updated_at:new Date().toISOString()},{onConflict:"project_id"})}catch(Q){console.error("ScopeMatrix: Error loading data:",Q),console.error("ScopeMatrix: Error details:",{message:Q instanceof Error?Q.message:"Unknown error",stack:Q instanceof Error?Q.stack:void 0}),n([])}finally{d(!1)}},J=T=>{const G=new Set,Q=new Set,me=new Set,fe=new Set,oe=new Set;T.forEach(ke=>{ke.section&&G.add(ke.section),ke.service&&Q.add(ke.service),ke.subclass&&me.add(ke.subclass),ke.frr&&fe.add(ke.frr),ke.sizeBucket&&oe.add(ke.sizeBucket)}),be({sections:Array.from(G).sort(),services:Array.from(Q).sort(),subclasses:Array.from(me).sort(),frrs:Array.from(fe).sort(),sizeBuckets:Array.from(oe).sort()})},pe=()=>{console.log("=== BUILD MATRIX START ==="),console.log("buildMatrix: Starting with",s.length,"comparison rows"),console.log("buildMatrix: Has generated:",V),console.log("buildMatrix: Active filters:",W);let T=s;W.section&&(T=T.filter(oe=>oe.section===W.section)),W.service&&(T=T.filter(oe=>oe.service===W.service)),W.subclass&&(T=T.filter(oe=>oe.subclass===W.subclass)),W.frr&&(T=T.filter(oe=>oe.frr===W.frr)),W.sizeBucket&&(T=T.filter(oe=>oe.sizeBucket===W.sizeBucket)),console.log("buildMatrix: After filtering:",T.length,"rows");const G=Array.from(new Set(T.map(oe=>oe.supplier))).sort();c(G),console.log("buildMatrix: Found",G.length,"suppliers:",G);const Q=new Map;T.forEach(oe=>{const ke=`${oe.systemId}|${oe.systemLabel}`;Q.has(ke)||Q.set(ke,{systemId:oe.systemId,systemLabel:oe.systemLabel,section:oe.section,service:oe.service,subclass:oe.subclass,frr:oe.frr,sizeBucket:oe.sizeBucket,cells:{}});const we=Q.get(ke);if(!we.cells[oe.supplier])we.cells[oe.supplier]={unitRate:oe.unitRate,flag:oe.flag,modelRate:oe.modelRate,variancePct:oe.variancePct,componentCount:1,quoteId:oe.quoteId,quoteItemId:oe.quoteItemId,totalQuantity:oe.quantity||0,totalValue:oe.total||0};else{const Pe=we.cells[oe.supplier],Ue=Pe.totalValue||0,nt=(Pe.totalQuantity||0)+(oe.quantity||0),He=Ue+(oe.total||0);if(Pe.totalQuantity=nt,Pe.totalValue=He,Pe.componentCount=(Pe.componentCount||0)+1,Pe.unitRate=nt>0?He/nt:Pe.unitRate,oe.modelRate!==null&&Pe.unitRate>0){const Be=(Pe.unitRate-oe.modelRate)/oe.modelRate*100;Pe.variancePct=Be,Math.abs(Be)<=10?Pe.flag="GREEN":Math.abs(Be)<=25?Pe.flag="AMBER":Pe.flag="RED"}}});const me=Array.from(Q.values()).sort((oe,ke)=>oe.systemId==="UNMAPPED"&&ke.systemId!=="UNMAPPED"?1:ke.systemId==="UNMAPPED"&&oe.systemId!=="UNMAPPED"?-1:oe.systemLabel.localeCompare(ke.systemLabel));console.log("buildMatrix: Generated",me.length,"matrix rows"),console.log("buildMatrix: Rows by systemId breakdown:");const fe=new Map;T.forEach(oe=>{fe.set(oe.systemId,(fe.get(oe.systemId)||0)+1)}),fe.forEach((oe,ke)=>{console.log(`  - ${ke}: ${oe} items`)}),me.length>0?(console.log("buildMatrix: Sample row:",me[0]),console.log("buildMatrix: Sample row cells:",Object.keys(me[0].cells))):(console.warn("buildMatrix: WARNING - No matrix rows generated!"),console.warn("buildMatrix: Diagnostics:",X),T.length>0&&(console.warn("buildMatrix: We have filtered data but no rows! This is the bug."),console.warn("buildMatrix: Sample filtered data:",T.slice(0,3)))),i(me),console.log("=== BUILD MATRIX END ===")},ge=()=>{try{if(console.log("Export CSV clicked",{matrixRowsCount:a.length,suppliersCount:l.length}),a.length===0){alert("No data available to export. Please ensure quotes are imported and the matrix has been generated.");return}const T=["System ID","System Label","Section","Service","Subclass","FRR","Size Bucket"];l.forEach(ke=>{T.push(`${ke} - Unit Rate`),T.push(`${ke} - Model Rate`),T.push(`${ke} - Variance %`),T.push(`${ke} - Flag`)});const G=a.map(ke=>{const we=[ke.systemId,ke.systemLabel,ke.section||"",ke.service||"",ke.subclass||"",ke.frr||"",ke.sizeBucket||""];return l.forEach(Pe=>{var et,nt,He;const Ue=ke.cells[Pe];Ue?(we.push(((et=Ue.unitRate)==null?void 0:et.toFixed(2))||""),we.push(((nt=Ue.modelRate)==null?void 0:nt.toFixed(2))||""),we.push(((He=Ue.variancePct)==null?void 0:He.toFixed(2))||""),we.push(Ue.flag)):we.push("","","","")}),we}),Q=[T.join(","),...G.map(ke=>ke.map(we=>`"${we}"`).join(","))].join(`
`),me=new Blob([Q],{type:"text/csv;charset=utf-8;"}),fe=URL.createObjectURL(me),oe=document.createElement("a");oe.href=fe,oe.download=`scope-matrix-${e}-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(oe),oe.click(),document.body.removeChild(oe),URL.revokeObjectURL(fe),console.log("Export completed successfully")}catch(T){console.error("Error exporting CSV:",T),alert("Failed to export CSV. Check console for details.")}},ne=async()=>{var T,G,Q;try{if(console.log("Export Excel clicked",{matrixRowsCount:a.length,suppliersCount:l.length}),a.length===0){alert("No data available to export. Please generate a scope matrix first.");return}const fe=await fetch("/templates/Itemized_Comparison_Global_1.xlsx");if(!fe.ok)throw new Error("Failed to load template file");const oe=await fe.arrayBuffer(),ke=wc(oe,{type:"array",cellStyles:!0}),we=ke.Sheets[ke.SheetNames[0]];we.A2={t:"s",v:`Project ID: ${e}`},we.A3={t:"s",v:`Generated: ${new Date().toLocaleString()}`};const Pe=3;we["!merges"]=[];for(let He=0;He<l.length;He++){const Be=Pe+He*2,xe=it.encode_cell({r:4,c:Be});we[xe]={t:"s",v:l[He],s:((T=we[xe])==null?void 0:T.s)||{}},we["!merges"].push({s:{r:4,c:Be},e:{r:4,c:Be+1}});const Xe=it.encode_cell({r:5,c:Be}),pt=it.encode_cell({r:5,c:Be+1});we[Xe]={t:"s",v:"Unit Rate",s:((G=we[Xe])==null?void 0:G.s)||{}},we[pt]={t:"s",v:"Total",s:((Q=we[pt])==null?void 0:Q.s)||{}}}const Ue=6,et=we["!ref"]?it.decode_range(we["!ref"]):{s:{r:0,c:0},e:{r:5,c:2}};a.forEach((He,Be)=>{const xe=Ue+Be;we[it.encode_cell({r:xe,c:0})]={t:"s",v:He.systemLabel||He.systemId},we[it.encode_cell({r:xe,c:1})]={t:"s",v:""},we[it.encode_cell({r:xe,c:2})]={t:"s",v:""},l.forEach((Xe,pt)=>{const tt=He.cells[Xe],ar=Pe+pt*2,ve=ar+1;if(tt&&tt.unitRate!==null&&!isNaN(tt.unitRate)){we[it.encode_cell({r:xe,c:ar})]={t:"n",v:tt.unitRate,z:'"$"#,##0.00'};const Ye=tt.totalValue!==void 0?tt.totalValue:tt.totalQuantity&&tt.unitRate?tt.totalQuantity*tt.unitRate:0;we[it.encode_cell({r:xe,c:ve})]={t:"n",v:Ye,z:'"$"#,##0.00'}}else we[it.encode_cell({r:xe,c:ar})]={t:"s",v:"N/A"},we[it.encode_cell({r:xe,c:ve})]={t:"s",v:"N/A"}}),et.e.r=Math.max(et.e.r,xe),et.e.c=Math.max(et.e.c,Pe+l.length*2-1)}),we["!ref"]=it.encode_range(et);const nt=`Itemized_Comparison_${e}_${new Date().toISOString().split("T")[0]}.xlsx`;fg(ke,nt),console.log("Excel export completed successfully")}catch(me){console.error("Error exporting Excel:",me),alert("Failed to export Excel. Check console for details.")}},ae=()=>{U({})},Ce=Object.values(W).some(T=>T),P=T=>{C(G=>G.includes(T)?G.filter(Q=>Q!==T):[...G,T])},ce=()=>{const T=k.filter(qf);N.length===T.length?C([]):C(T.map(G=>G.id))},ue=k.filter(qf);console.log("=== SCOPE MATRIX QUOTE FILTERING ==="),console.log("Total available quotes:",k.length),console.log("Ready quotes:",ue.length),k.forEach(T=>{const G=qf(T);console.log(`Quote "${T.supplier_name}":`,{isReady:G,parse_status:T.parse_status,items_count:T.items_count,mapped_items_count:T.mapped_items_count,has_failed_chunks:T.has_failed_chunks})}),console.log("====================================");const Ee=ue.length>0&&N.length===ue.length;return o.jsxs("div",{className:"min-h-screen",children:[o.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-6",children:[o.jsxs("div",{className:"mb-6",children:[o.jsxs("button",{onClick:t,className:"flex items-center gap-2 text-sm text-gray-600 hover:text-gray-900 mb-4 transition-colors",children:[o.jsx(Po,{size:16}),"Back to Project Dashboard"]}),o.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Scope Matrix"}),o.jsx("p",{className:"text-base text-gray-600",children:"Compare supplier quotes and generate your scope matrix."})]}),o.jsxs("div",{className:"bg-white rounded-lg p-6 border border-gray-200 shadow-sm mb-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Supplier Quotes"}),ue.length>0&&o.jsxs("button",{onClick:ce,className:"flex items-center gap-2 text-sm text-gray-600 hover:text-gray-900 font-medium",children:[Ee?o.jsx(Vy,{size:16}):o.jsx(Hy,{size:16}),Ee?"Deselect All":"Select All"]})]}),k.length>ue.length&&o.jsx("div",{className:"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg text-sm",children:o.jsxs("div",{className:"flex items-start gap-2",children:[o.jsx(wo,{size:16,className:"text-blue-600 flex-shrink-0 mt-0.5"}),o.jsxs("div",{className:"text-blue-800",children:[k.length-ue.length," quote(s) are not ready for comparison. Fix imports in ",o.jsx("a",{href:"#/import-quotes",className:"underline font-medium",children:"Import Quotes"})," or"," ",o.jsx("a",{href:"#/review-clean",className:"underline font-medium",children:"Review & Clean"}),"."]})]})}),Y?o.jsx("div",{className:"text-center py-8 text-gray-500 text-sm",children:"Loading quotes..."}):ue.length===0?o.jsxs("div",{className:"text-center py-12",children:[o.jsx(Je,{className:"mx-auto text-gray-400 mb-4",size:48}),o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No quotes ready for Scope Matrix"}),o.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"To compare suppliers, first import and clean at least one supplier quote."}),o.jsx("a",{href:"#/import-quotes",className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md font-medium transition-colors",children:"Go to Import Quotes"})]}):o.jsx("div",{className:"space-y-2",children:ue.map(T=>{var Q;const G=N.includes(T.id);return o.jsxs("button",{onClick:()=>P(T.id),className:`w-full flex items-center gap-3 py-3 px-3 rounded-lg border transition-all text-left ${G?"border-gray-300 bg-gray-50":"border-gray-200 bg-white hover:bg-gray-50"}`,children:[o.jsx("div",{className:"flex-shrink-0",children:G?o.jsx(Vy,{className:"text-blue-600",size:18}):o.jsx(Hy,{className:"text-gray-400",size:18})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:"font-semibold text-gray-900 text-sm",children:T.supplier_name}),o.jsxs("div",{className:"text-xs text-gray-500 mt-0.5",children:[T.items_count," items ",T.mapped_items_count>0?o.jsxs("span",{className:"text-green-600 font-medium",children:[" ",T.mapped_items_count," mapped"]}):o.jsx("span",{className:"text-amber-600 font-medium",children:" 0 mapped (needs Review & Clean)"})," $",((Q=T.total_amount)==null?void 0:Q.toLocaleString())||"0",T.mapped_items_count>0?o.jsx("span",{className:"text-green-600 font-medium ml-2",children:" Ready"}):o.jsx("span",{className:"text-amber-600 font-medium ml-2",children:" Needs mapping"})]})]})]},T.id)})}),N.length>0&&o.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[o.jsx("div",{className:"text-sm text-gray-900 font-medium mb-1",children:N.length===1?"Select at least 2 suppliers to generate a scope matrix.":o.jsxs(o.Fragment,{children:["Comparing: ",ue.filter(T=>N.includes(T.id)).map(T=>T.supplier_name).join(" vs ")]})}),N.length>=2&&(()=>{const T=ue.filter(fe=>N.includes(fe.id)),G=T.every(fe=>fe.mapped_items_count>0),Q=T.reduce((fe,oe)=>fe+oe.mapped_items_count,0),me=T.reduce((fe,oe)=>fe+oe.items_count,0);return o.jsx("div",{className:`text-xs ${G?"text-green-600":"text-amber-600"}`,children:G?` All selected quotes are normalised and mapped (${Q}/${me} items)`:" Some quotes need mapping - Go to Review & Clean and run Smart Clean"})})()]}),o.jsx("div",{className:"flex items-end justify-end mt-6",children:o.jsxs("div",{className:"text-right",children:[o.jsx("button",{onClick:M,disabled:N.length<2||B,className:"px-6 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-md font-medium transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed text-sm",children:B?"Building Matrix...":"Generate Scope Matrix"}),o.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Only updated quotes will be reprocessed."})]})})]}),!V&&!u&&N.length===0&&o.jsxs("div",{className:"bg-white rounded-lg p-8 border border-gray-200 text-center",children:[o.jsx("p",{className:"text-gray-600 mb-1",children:"No scope matrix generated yet."}),o.jsx("p",{className:"text-sm text-gray-500",children:"Generate a matrix to continue."})]}),u&&o.jsx("div",{className:"bg-white rounded-lg p-8 border border-gray-200 text-center",children:o.jsx("div",{className:"text-gray-600",children:"Building scope matrix..."})}),V&&!u&&s.length===0&&(()=>{const T=X;let G="No comparison data available",Q="Unable to generate scope matrix for the selected quotes.",me="Go to Review & Clean",fe="#/review-clean";return(T==null?void 0:T.reason)==="no_items"?(G="No processed items found",Q="We couldn't find any processed line items for the selected suppliers. Make sure quotes have been imported and processing completed successfully.",me="Check Import Status",fe="#/import-quotes"):(T==null?void 0:T.reason)==="no_mapped_items"?(G="Items aren't mapped to systems",Q="The selected suppliers have items, but none are mapped to systems. Map items to systems in Review & Clean so they can be compared.",me="Go to Review & Clean",fe="#/review-clean"):(T==null?void 0:T.reason)==="no_overlap"&&(G="No overlapping systems to compare",Q="These suppliers don't share any systems, so there's nothing to compare. Try selecting different quotes or adjust system mapping in Review & Clean.",me="Go to Review & Clean",fe="#/review-clean"),o.jsx("div",{className:"bg-white rounded-xl p-12 border border-gray-200 shadow-sm",children:o.jsxs("div",{className:"text-center",children:[o.jsx(Je,{className:"mx-auto mb-4 text-amber-500",size:48}),o.jsx("p",{className:"text-gray-900 text-lg font-semibold mb-2",children:G}),o.jsx("p",{className:"text-gray-600 mb-6 max-w-2xl mx-auto",children:Q}),T&&o.jsxs("div",{className:"text-left max-w-2xl mx-auto bg-gray-50 rounded-lg p-4 text-sm mb-6",children:[o.jsx("p",{className:"font-semibold text-gray-900 mb-3",children:"Diagnostics:"}),o.jsxs("div",{className:"space-y-2 text-gray-700",children:[o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{children:"Total items loaded:"}),o.jsx("span",{className:"font-medium",children:T.totalItems})]}),Object.entries(T.itemsByQuote).map(([oe,ke])=>{const we=k.find(Ue=>Ue.id===oe),Pe=T.itemsWithSystemByQuote[oe]||0;return o.jsxs("div",{className:"pl-4 border-l-2 border-gray-300",children:[o.jsx("div",{className:"font-medium text-gray-900",children:(we==null?void 0:we.supplier_name)||"Unknown"}),o.jsxs("div",{className:"text-xs text-gray-600",children:[ke," items  ",Pe," mapped to systems"]})]},oe)}),o.jsxs("div",{className:"flex justify-between pt-2 border-t border-gray-300",children:[o.jsx("span",{children:"Overlapping systems:"}),o.jsx("span",{className:"font-medium",children:T.overlappingSystemsCount})]})]})]}),o.jsxs("div",{className:"flex items-center justify-center gap-3",children:[o.jsx("a",{href:fe,className:"inline-flex items-center gap-2 px-6 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-md font-medium transition-colors",children:me}),o.jsx("button",{onClick:()=>{console.clear(),console.log(""),console.log(" SCOPE MATRIX DETAILED DIAGNOSTICS"),console.log(""),console.log(""),console.log(" Full diagnostics object:",X),console.log(""),console.log(" Available quotes:",k),console.log(""),console.log(" Selected quote IDs:",N),console.log(""),console.log(" Comparison data length:",s.length),console.log(""),console.log(" Matrix rows length:",a.length),console.log(""),console.log(" Suppliers:",l),console.log(""),console.log(""),alert(` Console cleared and diagnostic details logged!

Press F12 or right-click > Inspect > Console to view the detailed information.`)},className:"px-4 py-2 text-sm text-gray-600 hover:text-gray-900 border border-gray-300 rounded-md hover:bg-gray-50 transition-colors",children:"Show Console Details"})]})]})})})(),V&&!u&&s.length>0&&o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsxs("button",{onClick:()=>h(!f),className:"flex items-center gap-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 transition-colors",children:[o.jsx(PS,{size:18}),"Filters",Ce&&o.jsx("span",{className:"ml-1 px-2 py-0.5 bg-blue-600 text-white text-xs rounded-full",children:Object.values(W).filter(T=>T).length})]}),Ce&&o.jsxs("button",{onClick:ae,className:"flex items-center gap-2 px-3 py-2 text-sm text-gray-600 hover:text-gray-900",children:[o.jsx(ps,{size:16}),"Clear filters"]})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsxs("button",{onClick:()=>g(!0),disabled:S.length===0,className:"flex items-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed",children:[o.jsx(RF,{size:18}),"Suggested Systems",S.length>0&&o.jsx("span",{className:"ml-1 px-2 py-0.5 bg-purple-800 text-white text-xs rounded-full",children:S.length})]}),o.jsxs("button",{onClick:ge,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:[o.jsx(fi,{size:18}),"Export CSV"]}),o.jsxs("button",{onClick:ne,disabled:a.length===0,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed",title:a.length===0?"Generate a scope matrix first to export itemized comparison":"Export Itemized Comparison to Excel",children:[o.jsx(lm,{size:18}),"Export Items (Excel)"]})]})]}),f&&o.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Section"}),o.jsxs("select",{value:W.section||"",onChange:T=>U({...W,section:T.target.value||void 0}),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[o.jsx("option",{value:"",children:"All"}),he.sections.map(T=>o.jsx("option",{value:T,children:T},T))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Service"}),o.jsxs("select",{value:W.service||"",onChange:T=>U({...W,service:T.target.value||void 0}),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[o.jsx("option",{value:"",children:"All"}),he.services.map(T=>o.jsx("option",{value:T,children:T},T))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Subclass"}),o.jsxs("select",{value:W.subclass||"",onChange:T=>U({...W,subclass:T.target.value||void 0}),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[o.jsx("option",{value:"",children:"All"}),he.subclasses.map(T=>o.jsx("option",{value:T,children:T},T))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"FRR"}),o.jsxs("select",{value:W.frr||"",onChange:T=>U({...W,frr:T.target.value||void 0}),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[o.jsx("option",{value:"",children:"All"}),he.frrs.map(T=>o.jsx("option",{value:T,children:T},T))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Size Bucket"}),o.jsxs("select",{value:W.sizeBucket||"",onChange:T=>U({...W,sizeBucket:T.target.value||void 0}),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[o.jsx("option",{value:"",children:"All"}),he.sizeBuckets.map(T=>o.jsx("option",{value:T,children:T},T))]})]})]})}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-6",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Scope Matrix"}),o.jsxs("div",{className:"relative group",children:[o.jsx(wo,{size:18,className:"text-gray-400 hover:text-gray-600 cursor-help"}),o.jsxs("div",{className:"absolute left-1/2 -translate-x-1/2 bottom-full mb-2 hidden group-hover:block z-20 w-80 p-3 bg-gray-900 text-white text-sm rounded-lg shadow-lg",children:[o.jsx("div",{className:"font-semibold mb-1",children:"Scope Matrix"}),o.jsx("div",{className:"text-gray-200",children:"Compare supplier rates for each passive fire system and quickly see pricing differences and missing items."}),o.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 top-full w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-gray-900"})]})]})]}),o.jsxs("div",{className:"flex items-center gap-6 text-sm",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-4 h-4 bg-green-100 border-2 border-green-300 rounded"}),o.jsx("span",{className:"text-gray-600",children:"10%"})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-4 h-4 bg-amber-100 border-2 border-amber-300 rounded"}),o.jsx("span",{className:"text-gray-600",children:"20%"})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-4 h-4 bg-red-100 border-2 border-red-300 rounded"}),o.jsx("span",{className:"text-gray-600",children:">20%"})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-4 h-4 bg-gray-100 border-2 border-gray-300 rounded"}),o.jsx("span",{className:"text-gray-600",children:"N/A"})]})]})]}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full border-collapse text-sm",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"bg-gray-50",children:[o.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700 border border-gray-200 sticky left-0 bg-gray-50 z-10",children:"System"}),l.map(T=>o.jsx("th",{className:"px-3 py-2 text-center font-medium text-gray-700 border border-gray-200 min-w-[120px]",children:T},T))]})}),o.jsx("tbody",{children:a.map((T,G)=>o.jsxs("tr",{className:"hover:bg-gray-50",children:[o.jsx("td",{className:"px-3 py-2 text-sm font-medium text-gray-900 border border-gray-200 sticky left-0 bg-white z-10",children:o.jsxs("div",{className:"flex flex-col",children:[o.jsx("span",{className:"font-semibold",children:T.systemLabel}),T.systemId!==T.systemLabel&&o.jsx("span",{className:"text-xs text-gray-500",children:T.systemId})]})}),l.map(Q=>{const me=T.cells[Q];if(!me)return o.jsx("td",{className:"px-3 py-2 text-center border border-gray-200",children:o.jsx("span",{className:"text-gray-400",children:"-"})},Q);const fe=m.has(me.quoteItemId);return o.jsx("td",{className:"px-3 py-2 border border-gray-200",children:o.jsxs("div",{className:"relative group",children:[o.jsxs("div",{className:`px-2 py-1.5 rounded text-center font-medium border-2 ${gV(me.flag)} flex items-center justify-center gap-1`,children:[o.jsx("span",{children:me.unitRate!==null?`$${me.unitRate.toFixed(2)}`:"N/A"}),fe&&o.jsx(Je,{size:14,className:"text-yellow-600"})]}),o.jsxs("div",{className:"absolute left-1/2 -translate-x-1/2 bottom-full mb-2 hidden group-hover:block z-20 w-48 p-3 bg-gray-900 text-white text-xs rounded-lg shadow-lg",children:[o.jsxs("div",{className:"space-y-1",children:[fe&&o.jsxs("div",{className:"pb-2 mb-2 border-b border-gray-700 text-yellow-300 flex items-start gap-1",children:[o.jsx(Je,{size:14,className:"flex-shrink-0 mt-0.5"}),o.jsx("span",{children:"Quantity missing in source quote. Please review before finalising."})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-gray-300",children:"Unit Rate:"}),o.jsx("span",{className:"font-semibold",children:me.unitRate!==null?`$${me.unitRate.toFixed(2)}`:"N/A"})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-gray-300",children:"Model Rate:"}),o.jsx("span",{className:"font-semibold",children:me.modelRate!==null?`$${me.modelRate.toFixed(2)}`:"N/A"})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-gray-300",children:"Variance:"}),o.jsx("span",{className:"font-semibold",children:me.variancePct!==null?`${me.variancePct>0?"+":""}${me.variancePct.toFixed(1)}%`:"N/A"})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-gray-300",children:"Components:"}),o.jsx("span",{className:"font-semibold",children:me.componentCount||"N/A"})]})]}),o.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 top-full w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-gray-900"})]})]})},Q)})]},G))})]})}),a.length===0&&o.jsx("div",{className:"text-center py-8 text-gray-500",children:"No data matches the selected filters."}),o.jsxs("div",{className:"mt-6 pt-4 border-t border-gray-200",children:[o.jsx("button",{onClick:()=>v(!w),className:"flex items-center gap-2 text-sm text-gray-600 hover:text-gray-900 transition-colors",children:w?o.jsxs(o.Fragment,{children:[o.jsx(bF,{size:16}),o.jsx("span",{children:"Less Info"})]}):o.jsxs(o.Fragment,{children:[o.jsx(ri,{size:16}),o.jsx("span",{children:"More Info"})]})}),w&&o.jsxs("div",{className:"mt-4 p-4 bg-gray-50 border border-gray-200 rounded-lg",children:[o.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-2",children:"How to Read This Matrix"}),o.jsx("p",{className:"text-sm text-gray-700 leading-relaxed",children:"This matrix compares each supplier's rates for the same passive fire systems so you can accurately assess scope and pricing differences. Every row is a system type, and each column shows how each supplier priced that system. Colour indicators highlight where prices vary, helping you quickly identify mismatches, missing items, and potential scope gaps."})]})]})]}),o.jsx(m0,{currentStep:4,totalSteps:6,onBack:t,onNext:r,backLabel:"Back: Quote Intelligence",nextLabel:"Next: Equalisation"})]})]}),p&&o.jsx(xV,{projectId:e,organisationId:b,onClose:()=>g(!1),onSystemCreated:()=>{z()}})]})}function yV(e,t){const r=new Map,s=[],n=new Map;e.forEach(l=>{n.has(l.systemId)||n.set(l.systemId,[]),n.get(l.systemId).push(l)});const a=Array.from(new Set(e.map(l=>l.supplier)));return a.forEach(l=>{r.set(l,{original:0,equalised:0,itemsAdded:0})}),e.forEach(l=>{const c=r.get(l.supplier),u=l.total||0;c.original+=u,c.equalised+=u}),n.forEach((l,c)=>{var f;const u=new Set(l.map(h=>h.supplier)),d=a.filter(h=>!u.has(h));if(d.length>0){let h=null,m="";if(t==="MODEL"&&((f=l[0])!=null&&f.modelRate))h=l[0].modelRate,m="MODEL";else if(t==="PEER_MEDIAN"){const x=l.map(p=>p.unitRate).filter(p=>p!==null&&p>0);x.length>0&&(x.sort((p,g)=>p-g),h=x[Math.floor(x.length/2)],m="PEER_MEDIAN")}if(h!==null){const x=l[0];d.forEach(p=>{const w=h*1,v=r.get(p);v.equalised+=w,v.itemsAdded+=1,s.push({supplierName:p,systemId:x.systemId,systemLabel:x.systemLabel,reason:"Missing scope item",source:m,rateUsed:h,quantity:1,total:w})})}}}),{supplierTotals:a.map(l=>{const c=r.get(l),u=c.equalised-c.original,d=c.original>0?u/c.original*100:0;return{supplierName:l,originalTotal:c.original,equalisedTotal:c.equalised,adjustment:u,adjustmentPct:d,itemsAdded:c.itemsAdded}}),equalisationLog:s,mode:t}}function wV({projectId:e,onNavigateBack:t,onNavigateNext:r}){const[s,n]=j.useState([]),[a,i]=j.useState(null),[l,c]=j.useState("MODEL"),[u,d]=j.useState(!0),[f,h]=j.useState(!1),m=j.useCallback(async()=>{d(!0);try{const{data:v}=await se.from("quotes").select("id, supplier_name").eq("project_id",e).order("supplier_name");if(!v||v.length===0){d(!1);return}const y=v.map(C=>C.id),{data:b}=await se.from("quote_items").select("*").in("quote_id",y);if(!b){d(!1);return}const S=b.map(C=>{const B=v.find(H=>H.id===C.quote_id);return{quoteId:C.quote_id,quoteItemId:C.id,supplier:(B==null?void 0:B.supplier_name)||"Unknown",originalDescription:C.description,quantity:C.quantity||1,rate:C.unit_price,total:C.total_price,section:C.section,service:C.service,subclass:C.subclass,frr:C.frr,size:C.size}}),k=b.map(C=>({quoteItemId:C.id,systemId:C.system_id,systemLabel:C.system_label})),_=xg(e);await _.loadSettings();const N=await ZE(S,k,C=>_.getModelRate(C));n(N)}catch(v){console.error("Error loading data:",v)}finally{d(!1)}},[e]),x=j.useCallback(()=>{if(s.length===0){i(null);return}const v=yV(s,l),y=s.filter(S=>S.modelRate!==null).length,b=s.length;console.log("Equalisation calculated:",{mode:l,totalEqualisations:v.totalEqualisations,logEntries:v.equalisationLog.length,suppliers:v.supplierTotals.length,comparisonRowsCount:s.length,modelRatesAvailable:y,modelRatesCoverage:`${y}/${b} (${(y/b*100).toFixed(1)}%)`,sampleComparisonRows:s.slice(0,3).map(S=>({supplier:S.supplier,system:S.systemLabel,unitRate:S.unitRate,modelRate:S.modelRate,hasModelRate:S.modelRate!==null}))}),i(v)},[s,l]);j.useEffect(()=>{p()},[e]),j.useEffect(()=>{f&&m()},[m,f]),j.useEffect(()=>{x()},[x]);const p=async()=>{try{const{data:v}=await se.from("project_settings").select("equalisation_mode").eq("project_id",e).maybeSingle();v!=null&&v.equalisation_mode&&c(v.equalisation_mode)}catch(v){console.error("Error loading equalisation mode:",v)}finally{h(!0)}},g=async v=>{c(v);try{const y=new Date().toISOString(),{error:b}=await se.from("project_settings").upsert({project_id:e,equalisation_mode:v,last_equalisation_run:y,updated_at:y},{onConflict:"project_id"});b&&console.error("Error saving equalisation mode:",b)}catch(y){console.error("Error persisting equalisation mode:",y)}},w=()=>{try{if(console.log("Export Equalisation Log clicked",{hasResult:!!a,logCount:(a==null?void 0:a.equalisationLog.length)||0,mode:l}),!a){alert("No equalisation result available. Please run the equalisation analysis first.");return}if(a.equalisationLog.length===0){alert("No equalisation log entries to export.");return}const v=["Supplier","System ID","System Label","Reason","Source","Rate Used","Quantity","Total"],y=a.equalisationLog.map(N=>[N.supplierName,N.systemId,N.systemLabel,N.reason,N.source,N.rateUsed.toFixed(2),N.quantity.toString(),N.total.toFixed(2)]),b=[v.join(","),...y.map(N=>N.map(C=>`"${C}"`).join(","))].join(`
`),S=new Blob([b],{type:"text/csv;charset=utf-8;"}),k=URL.createObjectURL(S),_=document.createElement("a");_.href=k,_.download=`equalisation-log-${l.toLowerCase()}-${e}-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(_),_.click(),document.body.removeChild(_),URL.revokeObjectURL(k),console.log("Export completed successfully",{rowCount:y.length})}catch(v){console.error("Error exporting equalisation log:",v),alert("Failed to export equalisation log. Check console for details.")}};return u?o.jsx("div",{className:"flex items-center justify-center h-64",children:o.jsx("div",{className:"text-gray-500",children:"Loading equalisation analysis..."})}):s.length===0?o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center",children:[o.jsx("p",{className:"text-gray-500 text-lg",children:"No data available."}),o.jsx("p",{className:"text-gray-400 mt-2",children:"Import quotes and configure model rate settings to view equalisation."})]}):o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-6",children:[o.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Equalisation Analysis"}),o.jsxs("div",{className:"relative group",children:[o.jsxs("button",{onClick:w,disabled:!a||a.equalisationLog.length===0,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed",title:!a||a.equalisationLog.length===0?"No equalisation entries to export. This happens when all suppliers quote all systems.":"Export equalisation log to CSV",children:[o.jsx(fi,{size:18}),"Export Log",a&&a.equalisationLog.length===0&&o.jsx("span",{className:"ml-1 text-xs",children:"(0 entries)"})]}),a&&a.equalisationLog.length===0&&o.jsxs("div",{className:"absolute right-0 top-full mt-2 w-72 bg-amber-50 border border-amber-200 rounded-lg p-3 text-xs text-amber-800 opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none z-10",children:[o.jsx("strong",{children:"No scope gaps to equalise."}),o.jsx("br",{}),"All suppliers have quoted all systems. The export log only includes items that were equalised (filled in) using ",l==="MODEL"?"model rates":"peer median rates","."]})]})]}),o.jsxs("div",{className:"mb-6",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Equalisation Mode"}),o.jsxs("div",{className:"flex gap-4",children:[o.jsxs("label",{className:"flex items-center gap-3 px-4 py-3 border-2 rounded-lg cursor-pointer transition-all hover:bg-gray-50",children:[o.jsx("input",{type:"radio",name:"equalisationMode",value:"MODEL",checked:l==="MODEL",onChange:v=>g(v.target.value),className:"w-4 h-4 text-blue-600"}),o.jsxs("div",{children:[o.jsx("div",{className:"font-medium text-gray-900",children:"Model Rate"}),o.jsx("div",{className:"text-xs text-gray-600",children:"Use model rates for missing items"})]})]}),o.jsxs("label",{className:"flex items-center gap-3 px-4 py-3 border-2 rounded-lg cursor-pointer transition-all hover:bg-gray-50",children:[o.jsx("input",{type:"radio",name:"equalisationMode",value:"PEER_MEDIAN",checked:l==="PEER_MEDIAN",onChange:v=>g(v.target.value),className:"w-4 h-4 text-blue-600"}),o.jsxs("div",{children:[o.jsx("div",{className:"font-medium text-gray-900",children:"Peer Median"}),o.jsx("div",{className:"text-xs text-gray-600",children:"Use median of other suppliers' rates"})]})]})]})]}),o.jsxs("div",{className:"flex items-start gap-3 p-4 bg-blue-50 rounded-lg border border-blue-200 mb-6",children:[o.jsx(wo,{className:"text-blue-600 flex-shrink-0 mt-0.5",size:20}),o.jsxs("div",{className:"text-sm text-blue-900",children:[o.jsx("p",{className:"font-medium mb-1",children:"About Equalisation"}),o.jsxs("p",{children:["Equalisation fills in missing scope items for each supplier to enable fair comparison.",o.jsx("strong",{children:" MODEL"})," mode uses your configured model rates, while",o.jsx("strong",{children:" PEER_MEDIAN"})," uses the median rate from other suppliers for the same system."]})]})]}),s.length>0&&o.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg border border-gray-200",children:[o.jsx("h4",{className:"font-medium text-gray-900 mb-2 text-sm",children:"Data Status"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 text-sm",children:[o.jsxs("div",{children:[o.jsx("span",{className:"text-gray-600",children:"Total Items:"}),o.jsx("span",{className:"ml-2 font-semibold text-gray-900",children:s.length})]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-gray-600",children:"Model Rates Available:"}),o.jsx("span",{className:"ml-2 font-semibold text-gray-900",children:s.filter(v=>v.modelRate!==null).length}),o.jsxs("span",{className:"ml-1 text-xs text-gray-500",children:["(",(s.filter(v=>v.modelRate!==null).length/s.length*100).toFixed(0),"%)"]})]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-gray-600",children:"Systems:"}),o.jsx("span",{className:"ml-2 font-semibold text-gray-900",children:new Set(s.map(v=>v.systemLabel)).size})]})]}),s.filter(v=>v.modelRate!==null).length===0&&l==="MODEL"&&o.jsxs("div",{className:"mt-3 p-3 bg-amber-50 border border-amber-200 rounded text-sm text-amber-800",children:[o.jsx("strong",{children:"Warning:"})," No model rates are configured. MODEL mode equalisation will not work. Please configure model rates in Settings or use PEER_MEDIAN mode instead."]})]})]}),a&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[o.jsx(si,{size:20,className:"text-gray-700"}),o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Supplier Totals Comparison"})]}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full border-collapse text-sm",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"bg-gray-50",children:[o.jsx("th",{className:"px-4 py-3 text-left font-medium text-gray-700 border border-gray-200",children:"Supplier"}),o.jsx("th",{className:"px-4 py-3 text-right font-medium text-gray-700 border border-gray-200",children:"Original Total"}),o.jsx("th",{className:"px-4 py-3 text-right font-medium text-gray-700 border border-gray-200",children:"Equalised Total"}),o.jsx("th",{className:"px-4 py-3 text-right font-medium text-gray-700 border border-gray-200",children:"Adjustment"}),o.jsx("th",{className:"px-4 py-3 text-right font-medium text-gray-700 border border-gray-200",children:"Adjustment %"}),o.jsx("th",{className:"px-4 py-3 text-right font-medium text-gray-700 border border-gray-200",children:"Items Added"})]})}),o.jsx("tbody",{children:a.supplierTotals.map((v,y)=>o.jsxs("tr",{className:"hover:bg-gray-50",children:[o.jsx("td",{className:"px-4 py-3 font-medium text-gray-900 border border-gray-200",children:v.supplierName}),o.jsxs("td",{className:"px-4 py-3 text-right text-gray-900 border border-gray-200",children:["$",v.originalTotal.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),o.jsxs("td",{className:"px-4 py-3 text-right font-semibold text-gray-900 border border-gray-200",children:["$",v.equalisedTotal.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),o.jsxs("td",{className:`px-4 py-3 text-right font-medium border border-gray-200 ${v.adjustment>0?"text-red-700":v.adjustment<0?"text-green-700":"text-gray-600"}`,children:[v.adjustment>=0?"+":"","$",v.adjustment.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),o.jsxs("td",{className:`px-4 py-3 text-right font-medium border border-gray-200 ${v.adjustmentPct>0?"text-red-700":v.adjustmentPct<0?"text-green-700":"text-gray-600"}`,children:[v.adjustmentPct>=0?"+":"",v.adjustmentPct.toFixed(1),"%"]}),o.jsx("td",{className:"px-4 py-3 text-right text-gray-900 border border-gray-200",children:v.equalisationCount})]},y))})]})})]}),a.equalisationLog.length>0&&o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[o.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Equalisation Audit Log",o.jsxs("span",{className:"ml-2 text-sm font-normal text-gray-600",children:["(",a.totalEqualisations," entries)"]})]}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full border-collapse text-sm",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"bg-gray-50",children:[o.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700 border border-gray-200",children:"Supplier"}),o.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700 border border-gray-200",children:"System"}),o.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700 border border-gray-200",children:"Reason"}),o.jsx("th",{className:"px-3 py-2 text-center font-medium text-gray-700 border border-gray-200",children:"Source"}),o.jsx("th",{className:"px-3 py-2 text-right font-medium text-gray-700 border border-gray-200",children:"Rate Used"}),o.jsx("th",{className:"px-3 py-2 text-right font-medium text-gray-700 border border-gray-200",children:"Quantity"}),o.jsx("th",{className:"px-3 py-2 text-right font-medium text-gray-700 border border-gray-200",children:"Total"})]})}),o.jsx("tbody",{children:a.equalisationLog.map((v,y)=>o.jsxs("tr",{className:"hover:bg-gray-50",children:[o.jsx("td",{className:"px-3 py-2 text-gray-900 border border-gray-200",children:v.supplierName}),o.jsx("td",{className:"px-3 py-2 border border-gray-200",children:o.jsxs("div",{className:"flex flex-col",children:[o.jsx("span",{className:"font-medium text-gray-900",children:v.systemLabel}),v.systemId!==v.systemLabel&&o.jsx("span",{className:"text-xs text-gray-500",children:v.systemId})]})}),o.jsx("td",{className:"px-3 py-2 text-gray-700 border border-gray-200",children:v.reason}),o.jsx("td",{className:"px-3 py-2 text-center border border-gray-200",children:o.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${v.source==="MODEL"?"bg-blue-100 text-blue-800":"bg-purple-100 text-purple-800"}`,children:v.source})}),o.jsxs("td",{className:"px-3 py-2 text-right text-gray-900 border border-gray-200",children:["$",v.rateUsed.toFixed(2)]}),o.jsx("td",{className:"px-3 py-2 text-right text-gray-900 border border-gray-200",children:v.quantity}),o.jsxs("td",{className:"px-3 py-2 text-right font-medium text-gray-900 border border-gray-200",children:["$",v.total.toFixed(2)]})]},y))})]})})]}),a.equalisationLog.length===0&&o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center",children:[o.jsx("p",{className:"text-gray-500",children:"No equalisation adjustments needed."}),o.jsx("p",{className:"text-gray-400 mt-2",children:"All suppliers have quoted all systems."})]})]}),o.jsx(m0,{currentStep:5,totalSteps:6,onBack:t,onNext:r,backLabel:"Back: Scope Matrix",nextLabel:"Next: Award Report"})]})}function bV({disabled:e,onExport:t,loading:r}){const[s,n]=j.useState(!1),a=j.useRef(null);j.useEffect(()=>{const l=c=>{a.current&&!a.current.contains(c.target)&&n(!1)};return s&&document.addEventListener("mousedown",l),()=>{document.removeEventListener("mousedown",l)}},[s]);const i=l=>{n(!1),t(l)};return o.jsxs("div",{className:"relative",ref:a,children:[o.jsxs("button",{onClick:()=>!e&&!r&&n(!s),disabled:e||r,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md font-medium transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed",title:e?"Export is available after a preferred supplier has been selected.":"Export documents",children:[o.jsx(fi,{size:16}),r?"Exporting...":"Export",o.jsx(ri,{size:14,className:`transition-transform ${s?"rotate-180":""}`})]}),s&&!e&&!r&&o.jsxs("div",{className:"absolute right-0 mt-2 w-64 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-50",children:[o.jsxs("button",{onClick:()=>i("site"),className:"w-full text-left px-4 py-2.5 hover:bg-gray-50 transition-colors",children:[o.jsx("div",{className:"font-medium text-gray-900 text-sm",children:"Site Scope Pack"}),o.jsx("div",{className:"text-xs text-gray-500 mt-0.5",children:"No pricing or commercial terms"})]}),o.jsx("div",{className:"border-t border-gray-100 my-1"}),o.jsxs("button",{onClick:()=>i("commercial"),className:"w-full text-left px-4 py-2.5 hover:bg-gray-50 transition-colors",children:[o.jsx("div",{className:"font-medium text-gray-900 text-sm",children:"Commercial Handover Pack"}),o.jsx("div",{className:"text-xs text-gray-500 mt-0.5",children:"Full contract details with pricing"})]})]})]})}function _V({projectId:e,onNavigateBack:t}){const[r,s]=j.useState("summary"),[n,a]=j.useState(!0),[i,l]=j.useState(null),[c,u]=j.useState(null),[d,f]=j.useState(!1),{currentOrganisation:h}=wa();j.useEffect(()=>{m()},[e]);const m=async()=>{a(!0);try{const{data:w}=await se.from("projects").select("id, name, client, updated_at, approved_quote_id").eq("id",e).maybeSingle();w&&l(w);const v=w==null?void 0:w.approved_quote_id;if(v){const{data:y}=await se.from("quotes").select("supplier_name, total_amount, updated_at").eq("id",v).maybeSingle();y&&u({supplier_name:y.supplier_name,total_amount:y.total_amount||0,awarded_date:y.updated_at})}}catch(w){console.error("Error loading contract manager data:",w)}finally{a(!1)}},x=async w=>{var v;if(c){f(!0);try{const{data:{session:y}}=await se.auth.getSession(),S=await fetch("https://cbankidsdfsvsgfygbzt.supabase.co/functions/v1/export_contract_manager",{method:"POST",headers:{Authorization:`Bearer ${(y==null?void 0:y.access_token)||"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNiYW5raWRzZGZzdnNnZnlnYnp0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMzMTk3NDgsImV4cCI6MjA3ODg5NTc0OH0.SXgc-9ZamplKeJm5_nl8J2-UzO7A0f8KbAnPZEmsiSo"}`,"Content-Type":"application/json"},body:JSON.stringify({projectId:e,mode:w})});if(!S.ok)throw new Error("Export failed");const k=await S.json(),_=new Date().toISOString().slice(0,16).replace(/[-:]/g,"").replace("T","_"),N=((v=i==null?void 0:i.name)==null?void 0:v.replace(/[^a-zA-Z0-9]/g,"_"))||"Project",C=w==="site"?`SiteScope_${N}_${_}.html`:`CommercialHandover_${N}_${_}.html`,B=new Blob([k.html],{type:"text/html"}),H=window.URL.createObjectURL(B),V=document.createElement("a");V.href=H,V.download=C,document.body.appendChild(V),V.click(),document.body.removeChild(V),window.URL.revokeObjectURL(H),alert(`${w==="site"?"Site Scope Pack":"Commercial Handover Pack"} generated successfully! Open the HTML file and use your browser's Print to PDF function.`)}catch(y){console.error("Export error:",y),alert("Could not generate export. Please try again or contact support.")}finally{f(!1)}}},p=[{id:"summary",label:"Contract Summary",icon:Yr},{id:"scope",label:"Scope & Systems",icon:tr},{id:"inclusions",label:"Inclusions & Exclusions",icon:kF},{id:"allowances",label:"Allowances",icon:Yr},{id:"variations",label:"Variations Log",icon:Je}];if(n)return o.jsx("div",{className:"p-6 max-w-full",children:o.jsx("div",{className:"flex items-center justify-center h-64",children:o.jsx("div",{className:"text-gray-500",children:"Loading contract information..."})})});const g=!!c;return o.jsxs("div",{className:"p-6 max-w-full",children:[o.jsxs("div",{className:"mb-6",children:[o.jsxs("button",{onClick:t,className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 mb-4 text-sm",children:[o.jsx(Po,{size:16}),"Back to Project Dashboard"]}),o.jsxs("div",{className:"flex items-start justify-between mb-4",children:[o.jsxs("div",{children:[o.jsxs("div",{className:"text-sm text-gray-500 mb-1",children:["Projects  ",(i==null?void 0:i.name)||"Unknown Project","  Contract Manager"]}),o.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:(i==null?void 0:i.name)||"Unknown Project"}),o.jsx("h2",{className:"text-xl text-gray-600 mt-1",children:"Contract Manager"})]}),o.jsxs("div",{className:"text-right text-sm",children:[o.jsx("div",{className:"text-gray-500",children:"Organisation"}),o.jsx("div",{className:"font-medium text-gray-900",children:(h==null?void 0:h.name)||"N/A"}),o.jsx("div",{className:"text-gray-500 mt-2",children:"Last Updated"}),o.jsx("div",{className:"font-medium text-gray-900",children:i!=null&&i.updated_at?new Date(i.updated_at).toLocaleDateString():"N/A"})]})]}),o.jsxs("div",{className:"flex items-center justify-between py-4 border-t border-b border-gray-200",children:[o.jsx("p",{className:"text-gray-600",children:"Manage your subcontract scope and handover information."}),o.jsx(bV,{disabled:!g,onExport:x,loading:d})]})]}),g?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"border-b border-gray-200 mb-6",children:o.jsx("div",{className:"flex gap-1",children:p.map(w=>{const v=w.icon;return o.jsxs("button",{onClick:()=>s(w.id),className:`flex items-center gap-2 px-4 py-3 font-medium transition-colors ${r===w.id?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-900"}`,children:[o.jsx(v,{size:16}),w.label]},w.id)})})}),o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[r==="summary"&&o.jsx(SV,{awardInfo:c,projectInfo:i}),r==="scope"&&o.jsx(kV,{projectId:e}),r==="inclusions"&&o.jsx(NV,{}),r==="allowances"&&o.jsx(EV,{}),r==="variations"&&o.jsx(jV,{})]})]}):o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-12 text-center",children:[o.jsx(Je,{className:"mx-auto text-gray-400 mb-4",size:48}),o.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"No award selected"}),o.jsx("p",{className:"text-gray-600 mb-6",children:"Select a preferred supplier in your Award Report before using Contract Manager."}),o.jsx("button",{onClick:()=>window.location.href="#/reports",className:"px-6 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-md font-medium transition-colors",children:"Go to Reports"})]})]})}function SV({awardInfo:e,projectInfo:t}){return o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Contract Summary"}),o.jsxs("div",{className:"grid grid-cols-2 gap-6 mb-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Subcontractor"}),o.jsx("div",{className:"text-base text-gray-900",children:(e==null?void 0:e.supplier_name)||"TBC"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Subcontract Sum"}),o.jsxs("div",{className:"text-base font-semibold text-gray-900",children:["$",e!=null&&e.total_amount?e.total_amount.toLocaleString():"0.00"]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Main Contractor"}),o.jsx("div",{className:"text-base text-gray-900",children:"TBC"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Client / End User"}),o.jsx("div",{className:"text-base text-gray-900",children:(t==null?void 0:t.client)||"TBC"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Payment Terms"}),o.jsx("div",{className:"text-base text-gray-900",children:"20th following month, 22 working days payment"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Retentions"}),o.jsx("div",{className:"text-base text-gray-900",children:"3% standard retention"})]}),o.jsxs("div",{className:"col-span-2",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Liquidated Damages (LDs)"}),o.jsx("div",{className:"text-base text-gray-900",children:"None specified"})]})]}),o.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 text-sm text-blue-800",children:[o.jsx(Je,{size:16,className:"inline mr-2"}),"These values will be refined as Contract Manager is integrated with your commercial data."]})]})}function kV({projectId:e}){return o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Scope & Systems"}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full",children:[o.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"System"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Rating"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Notes"})]})}),o.jsxs("tbody",{className:"divide-y divide-gray-200",children:[o.jsxs("tr",{children:[o.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:"Fire batts & mastic"}),o.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:"FRR 60/60/60"}),o.jsx("td",{className:"px-4 py-3 text-sm text-gray-500",children:"See scope matrix"})]}),o.jsxs("tr",{children:[o.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:"Intumescent paint to steel"}),o.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:"FRR 90/90/90"}),o.jsx("td",{className:"px-4 py-3 text-sm text-gray-500",children:"See scope matrix"})]})]})]})}),o.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 text-sm text-blue-800 mt-4",children:[o.jsx(Je,{size:16,className:"inline mr-2"}),"Scope & Systems will be automatically populated from the Scope Matrix in a future update."]})]})}function NV(){return o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Inclusions & Exclusions"}),o.jsxs("div",{className:"grid grid-cols-2 gap-8",children:[o.jsxs("div",{children:[o.jsx("h4",{className:"text-base font-semibold text-gray-900 mb-3",children:"Inclusions"}),o.jsxs("ul",{className:"space-y-2 text-sm text-gray-700",children:[o.jsxs("li",{className:"flex items-start gap-2",children:[o.jsx("span",{className:"text-green-600 mt-1",children:""}),o.jsx("span",{children:"All passive fire stopping to service penetrations as per fire engineering report and drawings."})]}),o.jsxs("li",{className:"flex items-start gap-2",children:[o.jsx("span",{className:"text-green-600 mt-1",children:""}),o.jsx("span",{children:"Intumescent coatings to structural steel members identified as requiring FRR."})]}),o.jsxs("li",{className:"flex items-start gap-2",children:[o.jsx("span",{className:"text-green-600 mt-1",children:""}),o.jsx("span",{children:"Supply of QA documentation including labels, photos, and PS3."})]}),o.jsxs("li",{className:"flex items-start gap-2",children:[o.jsx("span",{className:"text-green-600 mt-1",children:""}),o.jsx("span",{children:"All materials, labour, and equipment necessary to complete the works."})]}),o.jsxs("li",{className:"flex items-start gap-2",children:[o.jsx("span",{className:"text-green-600 mt-1",children:""}),o.jsx("span",{children:"Site-specific SWMS and induction for all personnel."})]})]})]}),o.jsxs("div",{children:[o.jsx("h4",{className:"text-base font-semibold text-gray-900 mb-3",children:"Exclusions"}),o.jsxs("ul",{className:"space-y-2 text-sm text-gray-700",children:[o.jsxs("li",{className:"flex items-start gap-2",children:[o.jsx("span",{className:"text-red-600 mt-1",children:""}),o.jsx("span",{children:"Remediation of pre-existing, non-compliant fire stopping."})]}),o.jsxs("li",{className:"flex items-start gap-2",children:[o.jsx("span",{className:"text-red-600 mt-1",children:""}),o.jsx("span",{children:"Temporary services penetrations."})]}),o.jsxs("li",{className:"flex items-start gap-2",children:[o.jsx("span",{className:"text-red-600 mt-1",children:""}),o.jsx("span",{children:"Access equipment and out-of-hours work unless specifically agreed."})]}),o.jsxs("li",{className:"flex items-start gap-2",children:[o.jsx("span",{className:"text-red-600 mt-1",children:""}),o.jsx("span",{children:"Works to penetrations not shown on drawings or schedules."})]}),o.jsxs("li",{className:"flex items-start gap-2",children:[o.jsx("span",{className:"text-red-600 mt-1",children:""}),o.jsx("span",{children:"Delays caused by incomplete services installations or lack of access."})]})]})]})]}),o.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 text-sm text-blue-800 mt-6",children:[o.jsx(Je,{size:16,className:"inline mr-2"}),"Inclusions and exclusions will later be editable and exported as part of the Handover Pack."]})]})}function EV(){return o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Allowances & Provisional Sums"}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full",children:[o.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Description"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Qty / Basis"}),o.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Rate"}),o.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Total"})]})}),o.jsxs("tbody",{className:"divide-y divide-gray-200",children:[o.jsxs("tr",{children:[o.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:"Remedial fire stopping allowance"}),o.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:"20 openings"}),o.jsx("td",{className:"px-4 py-3 text-sm text-gray-700 text-right",children:"$250.00"}),o.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900 text-right",children:"$5,000.00"})]}),o.jsxs("tr",{children:[o.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:"Access equipment allowance"}),o.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:"Lump sum"}),o.jsx("td",{className:"px-4 py-3 text-sm text-gray-700 text-right",children:"-"}),o.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900 text-right",children:"$8,500.00"})]}),o.jsxs("tr",{children:[o.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:"Provisional sum - additional works"}),o.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:"As directed"}),o.jsx("td",{className:"px-4 py-3 text-sm text-gray-700 text-right",children:"-"}),o.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900 text-right",children:"$10,000.00"})]}),o.jsxs("tr",{className:"bg-gray-50",children:[o.jsx("td",{colSpan:3,className:"px-4 py-3 text-sm font-semibold text-gray-900",children:"Total Allowances"}),o.jsx("td",{className:"px-4 py-3 text-sm font-bold text-gray-900 text-right",children:"$23,500.00"})]})]})]})}),o.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 text-sm text-blue-800 mt-4",children:[o.jsx(Je,{size:16,className:"inline mr-2"}),"Future versions will pull allowances from estimating data and allow editing."]})]})}function jV(){return o.jsxs("div",{className:"text-center py-12",children:[o.jsx(Je,{className:"mx-auto text-gray-400 mb-4",size:48}),o.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Variations Log"}),o.jsx("p",{className:"text-gray-600",children:"Track proposed and approved variations here in a future update."})]})}function TV({projects:e,projectId:t,onNavigate:r}){const[s,n]=j.useState(""),[a,i]=j.useState(null),[l,c]=j.useState(!1),[u,d]=j.useState(null);j.useEffect(()=>{if(t&&e.length>0&&!a){const _=e.find(N=>N.id===t&&N.has_report);_&&i(_)}},[t,e]);const f=e.filter(_=>_.workflow_complete),h=f.filter(_=>_.name.toLowerCase().includes(s.toLowerCase())||_.client_reference.toLowerCase().includes(s.toLowerCase())),m=h.filter(_=>!_.has_report),x=h.filter(_=>_.has_report),p=()=>{a!=null&&a.report_id&&(r==null||r("award-report",a.report_id))},g=async(_=!1)=>{var N,C,B,H,V,K,Y;if(a){c(!0),d(null);try{const ie=await fetch("https://cbankidsdfsvsgfygbzt.supabase.co/functions/v1/compute_award_report",{method:"POST",headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNiYW5raWRzZGZzdnNnZnlnYnp0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMzMTk3NDgsImV4cCI6MjA3ODg5NTc0OH0.SXgc-9ZamplKeJm5_nl8J2-UzO7A0f8KbAnPZEmsiSo","Content-Type":"application/json"},body:JSON.stringify({projectId:a.id,force:_})});if(!ie.ok){const R=await ie.text();throw new Error(`Server returned ${ie.status}: ${R}`)}const W=await ie.json();if(!W||!W.reportId)throw new Error("No report ID returned from server");const{data:U}=await se.from("award_reports").select("id, generated_at, result_json").eq("id",W.reportId).single(),he=((B=(C=(N=U==null?void 0:U.result_json)==null?void 0:N.awardSummary)==null?void 0:C.suppliers)==null?void 0:B.length)||0,be=((Y=(K=(V=(H=U==null?void 0:U.result_json)==null?void 0:H.awardSummary)==null?void 0:V.suppliers)==null?void 0:K[0])==null?void 0:Y.coveragePercent)||0;i({...a,has_report:!0,report_id:W.reportId,report_generated_at:U==null?void 0:U.generated_at,report_quotes_count:he,report_coverage_percent:Math.round(be)}),r==null||r("award-report",W.reportId)}catch(q){console.error("Error computing award report:",q),d(q.message||"Failed to compute award report")}finally{c(!1)}}},w=()=>{g(!1)},v=()=>{g(!0)},y=async()=>{var _,N,C,B,H,V,K;if(a!=null&&a.report_id)try{const{data:Y}=await se.from("award_reports").select("id, generated_at, result_json").eq("id",a.report_id).single();if(Y){const q=((C=(N=(_=Y.result_json)==null?void 0:_.awardSummary)==null?void 0:N.suppliers)==null?void 0:C.length)||0,X=((K=(V=(H=(B=Y.result_json)==null?void 0:B.awardSummary)==null?void 0:H.suppliers)==null?void 0:V[0])==null?void 0:K.coveragePercent)||0;i({...a,report_generated_at:Y.generated_at,report_quotes_count:q,report_coverage_percent:Math.round(X)})}}catch(Y){console.error("Error refreshing project metadata:",Y)}};j.useEffect(()=>{a!=null&&a.has_report&&a.report_id&&y()},[a==null?void 0:a.id]);const b=async()=>{if(a!=null&&a.report_id)try{const{data:_,error:N}=await se.from("award_reports").select("result_json, generated_at").eq("id",a.report_id).single();if(N||!_){console.error("Error loading report:",N);return}const B=_.result_json.awardSummary,H=`
        <!DOCTYPE html>
        <html>
        <head>
          <meta charset="UTF-8">
          <title>Award Report - ${a.name}</title>
          <style>
            body { font-family: Arial, sans-serif; padding: 40px; line-height: 1.6; color: #333; }
            h1 { color: #1e40af; border-bottom: 3px solid #3b82f6; padding-bottom: 10px; margin-bottom: 30px; }
            h2 { color: #1e40af; margin-top: 30px; margin-bottom: 15px; border-bottom: 1px solid #e5e7eb; padding-bottom: 8px; }
            h3 { color: #374151; margin-top: 20px; }
            table { width: 100%; border-collapse: collapse; margin: 20px 0; }
            th, td { padding: 12px; text-align: left; border: 1px solid #d1d5db; }
            th { background-color: #3b82f6; color: white; font-weight: 600; }
            tr:nth-child(even) { background-color: #f9fafb; }
            .meta { color: #6b7280; font-size: 14px; margin-bottom: 30px; }
            .supplier-section { margin: 30px 0; padding: 20px; background: #f9fafb; border-radius: 8px; }
            .recommendation { background: #dbeafe; padding: 15px; border-left: 4px solid #3b82f6; margin: 20px 0; }
          </style>
        </head>
        <body>
          <h1>Award Recommendation Report</h1>
          <div class="meta">
            <p><strong>Project:</strong> ${a.name}</p>
            <p><strong>Client:</strong> ${a.client_reference}</p>
            <p><strong>Generated:</strong> ${new Date(_.generated_at).toLocaleString()}</p>
            <p><strong>Equalisation Mode:</strong> ${B.equalisationMode}</p>
          </div>

          <h2>Supplier Rankings</h2>
          <table>
            <thead>
              <tr>
                <th>Rank</th>
                <th>Supplier</th>
                <th>Adjusted Total</th>
                <th>Risk Score</th>
                <th>Coverage %</th>
                <th>Items Quoted</th>
              </tr>
            </thead>
            <tbody>
              ${B.suppliers.map((q,X)=>`
                <tr>
                  <td>${X+1}</td>
                  <td>${q.supplierName}</td>
                  <td>$${q.adjustedTotal.toLocaleString()}</td>
                  <td>${q.riskScore}</td>
                  <td>${q.coveragePercent}%</td>
                  <td>${q.itemsQuoted}</td>
                </tr>
              `).join("")}
            </tbody>
          </table>

          <h2>Recommendations</h2>
          ${B.recommendations.map(q=>`
            <div class="recommendation">
              <h3>${q.type.replace("_"," ")}</h3>
              <p><strong>Supplier:</strong> ${q.supplier.supplierName}</p>
              <p><strong>Reason:</strong> ${q.reason}</p>
            </div>
          `).join("")}
        </body>
        </html>
      `,V=new Blob([H],{type:"text/html"}),K=URL.createObjectURL(V),Y=window.open(K,"_blank","width=1024,height=768");if(Y)Y.onload=()=>{setTimeout(()=>{Y.print(),setTimeout(()=>{URL.revokeObjectURL(K)},1e3)},500)};else{const q=document.createElement("a");q.href=K,q.download=`Award_Report_${a.name.replace(/[^a-z0-9]/gi,"_")}.html`,document.body.appendChild(q),q.click(),document.body.removeChild(q),setTimeout(()=>URL.revokeObjectURL(K),1e3)}}catch(_){console.error("Error exporting PDF:",_)}},S=()=>{a&&(r==null||r("award-report"))},k=_=>new Date(_).toLocaleDateString("en-NZ",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"});return o.jsxs("div",{className:"h-full flex flex-col bg-gray-50",children:[o.jsx("div",{className:"bg-white border-b border-gray-200 px-6 py-4",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-10 h-10 bg-blue-500 rounded-lg flex items-center justify-center",children:o.jsx(Yr,{className:"w-6 h-6 text-white"})}),o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Reports Hub"}),o.jsx("p",{className:"text-sm text-gray-500",children:"Manage and generate award reports"})]})]})}),o.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[o.jsxs("div",{className:"w-96 bg-white border-r border-gray-200 flex flex-col",children:[o.jsx("div",{className:"p-4 border-b border-gray-200",children:o.jsxs("div",{className:"relative",children:[o.jsx(kd,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),o.jsx("input",{type:"text",placeholder:"Search projects...",value:s,onChange:_=>n(_.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),o.jsxs("div",{className:"flex-1 overflow-y-auto",children:[m.length>0&&o.jsxs("div",{className:"mb-6",children:[o.jsx("div",{className:"px-4 py-2 bg-amber-50 border-b border-amber-100",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Je,{className:"w-4 h-4 text-amber-600"}),o.jsxs("span",{className:"text-sm font-medium text-amber-900",children:["Needs Report (",m.length,")"]})]})}),o.jsx("div",{className:"divide-y divide-gray-100",children:m.map(_=>o.jsxs("button",{onClick:()=>i(_),className:`w-full text-left px-4 py-3 hover:bg-gray-50 transition-colors ${(a==null?void 0:a.id)===_.id?"bg-blue-50 border-l-4 border-blue-500":""}`,children:[o.jsx("div",{className:"font-medium text-gray-900 mb-1",children:_.name}),o.jsx("div",{className:"text-xs text-gray-500 mb-1",children:_.client_reference}),o.jsxs("div",{className:"text-xs text-gray-400",children:["Updated ",k(_.updated_at)]})]},_.id))})]}),x.length>0&&o.jsxs("div",{children:[o.jsx("div",{className:"px-4 py-2 bg-green-50 border-b border-green-100",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(im,{className:"w-4 h-4 text-green-600"}),o.jsxs("span",{className:"text-sm font-medium text-green-900",children:["With Report (",x.length,")"]})]})}),o.jsx("div",{className:"divide-y divide-gray-100",children:x.map(_=>o.jsxs("button",{onClick:()=>i(_),className:`w-full text-left px-4 py-3 hover:bg-gray-50 transition-colors ${(a==null?void 0:a.id)===_.id?"bg-blue-50 border-l-4 border-blue-500":""}`,children:[o.jsx("div",{className:"font-medium text-gray-900 mb-1",children:_.name}),o.jsx("div",{className:"text-xs text-gray-500 mb-1",children:_.client_reference}),o.jsxs("div",{className:"text-xs text-gray-400",children:["Updated ",k(_.updated_at)]})]},_.id))})]}),f.length===0&&o.jsxs("div",{className:"flex flex-col items-center justify-center h-64 px-6 text-center",children:[o.jsx(Je,{className:"w-12 h-12 mb-3 text-amber-400"}),o.jsx("p",{className:"text-sm font-medium text-gray-900 mb-2",children:"No Report-Ready Projects"}),o.jsx("p",{className:"text-xs text-gray-500 max-w-xs",children:"Projects must complete all workflow steps (Import Quotes  Review & Clean  Scope Matrix) before they appear here."})]}),f.length>0&&h.length===0&&o.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-gray-400",children:[o.jsx(kd,{className:"w-12 h-12 mb-3"}),o.jsx("p",{className:"text-sm",children:"No projects match your search"})]})]})]}),o.jsx("div",{className:"flex-1 overflow-y-auto",children:a?o.jsxs("div",{className:"p-8",children:[o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6",children:[o.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-4",children:a.name}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{className:"flex items-center gap-3 text-gray-600",children:[o.jsx(yo,{className:"w-5 h-5 text-gray-400"}),o.jsxs("div",{children:[o.jsx("div",{className:"text-xs text-gray-500 uppercase",children:"Client"}),o.jsx("div",{className:"font-medium",children:a.client_reference||"Not specified"})]})]}),o.jsxs("div",{className:"flex items-center gap-3 text-gray-600",children:[o.jsx(AF,{className:"w-5 h-5 text-gray-400"}),o.jsxs("div",{children:[o.jsx("div",{className:"text-xs text-gray-500 uppercase",children:"Reference"}),o.jsx("div",{className:"font-medium",children:a.client_reference||"N/A"})]})]})]})]}),a.has_report?o.jsxs(o.Fragment,{children:[u&&o.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:o.jsxs("div",{className:"flex items-center gap-2 text-red-800",children:[o.jsx(Je,{className:"w-5 h-5"}),o.jsx("span",{className:"font-medium",children:u})]})}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Report Actions"}),o.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4",children:o.jsxs("div",{className:"flex items-start gap-2",children:[o.jsx(Je,{className:"w-5 h-5 text-blue-600 mt-0.5 flex-shrink-0"}),o.jsx("p",{className:"text-sm text-blue-800",children:"This report is cached. Changes to quotes will show after you click Regenerate."})]})}),o.jsxs("div",{className:"flex flex-wrap gap-3",children:[o.jsx("button",{onClick:p,disabled:l,className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium",children:"View Report"}),o.jsx("button",{onClick:v,disabled:l,className:"flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium",children:l?o.jsxs(o.Fragment,{children:[o.jsx(js,{className:"w-4 h-4 animate-spin"}),"Regenerating..."]}):o.jsxs(o.Fragment,{children:[o.jsx(Cr,{className:"w-4 h-4"}),"Regenerate"]})}),o.jsxs("button",{onClick:b,disabled:l,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium",children:[o.jsx(px,{className:"w-4 h-4"}),"Export PDF"]}),o.jsxs("button",{onClick:S,disabled:l,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium",children:[o.jsx(zF,{className:"w-4 h-4"}),"Export Excel"]})]})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Report Details"}),o.jsxs("div",{className:"grid grid-cols-3 gap-6",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:o.jsx(CS,{className:"w-5 h-5 text-blue-600"})}),o.jsxs("div",{children:[o.jsx("div",{className:"text-xs text-gray-500 uppercase",children:"Generated"}),o.jsx("div",{className:"font-medium text-gray-900",children:a.report_generated_at?k(a.report_generated_at):"N/A"})]})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:o.jsx(Yr,{className:"w-5 h-5 text-green-600"})}),o.jsxs("div",{children:[o.jsx("div",{className:"text-xs text-gray-500 uppercase",children:"Quotes Included"}),o.jsx("div",{className:"font-medium text-gray-900",children:a.report_quotes_count||0})]})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center",children:o.jsx(si,{className:"w-5 h-5 text-purple-600"})}),o.jsxs("div",{children:[o.jsx("div",{className:"text-xs text-gray-500 uppercase",children:"Coverage"}),o.jsx("div",{className:"font-medium text-gray-900",children:a.report_coverage_percent?`${a.report_coverage_percent}%`:"N/A"})]})]})]})]})]}):o.jsxs(o.Fragment,{children:[u&&o.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:o.jsxs("div",{className:"flex items-center gap-2 text-red-800",children:[o.jsx(Je,{className:"w-5 h-5"}),o.jsx("span",{className:"font-medium",children:u})]})}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center",children:[o.jsx("div",{className:"w-16 h-16 bg-amber-100 rounded-full flex items-center justify-center mx-auto mb-4",children:o.jsx(Je,{className:"w-8 h-8 text-amber-600"})}),o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Report Available"}),o.jsx("p",{className:"text-gray-500 mb-6",children:"Generate an award report to compare quotes and make award decisions."}),o.jsx("button",{onClick:w,disabled:l,className:"px-6 py-3 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium inline-flex items-center gap-2",children:l?o.jsxs(o.Fragment,{children:[o.jsx(js,{className:"w-5 h-5 animate-spin"}),"Generating Report..."]}):o.jsxs(o.Fragment,{children:[o.jsx(Yr,{className:"w-5 h-5"}),"Generate Award Report"]})})]})]})]}):o.jsx("div",{className:"flex items-center justify-center h-full",children:o.jsxs("div",{className:"text-center text-gray-400",children:[o.jsx(xx,{className:"w-16 h-16 mx-auto mb-4"}),o.jsx("p",{className:"text-lg",children:"Select a project to view details"})]})})})]})]})}function ej({projectId:e,reportId:t,onToast:r,onNavigate:s}){var Ce,P;const[n,a]=j.useState([]),[i,l]=j.useState(null),[c,u]=j.useState(null),[d,f]=j.useState("MODEL"),[h,m]=j.useState(!0),[x,p]=j.useState(null),[g,w]=j.useState(!1),[v,y]=j.useState(!1),[b,S]=j.useState(!1),[k,_]=j.useState(t||null),[N,C]=j.useState(""),[B,H]=j.useState(!1),[V,K]=j.useState(new Map),Y=j.useRef(null),q=j.useRef(null);j.useEffect(()=>{X(),t?W(t):ie()},[t,e]),j.useEffect(()=>{const ce=ue=>{Y.current&&!Y.current.contains(ue.target)&&w(!1),q.current&&!q.current.contains(ue.target)&&y(!1)};return document.addEventListener("mousedown",ce),()=>document.removeEventListener("mousedown",ce)},[]);const X=async()=>{try{const{data:ce}=await se.from("projects").select("id, name, client, approved_quote_id").eq("id",e).maybeSingle();ce&&p(ce)}catch(ce){console.error("Error loading project:",ce)}},ie=async()=>{var ce;try{m(!0);const{data:ue,error:Ee}=await se.from("award_reports").select("*").eq("project_id",e).order("created_at",{ascending:!1}).limit(1).maybeSingle();if(Ee||!ue)throw new Error("No report found");ue.result_json&&(a(ue.result_json.comparisonData||[]),l(ue.result_json.awardSummary||null),u(ue.result_json.aiAnalysis||null),(ce=ue.params_json)!=null&&ce.equalisationMode&&f(ue.params_json.equalisationMode)),_(ue.id),C(ue.created_at);const{data:T}=await se.from("quotes").select("id, supplier_name").eq("project_id",ue.project_id);if(T){const G=new Map;T.forEach(Q=>G.set(Q.supplier_name,Q.id)),K(G)}}catch(ue){console.error("Error loading report:",ue),r==null||r(ue.message||"Failed to load report","error")}finally{m(!1)}},W=async ce=>{var ue;try{m(!0);const{data:Ee,error:T}=await se.from("award_reports").select("*").eq("id",ce).maybeSingle();if(T||!Ee)throw new Error("Report not found");Ee.result_json&&(a(Ee.result_json.comparisonData||[]),l(Ee.result_json.awardSummary||null),u(Ee.result_json.aiAnalysis||null),(ue=Ee.params_json)!=null&&ue.equalisationMode&&f(Ee.params_json.equalisationMode)),_(Ee.id),C(Ee.created_at);const{data:G}=await se.from("quotes").select("id, supplier_name").eq("project_id",Ee.project_id);if(G){const Q=new Map;G.forEach(me=>Q.set(me.supplier_name,me.id)),K(Q)}}catch(Ee){console.error("Error loading report:",Ee),r==null||r(Ee.message||"Failed to load report","error")}finally{m(!1)}},U=async()=>{try{S(!0);const Ee=await fetch("https://cbankidsdfsvsgfygbzt.supabase.co/functions/v1/compute_award_report",{method:"POST",headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNiYW5raWRzZGZzdnNnZnlnYnp0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMzMTk3NDgsImV4cCI6MjA3ODg5NTc0OH0.SXgc-9ZamplKeJm5_nl8J2-UzO7A0f8KbAnPZEmsiSo","Content-Type":"application/json"},body:JSON.stringify({projectId:e,force:!0})});if(!Ee.ok)throw new Error("Failed to regenerate report");const T=await Ee.json();T.reportId&&(await W(T.reportId),r==null||r("Report recalculated successfully","success"))}catch(ce){console.error("Error recalculating:",ce),r==null||r(ce.message||"Failed to recalculate report","error")}finally{S(!1)}},he=async()=>{var ce,ue,Ee;if(!i||n.length===0){r==null||r("No itemized comparison data available to export.","error");return}try{const G=await fetch("/templates/Itemized_Comparison_Global_1.xlsx");if(!G.ok)throw new Error("Failed to load template file");const Q=await G.arrayBuffer(),me=wc(Q,{type:"array",cellStyles:!0}),fe=me.Sheets[me.SheetNames[0]];fe.A2={t:"s",v:`Project: ${(x==null?void 0:x.name)||e}`},fe.A3={t:"s",v:`Generated: ${new Date().toLocaleString()}`};const oe=i.suppliers,ke=3;fe["!merges"]=[];for(let nt=0;nt<oe.length;nt++){const He=ke+nt*2,Be=it.encode_cell({r:4,c:He});fe[Be]={t:"s",v:oe[nt].supplierName,s:((ce=fe[Be])==null?void 0:ce.s)||{}},fe["!merges"].push({s:{r:4,c:He},e:{r:4,c:He+1}});const xe=it.encode_cell({r:5,c:He}),Xe=it.encode_cell({r:5,c:He+1});fe[xe]={t:"s",v:"Unit Rate",s:((ue=fe[xe])==null?void 0:ue.s)||{}},fe[Xe]={t:"s",v:"Total",s:((Ee=fe[Xe])==null?void 0:Ee.s)||{}}}const we=6,Pe=fe["!ref"]?it.decode_range(fe["!ref"]):{s:{r:0,c:0},e:{r:5,c:2}};n.forEach((nt,He)=>{const Be=we+He;fe[it.encode_cell({r:Be,c:0})]={t:"s",v:nt.description||""},fe[it.encode_cell({r:Be,c:1})]={t:"n",v:nt.quantity||0},fe[it.encode_cell({r:Be,c:2})]={t:"s",v:nt.unit||""},oe.forEach((xe,Xe)=>{var ve;const pt=(ve=nt.suppliers)==null?void 0:ve[xe.supplierName],tt=ke+Xe*2,ar=tt+1;pt&&pt.unitPrice!==null&&!isNaN(pt.unitPrice)?(fe[it.encode_cell({r:Be,c:tt})]={t:"n",v:pt.unitPrice,z:'"$"#,##0.00'},fe[it.encode_cell({r:Be,c:ar})]={t:"n",v:pt.total,z:'"$"#,##0.00'}):(fe[it.encode_cell({r:Be,c:tt})]={t:"s",v:"N/A"},fe[it.encode_cell({r:Be,c:ar})]={t:"s",v:"N/A"})}),Pe.e.r=Math.max(Pe.e.r,Be),Pe.e.c=Math.max(Pe.e.c,ke+oe.length*2-1)}),fe["!ref"]=it.encode_range(Pe);const et=`Itemized_Comparison_${((x==null?void 0:x.name)||"Project").replace(/[^a-zA-Z0-9]/g,"_")}_${new Date().toISOString().split("T")[0]}.xlsx`;fg(me,et),w(!1),r==null||r("Itemized comparison exported successfully","success")}catch(T){console.error("Error exporting itemized comparison:",T),r==null||r("Failed to export itemized comparison","error")}},be=()=>{w(!1),window.print()},R=async ce=>{const ue=V.get(ce);if(!ue){r==null||r("Quote not found","error");return}try{const{error:Ee}=await se.from("projects").update({approved_quote_id:ue,updated_at:new Date().toISOString()}).eq("id",e);if(Ee)throw new Error(Ee.message);const{error:T}=await se.from("quotes").update({status:"accepted",updated_at:new Date().toISOString()}).eq("id",ue);if(T)throw new Error(T.message);r==null||r(`Approved ${ce}`,"success"),x&&p({...x,approved_quote_id:ue})}catch(Ee){console.error("Error approving quote:",Ee),r==null||r(Ee.message||"Failed to approve quote","error")}};if(h)return o.jsx("div",{className:"flex items-center justify-center h-64",children:o.jsx("div",{className:"w-8 h-8 border-4 border-orange-500 border-t-transparent rounded-full animate-spin"})});if(!i||i.suppliers.length===0)return o.jsx("div",{className:"p-8",children:o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-12 text-center",children:[o.jsx(vf,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),o.jsx("p",{className:"text-gray-900 text-lg font-semibold mb-2",children:"No Award Report Available"}),o.jsx("p",{className:"text-gray-600",children:"Generate a report from the Reports Hub to view analysis."})]})});const M=i.recommendations.find(ce=>ce.type==="BEST_VALUE"),O=i.recommendations.find(ce=>ce.type==="LOWEST_RISK"),z=i.recommendations.find(ce=>ce.type==="BALANCED"),J=ce=>new Intl.NumberFormat("en-NZ",{style:"currency",currency:"NZD",minimumFractionDigits:2}).format(ce),pe=ce=>new Date(ce).toLocaleDateString("en-NZ",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),ge=ce=>{switch(ce){case"MODEL":return"Model";case"PEER_MEDIAN":return"Client";case"SIMPLE":return"Simple"}},ne=((Ce=c==null?void 0:c.gapsAndRisks)==null?void 0:Ce.filter(ce=>ce.severity==="HIGH"))||[],ae=((P=c==null?void 0:c.gapsAndRisks)==null?void 0:P.filter(ce=>ce.severity!=="HIGH"))||[];return o.jsxs("div",{className:"min-h-screen bg-gray-50",children:[o.jsx("style",{children:`
          @media print {
            body * {
              visibility: hidden;
            }
            #printable-report, #printable-report * {
              visibility: visible;
            }
            #printable-report {
              position: absolute;
              left: 0;
              top: 0;
              width: 100%;
            }
            .no-print {
              display: none !important;
            }
          }
        `}),o.jsx("div",{className:"bg-white border-b border-gray-200 no-print",children:o.jsx("div",{className:"max-w-7xl mx-auto px-6 py-4",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsxs("button",{onClick:()=>s==null?void 0:s("reports"),className:"flex items-center gap-2 text-sm text-gray-600 hover:text-gray-900 transition-colors",children:[o.jsx(Po,{size:16}),"Back to Reports"]}),o.jsx("div",{className:"h-4 w-px bg-gray-300"}),o.jsxs("div",{children:[o.jsxs("h1",{className:"text-xl font-bold text-gray-900",children:[(x==null?void 0:x.name)||"Project","  Report"]}),o.jsxs("p",{className:"text-xs text-gray-500 mt-0.5",children:["Generated ",pe(N),' " Award Recommendation & Itemized Comparison']})]})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsxs("div",{className:"inline-flex rounded-lg border border-gray-300 bg-white shadow-sm overflow-hidden",children:[o.jsx("button",{className:`px-3 py-1.5 text-sm font-medium transition-colors ${d==="MODEL"?"bg-gray-900 text-white":"hover:bg-gray-50 text-gray-700"}`,onClick:()=>f("MODEL"),children:"Model"}),o.jsx("button",{className:`px-3 py-1.5 text-sm font-medium border-l border-gray-300 transition-colors ${d==="PEER_MEDIAN"?"bg-gray-900 text-white":"hover:bg-gray-50 text-gray-700"}`,onClick:()=>f("PEER_MEDIAN"),children:"Client"}),o.jsx("button",{className:`px-3 py-1.5 text-sm font-medium border-l border-gray-300 transition-colors ${d==="SIMPLE"?"bg-gray-900 text-white":"hover:bg-gray-50 text-gray-700"}`,onClick:()=>f("SIMPLE"),children:"Simple"})]}),o.jsxs("div",{className:"relative",ref:Y,children:[o.jsxs("button",{onClick:()=>w(!g),className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors text-sm font-medium",children:[o.jsx(fi,{size:16}),"Export report",o.jsx(ri,{size:14,className:`transition-transform ${g?"rotate-180":""}`})]}),g&&o.jsx("div",{className:"absolute right-0 mt-2 w-56 bg-white rounded-lg shadow-lg border border-gray-200 z-50",children:o.jsxs("div",{className:"py-1",children:[o.jsxs("button",{onClick:be,className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center gap-2",children:[o.jsx(px,{size:16}),"Export PDF"]}),o.jsxs("button",{onClick:he,disabled:n.length===0,className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[o.jsx(lm,{size:16}),"Export items (Excel)"]})]})})]}),o.jsxs("div",{className:"relative",ref:q,children:[o.jsxs("button",{onClick:()=>y(!v),className:"flex items-center gap-2 px-3 py-2 border border-gray-300 bg-white text-gray-700 rounded-md hover:bg-gray-50 transition-colors text-sm",children:[o.jsx(DF,{size:16}),"More actions"]}),v&&o.jsx("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 z-50",children:o.jsxs("div",{className:"py-1",children:[o.jsxs("button",{onClick:()=>{y(!1)},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center gap-2",children:[o.jsx(LF,{size:16}),"Rename report"]}),o.jsxs("button",{onClick:()=>{y(!1),U()},disabled:b,className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center gap-2 disabled:opacity-50",children:[o.jsx(Cr,{size:16,className:b?"animate-spin":""}),"Regenerate report"]}),o.jsxs("button",{onClick:()=>{y(!1)},className:"w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50 flex items-center gap-2",children:[o.jsx(bo,{size:16}),"Delete report"]})]})})]}),o.jsxs("button",{onClick:U,disabled:b,className:"flex items-center gap-2 px-3 py-2 border border-gray-300 bg-white text-gray-700 rounded-md hover:bg-gray-50 disabled:opacity-50 transition-colors text-sm",children:[o.jsx(Cr,{size:16,className:b?"animate-spin":""}),"Recalculate"]})]})]})})}),o.jsxs("div",{id:"printable-report",className:"max-w-7xl mx-auto px-6 py-8",children:[o.jsx("div",{className:"bg-gradient-to-br from-blue-50 to-sky-50 rounded-lg border border-blue-100 p-8 mb-6",children:o.jsxs("div",{className:"flex items-start justify-between",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Award Recommendation Report"}),o.jsx("p",{className:"text-lg text-gray-600 mb-4",children:"Project Analysis & Supplier Evaluation"}),o.jsxs("div",{className:"flex items-center gap-6 text-sm text-gray-600",children:[o.jsxs("div",{children:[o.jsx("span",{className:"font-medium",children:"Project:"})," ",x==null?void 0:x.name]}),o.jsxs("div",{children:[o.jsx("span",{className:"font-medium",children:"Mode:"})," ",ge(d)]}),o.jsxs("div",{children:[o.jsx("span",{className:"font-medium",children:"Suppliers:"})," ",i.suppliers.length]}),o.jsxs("div",{children:[o.jsx("span",{className:"font-medium",children:"Systems:"})," ",i.totalSystems]})]})]}),o.jsxs("div",{className:"text-right text-sm text-gray-500",children:["Generated by",o.jsx("br",{}),o.jsx("span",{className:"font-semibold text-gray-900",children:"PassiveFire Verify+"})]})]})}),d!=="SIMPLE"?o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-5 mb-6",children:[o.jsx("div",{className:"bg-white rounded-lg shadow p-6 border border-gray-200",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex-1",children:[o.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"Best Value Supplier"}),o.jsx("p",{className:"text-xl font-bold text-gray-900 mb-1",children:(M==null?void 0:M.supplier.supplierName)||"N/A"}),o.jsx("p",{className:"text-xs text-gray-500",children:M?`${J(M.supplier.adjustedTotal)} " ${M.supplier.coveragePercent}% coverage`:"Best balance of price and coverage"})]}),o.jsx("div",{className:"p-3 rounded-lg bg-green-50 text-green-700",children:o.jsx(si,{className:"w-6 h-6"})})]})}),o.jsx("div",{className:"bg-white rounded-lg shadow p-6 border border-gray-200",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex-1",children:[o.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"Lowest Risk"}),o.jsx("p",{className:"text-xl font-bold text-gray-900 mb-1",children:(O==null?void 0:O.supplier.supplierName)||"N/A"}),o.jsx("p",{className:"text-xs text-gray-500",children:O?`Risk Score ${O.supplier.riskScore.toFixed(1)} " ${O.supplier.coveragePercent}% coverage`:"Lowest risk profile"})]}),o.jsx("div",{className:"p-3 rounded-lg bg-blue-50 text-blue-700",children:o.jsx(sc,{className:"w-6 h-6"})})]})}),o.jsx("div",{className:"bg-white rounded-lg shadow p-6 border border-gray-200",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex-1",children:[o.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"Balanced Choice"}),o.jsx("p",{className:"text-xl font-bold text-gray-900 mb-1",children:(z==null?void 0:z.supplier.supplierName)||"N/A"}),o.jsx("p",{className:"text-xs text-gray-500",children:z?"Optimal balance of all factors":"Best overall recommendation"})]}),o.jsx("div",{className:"p-3 rounded-lg bg-orange-50 text-orange-700",children:o.jsx(vf,{className:"w-6 h-6"})})]})}),o.jsx("div",{className:"bg-white rounded-lg shadow p-6 border border-gray-200",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex-1",children:[o.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"Key Metrics"}),o.jsxs("div",{className:"space-y-1 mt-2",children:[o.jsxs("p",{className:"text-sm text-gray-700",children:[o.jsx("span",{className:"font-medium",children:"Quotes:"})," ",i.suppliers.length]}),o.jsxs("p",{className:"text-sm text-gray-700",children:[o.jsx("span",{className:"font-medium",children:"Systems:"})," ",i.totalSystems]}),o.jsxs("p",{className:"text-sm text-gray-700",children:[o.jsx("span",{className:"font-medium",children:"Avg Coverage:"})," ",(i.suppliers.reduce((ce,ue)=>ce+ue.coveragePercent,0)/i.suppliers.length).toFixed(1),"%"]})]})]}),o.jsx("div",{className:"p-3 rounded-lg bg-slate-50 text-slate-700",children:o.jsx(TS,{className:"w-6 h-6"})})]})})]}):o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-5 mb-6",children:[o.jsx("div",{className:"bg-white rounded-lg shadow p-6 border border-gray-200",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex-1",children:[o.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"Best Value Supplier"}),o.jsx("p",{className:"text-xl font-bold text-gray-900 mb-1",children:(M==null?void 0:M.supplier.supplierName)||"N/A"}),o.jsx("p",{className:"text-xs text-gray-500",children:M?`${J(M.supplier.adjustedTotal)}`:"Best price"})]}),o.jsx("div",{className:"p-3 rounded-lg bg-green-50 text-green-700",children:o.jsx(si,{className:"w-6 h-6"})})]})}),o.jsx("div",{className:"bg-white rounded-lg shadow p-6 border border-gray-200",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex-1",children:[o.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"Lowest Risk"}),o.jsx("p",{className:"text-xl font-bold text-gray-900 mb-1",children:(O==null?void 0:O.supplier.supplierName)||"N/A"}),o.jsx("p",{className:"text-xs text-gray-500",children:O?"Most complete coverage":"Lowest risk"})]}),o.jsx("div",{className:"p-3 rounded-lg bg-blue-50 text-blue-700",children:o.jsx(sc,{className:"w-6 h-6"})})]})}),o.jsx("div",{className:"bg-white rounded-lg shadow p-6 border border-gray-200",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex-1",children:[o.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"Balanced Choice"}),o.jsx("p",{className:"text-xl font-bold text-gray-900 mb-1",children:(z==null?void 0:z.supplier.supplierName)||"N/A"}),o.jsx("p",{className:"text-xs text-gray-500",children:"Recommended choice"})]}),o.jsx("div",{className:"p-3 rounded-lg bg-orange-50 text-orange-700",children:o.jsx(vf,{className:"w-6 h-6"})})]})})]}),o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"bg-white rounded-lg shadow border border-gray-200",children:[o.jsx("div",{className:"border-b border-gray-200 px-6 py-4",children:o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Why this recommendation"})}),o.jsx("div",{className:"p-6",children:o.jsx("ul",{className:"space-y-3",children:i.recommendations.map((ce,ue)=>o.jsxs("li",{className:"flex items-start gap-3",children:[o.jsx(tr,{className:"w-5 h-5 text-green-600 flex-shrink-0 mt-0.5"}),o.jsxs("div",{children:[o.jsxs("p",{className:"font-medium text-gray-900",children:[ce.supplier.supplierName," - ",ce.type.replace("_"," ")]}),o.jsx("p",{className:"text-sm text-gray-600 mt-0.5",children:ce.reason})]})]},ue))})})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow border border-gray-200",children:[o.jsx("div",{className:"border-b border-gray-200 px-6 py-4",children:o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Supplier comparison summary"})}),o.jsx("div",{className:"p-6",children:o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"border-b border-gray-200",children:[o.jsx("th",{className:"text-left text-sm font-medium text-gray-600 pb-3",children:"Supplier"}),o.jsx("th",{className:"text-right text-sm font-medium text-gray-600 pb-3",children:"Total Price"}),o.jsx("th",{className:"text-right text-sm font-medium text-gray-600 pb-3",children:"Systems Covered"}),o.jsx("th",{className:"text-right text-sm font-medium text-gray-600 pb-3",children:"Coverage %"}),o.jsx("th",{className:"text-right text-sm font-medium text-gray-600 pb-3",children:"Risk Score"}),d!=="SIMPLE"&&o.jsx("th",{className:"text-left text-sm font-medium text-gray-600 pb-3 pl-6",children:"Actions"})]})}),o.jsx("tbody",{children:i.suppliers.map((ce,ue)=>o.jsxs("tr",{className:"border-b border-gray-100 last:border-0",children:[o.jsx("td",{className:"py-3 text-sm font-medium text-gray-900",children:ce.supplierName}),o.jsx("td",{className:"py-3 text-sm text-right text-gray-900",children:J(ce.adjustedTotal)}),o.jsx("td",{className:"py-3 text-sm text-right text-gray-700",children:ce.itemsQuoted}),o.jsxs("td",{className:"py-3 text-sm text-right text-gray-700",children:[ce.coveragePercent,"%"]}),o.jsx("td",{className:"py-3 text-sm text-right",children:o.jsx("span",{className:`inline-flex px-2 py-0.5 rounded text-xs font-medium ${ce.riskScore<=2?"bg-green-100 text-green-800":ce.riskScore<=4?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:ce.riskScore.toFixed(1)})}),d!=="SIMPLE"&&o.jsx("td",{className:"py-3 text-sm pl-6",children:o.jsx("button",{onClick:()=>R(ce.supplierName),disabled:(x==null?void 0:x.approved_quote_id)===V.get(ce.supplierName),className:"text-blue-600 hover:text-blue-800 font-medium disabled:text-gray-400 disabled:cursor-not-allowed",children:(x==null?void 0:x.approved_quote_id)===V.get(ce.supplierName)?"Approved":"Approve"})})]},ue))})]})})})]}),d!=="SIMPLE"&&(ne.length>0||ae.length>0)&&o.jsxs("div",{className:"bg-white rounded-lg shadow border border-gray-200",children:[o.jsx("div",{className:"border-b border-gray-200 px-6 py-4",children:o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Risk & exceptions"})}),o.jsxs("div",{className:"p-6 space-y-6",children:[ne.length>0&&o.jsxs("div",{children:[o.jsxs("h4",{className:"text-sm font-semibold text-red-900 mb-3 flex items-center gap-2",children:[o.jsx(Je,{size:16,className:"text-red-600"}),"Critical gaps (must resolve)"]}),o.jsx("ul",{className:"space-y-2",children:ne.map((ce,ue)=>o.jsxs("li",{className:"flex items-start gap-2 text-sm",children:[o.jsx("span",{className:"w-1.5 h-1.5 bg-red-600 rounded-full mt-1.5 flex-shrink-0"}),o.jsx("span",{className:"text-gray-700",children:ce.description})]},ue))})]}),ae.length>0&&o.jsxs("div",{children:[o.jsxs("h4",{className:"text-sm font-semibold text-yellow-900 mb-3 flex items-center gap-2",children:[o.jsx(Je,{size:16,className:"text-yellow-600"}),"Non-critical gaps (clarifications)"]}),o.jsx("ul",{className:"space-y-2",children:ae.map((ce,ue)=>o.jsxs("li",{className:"flex items-start gap-2 text-sm",children:[o.jsx("span",{className:"w-1.5 h-1.5 bg-yellow-600 rounded-full mt-1.5 flex-shrink-0"}),o.jsx("span",{className:"text-gray-700",children:ce.description})]},ue))})]})]})]}),d!=="SIMPLE"&&n.length>0&&o.jsxs("div",{className:"bg-white rounded-lg shadow border border-gray-200",children:[o.jsxs("div",{className:"border-b border-gray-200 px-6 py-4 flex items-center justify-between",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Itemized comparison"}),o.jsxs("button",{onClick:()=>H(!B),className:"flex items-center gap-2 text-sm text-blue-600 hover:text-blue-800 font-medium",children:[B?"Hide details":"View full comparison",o.jsx(Fc,{size:16,className:`transition-transform ${B?"rotate-90":""}`})]})]}),o.jsx("div",{className:"p-6",children:B?o.jsxs("div",{className:"overflow-x-auto",children:[o.jsxs("table",{className:"w-full text-sm",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"border-b border-gray-200",children:[o.jsx("th",{className:"text-left font-medium text-gray-600 pb-3 pr-4",children:"Description"}),o.jsx("th",{className:"text-right font-medium text-gray-600 pb-3 px-4",children:"Qty"}),o.jsx("th",{className:"text-left font-medium text-gray-600 pb-3 px-4",children:"Unit"}),i.suppliers.map((ce,ue)=>o.jsx("th",{className:"text-right font-medium text-gray-600 pb-3 px-4",children:ce.supplierName},ue))]})}),o.jsx("tbody",{children:n.slice(0,50).map((ce,ue)=>o.jsxs("tr",{className:"border-b border-gray-100",children:[o.jsx("td",{className:"py-2 pr-4 text-gray-900",children:ce.description}),o.jsx("td",{className:"py-2 px-4 text-right text-gray-700",children:ce.quantity}),o.jsx("td",{className:"py-2 px-4 text-gray-700",children:ce.unit}),i.suppliers.map((Ee,T)=>{var Q;const G=(Q=ce.suppliers)==null?void 0:Q[Ee.supplierName];return o.jsx("td",{className:"py-2 px-4 text-right text-gray-700",children:G&&G.unitPrice!==null?J(G.unitPrice):"N/A"},T)})]},ue))})]}),n.length>50&&o.jsxs("p",{className:"text-sm text-gray-500 mt-4 text-center",children:["Showing first 50 of ",n.length," items. Export to Excel for full data."]})]}):o.jsxs("div",{className:"text-center py-8",children:[o.jsxs("p",{className:"text-gray-600 mb-4",children:[n.length," line items available for detailed comparison"]}),o.jsxs("div",{className:"flex items-center justify-center gap-3",children:[o.jsx("button",{onClick:()=>H(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors text-sm font-medium",children:"View full itemized comparison"}),o.jsxs("button",{onClick:he,className:"px-4 py-2 border border-gray-300 bg-white text-gray-700 rounded-md hover:bg-gray-50 transition-colors text-sm font-medium",children:[o.jsx(lm,{size:16,className:"inline mr-2"}),"Export itemized Excel"]})]})]})})]})]})]})]})}function CV(e){const[t,r]=j.useState("hub"),[s,n]=j.useState(null),a=(l,c)=>{r(l)},i=()=>{r("hub"),n(null)};return t==="award-report"?o.jsx(ej,{projectId:e.projectId,reportId:s||void 0,onNavigate:i}):o.jsx(TV,{...e,onNavigate:l=>a(l)})}function AV({projectId:e,projectName:t,onNavigateToHub:r,onToast:s}){const[n,a]=j.useState(null),[i,l]=j.useState(!0);j.useEffect(()=>{c()},[e]);const c=async()=>{l(!0);try{const{data:u,error:d}=await se.from("award_reports").select("id").eq("project_id",e).order("created_at",{ascending:!1}).limit(1).maybeSingle();d?(console.error("Error checking for report:",d),a(!1)):a(!!u)}catch(u){console.error("Failed to check report:",u),a(!1)}finally{l(!1)}};return i?o.jsx("div",{className:"flex items-center justify-center h-full",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"w-8 h-8 border-4 border-orange-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),o.jsx("p",{className:"text-gray-600",children:"Loading report..."})]})}):n===!1?o.jsx("div",{className:"p-8",children:o.jsxs("div",{className:"max-w-3xl mx-auto",children:[o.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsxs("div",{className:"text-sm text-gray-500 mb-1",children:["Projects > ",t," > Report"]}),o.jsxs("h1",{className:"text-3xl font-bold text-gray-900",children:[t,"  Report"]}),o.jsx("p",{className:"text-gray-600 mt-1",children:"Award Recommendation & Itemised Comparison"})]}),o.jsxs("button",{onClick:r,className:"flex items-center gap-2 px-3 py-2 text-sm text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-md transition-colors",children:[o.jsx(om,{size:16}),"View all project reports"]})]}),o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-12 text-center",children:[o.jsx(Yr,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),o.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No Report Generated Yet"}),o.jsx("p",{className:"text-gray-600 mb-6",children:"To generate an award recommendation report, you need to complete the Scope Matrix workflow step first."}),o.jsxs("div",{className:"space-y-3 text-left max-w-md mx-auto",children:[o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx("div",{className:"w-6 h-6 bg-orange-100 text-orange-600 rounded-full flex items-center justify-center text-sm font-semibold flex-shrink-0 mt-0.5",children:"1"}),o.jsxs("div",{children:[o.jsx("div",{className:"font-medium text-gray-900",children:"Import Quotes"}),o.jsx("div",{className:"text-sm text-gray-600",children:"Upload supplier quotes for analysis"})]})]}),o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx("div",{className:"w-6 h-6 bg-orange-100 text-orange-600 rounded-full flex items-center justify-center text-sm font-semibold flex-shrink-0 mt-0.5",children:"2"}),o.jsxs("div",{children:[o.jsx("div",{className:"font-medium text-gray-900",children:"Review & Clean"}),o.jsx("div",{className:"text-sm text-gray-600",children:"Normalize and validate quote data"})]})]}),o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx("div",{className:"w-6 h-6 bg-orange-100 text-orange-600 rounded-full flex items-center justify-center text-sm font-semibold flex-shrink-0 mt-0.5",children:"3"}),o.jsxs("div",{children:[o.jsx("div",{className:"font-medium text-gray-900",children:"Scope Matrix"}),o.jsx("div",{className:"text-sm text-gray-600",children:"Compare suppliers and generate report"})]})]})]})]})]})}):o.jsxs("div",{className:"h-full flex flex-col",children:[o.jsx("div",{className:"bg-white border-b border-gray-200 px-6 py-4",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsxs("div",{className:"text-sm text-gray-500 mb-1",children:["Projects > ",t," > Report"]}),o.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:[t,"  Report"]}),o.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Award Recommendation & Itemised Comparison generated by PassiveFire Verify+"})]}),o.jsxs("button",{onClick:r,className:"flex items-center gap-2 px-3 py-2 text-sm text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-md transition-colors",children:[o.jsx(om,{size:16}),"View all project reports"]})]})}),o.jsx("div",{className:"flex-1 overflow-auto",children:o.jsx(ej,{projectId:e,onToast:s,onNavigate:u=>{console.log("Navigate to:",u)}})})]})}function FV({projectId:e}){return o.jsxs("div",{className:"p-8",children:[o.jsx(ua,{title:"Insights Dashboard",description:"AI-powered insights and analytics"}),o.jsx("div",{className:"mt-6 p-6 bg-white rounded-lg border border-gray-200",children:o.jsx("p",{className:"text-gray-600",children:"Insights Dashboard - Analytics and intelligence coming soon"})})]})}function tj(){const[e,t]=j.useState(!1),[r,s]=j.useState(null),[n,a]=j.useState(null),[i,l]=j.useState(null),[c,u]=j.useState(!1);j.useEffect(()=>{d()},[]);const d=async()=>{u(!0);try{const w=await fetch("https://cbankidsdfsvsgfygbzt.supabase.co/functions/v1/test_openai_connection",{method:"POST",headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNiYW5raWRzZGZzdnNnZnlnYnp0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMzMTk3NDgsImV4cCI6MjA3ODg5NTc0OH0.SXgc-9ZamplKeJm5_nl8J2-UzO7A0f8KbAnPZEmsiSo","Content-Type":"application/json"}});if(w.ok){const v=await w.json();l(v)}else l({ok:!1,error:"Failed to check OpenAI connection"})}catch{l({ok:!1,error:"Network error while checking OpenAI connection"})}finally{u(!1)}},f=async p=>{t(!0),a(null);try{const v=await fetch("https://cbankidsdfsvsgfygbzt.supabase.co/functions/v1/verify_installation",{method:"POST",headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNiYW5raWRzZGZzdnNnZnlnYnp0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMzMTk3NDgsImV4cCI6MjA3ODg5NTc0OH0.SXgc-9ZamplKeJm5_nl8J2-UzO7A0f8KbAnPZEmsiSo","Content-Type":"application/json"},body:JSON.stringify({autoFix:p})});if(!v.ok)throw new Error("Failed to run system check");const y=await v.json();s(y)}catch(g){a(g.message||"An error occurred while running the system check")}finally{t(!1)}},h=p=>{switch(p){case"pass":return o.jsx("span",{className:"text-2xl",children:""});case"fixed":return o.jsx("span",{className:"text-2xl",children:""});case"fail":return o.jsx("span",{className:"text-2xl",children:""})}},m=p=>{switch(p){case"pass":return"Pass";case"fixed":return"Fixed";case"fail":return"Fail"}},x=p=>new Date(p).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"});return o.jsxs("div",{className:"space-y-6 px-8 py-6",children:[o.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:o.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-6",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-3xl font-semibold brand-navy mb-2",children:"Verify+ System Audit"}),o.jsx("p",{className:"text-gray-600 text-base",children:"Comprehensive system health check and automatic issue resolution"})]}),o.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[o.jsx("button",{onClick:()=>f(!1),disabled:e,className:"flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:bg-gray-300 disabled:text-gray-500 disabled:cursor-not-allowed font-medium text-sm",children:e?o.jsxs(o.Fragment,{children:[o.jsx(Cr,{size:18,className:"animate-spin"}),"Running..."]}):o.jsxs(o.Fragment,{children:[o.jsx(Ku,{size:18}),"Run Check"]})}),o.jsx("button",{onClick:()=>f(!0),disabled:e,className:"flex items-center justify-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed font-medium text-sm",children:e?o.jsxs(o.Fragment,{children:[o.jsx(Cr,{size:18,className:"animate-spin"}),"Running..."]}):o.jsxs(o.Fragment,{children:[o.jsx(yf,{size:18}),"Run & Auto-Fix"]})})]})]})}),o.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[o.jsxs("div",{className:"flex items-start justify-between mb-6",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-10 h-10 bg-blue-50 rounded-lg flex items-center justify-center flex-shrink-0",children:o.jsx(FF,{className:"text-blue-600",size:20})}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"OpenAI API Configuration"}),o.jsx("p",{className:"text-sm text-gray-600 mt-0.5",children:"Required for Verify+ Copilot functionality"})]})]}),o.jsxs("button",{onClick:d,disabled:c,className:"flex items-center gap-2 px-3 py-1.5 text-sm bg-white text-blue-700 rounded-full hover:bg-blue-50 transition-colors disabled:opacity-50 font-medium border border-blue-200",children:[o.jsx(Cr,{size:14,className:c?"animate-spin":""}),"Recheck"]})]}),c&&o.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[o.jsx(Cr,{size:16,className:"animate-spin"}),o.jsx("span",{className:"text-sm",children:"Checking OpenAI connection..."})]}),!c&&i&&o.jsx("div",{className:`rounded-lg p-4 ${i.ok?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"}`,children:o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 ${i.ok?"bg-green-100":"bg-red-100"}`,children:i.ok?o.jsx(im,{className:"text-green-600",size:18}):o.jsx(Je,{className:"text-red-600",size:18})}),o.jsxs("div",{className:"flex-1",children:[o.jsx("h4",{className:`font-semibold text-sm mb-1 ${i.ok?"text-green-900":"text-red-900"}`,children:i.ok?"Connected":"Not Configured"}),o.jsx("p",{className:`text-xs mb-2 ${i.ok?"text-green-700":"text-red-700"}`,children:i.message||i.error||"Unknown status"}),i.ok&&o.jsxs("div",{className:"text-xs text-green-700 space-y-1 mt-2",children:[o.jsxs("div",{children:["Models available: ",o.jsx("span",{className:"font-semibold",children:i.modelCount})]}),o.jsxs("div",{children:["GPT-4 access: ",o.jsx("span",{className:"font-semibold",children:i.gpt4Available?"Yes":"No"})]})]}),!i.ok&&o.jsxs("div",{className:"mt-3 p-4 bg-white rounded-lg border border-red-200",children:[o.jsx("p",{className:"text-sm text-red-900 font-semibold mb-3",children:"Setup Instructions:"}),o.jsxs("ol",{className:"text-sm text-red-800 space-y-2 list-decimal list-inside",children:[o.jsx("li",{children:"Go to Supabase Dashboard"}),o.jsx("li",{children:"Navigate to Project Settings  Edge Functions  Secrets"}),o.jsxs("li",{children:["Add a new secret named ",o.jsx("code",{className:"bg-red-100 px-2 py-0.5 rounded font-mono text-xs",children:"OPENAI_API_KEY"})]}),o.jsx("li",{children:"Paste your OpenAI API key as the value"}),o.jsx("li",{children:'Click "Recheck" above to verify'})]})]})]})]})})]}),n&&o.jsx("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4",children:o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-full flex items-center justify-center flex-shrink-0",children:o.jsx(Je,{className:"text-red-600",size:18})}),o.jsxs("div",{children:[o.jsx("h3",{className:"font-semibold text-red-900 mb-1 text-sm",children:"Error"}),o.jsx("p",{className:"text-red-700 text-xs",children:n})]})]})}),r&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-5",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("div",{className:"text-xs font-semibold text-gray-600 mb-2 uppercase",children:"Passed"}),o.jsx("div",{className:"text-2xl font-bold text-green-600",children:r.passed})]}),o.jsx("div",{className:"w-12 h-12 bg-green-50 rounded-lg flex items-center justify-center",children:o.jsx(im,{size:24,className:"text-green-600"})})]})}),o.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-5",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("div",{className:"text-xs font-semibold text-gray-600 mb-2 uppercase",children:"Failed"}),o.jsx("div",{className:"text-2xl font-bold text-red-600",children:r.failed})]}),o.jsx("div",{className:"w-12 h-12 bg-red-50 rounded-lg flex items-center justify-center",children:o.jsx(Je,{size:24,className:"text-red-600"})})]})}),o.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-5",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("div",{className:"text-xs font-semibold text-gray-600 mb-2 uppercase",children:"Fixed"}),o.jsx("div",{className:"text-2xl font-bold text-amber-600",children:r.fixed})]}),o.jsx("div",{className:"w-12 h-12 bg-amber-50 rounded-lg flex items-center justify-center",children:o.jsx(yf,{size:24,className:"text-amber-600"})})]})})]}),r.failed>0&&o.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-xl p-4",children:o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx("div",{className:"w-8 h-8 bg-amber-100 rounded-full flex items-center justify-center flex-shrink-0",children:o.jsx(Je,{className:"text-amber-600",size:18})}),o.jsxs("div",{children:[o.jsxs("h3",{className:"font-semibold text-amber-900 mb-1 text-sm",children:[r.failed," check",r.failed!==1?"s":""," failed"]}),o.jsx("p",{className:"text-amber-700 text-xs",children:"Run & Auto-Fix recommended to resolve these issues automatically"})]})]})}),o.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full",children:[o.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Area"}),o.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Name"}),o.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Status"}),o.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Detail"}),o.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Fix Hint"})]})}),o.jsx("tbody",{className:"divide-y divide-gray-200",children:r.checks.map((p,g)=>o.jsxs("tr",{className:`hover:bg-gray-50 transition-colors ${p.status==="fail"?"bg-red-50":""}`,children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:p.area}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:p.name}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxs("div",{className:"flex items-center gap-2",children:[h(p.status),o.jsx("span",{className:`text-sm font-medium ${p.status==="pass"?"text-green-700":p.status==="fixed"?"text-amber-700":"text-red-700"}`,children:m(p.status)})]})}),o.jsx("td",{className:"px-6 py-4 text-sm text-gray-700",children:p.detail}),o.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:p.fixHint||"-"})]},g))})]})})}),o.jsx("div",{className:"bg-gray-50 rounded-xl border border-gray-200 px-6 py-4",children:o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 text-sm",children:[o.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[o.jsx(c0,{size:16}),o.jsxs("span",{children:["Last check: ",x(r.timestamp)]})]}),o.jsx("div",{className:"text-gray-500 font-medium",children:"PassiveFire Verify+ v1.0.0"})]})})]}),!r&&!e&&!n&&o.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-12 text-center",children:o.jsxs("div",{className:"max-w-md mx-auto",children:[o.jsx("div",{className:"w-16 h-16 bg-blue-50 rounded-xl flex items-center justify-center mx-auto mb-4",children:o.jsx(Ku,{size:32,className:"text-blue-600"})}),o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Ready to Check System Health"}),o.jsx("p",{className:"text-gray-600 text-sm mb-6 leading-relaxed",children:"Run a comprehensive system audit to verify your installation and identify any issues. Use Auto-Fix to automatically resolve common problems."}),o.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 justify-center",children:[o.jsxs("button",{onClick:()=>f(!1),className:"flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium text-sm",children:[o.jsx(Ku,{size:18}),"Run Check"]}),o.jsxs("button",{onClick:()=>f(!0),className:"flex items-center justify-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors font-medium text-sm",children:[o.jsx(yf,{size:18}),"Run & Auto-Fix"]})]})]})})]})}function rj(){const[e,t]=j.useState([]),[r,s]=j.useState(!0),[n,a]=j.useState(new Set),[i,l]=j.useState("all"),c=async()=>{s(!0);try{let x=se.from("copilot_audit").select("*").order("ts",{ascending:!1}).limit(100);i==="success"?x=x.eq("result_ok",!0):i==="failed"&&(x=x.eq("result_ok",!1));const{data:p,error:g}=await x;if(g){console.error("Error loading audit logs:",g);return}t(p||[])}finally{s(!1)}};j.useEffect(()=>{c()},[i]);const u=x=>{a(p=>{const g=new Set(p);return g.has(x)?g.delete(x):g.add(x),g})},d=x=>new Date(x).toLocaleString(),f=x=>x.includes("verify")?"bg-blue-50 text-blue-700 border-blue-200":x.includes("compute")?"bg-purple-50 text-purple-700 border-purple-200":x.includes("approve")?"bg-green-50 text-green-700 border-green-200":x.includes("generate")?"bg-amber-50 text-amber-700 border-amber-200":"bg-gray-100 text-gray-700 border-gray-200",h=x=>x==="owner"?"bg-red-50 text-red-700 border-red-200":x==="estimator"?"bg-orange-50 text-blue-700 border-orange-200":"bg-gray-100 text-gray-700 border-gray-200",m=e;return o.jsxs("div",{className:"space-y-6 p-6",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-3xl font-bold brand-navy mb-2",children:"Copilot Audit Logs"}),o.jsx("p",{className:"text-gray-600",children:"Last 100 Copilot actions for this project"})]}),o.jsxs("button",{onClick:c,disabled:r,className:"flex items-center justify-center gap-2 px-4 py-2 bg-blue-50 text-blue-700 rounded-lg hover:bg-blue-100 transition-colors disabled:opacity-50 font-medium border border-blue-100",children:[o.jsx(Cr,{size:18,className:r?"animate-spin":""}),o.jsx("span",{children:"Refresh"})]})]}),o.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4",children:o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[o.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[o.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Filter:"}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("button",{onClick:()=>l("all"),className:`px-4 py-2 rounded-full text-sm font-medium transition-colors ${i==="all"?"bg-brand-primary text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"All"}),o.jsx("button",{onClick:()=>l("success"),className:`px-4 py-2 rounded-full text-sm font-medium transition-colors ${i==="success"?"bg-green-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Success"}),o.jsx("button",{onClick:()=>l("failed"),className:`px-4 py-2 rounded-full text-sm font-medium transition-colors ${i==="failed"?"bg-red-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Failed"})]})]}),o.jsxs("div",{className:"text-sm text-gray-600 font-medium",children:["Showing ",m.length," log",m.length!==1?"s":""]})]})}),r?o.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-12 text-center",children:[o.jsx(Cr,{className:"animate-spin mx-auto mb-4 text-blue-600",size:48}),o.jsx("p",{className:"text-gray-600",children:"Loading audit logs..."})]}):m.length===0?o.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-12 text-center",children:o.jsx("p",{className:"text-gray-600",children:"No audit logs found"})}):o.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"bg-gray-50 border-b border-gray-200",children:[o.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(c0,{size:14}),o.jsx("span",{children:"Time"})]})}),o.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(xx,{size:14}),o.jsx("span",{children:"User"})]})}),o.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Role"}),o.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Tool"}),o.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Status"}),o.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Details"})]})}),o.jsx("tbody",{className:"divide-y divide-gray-200",children:m.map(x=>o.jsxs(rc.tr,{initial:{opacity:0},animate:{opacity:1},className:"hover:bg-gray-50 transition-colors",children:[o.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:d(x.ts)}),o.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:x.user_email}),o.jsx("td",{className:"px-6 py-4",children:o.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-medium border ${h(x.role)}`,children:x.role})}),o.jsx("td",{className:"px-6 py-4",children:o.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-medium border ${f(x.tool_name)}`,children:x.tool_name})}),o.jsx("td",{className:"px-6 py-4",children:x.result_ok?o.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 bg-green-50 text-green-700 rounded-full text-xs font-medium border border-green-200",children:[o.jsx(tr,{size:14}),o.jsx("span",{children:"Success"})]}):o.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 bg-red-50 text-red-700 rounded-full text-xs font-medium border border-red-200",children:[o.jsx(so,{size:14}),o.jsx("span",{children:"Failed"})]})}),o.jsx("td",{className:"px-6 py-4",children:o.jsxs("button",{onClick:()=>u(x.id),className:"flex items-center gap-1 text-sm brand-primary hover:underline transition-colors font-medium",children:[n.has(x.id)?o.jsx(ri,{size:16}):o.jsx(Fc,{size:16}),o.jsx("span",{children:"View"})]})})]},x.id))})]})}),Array.from(n).map(x=>{const p=m.find(g=>g.id===x);return p?o.jsxs(rc.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"border-t border-gray-200 bg-gray-50 p-6",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{children:[o.jsx("h4",{className:"text-xs font-semibold text-gray-700 uppercase mb-3",children:"Arguments"}),o.jsx("pre",{className:"text-xs text-gray-900 bg-white p-4 rounded-lg border border-gray-200 overflow-x-auto",children:JSON.stringify(p.args_json,null,2)})]}),o.jsxs("div",{children:[o.jsx("h4",{className:"text-xs font-semibold text-gray-700 uppercase mb-3",children:"Result"}),o.jsx("pre",{className:"text-xs text-gray-900 bg-white p-4 rounded-lg border border-gray-200 overflow-x-auto",children:JSON.stringify(p.result_json,null,2)})]})]}),p.error_message&&o.jsxs("div",{className:"mt-6",children:[o.jsx("h4",{className:"text-xs font-semibold text-red-700 uppercase mb-3",children:"Error Message"}),o.jsx("p",{className:"text-sm text-red-700 bg-red-50 p-4 rounded-lg border border-red-200",children:p.error_message})]})]},`details-${x}`):null})]})]})}async function PV(e,t){console.log("Snapshot creation not implemented")}async function RV(e){return[]}async function IV(e){console.log("Snapshot restore not implemented")}async function OV(e,t){return PV()}async function DV(e){return IV()}async function LV(e){return RV()}async function MV(e){console.log("Delete snapshot not implemented")}async function BV(e){console.log("Legacy data migration not implemented")}async function Rw(e){return!1}function UV(){return null}function zV(e){return e}const $V="https://verify-pdf-extractor.onrender.com";async function VV(){try{const e=await fetch(`${$V}/health`,{method:"GET"});if(!e.ok){const r=await e.text();throw new Error(`Health check failed: ${e.status} ${r}`)}return await e.json()}catch(e){throw console.error("PDF Extractor health check error:",e),new Error(e instanceof Error?`Health check failed: ${e.message}`:"Health check failed: Unknown error")}}function WV({projectId:e,onProjectDeleted:t,onNavigateToMatrix:r}){const[s,n]=j.useState("project"),[a,i]=j.useState(!1),[l,c]=j.useState(!1),[u,d]=j.useState(null),[f,h]=j.useState("api"),[m,x]=j.useState(""),[p,g]=j.useState([]),[w,v]=j.useState(!0),[y,b]=j.useState(!1),[S,k]=j.useState(!1),[_,N]=j.useState(!1),[C,B]=j.useState(!1),[H,V]=j.useState(!1),[K,Y]=j.useState(!1),[q,X]=j.useState(""),[ie,W]=j.useState(""),[U,he]=j.useState(!1),[be,R]=j.useState([]),[M,O]=j.useState(!1),[z,J]=j.useState(!1),[pe,ge]=j.useState(!1),[ne,ae]=j.useState(""),[Ce,P]=j.useState(""),[ce,ue]=j.useState(""),[Ee,T]=j.useState(null),[G,Q]=j.useState(!1),me=xg(e);j.useEffect(()=>{fe(),xe(),oe(),B(Rw())},[e]);const fe=async()=>{v(!0);try{const ve=await me.loadSettings();ve&&(h(ve.model_rate_source),x(ve.api_base_url),ve.csv_data&&g(ve.csv_data))}catch(ve){console.error("Error loading settings:",ve)}v(!1)},oe=async()=>{try{const{data:ve}=await se.from("user_preferences").select("show_splash_on_load").eq("id","00000000-0000-0000-0000-000000000001").maybeSingle();ve&&(V(ve.show_splash_on_load),localStorage.setItem("showSplashOnLoad",String(ve.show_splash_on_load)))}catch(ve){console.error("Error loading user preferences:",ve)}},ke=async()=>{Q(!0),T(null);try{const ve=await VV();T(` Healthy - ${ve.status||"OK"}${ve.message?`: ${ve.message}`:""}`),d({type:"success",text:"PDF Extractor API is healthy and responding"})}catch(ve){const Ye=ve instanceof Error?ve.message:"Unknown error";T(` Failed - ${Ye}`),d({type:"error",text:`PDF Extractor health check failed: ${Ye}`})}finally{Q(!1)}},we=async ve=>{try{const{error:Ye}=await se.from("user_preferences").update({show_splash_on_load:ve}).eq("id","00000000-0000-0000-0000-000000000001");if(Ye)throw Ye;V(ve),localStorage.setItem("showSplashOnLoad",String(ve)),d({type:"success",text:`Splash screen will ${ve?"show":"not show"} on every load`})}catch(Ye){console.error("Error updating splash preference:",Ye),d({type:"error",text:"Failed to update splash screen preference"})}},Pe=async()=>{i(!0),d(null);try{const{data:ve}=await se.from("projects").select("*").eq("id",e).single(),{data:Ye}=await se.from("quotes").select("*").eq("project_id",e),Et=(Ye==null?void 0:Ye.map(yi=>yi.id))||[],{data:Ir}=await se.from("quote_items").select("*").in("quote_id",Et),{data:Ht}=await se.from("scope_categories").select("*").eq("project_id",e),xs={version:"1.0",exported_at:new Date().toISOString(),project:ve,quotes:Ye||[],quote_items:Ir||[],scope_categories:Ht||[]},pn=new Blob([JSON.stringify(xs,null,2)],{type:"application/json"}),es=URL.createObjectURL(pn),at=document.createElement("a");at.href=es,at.download=`passivefire-project-${e}-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(at),at.click(),document.body.removeChild(at),URL.revokeObjectURL(es),d({type:"success",text:"Project data exported successfully!"})}catch(ve){console.error("Export error:",ve),d({type:"error",text:"Failed to export project data."})}finally{i(!1)}},Ue=async ve=>{var Et;const Ye=(Et=ve.target.files)==null?void 0:Et[0];if(Ye){c(!0),d(null);try{const Ir=await Ye.text(),Ht=JSON.parse(Ir);if(!Ht.quotes||!Ht.quote_items)throw new Error("Invalid file format");for(const xs of Ht.quotes){const{id:pn,project_id:es,created_at:at,updated_at:yi,...k0}=xs,{data:N0,error:zc}=await se.from("quotes").insert({...k0,project_id:e}).select().single();if(zc)throw zc;const E0=Ht.quote_items.filter(Uo=>Uo.quote_id===pn);for(const Uo of E0){const{id:gg,quote_id:vg,created_at:$c,updated_at:yg,...j0}=Uo,{error:Vc}=await se.from("quote_items").insert({...j0,quote_id:N0.id});if(Vc)throw Vc}}if(Ht.scope_categories&&Ht.scope_categories.length>0)for(const xs of Ht.scope_categories){const{id:pn,project_id:es,created_at:at,...yi}=xs;await se.from("scope_categories").insert({...yi,project_id:e})}d({type:"success",text:`Imported ${Ht.quotes.length} quotes successfully!`}),ve.target.value=""}catch(Ir){console.error("Import error:",Ir),d({type:"error",text:"Failed to import project data. Please check the file format."})}finally{c(!1)}}},et=async()=>{var ve,Ye;if(confirm("This will check for legacy data in localStorage and migrate it to a new project. Continue?")){N(!0),d(null);try{if(!Rw()){d({type:"error",text:"No legacy data found to migrate."}),B(!1);return}const Et=await BV();Et.success&&Et.projectId?(d({type:"success",text:`Legacy data migrated successfully! ${((ve=Et.itemsMigrated)==null?void 0:ve.lines)||0} items from ${((Ye=Et.itemsMigrated)==null?void 0:Ye.suppliers)||0} suppliers. Reload the page to see the new project.`}),B(!1)):d({type:"error",text:Et.error||"Failed to migrate legacy data."})}catch(Et){console.error("Migration error:",Et),d({type:"error",text:"An error occurred during migration."})}finally{N(!1)}}},nt=async()=>{if(confirm("Are you sure you want to delete this project? This will remove all quotes and data. This action cannot be undone."))try{const{error:ve}=await se.from("projects").delete().eq("id",e);if(ve)throw ve;t()}catch(ve){console.error("Delete error:",ve),d({type:"error",text:"Failed to delete project."})}},He=async()=>{b(!0),d(null);try{await me.saveSettings({model_rate_source:f,api_base_url:m,csv_data:p.length>0?p:void 0})?(await se.from("projects").update({updated_at:new Date().toISOString()}).eq("id",e),d({type:"success",text:"Settings saved successfully!"})):d({type:"error",text:"Failed to save settings."})}catch(ve){console.error("Save settings error:",ve),d({type:"error",text:"Failed to save settings."})}finally{b(!1)}},Be=async ve=>{var Et;const Ye=(Et=ve.target.files)==null?void 0:Et[0];if(Ye){k(!0),d(null);try{const Ir=await Ye.arrayBuffer(),Ht=wc(Ir,{type:"array"}),xs=Ht.Sheets[Ht.SheetNames[0]],es=it.sheet_to_json(xs).map(at=>({systemId:String(at.systemId||at.SystemId||at.system_id||"").trim(),sizeBucket:String(at.sizeBucket||at.SizeBucket||at.size_bucket||"").trim(),frr:String(at.frr||at.FRR||"").trim(),service:String(at.service||at.Service||"").trim(),subclass:String(at.subclass||at.Subclass||at.sub_class||"").trim(),componentCount:parseInt(at.componentCount||at.ComponentCount||at.component_count||"0"),modelRate:parseFloat(at.modelRate||at.ModelRate||at.model_rate||"0")})).filter(at=>at.systemId&&at.modelRate>0);if(es.length===0)throw new Error("No valid data found in CSV file");g(es),d({type:"success",text:`Loaded ${es.length} model rates from CSV.`}),ve.target.value=""}catch(Ir){console.error("CSV upload error:",Ir),d({type:"error",text:"Failed to parse CSV file. Please check the format."})}finally{k(!1)}}},xe=async()=>{O(!0);const ve=await LV();R(ve),O(!1)},Xe=async()=>{if(!ne||!Ce){d({type:"error",text:"Please provide snapshot key and name."});return}J(!0),d(null);try{await OV(ne,e,{name:Ce,client:ce||"Unknown",created:new Date().toISOString().split("T")[0]})?(d({type:"success",text:`Snapshot "${ne}" saved successfully!`}),ae(""),P(""),ue(""),await xe()):d({type:"error",text:"Failed to save snapshot."})}catch(ve){console.error("Save snapshot error:",ve),d({type:"error",text:"Failed to save snapshot."})}finally{J(!1)}},pt=async ve=>{if(confirm(`Restore snapshot "${ve}"? This will replace all current project data.`)){ge(!0),d(null);try{await DV(ve,e)?(d({type:"success",text:`Snapshot "${ve}" restored successfully! Refresh the page to see changes.`}),await fe()):d({type:"error",text:"Failed to restore snapshot."})}catch(Ye){console.error("Restore snapshot error:",Ye),d({type:"error",text:"Failed to restore snapshot."})}finally{ge(!1)}}},tt=async ve=>{if(confirm(`Delete snapshot "${ve}"? This action cannot be undone.`)){d(null);try{await MV(ve)?(d({type:"success",text:`Snapshot "${ve}" deleted successfully!`}),await xe()):d({type:"error",text:"Failed to delete snapshot."})}catch(Ye){console.error("Delete snapshot error:",Ye),d({type:"error",text:"Failed to delete snapshot."})}}},ar=async()=>{var ve,Ye;if(!q.trim()){alert("Please enter a template name");return}he(!0);try{const{data:Et}=await se.auth.getSession(),Ir=(Ye=(ve=Et==null?void 0:Et.session)==null?void 0:ve.user)==null?void 0:Ye.id;if(!Ir){alert("You must be logged in to save templates");return}const{data:Ht}=await se.from("projects").select("name").eq("id",e).maybeSingle(),xs=await me.loadSettings(),{data:pn}=await se.from("project_settings").select("*").eq("project_id",e).maybeSingle(),{error:es}=await se.from("project_templates").insert({name:q.trim(),description:ie.trim(),trade:"Passive Fire",is_default:!1,created_by_user_id:Ir,project_settings:{...xs,...pn},analysis_settings:{},report_settings:{},compliance_settings:{}});if(es)throw es;d({type:"success",text:zV("saveProjectAsTemplate.toasts.success",{templateName:q,projectName:(Ht==null?void 0:Ht.name)||"Project"})}),Y(!1),X(""),W("")}catch(Et){console.error("Error saving template:",Et),alert("Failed to save template")}finally{he(!1)}};return o.jsxs("div",{className:"space-y-6",children:[o.jsx("div",{className:"bg-white rounded-lg shadow-sm border-b border-gray-200",children:o.jsxs("div",{className:"flex gap-1 p-2",children:[o.jsxs("button",{onClick:()=>n("project"),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-colors ${s==="project"?"bg-orange-50 text-brand-primary border border-brand-primary":"text-gray-600 hover:bg-gray-50"}`,children:[o.jsx(dm,{size:18}),"Project Settings"]}),o.jsxs("button",{onClick:()=>n("systemcheck"),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-colors ${s==="systemcheck"?"bg-orange-50 text-brand-primary border border-brand-primary":"text-gray-600 hover:bg-gray-50"}`,children:[o.jsx(BF,{size:18}),"System Check"]}),o.jsxs("button",{onClick:()=>n("copilotaudit"),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-colors ${s==="copilotaudit"?"bg-orange-50 text-brand-primary border border-brand-primary":"text-gray-600 hover:bg-gray-50"}`,children:[o.jsx(sc,{size:18}),"Copilot Audit"]})]})}),u&&o.jsx("div",{className:`p-4 rounded-md ${u.type==="success"?"bg-green-50 text-green-800":"bg-red-50 text-red-800"}`,children:u.text}),s==="systemcheck"?o.jsx(tj,{}):s==="copilotaudit"?o.jsx(rj,{}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-6",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(dm,{size:20,className:"text-gray-700"}),o.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Project Settings"})]}),o.jsxs("button",{onClick:()=>{const{data:ve}=se.from("projects").select("name").eq("id",e).maybeSingle().then(({data:Ye})=>{X(`${(Ye==null?void 0:Ye.name)||"Project"} Template`)});Y(!0)},className:"flex items-center gap-2 px-4 py-2 text-blue-600 bg-blue-50 hover:bg-blue-100 rounded-lg transition-colors font-medium text-sm border border-blue-200",children:[o.jsx(yF,{size:16}),"saveProjectAsTemplate.buttonLabel"]})]}),o.jsx("h3",{className:"text-base font-semibold text-gray-900 mb-4",children:"Model Rate Provider"}),w?o.jsx("div",{className:"text-center py-8 text-gray-500",children:"Loading settings..."}):o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Model Rate Source"}),o.jsxs("div",{className:"flex gap-4",children:[o.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[o.jsx("input",{type:"radio",name:"modelRateSource",value:"api",checked:f==="api",onChange:ve=>h(ve.target.value),className:"w-4 h-4 text-blue-600"}),o.jsx(TF,{size:18,className:"text-gray-600"}),o.jsx("span",{className:"text-sm text-gray-700",children:"API"})]}),o.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[o.jsx("input",{type:"radio",name:"modelRateSource",value:"csv",checked:f==="csv",onChange:ve=>h(ve.target.value),className:"w-4 h-4 text-blue-600"}),o.jsx(Yr,{size:18,className:"text-gray-600"}),o.jsx("span",{className:"text-sm text-gray-700",children:"CSV"})]})]})]}),f==="api"&&o.jsxs("div",{children:[o.jsx("label",{htmlFor:"apiBaseUrl",className:"block text-sm font-medium text-gray-700 mb-2",children:"API Base URL"}),o.jsx("input",{id:"apiBaseUrl",type:"url",value:m,onChange:ve=>x(ve.target.value),placeholder:"https://gkdvcyocchnfwelrxvmz.supabase.co/functions/v1/rate-api",className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-gray-900"}),o.jsxs("div",{className:"mt-2 space-y-1",children:[o.jsx("p",{className:"text-xs text-gray-500",children:"Leave empty to use the default Verify+ Rate API"}),o.jsx("p",{className:"text-xs text-blue-600 font-mono",children:"Default: https://gkdvcyocchnfwelrxvmz.supabase.co/functions/v1/rate-api"}),o.jsxs("p",{className:"text-xs text-gray-500",children:["The API will be called as: POST ","{baseUrl}","/rate with system_label, size, frr, service, and subclass"]})]})]}),o.jsx(UV,{projectId:e}),o.jsxs("div",{className:"bg-gray-50 p-4 rounded-md border border-gray-200",children:[o.jsxs("p",{className:"text-sm text-gray-700 mb-2",children:[o.jsx("strong",{children:"Project ID:"})," ",o.jsx("code",{className:"text-xs bg-white px-2 py-1 rounded border border-gray-300",children:e})]}),o.jsx("p",{className:"text-xs text-gray-500",children:"Used for storage keys and data isolation"})]}),f==="csv"&&o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Upload ModelSolutions.csv"}),o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsxs("label",{className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors cursor-pointer",children:[o.jsx(hm,{size:18}),S?"Uploading...":"Upload CSV",o.jsx("input",{type:"file",accept:".csv,.xlsx,.xls",multiple:!1,onChange:Be,disabled:S,className:"hidden"})]}),p.length>0&&o.jsxs("span",{className:"text-sm text-gray-600",children:[p.length," model rates loaded"]})]}),o.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"Required columns: systemId, sizeBucket, frr, service, subclass, componentCount, modelRate"}),p.length>0&&o.jsxs("div",{className:"mt-4 border border-gray-200 rounded-md overflow-hidden",children:[o.jsx("div",{className:"max-h-64 overflow-y-auto",children:o.jsxs("table",{className:"w-full text-xs",children:[o.jsx("thead",{className:"bg-gray-50 border-b border-gray-200 sticky top-0",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700",children:"System ID"}),o.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700",children:"Size Bucket"}),o.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700",children:"FRR"}),o.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700",children:"Service"}),o.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700",children:"Subclass"}),o.jsx("th",{className:"px-3 py-2 text-right font-medium text-gray-700",children:"Components"}),o.jsx("th",{className:"px-3 py-2 text-right font-medium text-gray-700",children:"Model Rate"})]})}),o.jsx("tbody",{className:"divide-y divide-gray-200",children:p.slice(0,10).map((ve,Ye)=>o.jsxs("tr",{className:"hover:bg-gray-50",children:[o.jsx("td",{className:"px-3 py-2 text-gray-900",children:ve.systemId}),o.jsx("td",{className:"px-3 py-2 text-gray-600",children:ve.sizeBucket}),o.jsx("td",{className:"px-3 py-2 text-gray-600",children:ve.frr}),o.jsx("td",{className:"px-3 py-2 text-gray-600",children:ve.service}),o.jsx("td",{className:"px-3 py-2 text-gray-600",children:ve.subclass}),o.jsx("td",{className:"px-3 py-2 text-right text-gray-900",children:ve.componentCount}),o.jsxs("td",{className:"px-3 py-2 text-right text-gray-900",children:["$",ve.modelRate.toFixed(2)]})]},Ye))})]})}),p.length>10&&o.jsxs("div",{className:"px-3 py-2 bg-gray-50 border-t border-gray-200 text-xs text-gray-500",children:["Showing 10 of ",p.length," rows"]})]})]}),o.jsx("div",{className:"flex items-center gap-3 pt-4 border-t border-gray-200",children:o.jsx("button",{onClick:He,disabled:y||f==="csv"&&p.length===0,className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed",children:y?"Saving...":"Save Settings"})})]})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[o.jsx(d0,{className:"text-cyan-600",size:24}),o.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"User Experience"})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg border border-gray-200",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"Show Splash Screen on Every Load"}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Display the animated BurnRatePro splash screen each time the app loads"})]}),o.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[o.jsx("input",{type:"checkbox",checked:H,onChange:ve=>we(ve.target.checked),className:"sr-only peer"}),o.jsx("div",{className:"w-11 h-6 bg-gray-300 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-cyan-300 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-cyan-600"})]})]}),o.jsx("div",{className:"text-xs text-gray-500 bg-blue-50 border border-blue-200 rounded-lg p-3",children:o.jsxs("p",{children:[o.jsx("strong",{children:"Tip:"})," Press ",o.jsx("kbd",{className:"px-2 py-1 bg-white border border-blue-300 rounded text-xs",children:"Shift"})," + ",o.jsx("kbd",{className:"px-2 py-1 bg-white border border-blue-300 rounded text-xs",children:"S"})," to replay the splash screen at any time"]})})]})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[o.jsxs("h2",{className:"text-xl font-semibold text-gray-900 mb-6 flex items-center gap-2",children:[o.jsx($y,{size:20,className:"text-gray-700"}),"PDF Extractor API"]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg border border-gray-200",children:[o.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-2",children:"External PDF Extraction Service"}),o.jsx("p",{className:"text-xs text-gray-600 mb-3",children:"This service automatically extracts structured data from supplier quote PDFs."}),o.jsxs("div",{className:"text-xs text-gray-500 space-y-1 mb-4",children:[o.jsxs("div",{children:[o.jsx("strong",{children:"Endpoint:"})," https://verify-pdf-extractor.onrender.com"]}),o.jsxs("div",{children:[o.jsx("strong",{children:"Status:"})," ",Ee||"Not checked"]})]}),o.jsx("button",{onClick:ke,disabled:G,className:"flex items-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed text-sm font-medium",children:G?o.jsxs(o.Fragment,{children:[o.jsx(Cr,{size:16,className:"animate-spin"}),"Checking..."]}):o.jsxs(o.Fragment,{children:[o.jsx($y,{size:16}),"Check Health"]})})]}),o.jsx("div",{className:"text-xs text-gray-500 bg-purple-50 border border-purple-200 rounded-lg p-3",children:o.jsxs("p",{children:[o.jsx("strong",{children:"Note:"})," The PDF extractor is called automatically when you upload a PDF in the Import Quotes screen. This health check verifies the service is online and responding."]})})]})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[o.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Project Data"}),o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"border-b border-gray-200 pb-6",children:[o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-3",children:"Export Data"}),o.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Export all project data including quotes, items, and categories to a JSON file."}),o.jsxs("button",{onClick:Pe,disabled:a,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed",children:[o.jsx(fi,{size:18}),a?"Exporting...":"Export Project Data"]})]}),o.jsxs("div",{className:"border-b border-gray-200 pb-6",children:[o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-3",children:"Import Data"}),o.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Import quotes and items from a previously exported JSON file. This will add to existing data."}),o.jsxs("label",{className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors cursor-pointer inline-flex",children:[o.jsx(hm,{size:18}),l?"Importing...":"Import Project Data",o.jsx("input",{type:"file",accept:".json",multiple:!1,onChange:Ue,disabled:l,className:"hidden"})]})]}),C&&o.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[o.jsxs("h3",{className:"text-lg font-medium text-yellow-900 mb-3 flex items-center gap-2",children:[o.jsx(_n,{size:20,className:"text-yellow-600"}),"Legacy Data Migration"]}),o.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Legacy data detected in localStorage. Click below to migrate it to a new project in the database."}),o.jsxs("button",{onClick:et,disabled:_,className:"flex items-center gap-2 px-4 py-2 bg-yellow-600 text-white rounded-md hover:bg-yellow-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed",children:[o.jsx(Cr,{size:18,className:_?"animate-spin":""}),_?"Migrating...":"Re-run Migration"]})]}),o.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[o.jsx("h3",{className:"text-lg font-medium text-red-900 mb-3",children:"Danger Zone"}),o.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Permanently delete this project and all associated data. This action cannot be undone."}),o.jsxs("button",{onClick:nt,className:"flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors",children:[o.jsx(bo,{size:18}),"Delete Project"]})]})]})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[o.jsx(SF,{size:20,className:"text-gray-700"}),o.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Project Snapshots"})]}),o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"border-b border-gray-200 pb-6",children:[o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-3",children:"Save Current Project"}),o.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Create a snapshot of the current project state including all quotes, mappings, comparisons, and settings."}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"snapshotKey",className:"block text-sm font-medium text-gray-700 mb-2",children:"Snapshot Key *"}),o.jsx("input",{id:"snapshotKey",type:"text",value:ne,onChange:ve=>ae(ve.target.value),placeholder:"HowickLibrary_2025",className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-gray-900"})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"snapshotName",className:"block text-sm font-medium text-gray-700 mb-2",children:"Project Name *"}),o.jsx("input",{id:"snapshotName",type:"text",value:Ce,onChange:ve=>P(ve.target.value),placeholder:"Howick Library",className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-gray-900"})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"snapshotClient",className:"block text-sm font-medium text-gray-700 mb-2",children:"Client"}),o.jsx("input",{id:"snapshotClient",type:"text",value:ce,onChange:ve=>ue(ve.target.value),placeholder:"Cassidy",className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-gray-900"})]})]}),o.jsxs("button",{onClick:Xe,disabled:z||!ne||!Ce,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed",children:[o.jsx(um,{size:18}),z?"Saving Snapshot...":"Save Snapshot"]})]}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Saved Snapshots"}),o.jsxs("button",{onClick:xe,disabled:M,className:"flex items-center gap-2 px-3 py-1 text-sm bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 transition-colors",children:[o.jsx(Cr,{size:16}),"Refresh"]})]}),M?o.jsx("div",{className:"text-center py-8 text-gray-500",children:"Loading snapshots..."}):be.length===0?o.jsx("div",{className:"text-center py-8 text-gray-500 bg-gray-50 rounded-md border border-gray-200",children:"No snapshots saved yet."}):o.jsx("div",{className:"space-y-3",children:be.map(ve=>o.jsx("div",{className:"p-4 bg-gray-50 rounded-md border border-gray-200 hover:border-blue-300 transition-colors",children:o.jsxs("div",{className:"flex items-start justify-between",children:[o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[o.jsx("h4",{className:"font-semibold text-gray-900",children:ve.projectMeta.name}),o.jsx("code",{className:"px-2 py-0.5 text-xs bg-white rounded border border-gray-300 text-gray-700",children:ve.projectKey})]}),o.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[o.jsxs("p",{children:[o.jsx("strong",{children:"Client:"})," ",ve.projectMeta.client," |",o.jsx("strong",{className:"ml-2",children:"Created:"})," ",ve.projectMeta.created]}),o.jsxs("p",{children:[o.jsx("strong",{children:"Suppliers:"})," ",ve.suppliers.length," |",o.jsx("strong",{className:"ml-2",children:"Items:"})," ",ve.normalisedLines.length," |",o.jsx("strong",{className:"ml-2",children:"Saved:"})," ",new Date(ve.snapshotDate||"").toLocaleDateString()]})]})]}),o.jsxs("div",{className:"flex gap-2 ml-4",children:[o.jsxs("button",{onClick:()=>pt(ve.projectKey),disabled:pe,className:"flex items-center gap-1 px-3 py-1 text-sm bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors disabled:bg-gray-400",children:[o.jsx(Cr,{size:14}),"Restore"]}),o.jsxs("button",{onClick:()=>tt(ve.projectKey),className:"flex items-center gap-1 px-3 py-1 text-sm bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors",children:[o.jsx(bo,{size:14}),"Delete"]})]})]})},ve.id))})]})]})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Account"}),o.jsx("div",{className:"space-y-4",children:o.jsxs("button",{onClick:async()=>{await se.auth.signOut()},className:"flex items-center gap-2 px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors",children:[o.jsx(RS,{size:18}),"Logout"]})})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"About PassiveFire Verify+"}),o.jsxs("div",{className:"text-sm text-gray-600 space-y-2",children:[o.jsx("p",{children:"Version 1.0"}),o.jsx("p",{children:"PassiveFire Verify+ helps you manage and analyze quotes for passive fire protection projects. Import quotes, review items, compare suppliers, and generate award reports."})]})]})]}),K&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:o.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full",children:[o.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:o.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"saveProjectAsTemplate.modal.title"})}),o.jsxs("div",{className:"px-6 py-4 space-y-4",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["saveProjectAsTemplate.modal.fields.name.label"," ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",value:q,onChange:ve=>X(ve.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white text-gray-900",placeholder:"saveProjectAsTemplate.modal.fields.name.placeholder"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"saveProjectAsTemplate.modal.fields.description.label"}),o.jsx("textarea",{value:ie,onChange:ve=>W(ve.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"saveProjectAsTemplate.modal.fields.description.placeholder"})]}),o.jsx("div",{className:"text-sm text-gray-600 bg-blue-50 border border-blue-200 rounded-lg p-3",children:"saveProjectAsTemplate.modal.description"})]}),o.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex items-center justify-end gap-3",children:[o.jsx("button",{onClick:()=>{Y(!1),X(""),W("")},className:"px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg transition-colors font-medium text-sm",children:"saveProjectAsTemplate.modal.buttons.cancel"}),o.jsx("button",{onClick:ar,disabled:U||!q.trim(),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium text-sm disabled:bg-gray-300 disabled:cursor-not-allowed",children:U?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Saving..."]}):o.jsxs(o.Fragment,{children:[o.jsx(um,{size:16}),"saveProjectAsTemplate.modal.buttons.confirm"]})})]})]})})]})}function qV({message:e,type:t,onClose:r,duration:s=5e3}){j.useEffect(()=>{if(s>0){const c=setTimeout(()=>{r()},s);return()=>clearTimeout(c)}},[s,r]);const n={success:tr,error:so,info:wo,warning:Je},a={success:"bg-green-50 text-green-800 border-green-200",error:"bg-red-50 text-red-800 border-red-200",info:"bg-blue-50 text-blue-800 border-blue-200",warning:"bg-yellow-50 text-yellow-800 border-yellow-200"},i={success:"text-green-600",error:"text-red-600",info:"text-blue-600",warning:"text-yellow-600"},l=n[t];return o.jsxs("div",{className:`fixed top-4 right-4 z-50 flex items-start gap-3 min-w-80 max-w-md p-4 rounded-lg border shadow-lg ${a[t]} animate-slide-in`,children:[o.jsx(l,{size:20,className:`flex-shrink-0 mt-0.5 ${i[t]}`}),o.jsx("div",{className:"flex-1 text-sm font-medium",children:e}),o.jsx("button",{onClick:r,className:"flex-shrink-0 hover:opacity-70 transition-opacity",children:o.jsx(ps,{size:18})})]})}class HV{constructor(){C0(this,"listeners",new Set);C0(this,"messages",[])}subscribe(t){return this.listeners.add(t),()=>this.listeners.delete(t)}notify(){this.listeners.forEach(t=>t([...this.messages]))}show(t){const r={...t,id:Math.random().toString(36).substring(2,11),createdAt:Date.now(),duration:t.duration||5e3};this.messages.push(r),this.notify(),r.duration&&r.duration>0&&setTimeout(()=>{this.dismiss(r.id)},r.duration)}dismiss(t){this.messages=this.messages.filter(r=>r.id!==t),this.notify()}remove(t){this.dismiss(t)}clear(){this.messages=[],this.notify()}showAccessDenied(t){this.show({type:"warning",title:"Access denied",body:t||"You don't have permission to manage organisation members. If you need access, please contact your organisation admin.",duration:6e3})}}const Mm=new HV;function GV(){const[e,t]=j.useState([]);j.useEffect(()=>Mm.subscribe(i=>{t(i.map(l=>({id:l.id,type:l.type,title:l.title,body:l.body||"",duration:l.duration||5e3})))}),[]);const r=a=>{Mm.remove(a)},s=a=>{switch(a){case"success":return o.jsx(tr,{className:"text-green-500",size:20});case"error":return o.jsx(Je,{className:"text-red-500",size:20});case"warning":return o.jsx(Je,{className:"text-amber-500",size:20});case"info":return o.jsx(wo,{className:"text-blue-500",size:20});default:return o.jsx(wo,{className:"text-gray-500",size:20})}},n=a=>{switch(a){case"success":return"bg-green-50 border-green-200";case"error":return"bg-red-50 border-red-200";case"warning":return"bg-amber-50 border-amber-200";case"info":return"bg-blue-50 border-blue-200";default:return"bg-gray-50 border-gray-200"}};return o.jsx("div",{className:"fixed top-4 right-4 z-50 flex flex-col gap-2 pointer-events-none",children:o.jsx(nx,{children:e.map(a=>o.jsx(rc.div,{initial:{opacity:0,x:100,scale:.8},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:100,scale:.8},className:`min-w-80 max-w-md rounded-lg border shadow-lg p-4 pointer-events-auto ${n(a.type)}`,children:o.jsxs("div",{className:"flex items-start gap-3",children:[s(a.type),o.jsxs("div",{className:"flex-1 min-w-0",children:[a.title&&o.jsx("div",{className:"font-semibold text-gray-900 mb-1",children:a.title}),o.jsx("div",{className:"text-sm text-gray-700",children:a.body})]}),o.jsx("button",{onClick:()=>r(a.id),className:"text-gray-400 hover:text-gray-600 transition-colors",children:o.jsx(ps,{size:18})})]})},a.id))})})}function KV(){return o.jsx("footer",{className:"py-4 px-6 flex justify-center lg:justify-end",children:o.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-full border border-gray-200 bg-white/90 text-xs text-gray-500",children:[o.jsx("span",{className:"font-medium",children:"PassiveFire Verify+"}),o.jsx("span",{className:"text-gray-300",children:""}),o.jsx("span",{children:"v1.9"}),o.jsx("span",{className:"text-gray-300",children:""}),o.jsx("span",{children:" 2025 PassiveFire Verify+. All rights reserved."})]})})}function XV({isOpen:e,onClose:t,currentProjectId:r,allProjects:s,onNavigate:n}){const[a,i]=j.useState(""),[l,c]=j.useState([{role:"assistant",content:"Hi! I'm your AI Copilot. I can help you navigate the app, answer questions about your quotes, and provide insights. What can I help you with?"}]),u=()=>{if(!a.trim())return;c(h=>[...h,{role:"user",content:a}]);const d=a.toLowerCase();let f="I'm still learning! This is a placeholder response. In production, I would be powered by AI to provide intelligent assistance.";d.includes("quote")||d.includes("import")?(f="To import quotes, navigate to the Quotes tab and upload your PDF or Excel files. I can help you with parsing issues if you encounter any.",setTimeout(()=>n("quotes",r),2e3)):d.includes("report")||d.includes("award")?(f="The Award Report is generated in the Reports section. It uses AI to analyze all quotes and recommend the best supplier based on price, coverage, and risk.",setTimeout(()=>n("reports",r),2e3)):(d.includes("scope")||d.includes("matrix"))&&(f="The Scope Matrix shows a side-by-side comparison of all suppliers' pricing. It highlights variances and helps identify gaps in coverage.",setTimeout(()=>n("scope",r),2e3)),setTimeout(()=>{c(h=>[...h,{role:"assistant",content:f}])},500),i("")};return o.jsx(nx,{children:e&&o.jsxs(o.Fragment,{children:[o.jsx(rc.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-30 z-40",onClick:t}),o.jsxs(rc.div,{initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:{type:"spring",damping:25,stiffness:200},className:"fixed right-0 top-0 h-full w-96 bg-white shadow-2xl z-50 flex flex-col",children:[o.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-purple-600 to-blue-600 rounded-full flex items-center justify-center",children:o.jsx(d0,{size:18,className:"text-white"})}),o.jsx("h2",{className:"text-lg font-semibold",children:"AI Copilot"})]}),o.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:o.jsx(ps,{size:20})})]}),o.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:l.map((d,f)=>o.jsx("div",{className:`flex ${d.role==="user"?"justify-end":"justify-start"}`,children:o.jsx("div",{className:`max-w-[80%] rounded-lg p-3 ${d.role==="user"?"bg-blue-600 text-white":"bg-gray-100 text-gray-900"}`,children:d.content})},f))}),o.jsx("div",{className:"p-4 border-t border-gray-200",children:o.jsxs("div",{className:"flex gap-2",children:[o.jsx("input",{type:"text",value:a,onChange:d=>i(d.target.value),onKeyPress:d=>d.key==="Enter"&&u(),placeholder:"Ask me anything...",className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),o.jsx("button",{onClick:u,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:o.jsx(MF,{size:18})})]})})]})]})})}function QV(){const[e,t]=j.useState(""),[r,s]=j.useState(""),[n,a]=j.useState(!1),[i,l]=j.useState(""),[c,u]=j.useState(!1),d=async f=>{f.preventDefault(),l(""),a(!0);try{if(c){const{error:h}=await se.auth.signUp({email:e,password:r});if(h)throw h;l("Check your email for the confirmation link")}else{const{error:h}=await se.auth.signInWithPassword({email:e,password:r});if(h)throw h}}catch(h){l(h.message||"An error occurred")}finally{a(!1)}};return o.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",children:o.jsxs("div",{className:"max-w-md w-full bg-white rounded-2xl shadow-xl p-8",children:[o.jsxs("div",{className:"text-center mb-8",children:[o.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-blue-600 rounded-full mb-4",children:o.jsx(sc,{className:"text-white",size:32})}),o.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"PassiveFire Verify+"}),o.jsx("p",{className:"text-gray-600",children:c?"Create your account":"Sign in to your account"})]}),o.jsxs("form",{onSubmit:d,className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),o.jsxs("div",{className:"relative",children:[o.jsx(OF,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:20}),o.jsx("input",{type:"email",value:e,onChange:f=>t(f.target.value),required:!0,className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white text-gray-900",placeholder:"you@example.com"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),o.jsxs("div",{className:"relative",children:[o.jsx(IF,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:20}),o.jsx("input",{type:"password",value:r,onChange:f=>s(f.target.value),required:!0,className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white text-gray-900",placeholder:""})]})]}),i&&o.jsx("div",{className:`text-sm ${i.includes("email")?"text-green-600":"text-red-600"} bg-red-50 p-3 rounded-lg`,children:i}),o.jsx("button",{type:"submit",disabled:n,className:"w-full bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed font-medium",children:n?"Please wait...":c?"Sign Up":"Sign In"})]}),o.jsx("div",{className:"mt-6 text-center",children:o.jsx("button",{onClick:()=>u(!c),className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:c?"Already have an account? Sign in":"Don't have an account? Sign up"})})]})})}function Iw({onOrganisationSelected:e}){const{organisations:t,setCurrentOrganisation:r,loading:s,refreshOrganisations:n}=wa(),[a,i]=j.useState(!1),[l,c]=j.useState(""),[u,d]=j.useState(""),f=m=>{r(m),e()},h=async()=>{if(!l.trim()){d("Please enter an organisation name");return}d(""),i(!0);try{const{data:{user:m}}=await se.auth.getUser();if(!m){d("Not authenticated"),i(!1);return}const{data:x,error:p}=await se.from("organisations").insert({name:l.trim()}).select().single();if(p)throw p;await se.from("organisation_members").insert({organisation_id:x.id,user_id:m.id,role:"admin"}),await n(),c(""),d(""),r(x),e()}catch(m){d(m.message||"Failed to create organisation")}finally{i(!1)}};return s?o.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:o.jsxs("div",{className:"text-center",children:[o.jsx(js,{className:"mx-auto mb-4 text-blue-600 animate-spin",size:48}),o.jsx("p",{className:"text-gray-600",children:"Loading organisations..."})]})}):o.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:o.jsxs("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-8",children:[o.jsxs("div",{className:"text-center mb-6",children:[o.jsx(yo,{className:"mx-auto mb-4 text-blue-600",size:48}),o.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Select Organisation"}),o.jsx("p",{className:"text-gray-600",children:"Choose which organisation to work with"})]}),t.length>0?o.jsx("div",{className:"space-y-3",children:t.map(m=>o.jsx("button",{onClick:()=>f(m),className:"w-full p-4 border border-gray-200 rounded-lg hover:border-blue-500 hover:bg-blue-50 transition-colors text-left",children:o.jsx("div",{className:"font-semibold text-gray-900",children:m.name})},m.id))}):o.jsxs("div",{className:"text-center py-8",children:[o.jsx(Je,{className:"mx-auto mb-4 text-gray-400",size:48}),o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Organisations Found"}),o.jsx("p",{className:"text-gray-600 mb-6",children:"You are not a member of any organisation yet. Create one to get started."}),o.jsxs("div",{className:"space-y-3",children:[o.jsx("input",{type:"text",value:l,onChange:m=>c(m.target.value),onKeyPress:m=>m.key==="Enter"&&h(),placeholder:"Organisation name",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:a}),u&&o.jsx("div",{className:"text-red-600 text-sm",children:u}),o.jsx("button",{onClick:h,disabled:a,className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:a?o.jsxs(o.Fragment,{children:[o.jsx(js,{size:20,className:"animate-spin"}),"Creating..."]}):o.jsxs(o.Fragment,{children:[o.jsx(u0,{size:20}),"Create Organisation"]})})]})]})]})})}function YV(){const{currentOrganisation:e}=wa();return o.jsxs("div",{children:[o.jsx(ua,{title:"Organisation Settings",description:"Manage your organisation preferences"}),o.jsxs("div",{className:"mt-6 p-6 bg-white rounded-lg border border-gray-200",children:[o.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Current Organisation"}),o.jsx("p",{className:"text-gray-600",children:e==null?void 0:e.name})]})]})}function Ow(){return o.jsxs("div",{className:"p-8",children:[o.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Admin Dashboard"}),o.jsx("p",{className:"text-gray-600",children:"Platform administration"})]})}function JV(){const[e,t]=j.useState([]),[r,s]=j.useState([]),[n,a]=j.useState(!0),[i,l]=j.useState(""),[c,u]=j.useState("all");j.useEffect(()=>{d()},[]),j.useEffect(()=>{f()},[i,c,e]);const d=async()=>{try{const{data:x,error:p}=await se.from("organisations").select("*").order("created_at",{ascending:!1});if(p)throw p;const g=await Promise.all((x||[]).map(async w=>{const{data:v}=await se.from("organisation_members").select("user_id, role, status").eq("organisation_id",w.id),y=v==null?void 0:v.find(C=>C.role==="owner"),b=(v==null?void 0:v.filter(C=>C.status==="active"&&["owner","admin","member"].includes(C.role)).length)||0;let S="";if(y){const{data:C}=await se.from("profiles").select("email, full_name").eq("id",y.user_id).maybeSingle();S=(C==null?void 0:C.email)||""}const{data:k}=await se.from("subscriptions").select("plan_name").eq("organisation_id",w.id).maybeSingle(),{count:_}=await se.from("projects").select("*",{count:"exact",head:!0}).eq("organisation_id",w.id),{data:N}=await se.from("projects").select("updated_at").eq("organisation_id",w.id).order("updated_at",{ascending:!1}).limit(1).maybeSingle();return{...w,owner_email:S,plan_name:(k==null?void 0:k.plan_name)||"Trial",seats_used:b,project_count:_||0,last_active:(N==null?void 0:N.updated_at)||w.created_at}}));t(g)}catch(x){console.error("Error loading organisations:",x)}finally{a(!1)}},f=()=>{let x=e;if(c!=="all"&&(x=x.filter(p=>p.status===c)),i.trim()){const p=i.toLowerCase();x=x.filter(g=>g.name.toLowerCase().includes(p)||g.owner_email&&g.owner_email.toLowerCase().includes(p))}s(x)},h=x=>new Date(x).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"}),m=x=>{switch(x){case"trial":return"bg-amber-50 text-amber-700";case"suspended":return"bg-rose-50 text-rose-700";default:return"bg-emerald-50 text-emerald-700"}};return o.jsxs("div",{className:"px-6 py-6 max-w-7xl mx-auto",children:[o.jsxs("div",{className:"flex items-start justify-between mb-6",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-xl font-semibold text-slate-900",children:"Organisations"}),o.jsx("p",{className:"mt-1 text-sm text-slate-500",children:"Manage client organisations, seat limits, and subscription status."})]}),o.jsx("button",{onClick:()=>window.location.href="/admin/organisations/new",className:"inline-flex items-center rounded-lg bg-[#0A66C2] px-4 py-2 text-sm font-semibold text-white shadow hover:bg-[#0952A0] transition",children:"Create organisation"})]}),o.jsxs("div",{className:"mb-4 flex items-center gap-4",children:[o.jsxs("div",{className:"relative flex-1",children:[o.jsx(kd,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:16}),o.jsx("input",{type:"text",placeholder:"Search by organisation name or owner email",value:i,onChange:x=>l(x.target.value),className:"w-full rounded-lg border border-slate-300 bg-slate-50 pl-9 pr-3 py-2 text-sm text-slate-800 placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-[#0A66C2] focus:border-[#0A66C2]"})]}),o.jsxs("select",{value:c,onChange:x=>u(x.target.value),className:"rounded-lg border border-slate-300 bg-slate-50 px-3 py-2 text-sm text-slate-800 focus:outline-none focus:ring-2 focus:ring-[#0A66C2] focus:border-[#0A66C2]",children:[o.jsx("option",{value:"all",children:"All"}),o.jsx("option",{value:"active",children:"Active"}),o.jsx("option",{value:"trial",children:"Trial"}),o.jsx("option",{value:"suspended",children:"Suspended"})]})]}),o.jsx("div",{className:"rounded-xl border border-slate-200 bg-white shadow-[0_4px_14px_rgba(15,23,42,0.06)] overflow-hidden",children:n?o.jsx("div",{className:"text-center py-12 text-slate-500",children:"Loading organisations..."}):r.length===0?o.jsx("div",{className:"text-center py-12 text-slate-500",children:i||c!=="all"?"No organisations found":"No organisations yet"}):o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full table-auto text-left text-sm",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"border-b border-slate-100",children:[o.jsx("th",{className:"px-4 py-3 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Organisation"}),o.jsx("th",{className:"px-4 py-3 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Owner"}),o.jsx("th",{className:"px-4 py-3 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Plan"}),o.jsx("th",{className:"px-4 py-3 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Seats"}),o.jsx("th",{className:"px-4 py-3 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Projects"}),o.jsx("th",{className:"px-4 py-3 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Status"}),o.jsx("th",{className:"px-4 py-3 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Last active"}),o.jsx("th",{className:"px-4 py-3 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Actions"})]})}),o.jsx("tbody",{children:r.map(x=>o.jsxs("tr",{className:"border-b border-slate-100 hover:bg-slate-50 cursor-pointer",onClick:()=>window.location.href=`/admin/organisations/${x.id}`,children:[o.jsx("td",{className:"px-4 py-3 align-middle",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"font-medium text-slate-900",children:x.name}),x.status!=="active"&&o.jsx("span",{className:`inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium ${m(x.status)}`,children:x.status.charAt(0).toUpperCase()+x.status.slice(1)})]})}),o.jsx("td",{className:"px-4 py-3 align-middle text-sm text-slate-600",children:x.owner_email||""}),o.jsx("td",{className:"px-4 py-3 align-middle text-sm text-slate-800",children:x.plan_name}),o.jsx("td",{className:"px-4 py-3 align-middle text-sm text-slate-800",children:o.jsxs("span",{className:x.seats_used>x.seat_limit?"text-rose-600 font-medium":"",children:[x.seats_used," / ",x.seat_limit]})}),o.jsx("td",{className:"px-4 py-3 align-middle text-sm text-slate-800",children:x.project_count}),o.jsx("td",{className:"px-4 py-3 align-middle",children:o.jsx("span",{className:`inline-flex items-center rounded-full px-2 py-1 text-xs font-medium ${m(x.status)}`,children:x.status.charAt(0).toUpperCase()+x.status.slice(1)})}),o.jsx("td",{className:"px-4 py-3 align-middle text-sm text-slate-600",children:h(x.last_active)}),o.jsx("td",{className:"px-4 py-3 align-middle",children:o.jsx("button",{onClick:p=>{p.stopPropagation(),window.location.href=`/admin/organisations/${x.id}`},className:"text-xs font-medium text-[#0A66C2] hover:underline",children:"Open"})})]},x.id))})]})})})]})}function ZV({organisationId:e}){const[t,r]=j.useState(null),[s,n]=j.useState(null),[a,i]=j.useState([]),[l,c]=j.useState([]),[u,d]=j.useState(!0),[f,h]=j.useState(!1),[m,x]=j.useState(!1),[p,g]=j.useState(""),[w,v]=j.useState(10),[y,b]=j.useState(null),[S,k]=j.useState(""),[_,N]=j.useState("");j.useEffect(()=>{C()},[e]);const C=async()=>{try{const{data:X,error:ie}=await se.from("organisations").select("*").eq("id",e).single();if(ie)throw ie;r(X),v(X.seat_limit),N(new Date(X.created_at).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"}));const{data:W}=await se.from("subscriptions").select("*").eq("organisation_id",e).maybeSingle();n(W),g((W==null?void 0:W.plan_name)||"Trial");const{data:U}=await se.from("organisation_members").select("*").eq("organisation_id",e).order("activated_at",{ascending:!1,nullsFirst:!1}),he=await Promise.all((U||[]).map(async M=>{const{data:O}=await se.from("profiles").select("email, full_name").eq("id",M.user_id).maybeSingle();return M.role==="owner"&&k((O==null?void 0:O.email)||"Unknown"),{...M,email:(O==null?void 0:O.email)||"Unknown",full_name:O==null?void 0:O.full_name}}));i(he);const{data:be}=await se.from("projects").select("*").eq("organisation_id",e).order("updated_at",{ascending:!1}),R=await Promise.all((be||[]).map(async M=>{const{count:O}=await se.from("quotes").select("*",{count:"exact",head:!0}).eq("project_id",M.id),{data:z}=await se.from("profiles").select("email").eq("id",M.user_id).maybeSingle();return{...M,quote_count:O||0,owner_email:z==null?void 0:z.email}}));c(R)}catch(X){console.error("Error loading organisation:",X)}finally{d(!1)}},B=async()=>{if(t){h(!0);try{const{error:X}=await se.from("organisations").update({seat_limit:w}).eq("id",e);if(X)throw X;if(s){const{error:ie}=await se.from("subscriptions").update({plan_name:p,seat_limit:w}).eq("organisation_id",e);if(ie)throw ie}b({type:"success",message:"Changes saved successfully"}),x(!1),await C()}catch(X){b({type:"error",message:X.message||"Failed to save changes"})}finally{h(!1)}}},H=async()=>{if(confirm("Suspend this organisation? Members will lose access immediately."))try{const{error:X}=await se.from("organisations").update({status:"suspended"}).eq("id",e);if(X)throw X;b({type:"success",message:"Organisation suspended"}),await C()}catch(X){b({type:"error",message:X.message||"Failed to suspend organisation"})}},V=async()=>{try{const{error:X}=await se.from("organisations").update({status:"active"}).eq("id",e);if(X)throw X;b({type:"success",message:"Organisation activated"}),await C()}catch(X){b({type:"error",message:X.message||"Failed to activate organisation"})}},K=X=>new Date(X).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"}),Y=X=>{switch(X){case"trial":return"bg-amber-50 text-amber-700 border-amber-200";case"suspended":return"bg-rose-50 text-rose-700 border-rose-200";default:return"bg-emerald-50 text-emerald-700 border-emerald-200"}},q=a.filter(X=>X.status==="active"&&["owner","admin","member"].includes(X.role)).length;return u?o.jsx("div",{className:"px-6 py-6 max-w-7xl mx-auto",children:o.jsx("div",{className:"text-center py-12 text-slate-500",children:"Loading organisation..."})}):t?o.jsxs("div",{className:"px-6 py-6 max-w-7xl mx-auto",children:[y&&o.jsxs("div",{className:`fixed top-4 right-4 z-50 rounded-lg px-4 py-3 shadow-lg flex items-center gap-3 ${y.type==="success"?"bg-emerald-50 text-emerald-800 border border-emerald-200":"bg-rose-50 text-rose-800 border border-rose-200"}`,children:[y.type==="error"&&o.jsx(Je,{size:18}),o.jsx("span",{className:"text-sm font-medium",children:y.message}),o.jsx("button",{onClick:()=>b(null),className:"ml-2",children:o.jsx(ps,{size:16})})]}),o.jsxs("button",{onClick:()=>window.location.href="/admin/organisations",className:"inline-flex items-center gap-2 text-sm text-slate-600 hover:text-slate-900 mb-4",children:[o.jsx(Po,{size:16}),"Back to organisations"]}),o.jsxs("div",{className:"flex items-start justify-between mb-6",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-xl font-semibold text-slate-900",children:t.name}),o.jsxs("p",{className:"mt-1 text-sm text-slate-500",children:["Created ",_,"  Owner: ",S]})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("span",{className:`inline-flex items-center rounded-full border px-3 py-1 text-xs font-medium ${Y(t.status)}`,children:t.status.charAt(0).toUpperCase()+t.status.slice(1)}),t.status==="suspended"?o.jsx("button",{onClick:V,className:"inline-flex items-center rounded-lg bg-emerald-600 px-4 py-2 text-sm font-semibold text-white shadow hover:bg-emerald-700 transition",children:"Activate"}):o.jsx("button",{onClick:H,className:"inline-flex items-center rounded-lg bg-rose-600 px-4 py-2 text-sm font-semibold text-white shadow hover:bg-rose-700 transition",children:"Suspend"})]})]}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[o.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[o.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white shadow-[0_4px_14px_rgba(15,23,42,0.06)] p-4",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsx("h2",{className:"text-sm font-semibold text-slate-900",children:"Plan & seats"}),m?null:o.jsx("button",{onClick:()=>x(!0),className:"text-xs font-medium text-[#0A66C2] hover:underline",children:"Edit"})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Plan"}),o.jsxs("select",{value:p,onChange:X=>g(X.target.value),disabled:!m,className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-[#0A66C2] focus:border-[#0A66C2] disabled:bg-slate-50 disabled:text-slate-500",children:[o.jsx("option",{value:"Trial",children:"Trial (14 days)"}),o.jsx("option",{value:"Starter",children:"Starter"}),o.jsx("option",{value:"Pro",children:"Pro"}),o.jsx("option",{value:"Enterprise",children:"Enterprise"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Seat limit"}),o.jsx("input",{type:"number",value:w,onChange:X=>v(parseInt(X.target.value)||0),disabled:!m,className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-[#0A66C2] focus:border-[#0A66C2] disabled:bg-slate-50 disabled:text-slate-500"}),o.jsxs("p",{className:"mt-1 text-xs text-slate-500",children:["Currently using ",q," seats. Owners, admins, and members use a seat. Viewers are free."]}),w<q&&o.jsxs("p",{className:"mt-1 text-xs text-rose-600",children:["Warning: This organisation uses ",q," seats. Reducing to ",w," will place them over their limit."]})]}),m&&o.jsxs("div",{className:"flex items-center gap-3 pt-2",children:[o.jsx("button",{onClick:B,disabled:f,className:"px-4 py-2 rounded-lg bg-[#0A66C2] text-sm font-semibold text-white hover:bg-[#0952A0] disabled:opacity-50 transition",children:f?"Saving...":"Save changes"}),o.jsx("button",{onClick:()=>{x(!1),v(t.seat_limit),g((s==null?void 0:s.plan_name)||"Trial")},className:"px-4 py-2 text-sm font-medium text-slate-700 hover:text-slate-900",children:"Cancel"})]})]})]}),o.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white shadow-[0_4px_14px_rgba(15,23,42,0.06)] p-4",children:[o.jsx("h2",{className:"text-sm font-semibold text-slate-900 mb-3",children:"Members"}),o.jsx("p",{className:"text-xs text-slate-500 mb-4",children:"Overview of all members in this organisation. Seat-consuming roles are highlighted."}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full table-auto text-left text-sm",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"border-b border-slate-100",children:[o.jsx("th",{className:"px-2 py-2 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Member"}),o.jsx("th",{className:"px-2 py-2 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Email"}),o.jsx("th",{className:"px-2 py-2 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Role"}),o.jsx("th",{className:"px-2 py-2 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Status"}),o.jsx("th",{className:"px-2 py-2 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Last active"})]})}),o.jsx("tbody",{children:a.map(X=>o.jsxs("tr",{className:"border-b border-slate-50",children:[o.jsx("td",{className:"px-2 py-2 text-sm text-slate-900",children:X.full_name||X.email.split("@")[0]}),o.jsx("td",{className:"px-2 py-2 text-sm text-slate-600",children:X.email}),o.jsx("td",{className:"px-2 py-2",children:o.jsx("span",{className:`inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium ${["owner","admin","member"].includes(X.role)?"bg-blue-50 text-blue-700":"bg-slate-50 text-slate-700"}`,children:X.role.charAt(0).toUpperCase()+X.role.slice(1)})}),o.jsx("td",{className:"px-2 py-2",children:o.jsx("span",{className:`inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium ${X.status==="active"?"bg-emerald-50 text-emerald-700":X.status==="invited"?"bg-slate-50 text-slate-700":"bg-rose-50 text-rose-700"}`,children:X.status.charAt(0).toUpperCase()+X.status.slice(1)})}),o.jsx("td",{className:"px-2 py-2 text-sm text-slate-600",children:X.activated_at?K(X.activated_at):"Never"})]},X.id))})]})})]}),o.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white shadow-[0_4px_14px_rgba(15,23,42,0.06)] p-4",children:[o.jsx("h2",{className:"text-sm font-semibold text-slate-900 mb-4",children:"Projects"}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full table-auto text-left text-sm",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"border-b border-slate-100",children:[o.jsx("th",{className:"px-2 py-2 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Project"}),o.jsx("th",{className:"px-2 py-2 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Status"}),o.jsx("th",{className:"px-2 py-2 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Last updated"}),o.jsx("th",{className:"px-2 py-2 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Quotes"}),o.jsx("th",{className:"px-2 py-2 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Owner"})]})}),o.jsx("tbody",{children:l.length===0?o.jsx("tr",{children:o.jsx("td",{colSpan:5,className:"px-2 py-4 text-center text-sm text-slate-500",children:"No projects yet"})}):l.map(X=>o.jsxs("tr",{className:"border-b border-slate-50",children:[o.jsx("td",{className:"px-2 py-2 font-medium text-sm text-slate-900",children:X.name}),o.jsx("td",{className:"px-2 py-2",children:o.jsx("span",{className:`inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium ${X.status==="active"?"bg-emerald-50 text-emerald-700":"bg-slate-50 text-slate-700"}`,children:X.status.charAt(0).toUpperCase()+X.status.slice(1)})}),o.jsx("td",{className:"px-2 py-2 text-sm text-slate-600",children:K(X.updated_at)}),o.jsx("td",{className:"px-2 py-2 text-sm text-slate-800",children:X.quote_count}),o.jsx("td",{className:"px-2 py-2 text-sm text-slate-600",children:X.owner_email||""})]},X.id))})]})})]})]}),o.jsx("div",{children:o.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white shadow-[0_4px_14px_rgba(15,23,42,0.06)] p-4",children:[o.jsx("h2",{className:"text-sm font-semibold text-slate-900 mb-3",children:"Quick actions"}),o.jsx("div",{className:"space-y-2",children:o.jsx("button",{onClick:()=>navigator.clipboard.writeText(e),className:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-slate-50 rounded-lg transition",children:"Copy organisation ID"})})]})})]})]}):o.jsx("div",{className:"px-6 py-6 max-w-7xl mx-auto",children:o.jsx("div",{className:"text-center py-12 text-slate-500",children:"Organisation not found"})})}function eW(){const[e,t]=j.useState(""),[r,s]=j.useState("Trial"),[n,a]=j.useState(5),[i,l]=j.useState(""),[c,u]=j.useState(""),[d,f]=j.useState(!1),[h,m]=j.useState(null),x=async()=>{if(!e||!i){m({type:"error",message:"Please fill in all required fields"});return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(i)){m({type:"error",message:"Please enter a valid email address"});return}f(!0);try{const{data:{user:p}}=await se.auth.getUser(),{data:g,error:w}=await se.from("organisations").insert({name:e,status:r==="Trial"?"trial":"active",seat_limit:n,created_by_user_id:p==null?void 0:p.id}).select().single();if(w)throw w;const{error:v}=await se.from("subscriptions").insert({organisation_id:g.id,plan_name:r,seat_limit:n,billing_status:"active"});if(v)throw v;let y="";const{data:b}=await se.from("profiles").select("id").eq("email",i).maybeSingle();if(b)y=b.id;else{const k=Math.random().toString(36).slice(-12),{data:_,error:N}=await se.auth.admin.createUser({email:i,password:k,email_confirm:!1});if(N)throw N;y=_.user.id}const{error:S}=await se.from("organisation_members").insert({organisation_id:g.id,user_id:y,role:"owner",status:"invited",invited_by_user_id:p==null?void 0:p.id});if(S)throw S;window.location.href=`/admin/organisations/${g.id}`}catch(p){console.error("Error creating organisation:",p),m({type:"error",message:p.message||"Failed to create organisation"}),f(!1)}};return o.jsxs("div",{className:"px-6 py-6 max-w-3xl mx-auto",children:[h&&o.jsxs("div",{className:`fixed top-4 right-4 z-50 rounded-lg px-4 py-3 shadow-lg flex items-center gap-3 ${h.type==="success"?"bg-emerald-50 text-emerald-800 border border-emerald-200":"bg-rose-50 text-rose-800 border border-rose-200"}`,children:[h.type==="error"&&o.jsx(Je,{size:18}),o.jsx("span",{className:"text-sm font-medium",children:h.message}),o.jsx("button",{onClick:()=>m(null),className:"ml-2",children:o.jsx(ps,{size:16})})]}),o.jsxs("button",{onClick:()=>window.location.href="/admin/organisations",className:"inline-flex items-center gap-2 text-sm text-slate-600 hover:text-slate-900 mb-6",children:[o.jsx(Po,{size:16}),"Back to organisations"]}),o.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white shadow-[0_4px_14px_rgba(15,23,42,0.06)] p-6",children:[o.jsx("h1",{className:"text-xl font-semibold text-slate-900 mb-2",children:"Create organisation"}),o.jsx("p",{className:"text-sm text-slate-500 mb-6",children:"Set up a new organisation with a primary owner who will receive an invite email."}),o.jsxs("div",{className:"space-y-5",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Organisation name ",o.jsx("span",{className:"text-rose-600",children:"*"})]}),o.jsx("input",{type:"text",placeholder:"Optimal Fire",value:e,onChange:p=>t(p.target.value),className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-[#0A66C2] focus:border-[#0A66C2] bg-white text-gray-900"})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Plan ",o.jsx("span",{className:"text-rose-600",children:"*"})]}),o.jsxs("select",{value:r,onChange:p=>s(p.target.value),className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-[#0A66C2] focus:border-[#0A66C2]",children:[o.jsx("option",{value:"Trial",children:"Trial (14 days)"}),o.jsx("option",{value:"Starter",children:"Starter"}),o.jsx("option",{value:"Pro",children:"Pro"}),o.jsx("option",{value:"Enterprise",children:"Enterprise"})]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Seat limit ",o.jsx("span",{className:"text-rose-600",children:"*"})]}),o.jsx("input",{type:"number",value:n,onChange:p=>a(parseInt(p.target.value)||0),min:"1",className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-[#0A66C2] focus:border-[#0A66C2] bg-white text-gray-900"}),o.jsx("p",{className:"mt-1 text-xs text-slate-500",children:"Owners, admins, and members use a seat. Viewers are free."})]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Primary owner email ",o.jsx("span",{className:"text-rose-600",children:"*"})]}),o.jsx("input",{type:"email",placeholder:"owner@company.com",value:i,onChange:p=>l(p.target.value),className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-[#0A66C2] focus:border-[#0A66C2] bg-white text-gray-900"}),o.jsx("p",{className:"mt-1 text-xs text-slate-500",children:"We'll send an invite to this email. They'll become the Organisation Owner."})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Internal notes"}),o.jsx("textarea",{placeholder:"Optional admin-only notes about this organisation...",value:c,onChange:p=>u(p.target.value),rows:3,className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-[#0A66C2] focus:border-[#0A66C2] resize-none"})]})]}),o.jsxs("div",{className:"mt-6 flex items-center justify-end gap-3 pt-4 border-t border-slate-200",children:[o.jsx("button",{onClick:()=>window.location.href="/admin/organisations",className:"px-4 py-2 text-sm font-medium text-slate-700 hover:text-slate-900",disabled:d,children:"Cancel"}),o.jsx("button",{onClick:x,disabled:d||!e||!i,className:"px-4 py-2 rounded-lg bg-[#0A66C2] text-sm font-semibold text-white hover:bg-[#0952A0] disabled:opacity-50 disabled:cursor-not-allowed transition",children:d?"Creating...":"Create organisation"})]})]})]})}function tW({organisationId:e,organisationName:t,currentLicenses:r,subscriptionStatus:s,onClose:n,onUpdate:a}){const[i,l]=j.useState(r),[c,u]=j.useState(!1),[d,f]=j.useState(null),h=async v=>{u(!0),f(null);try{const y=await wR(e,v);l(y.licensedTrades),f({type:"success",text:y.message}),setTimeout(()=>a(),1e3)}catch(y){console.error("Failed to add license:",y),f({type:"error",text:"Failed to add trade license"})}finally{u(!1)}},m=async v=>{if(i.length===1){f({type:"error",text:"Cannot remove last trade license"});return}u(!0),f(null);try{const y=await bR(e,v);l(y.licensedTrades),f({type:"success",text:y.message}),setTimeout(()=>a(),1e3)}catch(y){console.error("Failed to remove license:",y),f({type:"error",text:"Failed to remove trade license"})}finally{u(!1)}},p=(()=>{const v=i.reduce((y,b)=>{const S=Hs.find(k=>k.value===b);return y+((S==null?void 0:S.price)||0)},0);return i.length===2?v*.85:i.length===3?v*.75:i.length>=4?v*.65:v})(),g=i.reduce((v,y)=>{const b=Hs.find(S=>S.value===y);return v+((b==null?void 0:b.price)||0)},0),w=g-p;return o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-3xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[o.jsxs("div",{className:"p-6 border-b border-gray-200 flex items-center justify-between sticky top-0 bg-white",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Manage Trade Licenses"}),o.jsx("p",{className:"text-gray-600 mt-1",children:t})]}),o.jsx("button",{onClick:n,className:"p-2 text-gray-400 hover:text-gray-600 transition-colors",children:o.jsx(ps,{size:24})})]}),d&&o.jsx("div",{className:`mx-6 mt-4 p-4 rounded-md ${d.type==="success"?"bg-green-50 text-green-800":"bg-red-50 text-red-800"}`,children:d.text}),o.jsxs("div",{className:"p-6 space-y-6",children:[s==="trial"&&o.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[o.jsx("div",{className:"font-semibold text-blue-900 mb-1",children:"Trial Mode"}),o.jsx("div",{className:"text-sm text-blue-800",children:"This client is on trial and can access all trades. Licenses will be enforced when they convert to paid."})]}),o.jsxs("div",{children:[o.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Current Licensed Trades"}),o.jsx("div",{className:"space-y-2",children:i.length===0?o.jsx("div",{className:"text-gray-500 text-sm",children:"No trade licenses active"}):i.map(v=>{const y=Hs.find(b=>b.value===v);return y?o.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:`w-3 h-3 rounded-full bg-${y.color}-500`}),o.jsxs("div",{children:[o.jsx("div",{className:"font-medium text-gray-900",children:y.label}),o.jsxs("div",{className:"text-sm text-gray-600",children:["$",y.price,"/month"]})]})]}),o.jsx("button",{onClick:()=>m(v),disabled:c||i.length===1,className:"p-2 text-red-600 hover:bg-red-50 rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:i.length===1?"Cannot remove last license":"Remove license",children:o.jsx(bo,{size:16})})]},v):null})})]}),o.jsxs("div",{children:[o.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Available Trades to Add"}),o.jsx("div",{className:"grid grid-cols-2 gap-3",children:Hs.filter(v=>!i.includes(v.value)).map(v=>o.jsxs("button",{onClick:()=>h(v.value),disabled:c,className:"flex items-center gap-3 p-4 border-2 border-gray-200 rounded-lg hover:border-blue-500 hover:bg-blue-50 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:[o.jsx("div",{className:`w-4 h-4 rounded-full bg-${v.color}-500`}),o.jsxs("div",{className:"text-left flex-1",children:[o.jsx("div",{className:"font-medium text-gray-900",children:v.label}),o.jsxs("div",{className:"text-sm text-gray-600",children:["$",v.price,"/month"]})]}),o.jsx(u0,{size:20,className:"text-gray-400"})]},v.value))}),Hs.filter(v=>!i.includes(v.value)).length===0&&o.jsxs("div",{className:"text-center p-8 bg-green-50 rounded-lg",children:[o.jsx(mx,{size:48,className:"mx-auto mb-2 text-green-600"}),o.jsx("div",{className:"font-semibold text-green-900",children:"All Trades Licensed!"}),o.jsx("div",{className:"text-sm text-green-700 mt-1",children:"This client has access to every trade"})]})]}),o.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-blue-100 border border-blue-200 rounded-lg p-6",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[o.jsx(FS,{className:"text-blue-600",size:24}),o.jsx("h3",{className:"font-bold text-blue-900",children:"Revenue Calculation"})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex justify-between text-sm",children:[o.jsxs("span",{className:"text-blue-800",children:["Base Price (",i.length," trades):"]}),o.jsxs("span",{className:"font-medium text-blue-900",children:["$",g,"/month"]})]}),i.length>=2&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex justify-between text-sm",children:[o.jsxs("span",{className:"text-blue-800",children:["Bundle Discount (",i.length===2&&"15%",i.length===3&&"25%",i.length>=4&&"35%","):"]}),o.jsxs("span",{className:"font-medium text-green-600",children:["-$",w.toFixed(0)]})]}),o.jsx("div",{className:"h-px bg-blue-300 my-2"})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"font-bold text-blue-900",children:"Monthly Revenue:"}),o.jsxs("span",{className:"text-2xl font-bold text-blue-900",children:["$",p.toFixed(0)]})]}),o.jsxs("div",{className:"text-xs text-blue-700 mt-2",children:[i.length===1&&"Add another trade for 15% bundle discount",i.length===2&&"Add one more trade for 25% bundle discount (10% more savings)",i.length===3&&"Add all trades for 35% bundle discount",i.length>=4&&"Maximum bundle discount applied!"]})]})]}),o.jsx("div",{className:"flex gap-3",children:o.jsx("button",{onClick:n,className:"flex-1 px-6 py-3 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 font-medium",children:"Close"})})]})]})})}function Dw(){const[e,t]=j.useState([]),[r,s]=j.useState(!0),[n,a]=j.useState("all"),[i,l]=j.useState(""),[c,u]=j.useState(null),[d,f]=j.useState(null);j.useEffect(()=>{h()},[]);const h=async()=>{s(!0);try{const b=await fR();t(b)}catch(b){console.error("Failed to load organisations:",b),u({type:"error",text:"Failed to load organisations"})}finally{s(!1)}},m=async(b,S)=>{try{await mR(b,S),u({type:"success",text:`Trial extended by ${S} days`}),await h()}catch(k){console.error("Failed to extend trial:",k),u({type:"error",text:"Failed to extend trial"})}},x=async(b,S)=>{try{await pR(b,S),u({type:"success",text:`Status updated to ${S}`}),await h()}catch(k){console.error("Failed to update status:",k),u({type:"error",text:"Failed to update status"})}},p=async b=>{try{await xR(b.id)}catch(S){console.error("Failed to impersonate:",S),u({type:"error",text:"Failed to enter client mode"})}},g=b=>{if(!b)return null;const S=new Date(b),k=new Date,_=S.getTime()-k.getTime();return Math.ceil(_/(1e3*60*60*24))},w=b=>{switch(b){case"trial":return"bg-blue-100 text-blue-800";case"active":return"bg-green-100 text-green-800";case"expired":return"bg-red-100 text-red-800";case"suspended":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},v=e.filter(b=>!(n!=="all"&&b.subscription_status!==n||i&&!b.name.toLowerCase().includes(i.toLowerCase()))),y={total:e.length,trial:e.filter(b=>b.subscription_status==="trial").length,active:e.filter(b=>b.subscription_status==="active").length,expired:e.filter(b=>b.subscription_status==="expired").length,totalQuotes:e.reduce((b,S)=>b+S.quote_count,0)};return r?o.jsx("div",{className:"flex items-center justify-center h-64",children:o.jsx("div",{className:"text-gray-500",children:"Loading clients..."})}):o.jsxs("div",{className:"space-y-6",children:[o.jsx(ua,{title:"Super Admin Dashboard",subtitle:"God-mode control over all clients and trades"}),c&&o.jsx("div",{className:`p-4 rounded-md ${c.type==="success"?"bg-green-50 text-green-800":"bg-red-50 text-red-800"}`,children:c.text}),o.jsxs("div",{className:"grid grid-cols-5 gap-4",children:[o.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(OS,{className:"text-gray-600",size:24}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm text-gray-600",children:"Total Clients"}),o.jsx("div",{className:"text-2xl font-bold text-gray-900",children:y.total})]})]})}),o.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-blue-200 p-4",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(c0,{className:"text-blue-600",size:24}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm text-blue-600",children:"On Trial"}),o.jsx("div",{className:"text-2xl font-bold text-blue-600",children:y.trial})]})]})}),o.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-green-200 p-4",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(tr,{className:"text-green-600",size:24}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm text-green-600",children:"Active Paid"}),o.jsx("div",{className:"text-2xl font-bold text-green-600",children:y.active})]})]})}),o.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-red-200 p-4",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(so,{className:"text-red-600",size:24}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm text-red-600",children:"Expired"}),o.jsx("div",{className:"text-2xl font-bold text-red-600",children:y.expired})]})]})}),o.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(Yr,{className:"text-gray-600",size:24}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm text-gray-600",children:"Total Quotes"}),o.jsx("div",{className:"text-2xl font-bold text-gray-900",children:y.totalQuotes})]})]})})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[o.jsx("div",{className:"p-4 border-b border-gray-200",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex gap-2",children:[o.jsxs("button",{onClick:()=>a("all"),className:`px-4 py-2 rounded-md font-medium transition-colors ${n==="all"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["All (",y.total,")"]}),o.jsxs("button",{onClick:()=>a("trial"),className:`px-4 py-2 rounded-md font-medium transition-colors ${n==="trial"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["Trial (",y.trial,")"]}),o.jsxs("button",{onClick:()=>a("active"),className:`px-4 py-2 rounded-md font-medium transition-colors ${n==="active"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["Active (",y.active,")"]}),o.jsxs("button",{onClick:()=>a("expired"),className:`px-4 py-2 rounded-md font-medium transition-colors ${n==="expired"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["Expired (",y.expired,")"]})]}),o.jsxs("div",{className:"flex gap-3",children:[o.jsx("input",{type:"text",placeholder:"Search clients...",value:i,onChange:b=>l(b.target.value),className:"px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),o.jsxs("button",{onClick:()=>window.location.href="/admin/clients/new",className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 font-medium",children:[o.jsx(u0,{size:18}),"New Client"]})]})]})}),o.jsxs("div",{className:"overflow-x-auto",children:[o.jsxs("table",{className:"w-full",children:[o.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase",children:"Client"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase",children:"Licensed Trades"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase",children:"Status"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase",children:"Trial End"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase",children:"Quotes"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase",children:"Last Active"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase",children:"Actions"})]})}),o.jsx("tbody",{className:"divide-y divide-gray-200",children:v.map(b=>{const S=g(b.trial_end_date);return o.jsxs("tr",{className:"hover:bg-gray-50",children:[o.jsx("td",{className:"px-4 py-3",children:o.jsxs("div",{children:[o.jsx("div",{className:"font-medium text-gray-900",children:b.name}),o.jsx("div",{className:"text-sm text-gray-500",children:b.owner_email||"No owner"})]})}),o.jsxs("td",{className:"px-4 py-3",children:[o.jsx("div",{className:"flex flex-wrap gap-1",children:b.licensed_trades&&b.licensed_trades.length>0?b.licensed_trades.map(k=>{var _;return o.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-medium rounded bg-blue-100 text-blue-800",children:((_=Ex[k])==null?void 0:_.replace(" Verify+",""))||k},k)}):o.jsx("span",{className:"text-xs text-gray-400",children:"No trades"})}),o.jsx("button",{onClick:()=>f(b),className:"text-xs text-blue-600 hover:text-blue-800 mt-1",children:"Manage Licenses"})]}),o.jsx("td",{className:"px-4 py-3",children:o.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded ${w(b.subscription_status)}`,children:b.subscription_status})}),o.jsx("td",{className:"px-4 py-3",children:b.trial_end_date?o.jsxs("div",{children:[o.jsx("div",{className:"text-sm text-gray-900",children:new Date(b.trial_end_date).toLocaleDateString()}),S!==null&&o.jsx("div",{className:`text-xs ${S<0?"text-red-600":S<3?"text-orange-600":"text-gray-500"}`,children:S<0?`${Math.abs(S)} days ago`:`${S} days left`})]}):o.jsx("span",{className:"text-sm text-gray-400",children:"N/A"})}),o.jsx("td",{className:"px-4 py-3",children:o.jsx("span",{className:"text-sm font-medium text-gray-900",children:b.quote_count})}),o.jsx("td",{className:"px-4 py-3",children:b.last_active_at?o.jsx("span",{className:"text-sm text-gray-600",children:new Date(b.last_active_at).toLocaleDateString()}):o.jsx("span",{className:"text-sm text-gray-400",children:"Never"})}),o.jsx("td",{className:"px-4 py-3",children:o.jsxs("div",{className:"flex gap-2",children:[o.jsx("button",{onClick:()=>p(b),className:"p-1.5 text-blue-600 hover:bg-blue-50 rounded transition-colors",title:"Enter as Client",children:o.jsx(om,{size:16})}),o.jsx("button",{onClick:()=>m(b.id,30),className:"p-1.5 text-green-600 hover:bg-green-50 rounded transition-colors",title:"Extend Trial +30 days",children:o.jsx(CS,{size:16})}),b.subscription_status==="trial"&&o.jsx("button",{onClick:()=>x(b.id,"active"),className:"p-1.5 text-green-600 hover:bg-green-50 rounded transition-colors",title:"Upgrade to Active",children:o.jsx(si,{size:16})})]})})]},b.id)})})]}),v.length===0&&o.jsx("div",{className:"p-12 text-center text-gray-500",children:"No clients found matching your filters"})]})]}),d&&o.jsx(tW,{organisationId:d.id,organisationName:d.name,currentLicenses:d.licensed_trades||[],subscriptionStatus:d.subscription_status,onClose:()=>f(null),onUpdate:()=>{h(),u({type:"success",text:"Trade licenses updated"})}})]})}function rW(){const[e,t]=j.useState({name:"",selectedTrades:["passive_fire"],trialDays:14,ownerEmail:""}),[r,s]=j.useState(!1),[n,a]=j.useState(null),[i,l]=j.useState(null),c=x=>{const p=x.reduce((g,w)=>{const v=Hs.find(y=>y.value===w);return g+((v==null?void 0:v.price)||0)},0);return x.length===2?p*.85:x.length===3?p*.75:x.length>=4?p*.65:p},u=x=>{if(e.selectedTrades.includes(x)){if(e.selectedTrades.length===1)return;t({...e,selectedTrades:e.selectedTrades.filter(p=>p!==x)})}else t({...e,selectedTrades:[...e.selectedTrades,x]})},d=async x=>{x.preventDefault(),s(!0),l(null);try{const{data:{session:p}}=await se.auth.getSession();if(!(p!=null&&p.user.email))throw new Error("Not authenticated");const{data:g,error:w}=await se.rpc("admin_create_client_organisation",{p_admin_email:p.user.email,p_org_name:e.name,p_trade_type:e.selectedTrades[0],p_trial_days:e.trialDays,p_owner_email:e.ownerEmail});if(w)throw w;const v=g.organisation_id,{error:y}=await se.from("organisations").update({licensed_trades:e.selectedTrades}).eq("id",v);if(y)throw y;a({organisationId:v,message:g.message})}catch(p){console.error("Failed to create organisation:",p),l(p instanceof Error?p.message:"Failed to create client")}finally{s(!1)}},f=c(e.selectedTrades),h=e.selectedTrades.reduce((x,p)=>{const g=Hs.find(w=>w.value===p);return x+((g==null?void 0:g.price)||0)},0),m=h-f;return n?o.jsxs("div",{className:"space-y-6",children:[o.jsx(ua,{title:"Client Created Successfully",subtitle:"The new client organisation is ready"}),o.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-8 max-w-2xl mx-auto",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"mx-auto w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mb-4",children:o.jsx(tr,{size:32,className:"text-green-600"})}),o.jsxs("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:[e.name," Created!"]}),o.jsx("p",{className:"text-gray-600 mb-6",children:n.message}),o.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 text-left space-y-2 mb-6",children:[o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-gray-600",children:"Organisation ID:"}),o.jsx("span",{className:"font-mono text-sm text-gray-900",children:n.organisationId})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-gray-600",children:"Owner Email:"}),o.jsx("span",{className:"font-medium text-gray-900",children:e.ownerEmail})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-gray-600",children:"Licensed Trades:"}),o.jsx("div",{className:"flex flex-wrap gap-1 justify-end",children:e.selectedTrades.map(x=>{var p;return o.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs font-medium rounded",children:(p=Ex[x])==null?void 0:p.replace(" Verify+","")},x)})})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-gray-600",children:"Monthly Revenue:"}),o.jsxs("span",{className:"text-lg font-bold text-green-600",children:["$",f.toFixed(0)]})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-gray-600",children:"Trial Length:"}),o.jsxs("span",{className:"font-medium text-gray-900",children:[e.trialDays," days"]})]})]}),o.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 text-left mb-6",children:[o.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"Next Steps:"}),o.jsxs("ol",{className:"list-decimal list-inside space-y-1 text-sm text-blue-800",children:[o.jsxs("li",{children:["Owner must sign up at the app using: ",o.jsx("strong",{children:e.ownerEmail})]}),o.jsx("li",{children:"They'll be automatically added to this organisation"}),o.jsxs("li",{children:["During trial: All ",e.selectedTrades.length," trades are accessible"]}),o.jsxs("li",{children:["After trial: Pay $",f.toFixed(0),"/month to keep licenses active"]})]})]}),o.jsxs("div",{className:"flex gap-3",children:[o.jsx("button",{onClick:()=>window.location.href="/admin/dashboard",className:"flex-1 px-6 py-3 bg-blue-600 text-white rounded-md hover:bg-blue-700 font-medium",children:"Back to Dashboard"}),o.jsx("button",{onClick:()=>{a(null),t({name:"",selectedTrades:["passive_fire"],trialDays:14,ownerEmail:""})},className:"flex-1 px-6 py-3 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 font-medium",children:"Create Another Client"})]})]})})]}):o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsx("button",{onClick:()=>window.location.href="/admin/dashboard",className:"p-2 text-gray-600 hover:bg-gray-100 rounded transition-colors",children:o.jsx(Po,{size:20})}),o.jsx(ua,{title:"Create New Client",subtitle:"Set up a new organisation with multi-trade licensing in under 15 seconds"})]}),i&&o.jsx("div",{className:"bg-red-50 border border-red-200 text-red-800 rounded-lg p-4",children:i}),o.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 max-w-3xl",children:o.jsxs("form",{onSubmit:d,className:"space-y-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Company Name *"}),o.jsx("input",{type:"text",required:!0,value:e.name,onChange:x=>t({...e,name:x.target.value}),placeholder:"e.g., Acme Fire Protection Ltd",className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:["Licensed Trades * ",o.jsx("span",{className:"text-gray-500 font-normal",children:"(select all that apply)"})]}),o.jsx("div",{className:"grid grid-cols-2 gap-3",children:Hs.map(x=>{const p=e.selectedTrades.includes(x.value);return o.jsxs("button",{type:"button",onClick:()=>u(x.value),disabled:p&&e.selectedTrades.length===1,className:`p-4 border-2 rounded-lg text-left transition-all ${p?"border-blue-500 bg-blue-50 ring-2 ring-blue-200":"border-gray-200 hover:border-blue-300"} ${p&&e.selectedTrades.length===1?"opacity-50 cursor-not-allowed":""}`,children:[o.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[o.jsx("div",{className:`w-4 h-4 rounded-full ${x.color==="orange"?"bg-orange-500":x.color==="yellow"?"bg-yellow-500":x.color==="blue"?"bg-blue-500":"bg-green-500"}`}),o.jsx("div",{className:"font-medium text-gray-900",children:x.label}),p&&o.jsx(tr,{size:16,className:"ml-auto text-blue-600"})]}),o.jsxs("div",{className:"text-sm text-gray-600",children:["$",x.price,"/month"]})]},x.value)})}),o.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"Client can access all selected trades during trial. After trial, they pay for what they keep."})]}),o.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-green-100 border border-green-200 rounded-lg p-5",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[o.jsx(FS,{className:"text-green-600",size:24}),o.jsx("h3",{className:"font-bold text-green-900",children:"Revenue Calculator"})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex justify-between text-sm",children:[o.jsxs("span",{className:"text-green-800",children:["Base Price (",e.selectedTrades.length," trades):"]}),o.jsxs("span",{className:"font-medium text-green-900",children:["$",h,"/month"]})]}),e.selectedTrades.length>=2&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex justify-between text-sm",children:[o.jsxs("span",{className:"text-green-800",children:["Bundle Discount (",e.selectedTrades.length===2&&"15%",e.selectedTrades.length===3&&"25%",e.selectedTrades.length>=4&&"35%","):"]}),o.jsxs("span",{className:"font-medium text-green-600",children:["-$",m.toFixed(0)]})]}),o.jsx("div",{className:"h-px bg-green-300 my-2"})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"font-bold text-green-900",children:"Monthly Revenue:"}),o.jsxs("span",{className:"text-2xl font-bold text-green-900",children:["$",f.toFixed(0)]})]}),o.jsxs("div",{className:"text-xs text-green-700 mt-2",children:[e.selectedTrades.length===1&&"Select another trade for 15% bundle discount",e.selectedTrades.length===2&&"Select one more trade for 25% bundle discount (10% more savings)",e.selectedTrades.length===3&&"Select all trades for 35% bundle discount",e.selectedTrades.length>=4&&"Maximum bundle discount applied!"]})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Trial Length *"}),o.jsx("div",{className:"grid grid-cols-4 gap-2",children:[7,14,30,60].map(x=>o.jsxs("button",{type:"button",onClick:()=>t({...e,trialDays:x}),className:`px-4 py-2 rounded-md font-medium transition-colors ${e.trialDays===x?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[x," days"]},x))})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Owner Email *"}),o.jsx("input",{type:"email",required:!0,value:e.ownerEmail,onChange:x=>t({...e,ownerEmail:x.target.value}),placeholder:"owner@company.com",className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),o.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"They'll need to sign up with this email to access the organisation"})]}),o.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[o.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"What happens next:"}),o.jsxs("ul",{className:"list-disc list-inside space-y-1 text-sm text-blue-800",children:[o.jsxs("li",{children:["Organisation created with ",e.selectedTrades.length," licensed trade",e.selectedTrades.length>1?"s":""]}),o.jsx("li",{children:"Default project set up for primary trade"}),o.jsxs("li",{children:["Owner can sign up and access all ",e.selectedTrades.length," trades during trial"]}),o.jsxs("li",{children:["After trial: $",f.toFixed(0),"/month to keep licenses active"]})]})]}),o.jsxs("div",{className:"flex gap-3 pt-4",children:[o.jsx("button",{type:"button",onClick:()=>window.location.href="/admin/dashboard",className:"flex-1 px-6 py-3 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 font-medium",children:"Cancel"}),o.jsx("button",{type:"submit",disabled:r,className:"flex-1 px-6 py-3 bg-green-600 text-white rounded-md hover:bg-green-700 font-medium disabled:bg-gray-400 disabled:cursor-not-allowed",children:r?"Creating...":`Create Client ($${f.toFixed(0)}/mo)`})]})]})})]})}function sW(){const[e,t]=j.useState([]),[r,s]=j.useState(!0),[n,a]=j.useState(""),[i,l]=j.useState("all"),[c,u]=j.useState("all"),[d,f]=j.useState([]);j.useEffect(()=>{h()},[]);const h=async()=>{s(!0);try{const[g,w]=await Promise.all([hR(),se.from("organisations").select("id, name").order("name")]);t(g),f(w.data||[])}catch(g){console.error("Failed to load data:",g)}finally{s(!1)}},m=async g=>{try{const w=g.supplier_name?`${g.organisation_id}/${g.supplier_name.replace(/\s+/g,"_")}_${g.quote_id}.pdf`:`${g.organisation_id}/quote_${g.quote_id}.pdf`,{data:v,error:y}=await se.storage.from("quotes").createSignedUrl(w,3600);if(y)throw y;v!=null&&v.signedUrl&&window.open(v.signedUrl,"_blank")}catch(w){console.error("Failed to download:",w),alert("Failed to download PDF. It may have been deleted or moved.")}},x=e.filter(g=>!(n&&!g.supplier_name.toLowerCase().includes(n.toLowerCase())&&!g.organisation_name.toLowerCase().includes(n.toLowerCase())||i!=="all"&&g.trade_type!==i||c!=="all"&&g.organisation_id!==c)),p={total:e.length,totalSize:e.reduce((g,w)=>g+(w.items_count||0),0),avgConfidence:e.length>0?(e.reduce((g,w)=>g+(w.avg_confidence||0),0)/e.length*100).toFixed(1):"0"};return r?o.jsx("div",{className:"flex items-center justify-center h-64",children:o.jsx("div",{className:"text-gray-500",children:"Loading PDF vault..."})}):o.jsxs("div",{className:"space-y-6",children:[o.jsx(ua,{title:"Global PDF Vault",subtitle:"Every PDF ever uploaded by any client, searchable and downloadable"}),o.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[o.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(Yr,{className:"text-gray-600",size:24}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm text-gray-600",children:"Total PDFs"}),o.jsx("div",{className:"text-2xl font-bold text-gray-900",children:p.total})]})]})}),o.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(Yr,{className:"text-gray-600",size:24}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm text-gray-600",children:"Total Line Items"}),o.jsx("div",{className:"text-2xl font-bold text-gray-900",children:p.totalSize.toLocaleString()})]})]})}),o.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(Yr,{className:"text-gray-600",size:24}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm text-gray-600",children:"Avg Confidence"}),o.jsxs("div",{className:"text-2xl font-bold text-gray-900",children:[p.avgConfidence,"%"]})]})]})})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[o.jsx("div",{className:"p-4 border-b border-gray-200",children:o.jsxs("div",{className:"flex gap-3",children:[o.jsxs("div",{className:"flex-1 relative",children:[o.jsx(kd,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:18}),o.jsx("input",{type:"text",placeholder:"Search by supplier or organisation...",value:n,onChange:g=>a(g.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),o.jsxs("select",{value:i,onChange:g=>l(g.target.value),className:"px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"all",children:"All Trades"}),o.jsx("option",{value:"passive_fire",children:"PassiveFire"}),o.jsx("option",{value:"electrical",children:"Electrical"}),o.jsx("option",{value:"plumbing",children:"Plumbing"}),o.jsx("option",{value:"mechanical",children:"Mechanical"})]}),o.jsxs("select",{value:c,onChange:g=>u(g.target.value),className:"px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"all",children:"All Organisations"}),d.map(g=>o.jsx("option",{value:g.id,children:g.name},g.id))]})]})}),o.jsxs("div",{className:"overflow-x-auto",children:[o.jsxs("table",{className:"w-full",children:[o.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase",children:"Supplier"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase",children:"Organisation"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase",children:"Project"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase",children:"Items"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase",children:"Total"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase",children:"Confidence"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase",children:"Uploaded"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase",children:"Actions"})]})}),o.jsx("tbody",{className:"divide-y divide-gray-200",children:x.map(g=>o.jsxs("tr",{className:"hover:bg-gray-50",children:[o.jsx("td",{className:"px-4 py-3",children:o.jsxs("div",{children:[o.jsx("div",{className:"font-medium text-gray-900",children:g.supplier_name}),g.quote_reference&&o.jsx("div",{className:"text-sm text-gray-500",children:g.quote_reference})]})}),o.jsxs("td",{className:"px-4 py-3",children:[o.jsx("div",{className:"text-sm text-gray-900",children:g.organisation_name}),o.jsxs("div",{className:"text-xs text-gray-500",children:[g.trade_type==="passive_fire"&&"PassiveFire",g.trade_type==="electrical"&&"Electrical",g.trade_type==="plumbing"&&"Plumbing"]})]}),o.jsx("td",{className:"px-4 py-3",children:o.jsx("div",{className:"text-sm text-gray-700",children:g.project_name})}),o.jsx("td",{className:"px-4 py-3",children:o.jsx("span",{className:"text-sm font-medium text-gray-900",children:g.items_count})}),o.jsx("td",{className:"px-4 py-3",children:o.jsxs("span",{className:"text-sm font-medium text-gray-900",children:["$",g.total_amount.toLocaleString()]})}),o.jsx("td",{className:"px-4 py-3",children:g.avg_confidence?o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-2 w-16",children:o.jsx("div",{className:`h-2 rounded-full ${g.avg_confidence<.5?"bg-red-600":g.avg_confidence<.75?"bg-yellow-600":"bg-green-600"}`,style:{width:`${g.avg_confidence*100}%`}})}),o.jsxs("span",{className:"text-xs text-gray-600",children:[(g.avg_confidence*100).toFixed(0),"%"]})]}):o.jsx("span",{className:"text-sm text-gray-400",children:"N/A"})}),o.jsx("td",{className:"px-4 py-3",children:o.jsxs("div",{children:[o.jsx("div",{className:"text-sm text-gray-900",children:new Date(g.created_at).toLocaleDateString()}),o.jsx("div",{className:"text-xs text-gray-500",children:g.uploaded_by_email||"Unknown"})]})}),o.jsx("td",{className:"px-4 py-3",children:o.jsx("div",{className:"flex gap-2",children:o.jsx("button",{onClick:()=>m(g),className:"p-1.5 text-blue-600 hover:bg-blue-50 rounded transition-colors",title:"Download PDF",children:o.jsx(fi,{size:16})})})})]},g.quote_id))})]}),x.length===0&&o.jsx("div",{className:"p-12 text-center text-gray-500",children:"No PDFs found matching your filters"})]})]})]})}function Lw(){const[e,t]=j.useState("dashboard"),[r,s]=j.useState(null),[n,a]=j.useState(""),[i,l]=j.useState(!1);j.useEffect(()=>{c()},[]);const c=async()=>{const{data:{session:f}}=await se.auth.getSession();f!=null&&f.user.email&&(a(f.user.email),l(Uk(f.user.email)))};j.useEffect(()=>{const f=window.location.pathname;if(f==="/admin"||f==="/admin/")t(i?"super-dashboard":"dashboard");else if(f==="/admin/dashboard")t("super-dashboard");else if(f==="/admin/clients/new")t("create-client");else if(f==="/admin/pdfs")t("pdf-vault");else if(f==="/admin/organisations")t("organisations");else if(f==="/admin/organisations/new")t("create-organisation");else if(f.startsWith("/admin/organisations/")){const h=f.split("/").pop();h&&(s(h),t("organisation-detail"))}},[i]);const u=async()=>{await se.auth.signOut(),window.location.href="/"},d=()=>{switch(e){case"super-dashboard":return o.jsx(Dw,{});case"create-client":return o.jsx(rW,{});case"pdf-vault":return o.jsx(sW,{});case"dashboard":return o.jsx(Ow,{});case"organisations":return o.jsx(JV,{});case"organisation-detail":return r?o.jsx(ZV,{organisationId:r}):null;case"create-organisation":return o.jsx(eW,{});default:return i?o.jsx(Dw,{}):o.jsx(Ow,{})}};return o.jsxs("div",{className:"min-h-screen bg-slate-50 flex",children:[o.jsxs("div",{className:"w-64 bg-white border-r border-slate-200 flex flex-col",children:[o.jsx("div",{className:"p-6 border-b border-slate-200",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-blue-500 to-blue-600 flex items-center justify-center",children:o.jsx(yo,{className:"text-white",size:20})}),o.jsxs("div",{children:[o.jsx("div",{className:"font-semibold text-slate-900",children:"Admin Console"}),o.jsx("div",{className:"text-xs text-slate-500",children:"Master Admin"})]})]})}),o.jsxs("nav",{className:"flex-1 p-4 space-y-1",children:[i&&o.jsxs(o.Fragment,{children:[o.jsxs("button",{onClick:()=>window.location.href="/admin/dashboard",className:`w-full flex items-center gap-3 px-4 py-2 rounded-lg text-sm font-medium transition ${e==="super-dashboard"?"bg-blue-50 text-blue-700":"text-slate-700 hover:bg-slate-50"}`,children:[o.jsx(OS,{size:18}),"Clients & Trials"]}),o.jsxs("button",{onClick:()=>window.location.href="/admin/pdfs",className:`w-full flex items-center gap-3 px-4 py-2 rounded-lg text-sm font-medium transition ${e==="pdf-vault"?"bg-blue-50 text-blue-700":"text-slate-700 hover:bg-slate-50"}`,children:[o.jsx(Yr,{size:18}),"PDF Vault"]}),o.jsx("div",{className:"h-px bg-slate-200 my-2"})]}),o.jsxs("button",{onClick:()=>window.location.href="/admin",className:`w-full flex items-center gap-3 px-4 py-2 rounded-lg text-sm font-medium transition ${e==="dashboard"?"bg-blue-50 text-blue-700":"text-slate-700 hover:bg-slate-50"}`,children:[o.jsx(cm,{size:18}),"Dashboard"]}),o.jsxs("button",{onClick:()=>window.location.href="/admin/organisations",className:`w-full flex items-center gap-3 px-4 py-2 rounded-lg text-sm font-medium transition ${e==="organisations"||e==="organisation-detail"||e==="create-organisation"?"bg-blue-50 text-blue-700":"text-slate-700 hover:bg-slate-50"}`,children:[o.jsx(yo,{size:18}),"Organisations"]})]}),o.jsxs("div",{className:"p-4 border-t border-slate-200 space-y-2",children:[o.jsxs("button",{onClick:()=>window.location.href="/",className:"w-full flex items-center gap-3 px-4 py-2 rounded-lg text-sm font-medium text-slate-700 hover:bg-slate-50 transition",children:[o.jsx(cm,{size:18}),"Main App"]}),o.jsxs("button",{onClick:u,className:"w-full flex items-center gap-3 px-4 py-2 rounded-lg text-sm font-medium text-rose-600 hover:bg-rose-50 transition",children:[o.jsx(RS,{size:18}),"Logout"]})]})]}),o.jsx("div",{className:"flex-1 overflow-auto",children:d()})]})}const sj=j.createContext(null);function nW({children:e}){const[t,r]=j.useState(!1),[s,n]=j.useState(!0);j.useEffect(()=>{a()},[]);const a=async()=>{try{const{data:{user:i}}=await se.auth.getUser();if(!i){r(!1),n(!1);return}const{data:l}=await se.from("platform_admins").select("is_active").eq("user_id",i.id).eq("is_active",!0).maybeSingle();r(!!l)}catch(i){console.error("Error checking admin status:",i),r(!1)}finally{n(!1)}};return o.jsx(sj.Provider,{value:{isMasterAdmin:t,loading:s},children:e})}function aW(){const e=j.useContext(sj);if(!e)throw new Error("useAdmin must be used within AdminProvider");return e}function iW(){const[e,t]=j.useState(null),[r,s]=j.useState(!0),[n,a]=j.useState("dashboard"),[i,l]=j.useState(null),[c,u]=j.useState(null),[d,f]=j.useState([]),[h,m]=j.useState(!0),[x,p]=j.useState(null),[g,w]=j.useState(!1),[v,y]=j.useState(!1),[b,S]=j.useState(null),{currentOrganisation:k,organisations:_,loading:N,setCurrentOrganisation:C}=wa(),{isMasterAdmin:B,loading:H}=aW();j.useEffect(()=>{const M=setTimeout(()=>{r&&(console.warn("Auth loading timeout - forcing completion"),s(!1))},5e3);se.auth.getSession().then(({data:{session:z}})=>{t(z),s(!1),clearTimeout(M)}).catch(z=>{console.error("Error loading session:",z),s(!1),clearTimeout(M)});const{data:{subscription:O}}=se.auth.onAuthStateChange((z,J)=>{(async()=>t(J))()});return()=>{O.unsubscribe(),clearTimeout(M)}},[]),j.useEffect(()=>{!r&&e&&K()},[r,e]),j.useEffect(()=>{k&&(K(),V())},[k]);const V=async()=>{if(k)try{const{data:M,error:O}=await se.from("organisations").select("licensed_trades, subscription_status").eq("id",k.id).single();!O&&M&&S({licensed_trades:M.licensed_trades||[],subscription_status:M.subscription_status||"trial"})}catch(M){console.error("Failed to load org licensing:",M)}};j.useEffect(()=>{i&&X(i)},[i]),j.useEffect(()=>{d.length===0&&k&&ie()},[k]);const K=async()=>{m(!0),await ie();const M=localStorage.getItem("passivefire_current_project_id");if(M&&k){const{data:O}=await se.from("projects").select("id, name, client, reference").eq("id",M).eq("organisation_id",k.id).maybeSingle();O?(l(O.id),u(O)):(localStorage.removeItem("passivefire_current_project_id"),l(null),u(null))}m(!1)},Y=async M=>{l(M),y(!1),localStorage.setItem("passivefire_current_project_id",M),await se.from("projects").update({last_accessed_at:new Date().toISOString()}).eq("id",M),await X(M)},q=async(M,O,z)=>{if(!k||!(e!=null&&e.user))return p({message:"Must be logged in to create a project",type:"error"}),null;try{const{data:J,error:pe}=await se.from("projects").insert({organisation_id:k.id,name:M,client:O||null,reference:z||null,status:"active",created_by_user_id:e.user.id,user_id:e.user.id}).select().single();if(pe)throw pe;return await ie(),p({message:`Project "${M}" created successfully`,type:"success"}),await Y(J.id),J.id}catch(J){return console.error("Error creating project:",J),p({message:"Failed to create project",type:"error"}),null}},X=async M=>{const{data:O}=await se.from("projects").select("id, name, client, reference").eq("id",M).maybeSingle();O&&u(O)},ie=async()=>{if(!k)return;const{data:M,error:O}=await se.from("projects").select("id, name, client, reference, updated_at, approved_quote_id").eq("organisation_id",k.id).order("updated_at",{ascending:!1});if(O){console.error("Error loading projects:",O);return}if(M){const z=await Promise.all(M.map(async J=>{var T,G,Q,me,fe,oe,ke;const{data:pe}=await se.from("quotes").select("id, status").eq("project_id",J.id),ge=pe&&pe.length>0,ne=pe&&pe.every(we=>we.status==="processed"||we.status==="ready"),{data:ae}=await se.from("quote_items").select("id, system_id, quote_id").in("quote_id",(pe==null?void 0:pe.map(we=>we.id))||[]),Ce=ae&&ae.some(we=>we.system_id),P=ge&&ne&&Ce,{data:ce}=await se.from("award_reports").select("id, generated_at, status, result_json").eq("project_id",J.id).eq("status","ready").order("generated_at",{ascending:!1}).limit(1).maybeSingle(),ue=((Q=(G=(T=ce==null?void 0:ce.result_json)==null?void 0:T.awardSummary)==null?void 0:G.suppliers)==null?void 0:Q.length)||0,Ee=((ke=(oe=(fe=(me=ce==null?void 0:ce.result_json)==null?void 0:me.awardSummary)==null?void 0:fe.suppliers)==null?void 0:oe[0])==null?void 0:ke.coveragePercent)||0;return{id:J.id,name:J.name,client_reference:J.client||J.reference||"No client",updated_at:J.updated_at,has_report:!!ce,report_id:ce==null?void 0:ce.id,report_generated_at:ce==null?void 0:ce.generated_at,report_quotes_count:ue,report_coverage_percent:Math.round(Ee),workflow_complete:P}}));f(z)}},W=M=>i?!0:(p({message:"Select or create a project first.",type:"error"}),!1),U=(M,O)=>{const z=O||i;switch(z&&l(z),M){case"dashboard":a("dashboard");break;case"quotes":a("quotes");break;case"review":a("review");break;case"quoteintel":a("quoteintel");break;case"scope":a("scope");break;case"reports":case"award":a("reports");break;case"contract":case"basetracker":a("contract");break;case"insights":a("insights");break;case"settings":a("settings");break;default:a("dashboard")}},he=()=>{switch(n){case"dashboard":return o.jsx(tn,{projectId:i,projectName:c==null?void 0:c.name,allProjects:d,onProjectSelect:Y,onCreateProject:q,onNavigateToQuotes:()=>{W()&&a("quotes")},onNavigateToMatrix:()=>{W()&&a("scope")},onNavigateToReports:()=>{W()&&a("reports")}});case"quotes":return i?o.jsx(DR,{projectId:i,onQuotesImported:()=>{},onNavigateToDashboard:()=>a("dashboard"),onNavigateToNext:()=>a("review")}):o.jsx(tn,{projectId:null,projectName:void 0,allProjects:d,onProjectSelect:Y,onCreateProject:q,onNavigateToQuotes:()=>{W()&&a("quotes")},onNavigateToMatrix:()=>{W()&&a("scope")},onNavigateToReports:()=>{W()&&a("reports")}});case"review":return i?o.jsx(ZR,{projectId:i,onNavigateBack:()=>a("quotes"),onNavigateNext:()=>a("quoteintel")}):o.jsx(tn,{projectId:null,projectName:void 0,allProjects:d,onProjectSelect:Y,onCreateProject:q,onNavigateToQuotes:()=>{W()&&a("quotes")},onNavigateToMatrix:()=>{W()&&a("scope")},onNavigateToReports:()=>{W()&&a("reports")}});case"quoteintel":return i?o.jsx(fV,{projectId:i,onNavigateBack:()=>a("review"),onNavigateNext:()=>a("scope")}):o.jsx(tn,{projectId:null,projectName:void 0,allProjects:d,onProjectSelect:Y,onCreateProject:q,onNavigateToQuotes:()=>{W()&&a("quotes")},onNavigateToMatrix:()=>{W()&&a("scope")},onNavigateToReports:()=>{W()&&a("reports")}});case"scope":return i?o.jsx(vV,{projectId:i,onNavigateBack:()=>a("quoteintel"),onNavigateNext:()=>a("equalisation")}):o.jsx(tn,{projectId:null,projectName:void 0,allProjects:d,onProjectSelect:Y,onCreateProject:q,onNavigateToQuotes:()=>{W()&&a("quotes")},onNavigateToMatrix:()=>{W()&&a("scope")},onNavigateToReports:()=>{W()&&a("reports")}});case"equalisation":return i?o.jsx(wV,{projectId:i,onNavigateBack:()=>a("scope"),onNavigateNext:()=>a("reports")}):o.jsx(tn,{projectId:null,projectName:void 0,allProjects:d,onProjectSelect:Y,onCreateProject:q,onNavigateToQuotes:()=>{W()&&a("quotes")},onNavigateToMatrix:()=>{W()&&a("scope")},onNavigateToReports:()=>{W()&&a("reports")}});case"contract":return i?o.jsx(_V,{projectId:i}):o.jsx(tn,{projectId:null,projectName:void 0,allProjects:d,onProjectSelect:Y,onCreateProject:q,onNavigateToQuotes:()=>{W()&&a("quotes")},onNavigateToMatrix:()=>{W()&&a("scope")},onNavigateToReports:()=>{W()&&a("reports")}});case"reports":return i?v?o.jsx(CV,{projectId:i,projects:d,onNavigateBackToScope:()=>a("scope"),onNavigateBackToDashboard:()=>a("dashboard")}):o.jsx(AV,{projectId:i,projectName:(c==null?void 0:c.name)||"Project",onNavigateToHub:()=>y(!0),onToast:(M,O)=>p({message:M,type:O})}):o.jsx(tn,{projectId:null,projectName:void 0,allProjects:d,onProjectSelect:Y,onCreateProject:q,onNavigateToQuotes:()=>{W()&&a("quotes")},onNavigateToMatrix:()=>{W()&&a("scope")},onNavigateToReports:()=>{W()&&a("reports")}});case"insights":return i?o.jsx(FV,{projectId:i}):o.jsx(tn,{projectId:null,projectName:void 0,allProjects:d,onProjectSelect:Y,onCreateProject:q,onNavigateToQuotes:()=>{W()&&a("quotes")},onNavigateToMatrix:()=>{W()&&a("scope")},onNavigateToReports:()=>{W()&&a("reports")}});case"systemcheck":return o.jsx(tj,{});case"copilotaudit":return o.jsx(rj,{});case"settings":return i?o.jsx(WV,{projectId:i,onProjectDeleted:()=>l(null)}):o.jsxs("div",{className:"p-8",children:[o.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Settings"}),o.jsx("p",{className:"text-gray-600 mb-4",children:"Select a project to configure project-specific settings, or manage organisation settings below."}),o.jsx(YV,{})]});default:return o.jsx(tn,{projectId:i,projectName:c==null?void 0:c.name,allProjects:d,onProjectSelect:Y,onCreateProject:q,onNavigateToQuotes:()=>{W()&&a("quotes")},onNavigateToMatrix:()=>{W()&&a("scope")},onNavigateToReports:()=>{W()&&a("reports")}})}};if(r||N||H)return o.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),o.jsx("p",{className:"text-gray-600",children:"Loading..."})]})});if(!e)return o.jsx(QV,{});if(window.location.pathname.startsWith("/admin"))return B?o.jsx(Lw,{}):(Mm.show({type:"warning",title:"Access denied",body:"The Admin Console is only accessible to platform administrators.",duration:5e3}),setTimeout(()=>{window.location.href="/"},1e3),null);if(!k&&_.length>0)return o.jsx(Iw,{onOrganisationSelected:()=>{}});if(!k)return B?o.jsx(Lw,{}):o.jsx(Iw,{onOrganisationSelected:()=>{}});if(h)return o.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),o.jsx("p",{className:"text-gray-600",children:"Loading..."})]})});const be=yR(),R=be?k:null;return o.jsxs("div",{className:"min-h-screen bg-gray-50 flex overflow-x-hidden",children:[o.jsx(NR,{activeTab:n,onTabChange:M=>{y(!1),a(M)},projectId:i}),o.jsxs("div",{className:"flex-1 flex flex-col max-w-full overflow-x-hidden",children:[be&&R&&o.jsxs("div",{className:"bg-red-600 text-white px-6 py-3 flex items-center justify-between shadow-lg",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(_n,{size:20}),o.jsxs("div",{children:[o.jsx("div",{className:"font-bold",children:"ADMIN MODE - Impersonating Client"}),o.jsxs("div",{className:"text-sm text-red-100",children:["Viewing as: ",R.name]})]})]}),o.jsxs("button",{onClick:()=>gR(),className:"flex items-center gap-2 px-4 py-2 bg-red-700 hover:bg-red-800 rounded-md font-medium transition-colors",children:[o.jsx(ps,{size:16}),"Exit Admin Mode"]})]}),!be&&b&&b.licensed_trades&&o.jsx(_R,{currentTrades:b.licensed_trades,subscriptionStatus:b.subscription_status}),o.jsx(ER,{currentProjectId:i||void 0,currentProjectName:c==null?void 0:c.name,onProjectChange:Y,onBackToDashboard:()=>{l(null),u(null),a("dashboard")},notificationCount:0,onNavigateToAccount:()=>a("settings"),onNavigateToBilling:()=>a("settings"),onSwitchOrganisation:()=>{C(null),l(null),u(null),f([]),a("dashboard")}}),o.jsx("main",{className:"flex-1 overflow-auto",children:he()}),o.jsx(KV,{})]}),o.jsx(nx,{children:x&&o.jsx(qV,{message:x.message,type:x.type,onClose:()=>p(null)})}),o.jsx(GV,{}),o.jsx("button",{onClick:()=>w(!0),className:"fixed bottom-6 right-6 w-14 h-14 bg-gradient-to-r from-purple-600 to-blue-600 text-white rounded-full shadow-lg hover:shadow-xl transition-all duration-200 flex items-center justify-center z-40 hover:scale-110",title:"Ask AI Copilot",children:o.jsx(d0,{size:24})}),o.jsx(XV,{isOpen:g,onClose:()=>w(!1),currentProjectId:i||void 0,allProjects:d.map(M=>({id:M.id,name:M.name})),onNavigate:U})]})}function oW(){return o.jsx(nW,{children:o.jsx(SR,{children:o.jsx(iW,{})})})}class lW extends j.Component{constructor(t){super(t),this.state={hasError:!1,error:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,r){console.error("Error caught by boundary:",t,r)}render(){var t,r;return this.state.hasError?o.jsxs("div",{style:{padding:"40px",fontFamily:"system-ui, -apple-system, sans-serif",maxWidth:"800px",margin:"0 auto"},children:[o.jsx("h1",{style:{color:"#dc2626",marginBottom:"16px"},children:"Application Error"}),o.jsx("div",{style:{background:"#fee2e2",border:"1px solid #fecaca",borderRadius:"8px",padding:"16px",marginBottom:"16px"},children:o.jsx("p",{style:{margin:0,fontFamily:"monospace",fontSize:"14px"},children:((t=this.state.error)==null?void 0:t.message)||"Unknown error"})}),o.jsxs("details",{style:{marginTop:"16px"},children:[o.jsx("summary",{style:{cursor:"pointer",marginBottom:"8px"},children:"Stack Trace"}),o.jsx("pre",{style:{background:"#f3f4f6",padding:"12px",borderRadius:"4px",overflow:"auto",fontSize:"12px"},children:(r=this.state.error)==null?void 0:r.stack})]}),o.jsx("button",{onClick:()=>window.location.reload(),style:{marginTop:"24px",padding:"8px 16px",background:"#3b82f6",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"14px"},children:"Reload Page"})]}):this.props.children}}Hf.createRoot(document.getElementById("root")).render(o.jsx(kj.StrictMode,{children:o.jsx(lW,{children:o.jsx(oW,{})})}));
