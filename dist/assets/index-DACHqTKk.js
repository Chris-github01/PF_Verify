var tE=Object.defineProperty;var rE=(e,t,r)=>t in e?tE(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var A0=(e,t,r)=>rE(e,typeof t!="symbol"?t+"":t,r);function sE(e,t){for(var r=0;r<t.length;r++){const s=t[r];if(typeof s!="string"&&!Array.isArray(s)){for(const n in s)if(n!=="default"&&!(n in e)){const a=Object.getOwnPropertyDescriptor(s,n);a&&Object.defineProperty(e,n,a.get?a:{enumerable:!0,get:()=>s[n]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function r(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(n){if(n.ep)return;n.ep=!0;const a=r(n);fetch(n.href,a)}})();function nE(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function aE(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function s(){return this instanceof s?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(s){var n=Object.getOwnPropertyDescriptor(e,s);Object.defineProperty(r,s,n.get?n:{enumerable:!0,get:function(){return e[s]}})}),r}var Lw={exports:{}},Hd={},Mw={exports:{}},Ye={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wc=Symbol.for("react.element"),iE=Symbol.for("react.portal"),oE=Symbol.for("react.fragment"),lE=Symbol.for("react.strict_mode"),cE=Symbol.for("react.profiler"),uE=Symbol.for("react.provider"),dE=Symbol.for("react.context"),fE=Symbol.for("react.forward_ref"),hE=Symbol.for("react.suspense"),mE=Symbol.for("react.memo"),pE=Symbol.for("react.lazy"),gg=Symbol.iterator;function xE(e){return e===null||typeof e!="object"?null:(e=gg&&e[gg]||e["@@iterator"],typeof e=="function"?e:null)}var Bw={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Uw=Object.assign,$w={};function jo(e,t,r){this.props=e,this.context=t,this.refs=$w,this.updater=r||Bw}jo.prototype.isReactComponent={};jo.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};jo.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function zw(){}zw.prototype=jo.prototype;function Dm(e,t,r){this.props=e,this.context=t,this.refs=$w,this.updater=r||Bw}var Lm=Dm.prototype=new zw;Lm.constructor=Dm;Uw(Lm,jo.prototype);Lm.isPureReactComponent=!0;var vg=Array.isArray,Vw=Object.prototype.hasOwnProperty,Mm={current:null},Ww={key:!0,ref:!0,__self:!0,__source:!0};function Hw(e,t,r){var s,n={},a=null,i=null;if(t!=null)for(s in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(a=""+t.key),t)Vw.call(t,s)&&!Ww.hasOwnProperty(s)&&(n[s]=t[s]);var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];n.children=c}if(e&&e.defaultProps)for(s in l=e.defaultProps,l)n[s]===void 0&&(n[s]=l[s]);return{$$typeof:wc,type:e,key:a,ref:i,props:n,_owner:Mm.current}}function gE(e,t){return{$$typeof:wc,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Bm(e){return typeof e=="object"&&e!==null&&e.$$typeof===wc}function vE(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var yg=/\/+/g;function F0(e,t){return typeof e=="object"&&e!==null&&e.key!=null?vE(""+e.key):t.toString(36)}function Fu(e,t,r,s,n){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(a){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case wc:case iE:i=!0}}if(i)return i=e,n=n(i),e=s===""?"."+F0(i,0):s,vg(n)?(r="",e!=null&&(r=e.replace(yg,"$&/")+"/"),Fu(n,t,r,"",function(u){return u})):n!=null&&(Bm(n)&&(n=gE(n,r+(!n.key||i&&i.key===n.key?"":(""+n.key).replace(yg,"$&/")+"/")+e)),t.push(n)),1;if(i=0,s=s===""?".":s+":",vg(e))for(var l=0;l<e.length;l++){a=e[l];var c=s+F0(a,l);i+=Fu(a,t,r,c,n)}else if(c=xE(e),typeof c=="function")for(e=c.call(e),l=0;!(a=e.next()).done;)a=a.value,c=s+F0(a,l++),i+=Fu(a,t,r,c,n);else if(a==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function Wc(e,t,r){if(e==null)return e;var s=[],n=0;return Fu(e,s,"","",function(a){return t.call(r,a,n++)}),s}function yE(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Br={current:null},Pu={transition:null},wE={ReactCurrentDispatcher:Br,ReactCurrentBatchConfig:Pu,ReactCurrentOwner:Mm};function qw(){throw Error("act(...) is not supported in production builds of React.")}Ye.Children={map:Wc,forEach:function(e,t,r){Wc(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Wc(e,function(){t++}),t},toArray:function(e){return Wc(e,function(t){return t})||[]},only:function(e){if(!Bm(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ye.Component=jo;Ye.Fragment=oE;Ye.Profiler=cE;Ye.PureComponent=Dm;Ye.StrictMode=lE;Ye.Suspense=hE;Ye.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=wE;Ye.act=qw;Ye.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var s=Uw({},e.props),n=e.key,a=e.ref,i=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,i=Mm.current),t.key!==void 0&&(n=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)Vw.call(t,c)&&!Ww.hasOwnProperty(c)&&(s[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)s.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];s.children=l}return{$$typeof:wc,type:e.type,key:n,ref:a,props:s,_owner:i}};Ye.createContext=function(e){return e={$$typeof:dE,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:uE,_context:e},e.Consumer=e};Ye.createElement=Hw;Ye.createFactory=function(e){var t=Hw.bind(null,e);return t.type=e,t};Ye.createRef=function(){return{current:null}};Ye.forwardRef=function(e){return{$$typeof:fE,render:e}};Ye.isValidElement=Bm;Ye.lazy=function(e){return{$$typeof:pE,_payload:{_status:-1,_result:e},_init:yE}};Ye.memo=function(e,t){return{$$typeof:mE,type:e,compare:t===void 0?null:t}};Ye.startTransition=function(e){var t=Pu.transition;Pu.transition={};try{e()}finally{Pu.transition=t}};Ye.unstable_act=qw;Ye.useCallback=function(e,t){return Br.current.useCallback(e,t)};Ye.useContext=function(e){return Br.current.useContext(e)};Ye.useDebugValue=function(){};Ye.useDeferredValue=function(e){return Br.current.useDeferredValue(e)};Ye.useEffect=function(e,t){return Br.current.useEffect(e,t)};Ye.useId=function(){return Br.current.useId()};Ye.useImperativeHandle=function(e,t,r){return Br.current.useImperativeHandle(e,t,r)};Ye.useInsertionEffect=function(e,t){return Br.current.useInsertionEffect(e,t)};Ye.useLayoutEffect=function(e,t){return Br.current.useLayoutEffect(e,t)};Ye.useMemo=function(e,t){return Br.current.useMemo(e,t)};Ye.useReducer=function(e,t,r){return Br.current.useReducer(e,t,r)};Ye.useRef=function(e){return Br.current.useRef(e)};Ye.useState=function(e){return Br.current.useState(e)};Ye.useSyncExternalStore=function(e,t,r){return Br.current.useSyncExternalStore(e,t,r)};Ye.useTransition=function(){return Br.current.useTransition()};Ye.version="18.3.1";Mw.exports=Ye;var T=Mw.exports;const bE=nE(T);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _E=T,SE=Symbol.for("react.element"),kE=Symbol.for("react.fragment"),NE=Object.prototype.hasOwnProperty,jE=_E.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,EE={key:!0,ref:!0,__self:!0,__source:!0};function Gw(e,t,r){var s,n={},a=null,i=null;r!==void 0&&(a=""+r),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(i=t.ref);for(s in t)NE.call(t,s)&&!EE.hasOwnProperty(s)&&(n[s]=t[s]);if(e&&e.defaultProps)for(s in t=e.defaultProps,t)n[s]===void 0&&(n[s]=t[s]);return{$$typeof:SE,type:e,key:a,ref:i,props:n,_owner:jE.current}}Hd.Fragment=kE;Hd.jsx=Gw;Hd.jsxs=Gw;Lw.exports=Hd;var o=Lw.exports,qf={},Kw={exports:{}},hs={},Xw={exports:{}},Yw={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(K,V){var fe=K.length;K.push(V);e:for(;0<fe;){var ve=fe-1>>>1,P=K[ve];if(0<n(P,V))K[ve]=V,K[fe]=P,fe=ve;else break e}}function r(K){return K.length===0?null:K[0]}function s(K){if(K.length===0)return null;var V=K[0],fe=K.pop();if(fe!==V){K[0]=fe;e:for(var ve=0,P=K.length,M=P>>>1;ve<M;){var D=2*(ve+1)-1,B=K[D],Y=D+1,he=K[Y];if(0>n(B,fe))Y<P&&0>n(he,B)?(K[ve]=he,K[Y]=fe,ve=Y):(K[ve]=B,K[D]=fe,ve=D);else if(Y<P&&0>n(he,fe))K[ve]=he,K[Y]=fe,ve=Y;else break e}}return V}function n(K,V){var fe=K.sortIndex-V.sortIndex;return fe!==0?fe:K.id-V.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var i=Date,l=i.now();e.unstable_now=function(){return i.now()-l}}var c=[],u=[],d=1,f=null,h=3,p=!1,m=!1,x=!1,g=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(K){for(var V=r(u);V!==null;){if(V.callback===null)s(u);else if(V.startTime<=K)s(u),V.sortIndex=V.expirationTime,t(c,V);else break;V=r(u)}}function b(K){if(x=!1,v(K),!m)if(r(c)!==null)m=!0,L(_);else{var V=r(u);V!==null&&X(b,V.startTime-K)}}function _(K,V){m=!1,x&&(x=!1,y(E),E=-1),p=!0;var fe=h;try{for(v(V),f=r(c);f!==null&&(!(f.expirationTime>V)||K&&!H());){var ve=f.callback;if(typeof ve=="function"){f.callback=null,h=f.priorityLevel;var P=ve(f.expirationTime<=V);V=e.unstable_now(),typeof P=="function"?f.callback=P:f===r(c)&&s(c),v(V)}else s(c);f=r(c)}if(f!==null)var M=!0;else{var D=r(u);D!==null&&X(b,D.startTime-V),M=!1}return M}finally{f=null,h=fe,p=!1}}var k=!1,S=null,E=-1,C=5,U=-1;function H(){return!(e.unstable_now()-U<C)}function W(){if(S!==null){var K=e.unstable_now();U=K;var V=!0;try{V=S(!0,K)}finally{V?q():(k=!1,S=null)}}else k=!1}var q;if(typeof w=="function")q=function(){w(W)};else if(typeof MessageChannel<"u"){var z=new MessageChannel,Q=z.port2;z.port1.onmessage=W,q=function(){Q.postMessage(null)}}else q=function(){g(W,0)};function L(K){S=K,k||(k=!0,q())}function X(K,V){E=g(function(){K(e.unstable_now())},V)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(K){K.callback=null},e.unstable_continueExecution=function(){m||p||(m=!0,L(_))},e.unstable_forceFrameRate=function(K){0>K||125<K?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<K?Math.floor(1e3/K):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(K){switch(h){case 1:case 2:case 3:var V=3;break;default:V=h}var fe=h;h=V;try{return K()}finally{h=fe}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(K,V){switch(K){case 1:case 2:case 3:case 4:case 5:break;default:K=3}var fe=h;h=K;try{return V()}finally{h=fe}},e.unstable_scheduleCallback=function(K,V,fe){var ve=e.unstable_now();switch(typeof fe=="object"&&fe!==null?(fe=fe.delay,fe=typeof fe=="number"&&0<fe?ve+fe:ve):fe=ve,K){case 1:var P=-1;break;case 2:P=250;break;case 5:P=1073741823;break;case 4:P=1e4;break;default:P=5e3}return P=fe+P,K={id:d++,callback:V,priorityLevel:K,startTime:fe,expirationTime:P,sortIndex:-1},fe>ve?(K.sortIndex=fe,t(u,K),r(c)===null&&K===r(u)&&(x?(y(E),E=-1):x=!0,X(b,fe-ve))):(K.sortIndex=P,t(c,K),m||p||(m=!0,L(_))),K},e.unstable_shouldYield=H,e.unstable_wrapCallback=function(K){var V=h;return function(){var fe=h;h=V;try{return K.apply(this,arguments)}finally{h=fe}}}})(Yw);Xw.exports=Yw;var TE=Xw.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var CE=T,ds=TE;function we(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Jw=new Set,Rl={};function ui(e,t){lo(e,t),lo(e+"Capture",t)}function lo(e,t){for(Rl[e]=t,e=0;e<t.length;e++)Jw.add(t[e])}var En=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Gf=Object.prototype.hasOwnProperty,AE=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,wg={},bg={};function FE(e){return Gf.call(bg,e)?!0:Gf.call(wg,e)?!1:AE.test(e)?bg[e]=!0:(wg[e]=!0,!1)}function PE(e,t,r,s){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return s?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function RE(e,t,r,s){if(t===null||typeof t>"u"||PE(e,t,r,s))return!0;if(s)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Ur(e,t,r,s,n,a,i){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=s,this.attributeNamespace=n,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=i}var mr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){mr[e]=new Ur(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];mr[t]=new Ur(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){mr[e]=new Ur(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){mr[e]=new Ur(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){mr[e]=new Ur(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){mr[e]=new Ur(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){mr[e]=new Ur(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){mr[e]=new Ur(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){mr[e]=new Ur(e,5,!1,e.toLowerCase(),null,!1,!1)});var Um=/[\-:]([a-z])/g;function $m(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Um,$m);mr[t]=new Ur(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Um,$m);mr[t]=new Ur(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Um,$m);mr[t]=new Ur(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){mr[e]=new Ur(e,1,!1,e.toLowerCase(),null,!1,!1)});mr.xlinkHref=new Ur("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){mr[e]=new Ur(e,1,!1,e.toLowerCase(),null,!0,!0)});function zm(e,t,r,s){var n=mr.hasOwnProperty(t)?mr[t]:null;(n!==null?n.type!==0:s||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(RE(t,r,n,s)&&(r=null),s||n===null?FE(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):n.mustUseProperty?e[n.propertyName]=r===null?n.type===3?!1:"":r:(t=n.attributeName,s=n.attributeNamespace,r===null?e.removeAttribute(t):(n=n.type,r=n===3||n===4&&r===!0?"":""+r,s?e.setAttributeNS(s,t,r):e.setAttribute(t,r))))}var On=CE.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Hc=Symbol.for("react.element"),Fi=Symbol.for("react.portal"),Pi=Symbol.for("react.fragment"),Vm=Symbol.for("react.strict_mode"),Kf=Symbol.for("react.profiler"),Qw=Symbol.for("react.provider"),Zw=Symbol.for("react.context"),Wm=Symbol.for("react.forward_ref"),Xf=Symbol.for("react.suspense"),Yf=Symbol.for("react.suspense_list"),Hm=Symbol.for("react.memo"),Vn=Symbol.for("react.lazy"),e2=Symbol.for("react.offscreen"),_g=Symbol.iterator;function Wo(e){return e===null||typeof e!="object"?null:(e=_g&&e[_g]||e["@@iterator"],typeof e=="function"?e:null)}var Ft=Object.assign,P0;function el(e){if(P0===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);P0=t&&t[1]||""}return`
`+P0+e}var R0=!1;function I0(e,t){if(!e||R0)return"";R0=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var s=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){s=u}e.call(t.prototype)}else{try{throw Error()}catch(u){s=u}e()}}catch(u){if(u&&s&&typeof u.stack=="string"){for(var n=u.stack.split(`
`),a=s.stack.split(`
`),i=n.length-1,l=a.length-1;1<=i&&0<=l&&n[i]!==a[l];)l--;for(;1<=i&&0<=l;i--,l--)if(n[i]!==a[l]){if(i!==1||l!==1)do if(i--,l--,0>l||n[i]!==a[l]){var c=`
`+n[i].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=i&&0<=l);break}}}finally{R0=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?el(e):""}function IE(e){switch(e.tag){case 5:return el(e.type);case 16:return el("Lazy");case 13:return el("Suspense");case 19:return el("SuspenseList");case 0:case 2:case 15:return e=I0(e.type,!1),e;case 11:return e=I0(e.type.render,!1),e;case 1:return e=I0(e.type,!0),e;default:return""}}function Jf(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Pi:return"Fragment";case Fi:return"Portal";case Kf:return"Profiler";case Vm:return"StrictMode";case Xf:return"Suspense";case Yf:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Zw:return(e.displayName||"Context")+".Consumer";case Qw:return(e._context.displayName||"Context")+".Provider";case Wm:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Hm:return t=e.displayName||null,t!==null?t:Jf(e.type)||"Memo";case Vn:t=e._payload,e=e._init;try{return Jf(e(t))}catch{}}return null}function OE(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Jf(t);case 8:return t===Vm?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function ia(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function t2(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function DE(e){var t=t2(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),s=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var n=r.get,a=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return n.call(this)},set:function(i){s=""+i,a.call(this,i)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return s},setValue:function(i){s=""+i},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function qc(e){e._valueTracker||(e._valueTracker=DE(e))}function r2(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),s="";return e&&(s=t2(e)?e.checked?"true":"false":e.value),e=s,e!==r?(t.setValue(e),!0):!1}function Ku(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Qf(e,t){var r=t.checked;return Ft({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function Sg(e,t){var r=t.defaultValue==null?"":t.defaultValue,s=t.checked!=null?t.checked:t.defaultChecked;r=ia(t.value!=null?t.value:r),e._wrapperState={initialChecked:s,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function s2(e,t){t=t.checked,t!=null&&zm(e,"checked",t,!1)}function Zf(e,t){s2(e,t);var r=ia(t.value),s=t.type;if(r!=null)s==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(s==="submit"||s==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?eh(e,t.type,r):t.hasOwnProperty("defaultValue")&&eh(e,t.type,ia(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function kg(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var s=t.type;if(!(s!=="submit"&&s!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function eh(e,t,r){(t!=="number"||Ku(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var tl=Array.isArray;function Yi(e,t,r,s){if(e=e.options,t){t={};for(var n=0;n<r.length;n++)t["$"+r[n]]=!0;for(r=0;r<e.length;r++)n=t.hasOwnProperty("$"+e[r].value),e[r].selected!==n&&(e[r].selected=n),n&&s&&(e[r].defaultSelected=!0)}else{for(r=""+ia(r),t=null,n=0;n<e.length;n++){if(e[n].value===r){e[n].selected=!0,s&&(e[n].defaultSelected=!0);return}t!==null||e[n].disabled||(t=e[n])}t!==null&&(t.selected=!0)}}function th(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(we(91));return Ft({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Ng(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(we(92));if(tl(r)){if(1<r.length)throw Error(we(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:ia(r)}}function n2(e,t){var r=ia(t.value),s=ia(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),s!=null&&(e.defaultValue=""+s)}function jg(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function a2(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function rh(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?a2(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Gc,i2=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,s,n){MSApp.execUnsafeLocalFunction(function(){return e(t,r,s,n)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Gc=Gc||document.createElement("div"),Gc.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Gc.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Il(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var cl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},LE=["Webkit","ms","Moz","O"];Object.keys(cl).forEach(function(e){LE.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),cl[t]=cl[e]})});function o2(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||cl.hasOwnProperty(e)&&cl[e]?(""+t).trim():t+"px"}function l2(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var s=r.indexOf("--")===0,n=o2(r,t[r],s);r==="float"&&(r="cssFloat"),s?e.setProperty(r,n):e[r]=n}}var ME=Ft({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function sh(e,t){if(t){if(ME[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(we(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(we(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(we(61))}if(t.style!=null&&typeof t.style!="object")throw Error(we(62))}}function nh(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ah=null;function qm(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var ih=null,Ji=null,Qi=null;function Eg(e){if(e=Sc(e)){if(typeof ih!="function")throw Error(we(280));var t=e.stateNode;t&&(t=Yd(t),ih(e.stateNode,e.type,t))}}function c2(e){Ji?Qi?Qi.push(e):Qi=[e]:Ji=e}function u2(){if(Ji){var e=Ji,t=Qi;if(Qi=Ji=null,Eg(e),t)for(e=0;e<t.length;e++)Eg(t[e])}}function d2(e,t){return e(t)}function f2(){}var O0=!1;function h2(e,t,r){if(O0)return e(t,r);O0=!0;try{return d2(e,t,r)}finally{O0=!1,(Ji!==null||Qi!==null)&&(f2(),u2())}}function Ol(e,t){var r=e.stateNode;if(r===null)return null;var s=Yd(r);if(s===null)return null;r=s[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(e=e.type,s=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!s;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(we(231,t,typeof r));return r}var oh=!1;if(En)try{var Ho={};Object.defineProperty(Ho,"passive",{get:function(){oh=!0}}),window.addEventListener("test",Ho,Ho),window.removeEventListener("test",Ho,Ho)}catch{oh=!1}function BE(e,t,r,s,n,a,i,l,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(d){this.onError(d)}}var ul=!1,Xu=null,Yu=!1,lh=null,UE={onError:function(e){ul=!0,Xu=e}};function $E(e,t,r,s,n,a,i,l,c){ul=!1,Xu=null,BE.apply(UE,arguments)}function zE(e,t,r,s,n,a,i,l,c){if($E.apply(this,arguments),ul){if(ul){var u=Xu;ul=!1,Xu=null}else throw Error(we(198));Yu||(Yu=!0,lh=u)}}function di(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function m2(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Tg(e){if(di(e)!==e)throw Error(we(188))}function VE(e){var t=e.alternate;if(!t){if(t=di(e),t===null)throw Error(we(188));return t!==e?null:e}for(var r=e,s=t;;){var n=r.return;if(n===null)break;var a=n.alternate;if(a===null){if(s=n.return,s!==null){r=s;continue}break}if(n.child===a.child){for(a=n.child;a;){if(a===r)return Tg(n),e;if(a===s)return Tg(n),t;a=a.sibling}throw Error(we(188))}if(r.return!==s.return)r=n,s=a;else{for(var i=!1,l=n.child;l;){if(l===r){i=!0,r=n,s=a;break}if(l===s){i=!0,s=n,r=a;break}l=l.sibling}if(!i){for(l=a.child;l;){if(l===r){i=!0,r=a,s=n;break}if(l===s){i=!0,s=a,r=n;break}l=l.sibling}if(!i)throw Error(we(189))}}if(r.alternate!==s)throw Error(we(190))}if(r.tag!==3)throw Error(we(188));return r.stateNode.current===r?e:t}function p2(e){return e=VE(e),e!==null?x2(e):null}function x2(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=x2(e);if(t!==null)return t;e=e.sibling}return null}var g2=ds.unstable_scheduleCallback,Cg=ds.unstable_cancelCallback,WE=ds.unstable_shouldYield,HE=ds.unstable_requestPaint,Ut=ds.unstable_now,qE=ds.unstable_getCurrentPriorityLevel,Gm=ds.unstable_ImmediatePriority,v2=ds.unstable_UserBlockingPriority,Ju=ds.unstable_NormalPriority,GE=ds.unstable_LowPriority,y2=ds.unstable_IdlePriority,qd=null,ln=null;function KE(e){if(ln&&typeof ln.onCommitFiberRoot=="function")try{ln.onCommitFiberRoot(qd,e,void 0,(e.current.flags&128)===128)}catch{}}var Xs=Math.clz32?Math.clz32:JE,XE=Math.log,YE=Math.LN2;function JE(e){return e>>>=0,e===0?32:31-(XE(e)/YE|0)|0}var Kc=64,Xc=4194304;function rl(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Qu(e,t){var r=e.pendingLanes;if(r===0)return 0;var s=0,n=e.suspendedLanes,a=e.pingedLanes,i=r&268435455;if(i!==0){var l=i&~n;l!==0?s=rl(l):(a&=i,a!==0&&(s=rl(a)))}else i=r&~n,i!==0?s=rl(i):a!==0&&(s=rl(a));if(s===0)return 0;if(t!==0&&t!==s&&!(t&n)&&(n=s&-s,a=t&-t,n>=a||n===16&&(a&4194240)!==0))return t;if(s&4&&(s|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=s;0<t;)r=31-Xs(t),n=1<<r,s|=e[r],t&=~n;return s}function QE(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ZE(e,t){for(var r=e.suspendedLanes,s=e.pingedLanes,n=e.expirationTimes,a=e.pendingLanes;0<a;){var i=31-Xs(a),l=1<<i,c=n[i];c===-1?(!(l&r)||l&s)&&(n[i]=QE(l,t)):c<=t&&(e.expiredLanes|=l),a&=~l}}function ch(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function w2(){var e=Kc;return Kc<<=1,!(Kc&4194240)&&(Kc=64),e}function D0(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function bc(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Xs(t),e[t]=r}function eT(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var s=e.eventTimes;for(e=e.expirationTimes;0<r;){var n=31-Xs(r),a=1<<n;t[n]=0,s[n]=-1,e[n]=-1,r&=~a}}function Km(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var s=31-Xs(r),n=1<<s;n&t|e[s]&t&&(e[s]|=t),r&=~n}}var lt=0;function b2(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var _2,Xm,S2,k2,N2,uh=!1,Yc=[],Qn=null,Zn=null,ea=null,Dl=new Map,Ll=new Map,Hn=[],tT="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ag(e,t){switch(e){case"focusin":case"focusout":Qn=null;break;case"dragenter":case"dragleave":Zn=null;break;case"mouseover":case"mouseout":ea=null;break;case"pointerover":case"pointerout":Dl.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ll.delete(t.pointerId)}}function qo(e,t,r,s,n,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:r,eventSystemFlags:s,nativeEvent:a,targetContainers:[n]},t!==null&&(t=Sc(t),t!==null&&Xm(t)),e):(e.eventSystemFlags|=s,t=e.targetContainers,n!==null&&t.indexOf(n)===-1&&t.push(n),e)}function rT(e,t,r,s,n){switch(t){case"focusin":return Qn=qo(Qn,e,t,r,s,n),!0;case"dragenter":return Zn=qo(Zn,e,t,r,s,n),!0;case"mouseover":return ea=qo(ea,e,t,r,s,n),!0;case"pointerover":var a=n.pointerId;return Dl.set(a,qo(Dl.get(a)||null,e,t,r,s,n)),!0;case"gotpointercapture":return a=n.pointerId,Ll.set(a,qo(Ll.get(a)||null,e,t,r,s,n)),!0}return!1}function j2(e){var t=Oa(e.target);if(t!==null){var r=di(t);if(r!==null){if(t=r.tag,t===13){if(t=m2(r),t!==null){e.blockedOn=t,N2(e.priority,function(){S2(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Ru(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=dh(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var s=new r.constructor(r.type,r);ah=s,r.target.dispatchEvent(s),ah=null}else return t=Sc(r),t!==null&&Xm(t),e.blockedOn=r,!1;t.shift()}return!0}function Fg(e,t,r){Ru(e)&&r.delete(t)}function sT(){uh=!1,Qn!==null&&Ru(Qn)&&(Qn=null),Zn!==null&&Ru(Zn)&&(Zn=null),ea!==null&&Ru(ea)&&(ea=null),Dl.forEach(Fg),Ll.forEach(Fg)}function Go(e,t){e.blockedOn===t&&(e.blockedOn=null,uh||(uh=!0,ds.unstable_scheduleCallback(ds.unstable_NormalPriority,sT)))}function Ml(e){function t(n){return Go(n,e)}if(0<Yc.length){Go(Yc[0],e);for(var r=1;r<Yc.length;r++){var s=Yc[r];s.blockedOn===e&&(s.blockedOn=null)}}for(Qn!==null&&Go(Qn,e),Zn!==null&&Go(Zn,e),ea!==null&&Go(ea,e),Dl.forEach(t),Ll.forEach(t),r=0;r<Hn.length;r++)s=Hn[r],s.blockedOn===e&&(s.blockedOn=null);for(;0<Hn.length&&(r=Hn[0],r.blockedOn===null);)j2(r),r.blockedOn===null&&Hn.shift()}var Zi=On.ReactCurrentBatchConfig,Zu=!0;function nT(e,t,r,s){var n=lt,a=Zi.transition;Zi.transition=null;try{lt=1,Ym(e,t,r,s)}finally{lt=n,Zi.transition=a}}function aT(e,t,r,s){var n=lt,a=Zi.transition;Zi.transition=null;try{lt=4,Ym(e,t,r,s)}finally{lt=n,Zi.transition=a}}function Ym(e,t,r,s){if(Zu){var n=dh(e,t,r,s);if(n===null)q0(e,t,s,ed,r),Ag(e,s);else if(rT(n,e,t,r,s))s.stopPropagation();else if(Ag(e,s),t&4&&-1<tT.indexOf(e)){for(;n!==null;){var a=Sc(n);if(a!==null&&_2(a),a=dh(e,t,r,s),a===null&&q0(e,t,s,ed,r),a===n)break;n=a}n!==null&&s.stopPropagation()}else q0(e,t,s,null,r)}}var ed=null;function dh(e,t,r,s){if(ed=null,e=qm(s),e=Oa(e),e!==null)if(t=di(e),t===null)e=null;else if(r=t.tag,r===13){if(e=m2(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return ed=e,null}function E2(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(qE()){case Gm:return 1;case v2:return 4;case Ju:case GE:return 16;case y2:return 536870912;default:return 16}default:return 16}}var Kn=null,Jm=null,Iu=null;function T2(){if(Iu)return Iu;var e,t=Jm,r=t.length,s,n="value"in Kn?Kn.value:Kn.textContent,a=n.length;for(e=0;e<r&&t[e]===n[e];e++);var i=r-e;for(s=1;s<=i&&t[r-s]===n[a-s];s++);return Iu=n.slice(e,1<s?1-s:void 0)}function Ou(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Jc(){return!0}function Pg(){return!1}function ms(e){function t(r,s,n,a,i){this._reactName=r,this._targetInst=n,this.type=s,this.nativeEvent=a,this.target=i,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(r=e[l],this[l]=r?r(a):a[l]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?Jc:Pg,this.isPropagationStopped=Pg,this}return Ft(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Jc)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Jc)},persist:function(){},isPersistent:Jc}),t}var Eo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Qm=ms(Eo),_c=Ft({},Eo,{view:0,detail:0}),iT=ms(_c),L0,M0,Ko,Gd=Ft({},_c,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Zm,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ko&&(Ko&&e.type==="mousemove"?(L0=e.screenX-Ko.screenX,M0=e.screenY-Ko.screenY):M0=L0=0,Ko=e),L0)},movementY:function(e){return"movementY"in e?e.movementY:M0}}),Rg=ms(Gd),oT=Ft({},Gd,{dataTransfer:0}),lT=ms(oT),cT=Ft({},_c,{relatedTarget:0}),B0=ms(cT),uT=Ft({},Eo,{animationName:0,elapsedTime:0,pseudoElement:0}),dT=ms(uT),fT=Ft({},Eo,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),hT=ms(fT),mT=Ft({},Eo,{data:0}),Ig=ms(mT),pT={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},xT={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},gT={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function vT(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=gT[e])?!!t[e]:!1}function Zm(){return vT}var yT=Ft({},_c,{key:function(e){if(e.key){var t=pT[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Ou(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?xT[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Zm,charCode:function(e){return e.type==="keypress"?Ou(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Ou(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),wT=ms(yT),bT=Ft({},Gd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Og=ms(bT),_T=Ft({},_c,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Zm}),ST=ms(_T),kT=Ft({},Eo,{propertyName:0,elapsedTime:0,pseudoElement:0}),NT=ms(kT),jT=Ft({},Gd,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),ET=ms(jT),TT=[9,13,27,32],ep=En&&"CompositionEvent"in window,dl=null;En&&"documentMode"in document&&(dl=document.documentMode);var CT=En&&"TextEvent"in window&&!dl,C2=En&&(!ep||dl&&8<dl&&11>=dl),Dg=" ",Lg=!1;function A2(e,t){switch(e){case"keyup":return TT.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function F2(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Ri=!1;function AT(e,t){switch(e){case"compositionend":return F2(t);case"keypress":return t.which!==32?null:(Lg=!0,Dg);case"textInput":return e=t.data,e===Dg&&Lg?null:e;default:return null}}function FT(e,t){if(Ri)return e==="compositionend"||!ep&&A2(e,t)?(e=T2(),Iu=Jm=Kn=null,Ri=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return C2&&t.locale!=="ko"?null:t.data;default:return null}}var PT={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Mg(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!PT[e.type]:t==="textarea"}function P2(e,t,r,s){c2(s),t=td(t,"onChange"),0<t.length&&(r=new Qm("onChange","change",null,r,s),e.push({event:r,listeners:t}))}var fl=null,Bl=null;function RT(e){V2(e,0)}function Kd(e){var t=Di(e);if(r2(t))return e}function IT(e,t){if(e==="change")return t}var R2=!1;if(En){var U0;if(En){var $0="oninput"in document;if(!$0){var Bg=document.createElement("div");Bg.setAttribute("oninput","return;"),$0=typeof Bg.oninput=="function"}U0=$0}else U0=!1;R2=U0&&(!document.documentMode||9<document.documentMode)}function Ug(){fl&&(fl.detachEvent("onpropertychange",I2),Bl=fl=null)}function I2(e){if(e.propertyName==="value"&&Kd(Bl)){var t=[];P2(t,Bl,e,qm(e)),h2(RT,t)}}function OT(e,t,r){e==="focusin"?(Ug(),fl=t,Bl=r,fl.attachEvent("onpropertychange",I2)):e==="focusout"&&Ug()}function DT(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Kd(Bl)}function LT(e,t){if(e==="click")return Kd(t)}function MT(e,t){if(e==="input"||e==="change")return Kd(t)}function BT(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Zs=typeof Object.is=="function"?Object.is:BT;function Ul(e,t){if(Zs(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),s=Object.keys(t);if(r.length!==s.length)return!1;for(s=0;s<r.length;s++){var n=r[s];if(!Gf.call(t,n)||!Zs(e[n],t[n]))return!1}return!0}function $g(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function zg(e,t){var r=$g(e);e=0;for(var s;r;){if(r.nodeType===3){if(s=e+r.textContent.length,e<=t&&s>=t)return{node:r,offset:t-e};e=s}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=$g(r)}}function O2(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?O2(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function D2(){for(var e=window,t=Ku();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Ku(e.document)}return t}function tp(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function UT(e){var t=D2(),r=e.focusedElem,s=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&O2(r.ownerDocument.documentElement,r)){if(s!==null&&tp(r)){if(t=s.start,e=s.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var n=r.textContent.length,a=Math.min(s.start,n);s=s.end===void 0?a:Math.min(s.end,n),!e.extend&&a>s&&(n=s,s=a,a=n),n=zg(r,a);var i=zg(r,s);n&&i&&(e.rangeCount!==1||e.anchorNode!==n.node||e.anchorOffset!==n.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(t=t.createRange(),t.setStart(n.node,n.offset),e.removeAllRanges(),a>s?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var $T=En&&"documentMode"in document&&11>=document.documentMode,Ii=null,fh=null,hl=null,hh=!1;function Vg(e,t,r){var s=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;hh||Ii==null||Ii!==Ku(s)||(s=Ii,"selectionStart"in s&&tp(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),hl&&Ul(hl,s)||(hl=s,s=td(fh,"onSelect"),0<s.length&&(t=new Qm("onSelect","select",null,t,r),e.push({event:t,listeners:s}),t.target=Ii)))}function Qc(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Oi={animationend:Qc("Animation","AnimationEnd"),animationiteration:Qc("Animation","AnimationIteration"),animationstart:Qc("Animation","AnimationStart"),transitionend:Qc("Transition","TransitionEnd")},z0={},L2={};En&&(L2=document.createElement("div").style,"AnimationEvent"in window||(delete Oi.animationend.animation,delete Oi.animationiteration.animation,delete Oi.animationstart.animation),"TransitionEvent"in window||delete Oi.transitionend.transition);function Xd(e){if(z0[e])return z0[e];if(!Oi[e])return e;var t=Oi[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in L2)return z0[e]=t[r];return e}var M2=Xd("animationend"),B2=Xd("animationiteration"),U2=Xd("animationstart"),$2=Xd("transitionend"),z2=new Map,Wg="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ma(e,t){z2.set(e,t),ui(t,[e])}for(var V0=0;V0<Wg.length;V0++){var W0=Wg[V0],zT=W0.toLowerCase(),VT=W0[0].toUpperCase()+W0.slice(1);ma(zT,"on"+VT)}ma(M2,"onAnimationEnd");ma(B2,"onAnimationIteration");ma(U2,"onAnimationStart");ma("dblclick","onDoubleClick");ma("focusin","onFocus");ma("focusout","onBlur");ma($2,"onTransitionEnd");lo("onMouseEnter",["mouseout","mouseover"]);lo("onMouseLeave",["mouseout","mouseover"]);lo("onPointerEnter",["pointerout","pointerover"]);lo("onPointerLeave",["pointerout","pointerover"]);ui("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ui("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ui("onBeforeInput",["compositionend","keypress","textInput","paste"]);ui("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ui("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ui("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var sl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),WT=new Set("cancel close invalid load scroll toggle".split(" ").concat(sl));function Hg(e,t,r){var s=e.type||"unknown-event";e.currentTarget=r,zE(s,t,void 0,e),e.currentTarget=null}function V2(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var s=e[r],n=s.event;s=s.listeners;e:{var a=void 0;if(t)for(var i=s.length-1;0<=i;i--){var l=s[i],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==a&&n.isPropagationStopped())break e;Hg(n,l,u),a=c}else for(i=0;i<s.length;i++){if(l=s[i],c=l.instance,u=l.currentTarget,l=l.listener,c!==a&&n.isPropagationStopped())break e;Hg(n,l,u),a=c}}}if(Yu)throw e=lh,Yu=!1,lh=null,e}function ft(e,t){var r=t[vh];r===void 0&&(r=t[vh]=new Set);var s=e+"__bubble";r.has(s)||(W2(t,e,2,!1),r.add(s))}function H0(e,t,r){var s=0;t&&(s|=4),W2(r,e,s,t)}var Zc="_reactListening"+Math.random().toString(36).slice(2);function $l(e){if(!e[Zc]){e[Zc]=!0,Jw.forEach(function(r){r!=="selectionchange"&&(WT.has(r)||H0(r,!1,e),H0(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Zc]||(t[Zc]=!0,H0("selectionchange",!1,t))}}function W2(e,t,r,s){switch(E2(t)){case 1:var n=nT;break;case 4:n=aT;break;default:n=Ym}r=n.bind(null,t,r,e),n=void 0,!oh||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(n=!0),s?n!==void 0?e.addEventListener(t,r,{capture:!0,passive:n}):e.addEventListener(t,r,!0):n!==void 0?e.addEventListener(t,r,{passive:n}):e.addEventListener(t,r,!1)}function q0(e,t,r,s,n){var a=s;if(!(t&1)&&!(t&2)&&s!==null)e:for(;;){if(s===null)return;var i=s.tag;if(i===3||i===4){var l=s.stateNode.containerInfo;if(l===n||l.nodeType===8&&l.parentNode===n)break;if(i===4)for(i=s.return;i!==null;){var c=i.tag;if((c===3||c===4)&&(c=i.stateNode.containerInfo,c===n||c.nodeType===8&&c.parentNode===n))return;i=i.return}for(;l!==null;){if(i=Oa(l),i===null)return;if(c=i.tag,c===5||c===6){s=a=i;continue e}l=l.parentNode}}s=s.return}h2(function(){var u=a,d=qm(r),f=[];e:{var h=z2.get(e);if(h!==void 0){var p=Qm,m=e;switch(e){case"keypress":if(Ou(r)===0)break e;case"keydown":case"keyup":p=wT;break;case"focusin":m="focus",p=B0;break;case"focusout":m="blur",p=B0;break;case"beforeblur":case"afterblur":p=B0;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=Rg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=lT;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=ST;break;case M2:case B2:case U2:p=dT;break;case $2:p=NT;break;case"scroll":p=iT;break;case"wheel":p=ET;break;case"copy":case"cut":case"paste":p=hT;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=Og}var x=(t&4)!==0,g=!x&&e==="scroll",y=x?h!==null?h+"Capture":null:h;x=[];for(var w=u,v;w!==null;){v=w;var b=v.stateNode;if(v.tag===5&&b!==null&&(v=b,y!==null&&(b=Ol(w,y),b!=null&&x.push(zl(w,b,v)))),g)break;w=w.return}0<x.length&&(h=new p(h,m,null,r,d),f.push({event:h,listeners:x}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",p=e==="mouseout"||e==="pointerout",h&&r!==ah&&(m=r.relatedTarget||r.fromElement)&&(Oa(m)||m[Tn]))break e;if((p||h)&&(h=d.window===d?d:(h=d.ownerDocument)?h.defaultView||h.parentWindow:window,p?(m=r.relatedTarget||r.toElement,p=u,m=m?Oa(m):null,m!==null&&(g=di(m),m!==g||m.tag!==5&&m.tag!==6)&&(m=null)):(p=null,m=u),p!==m)){if(x=Rg,b="onMouseLeave",y="onMouseEnter",w="mouse",(e==="pointerout"||e==="pointerover")&&(x=Og,b="onPointerLeave",y="onPointerEnter",w="pointer"),g=p==null?h:Di(p),v=m==null?h:Di(m),h=new x(b,w+"leave",p,r,d),h.target=g,h.relatedTarget=v,b=null,Oa(d)===u&&(x=new x(y,w+"enter",m,r,d),x.target=v,x.relatedTarget=g,b=x),g=b,p&&m)t:{for(x=p,y=m,w=0,v=x;v;v=yi(v))w++;for(v=0,b=y;b;b=yi(b))v++;for(;0<w-v;)x=yi(x),w--;for(;0<v-w;)y=yi(y),v--;for(;w--;){if(x===y||y!==null&&x===y.alternate)break t;x=yi(x),y=yi(y)}x=null}else x=null;p!==null&&qg(f,h,p,x,!1),m!==null&&g!==null&&qg(f,g,m,x,!0)}}e:{if(h=u?Di(u):window,p=h.nodeName&&h.nodeName.toLowerCase(),p==="select"||p==="input"&&h.type==="file")var _=IT;else if(Mg(h))if(R2)_=MT;else{_=DT;var k=OT}else(p=h.nodeName)&&p.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(_=LT);if(_&&(_=_(e,u))){P2(f,_,r,d);break e}k&&k(e,h,u),e==="focusout"&&(k=h._wrapperState)&&k.controlled&&h.type==="number"&&eh(h,"number",h.value)}switch(k=u?Di(u):window,e){case"focusin":(Mg(k)||k.contentEditable==="true")&&(Ii=k,fh=u,hl=null);break;case"focusout":hl=fh=Ii=null;break;case"mousedown":hh=!0;break;case"contextmenu":case"mouseup":case"dragend":hh=!1,Vg(f,r,d);break;case"selectionchange":if($T)break;case"keydown":case"keyup":Vg(f,r,d)}var S;if(ep)e:{switch(e){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else Ri?A2(e,r)&&(E="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(E="onCompositionStart");E&&(C2&&r.locale!=="ko"&&(Ri||E!=="onCompositionStart"?E==="onCompositionEnd"&&Ri&&(S=T2()):(Kn=d,Jm="value"in Kn?Kn.value:Kn.textContent,Ri=!0)),k=td(u,E),0<k.length&&(E=new Ig(E,e,null,r,d),f.push({event:E,listeners:k}),S?E.data=S:(S=F2(r),S!==null&&(E.data=S)))),(S=CT?AT(e,r):FT(e,r))&&(u=td(u,"onBeforeInput"),0<u.length&&(d=new Ig("onBeforeInput","beforeinput",null,r,d),f.push({event:d,listeners:u}),d.data=S))}V2(f,t)})}function zl(e,t,r){return{instance:e,listener:t,currentTarget:r}}function td(e,t){for(var r=t+"Capture",s=[];e!==null;){var n=e,a=n.stateNode;n.tag===5&&a!==null&&(n=a,a=Ol(e,r),a!=null&&s.unshift(zl(e,a,n)),a=Ol(e,t),a!=null&&s.push(zl(e,a,n))),e=e.return}return s}function yi(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function qg(e,t,r,s,n){for(var a=t._reactName,i=[];r!==null&&r!==s;){var l=r,c=l.alternate,u=l.stateNode;if(c!==null&&c===s)break;l.tag===5&&u!==null&&(l=u,n?(c=Ol(r,a),c!=null&&i.unshift(zl(r,c,l))):n||(c=Ol(r,a),c!=null&&i.push(zl(r,c,l)))),r=r.return}i.length!==0&&e.push({event:t,listeners:i})}var HT=/\r\n?/g,qT=/\u0000|\uFFFD/g;function Gg(e){return(typeof e=="string"?e:""+e).replace(HT,`
`).replace(qT,"")}function eu(e,t,r){if(t=Gg(t),Gg(e)!==t&&r)throw Error(we(425))}function rd(){}var mh=null,ph=null;function xh(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var gh=typeof setTimeout=="function"?setTimeout:void 0,GT=typeof clearTimeout=="function"?clearTimeout:void 0,Kg=typeof Promise=="function"?Promise:void 0,KT=typeof queueMicrotask=="function"?queueMicrotask:typeof Kg<"u"?function(e){return Kg.resolve(null).then(e).catch(XT)}:gh;function XT(e){setTimeout(function(){throw e})}function G0(e,t){var r=t,s=0;do{var n=r.nextSibling;if(e.removeChild(r),n&&n.nodeType===8)if(r=n.data,r==="/$"){if(s===0){e.removeChild(n),Ml(t);return}s--}else r!=="$"&&r!=="$?"&&r!=="$!"||s++;r=n}while(r);Ml(t)}function ta(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Xg(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var To=Math.random().toString(36).slice(2),an="__reactFiber$"+To,Vl="__reactProps$"+To,Tn="__reactContainer$"+To,vh="__reactEvents$"+To,YT="__reactListeners$"+To,JT="__reactHandles$"+To;function Oa(e){var t=e[an];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Tn]||r[an]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=Xg(e);e!==null;){if(r=e[an])return r;e=Xg(e)}return t}e=r,r=e.parentNode}return null}function Sc(e){return e=e[an]||e[Tn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Di(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(we(33))}function Yd(e){return e[Vl]||null}var yh=[],Li=-1;function pa(e){return{current:e}}function pt(e){0>Li||(e.current=yh[Li],yh[Li]=null,Li--)}function dt(e,t){Li++,yh[Li]=e.current,e.current=t}var oa={},Tr=pa(oa),Gr=pa(!1),Qa=oa;function co(e,t){var r=e.type.contextTypes;if(!r)return oa;var s=e.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===t)return s.__reactInternalMemoizedMaskedChildContext;var n={},a;for(a in r)n[a]=t[a];return s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=n),n}function Kr(e){return e=e.childContextTypes,e!=null}function sd(){pt(Gr),pt(Tr)}function Yg(e,t,r){if(Tr.current!==oa)throw Error(we(168));dt(Tr,t),dt(Gr,r)}function H2(e,t,r){var s=e.stateNode;if(t=t.childContextTypes,typeof s.getChildContext!="function")return r;s=s.getChildContext();for(var n in s)if(!(n in t))throw Error(we(108,OE(e)||"Unknown",n));return Ft({},r,s)}function nd(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||oa,Qa=Tr.current,dt(Tr,e),dt(Gr,Gr.current),!0}function Jg(e,t,r){var s=e.stateNode;if(!s)throw Error(we(169));r?(e=H2(e,t,Qa),s.__reactInternalMemoizedMergedChildContext=e,pt(Gr),pt(Tr),dt(Tr,e)):pt(Gr),dt(Gr,r)}var yn=null,Jd=!1,K0=!1;function q2(e){yn===null?yn=[e]:yn.push(e)}function QT(e){Jd=!0,q2(e)}function xa(){if(!K0&&yn!==null){K0=!0;var e=0,t=lt;try{var r=yn;for(lt=1;e<r.length;e++){var s=r[e];do s=s(!0);while(s!==null)}yn=null,Jd=!1}catch(n){throw yn!==null&&(yn=yn.slice(e+1)),g2(Gm,xa),n}finally{lt=t,K0=!1}}return null}var Mi=[],Bi=0,ad=null,id=0,js=[],Es=0,Za=null,wn=1,bn="";function Ea(e,t){Mi[Bi++]=id,Mi[Bi++]=ad,ad=e,id=t}function G2(e,t,r){js[Es++]=wn,js[Es++]=bn,js[Es++]=Za,Za=e;var s=wn;e=bn;var n=32-Xs(s)-1;s&=~(1<<n),r+=1;var a=32-Xs(t)+n;if(30<a){var i=n-n%5;a=(s&(1<<i)-1).toString(32),s>>=i,n-=i,wn=1<<32-Xs(t)+n|r<<n|s,bn=a+e}else wn=1<<a|r<<n|s,bn=e}function rp(e){e.return!==null&&(Ea(e,1),G2(e,1,0))}function sp(e){for(;e===ad;)ad=Mi[--Bi],Mi[Bi]=null,id=Mi[--Bi],Mi[Bi]=null;for(;e===Za;)Za=js[--Es],js[Es]=null,bn=js[--Es],js[Es]=null,wn=js[--Es],js[Es]=null}var us=null,ls=null,yt=!1,Ws=null;function K2(e,t){var r=Ts(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function Qg(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,us=e,ls=ta(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,us=e,ls=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Za!==null?{id:wn,overflow:bn}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Ts(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,us=e,ls=null,!0):!1;default:return!1}}function wh(e){return(e.mode&1)!==0&&(e.flags&128)===0}function bh(e){if(yt){var t=ls;if(t){var r=t;if(!Qg(e,t)){if(wh(e))throw Error(we(418));t=ta(r.nextSibling);var s=us;t&&Qg(e,t)?K2(s,r):(e.flags=e.flags&-4097|2,yt=!1,us=e)}}else{if(wh(e))throw Error(we(418));e.flags=e.flags&-4097|2,yt=!1,us=e}}}function Zg(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;us=e}function tu(e){if(e!==us)return!1;if(!yt)return Zg(e),yt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!xh(e.type,e.memoizedProps)),t&&(t=ls)){if(wh(e))throw X2(),Error(we(418));for(;t;)K2(e,t),t=ta(t.nextSibling)}if(Zg(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(we(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){ls=ta(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}ls=null}}else ls=us?ta(e.stateNode.nextSibling):null;return!0}function X2(){for(var e=ls;e;)e=ta(e.nextSibling)}function uo(){ls=us=null,yt=!1}function np(e){Ws===null?Ws=[e]:Ws.push(e)}var ZT=On.ReactCurrentBatchConfig;function Xo(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(we(309));var s=r.stateNode}if(!s)throw Error(we(147,e));var n=s,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(i){var l=n.refs;i===null?delete l[a]:l[a]=i},t._stringRef=a,t)}if(typeof e!="string")throw Error(we(284));if(!r._owner)throw Error(we(290,e))}return e}function ru(e,t){throw e=Object.prototype.toString.call(t),Error(we(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function ev(e){var t=e._init;return t(e._payload)}function Y2(e){function t(y,w){if(e){var v=y.deletions;v===null?(y.deletions=[w],y.flags|=16):v.push(w)}}function r(y,w){if(!e)return null;for(;w!==null;)t(y,w),w=w.sibling;return null}function s(y,w){for(y=new Map;w!==null;)w.key!==null?y.set(w.key,w):y.set(w.index,w),w=w.sibling;return y}function n(y,w){return y=aa(y,w),y.index=0,y.sibling=null,y}function a(y,w,v){return y.index=v,e?(v=y.alternate,v!==null?(v=v.index,v<w?(y.flags|=2,w):v):(y.flags|=2,w)):(y.flags|=1048576,w)}function i(y){return e&&y.alternate===null&&(y.flags|=2),y}function l(y,w,v,b){return w===null||w.tag!==6?(w=tf(v,y.mode,b),w.return=y,w):(w=n(w,v),w.return=y,w)}function c(y,w,v,b){var _=v.type;return _===Pi?d(y,w,v.props.children,b,v.key):w!==null&&(w.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===Vn&&ev(_)===w.type)?(b=n(w,v.props),b.ref=Xo(y,w,v),b.return=y,b):(b=zu(v.type,v.key,v.props,null,y.mode,b),b.ref=Xo(y,w,v),b.return=y,b)}function u(y,w,v,b){return w===null||w.tag!==4||w.stateNode.containerInfo!==v.containerInfo||w.stateNode.implementation!==v.implementation?(w=rf(v,y.mode,b),w.return=y,w):(w=n(w,v.children||[]),w.return=y,w)}function d(y,w,v,b,_){return w===null||w.tag!==7?(w=Va(v,y.mode,b,_),w.return=y,w):(w=n(w,v),w.return=y,w)}function f(y,w,v){if(typeof w=="string"&&w!==""||typeof w=="number")return w=tf(""+w,y.mode,v),w.return=y,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Hc:return v=zu(w.type,w.key,w.props,null,y.mode,v),v.ref=Xo(y,null,w),v.return=y,v;case Fi:return w=rf(w,y.mode,v),w.return=y,w;case Vn:var b=w._init;return f(y,b(w._payload),v)}if(tl(w)||Wo(w))return w=Va(w,y.mode,v,null),w.return=y,w;ru(y,w)}return null}function h(y,w,v,b){var _=w!==null?w.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return _!==null?null:l(y,w,""+v,b);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Hc:return v.key===_?c(y,w,v,b):null;case Fi:return v.key===_?u(y,w,v,b):null;case Vn:return _=v._init,h(y,w,_(v._payload),b)}if(tl(v)||Wo(v))return _!==null?null:d(y,w,v,b,null);ru(y,v)}return null}function p(y,w,v,b,_){if(typeof b=="string"&&b!==""||typeof b=="number")return y=y.get(v)||null,l(w,y,""+b,_);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Hc:return y=y.get(b.key===null?v:b.key)||null,c(w,y,b,_);case Fi:return y=y.get(b.key===null?v:b.key)||null,u(w,y,b,_);case Vn:var k=b._init;return p(y,w,v,k(b._payload),_)}if(tl(b)||Wo(b))return y=y.get(v)||null,d(w,y,b,_,null);ru(w,b)}return null}function m(y,w,v,b){for(var _=null,k=null,S=w,E=w=0,C=null;S!==null&&E<v.length;E++){S.index>E?(C=S,S=null):C=S.sibling;var U=h(y,S,v[E],b);if(U===null){S===null&&(S=C);break}e&&S&&U.alternate===null&&t(y,S),w=a(U,w,E),k===null?_=U:k.sibling=U,k=U,S=C}if(E===v.length)return r(y,S),yt&&Ea(y,E),_;if(S===null){for(;E<v.length;E++)S=f(y,v[E],b),S!==null&&(w=a(S,w,E),k===null?_=S:k.sibling=S,k=S);return yt&&Ea(y,E),_}for(S=s(y,S);E<v.length;E++)C=p(S,y,E,v[E],b),C!==null&&(e&&C.alternate!==null&&S.delete(C.key===null?E:C.key),w=a(C,w,E),k===null?_=C:k.sibling=C,k=C);return e&&S.forEach(function(H){return t(y,H)}),yt&&Ea(y,E),_}function x(y,w,v,b){var _=Wo(v);if(typeof _!="function")throw Error(we(150));if(v=_.call(v),v==null)throw Error(we(151));for(var k=_=null,S=w,E=w=0,C=null,U=v.next();S!==null&&!U.done;E++,U=v.next()){S.index>E?(C=S,S=null):C=S.sibling;var H=h(y,S,U.value,b);if(H===null){S===null&&(S=C);break}e&&S&&H.alternate===null&&t(y,S),w=a(H,w,E),k===null?_=H:k.sibling=H,k=H,S=C}if(U.done)return r(y,S),yt&&Ea(y,E),_;if(S===null){for(;!U.done;E++,U=v.next())U=f(y,U.value,b),U!==null&&(w=a(U,w,E),k===null?_=U:k.sibling=U,k=U);return yt&&Ea(y,E),_}for(S=s(y,S);!U.done;E++,U=v.next())U=p(S,y,E,U.value,b),U!==null&&(e&&U.alternate!==null&&S.delete(U.key===null?E:U.key),w=a(U,w,E),k===null?_=U:k.sibling=U,k=U);return e&&S.forEach(function(W){return t(y,W)}),yt&&Ea(y,E),_}function g(y,w,v,b){if(typeof v=="object"&&v!==null&&v.type===Pi&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case Hc:e:{for(var _=v.key,k=w;k!==null;){if(k.key===_){if(_=v.type,_===Pi){if(k.tag===7){r(y,k.sibling),w=n(k,v.props.children),w.return=y,y=w;break e}}else if(k.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===Vn&&ev(_)===k.type){r(y,k.sibling),w=n(k,v.props),w.ref=Xo(y,k,v),w.return=y,y=w;break e}r(y,k);break}else t(y,k);k=k.sibling}v.type===Pi?(w=Va(v.props.children,y.mode,b,v.key),w.return=y,y=w):(b=zu(v.type,v.key,v.props,null,y.mode,b),b.ref=Xo(y,w,v),b.return=y,y=b)}return i(y);case Fi:e:{for(k=v.key;w!==null;){if(w.key===k)if(w.tag===4&&w.stateNode.containerInfo===v.containerInfo&&w.stateNode.implementation===v.implementation){r(y,w.sibling),w=n(w,v.children||[]),w.return=y,y=w;break e}else{r(y,w);break}else t(y,w);w=w.sibling}w=rf(v,y.mode,b),w.return=y,y=w}return i(y);case Vn:return k=v._init,g(y,w,k(v._payload),b)}if(tl(v))return m(y,w,v,b);if(Wo(v))return x(y,w,v,b);ru(y,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,w!==null&&w.tag===6?(r(y,w.sibling),w=n(w,v),w.return=y,y=w):(r(y,w),w=tf(v,y.mode,b),w.return=y,y=w),i(y)):r(y,w)}return g}var fo=Y2(!0),J2=Y2(!1),od=pa(null),ld=null,Ui=null,ap=null;function ip(){ap=Ui=ld=null}function op(e){var t=od.current;pt(od),e._currentValue=t}function _h(e,t,r){for(;e!==null;){var s=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,s!==null&&(s.childLanes|=t)):s!==null&&(s.childLanes&t)!==t&&(s.childLanes|=t),e===r)break;e=e.return}}function eo(e,t){ld=e,ap=Ui=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Hr=!0),e.firstContext=null)}function Rs(e){var t=e._currentValue;if(ap!==e)if(e={context:e,memoizedValue:t,next:null},Ui===null){if(ld===null)throw Error(we(308));Ui=e,ld.dependencies={lanes:0,firstContext:e}}else Ui=Ui.next=e;return t}var Da=null;function lp(e){Da===null?Da=[e]:Da.push(e)}function Q2(e,t,r,s){var n=t.interleaved;return n===null?(r.next=r,lp(t)):(r.next=n.next,n.next=r),t.interleaved=r,Cn(e,s)}function Cn(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Wn=!1;function cp(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Z2(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Sn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ra(e,t,r){var s=e.updateQueue;if(s===null)return null;if(s=s.shared,Qe&2){var n=s.pending;return n===null?t.next=t:(t.next=n.next,n.next=t),s.pending=t,Cn(e,r)}return n=s.interleaved,n===null?(t.next=t,lp(s)):(t.next=n.next,n.next=t),s.interleaved=t,Cn(e,r)}function Du(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var s=t.lanes;s&=e.pendingLanes,r|=s,t.lanes=r,Km(e,r)}}function tv(e,t){var r=e.updateQueue,s=e.alternate;if(s!==null&&(s=s.updateQueue,r===s)){var n=null,a=null;if(r=r.firstBaseUpdate,r!==null){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};a===null?n=a=i:a=a.next=i,r=r.next}while(r!==null);a===null?n=a=t:a=a.next=t}else n=a=t;r={baseState:s.baseState,firstBaseUpdate:n,lastBaseUpdate:a,shared:s.shared,effects:s.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function cd(e,t,r,s){var n=e.updateQueue;Wn=!1;var a=n.firstBaseUpdate,i=n.lastBaseUpdate,l=n.shared.pending;if(l!==null){n.shared.pending=null;var c=l,u=c.next;c.next=null,i===null?a=u:i.next=u,i=c;var d=e.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==i&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(a!==null){var f=n.baseState;i=0,d=u=c=null,l=a;do{var h=l.lane,p=l.eventTime;if((s&h)===h){d!==null&&(d=d.next={eventTime:p,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var m=e,x=l;switch(h=t,p=r,x.tag){case 1:if(m=x.payload,typeof m=="function"){f=m.call(p,f,h);break e}f=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=x.payload,h=typeof m=="function"?m.call(p,f,h):m,h==null)break e;f=Ft({},f,h);break e;case 2:Wn=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,h=n.effects,h===null?n.effects=[l]:h.push(l))}else p={eventTime:p,lane:h,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=p,c=f):d=d.next=p,i|=h;if(l=l.next,l===null){if(l=n.shared.pending,l===null)break;h=l,l=h.next,h.next=null,n.lastBaseUpdate=h,n.shared.pending=null}}while(!0);if(d===null&&(c=f),n.baseState=c,n.firstBaseUpdate=u,n.lastBaseUpdate=d,t=n.shared.interleaved,t!==null){n=t;do i|=n.lane,n=n.next;while(n!==t)}else a===null&&(n.shared.lanes=0);ti|=i,e.lanes=i,e.memoizedState=f}}function rv(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var s=e[t],n=s.callback;if(n!==null){if(s.callback=null,s=r,typeof n!="function")throw Error(we(191,n));n.call(s)}}}var kc={},cn=pa(kc),Wl=pa(kc),Hl=pa(kc);function La(e){if(e===kc)throw Error(we(174));return e}function up(e,t){switch(dt(Hl,t),dt(Wl,e),dt(cn,kc),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:rh(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=rh(t,e)}pt(cn),dt(cn,t)}function ho(){pt(cn),pt(Wl),pt(Hl)}function eb(e){La(Hl.current);var t=La(cn.current),r=rh(t,e.type);t!==r&&(dt(Wl,e),dt(cn,r))}function dp(e){Wl.current===e&&(pt(cn),pt(Wl))}var jt=pa(0);function ud(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var X0=[];function fp(){for(var e=0;e<X0.length;e++)X0[e]._workInProgressVersionPrimary=null;X0.length=0}var Lu=On.ReactCurrentDispatcher,Y0=On.ReactCurrentBatchConfig,ei=0,At=null,Qt=null,sr=null,dd=!1,ml=!1,ql=0,e4=0;function gr(){throw Error(we(321))}function hp(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Zs(e[r],t[r]))return!1;return!0}function mp(e,t,r,s,n,a){if(ei=a,At=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Lu.current=e===null||e.memoizedState===null?n4:a4,e=r(s,n),ml){a=0;do{if(ml=!1,ql=0,25<=a)throw Error(we(301));a+=1,sr=Qt=null,t.updateQueue=null,Lu.current=i4,e=r(s,n)}while(ml)}if(Lu.current=fd,t=Qt!==null&&Qt.next!==null,ei=0,sr=Qt=At=null,dd=!1,t)throw Error(we(300));return e}function pp(){var e=ql!==0;return ql=0,e}function nn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return sr===null?At.memoizedState=sr=e:sr=sr.next=e,sr}function Is(){if(Qt===null){var e=At.alternate;e=e!==null?e.memoizedState:null}else e=Qt.next;var t=sr===null?At.memoizedState:sr.next;if(t!==null)sr=t,Qt=e;else{if(e===null)throw Error(we(310));Qt=e,e={memoizedState:Qt.memoizedState,baseState:Qt.baseState,baseQueue:Qt.baseQueue,queue:Qt.queue,next:null},sr===null?At.memoizedState=sr=e:sr=sr.next=e}return sr}function Gl(e,t){return typeof t=="function"?t(e):t}function J0(e){var t=Is(),r=t.queue;if(r===null)throw Error(we(311));r.lastRenderedReducer=e;var s=Qt,n=s.baseQueue,a=r.pending;if(a!==null){if(n!==null){var i=n.next;n.next=a.next,a.next=i}s.baseQueue=n=a,r.pending=null}if(n!==null){a=n.next,s=s.baseState;var l=i=null,c=null,u=a;do{var d=u.lane;if((ei&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),s=u.hasEagerState?u.eagerState:e(s,u.action);else{var f={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=f,i=s):c=c.next=f,At.lanes|=d,ti|=d}u=u.next}while(u!==null&&u!==a);c===null?i=s:c.next=l,Zs(s,t.memoizedState)||(Hr=!0),t.memoizedState=s,t.baseState=i,t.baseQueue=c,r.lastRenderedState=s}if(e=r.interleaved,e!==null){n=e;do a=n.lane,At.lanes|=a,ti|=a,n=n.next;while(n!==e)}else n===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Q0(e){var t=Is(),r=t.queue;if(r===null)throw Error(we(311));r.lastRenderedReducer=e;var s=r.dispatch,n=r.pending,a=t.memoizedState;if(n!==null){r.pending=null;var i=n=n.next;do a=e(a,i.action),i=i.next;while(i!==n);Zs(a,t.memoizedState)||(Hr=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),r.lastRenderedState=a}return[a,s]}function tb(){}function rb(e,t){var r=At,s=Is(),n=t(),a=!Zs(s.memoizedState,n);if(a&&(s.memoizedState=n,Hr=!0),s=s.queue,xp(ab.bind(null,r,s,e),[e]),s.getSnapshot!==t||a||sr!==null&&sr.memoizedState.tag&1){if(r.flags|=2048,Kl(9,nb.bind(null,r,s,n,t),void 0,null),ir===null)throw Error(we(349));ei&30||sb(r,t,n)}return n}function sb(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=At.updateQueue,t===null?(t={lastEffect:null,stores:null},At.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function nb(e,t,r,s){t.value=r,t.getSnapshot=s,ib(t)&&ob(e)}function ab(e,t,r){return r(function(){ib(t)&&ob(e)})}function ib(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Zs(e,r)}catch{return!0}}function ob(e){var t=Cn(e,1);t!==null&&Ys(t,e,1,-1)}function sv(e){var t=nn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Gl,lastRenderedState:e},t.queue=e,e=e.dispatch=s4.bind(null,At,e),[t.memoizedState,e]}function Kl(e,t,r,s){return e={tag:e,create:t,destroy:r,deps:s,next:null},t=At.updateQueue,t===null?(t={lastEffect:null,stores:null},At.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(s=r.next,r.next=e,e.next=s,t.lastEffect=e)),e}function lb(){return Is().memoizedState}function Mu(e,t,r,s){var n=nn();At.flags|=e,n.memoizedState=Kl(1|t,r,void 0,s===void 0?null:s)}function Qd(e,t,r,s){var n=Is();s=s===void 0?null:s;var a=void 0;if(Qt!==null){var i=Qt.memoizedState;if(a=i.destroy,s!==null&&hp(s,i.deps)){n.memoizedState=Kl(t,r,a,s);return}}At.flags|=e,n.memoizedState=Kl(1|t,r,a,s)}function nv(e,t){return Mu(8390656,8,e,t)}function xp(e,t){return Qd(2048,8,e,t)}function cb(e,t){return Qd(4,2,e,t)}function ub(e,t){return Qd(4,4,e,t)}function db(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function fb(e,t,r){return r=r!=null?r.concat([e]):null,Qd(4,4,db.bind(null,t,e),r)}function gp(){}function hb(e,t){var r=Is();t=t===void 0?null:t;var s=r.memoizedState;return s!==null&&t!==null&&hp(t,s[1])?s[0]:(r.memoizedState=[e,t],e)}function mb(e,t){var r=Is();t=t===void 0?null:t;var s=r.memoizedState;return s!==null&&t!==null&&hp(t,s[1])?s[0]:(e=e(),r.memoizedState=[e,t],e)}function pb(e,t,r){return ei&21?(Zs(r,t)||(r=w2(),At.lanes|=r,ti|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Hr=!0),e.memoizedState=r)}function t4(e,t){var r=lt;lt=r!==0&&4>r?r:4,e(!0);var s=Y0.transition;Y0.transition={};try{e(!1),t()}finally{lt=r,Y0.transition=s}}function xb(){return Is().memoizedState}function r4(e,t,r){var s=na(e);if(r={lane:s,action:r,hasEagerState:!1,eagerState:null,next:null},gb(e))vb(t,r);else if(r=Q2(e,t,r,s),r!==null){var n=Lr();Ys(r,e,s,n),yb(r,t,s)}}function s4(e,t,r){var s=na(e),n={lane:s,action:r,hasEagerState:!1,eagerState:null,next:null};if(gb(e))vb(t,n);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var i=t.lastRenderedState,l=a(i,r);if(n.hasEagerState=!0,n.eagerState=l,Zs(l,i)){var c=t.interleaved;c===null?(n.next=n,lp(t)):(n.next=c.next,c.next=n),t.interleaved=n;return}}catch{}finally{}r=Q2(e,t,n,s),r!==null&&(n=Lr(),Ys(r,e,s,n),yb(r,t,s))}}function gb(e){var t=e.alternate;return e===At||t!==null&&t===At}function vb(e,t){ml=dd=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function yb(e,t,r){if(r&4194240){var s=t.lanes;s&=e.pendingLanes,r|=s,t.lanes=r,Km(e,r)}}var fd={readContext:Rs,useCallback:gr,useContext:gr,useEffect:gr,useImperativeHandle:gr,useInsertionEffect:gr,useLayoutEffect:gr,useMemo:gr,useReducer:gr,useRef:gr,useState:gr,useDebugValue:gr,useDeferredValue:gr,useTransition:gr,useMutableSource:gr,useSyncExternalStore:gr,useId:gr,unstable_isNewReconciler:!1},n4={readContext:Rs,useCallback:function(e,t){return nn().memoizedState=[e,t===void 0?null:t],e},useContext:Rs,useEffect:nv,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Mu(4194308,4,db.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Mu(4194308,4,e,t)},useInsertionEffect:function(e,t){return Mu(4,2,e,t)},useMemo:function(e,t){var r=nn();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var s=nn();return t=r!==void 0?r(t):t,s.memoizedState=s.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},s.queue=e,e=e.dispatch=r4.bind(null,At,e),[s.memoizedState,e]},useRef:function(e){var t=nn();return e={current:e},t.memoizedState=e},useState:sv,useDebugValue:gp,useDeferredValue:function(e){return nn().memoizedState=e},useTransition:function(){var e=sv(!1),t=e[0];return e=t4.bind(null,e[1]),nn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var s=At,n=nn();if(yt){if(r===void 0)throw Error(we(407));r=r()}else{if(r=t(),ir===null)throw Error(we(349));ei&30||sb(s,t,r)}n.memoizedState=r;var a={value:r,getSnapshot:t};return n.queue=a,nv(ab.bind(null,s,a,e),[e]),s.flags|=2048,Kl(9,nb.bind(null,s,a,r,t),void 0,null),r},useId:function(){var e=nn(),t=ir.identifierPrefix;if(yt){var r=bn,s=wn;r=(s&~(1<<32-Xs(s)-1)).toString(32)+r,t=":"+t+"R"+r,r=ql++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=e4++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},a4={readContext:Rs,useCallback:hb,useContext:Rs,useEffect:xp,useImperativeHandle:fb,useInsertionEffect:cb,useLayoutEffect:ub,useMemo:mb,useReducer:J0,useRef:lb,useState:function(){return J0(Gl)},useDebugValue:gp,useDeferredValue:function(e){var t=Is();return pb(t,Qt.memoizedState,e)},useTransition:function(){var e=J0(Gl)[0],t=Is().memoizedState;return[e,t]},useMutableSource:tb,useSyncExternalStore:rb,useId:xb,unstable_isNewReconciler:!1},i4={readContext:Rs,useCallback:hb,useContext:Rs,useEffect:xp,useImperativeHandle:fb,useInsertionEffect:cb,useLayoutEffect:ub,useMemo:mb,useReducer:Q0,useRef:lb,useState:function(){return Q0(Gl)},useDebugValue:gp,useDeferredValue:function(e){var t=Is();return Qt===null?t.memoizedState=e:pb(t,Qt.memoizedState,e)},useTransition:function(){var e=Q0(Gl)[0],t=Is().memoizedState;return[e,t]},useMutableSource:tb,useSyncExternalStore:rb,useId:xb,unstable_isNewReconciler:!1};function $s(e,t){if(e&&e.defaultProps){t=Ft({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Sh(e,t,r,s){t=e.memoizedState,r=r(s,t),r=r==null?t:Ft({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Zd={isMounted:function(e){return(e=e._reactInternals)?di(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var s=Lr(),n=na(e),a=Sn(s,n);a.payload=t,r!=null&&(a.callback=r),t=ra(e,a,n),t!==null&&(Ys(t,e,n,s),Du(t,e,n))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var s=Lr(),n=na(e),a=Sn(s,n);a.tag=1,a.payload=t,r!=null&&(a.callback=r),t=ra(e,a,n),t!==null&&(Ys(t,e,n,s),Du(t,e,n))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Lr(),s=na(e),n=Sn(r,s);n.tag=2,t!=null&&(n.callback=t),t=ra(e,n,s),t!==null&&(Ys(t,e,s,r),Du(t,e,s))}};function av(e,t,r,s,n,a,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(s,a,i):t.prototype&&t.prototype.isPureReactComponent?!Ul(r,s)||!Ul(n,a):!0}function wb(e,t,r){var s=!1,n=oa,a=t.contextType;return typeof a=="object"&&a!==null?a=Rs(a):(n=Kr(t)?Qa:Tr.current,s=t.contextTypes,a=(s=s!=null)?co(e,n):oa),t=new t(r,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Zd,e.stateNode=t,t._reactInternals=e,s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=n,e.__reactInternalMemoizedMaskedChildContext=a),t}function iv(e,t,r,s){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,s),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,s),t.state!==e&&Zd.enqueueReplaceState(t,t.state,null)}function kh(e,t,r,s){var n=e.stateNode;n.props=r,n.state=e.memoizedState,n.refs={},cp(e);var a=t.contextType;typeof a=="object"&&a!==null?n.context=Rs(a):(a=Kr(t)?Qa:Tr.current,n.context=co(e,a)),n.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(Sh(e,t,a,r),n.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof n.getSnapshotBeforeUpdate=="function"||typeof n.UNSAFE_componentWillMount!="function"&&typeof n.componentWillMount!="function"||(t=n.state,typeof n.componentWillMount=="function"&&n.componentWillMount(),typeof n.UNSAFE_componentWillMount=="function"&&n.UNSAFE_componentWillMount(),t!==n.state&&Zd.enqueueReplaceState(n,n.state,null),cd(e,r,n,s),n.state=e.memoizedState),typeof n.componentDidMount=="function"&&(e.flags|=4194308)}function mo(e,t){try{var r="",s=t;do r+=IE(s),s=s.return;while(s);var n=r}catch(a){n=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:n,digest:null}}function Z0(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Nh(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var o4=typeof WeakMap=="function"?WeakMap:Map;function bb(e,t,r){r=Sn(-1,r),r.tag=3,r.payload={element:null};var s=t.value;return r.callback=function(){md||(md=!0,Oh=s),Nh(e,t)},r}function _b(e,t,r){r=Sn(-1,r),r.tag=3;var s=e.type.getDerivedStateFromError;if(typeof s=="function"){var n=t.value;r.payload=function(){return s(n)},r.callback=function(){Nh(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(r.callback=function(){Nh(e,t),typeof s!="function"&&(sa===null?sa=new Set([this]):sa.add(this));var i=t.stack;this.componentDidCatch(t.value,{componentStack:i!==null?i:""})}),r}function ov(e,t,r){var s=e.pingCache;if(s===null){s=e.pingCache=new o4;var n=new Set;s.set(t,n)}else n=s.get(t),n===void 0&&(n=new Set,s.set(t,n));n.has(r)||(n.add(r),e=b4.bind(null,e,t,r),t.then(e,e))}function lv(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function cv(e,t,r,s,n){return e.mode&1?(e.flags|=65536,e.lanes=n,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Sn(-1,1),t.tag=2,ra(r,t,1))),r.lanes|=1),e)}var l4=On.ReactCurrentOwner,Hr=!1;function Pr(e,t,r,s){t.child=e===null?J2(t,null,r,s):fo(t,e.child,r,s)}function uv(e,t,r,s,n){r=r.render;var a=t.ref;return eo(t,n),s=mp(e,t,r,s,a,n),r=pp(),e!==null&&!Hr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n,An(e,t,n)):(yt&&r&&rp(t),t.flags|=1,Pr(e,t,s,n),t.child)}function dv(e,t,r,s,n){if(e===null){var a=r.type;return typeof a=="function"&&!Np(a)&&a.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=a,Sb(e,t,a,s,n)):(e=zu(r.type,null,s,t,t.mode,n),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!(e.lanes&n)){var i=a.memoizedProps;if(r=r.compare,r=r!==null?r:Ul,r(i,s)&&e.ref===t.ref)return An(e,t,n)}return t.flags|=1,e=aa(a,s),e.ref=t.ref,e.return=t,t.child=e}function Sb(e,t,r,s,n){if(e!==null){var a=e.memoizedProps;if(Ul(a,s)&&e.ref===t.ref)if(Hr=!1,t.pendingProps=s=a,(e.lanes&n)!==0)e.flags&131072&&(Hr=!0);else return t.lanes=e.lanes,An(e,t,n)}return jh(e,t,r,s,n)}function kb(e,t,r){var s=t.pendingProps,n=s.children,a=e!==null?e.memoizedState:null;if(s.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},dt(zi,ts),ts|=r;else{if(!(r&1073741824))return e=a!==null?a.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,dt(zi,ts),ts|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=a!==null?a.baseLanes:r,dt(zi,ts),ts|=s}else a!==null?(s=a.baseLanes|r,t.memoizedState=null):s=r,dt(zi,ts),ts|=s;return Pr(e,t,n,r),t.child}function Nb(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function jh(e,t,r,s,n){var a=Kr(r)?Qa:Tr.current;return a=co(t,a),eo(t,n),r=mp(e,t,r,s,a,n),s=pp(),e!==null&&!Hr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n,An(e,t,n)):(yt&&s&&rp(t),t.flags|=1,Pr(e,t,r,n),t.child)}function fv(e,t,r,s,n){if(Kr(r)){var a=!0;nd(t)}else a=!1;if(eo(t,n),t.stateNode===null)Bu(e,t),wb(t,r,s),kh(t,r,s,n),s=!0;else if(e===null){var i=t.stateNode,l=t.memoizedProps;i.props=l;var c=i.context,u=r.contextType;typeof u=="object"&&u!==null?u=Rs(u):(u=Kr(r)?Qa:Tr.current,u=co(t,u));var d=r.getDerivedStateFromProps,f=typeof d=="function"||typeof i.getSnapshotBeforeUpdate=="function";f||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(l!==s||c!==u)&&iv(t,i,s,u),Wn=!1;var h=t.memoizedState;i.state=h,cd(t,s,i,n),c=t.memoizedState,l!==s||h!==c||Gr.current||Wn?(typeof d=="function"&&(Sh(t,r,d,s),c=t.memoizedState),(l=Wn||av(t,r,l,s,h,c,u))?(f||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=s,t.memoizedState=c),i.props=s,i.state=c,i.context=u,s=l):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),s=!1)}else{i=t.stateNode,Z2(e,t),l=t.memoizedProps,u=t.type===t.elementType?l:$s(t.type,l),i.props=u,f=t.pendingProps,h=i.context,c=r.contextType,typeof c=="object"&&c!==null?c=Rs(c):(c=Kr(r)?Qa:Tr.current,c=co(t,c));var p=r.getDerivedStateFromProps;(d=typeof p=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(l!==f||h!==c)&&iv(t,i,s,c),Wn=!1,h=t.memoizedState,i.state=h,cd(t,s,i,n);var m=t.memoizedState;l!==f||h!==m||Gr.current||Wn?(typeof p=="function"&&(Sh(t,r,p,s),m=t.memoizedState),(u=Wn||av(t,r,u,s,h,m,c)||!1)?(d||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(s,m,c),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(s,m,c)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=s,t.memoizedState=m),i.props=s,i.state=m,i.context=c,s=u):(typeof i.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),s=!1)}return Eh(e,t,r,s,a,n)}function Eh(e,t,r,s,n,a){Nb(e,t);var i=(t.flags&128)!==0;if(!s&&!i)return n&&Jg(t,r,!1),An(e,t,a);s=t.stateNode,l4.current=t;var l=i&&typeof r.getDerivedStateFromError!="function"?null:s.render();return t.flags|=1,e!==null&&i?(t.child=fo(t,e.child,null,a),t.child=fo(t,null,l,a)):Pr(e,t,l,a),t.memoizedState=s.state,n&&Jg(t,r,!0),t.child}function jb(e){var t=e.stateNode;t.pendingContext?Yg(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Yg(e,t.context,!1),up(e,t.containerInfo)}function hv(e,t,r,s,n){return uo(),np(n),t.flags|=256,Pr(e,t,r,s),t.child}var Th={dehydrated:null,treeContext:null,retryLane:0};function Ch(e){return{baseLanes:e,cachePool:null,transitions:null}}function Eb(e,t,r){var s=t.pendingProps,n=jt.current,a=!1,i=(t.flags&128)!==0,l;if((l=i)||(l=e!==null&&e.memoizedState===null?!1:(n&2)!==0),l?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(n|=1),dt(jt,n&1),e===null)return bh(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(i=s.children,e=s.fallback,a?(s=t.mode,a=t.child,i={mode:"hidden",children:i},!(s&1)&&a!==null?(a.childLanes=0,a.pendingProps=i):a=r0(i,s,0,null),e=Va(e,s,r,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=Ch(r),t.memoizedState=Th,e):vp(t,i));if(n=e.memoizedState,n!==null&&(l=n.dehydrated,l!==null))return c4(e,t,i,s,l,n,r);if(a){a=s.fallback,i=t.mode,n=e.child,l=n.sibling;var c={mode:"hidden",children:s.children};return!(i&1)&&t.child!==n?(s=t.child,s.childLanes=0,s.pendingProps=c,t.deletions=null):(s=aa(n,c),s.subtreeFlags=n.subtreeFlags&14680064),l!==null?a=aa(l,a):(a=Va(a,i,r,null),a.flags|=2),a.return=t,s.return=t,s.sibling=a,t.child=s,s=a,a=t.child,i=e.child.memoizedState,i=i===null?Ch(r):{baseLanes:i.baseLanes|r,cachePool:null,transitions:i.transitions},a.memoizedState=i,a.childLanes=e.childLanes&~r,t.memoizedState=Th,s}return a=e.child,e=a.sibling,s=aa(a,{mode:"visible",children:s.children}),!(t.mode&1)&&(s.lanes=r),s.return=t,s.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=s,t.memoizedState=null,s}function vp(e,t){return t=r0({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function su(e,t,r,s){return s!==null&&np(s),fo(t,e.child,null,r),e=vp(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function c4(e,t,r,s,n,a,i){if(r)return t.flags&256?(t.flags&=-257,s=Z0(Error(we(422))),su(e,t,i,s)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=s.fallback,n=t.mode,s=r0({mode:"visible",children:s.children},n,0,null),a=Va(a,n,i,null),a.flags|=2,s.return=t,a.return=t,s.sibling=a,t.child=s,t.mode&1&&fo(t,e.child,null,i),t.child.memoizedState=Ch(i),t.memoizedState=Th,a);if(!(t.mode&1))return su(e,t,i,null);if(n.data==="$!"){if(s=n.nextSibling&&n.nextSibling.dataset,s)var l=s.dgst;return s=l,a=Error(we(419)),s=Z0(a,s,void 0),su(e,t,i,s)}if(l=(i&e.childLanes)!==0,Hr||l){if(s=ir,s!==null){switch(i&-i){case 4:n=2;break;case 16:n=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:n=32;break;case 536870912:n=268435456;break;default:n=0}n=n&(s.suspendedLanes|i)?0:n,n!==0&&n!==a.retryLane&&(a.retryLane=n,Cn(e,n),Ys(s,e,n,-1))}return kp(),s=Z0(Error(we(421))),su(e,t,i,s)}return n.data==="$?"?(t.flags|=128,t.child=e.child,t=_4.bind(null,e),n._reactRetry=t,null):(e=a.treeContext,ls=ta(n.nextSibling),us=t,yt=!0,Ws=null,e!==null&&(js[Es++]=wn,js[Es++]=bn,js[Es++]=Za,wn=e.id,bn=e.overflow,Za=t),t=vp(t,s.children),t.flags|=4096,t)}function mv(e,t,r){e.lanes|=t;var s=e.alternate;s!==null&&(s.lanes|=t),_h(e.return,t,r)}function ef(e,t,r,s,n){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:s,tail:r,tailMode:n}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=s,a.tail=r,a.tailMode=n)}function Tb(e,t,r){var s=t.pendingProps,n=s.revealOrder,a=s.tail;if(Pr(e,t,s.children,r),s=jt.current,s&2)s=s&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&mv(e,r,t);else if(e.tag===19)mv(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}s&=1}if(dt(jt,s),!(t.mode&1))t.memoizedState=null;else switch(n){case"forwards":for(r=t.child,n=null;r!==null;)e=r.alternate,e!==null&&ud(e)===null&&(n=r),r=r.sibling;r=n,r===null?(n=t.child,t.child=null):(n=r.sibling,r.sibling=null),ef(t,!1,n,r,a);break;case"backwards":for(r=null,n=t.child,t.child=null;n!==null;){if(e=n.alternate,e!==null&&ud(e)===null){t.child=n;break}e=n.sibling,n.sibling=r,r=n,n=e}ef(t,!0,r,null,a);break;case"together":ef(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Bu(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function An(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),ti|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(we(153));if(t.child!==null){for(e=t.child,r=aa(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=aa(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function u4(e,t,r){switch(t.tag){case 3:jb(t),uo();break;case 5:eb(t);break;case 1:Kr(t.type)&&nd(t);break;case 4:up(t,t.stateNode.containerInfo);break;case 10:var s=t.type._context,n=t.memoizedProps.value;dt(od,s._currentValue),s._currentValue=n;break;case 13:if(s=t.memoizedState,s!==null)return s.dehydrated!==null?(dt(jt,jt.current&1),t.flags|=128,null):r&t.child.childLanes?Eb(e,t,r):(dt(jt,jt.current&1),e=An(e,t,r),e!==null?e.sibling:null);dt(jt,jt.current&1);break;case 19:if(s=(r&t.childLanes)!==0,e.flags&128){if(s)return Tb(e,t,r);t.flags|=128}if(n=t.memoizedState,n!==null&&(n.rendering=null,n.tail=null,n.lastEffect=null),dt(jt,jt.current),s)break;return null;case 22:case 23:return t.lanes=0,kb(e,t,r)}return An(e,t,r)}var Cb,Ah,Ab,Fb;Cb=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Ah=function(){};Ab=function(e,t,r,s){var n=e.memoizedProps;if(n!==s){e=t.stateNode,La(cn.current);var a=null;switch(r){case"input":n=Qf(e,n),s=Qf(e,s),a=[];break;case"select":n=Ft({},n,{value:void 0}),s=Ft({},s,{value:void 0}),a=[];break;case"textarea":n=th(e,n),s=th(e,s),a=[];break;default:typeof n.onClick!="function"&&typeof s.onClick=="function"&&(e.onclick=rd)}sh(r,s);var i;r=null;for(u in n)if(!s.hasOwnProperty(u)&&n.hasOwnProperty(u)&&n[u]!=null)if(u==="style"){var l=n[u];for(i in l)l.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Rl.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in s){var c=s[u];if(l=n!=null?n[u]:void 0,s.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(i in l)!l.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in c)c.hasOwnProperty(i)&&l[i]!==c[i]&&(r||(r={}),r[i]=c[i])}else r||(a||(a=[]),a.push(u,r)),r=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(a=a||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(a=a||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Rl.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&ft("scroll",e),a||l===c||(a=[])):(a=a||[]).push(u,c))}r&&(a=a||[]).push("style",r);var u=a;(t.updateQueue=u)&&(t.flags|=4)}};Fb=function(e,t,r,s){r!==s&&(t.flags|=4)};function Yo(e,t){if(!yt)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var s=null;r!==null;)r.alternate!==null&&(s=r),r=r.sibling;s===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:s.sibling=null}}function vr(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,s=0;if(t)for(var n=e.child;n!==null;)r|=n.lanes|n.childLanes,s|=n.subtreeFlags&14680064,s|=n.flags&14680064,n.return=e,n=n.sibling;else for(n=e.child;n!==null;)r|=n.lanes|n.childLanes,s|=n.subtreeFlags,s|=n.flags,n.return=e,n=n.sibling;return e.subtreeFlags|=s,e.childLanes=r,t}function d4(e,t,r){var s=t.pendingProps;switch(sp(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return vr(t),null;case 1:return Kr(t.type)&&sd(),vr(t),null;case 3:return s=t.stateNode,ho(),pt(Gr),pt(Tr),fp(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(e===null||e.child===null)&&(tu(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Ws!==null&&(Mh(Ws),Ws=null))),Ah(e,t),vr(t),null;case 5:dp(t);var n=La(Hl.current);if(r=t.type,e!==null&&t.stateNode!=null)Ab(e,t,r,s,n),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!s){if(t.stateNode===null)throw Error(we(166));return vr(t),null}if(e=La(cn.current),tu(t)){s=t.stateNode,r=t.type;var a=t.memoizedProps;switch(s[an]=t,s[Vl]=a,e=(t.mode&1)!==0,r){case"dialog":ft("cancel",s),ft("close",s);break;case"iframe":case"object":case"embed":ft("load",s);break;case"video":case"audio":for(n=0;n<sl.length;n++)ft(sl[n],s);break;case"source":ft("error",s);break;case"img":case"image":case"link":ft("error",s),ft("load",s);break;case"details":ft("toggle",s);break;case"input":Sg(s,a),ft("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!a.multiple},ft("invalid",s);break;case"textarea":Ng(s,a),ft("invalid",s)}sh(r,a),n=null;for(var i in a)if(a.hasOwnProperty(i)){var l=a[i];i==="children"?typeof l=="string"?s.textContent!==l&&(a.suppressHydrationWarning!==!0&&eu(s.textContent,l,e),n=["children",l]):typeof l=="number"&&s.textContent!==""+l&&(a.suppressHydrationWarning!==!0&&eu(s.textContent,l,e),n=["children",""+l]):Rl.hasOwnProperty(i)&&l!=null&&i==="onScroll"&&ft("scroll",s)}switch(r){case"input":qc(s),kg(s,a,!0);break;case"textarea":qc(s),jg(s);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(s.onclick=rd)}s=n,t.updateQueue=s,s!==null&&(t.flags|=4)}else{i=n.nodeType===9?n:n.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=a2(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof s.is=="string"?e=i.createElement(r,{is:s.is}):(e=i.createElement(r),r==="select"&&(i=e,s.multiple?i.multiple=!0:s.size&&(i.size=s.size))):e=i.createElementNS(e,r),e[an]=t,e[Vl]=s,Cb(e,t,!1,!1),t.stateNode=e;e:{switch(i=nh(r,s),r){case"dialog":ft("cancel",e),ft("close",e),n=s;break;case"iframe":case"object":case"embed":ft("load",e),n=s;break;case"video":case"audio":for(n=0;n<sl.length;n++)ft(sl[n],e);n=s;break;case"source":ft("error",e),n=s;break;case"img":case"image":case"link":ft("error",e),ft("load",e),n=s;break;case"details":ft("toggle",e),n=s;break;case"input":Sg(e,s),n=Qf(e,s),ft("invalid",e);break;case"option":n=s;break;case"select":e._wrapperState={wasMultiple:!!s.multiple},n=Ft({},s,{value:void 0}),ft("invalid",e);break;case"textarea":Ng(e,s),n=th(e,s),ft("invalid",e);break;default:n=s}sh(r,n),l=n;for(a in l)if(l.hasOwnProperty(a)){var c=l[a];a==="style"?l2(e,c):a==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&i2(e,c)):a==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&Il(e,c):typeof c=="number"&&Il(e,""+c):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(Rl.hasOwnProperty(a)?c!=null&&a==="onScroll"&&ft("scroll",e):c!=null&&zm(e,a,c,i))}switch(r){case"input":qc(e),kg(e,s,!1);break;case"textarea":qc(e),jg(e);break;case"option":s.value!=null&&e.setAttribute("value",""+ia(s.value));break;case"select":e.multiple=!!s.multiple,a=s.value,a!=null?Yi(e,!!s.multiple,a,!1):s.defaultValue!=null&&Yi(e,!!s.multiple,s.defaultValue,!0);break;default:typeof n.onClick=="function"&&(e.onclick=rd)}switch(r){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return vr(t),null;case 6:if(e&&t.stateNode!=null)Fb(e,t,e.memoizedProps,s);else{if(typeof s!="string"&&t.stateNode===null)throw Error(we(166));if(r=La(Hl.current),La(cn.current),tu(t)){if(s=t.stateNode,r=t.memoizedProps,s[an]=t,(a=s.nodeValue!==r)&&(e=us,e!==null))switch(e.tag){case 3:eu(s.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&eu(s.nodeValue,r,(e.mode&1)!==0)}a&&(t.flags|=4)}else s=(r.nodeType===9?r:r.ownerDocument).createTextNode(s),s[an]=t,t.stateNode=s}return vr(t),null;case 13:if(pt(jt),s=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(yt&&ls!==null&&t.mode&1&&!(t.flags&128))X2(),uo(),t.flags|=98560,a=!1;else if(a=tu(t),s!==null&&s.dehydrated!==null){if(e===null){if(!a)throw Error(we(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(we(317));a[an]=t}else uo(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;vr(t),a=!1}else Ws!==null&&(Mh(Ws),Ws=null),a=!0;if(!a)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(s=s!==null,s!==(e!==null&&e.memoizedState!==null)&&s&&(t.child.flags|=8192,t.mode&1&&(e===null||jt.current&1?er===0&&(er=3):kp())),t.updateQueue!==null&&(t.flags|=4),vr(t),null);case 4:return ho(),Ah(e,t),e===null&&$l(t.stateNode.containerInfo),vr(t),null;case 10:return op(t.type._context),vr(t),null;case 17:return Kr(t.type)&&sd(),vr(t),null;case 19:if(pt(jt),a=t.memoizedState,a===null)return vr(t),null;if(s=(t.flags&128)!==0,i=a.rendering,i===null)if(s)Yo(a,!1);else{if(er!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(i=ud(e),i!==null){for(t.flags|=128,Yo(a,!1),s=i.updateQueue,s!==null&&(t.updateQueue=s,t.flags|=4),t.subtreeFlags=0,s=r,r=t.child;r!==null;)a=r,e=s,a.flags&=14680066,i=a.alternate,i===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=i.childLanes,a.lanes=i.lanes,a.child=i.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=i.memoizedProps,a.memoizedState=i.memoizedState,a.updateQueue=i.updateQueue,a.type=i.type,e=i.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return dt(jt,jt.current&1|2),t.child}e=e.sibling}a.tail!==null&&Ut()>po&&(t.flags|=128,s=!0,Yo(a,!1),t.lanes=4194304)}else{if(!s)if(e=ud(i),e!==null){if(t.flags|=128,s=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Yo(a,!0),a.tail===null&&a.tailMode==="hidden"&&!i.alternate&&!yt)return vr(t),null}else 2*Ut()-a.renderingStartTime>po&&r!==1073741824&&(t.flags|=128,s=!0,Yo(a,!1),t.lanes=4194304);a.isBackwards?(i.sibling=t.child,t.child=i):(r=a.last,r!==null?r.sibling=i:t.child=i,a.last=i)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=Ut(),t.sibling=null,r=jt.current,dt(jt,s?r&1|2:r&1),t):(vr(t),null);case 22:case 23:return Sp(),s=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==s&&(t.flags|=8192),s&&t.mode&1?ts&1073741824&&(vr(t),t.subtreeFlags&6&&(t.flags|=8192)):vr(t),null;case 24:return null;case 25:return null}throw Error(we(156,t.tag))}function f4(e,t){switch(sp(t),t.tag){case 1:return Kr(t.type)&&sd(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return ho(),pt(Gr),pt(Tr),fp(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return dp(t),null;case 13:if(pt(jt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(we(340));uo()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return pt(jt),null;case 4:return ho(),null;case 10:return op(t.type._context),null;case 22:case 23:return Sp(),null;case 24:return null;default:return null}}var nu=!1,_r=!1,h4=typeof WeakSet=="function"?WeakSet:Set,Pe=null;function $i(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(s){Rt(e,t,s)}else r.current=null}function Fh(e,t,r){try{r()}catch(s){Rt(e,t,s)}}var pv=!1;function m4(e,t){if(mh=Zu,e=D2(),tp(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var s=r.getSelection&&r.getSelection();if(s&&s.rangeCount!==0){r=s.anchorNode;var n=s.anchorOffset,a=s.focusNode;s=s.focusOffset;try{r.nodeType,a.nodeType}catch{r=null;break e}var i=0,l=-1,c=-1,u=0,d=0,f=e,h=null;t:for(;;){for(var p;f!==r||n!==0&&f.nodeType!==3||(l=i+n),f!==a||s!==0&&f.nodeType!==3||(c=i+s),f.nodeType===3&&(i+=f.nodeValue.length),(p=f.firstChild)!==null;)h=f,f=p;for(;;){if(f===e)break t;if(h===r&&++u===n&&(l=i),h===a&&++d===s&&(c=i),(p=f.nextSibling)!==null)break;f=h,h=f.parentNode}f=p}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(ph={focusedElem:e,selectionRange:r},Zu=!1,Pe=t;Pe!==null;)if(t=Pe,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Pe=e;else for(;Pe!==null;){t=Pe;try{var m=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var x=m.memoizedProps,g=m.memoizedState,y=t.stateNode,w=y.getSnapshotBeforeUpdate(t.elementType===t.type?x:$s(t.type,x),g);y.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var v=t.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(we(163))}}catch(b){Rt(t,t.return,b)}if(e=t.sibling,e!==null){e.return=t.return,Pe=e;break}Pe=t.return}return m=pv,pv=!1,m}function pl(e,t,r){var s=t.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var n=s=s.next;do{if((n.tag&e)===e){var a=n.destroy;n.destroy=void 0,a!==void 0&&Fh(t,r,a)}n=n.next}while(n!==s)}}function e0(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var s=r.create;r.destroy=s()}r=r.next}while(r!==t)}}function Ph(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function Pb(e){var t=e.alternate;t!==null&&(e.alternate=null,Pb(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[an],delete t[Vl],delete t[vh],delete t[YT],delete t[JT])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Rb(e){return e.tag===5||e.tag===3||e.tag===4}function xv(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Rb(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Rh(e,t,r){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=rd));else if(s!==4&&(e=e.child,e!==null))for(Rh(e,t,r),e=e.sibling;e!==null;)Rh(e,t,r),e=e.sibling}function Ih(e,t,r){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(s!==4&&(e=e.child,e!==null))for(Ih(e,t,r),e=e.sibling;e!==null;)Ih(e,t,r),e=e.sibling}var cr=null,Vs=!1;function Bn(e,t,r){for(r=r.child;r!==null;)Ib(e,t,r),r=r.sibling}function Ib(e,t,r){if(ln&&typeof ln.onCommitFiberUnmount=="function")try{ln.onCommitFiberUnmount(qd,r)}catch{}switch(r.tag){case 5:_r||$i(r,t);case 6:var s=cr,n=Vs;cr=null,Bn(e,t,r),cr=s,Vs=n,cr!==null&&(Vs?(e=cr,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):cr.removeChild(r.stateNode));break;case 18:cr!==null&&(Vs?(e=cr,r=r.stateNode,e.nodeType===8?G0(e.parentNode,r):e.nodeType===1&&G0(e,r),Ml(e)):G0(cr,r.stateNode));break;case 4:s=cr,n=Vs,cr=r.stateNode.containerInfo,Vs=!0,Bn(e,t,r),cr=s,Vs=n;break;case 0:case 11:case 14:case 15:if(!_r&&(s=r.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){n=s=s.next;do{var a=n,i=a.destroy;a=a.tag,i!==void 0&&(a&2||a&4)&&Fh(r,t,i),n=n.next}while(n!==s)}Bn(e,t,r);break;case 1:if(!_r&&($i(r,t),s=r.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=r.memoizedProps,s.state=r.memoizedState,s.componentWillUnmount()}catch(l){Rt(r,t,l)}Bn(e,t,r);break;case 21:Bn(e,t,r);break;case 22:r.mode&1?(_r=(s=_r)||r.memoizedState!==null,Bn(e,t,r),_r=s):Bn(e,t,r);break;default:Bn(e,t,r)}}function gv(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new h4),t.forEach(function(s){var n=S4.bind(null,e,s);r.has(s)||(r.add(s),s.then(n,n))})}}function Ls(e,t){var r=t.deletions;if(r!==null)for(var s=0;s<r.length;s++){var n=r[s];try{var a=e,i=t,l=i;e:for(;l!==null;){switch(l.tag){case 5:cr=l.stateNode,Vs=!1;break e;case 3:cr=l.stateNode.containerInfo,Vs=!0;break e;case 4:cr=l.stateNode.containerInfo,Vs=!0;break e}l=l.return}if(cr===null)throw Error(we(160));Ib(a,i,n),cr=null,Vs=!1;var c=n.alternate;c!==null&&(c.return=null),n.return=null}catch(u){Rt(n,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Ob(t,e),t=t.sibling}function Ob(e,t){var r=e.alternate,s=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Ls(t,e),en(e),s&4){try{pl(3,e,e.return),e0(3,e)}catch(x){Rt(e,e.return,x)}try{pl(5,e,e.return)}catch(x){Rt(e,e.return,x)}}break;case 1:Ls(t,e),en(e),s&512&&r!==null&&$i(r,r.return);break;case 5:if(Ls(t,e),en(e),s&512&&r!==null&&$i(r,r.return),e.flags&32){var n=e.stateNode;try{Il(n,"")}catch(x){Rt(e,e.return,x)}}if(s&4&&(n=e.stateNode,n!=null)){var a=e.memoizedProps,i=r!==null?r.memoizedProps:a,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&a.type==="radio"&&a.name!=null&&s2(n,a),nh(l,i);var u=nh(l,a);for(i=0;i<c.length;i+=2){var d=c[i],f=c[i+1];d==="style"?l2(n,f):d==="dangerouslySetInnerHTML"?i2(n,f):d==="children"?Il(n,f):zm(n,d,f,u)}switch(l){case"input":Zf(n,a);break;case"textarea":n2(n,a);break;case"select":var h=n._wrapperState.wasMultiple;n._wrapperState.wasMultiple=!!a.multiple;var p=a.value;p!=null?Yi(n,!!a.multiple,p,!1):h!==!!a.multiple&&(a.defaultValue!=null?Yi(n,!!a.multiple,a.defaultValue,!0):Yi(n,!!a.multiple,a.multiple?[]:"",!1))}n[Vl]=a}catch(x){Rt(e,e.return,x)}}break;case 6:if(Ls(t,e),en(e),s&4){if(e.stateNode===null)throw Error(we(162));n=e.stateNode,a=e.memoizedProps;try{n.nodeValue=a}catch(x){Rt(e,e.return,x)}}break;case 3:if(Ls(t,e),en(e),s&4&&r!==null&&r.memoizedState.isDehydrated)try{Ml(t.containerInfo)}catch(x){Rt(e,e.return,x)}break;case 4:Ls(t,e),en(e);break;case 13:Ls(t,e),en(e),n=e.child,n.flags&8192&&(a=n.memoizedState!==null,n.stateNode.isHidden=a,!a||n.alternate!==null&&n.alternate.memoizedState!==null||(bp=Ut())),s&4&&gv(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(_r=(u=_r)||d,Ls(t,e),_r=u):Ls(t,e),en(e),s&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!d&&e.mode&1)for(Pe=e,d=e.child;d!==null;){for(f=Pe=d;Pe!==null;){switch(h=Pe,p=h.child,h.tag){case 0:case 11:case 14:case 15:pl(4,h,h.return);break;case 1:$i(h,h.return);var m=h.stateNode;if(typeof m.componentWillUnmount=="function"){s=h,r=h.return;try{t=s,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(x){Rt(s,r,x)}}break;case 5:$i(h,h.return);break;case 22:if(h.memoizedState!==null){yv(f);continue}}p!==null?(p.return=h,Pe=p):yv(f)}d=d.sibling}e:for(d=null,f=e;;){if(f.tag===5){if(d===null){d=f;try{n=f.stateNode,u?(a=n.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(l=f.stateNode,c=f.memoizedProps.style,i=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=o2("display",i))}catch(x){Rt(e,e.return,x)}}}else if(f.tag===6){if(d===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(x){Rt(e,e.return,x)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Ls(t,e),en(e),s&4&&gv(e);break;case 21:break;default:Ls(t,e),en(e)}}function en(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(Rb(r)){var s=r;break e}r=r.return}throw Error(we(160))}switch(s.tag){case 5:var n=s.stateNode;s.flags&32&&(Il(n,""),s.flags&=-33);var a=xv(e);Ih(e,a,n);break;case 3:case 4:var i=s.stateNode.containerInfo,l=xv(e);Rh(e,l,i);break;default:throw Error(we(161))}}catch(c){Rt(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function p4(e,t,r){Pe=e,Db(e)}function Db(e,t,r){for(var s=(e.mode&1)!==0;Pe!==null;){var n=Pe,a=n.child;if(n.tag===22&&s){var i=n.memoizedState!==null||nu;if(!i){var l=n.alternate,c=l!==null&&l.memoizedState!==null||_r;l=nu;var u=_r;if(nu=i,(_r=c)&&!u)for(Pe=n;Pe!==null;)i=Pe,c=i.child,i.tag===22&&i.memoizedState!==null?wv(n):c!==null?(c.return=i,Pe=c):wv(n);for(;a!==null;)Pe=a,Db(a),a=a.sibling;Pe=n,nu=l,_r=u}vv(e)}else n.subtreeFlags&8772&&a!==null?(a.return=n,Pe=a):vv(e)}}function vv(e){for(;Pe!==null;){var t=Pe;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:_r||e0(5,t);break;case 1:var s=t.stateNode;if(t.flags&4&&!_r)if(r===null)s.componentDidMount();else{var n=t.elementType===t.type?r.memoizedProps:$s(t.type,r.memoizedProps);s.componentDidUpdate(n,r.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&rv(t,a,s);break;case 3:var i=t.updateQueue;if(i!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}rv(t,i,r)}break;case 5:var l=t.stateNode;if(r===null&&t.flags&4){r=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var f=d.dehydrated;f!==null&&Ml(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(we(163))}_r||t.flags&512&&Ph(t)}catch(h){Rt(t,t.return,h)}}if(t===e){Pe=null;break}if(r=t.sibling,r!==null){r.return=t.return,Pe=r;break}Pe=t.return}}function yv(e){for(;Pe!==null;){var t=Pe;if(t===e){Pe=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Pe=r;break}Pe=t.return}}function wv(e){for(;Pe!==null;){var t=Pe;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{e0(4,t)}catch(c){Rt(t,r,c)}break;case 1:var s=t.stateNode;if(typeof s.componentDidMount=="function"){var n=t.return;try{s.componentDidMount()}catch(c){Rt(t,n,c)}}var a=t.return;try{Ph(t)}catch(c){Rt(t,a,c)}break;case 5:var i=t.return;try{Ph(t)}catch(c){Rt(t,i,c)}}}catch(c){Rt(t,t.return,c)}if(t===e){Pe=null;break}var l=t.sibling;if(l!==null){l.return=t.return,Pe=l;break}Pe=t.return}}var x4=Math.ceil,hd=On.ReactCurrentDispatcher,yp=On.ReactCurrentOwner,As=On.ReactCurrentBatchConfig,Qe=0,ir=null,Yt=null,hr=0,ts=0,zi=pa(0),er=0,Xl=null,ti=0,t0=0,wp=0,xl=null,Wr=null,bp=0,po=1/0,gn=null,md=!1,Oh=null,sa=null,au=!1,Xn=null,pd=0,gl=0,Dh=null,Uu=-1,$u=0;function Lr(){return Qe&6?Ut():Uu!==-1?Uu:Uu=Ut()}function na(e){return e.mode&1?Qe&2&&hr!==0?hr&-hr:ZT.transition!==null?($u===0&&($u=w2()),$u):(e=lt,e!==0||(e=window.event,e=e===void 0?16:E2(e.type)),e):1}function Ys(e,t,r,s){if(50<gl)throw gl=0,Dh=null,Error(we(185));bc(e,r,s),(!(Qe&2)||e!==ir)&&(e===ir&&(!(Qe&2)&&(t0|=r),er===4&&qn(e,hr)),Xr(e,s),r===1&&Qe===0&&!(t.mode&1)&&(po=Ut()+500,Jd&&xa()))}function Xr(e,t){var r=e.callbackNode;ZE(e,t);var s=Qu(e,e===ir?hr:0);if(s===0)r!==null&&Cg(r),e.callbackNode=null,e.callbackPriority=0;else if(t=s&-s,e.callbackPriority!==t){if(r!=null&&Cg(r),t===1)e.tag===0?QT(bv.bind(null,e)):q2(bv.bind(null,e)),KT(function(){!(Qe&6)&&xa()}),r=null;else{switch(b2(s)){case 1:r=Gm;break;case 4:r=v2;break;case 16:r=Ju;break;case 536870912:r=y2;break;default:r=Ju}r=Wb(r,Lb.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function Lb(e,t){if(Uu=-1,$u=0,Qe&6)throw Error(we(327));var r=e.callbackNode;if(to()&&e.callbackNode!==r)return null;var s=Qu(e,e===ir?hr:0);if(s===0)return null;if(s&30||s&e.expiredLanes||t)t=xd(e,s);else{t=s;var n=Qe;Qe|=2;var a=Bb();(ir!==e||hr!==t)&&(gn=null,po=Ut()+500,za(e,t));do try{y4();break}catch(l){Mb(e,l)}while(!0);ip(),hd.current=a,Qe=n,Yt!==null?t=0:(ir=null,hr=0,t=er)}if(t!==0){if(t===2&&(n=ch(e),n!==0&&(s=n,t=Lh(e,n))),t===1)throw r=Xl,za(e,0),qn(e,s),Xr(e,Ut()),r;if(t===6)qn(e,s);else{if(n=e.current.alternate,!(s&30)&&!g4(n)&&(t=xd(e,s),t===2&&(a=ch(e),a!==0&&(s=a,t=Lh(e,a))),t===1))throw r=Xl,za(e,0),qn(e,s),Xr(e,Ut()),r;switch(e.finishedWork=n,e.finishedLanes=s,t){case 0:case 1:throw Error(we(345));case 2:Ta(e,Wr,gn);break;case 3:if(qn(e,s),(s&130023424)===s&&(t=bp+500-Ut(),10<t)){if(Qu(e,0)!==0)break;if(n=e.suspendedLanes,(n&s)!==s){Lr(),e.pingedLanes|=e.suspendedLanes&n;break}e.timeoutHandle=gh(Ta.bind(null,e,Wr,gn),t);break}Ta(e,Wr,gn);break;case 4:if(qn(e,s),(s&4194240)===s)break;for(t=e.eventTimes,n=-1;0<s;){var i=31-Xs(s);a=1<<i,i=t[i],i>n&&(n=i),s&=~a}if(s=n,s=Ut()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*x4(s/1960))-s,10<s){e.timeoutHandle=gh(Ta.bind(null,e,Wr,gn),s);break}Ta(e,Wr,gn);break;case 5:Ta(e,Wr,gn);break;default:throw Error(we(329))}}}return Xr(e,Ut()),e.callbackNode===r?Lb.bind(null,e):null}function Lh(e,t){var r=xl;return e.current.memoizedState.isDehydrated&&(za(e,t).flags|=256),e=xd(e,t),e!==2&&(t=Wr,Wr=r,t!==null&&Mh(t)),e}function Mh(e){Wr===null?Wr=e:Wr.push.apply(Wr,e)}function g4(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var s=0;s<r.length;s++){var n=r[s],a=n.getSnapshot;n=n.value;try{if(!Zs(a(),n))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function qn(e,t){for(t&=~wp,t&=~t0,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Xs(t),s=1<<r;e[r]=-1,t&=~s}}function bv(e){if(Qe&6)throw Error(we(327));to();var t=Qu(e,0);if(!(t&1))return Xr(e,Ut()),null;var r=xd(e,t);if(e.tag!==0&&r===2){var s=ch(e);s!==0&&(t=s,r=Lh(e,s))}if(r===1)throw r=Xl,za(e,0),qn(e,t),Xr(e,Ut()),r;if(r===6)throw Error(we(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ta(e,Wr,gn),Xr(e,Ut()),null}function _p(e,t){var r=Qe;Qe|=1;try{return e(t)}finally{Qe=r,Qe===0&&(po=Ut()+500,Jd&&xa())}}function ri(e){Xn!==null&&Xn.tag===0&&!(Qe&6)&&to();var t=Qe;Qe|=1;var r=As.transition,s=lt;try{if(As.transition=null,lt=1,e)return e()}finally{lt=s,As.transition=r,Qe=t,!(Qe&6)&&xa()}}function Sp(){ts=zi.current,pt(zi)}function za(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,GT(r)),Yt!==null)for(r=Yt.return;r!==null;){var s=r;switch(sp(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&sd();break;case 3:ho(),pt(Gr),pt(Tr),fp();break;case 5:dp(s);break;case 4:ho();break;case 13:pt(jt);break;case 19:pt(jt);break;case 10:op(s.type._context);break;case 22:case 23:Sp()}r=r.return}if(ir=e,Yt=e=aa(e.current,null),hr=ts=t,er=0,Xl=null,wp=t0=ti=0,Wr=xl=null,Da!==null){for(t=0;t<Da.length;t++)if(r=Da[t],s=r.interleaved,s!==null){r.interleaved=null;var n=s.next,a=r.pending;if(a!==null){var i=a.next;a.next=n,s.next=i}r.pending=s}Da=null}return e}function Mb(e,t){do{var r=Yt;try{if(ip(),Lu.current=fd,dd){for(var s=At.memoizedState;s!==null;){var n=s.queue;n!==null&&(n.pending=null),s=s.next}dd=!1}if(ei=0,sr=Qt=At=null,ml=!1,ql=0,yp.current=null,r===null||r.return===null){er=1,Xl=t,Yt=null;break}e:{var a=e,i=r.return,l=r,c=t;if(t=hr,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=l,f=d.tag;if(!(d.mode&1)&&(f===0||f===11||f===15)){var h=d.alternate;h?(d.updateQueue=h.updateQueue,d.memoizedState=h.memoizedState,d.lanes=h.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=lv(i);if(p!==null){p.flags&=-257,cv(p,i,l,a,t),p.mode&1&&ov(a,u,t),t=p,c=u;var m=t.updateQueue;if(m===null){var x=new Set;x.add(c),t.updateQueue=x}else m.add(c);break e}else{if(!(t&1)){ov(a,u,t),kp();break e}c=Error(we(426))}}else if(yt&&l.mode&1){var g=lv(i);if(g!==null){!(g.flags&65536)&&(g.flags|=256),cv(g,i,l,a,t),np(mo(c,l));break e}}a=c=mo(c,l),er!==4&&(er=2),xl===null?xl=[a]:xl.push(a),a=i;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var y=bb(a,c,t);tv(a,y);break e;case 1:l=c;var w=a.type,v=a.stateNode;if(!(a.flags&128)&&(typeof w.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(sa===null||!sa.has(v)))){a.flags|=65536,t&=-t,a.lanes|=t;var b=_b(a,l,t);tv(a,b);break e}}a=a.return}while(a!==null)}$b(r)}catch(_){t=_,Yt===r&&r!==null&&(Yt=r=r.return);continue}break}while(!0)}function Bb(){var e=hd.current;return hd.current=fd,e===null?fd:e}function kp(){(er===0||er===3||er===2)&&(er=4),ir===null||!(ti&268435455)&&!(t0&268435455)||qn(ir,hr)}function xd(e,t){var r=Qe;Qe|=2;var s=Bb();(ir!==e||hr!==t)&&(gn=null,za(e,t));do try{v4();break}catch(n){Mb(e,n)}while(!0);if(ip(),Qe=r,hd.current=s,Yt!==null)throw Error(we(261));return ir=null,hr=0,er}function v4(){for(;Yt!==null;)Ub(Yt)}function y4(){for(;Yt!==null&&!WE();)Ub(Yt)}function Ub(e){var t=Vb(e.alternate,e,ts);e.memoizedProps=e.pendingProps,t===null?$b(e):Yt=t,yp.current=null}function $b(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=f4(r,t),r!==null){r.flags&=32767,Yt=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{er=6,Yt=null;return}}else if(r=d4(r,t,ts),r!==null){Yt=r;return}if(t=t.sibling,t!==null){Yt=t;return}Yt=t=e}while(t!==null);er===0&&(er=5)}function Ta(e,t,r){var s=lt,n=As.transition;try{As.transition=null,lt=1,w4(e,t,r,s)}finally{As.transition=n,lt=s}return null}function w4(e,t,r,s){do to();while(Xn!==null);if(Qe&6)throw Error(we(327));r=e.finishedWork;var n=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(we(177));e.callbackNode=null,e.callbackPriority=0;var a=r.lanes|r.childLanes;if(eT(e,a),e===ir&&(Yt=ir=null,hr=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||au||(au=!0,Wb(Ju,function(){return to(),null})),a=(r.flags&15990)!==0,r.subtreeFlags&15990||a){a=As.transition,As.transition=null;var i=lt;lt=1;var l=Qe;Qe|=4,yp.current=null,m4(e,r),Ob(r,e),UT(ph),Zu=!!mh,ph=mh=null,e.current=r,p4(r),HE(),Qe=l,lt=i,As.transition=a}else e.current=r;if(au&&(au=!1,Xn=e,pd=n),a=e.pendingLanes,a===0&&(sa=null),KE(r.stateNode),Xr(e,Ut()),t!==null)for(s=e.onRecoverableError,r=0;r<t.length;r++)n=t[r],s(n.value,{componentStack:n.stack,digest:n.digest});if(md)throw md=!1,e=Oh,Oh=null,e;return pd&1&&e.tag!==0&&to(),a=e.pendingLanes,a&1?e===Dh?gl++:(gl=0,Dh=e):gl=0,xa(),null}function to(){if(Xn!==null){var e=b2(pd),t=As.transition,r=lt;try{if(As.transition=null,lt=16>e?16:e,Xn===null)var s=!1;else{if(e=Xn,Xn=null,pd=0,Qe&6)throw Error(we(331));var n=Qe;for(Qe|=4,Pe=e.current;Pe!==null;){var a=Pe,i=a.child;if(Pe.flags&16){var l=a.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(Pe=u;Pe!==null;){var d=Pe;switch(d.tag){case 0:case 11:case 15:pl(8,d,a)}var f=d.child;if(f!==null)f.return=d,Pe=f;else for(;Pe!==null;){d=Pe;var h=d.sibling,p=d.return;if(Pb(d),d===u){Pe=null;break}if(h!==null){h.return=p,Pe=h;break}Pe=p}}}var m=a.alternate;if(m!==null){var x=m.child;if(x!==null){m.child=null;do{var g=x.sibling;x.sibling=null,x=g}while(x!==null)}}Pe=a}}if(a.subtreeFlags&2064&&i!==null)i.return=a,Pe=i;else e:for(;Pe!==null;){if(a=Pe,a.flags&2048)switch(a.tag){case 0:case 11:case 15:pl(9,a,a.return)}var y=a.sibling;if(y!==null){y.return=a.return,Pe=y;break e}Pe=a.return}}var w=e.current;for(Pe=w;Pe!==null;){i=Pe;var v=i.child;if(i.subtreeFlags&2064&&v!==null)v.return=i,Pe=v;else e:for(i=w;Pe!==null;){if(l=Pe,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:e0(9,l)}}catch(_){Rt(l,l.return,_)}if(l===i){Pe=null;break e}var b=l.sibling;if(b!==null){b.return=l.return,Pe=b;break e}Pe=l.return}}if(Qe=n,xa(),ln&&typeof ln.onPostCommitFiberRoot=="function")try{ln.onPostCommitFiberRoot(qd,e)}catch{}s=!0}return s}finally{lt=r,As.transition=t}}return!1}function _v(e,t,r){t=mo(r,t),t=bb(e,t,1),e=ra(e,t,1),t=Lr(),e!==null&&(bc(e,1,t),Xr(e,t))}function Rt(e,t,r){if(e.tag===3)_v(e,e,r);else for(;t!==null;){if(t.tag===3){_v(t,e,r);break}else if(t.tag===1){var s=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(sa===null||!sa.has(s))){e=mo(r,e),e=_b(t,e,1),t=ra(t,e,1),e=Lr(),t!==null&&(bc(t,1,e),Xr(t,e));break}}t=t.return}}function b4(e,t,r){var s=e.pingCache;s!==null&&s.delete(t),t=Lr(),e.pingedLanes|=e.suspendedLanes&r,ir===e&&(hr&r)===r&&(er===4||er===3&&(hr&130023424)===hr&&500>Ut()-bp?za(e,0):wp|=r),Xr(e,t)}function zb(e,t){t===0&&(e.mode&1?(t=Xc,Xc<<=1,!(Xc&130023424)&&(Xc=4194304)):t=1);var r=Lr();e=Cn(e,t),e!==null&&(bc(e,t,r),Xr(e,r))}function _4(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),zb(e,r)}function S4(e,t){var r=0;switch(e.tag){case 13:var s=e.stateNode,n=e.memoizedState;n!==null&&(r=n.retryLane);break;case 19:s=e.stateNode;break;default:throw Error(we(314))}s!==null&&s.delete(t),zb(e,r)}var Vb;Vb=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Gr.current)Hr=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Hr=!1,u4(e,t,r);Hr=!!(e.flags&131072)}else Hr=!1,yt&&t.flags&1048576&&G2(t,id,t.index);switch(t.lanes=0,t.tag){case 2:var s=t.type;Bu(e,t),e=t.pendingProps;var n=co(t,Tr.current);eo(t,r),n=mp(null,t,s,e,n,r);var a=pp();return t.flags|=1,typeof n=="object"&&n!==null&&typeof n.render=="function"&&n.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Kr(s)?(a=!0,nd(t)):a=!1,t.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,cp(t),n.updater=Zd,t.stateNode=n,n._reactInternals=t,kh(t,s,e,r),t=Eh(null,t,s,!0,a,r)):(t.tag=0,yt&&a&&rp(t),Pr(null,t,n,r),t=t.child),t;case 16:s=t.elementType;e:{switch(Bu(e,t),e=t.pendingProps,n=s._init,s=n(s._payload),t.type=s,n=t.tag=N4(s),e=$s(s,e),n){case 0:t=jh(null,t,s,e,r);break e;case 1:t=fv(null,t,s,e,r);break e;case 11:t=uv(null,t,s,e,r);break e;case 14:t=dv(null,t,s,$s(s.type,e),r);break e}throw Error(we(306,s,""))}return t;case 0:return s=t.type,n=t.pendingProps,n=t.elementType===s?n:$s(s,n),jh(e,t,s,n,r);case 1:return s=t.type,n=t.pendingProps,n=t.elementType===s?n:$s(s,n),fv(e,t,s,n,r);case 3:e:{if(jb(t),e===null)throw Error(we(387));s=t.pendingProps,a=t.memoizedState,n=a.element,Z2(e,t),cd(t,s,null,r);var i=t.memoizedState;if(s=i.element,a.isDehydrated)if(a={element:s,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){n=mo(Error(we(423)),t),t=hv(e,t,s,r,n);break e}else if(s!==n){n=mo(Error(we(424)),t),t=hv(e,t,s,r,n);break e}else for(ls=ta(t.stateNode.containerInfo.firstChild),us=t,yt=!0,Ws=null,r=J2(t,null,s,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(uo(),s===n){t=An(e,t,r);break e}Pr(e,t,s,r)}t=t.child}return t;case 5:return eb(t),e===null&&bh(t),s=t.type,n=t.pendingProps,a=e!==null?e.memoizedProps:null,i=n.children,xh(s,n)?i=null:a!==null&&xh(s,a)&&(t.flags|=32),Nb(e,t),Pr(e,t,i,r),t.child;case 6:return e===null&&bh(t),null;case 13:return Eb(e,t,r);case 4:return up(t,t.stateNode.containerInfo),s=t.pendingProps,e===null?t.child=fo(t,null,s,r):Pr(e,t,s,r),t.child;case 11:return s=t.type,n=t.pendingProps,n=t.elementType===s?n:$s(s,n),uv(e,t,s,n,r);case 7:return Pr(e,t,t.pendingProps,r),t.child;case 8:return Pr(e,t,t.pendingProps.children,r),t.child;case 12:return Pr(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(s=t.type._context,n=t.pendingProps,a=t.memoizedProps,i=n.value,dt(od,s._currentValue),s._currentValue=i,a!==null)if(Zs(a.value,i)){if(a.children===n.children&&!Gr.current){t=An(e,t,r);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var l=a.dependencies;if(l!==null){i=a.child;for(var c=l.firstContext;c!==null;){if(c.context===s){if(a.tag===1){c=Sn(-1,r&-r),c.tag=2;var u=a.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}a.lanes|=r,c=a.alternate,c!==null&&(c.lanes|=r),_h(a.return,r,t),l.lanes|=r;break}c=c.next}}else if(a.tag===10)i=a.type===t.type?null:a.child;else if(a.tag===18){if(i=a.return,i===null)throw Error(we(341));i.lanes|=r,l=i.alternate,l!==null&&(l.lanes|=r),_h(i,r,t),i=a.sibling}else i=a.child;if(i!==null)i.return=a;else for(i=a;i!==null;){if(i===t){i=null;break}if(a=i.sibling,a!==null){a.return=i.return,i=a;break}i=i.return}a=i}Pr(e,t,n.children,r),t=t.child}return t;case 9:return n=t.type,s=t.pendingProps.children,eo(t,r),n=Rs(n),s=s(n),t.flags|=1,Pr(e,t,s,r),t.child;case 14:return s=t.type,n=$s(s,t.pendingProps),n=$s(s.type,n),dv(e,t,s,n,r);case 15:return Sb(e,t,t.type,t.pendingProps,r);case 17:return s=t.type,n=t.pendingProps,n=t.elementType===s?n:$s(s,n),Bu(e,t),t.tag=1,Kr(s)?(e=!0,nd(t)):e=!1,eo(t,r),wb(t,s,n),kh(t,s,n,r),Eh(null,t,s,!0,e,r);case 19:return Tb(e,t,r);case 22:return kb(e,t,r)}throw Error(we(156,t.tag))};function Wb(e,t){return g2(e,t)}function k4(e,t,r,s){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ts(e,t,r,s){return new k4(e,t,r,s)}function Np(e){return e=e.prototype,!(!e||!e.isReactComponent)}function N4(e){if(typeof e=="function")return Np(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Wm)return 11;if(e===Hm)return 14}return 2}function aa(e,t){var r=e.alternate;return r===null?(r=Ts(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function zu(e,t,r,s,n,a){var i=2;if(s=e,typeof e=="function")Np(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case Pi:return Va(r.children,n,a,t);case Vm:i=8,n|=8;break;case Kf:return e=Ts(12,r,t,n|2),e.elementType=Kf,e.lanes=a,e;case Xf:return e=Ts(13,r,t,n),e.elementType=Xf,e.lanes=a,e;case Yf:return e=Ts(19,r,t,n),e.elementType=Yf,e.lanes=a,e;case e2:return r0(r,n,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Qw:i=10;break e;case Zw:i=9;break e;case Wm:i=11;break e;case Hm:i=14;break e;case Vn:i=16,s=null;break e}throw Error(we(130,e==null?e:typeof e,""))}return t=Ts(i,r,t,n),t.elementType=e,t.type=s,t.lanes=a,t}function Va(e,t,r,s){return e=Ts(7,e,s,t),e.lanes=r,e}function r0(e,t,r,s){return e=Ts(22,e,s,t),e.elementType=e2,e.lanes=r,e.stateNode={isHidden:!1},e}function tf(e,t,r){return e=Ts(6,e,null,t),e.lanes=r,e}function rf(e,t,r){return t=Ts(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function j4(e,t,r,s,n){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=D0(0),this.expirationTimes=D0(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=D0(0),this.identifierPrefix=s,this.onRecoverableError=n,this.mutableSourceEagerHydrationData=null}function jp(e,t,r,s,n,a,i,l,c){return e=new j4(e,t,r,l,c),t===1?(t=1,a===!0&&(t|=8)):t=0,a=Ts(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:s,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},cp(a),e}function E4(e,t,r){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Fi,key:s==null?null:""+s,children:e,containerInfo:t,implementation:r}}function Hb(e){if(!e)return oa;e=e._reactInternals;e:{if(di(e)!==e||e.tag!==1)throw Error(we(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Kr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(we(171))}if(e.tag===1){var r=e.type;if(Kr(r))return H2(e,r,t)}return t}function qb(e,t,r,s,n,a,i,l,c){return e=jp(r,s,!0,e,n,a,i,l,c),e.context=Hb(null),r=e.current,s=Lr(),n=na(r),a=Sn(s,n),a.callback=t??null,ra(r,a,n),e.current.lanes=n,bc(e,n,s),Xr(e,s),e}function s0(e,t,r,s){var n=t.current,a=Lr(),i=na(n);return r=Hb(r),t.context===null?t.context=r:t.pendingContext=r,t=Sn(a,i),t.payload={element:e},s=s===void 0?null:s,s!==null&&(t.callback=s),e=ra(n,t,i),e!==null&&(Ys(e,n,i,a),Du(e,n,i)),i}function gd(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Sv(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Ep(e,t){Sv(e,t),(e=e.alternate)&&Sv(e,t)}function T4(){return null}var Gb=typeof reportError=="function"?reportError:function(e){console.error(e)};function Tp(e){this._internalRoot=e}n0.prototype.render=Tp.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(we(409));s0(e,t,null,null)};n0.prototype.unmount=Tp.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;ri(function(){s0(null,e,null,null)}),t[Tn]=null}};function n0(e){this._internalRoot=e}n0.prototype.unstable_scheduleHydration=function(e){if(e){var t=k2();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Hn.length&&t!==0&&t<Hn[r].priority;r++);Hn.splice(r,0,e),r===0&&j2(e)}};function Cp(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function a0(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function kv(){}function C4(e,t,r,s,n){if(n){if(typeof s=="function"){var a=s;s=function(){var u=gd(i);a.call(u)}}var i=qb(t,s,e,0,null,!1,!1,"",kv);return e._reactRootContainer=i,e[Tn]=i.current,$l(e.nodeType===8?e.parentNode:e),ri(),i}for(;n=e.lastChild;)e.removeChild(n);if(typeof s=="function"){var l=s;s=function(){var u=gd(c);l.call(u)}}var c=jp(e,0,!1,null,null,!1,!1,"",kv);return e._reactRootContainer=c,e[Tn]=c.current,$l(e.nodeType===8?e.parentNode:e),ri(function(){s0(t,c,r,s)}),c}function i0(e,t,r,s,n){var a=r._reactRootContainer;if(a){var i=a;if(typeof n=="function"){var l=n;n=function(){var c=gd(i);l.call(c)}}s0(t,i,e,n)}else i=C4(r,t,e,n,s);return gd(i)}_2=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=rl(t.pendingLanes);r!==0&&(Km(t,r|1),Xr(t,Ut()),!(Qe&6)&&(po=Ut()+500,xa()))}break;case 13:ri(function(){var s=Cn(e,1);if(s!==null){var n=Lr();Ys(s,e,1,n)}}),Ep(e,1)}};Xm=function(e){if(e.tag===13){var t=Cn(e,134217728);if(t!==null){var r=Lr();Ys(t,e,134217728,r)}Ep(e,134217728)}};S2=function(e){if(e.tag===13){var t=na(e),r=Cn(e,t);if(r!==null){var s=Lr();Ys(r,e,t,s)}Ep(e,t)}};k2=function(){return lt};N2=function(e,t){var r=lt;try{return lt=e,t()}finally{lt=r}};ih=function(e,t,r){switch(t){case"input":if(Zf(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var s=r[t];if(s!==e&&s.form===e.form){var n=Yd(s);if(!n)throw Error(we(90));r2(s),Zf(s,n)}}}break;case"textarea":n2(e,r);break;case"select":t=r.value,t!=null&&Yi(e,!!r.multiple,t,!1)}};d2=_p;f2=ri;var A4={usingClientEntryPoint:!1,Events:[Sc,Di,Yd,c2,u2,_p]},Jo={findFiberByHostInstance:Oa,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},F4={bundleType:Jo.bundleType,version:Jo.version,rendererPackageName:Jo.rendererPackageName,rendererConfig:Jo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:On.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=p2(e),e===null?null:e.stateNode},findFiberByHostInstance:Jo.findFiberByHostInstance||T4,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var iu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!iu.isDisabled&&iu.supportsFiber)try{qd=iu.inject(F4),ln=iu}catch{}}hs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=A4;hs.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Cp(t))throw Error(we(200));return E4(e,t,null,r)};hs.createRoot=function(e,t){if(!Cp(e))throw Error(we(299));var r=!1,s="",n=Gb;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(n=t.onRecoverableError)),t=jp(e,1,!1,null,null,r,!1,s,n),e[Tn]=t.current,$l(e.nodeType===8?e.parentNode:e),new Tp(t)};hs.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(we(188)):(e=Object.keys(e).join(","),Error(we(268,e)));return e=p2(t),e=e===null?null:e.stateNode,e};hs.flushSync=function(e){return ri(e)};hs.hydrate=function(e,t,r){if(!a0(t))throw Error(we(200));return i0(null,e,t,!0,r)};hs.hydrateRoot=function(e,t,r){if(!Cp(e))throw Error(we(405));var s=r!=null&&r.hydratedSources||null,n=!1,a="",i=Gb;if(r!=null&&(r.unstable_strictMode===!0&&(n=!0),r.identifierPrefix!==void 0&&(a=r.identifierPrefix),r.onRecoverableError!==void 0&&(i=r.onRecoverableError)),t=qb(t,null,e,1,r??null,n,!1,a,i),e[Tn]=t.current,$l(e),s)for(e=0;e<s.length;e++)r=s[e],n=r._getVersion,n=n(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,n]:t.mutableSourceEagerHydrationData.push(r,n);return new n0(t)};hs.render=function(e,t,r){if(!a0(t))throw Error(we(200));return i0(null,e,t,!1,r)};hs.unmountComponentAtNode=function(e){if(!a0(e))throw Error(we(40));return e._reactRootContainer?(ri(function(){i0(null,null,e,!1,function(){e._reactRootContainer=null,e[Tn]=null})}),!0):!1};hs.unstable_batchedUpdates=_p;hs.unstable_renderSubtreeIntoContainer=function(e,t,r,s){if(!a0(r))throw Error(we(200));if(e==null||e._reactInternals===void 0)throw Error(we(38));return i0(e,t,r,!1,s)};hs.version="18.3.1-next-f1338f8080-20240426";function Kb(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Kb)}catch(e){console.error(e)}}Kb(),Kw.exports=hs;var P4=Kw.exports,Nv=P4;qf.createRoot=Nv.createRoot,qf.hydrateRoot=Nv.hydrateRoot;const Ap=T.createContext({});function Fp(e){const t=T.useRef(null);return t.current===null&&(t.current=e()),t.current}const Pp=typeof window<"u",Xb=Pp?T.useLayoutEffect:T.useEffect,o0=T.createContext(null);function Rp(e,t){e.indexOf(t)===-1&&e.push(t)}function Ip(e,t){const r=e.indexOf(t);r>-1&&e.splice(r,1)}const Fn=(e,t,r)=>r>t?t:r<e?e:r;let Op=()=>{};const Pn={},Yb=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e);function Jb(e){return typeof e=="object"&&e!==null}const Qb=e=>/^0[^.\s]+$/u.test(e);function Dp(e){let t;return()=>(t===void 0&&(t=e()),t)}const Fs=e=>e,R4=(e,t)=>r=>t(e(r)),Nc=(...e)=>e.reduce(R4),Yl=(e,t,r)=>{const s=t-e;return s===0?1:(r-e)/s};class Lp{constructor(){this.subscriptions=[]}add(t){return Rp(this.subscriptions,t),()=>Ip(this.subscriptions,t)}notify(t,r,s){const n=this.subscriptions.length;if(n)if(n===1)this.subscriptions[0](t,r,s);else for(let a=0;a<n;a++){const i=this.subscriptions[a];i&&i(t,r,s)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const un=e=>e*1e3,Cs=e=>e/1e3;function Zb(e,t){return t?e*(1e3/t):0}const e_=(e,t,r)=>(((1-3*r+3*t)*e+(3*r-6*t))*e+3*t)*e,I4=1e-7,O4=12;function D4(e,t,r,s,n){let a,i,l=0;do i=t+(r-t)/2,a=e_(i,s,n)-e,a>0?r=i:t=i;while(Math.abs(a)>I4&&++l<O4);return i}function jc(e,t,r,s){if(e===t&&r===s)return Fs;const n=a=>D4(a,0,1,e,r);return a=>a===0||a===1?a:e_(n(a),t,s)}const t_=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,r_=e=>t=>1-e(1-t),s_=jc(.33,1.53,.69,.99),Mp=r_(s_),n_=t_(Mp),a_=e=>(e*=2)<1?.5*Mp(e):.5*(2-Math.pow(2,-10*(e-1))),Bp=e=>1-Math.sin(Math.acos(e)),i_=r_(Bp),o_=t_(Bp),L4=jc(.42,0,1,1),M4=jc(0,0,.58,1),l_=jc(.42,0,.58,1),B4=e=>Array.isArray(e)&&typeof e[0]!="number",c_=e=>Array.isArray(e)&&typeof e[0]=="number",U4={linear:Fs,easeIn:L4,easeInOut:l_,easeOut:M4,circIn:Bp,circInOut:o_,circOut:i_,backIn:Mp,backInOut:n_,backOut:s_,anticipate:a_},$4=e=>typeof e=="string",jv=e=>{if(c_(e)){Op(e.length===4);const[t,r,s,n]=e;return jc(t,r,s,n)}else if($4(e))return U4[e];return e},ou=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function z4(e,t){let r=new Set,s=new Set,n=!1,a=!1;const i=new WeakSet;let l={delta:0,timestamp:0,isProcessing:!1};function c(d){i.has(d)&&(u.schedule(d),e()),d(l)}const u={schedule:(d,f=!1,h=!1)=>{const m=h&&n?r:s;return f&&i.add(d),m.has(d)||m.add(d),d},cancel:d=>{s.delete(d),i.delete(d)},process:d=>{if(l=d,n){a=!0;return}n=!0,[r,s]=[s,r],r.forEach(c),r.clear(),n=!1,a&&(a=!1,u.process(d))}};return u}const V4=40;function u_(e,t){let r=!1,s=!0;const n={delta:0,timestamp:0,isProcessing:!1},a=()=>r=!0,i=ou.reduce((v,b)=>(v[b]=z4(a),v),{}),{setup:l,read:c,resolveKeyframes:u,preUpdate:d,update:f,preRender:h,render:p,postRender:m}=i,x=()=>{const v=Pn.useManualTiming?n.timestamp:performance.now();r=!1,Pn.useManualTiming||(n.delta=s?1e3/60:Math.max(Math.min(v-n.timestamp,V4),1)),n.timestamp=v,n.isProcessing=!0,l.process(n),c.process(n),u.process(n),d.process(n),f.process(n),h.process(n),p.process(n),m.process(n),n.isProcessing=!1,r&&t&&(s=!1,e(x))},g=()=>{r=!0,s=!0,n.isProcessing||e(x)};return{schedule:ou.reduce((v,b)=>{const _=i[b];return v[b]=(k,S=!1,E=!1)=>(r||g(),_.schedule(k,S,E)),v},{}),cancel:v=>{for(let b=0;b<ou.length;b++)i[ou[b]].cancel(v)},state:n,steps:i}}const{schedule:wt,cancel:la,state:ur,steps:sf}=u_(typeof requestAnimationFrame<"u"?requestAnimationFrame:Fs,!0);let Vu;function W4(){Vu=void 0}const qr={now:()=>(Vu===void 0&&qr.set(ur.isProcessing||Pn.useManualTiming?ur.timestamp:performance.now()),Vu),set:e=>{Vu=e,queueMicrotask(W4)}},d_=e=>t=>typeof t=="string"&&t.startsWith(e),Up=d_("--"),H4=d_("var(--"),$p=e=>H4(e)?q4.test(e.split("/*")[0].trim()):!1,q4=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,Co={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},Jl={...Co,transform:e=>Fn(0,1,e)},lu={...Co,default:1},vl=e=>Math.round(e*1e5)/1e5,zp=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function G4(e){return e==null}const K4=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,Vp=(e,t)=>r=>!!(typeof r=="string"&&K4.test(r)&&r.startsWith(e)||t&&!G4(r)&&Object.prototype.hasOwnProperty.call(r,t)),f_=(e,t,r)=>s=>{if(typeof s!="string")return s;const[n,a,i,l]=s.match(zp);return{[e]:parseFloat(n),[t]:parseFloat(a),[r]:parseFloat(i),alpha:l!==void 0?parseFloat(l):1}},X4=e=>Fn(0,255,e),nf={...Co,transform:e=>Math.round(X4(e))},Ma={test:Vp("rgb","red"),parse:f_("red","green","blue"),transform:({red:e,green:t,blue:r,alpha:s=1})=>"rgba("+nf.transform(e)+", "+nf.transform(t)+", "+nf.transform(r)+", "+vl(Jl.transform(s))+")"};function Y4(e){let t="",r="",s="",n="";return e.length>5?(t=e.substring(1,3),r=e.substring(3,5),s=e.substring(5,7),n=e.substring(7,9)):(t=e.substring(1,2),r=e.substring(2,3),s=e.substring(3,4),n=e.substring(4,5),t+=t,r+=r,s+=s,n+=n),{red:parseInt(t,16),green:parseInt(r,16),blue:parseInt(s,16),alpha:n?parseInt(n,16)/255:1}}const Bh={test:Vp("#"),parse:Y4,transform:Ma.transform},Ec=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),zn=Ec("deg"),dn=Ec("%"),$e=Ec("px"),J4=Ec("vh"),Q4=Ec("vw"),Ev={...dn,parse:e=>dn.parse(e)/100,transform:e=>dn.transform(e*100)},Vi={test:Vp("hsl","hue"),parse:f_("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:r,alpha:s=1})=>"hsla("+Math.round(e)+", "+dn.transform(vl(t))+", "+dn.transform(vl(r))+", "+vl(Jl.transform(s))+")"},Xt={test:e=>Ma.test(e)||Bh.test(e)||Vi.test(e),parse:e=>Ma.test(e)?Ma.parse(e):Vi.test(e)?Vi.parse(e):Bh.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?Ma.transform(e):Vi.transform(e),getAnimatableNone:e=>{const t=Xt.parse(e);return t.alpha=0,Xt.transform(t)}},Z4=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function e3(e){var t,r;return isNaN(e)&&typeof e=="string"&&(((t=e.match(zp))==null?void 0:t.length)||0)+(((r=e.match(Z4))==null?void 0:r.length)||0)>0}const h_="number",m_="color",t3="var",r3="var(",Tv="${}",s3=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Ql(e){const t=e.toString(),r=[],s={color:[],number:[],var:[]},n=[];let a=0;const l=t.replace(s3,c=>(Xt.test(c)?(s.color.push(a),n.push(m_),r.push(Xt.parse(c))):c.startsWith(r3)?(s.var.push(a),n.push(t3),r.push(c)):(s.number.push(a),n.push(h_),r.push(parseFloat(c))),++a,Tv)).split(Tv);return{values:r,split:l,indexes:s,types:n}}function p_(e){return Ql(e).values}function x_(e){const{split:t,types:r}=Ql(e),s=t.length;return n=>{let a="";for(let i=0;i<s;i++)if(a+=t[i],n[i]!==void 0){const l=r[i];l===h_?a+=vl(n[i]):l===m_?a+=Xt.transform(n[i]):a+=n[i]}return a}}const n3=e=>typeof e=="number"?0:Xt.test(e)?Xt.getAnimatableNone(e):e;function a3(e){const t=p_(e);return x_(e)(t.map(n3))}const ca={test:e3,parse:p_,createTransformer:x_,getAnimatableNone:a3};function af(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+(t-e)*6*r:r<1/2?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function i3({hue:e,saturation:t,lightness:r,alpha:s}){e/=360,t/=100,r/=100;let n=0,a=0,i=0;if(!t)n=a=i=r;else{const l=r<.5?r*(1+t):r+t-r*t,c=2*r-l;n=af(c,l,e+1/3),a=af(c,l,e),i=af(c,l,e-1/3)}return{red:Math.round(n*255),green:Math.round(a*255),blue:Math.round(i*255),alpha:s}}function vd(e,t){return r=>r>0?t:e}const Et=(e,t,r)=>e+(t-e)*r,of=(e,t,r)=>{const s=e*e,n=r*(t*t-s)+s;return n<0?0:Math.sqrt(n)},o3=[Bh,Ma,Vi],l3=e=>o3.find(t=>t.test(e));function Cv(e){const t=l3(e);if(!t)return!1;let r=t.parse(e);return t===Vi&&(r=i3(r)),r}const Av=(e,t)=>{const r=Cv(e),s=Cv(t);if(!r||!s)return vd(e,t);const n={...r};return a=>(n.red=of(r.red,s.red,a),n.green=of(r.green,s.green,a),n.blue=of(r.blue,s.blue,a),n.alpha=Et(r.alpha,s.alpha,a),Ma.transform(n))},Uh=new Set(["none","hidden"]);function c3(e,t){return Uh.has(e)?r=>r<=0?e:t:r=>r>=1?t:e}function u3(e,t){return r=>Et(e,t,r)}function Wp(e){return typeof e=="number"?u3:typeof e=="string"?$p(e)?vd:Xt.test(e)?Av:h3:Array.isArray(e)?g_:typeof e=="object"?Xt.test(e)?Av:d3:vd}function g_(e,t){const r=[...e],s=r.length,n=e.map((a,i)=>Wp(a)(a,t[i]));return a=>{for(let i=0;i<s;i++)r[i]=n[i](a);return r}}function d3(e,t){const r={...e,...t},s={};for(const n in r)e[n]!==void 0&&t[n]!==void 0&&(s[n]=Wp(e[n])(e[n],t[n]));return n=>{for(const a in s)r[a]=s[a](n);return r}}function f3(e,t){const r=[],s={color:0,var:0,number:0};for(let n=0;n<t.values.length;n++){const a=t.types[n],i=e.indexes[a][s[a]],l=e.values[i]??0;r[n]=l,s[a]++}return r}const h3=(e,t)=>{const r=ca.createTransformer(t),s=Ql(e),n=Ql(t);return s.indexes.var.length===n.indexes.var.length&&s.indexes.color.length===n.indexes.color.length&&s.indexes.number.length>=n.indexes.number.length?Uh.has(e)&&!n.values.length||Uh.has(t)&&!s.values.length?c3(e,t):Nc(g_(f3(s,n),n.values),r):vd(e,t)};function v_(e,t,r){return typeof e=="number"&&typeof t=="number"&&typeof r=="number"?Et(e,t,r):Wp(e)(e,t)}const m3=e=>{const t=({timestamp:r})=>e(r);return{start:(r=!0)=>wt.update(t,r),stop:()=>la(t),now:()=>ur.isProcessing?ur.timestamp:qr.now()}},y_=(e,t,r=10)=>{let s="";const n=Math.max(Math.round(t/r),2);for(let a=0;a<n;a++)s+=Math.round(e(a/(n-1))*1e4)/1e4+", ";return`linear(${s.substring(0,s.length-2)})`},yd=2e4;function Hp(e){let t=0;const r=50;let s=e.next(t);for(;!s.done&&t<yd;)t+=r,s=e.next(t);return t>=yd?1/0:t}function p3(e,t=100,r){const s=r({...e,keyframes:[0,t]}),n=Math.min(Hp(s),yd);return{type:"keyframes",ease:a=>s.next(n*a).value/t,duration:Cs(n)}}const x3=5;function w_(e,t,r){const s=Math.max(t-x3,0);return Zb(r-e(s),t-s)}const Pt={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},lf=.001;function g3({duration:e=Pt.duration,bounce:t=Pt.bounce,velocity:r=Pt.velocity,mass:s=Pt.mass}){let n,a,i=1-t;i=Fn(Pt.minDamping,Pt.maxDamping,i),e=Fn(Pt.minDuration,Pt.maxDuration,Cs(e)),i<1?(n=u=>{const d=u*i,f=d*e,h=d-r,p=$h(u,i),m=Math.exp(-f);return lf-h/p*m},a=u=>{const f=u*i*e,h=f*r+r,p=Math.pow(i,2)*Math.pow(u,2)*e,m=Math.exp(-f),x=$h(Math.pow(u,2),i);return(-n(u)+lf>0?-1:1)*((h-p)*m)/x}):(n=u=>{const d=Math.exp(-u*e),f=(u-r)*e+1;return-lf+d*f},a=u=>{const d=Math.exp(-u*e),f=(r-u)*(e*e);return d*f});const l=5/e,c=y3(n,a,l);if(e=un(e),isNaN(c))return{stiffness:Pt.stiffness,damping:Pt.damping,duration:e};{const u=Math.pow(c,2)*s;return{stiffness:u,damping:i*2*Math.sqrt(s*u),duration:e}}}const v3=12;function y3(e,t,r){let s=r;for(let n=1;n<v3;n++)s=s-e(s)/t(s);return s}function $h(e,t){return e*Math.sqrt(1-t*t)}const w3=["duration","bounce"],b3=["stiffness","damping","mass"];function Fv(e,t){return t.some(r=>e[r]!==void 0)}function _3(e){let t={velocity:Pt.velocity,stiffness:Pt.stiffness,damping:Pt.damping,mass:Pt.mass,isResolvedFromDuration:!1,...e};if(!Fv(e,b3)&&Fv(e,w3))if(e.visualDuration){const r=e.visualDuration,s=2*Math.PI/(r*1.2),n=s*s,a=2*Fn(.05,1,1-(e.bounce||0))*Math.sqrt(n);t={...t,mass:Pt.mass,stiffness:n,damping:a}}else{const r=g3(e);t={...t,...r,mass:Pt.mass},t.isResolvedFromDuration=!0}return t}function wd(e=Pt.visualDuration,t=Pt.bounce){const r=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:s,restDelta:n}=r;const a=r.keyframes[0],i=r.keyframes[r.keyframes.length-1],l={done:!1,value:a},{stiffness:c,damping:u,mass:d,duration:f,velocity:h,isResolvedFromDuration:p}=_3({...r,velocity:-Cs(r.velocity||0)}),m=h||0,x=u/(2*Math.sqrt(c*d)),g=i-a,y=Cs(Math.sqrt(c/d)),w=Math.abs(g)<5;s||(s=w?Pt.restSpeed.granular:Pt.restSpeed.default),n||(n=w?Pt.restDelta.granular:Pt.restDelta.default);let v;if(x<1){const _=$h(y,x);v=k=>{const S=Math.exp(-x*y*k);return i-S*((m+x*y*g)/_*Math.sin(_*k)+g*Math.cos(_*k))}}else if(x===1)v=_=>i-Math.exp(-y*_)*(g+(m+y*g)*_);else{const _=y*Math.sqrt(x*x-1);v=k=>{const S=Math.exp(-x*y*k),E=Math.min(_*k,300);return i-S*((m+x*y*g)*Math.sinh(E)+_*g*Math.cosh(E))/_}}const b={calculatedDuration:p&&f||null,next:_=>{const k=v(_);if(p)l.done=_>=f;else{let S=_===0?m:0;x<1&&(S=_===0?un(m):w_(v,_,k));const E=Math.abs(S)<=s,C=Math.abs(i-k)<=n;l.done=E&&C}return l.value=l.done?i:k,l},toString:()=>{const _=Math.min(Hp(b),yd),k=y_(S=>b.next(_*S).value,_,30);return _+"ms "+k},toTransition:()=>{}};return b}wd.applyToOptions=e=>{const t=p3(e,100,wd);return e.ease=t.ease,e.duration=un(t.duration),e.type="keyframes",e};function zh({keyframes:e,velocity:t=0,power:r=.8,timeConstant:s=325,bounceDamping:n=10,bounceStiffness:a=500,modifyTarget:i,min:l,max:c,restDelta:u=.5,restSpeed:d}){const f=e[0],h={done:!1,value:f},p=E=>l!==void 0&&E<l||c!==void 0&&E>c,m=E=>l===void 0?c:c===void 0||Math.abs(l-E)<Math.abs(c-E)?l:c;let x=r*t;const g=f+x,y=i===void 0?g:i(g);y!==g&&(x=y-f);const w=E=>-x*Math.exp(-E/s),v=E=>y+w(E),b=E=>{const C=w(E),U=v(E);h.done=Math.abs(C)<=u,h.value=h.done?y:U};let _,k;const S=E=>{p(h.value)&&(_=E,k=wd({keyframes:[h.value,m(h.value)],velocity:w_(v,E,h.value),damping:n,stiffness:a,restDelta:u,restSpeed:d}))};return S(0),{calculatedDuration:null,next:E=>{let C=!1;return!k&&_===void 0&&(C=!0,b(E),S(E)),_!==void 0&&E>=_?k.next(E-_):(!C&&b(E),h)}}}function S3(e,t,r){const s=[],n=r||Pn.mix||v_,a=e.length-1;for(let i=0;i<a;i++){let l=n(e[i],e[i+1]);if(t){const c=Array.isArray(t)?t[i]||Fs:t;l=Nc(c,l)}s.push(l)}return s}function k3(e,t,{clamp:r=!0,ease:s,mixer:n}={}){const a=e.length;if(Op(a===t.length),a===1)return()=>t[0];if(a===2&&t[0]===t[1])return()=>t[1];const i=e[0]===e[1];e[0]>e[a-1]&&(e=[...e].reverse(),t=[...t].reverse());const l=S3(t,s,n),c=l.length,u=d=>{if(i&&d<e[0])return t[0];let f=0;if(c>1)for(;f<e.length-2&&!(d<e[f+1]);f++);const h=Yl(e[f],e[f+1],d);return l[f](h)};return r?d=>u(Fn(e[0],e[a-1],d)):u}function N3(e,t){const r=e[e.length-1];for(let s=1;s<=t;s++){const n=Yl(0,t,s);e.push(Et(r,1,n))}}function j3(e){const t=[0];return N3(t,e.length-1),t}function E3(e,t){return e.map(r=>r*t)}function T3(e,t){return e.map(()=>t||l_).splice(0,e.length-1)}function yl({duration:e=300,keyframes:t,times:r,ease:s="easeInOut"}){const n=B4(s)?s.map(jv):jv(s),a={done:!1,value:t[0]},i=E3(r&&r.length===t.length?r:j3(t),e),l=k3(i,t,{ease:Array.isArray(n)?n:T3(t,n)});return{calculatedDuration:e,next:c=>(a.value=l(c),a.done=c>=e,a)}}const C3=e=>e!==null;function qp(e,{repeat:t,repeatType:r="loop"},s,n=1){const a=e.filter(C3),l=n<0||t&&r!=="loop"&&t%2===1?0:a.length-1;return!l||s===void 0?a[l]:s}const A3={decay:zh,inertia:zh,tween:yl,keyframes:yl,spring:wd};function b_(e){typeof e.type=="string"&&(e.type=A3[e.type])}class Gp{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(t=>{this.resolve=t})}notifyFinished(){this.resolve()}then(t,r){return this.finished.then(t,r)}}const F3=e=>e/100;class Kp extends Gp{constructor(t){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var s,n;const{motionValue:r}=this.options;r&&r.updatedAt!==qr.now()&&this.tick(qr.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),(n=(s=this.options).onStop)==null||n.call(s))},this.options=t,this.initAnimation(),this.play(),t.autoplay===!1&&this.pause()}initAnimation(){const{options:t}=this;b_(t);const{type:r=yl,repeat:s=0,repeatDelay:n=0,repeatType:a,velocity:i=0}=t;let{keyframes:l}=t;const c=r||yl;c!==yl&&typeof l[0]!="number"&&(this.mixKeyframes=Nc(F3,v_(l[0],l[1])),l=[0,100]);const u=c({...t,keyframes:l});a==="mirror"&&(this.mirroredGenerator=c({...t,keyframes:[...l].reverse(),velocity:-i})),u.calculatedDuration===null&&(u.calculatedDuration=Hp(u));const{calculatedDuration:d}=u;this.calculatedDuration=d,this.resolvedDuration=d+n,this.totalDuration=this.resolvedDuration*(s+1)-n,this.generator=u}updateTime(t){const r=Math.round(t-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=r}tick(t,r=!1){const{generator:s,totalDuration:n,mixKeyframes:a,mirroredGenerator:i,resolvedDuration:l,calculatedDuration:c}=this;if(this.startTime===null)return s.next(0);const{delay:u=0,keyframes:d,repeat:f,repeatType:h,repeatDelay:p,type:m,onUpdate:x,finalKeyframe:g}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-n/this.speed,this.startTime)),r?this.currentTime=t:this.updateTime(t);const y=this.currentTime-u*(this.playbackSpeed>=0?1:-1),w=this.playbackSpeed>=0?y<0:y>n;this.currentTime=Math.max(y,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=n);let v=this.currentTime,b=s;if(f){const E=Math.min(this.currentTime,n)/l;let C=Math.floor(E),U=E%1;!U&&E>=1&&(U=1),U===1&&C--,C=Math.min(C,f+1),!!(C%2)&&(h==="reverse"?(U=1-U,p&&(U-=p/l)):h==="mirror"&&(b=i)),v=Fn(0,1,U)*l}const _=w?{done:!1,value:d[0]}:b.next(v);a&&(_.value=a(_.value));let{done:k}=_;!w&&c!==null&&(k=this.playbackSpeed>=0?this.currentTime>=n:this.currentTime<=0);const S=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&k);return S&&m!==zh&&(_.value=qp(d,this.options,g,this.speed)),x&&x(_.value),S&&this.finish(),_}then(t,r){return this.finished.then(t,r)}get duration(){return Cs(this.calculatedDuration)}get iterationDuration(){const{delay:t=0}=this.options||{};return this.duration+Cs(t)}get time(){return Cs(this.currentTime)}set time(t){var r;t=un(t),this.currentTime=t,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.playbackSpeed),(r=this.driver)==null||r.start(!1)}get speed(){return this.playbackSpeed}set speed(t){this.updateTime(qr.now());const r=this.playbackSpeed!==t;this.playbackSpeed=t,r&&(this.time=Cs(this.currentTime))}play(){var n,a;if(this.isStopped)return;const{driver:t=m3,startTime:r}=this.options;this.driver||(this.driver=t(i=>this.tick(i))),(a=(n=this.options).onPlay)==null||a.call(n);const s=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=s):this.holdTime!==null?this.startTime=s-this.holdTime:this.startTime||(this.startTime=r??s),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(qr.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){var t,r;this.notifyFinished(),this.teardown(),this.state="finished",(r=(t=this.options).onComplete)==null||r.call(t)}cancel(){var t,r;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),(r=(t=this.options).onCancel)==null||r.call(t)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}attachTimeline(t){var r;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),(r=this.driver)==null||r.stop(),t.observe(this)}}function P3(e){for(let t=1;t<e.length;t++)e[t]??(e[t]=e[t-1])}const Ba=e=>e*180/Math.PI,Vh=e=>{const t=Ba(Math.atan2(e[1],e[0]));return Wh(t)},R3={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:Vh,rotateZ:Vh,skewX:e=>Ba(Math.atan(e[1])),skewY:e=>Ba(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},Wh=e=>(e=e%360,e<0&&(e+=360),e),Pv=Vh,Rv=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),Iv=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),I3={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:Rv,scaleY:Iv,scale:e=>(Rv(e)+Iv(e))/2,rotateX:e=>Wh(Ba(Math.atan2(e[6],e[5]))),rotateY:e=>Wh(Ba(Math.atan2(-e[2],e[0]))),rotateZ:Pv,rotate:Pv,skewX:e=>Ba(Math.atan(e[4])),skewY:e=>Ba(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function Hh(e){return e.includes("scale")?1:0}function qh(e,t){if(!e||e==="none")return Hh(t);const r=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let s,n;if(r)s=I3,n=r;else{const l=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);s=R3,n=l}if(!n)return Hh(t);const a=s[t],i=n[1].split(",").map(D3);return typeof a=="function"?a(i):i[a]}const O3=(e,t)=>{const{transform:r="none"}=getComputedStyle(e);return qh(r,t)};function D3(e){return parseFloat(e.trim())}const Ao=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Fo=new Set(Ao),Ov=e=>e===Co||e===$e,L3=new Set(["x","y","z"]),M3=Ao.filter(e=>!L3.has(e));function B3(e){const t=[];return M3.forEach(r=>{const s=e.getValue(r);s!==void 0&&(t.push([r,s.get()]),s.set(r.startsWith("scale")?1:0))}),t}const Wa={width:({x:e},{paddingLeft:t="0",paddingRight:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),height:({y:e},{paddingTop:t="0",paddingBottom:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:(e,{transform:t})=>qh(t,"x"),y:(e,{transform:t})=>qh(t,"y")};Wa.translateX=Wa.x;Wa.translateY=Wa.y;const Ha=new Set;let Gh=!1,Kh=!1,Xh=!1;function __(){if(Kh){const e=Array.from(Ha).filter(s=>s.needsMeasurement),t=new Set(e.map(s=>s.element)),r=new Map;t.forEach(s=>{const n=B3(s);n.length&&(r.set(s,n),s.render())}),e.forEach(s=>s.measureInitialState()),t.forEach(s=>{s.render();const n=r.get(s);n&&n.forEach(([a,i])=>{var l;(l=s.getValue(a))==null||l.set(i)})}),e.forEach(s=>s.measureEndState()),e.forEach(s=>{s.suspendedScrollY!==void 0&&window.scrollTo(0,s.suspendedScrollY)})}Kh=!1,Gh=!1,Ha.forEach(e=>e.complete(Xh)),Ha.clear()}function S_(){Ha.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(Kh=!0)})}function U3(){Xh=!0,S_(),__(),Xh=!1}class Xp{constructor(t,r,s,n,a,i=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...t],this.onComplete=r,this.name=s,this.motionValue=n,this.element=a,this.isAsync=i}scheduleResolve(){this.state="scheduled",this.isAsync?(Ha.add(this),Gh||(Gh=!0,wt.read(S_),wt.resolveKeyframes(__))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:r,element:s,motionValue:n}=this;if(t[0]===null){const a=n==null?void 0:n.get(),i=t[t.length-1];if(a!==void 0)t[0]=a;else if(s&&r){const l=s.readValue(r,i);l!=null&&(t[0]=l)}t[0]===void 0&&(t[0]=i),n&&a===void 0&&n.set(t[0])}P3(t)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(t=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,t),Ha.delete(this)}cancel(){this.state==="scheduled"&&(Ha.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const $3=e=>e.startsWith("--");function z3(e,t,r){$3(t)?e.style.setProperty(t,r):e.style[t]=r}const V3=Dp(()=>window.ScrollTimeline!==void 0),W3={};function H3(e,t){const r=Dp(e);return()=>W3[t]??r()}const k_=H3(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),nl=([e,t,r,s])=>`cubic-bezier(${e}, ${t}, ${r}, ${s})`,Dv={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:nl([0,.65,.55,1]),circOut:nl([.55,0,1,.45]),backIn:nl([.31,.01,.66,-.59]),backOut:nl([.33,1.53,.69,.99])};function N_(e,t){if(e)return typeof e=="function"?k_()?y_(e,t):"ease-out":c_(e)?nl(e):Array.isArray(e)?e.map(r=>N_(r,t)||Dv.easeOut):Dv[e]}function q3(e,t,r,{delay:s=0,duration:n=300,repeat:a=0,repeatType:i="loop",ease:l="easeOut",times:c}={},u=void 0){const d={[t]:r};c&&(d.offset=c);const f=N_(l,n);Array.isArray(f)&&(d.easing=f);const h={delay:s,duration:n,easing:Array.isArray(f)?"linear":f,fill:"both",iterations:a+1,direction:i==="reverse"?"alternate":"normal"};return u&&(h.pseudoElement=u),e.animate(d,h)}function j_(e){return typeof e=="function"&&"applyToOptions"in e}function G3({type:e,...t}){return j_(e)&&k_()?e.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}class K3 extends Gp{constructor(t){if(super(),this.finishedTime=null,this.isStopped=!1,!t)return;const{element:r,name:s,keyframes:n,pseudoElement:a,allowFlatten:i=!1,finalKeyframe:l,onComplete:c}=t;this.isPseudoElement=!!a,this.allowFlatten=i,this.options=t,Op(typeof t.type!="string");const u=G3(t);this.animation=q3(r,s,n,u,a),u.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!a){const d=qp(n,this.options,l,this.speed);this.updateMotionValue?this.updateMotionValue(d):z3(r,s,d),this.animation.cancel()}c==null||c(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var t,r;(r=(t=this.animation).finish)==null||r.call(t)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:t}=this;t==="idle"||t==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var t,r;this.isPseudoElement||(r=(t=this.animation).commitStyles)==null||r.call(t)}get duration(){var r,s;const t=((s=(r=this.animation.effect)==null?void 0:r.getComputedTiming)==null?void 0:s.call(r).duration)||0;return Cs(Number(t))}get iterationDuration(){const{delay:t=0}=this.options||{};return this.duration+Cs(t)}get time(){return Cs(Number(this.animation.currentTime)||0)}set time(t){this.finishedTime=null,this.animation.currentTime=un(t)}get speed(){return this.animation.playbackRate}set speed(t){t<0&&(this.finishedTime=null),this.animation.playbackRate=t}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(t){this.animation.startTime=t}attachTimeline({timeline:t,observe:r}){var s;return this.allowFlatten&&((s=this.animation.effect)==null||s.updateTiming({easing:"linear"})),this.animation.onfinish=null,t&&V3()?(this.animation.timeline=t,Fs):r(this)}}const E_={anticipate:a_,backInOut:n_,circInOut:o_};function X3(e){return e in E_}function Y3(e){typeof e.ease=="string"&&X3(e.ease)&&(e.ease=E_[e.ease])}const Lv=10;class J3 extends K3{constructor(t){Y3(t),b_(t),super(t),t.startTime&&(this.startTime=t.startTime),this.options=t}updateMotionValue(t){const{motionValue:r,onUpdate:s,onComplete:n,element:a,...i}=this.options;if(!r)return;if(t!==void 0){r.set(t);return}const l=new Kp({...i,autoplay:!1}),c=un(this.finishedTime??this.time);r.setWithVelocity(l.sample(c-Lv).value,l.sample(c).value,Lv),l.stop()}}const Mv=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(ca.test(e)||e==="0")&&!e.startsWith("url("));function Q3(e){const t=e[0];if(e.length===1)return!0;for(let r=0;r<e.length;r++)if(e[r]!==t)return!0}function Z3(e,t,r,s){const n=e[0];if(n===null)return!1;if(t==="display"||t==="visibility")return!0;const a=e[e.length-1],i=Mv(n,t),l=Mv(a,t);return!i||!l?!1:Q3(e)||(r==="spring"||j_(r))&&s}function Yh(e){e.duration=0,e.type="keyframes"}const eC=new Set(["opacity","clipPath","filter","transform"]),tC=Dp(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function rC(e){var d;const{motionValue:t,name:r,repeatDelay:s,repeatType:n,damping:a,type:i}=e;if(!(((d=t==null?void 0:t.owner)==null?void 0:d.current)instanceof HTMLElement))return!1;const{onUpdate:c,transformTemplate:u}=t.owner.getProps();return tC()&&r&&eC.has(r)&&(r!=="transform"||!u)&&!c&&!s&&n!=="mirror"&&a!==0&&i!=="inertia"}const sC=40;class nC extends Gp{constructor({autoplay:t=!0,delay:r=0,type:s="keyframes",repeat:n=0,repeatDelay:a=0,repeatType:i="loop",keyframes:l,name:c,motionValue:u,element:d,...f}){var m;super(),this.stop=()=>{var x,g;this._animation&&(this._animation.stop(),(x=this.stopTimeline)==null||x.call(this)),(g=this.keyframeResolver)==null||g.cancel()},this.createdAt=qr.now();const h={autoplay:t,delay:r,type:s,repeat:n,repeatDelay:a,repeatType:i,name:c,motionValue:u,element:d,...f},p=(d==null?void 0:d.KeyframeResolver)||Xp;this.keyframeResolver=new p(l,(x,g,y)=>this.onKeyframesResolved(x,g,h,!y),c,u,d),(m=this.keyframeResolver)==null||m.scheduleResolve()}onKeyframesResolved(t,r,s,n){this.keyframeResolver=void 0;const{name:a,type:i,velocity:l,delay:c,isHandoff:u,onUpdate:d}=s;this.resolvedAt=qr.now(),Z3(t,a,i,l)||((Pn.instantAnimations||!c)&&(d==null||d(qp(t,s,r))),t[0]=t[t.length-1],Yh(s),s.repeat=0);const h={startTime:n?this.resolvedAt?this.resolvedAt-this.createdAt>sC?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:r,...s,keyframes:t},p=!u&&rC(h)?new J3({...h,element:h.motionValue.owner.current}):new Kp(h);p.finished.then(()=>this.notifyFinished()).catch(Fs),this.pendingTimeline&&(this.stopTimeline=p.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=p}get finished(){return this._animation?this.animation.finished:this._finished}then(t,r){return this.finished.finally(t).then(()=>{})}get animation(){var t;return this._animation||((t=this.keyframeResolver)==null||t.resume(),U3()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(t){this.animation.time=t}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(t){this.animation.speed=t}get startTime(){return this.animation.startTime}attachTimeline(t){return this._animation?this.stopTimeline=this.animation.attachTimeline(t):this.pendingTimeline=t,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var t;this._animation&&this.animation.cancel(),(t=this.keyframeResolver)==null||t.cancel()}}const aC=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function iC(e){const t=aC.exec(e);if(!t)return[,];const[,r,s,n]=t;return[`--${r??s}`,n]}function T_(e,t,r=1){const[s,n]=iC(e);if(!s)return;const a=window.getComputedStyle(t).getPropertyValue(s);if(a){const i=a.trim();return Yb(i)?parseFloat(i):i}return $p(n)?T_(n,t,r+1):n}function Yp(e,t){return(e==null?void 0:e[t])??(e==null?void 0:e.default)??e}const C_=new Set(["width","height","top","left","right","bottom",...Ao]),oC={test:e=>e==="auto",parse:e=>e},A_=e=>t=>t.test(e),F_=[Co,$e,dn,zn,Q4,J4,oC],Bv=e=>F_.find(A_(e));function lC(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||Qb(e):!0}const cC=new Set(["brightness","contrast","saturate","opacity"]);function uC(e){const[t,r]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[s]=r.match(zp)||[];if(!s)return e;const n=r.replace(s,"");let a=cC.has(t)?1:0;return s!==r&&(a*=100),t+"("+a+n+")"}const dC=/\b([a-z-]*)\(.*?\)/gu,Jh={...ca,getAnimatableNone:e=>{const t=e.match(dC);return t?t.map(uC).join(" "):e}},Uv={...Co,transform:Math.round},fC={rotate:zn,rotateX:zn,rotateY:zn,rotateZ:zn,scale:lu,scaleX:lu,scaleY:lu,scaleZ:lu,skew:zn,skewX:zn,skewY:zn,distance:$e,translateX:$e,translateY:$e,translateZ:$e,x:$e,y:$e,z:$e,perspective:$e,transformPerspective:$e,opacity:Jl,originX:Ev,originY:Ev,originZ:$e},Jp={borderWidth:$e,borderTopWidth:$e,borderRightWidth:$e,borderBottomWidth:$e,borderLeftWidth:$e,borderRadius:$e,radius:$e,borderTopLeftRadius:$e,borderTopRightRadius:$e,borderBottomRightRadius:$e,borderBottomLeftRadius:$e,width:$e,maxWidth:$e,height:$e,maxHeight:$e,top:$e,right:$e,bottom:$e,left:$e,padding:$e,paddingTop:$e,paddingRight:$e,paddingBottom:$e,paddingLeft:$e,margin:$e,marginTop:$e,marginRight:$e,marginBottom:$e,marginLeft:$e,backgroundPositionX:$e,backgroundPositionY:$e,...fC,zIndex:Uv,fillOpacity:Jl,strokeOpacity:Jl,numOctaves:Uv},hC={...Jp,color:Xt,backgroundColor:Xt,outlineColor:Xt,fill:Xt,stroke:Xt,borderColor:Xt,borderTopColor:Xt,borderRightColor:Xt,borderBottomColor:Xt,borderLeftColor:Xt,filter:Jh,WebkitFilter:Jh},P_=e=>hC[e];function R_(e,t){let r=P_(e);return r!==Jh&&(r=ca),r.getAnimatableNone?r.getAnimatableNone(t):void 0}const mC=new Set(["auto","none","0"]);function pC(e,t,r){let s=0,n;for(;s<e.length&&!n;){const a=e[s];typeof a=="string"&&!mC.has(a)&&Ql(a).values.length&&(n=e[s]),s++}if(n&&r)for(const a of t)e[a]=R_(r,n)}class xC extends Xp{constructor(t,r,s,n,a){super(t,r,s,n,a,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:r,name:s}=this;if(!r||!r.current)return;super.readKeyframes();for(let c=0;c<t.length;c++){let u=t[c];if(typeof u=="string"&&(u=u.trim(),$p(u))){const d=T_(u,r.current);d!==void 0&&(t[c]=d),c===t.length-1&&(this.finalKeyframe=u)}}if(this.resolveNoneKeyframes(),!C_.has(s)||t.length!==2)return;const[n,a]=t,i=Bv(n),l=Bv(a);if(i!==l)if(Ov(i)&&Ov(l))for(let c=0;c<t.length;c++){const u=t[c];typeof u=="string"&&(t[c]=parseFloat(u))}else Wa[s]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:r}=this,s=[];for(let n=0;n<t.length;n++)(t[n]===null||lC(t[n]))&&s.push(n);s.length&&pC(t,s,r)}measureInitialState(){const{element:t,unresolvedKeyframes:r,name:s}=this;if(!t||!t.current)return;s==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Wa[s](t.measureViewportBox(),window.getComputedStyle(t.current)),r[0]=this.measuredOrigin;const n=r[r.length-1];n!==void 0&&t.getValue(s,n).jump(n,!1)}measureEndState(){var l;const{element:t,name:r,unresolvedKeyframes:s}=this;if(!t||!t.current)return;const n=t.getValue(r);n&&n.jump(this.measuredOrigin,!1);const a=s.length-1,i=s[a];s[a]=Wa[r](t.measureViewportBox(),window.getComputedStyle(t.current)),i!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=i),(l=this.removedTransforms)!=null&&l.length&&this.removedTransforms.forEach(([c,u])=>{t.getValue(c).set(u)}),this.resolveNoneKeyframes()}}function gC(e,t,r){if(e instanceof EventTarget)return[e];if(typeof e=="string"){let s=document;const n=(r==null?void 0:r[e])??s.querySelectorAll(e);return n?Array.from(n):[]}return Array.from(e)}const I_=(e,t)=>t&&typeof e=="number"?t.transform(e):e;function O_(e){return Jb(e)&&"offsetHeight"in e}const $v=30,vC=e=>!isNaN(parseFloat(e));class yC{constructor(t,r={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=s=>{var a;const n=qr.now();if(this.updatedAt!==n&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(s),this.current!==this.prev&&((a=this.events.change)==null||a.notify(this.current),this.dependents))for(const i of this.dependents)i.dirty()},this.hasAnimated=!1,this.setCurrent(t),this.owner=r.owner}setCurrent(t){this.current=t,this.updatedAt=qr.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=vC(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,r){this.events[t]||(this.events[t]=new Lp);const s=this.events[t].add(r);return t==="change"?()=>{s(),wt.read(()=>{this.events.change.getSize()||this.stop()})}:s}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,r){this.passiveEffect=t,this.stopPassiveEffect=r}set(t){this.passiveEffect?this.passiveEffect(t,this.updateAndNotify):this.updateAndNotify(t)}setWithVelocity(t,r,s){this.set(r),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-s}jump(t,r=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,r&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var t;(t=this.events.change)==null||t.notify(this.current)}addDependent(t){this.dependents||(this.dependents=new Set),this.dependents.add(t)}removeDependent(t){this.dependents&&this.dependents.delete(t)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=qr.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>$v)return 0;const r=Math.min(this.updatedAt-this.prevUpdatedAt,$v);return Zb(parseFloat(this.current)-parseFloat(this.prevFrameValue),r)}start(t){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=t(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var t,r;(t=this.dependents)==null||t.clear(),(r=this.events.destroy)==null||r.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function xo(e,t){return new yC(e,t)}const{schedule:Qp}=u_(queueMicrotask,!1),Us={x:!1,y:!1};function D_(){return Us.x||Us.y}function wC(e){return e==="x"||e==="y"?Us[e]?null:(Us[e]=!0,()=>{Us[e]=!1}):Us.x||Us.y?null:(Us.x=Us.y=!0,()=>{Us.x=Us.y=!1})}function L_(e,t){const r=gC(e),s=new AbortController,n={passive:!0,...t,signal:s.signal};return[r,n,()=>s.abort()]}function zv(e){return!(e.pointerType==="touch"||D_())}function bC(e,t,r={}){const[s,n,a]=L_(e,r),i=l=>{if(!zv(l))return;const{target:c}=l,u=t(c,l);if(typeof u!="function"||!c)return;const d=f=>{zv(f)&&(u(f),c.removeEventListener("pointerleave",d))};c.addEventListener("pointerleave",d,n)};return s.forEach(l=>{l.addEventListener("pointerenter",i,n)}),a}const M_=(e,t)=>t?e===t?!0:M_(e,t.parentElement):!1,Zp=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1,_C=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function SC(e){return _C.has(e.tagName)||e.tabIndex!==-1}const Wu=new WeakSet;function Vv(e){return t=>{t.key==="Enter"&&e(t)}}function cf(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const kC=(e,t)=>{const r=e.currentTarget;if(!r)return;const s=Vv(()=>{if(Wu.has(r))return;cf(r,"down");const n=Vv(()=>{cf(r,"up")}),a=()=>cf(r,"cancel");r.addEventListener("keyup",n,t),r.addEventListener("blur",a,t)});r.addEventListener("keydown",s,t),r.addEventListener("blur",()=>r.removeEventListener("keydown",s),t)};function Wv(e){return Zp(e)&&!D_()}function NC(e,t,r={}){const[s,n,a]=L_(e,r),i=l=>{const c=l.currentTarget;if(!Wv(l))return;Wu.add(c);const u=t(c,l),d=(p,m)=>{window.removeEventListener("pointerup",f),window.removeEventListener("pointercancel",h),Wu.has(c)&&Wu.delete(c),Wv(p)&&typeof u=="function"&&u(p,{success:m})},f=p=>{d(p,c===window||c===document||r.useGlobalTarget||M_(c,p.target))},h=p=>{d(p,!1)};window.addEventListener("pointerup",f,n),window.addEventListener("pointercancel",h,n)};return s.forEach(l=>{(r.useGlobalTarget?window:l).addEventListener("pointerdown",i,n),O_(l)&&(l.addEventListener("focus",u=>kC(u,n)),!SC(l)&&!l.hasAttribute("tabindex")&&(l.tabIndex=0))}),a}function B_(e){return Jb(e)&&"ownerSVGElement"in e}function jC(e){return B_(e)&&e.tagName==="svg"}const jr=e=>!!(e&&e.getVelocity),EC=[...F_,Xt,ca],TC=e=>EC.find(A_(e)),ex=T.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});function Hv(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function CC(...e){return t=>{let r=!1;const s=e.map(n=>{const a=Hv(n,t);return!r&&typeof a=="function"&&(r=!0),a});if(r)return()=>{for(let n=0;n<s.length;n++){const a=s[n];typeof a=="function"?a():Hv(e[n],null)}}}}function AC(...e){return T.useCallback(CC(...e),e)}class FC extends T.Component{getSnapshotBeforeUpdate(t){const r=this.props.childRef.current;if(r&&t.isPresent&&!this.props.isPresent){const s=r.offsetParent,n=O_(s)&&s.offsetWidth||0,a=this.props.sizeRef.current;a.height=r.offsetHeight||0,a.width=r.offsetWidth||0,a.top=r.offsetTop,a.left=r.offsetLeft,a.right=n-a.width-a.left}return null}componentDidUpdate(){}render(){return this.props.children}}function PC({children:e,isPresent:t,anchorX:r,root:s}){const n=T.useId(),a=T.useRef(null),i=T.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:l}=T.useContext(ex),c=AC(a,e==null?void 0:e.ref);return T.useInsertionEffect(()=>{const{width:u,height:d,top:f,left:h,right:p}=i.current;if(t||!a.current||!u||!d)return;const m=r==="left"?`left: ${h}`:`right: ${p}`;a.current.dataset.motionPopId=n;const x=document.createElement("style");l&&(x.nonce=l);const g=s??document.head;return g.appendChild(x),x.sheet&&x.sheet.insertRule(`
          [data-motion-pop-id="${n}"] {
            position: absolute !important;
            width: ${u}px !important;
            height: ${d}px !important;
            ${m}px !important;
            top: ${f}px !important;
          }
        `),()=>{g.contains(x)&&g.removeChild(x)}},[t]),o.jsx(FC,{isPresent:t,childRef:a,sizeRef:i,children:T.cloneElement(e,{ref:c})})}const RC=({children:e,initial:t,isPresent:r,onExitComplete:s,custom:n,presenceAffectsLayout:a,mode:i,anchorX:l,root:c})=>{const u=Fp(IC),d=T.useId();let f=!0,h=T.useMemo(()=>(f=!1,{id:d,initial:t,isPresent:r,custom:n,onExitComplete:p=>{u.set(p,!0);for(const m of u.values())if(!m)return;s&&s()},register:p=>(u.set(p,!1),()=>u.delete(p))}),[r,u,s]);return a&&f&&(h={...h}),T.useMemo(()=>{u.forEach((p,m)=>u.set(m,!1))},[r]),T.useEffect(()=>{!r&&!u.size&&s&&s()},[r]),i==="popLayout"&&(e=o.jsx(PC,{isPresent:r,anchorX:l,root:c,children:e})),o.jsx(o0.Provider,{value:h,children:e})};function IC(){return new Map}function U_(e=!0){const t=T.useContext(o0);if(t===null)return[!0,null];const{isPresent:r,onExitComplete:s,register:n}=t,a=T.useId();T.useEffect(()=>{if(e)return n(a)},[e]);const i=T.useCallback(()=>e&&s&&s(a),[a,s,e]);return!r&&s?[!1,i]:[!0]}const cu=e=>e.key||"";function qv(e){const t=[];return T.Children.forEach(e,r=>{T.isValidElement(r)&&t.push(r)}),t}const tx=({children:e,custom:t,initial:r=!0,onExitComplete:s,presenceAffectsLayout:n=!0,mode:a="sync",propagate:i=!1,anchorX:l="left",root:c})=>{const[u,d]=U_(i),f=T.useMemo(()=>qv(e),[e]),h=i&&!u?[]:f.map(cu),p=T.useRef(!0),m=T.useRef(f),x=Fp(()=>new Map),[g,y]=T.useState(f),[w,v]=T.useState(f);Xb(()=>{p.current=!1,m.current=f;for(let k=0;k<w.length;k++){const S=cu(w[k]);h.includes(S)?x.delete(S):x.get(S)!==!0&&x.set(S,!1)}},[w,h.length,h.join("-")]);const b=[];if(f!==g){let k=[...f];for(let S=0;S<w.length;S++){const E=w[S],C=cu(E);h.includes(C)||(k.splice(S,0,E),b.push(E))}return a==="wait"&&b.length&&(k=b),v(qv(k)),y(f),null}const{forceRender:_}=T.useContext(Ap);return o.jsx(o.Fragment,{children:w.map(k=>{const S=cu(k),E=i&&!u?!1:f===w||h.includes(S),C=()=>{if(x.has(S))x.set(S,!0);else return;let U=!0;x.forEach(H=>{H||(U=!1)}),U&&(_==null||_(),v(m.current),i&&(d==null||d()),s&&s())};return o.jsx(RC,{isPresent:E,initial:!p.current||r?void 0:!1,custom:t,presenceAffectsLayout:n,mode:a,root:c,onExitComplete:E?void 0:C,anchorX:l,children:k},S)})})},$_=T.createContext({strict:!1}),Gv={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},go={};for(const e in Gv)go[e]={isEnabled:t=>Gv[e].some(r=>!!t[r])};function OC(e){for(const t in e)go[t]={...go[t],...e[t]}}const DC=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function bd(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||DC.has(e)}let z_=e=>!bd(e);function LC(e){typeof e=="function"&&(z_=t=>t.startsWith("on")?!bd(t):e(t))}try{LC(require("@emotion/is-prop-valid").default)}catch{}function MC(e,t,r){const s={};for(const n in e)n==="values"&&typeof e.values=="object"||(z_(n)||r===!0&&bd(n)||!t&&!bd(n)||e.draggable&&n.startsWith("onDrag"))&&(s[n]=e[n]);return s}const l0=T.createContext({});function c0(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}function Zl(e){return typeof e=="string"||Array.isArray(e)}const rx=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],sx=["initial",...rx];function u0(e){return c0(e.animate)||sx.some(t=>Zl(e[t]))}function V_(e){return!!(u0(e)||e.variants)}function BC(e,t){if(u0(e)){const{initial:r,animate:s}=e;return{initial:r===!1||Zl(r)?r:void 0,animate:Zl(s)?s:void 0}}return e.inherit!==!1?t:{}}function UC(e){const{initial:t,animate:r}=BC(e,T.useContext(l0));return T.useMemo(()=>({initial:t,animate:r}),[Kv(t),Kv(r)])}function Kv(e){return Array.isArray(e)?e.join(" "):e}const ec={};function $C(e){for(const t in e)ec[t]=e[t],Up(t)&&(ec[t].isCSSVariable=!0)}function W_(e,{layout:t,layoutId:r}){return Fo.has(e)||e.startsWith("origin")||(t||r!==void 0)&&(!!ec[e]||e==="opacity")}const zC={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},VC=Ao.length;function WC(e,t,r){let s="",n=!0;for(let a=0;a<VC;a++){const i=Ao[a],l=e[i];if(l===void 0)continue;let c=!0;if(typeof l=="number"?c=l===(i.startsWith("scale")?1:0):c=parseFloat(l)===0,!c||r){const u=I_(l,Jp[i]);if(!c){n=!1;const d=zC[i]||i;s+=`${d}(${u}) `}r&&(t[i]=u)}}return s=s.trim(),r?s=r(t,n?"":s):n&&(s="none"),s}function nx(e,t,r){const{style:s,vars:n,transformOrigin:a}=e;let i=!1,l=!1;for(const c in t){const u=t[c];if(Fo.has(c)){i=!0;continue}else if(Up(c)){n[c]=u;continue}else{const d=I_(u,Jp[c]);c.startsWith("origin")?(l=!0,a[c]=d):s[c]=d}}if(t.transform||(i||r?s.transform=WC(t,e.transform,r):s.transform&&(s.transform="none")),l){const{originX:c="50%",originY:u="50%",originZ:d=0}=a;s.transformOrigin=`${c} ${u} ${d}`}}const ax=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function H_(e,t,r){for(const s in t)!jr(t[s])&&!W_(s,r)&&(e[s]=t[s])}function HC({transformTemplate:e},t){return T.useMemo(()=>{const r=ax();return nx(r,t,e),Object.assign({},r.vars,r.style)},[t])}function qC(e,t){const r=e.style||{},s={};return H_(s,r,e),Object.assign(s,HC(e,t)),s}function GC(e,t){const r={},s=qC(e,t);return e.drag&&e.dragListener!==!1&&(r.draggable=!1,s.userSelect=s.WebkitUserSelect=s.WebkitTouchCallout="none",s.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(r.tabIndex=0),r.style=s,r}const KC={offset:"stroke-dashoffset",array:"stroke-dasharray"},XC={offset:"strokeDashoffset",array:"strokeDasharray"};function YC(e,t,r=1,s=0,n=!0){e.pathLength=1;const a=n?KC:XC;e[a.offset]=$e.transform(-s);const i=$e.transform(t),l=$e.transform(r);e[a.array]=`${i} ${l}`}function q_(e,{attrX:t,attrY:r,attrScale:s,pathLength:n,pathSpacing:a=1,pathOffset:i=0,...l},c,u,d){if(nx(e,l,u),c){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:f,style:h}=e;f.transform&&(h.transform=f.transform,delete f.transform),(h.transform||f.transformOrigin)&&(h.transformOrigin=f.transformOrigin??"50% 50%",delete f.transformOrigin),h.transform&&(h.transformBox=(d==null?void 0:d.transformBox)??"fill-box",delete f.transformBox),t!==void 0&&(f.x=t),r!==void 0&&(f.y=r),s!==void 0&&(f.scale=s),n!==void 0&&YC(f,n,a,i,!1)}const G_=()=>({...ax(),attrs:{}}),K_=e=>typeof e=="string"&&e.toLowerCase()==="svg";function JC(e,t,r,s){const n=T.useMemo(()=>{const a=G_();return q_(a,t,K_(s),e.transformTemplate,e.style),{...a.attrs,style:{...a.style}}},[t]);if(e.style){const a={};H_(a,e.style,e),n.style={...a,...n.style}}return n}const QC=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function ix(e){return typeof e!="string"||e.includes("-")?!1:!!(QC.indexOf(e)>-1||/[A-Z]/u.test(e))}function ZC(e,t,r,{latestValues:s},n,a=!1){const l=(ix(e)?JC:GC)(t,s,n,e),c=MC(t,typeof e=="string",a),u=e!==T.Fragment?{...c,...l,ref:r}:{},{children:d}=t,f=T.useMemo(()=>jr(d)?d.get():d,[d]);return T.createElement(e,{...u,children:f})}function Xv(e){const t=[{},{}];return e==null||e.values.forEach((r,s)=>{t[0][s]=r.get(),t[1][s]=r.getVelocity()}),t}function ox(e,t,r,s){if(typeof t=="function"){const[n,a]=Xv(s);t=t(r!==void 0?r:e.custom,n,a)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[n,a]=Xv(s);t=t(r!==void 0?r:e.custom,n,a)}return t}function Hu(e){return jr(e)?e.get():e}function eA({scrapeMotionValuesFromProps:e,createRenderState:t},r,s,n){return{latestValues:tA(r,s,n,e),renderState:t()}}function tA(e,t,r,s){const n={},a=s(e,{});for(const h in a)n[h]=Hu(a[h]);let{initial:i,animate:l}=e;const c=u0(e),u=V_(e);t&&u&&!c&&e.inherit!==!1&&(i===void 0&&(i=t.initial),l===void 0&&(l=t.animate));let d=r?r.initial===!1:!1;d=d||i===!1;const f=d?l:i;if(f&&typeof f!="boolean"&&!c0(f)){const h=Array.isArray(f)?f:[f];for(let p=0;p<h.length;p++){const m=ox(e,h[p]);if(m){const{transitionEnd:x,transition:g,...y}=m;for(const w in y){let v=y[w];if(Array.isArray(v)){const b=d?v.length-1:0;v=v[b]}v!==null&&(n[w]=v)}for(const w in x)n[w]=x[w]}}}return n}const X_=e=>(t,r)=>{const s=T.useContext(l0),n=T.useContext(o0),a=()=>eA(e,t,s,n);return r?a():Fp(a)};function lx(e,t,r){var a;const{style:s}=e,n={};for(const i in s)(jr(s[i])||t.style&&jr(t.style[i])||W_(i,e)||((a=r==null?void 0:r.getValue(i))==null?void 0:a.liveStyle)!==void 0)&&(n[i]=s[i]);return n}const rA=X_({scrapeMotionValuesFromProps:lx,createRenderState:ax});function Y_(e,t,r){const s=lx(e,t,r);for(const n in e)if(jr(e[n])||jr(t[n])){const a=Ao.indexOf(n)!==-1?"attr"+n.charAt(0).toUpperCase()+n.substring(1):n;s[a]=e[n]}return s}const sA=X_({scrapeMotionValuesFromProps:Y_,createRenderState:G_}),nA=Symbol.for("motionComponentSymbol");function Wi(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function aA(e,t,r){return T.useCallback(s=>{s&&e.onMount&&e.onMount(s),t&&(s?t.mount(s):t.unmount()),r&&(typeof r=="function"?r(s):Wi(r)&&(r.current=s))},[t])}const cx=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),iA="framerAppearId",J_="data-"+cx(iA),Q_=T.createContext({});function oA(e,t,r,s,n){var x,g;const{visualElement:a}=T.useContext(l0),i=T.useContext($_),l=T.useContext(o0),c=T.useContext(ex).reducedMotion,u=T.useRef(null);s=s||i.renderer,!u.current&&s&&(u.current=s(e,{visualState:t,parent:a,props:r,presenceContext:l,blockInitialAnimation:l?l.initial===!1:!1,reducedMotionConfig:c}));const d=u.current,f=T.useContext(Q_);d&&!d.projection&&n&&(d.type==="html"||d.type==="svg")&&lA(u.current,r,n,f);const h=T.useRef(!1);T.useInsertionEffect(()=>{d&&h.current&&d.update(r,l)});const p=r[J_],m=T.useRef(!!p&&!((x=window.MotionHandoffIsComplete)!=null&&x.call(window,p))&&((g=window.MotionHasOptimisedAnimation)==null?void 0:g.call(window,p)));return Xb(()=>{d&&(h.current=!0,window.MotionIsMounted=!0,d.updateFeatures(),d.scheduleRenderMicrotask(),m.current&&d.animationState&&d.animationState.animateChanges())}),T.useEffect(()=>{d&&(!m.current&&d.animationState&&d.animationState.animateChanges(),m.current&&(queueMicrotask(()=>{var y;(y=window.MotionHandoffMarkAsComplete)==null||y.call(window,p)}),m.current=!1),d.enteringChildren=void 0)}),d}function lA(e,t,r,s){const{layoutId:n,layout:a,drag:i,dragConstraints:l,layoutScroll:c,layoutRoot:u,layoutCrossfade:d}=t;e.projection=new r(e.latestValues,t["data-framer-portal-id"]?void 0:Z_(e.parent)),e.projection.setOptions({layoutId:n,layout:a,alwaysMeasureLayout:!!i||l&&Wi(l),visualElement:e,animationType:typeof a=="string"?a:"both",initialPromotionConfig:s,crossfade:d,layoutScroll:c,layoutRoot:u})}function Z_(e){if(e)return e.options.allowProjection!==!1?e.projection:Z_(e.parent)}function uf(e,{forwardMotionProps:t=!1}={},r,s){r&&OC(r);const n=ix(e)?sA:rA;function a(l,c){let u;const d={...T.useContext(ex),...l,layoutId:cA(l)},{isStatic:f}=d,h=UC(l),p=n(l,f);if(!f&&Pp){uA();const m=dA(d);u=m.MeasureLayout,h.visualElement=oA(e,p,d,s,m.ProjectionNode)}return o.jsxs(l0.Provider,{value:h,children:[u&&h.visualElement?o.jsx(u,{visualElement:h.visualElement,...d}):null,ZC(e,l,aA(p,h.visualElement,c),p,f,t)]})}a.displayName=`motion.${typeof e=="string"?e:`create(${e.displayName??e.name??""})`}`;const i=T.forwardRef(a);return i[nA]=e,i}function cA({layoutId:e}){const t=T.useContext(Ap).id;return t&&e!==void 0?t+"-"+e:e}function uA(e,t){T.useContext($_).strict}function dA(e){const{drag:t,layout:r}=go;if(!t&&!r)return{};const s={...t,...r};return{MeasureLayout:t!=null&&t.isEnabled(e)||r!=null&&r.isEnabled(e)?s.MeasureLayout:void 0,ProjectionNode:s.ProjectionNode}}function fA(e,t){if(typeof Proxy>"u")return uf;const r=new Map,s=(a,i)=>uf(a,i,e,t),n=(a,i)=>s(a,i);return new Proxy(n,{get:(a,i)=>i==="create"?s:(r.has(i)||r.set(i,uf(i,void 0,e,t)),r.get(i))})}function eS({top:e,left:t,right:r,bottom:s}){return{x:{min:t,max:r},y:{min:e,max:s}}}function hA({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function mA(e,t){if(!t)return e;const r=t({x:e.left,y:e.top}),s=t({x:e.right,y:e.bottom});return{top:r.y,left:r.x,bottom:s.y,right:s.x}}function df(e){return e===void 0||e===1}function Qh({scale:e,scaleX:t,scaleY:r}){return!df(e)||!df(t)||!df(r)}function Ca(e){return Qh(e)||tS(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function tS(e){return Yv(e.x)||Yv(e.y)}function Yv(e){return e&&e!=="0%"}function _d(e,t,r){const s=e-r,n=t*s;return r+n}function Jv(e,t,r,s,n){return n!==void 0&&(e=_d(e,n,s)),_d(e,r,s)+t}function Zh(e,t=0,r=1,s,n){e.min=Jv(e.min,t,r,s,n),e.max=Jv(e.max,t,r,s,n)}function rS(e,{x:t,y:r}){Zh(e.x,t.translate,t.scale,t.originPoint),Zh(e.y,r.translate,r.scale,r.originPoint)}const Qv=.999999999999,Zv=1.0000000000001;function pA(e,t,r,s=!1){const n=r.length;if(!n)return;t.x=t.y=1;let a,i;for(let l=0;l<n;l++){a=r[l],i=a.projectionDelta;const{visualElement:c}=a.options;c&&c.props.style&&c.props.style.display==="contents"||(s&&a.options.layoutScroll&&a.scroll&&a!==a.root&&qi(e,{x:-a.scroll.offset.x,y:-a.scroll.offset.y}),i&&(t.x*=i.x.scale,t.y*=i.y.scale,rS(e,i)),s&&Ca(a.latestValues)&&qi(e,a.latestValues))}t.x<Zv&&t.x>Qv&&(t.x=1),t.y<Zv&&t.y>Qv&&(t.y=1)}function Hi(e,t){e.min=e.min+t,e.max=e.max+t}function ey(e,t,r,s,n=.5){const a=Et(e.min,e.max,n);Zh(e,t,r,a,s)}function qi(e,t){ey(e.x,t.x,t.scaleX,t.scale,t.originX),ey(e.y,t.y,t.scaleY,t.scale,t.originY)}function sS(e,t){return eS(mA(e.getBoundingClientRect(),t))}function xA(e,t,r){const s=sS(e,r),{scroll:n}=t;return n&&(Hi(s.x,n.offset.x),Hi(s.y,n.offset.y)),s}const ty=()=>({translate:0,scale:1,origin:0,originPoint:0}),Gi=()=>({x:ty(),y:ty()}),ry=()=>({min:0,max:0}),Bt=()=>({x:ry(),y:ry()}),em={current:null},nS={current:!1};function gA(){if(nS.current=!0,!!Pp)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>em.current=e.matches;e.addEventListener("change",t),t()}else em.current=!1}const vA=new WeakMap;function yA(e,t,r){for(const s in t){const n=t[s],a=r[s];if(jr(n))e.addValue(s,n);else if(jr(a))e.addValue(s,xo(n,{owner:e}));else if(a!==n)if(e.hasValue(s)){const i=e.getValue(s);i.liveStyle===!0?i.jump(n):i.hasAnimated||i.set(n)}else{const i=e.getStaticValue(s);e.addValue(s,xo(i!==void 0?i:n,{owner:e}))}}for(const s in r)t[s]===void 0&&e.removeValue(s);return t}const sy=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class wA{scrapeMotionValuesFromProps(t,r,s){return{}}constructor({parent:t,props:r,presenceContext:s,reducedMotionConfig:n,blockInitialAnimation:a,visualState:i},l={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=Xp,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const h=qr.now();this.renderScheduledAt<h&&(this.renderScheduledAt=h,wt.render(this.render,!1,!0))};const{latestValues:c,renderState:u}=i;this.latestValues=c,this.baseTarget={...c},this.initialValues=r.initial?{...c}:{},this.renderState=u,this.parent=t,this.props=r,this.presenceContext=s,this.depth=t?t.depth+1:0,this.reducedMotionConfig=n,this.options=l,this.blockInitialAnimation=!!a,this.isControllingVariants=u0(r),this.isVariantNode=V_(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:d,...f}=this.scrapeMotionValuesFromProps(r,{},this);for(const h in f){const p=f[h];c[h]!==void 0&&jr(p)&&p.set(c[h])}}mount(t){var r;this.current=t,vA.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((s,n)=>this.bindToMotionValue(n,s)),nS.current||gA(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:em.current,(r=this.parent)==null||r.addChild(this),this.update(this.props,this.presenceContext)}unmount(){var t;this.projection&&this.projection.unmount(),la(this.notifyUpdate),la(this.render),this.valueSubscriptions.forEach(r=>r()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),(t=this.parent)==null||t.removeChild(this);for(const r in this.events)this.events[r].clear();for(const r in this.features){const s=this.features[r];s&&(s.unmount(),s.isMounted=!1)}this.current=null}addChild(t){this.children.add(t),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(t)}removeChild(t){this.children.delete(t),this.enteringChildren&&this.enteringChildren.delete(t)}bindToMotionValue(t,r){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const s=Fo.has(t);s&&this.onBindTransform&&this.onBindTransform();const n=r.on("change",i=>{this.latestValues[t]=i,this.props.onUpdate&&wt.preRender(this.notifyUpdate),s&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,t,r)),this.valueSubscriptions.set(t,()=>{n(),a&&a(),r.owner&&r.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in go){const r=go[t];if(!r)continue;const{isEnabled:s,Feature:n}=r;if(!this.features[t]&&n&&s(this.props)&&(this.features[t]=new n(this)),this.features[t]){const a=this.features[t];a.isMounted?a.update():(a.mount(),a.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Bt()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,r){this.latestValues[t]=r}update(t,r){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let s=0;s<sy.length;s++){const n=sy[s];this.propEventSubscriptions[n]&&(this.propEventSubscriptions[n](),delete this.propEventSubscriptions[n]);const a="on"+n,i=t[a];i&&(this.propEventSubscriptions[n]=this.on(n,i))}this.prevMotionValues=yA(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(t),()=>r.variantChildren.delete(t)}addValue(t,r){const s=this.values.get(t);r!==s&&(s&&this.removeValue(t),this.bindToMotionValue(t,r),this.values.set(t,r),this.latestValues[t]=r.get())}removeValue(t){this.values.delete(t);const r=this.valueSubscriptions.get(t);r&&(r(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,r){if(this.props.values&&this.props.values[t])return this.props.values[t];let s=this.values.get(t);return s===void 0&&r!==void 0&&(s=xo(r===null?void 0:r,{owner:this}),this.addValue(t,s)),s}readValue(t,r){let s=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:this.getBaseTargetFromProps(this.props,t)??this.readValueFromInstance(this.current,t,this.options);return s!=null&&(typeof s=="string"&&(Yb(s)||Qb(s))?s=parseFloat(s):!TC(s)&&ca.test(r)&&(s=R_(t,r)),this.setBaseTarget(t,jr(s)?s.get():s)),jr(s)?s.get():s}setBaseTarget(t,r){this.baseTarget[t]=r}getBaseTarget(t){var a;const{initial:r}=this.props;let s;if(typeof r=="string"||typeof r=="object"){const i=ox(this.props,r,(a=this.presenceContext)==null?void 0:a.custom);i&&(s=i[t])}if(r&&s!==void 0)return s;const n=this.getBaseTargetFromProps(this.props,t);return n!==void 0&&!jr(n)?n:this.initialValues[t]!==void 0&&s===void 0?void 0:this.baseTarget[t]}on(t,r){return this.events[t]||(this.events[t]=new Lp),this.events[t].add(r)}notify(t,...r){this.events[t]&&this.events[t].notify(...r)}scheduleRenderMicrotask(){Qp.render(this.render)}}class aS extends wA{constructor(){super(...arguments),this.KeyframeResolver=xC}sortInstanceNodePosition(t,r){return t.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(t,r){return t.style?t.style[r]:void 0}removeValueFromRenderState(t,{vars:r,style:s}){delete r[t],delete s[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;jr(t)&&(this.childSubscription=t.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}}function iS(e,{style:t,vars:r},s,n){const a=e.style;let i;for(i in t)a[i]=t[i];n==null||n.applyProjectionStyles(a,s);for(i in r)a.setProperty(i,r[i])}function bA(e){return window.getComputedStyle(e)}class _A extends aS{constructor(){super(...arguments),this.type="html",this.renderInstance=iS}readValueFromInstance(t,r){var s;if(Fo.has(r))return(s=this.projection)!=null&&s.isProjecting?Hh(r):O3(t,r);{const n=bA(t),a=(Up(r)?n.getPropertyValue(r):n[r])||0;return typeof a=="string"?a.trim():a}}measureInstanceViewportBox(t,{transformPagePoint:r}){return sS(t,r)}build(t,r,s){nx(t,r,s.transformTemplate)}scrapeMotionValuesFromProps(t,r,s){return lx(t,r,s)}}const oS=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function SA(e,t,r,s){iS(e,t,void 0,s);for(const n in t.attrs)e.setAttribute(oS.has(n)?n:cx(n),t.attrs[n])}class kA extends aS{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Bt}getBaseTargetFromProps(t,r){return t[r]}readValueFromInstance(t,r){if(Fo.has(r)){const s=P_(r);return s&&s.default||0}return r=oS.has(r)?r:cx(r),t.getAttribute(r)}scrapeMotionValuesFromProps(t,r,s){return Y_(t,r,s)}build(t,r,s){q_(t,r,this.isSVGTag,s.transformTemplate,s.style)}renderInstance(t,r,s,n){SA(t,r,s,n)}mount(t){this.isSVGTag=K_(t.tagName),super.mount(t)}}const NA=(e,t)=>ix(e)?new kA(t):new _A(t,{allowProjection:e!==T.Fragment});function ro(e,t,r){const s=e.getProps();return ox(s,t,r!==void 0?r:s.custom,e)}const tm=e=>Array.isArray(e);function jA(e,t,r){e.hasValue(t)?e.getValue(t).set(r):e.addValue(t,xo(r))}function EA(e){return tm(e)?e[e.length-1]||0:e}function TA(e,t){const r=ro(e,t);let{transitionEnd:s={},transition:n={},...a}=r||{};a={...a,...s};for(const i in a){const l=EA(a[i]);jA(e,i,l)}}function CA(e){return!!(jr(e)&&e.add)}function rm(e,t){const r=e.getValue("willChange");if(CA(r))return r.add(t);if(!r&&Pn.WillChange){const s=new Pn.WillChange("auto");e.addValue("willChange",s),s.add(t)}}function lS(e){return e.props[J_]}const AA=e=>e!==null;function FA(e,{repeat:t,repeatType:r="loop"},s){const n=e.filter(AA),a=t&&r!=="loop"&&t%2===1?0:n.length-1;return n[a]}const PA={type:"spring",stiffness:500,damping:25,restSpeed:10},RA=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),IA={type:"keyframes",duration:.8},OA={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},DA=(e,{keyframes:t})=>t.length>2?IA:Fo.has(e)?e.startsWith("scale")?RA(t[1]):PA:OA;function LA({when:e,delay:t,delayChildren:r,staggerChildren:s,staggerDirection:n,repeat:a,repeatType:i,repeatDelay:l,from:c,elapsed:u,...d}){return!!Object.keys(d).length}const ux=(e,t,r,s={},n,a)=>i=>{const l=Yp(s,e)||{},c=l.delay||s.delay||0;let{elapsed:u=0}=s;u=u-un(c);const d={keyframes:Array.isArray(r)?r:[null,r],ease:"easeOut",velocity:t.getVelocity(),...l,delay:-u,onUpdate:h=>{t.set(h),l.onUpdate&&l.onUpdate(h)},onComplete:()=>{i(),l.onComplete&&l.onComplete()},name:e,motionValue:t,element:a?void 0:n};LA(l)||Object.assign(d,DA(e,d)),d.duration&&(d.duration=un(d.duration)),d.repeatDelay&&(d.repeatDelay=un(d.repeatDelay)),d.from!==void 0&&(d.keyframes[0]=d.from);let f=!1;if((d.type===!1||d.duration===0&&!d.repeatDelay)&&(Yh(d),d.delay===0&&(f=!0)),(Pn.instantAnimations||Pn.skipAnimations)&&(f=!0,Yh(d),d.delay=0),d.allowFlatten=!l.type&&!l.ease,f&&!a&&t.get()!==void 0){const h=FA(d.keyframes,l);if(h!==void 0){wt.update(()=>{d.onUpdate(h),d.onComplete()});return}}return l.isSync?new Kp(d):new nC(d)};function MA({protectedKeys:e,needsAnimating:t},r){const s=e.hasOwnProperty(r)&&t[r]!==!0;return t[r]=!1,s}function cS(e,t,{delay:r=0,transitionOverride:s,type:n}={}){let{transition:a=e.getDefaultTransition(),transitionEnd:i,...l}=t;s&&(a=s);const c=[],u=n&&e.animationState&&e.animationState.getState()[n];for(const d in l){const f=e.getValue(d,e.latestValues[d]??null),h=l[d];if(h===void 0||u&&MA(u,d))continue;const p={delay:r,...Yp(a||{},d)},m=f.get();if(m!==void 0&&!f.isAnimating&&!Array.isArray(h)&&h===m&&!p.velocity)continue;let x=!1;if(window.MotionHandoffAnimation){const y=lS(e);if(y){const w=window.MotionHandoffAnimation(y,d,wt);w!==null&&(p.startTime=w,x=!0)}}rm(e,d),f.start(ux(d,f,h,e.shouldReduceMotion&&C_.has(d)?{type:!1}:p,e,x));const g=f.animation;g&&c.push(g)}return i&&Promise.all(c).then(()=>{wt.update(()=>{i&&TA(e,i)})}),c}function uS(e,t,r,s=0,n=1){const a=Array.from(e).sort((u,d)=>u.sortNodePosition(d)).indexOf(t),i=e.size,l=(i-1)*s;return typeof r=="function"?r(a,i):n===1?a*s:l-a*s}function sm(e,t,r={}){var c;const s=ro(e,t,r.type==="exit"?(c=e.presenceContext)==null?void 0:c.custom:void 0);let{transition:n=e.getDefaultTransition()||{}}=s||{};r.transitionOverride&&(n=r.transitionOverride);const a=s?()=>Promise.all(cS(e,s,r)):()=>Promise.resolve(),i=e.variantChildren&&e.variantChildren.size?(u=0)=>{const{delayChildren:d=0,staggerChildren:f,staggerDirection:h}=n;return BA(e,t,u,d,f,h,r)}:()=>Promise.resolve(),{when:l}=n;if(l){const[u,d]=l==="beforeChildren"?[a,i]:[i,a];return u().then(()=>d())}else return Promise.all([a(),i(r.delay)])}function BA(e,t,r=0,s=0,n=0,a=1,i){const l=[];for(const c of e.variantChildren)c.notify("AnimationStart",t),l.push(sm(c,t,{...i,delay:r+(typeof s=="function"?0:s)+uS(e.variantChildren,c,s,n,a)}).then(()=>c.notify("AnimationComplete",t)));return Promise.all(l)}function UA(e,t,r={}){e.notify("AnimationStart",t);let s;if(Array.isArray(t)){const n=t.map(a=>sm(e,a,r));s=Promise.all(n)}else if(typeof t=="string")s=sm(e,t,r);else{const n=typeof t=="function"?ro(e,t,r.custom):t;s=Promise.all(cS(e,n,r))}return s.then(()=>{e.notify("AnimationComplete",t)})}function dS(e,t){if(!Array.isArray(t))return!1;const r=t.length;if(r!==e.length)return!1;for(let s=0;s<r;s++)if(t[s]!==e[s])return!1;return!0}const $A=sx.length;function fS(e){if(!e)return;if(!e.isControllingVariants){const r=e.parent?fS(e.parent)||{}:{};return e.props.initial!==void 0&&(r.initial=e.props.initial),r}const t={};for(let r=0;r<$A;r++){const s=sx[r],n=e.props[s];(Zl(n)||n===!1)&&(t[s]=n)}return t}const zA=[...rx].reverse(),VA=rx.length;function WA(e){return t=>Promise.all(t.map(({animation:r,options:s})=>UA(e,r,s)))}function HA(e){let t=WA(e),r=ny(),s=!0;const n=c=>(u,d)=>{var h;const f=ro(e,d,c==="exit"?(h=e.presenceContext)==null?void 0:h.custom:void 0);if(f){const{transition:p,transitionEnd:m,...x}=f;u={...u,...x,...m}}return u};function a(c){t=c(e)}function i(c){const{props:u}=e,d=fS(e.parent)||{},f=[],h=new Set;let p={},m=1/0;for(let g=0;g<VA;g++){const y=zA[g],w=r[y],v=u[y]!==void 0?u[y]:d[y],b=Zl(v),_=y===c?w.isActive:null;_===!1&&(m=g);let k=v===d[y]&&v!==u[y]&&b;if(k&&s&&e.manuallyAnimateOnMount&&(k=!1),w.protectedKeys={...p},!w.isActive&&_===null||!v&&!w.prevProp||c0(v)||typeof v=="boolean")continue;const S=qA(w.prevProp,v);let E=S||y===c&&w.isActive&&!k&&b||g>m&&b,C=!1;const U=Array.isArray(v)?v:[v];let H=U.reduce(n(y),{});_===!1&&(H={});const{prevResolvedValues:W={}}=w,q={...W,...H},z=X=>{E=!0,h.has(X)&&(C=!0,h.delete(X)),w.needsAnimating[X]=!0;const K=e.getValue(X);K&&(K.liveStyle=!1)};for(const X in q){const K=H[X],V=W[X];if(p.hasOwnProperty(X))continue;let fe=!1;tm(K)&&tm(V)?fe=!dS(K,V):fe=K!==V,fe?K!=null?z(X):h.add(X):K!==void 0&&h.has(X)?z(X):w.protectedKeys[X]=!0}w.prevProp=v,w.prevResolvedValues=H,w.isActive&&(p={...p,...H}),s&&e.blockInitialAnimation&&(E=!1);const Q=k&&S;E&&(!Q||C)&&f.push(...U.map(X=>{const K={type:y};if(typeof X=="string"&&s&&!Q&&e.manuallyAnimateOnMount&&e.parent){const{parent:V}=e,fe=ro(V,X);if(V.enteringChildren&&fe){const{delayChildren:ve}=fe.transition||{};K.delay=uS(V.enteringChildren,e,ve)}}return{animation:X,options:K}}))}if(h.size){const g={};if(typeof u.initial!="boolean"){const y=ro(e,Array.isArray(u.initial)?u.initial[0]:u.initial);y&&y.transition&&(g.transition=y.transition)}h.forEach(y=>{const w=e.getBaseTarget(y),v=e.getValue(y);v&&(v.liveStyle=!0),g[y]=w??null}),f.push({animation:g})}let x=!!f.length;return s&&(u.initial===!1||u.initial===u.animate)&&!e.manuallyAnimateOnMount&&(x=!1),s=!1,x?t(f):Promise.resolve()}function l(c,u){var f;if(r[c].isActive===u)return Promise.resolve();(f=e.variantChildren)==null||f.forEach(h=>{var p;return(p=h.animationState)==null?void 0:p.setActive(c,u)}),r[c].isActive=u;const d=i(c);for(const h in r)r[h].protectedKeys={};return d}return{animateChanges:i,setActive:l,setAnimateFunction:a,getState:()=>r,reset:()=>{r=ny()}}}function qA(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!dS(t,e):!1}function ka(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function ny(){return{animate:ka(!0),whileInView:ka(),whileHover:ka(),whileTap:ka(),whileDrag:ka(),whileFocus:ka(),exit:ka()}}class ga{constructor(t){this.isMounted=!1,this.node=t}update(){}}class GA extends ga{constructor(t){super(t),t.animationState||(t.animationState=HA(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();c0(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:r}=this.node.prevProps||{};t!==r&&this.updateAnimationControlsSubscription()}unmount(){var t;this.node.animationState.reset(),(t=this.unmountControls)==null||t.call(this)}}let KA=0;class XA extends ga{constructor(){super(...arguments),this.id=KA++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:r}=this.node.presenceContext,{isPresent:s}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===s)return;const n=this.node.animationState.setActive("exit",!t);r&&!t&&n.then(()=>{r(this.id)})}mount(){const{register:t,onExitComplete:r}=this.node.presenceContext||{};r&&r(this.id),t&&(this.unmount=t(this.id))}unmount(){}}const YA={animation:{Feature:GA},exit:{Feature:XA}};function tc(e,t,r,s={passive:!0}){return e.addEventListener(t,r,s),()=>e.removeEventListener(t,r)}function Tc(e){return{point:{x:e.pageX,y:e.pageY}}}const JA=e=>t=>Zp(t)&&e(t,Tc(t));function wl(e,t,r,s){return tc(e,t,JA(r),s)}const hS=1e-4,QA=1-hS,ZA=1+hS,mS=.01,e6=0-mS,t6=0+mS;function Dr(e){return e.max-e.min}function r6(e,t,r){return Math.abs(e-t)<=r}function ay(e,t,r,s=.5){e.origin=s,e.originPoint=Et(t.min,t.max,e.origin),e.scale=Dr(r)/Dr(t),e.translate=Et(r.min,r.max,e.origin)-e.originPoint,(e.scale>=QA&&e.scale<=ZA||isNaN(e.scale))&&(e.scale=1),(e.translate>=e6&&e.translate<=t6||isNaN(e.translate))&&(e.translate=0)}function bl(e,t,r,s){ay(e.x,t.x,r.x,s?s.originX:void 0),ay(e.y,t.y,r.y,s?s.originY:void 0)}function iy(e,t,r){e.min=r.min+t.min,e.max=e.min+Dr(t)}function s6(e,t,r){iy(e.x,t.x,r.x),iy(e.y,t.y,r.y)}function oy(e,t,r){e.min=t.min-r.min,e.max=e.min+Dr(t)}function _l(e,t,r){oy(e.x,t.x,r.x),oy(e.y,t.y,r.y)}function _s(e){return[e("x"),e("y")]}const pS=({current:e})=>e?e.ownerDocument.defaultView:null,ly=(e,t)=>Math.abs(e-t);function n6(e,t){const r=ly(e.x,t.x),s=ly(e.y,t.y);return Math.sqrt(r**2+s**2)}class xS{constructor(t,r,{transformPagePoint:s,contextWindow:n=window,dragSnapToOrigin:a=!1,distanceThreshold:i=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const h=hf(this.lastMoveEventInfo,this.history),p=this.startEvent!==null,m=n6(h.offset,{x:0,y:0})>=this.distanceThreshold;if(!p&&!m)return;const{point:x}=h,{timestamp:g}=ur;this.history.push({...x,timestamp:g});const{onStart:y,onMove:w}=this.handlers;p||(y&&y(this.lastMoveEvent,h),this.startEvent=this.lastMoveEvent),w&&w(this.lastMoveEvent,h)},this.handlePointerMove=(h,p)=>{this.lastMoveEvent=h,this.lastMoveEventInfo=ff(p,this.transformPagePoint),wt.update(this.updatePoint,!0)},this.handlePointerUp=(h,p)=>{this.end();const{onEnd:m,onSessionEnd:x,resumeAnimation:g}=this.handlers;if(this.dragSnapToOrigin&&g&&g(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const y=hf(h.type==="pointercancel"?this.lastMoveEventInfo:ff(p,this.transformPagePoint),this.history);this.startEvent&&m&&m(h,y),x&&x(h,y)},!Zp(t))return;this.dragSnapToOrigin=a,this.handlers=r,this.transformPagePoint=s,this.distanceThreshold=i,this.contextWindow=n||window;const l=Tc(t),c=ff(l,this.transformPagePoint),{point:u}=c,{timestamp:d}=ur;this.history=[{...u,timestamp:d}];const{onSessionStart:f}=r;f&&f(t,hf(c,this.history)),this.removeListeners=Nc(wl(this.contextWindow,"pointermove",this.handlePointerMove),wl(this.contextWindow,"pointerup",this.handlePointerUp),wl(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),la(this.updatePoint)}}function ff(e,t){return t?{point:t(e.point)}:e}function cy(e,t){return{x:e.x-t.x,y:e.y-t.y}}function hf({point:e},t){return{point:e,delta:cy(e,gS(t)),offset:cy(e,a6(t)),velocity:i6(t,.1)}}function a6(e){return e[0]}function gS(e){return e[e.length-1]}function i6(e,t){if(e.length<2)return{x:0,y:0};let r=e.length-1,s=null;const n=gS(e);for(;r>=0&&(s=e[r],!(n.timestamp-s.timestamp>un(t)));)r--;if(!s)return{x:0,y:0};const a=Cs(n.timestamp-s.timestamp);if(a===0)return{x:0,y:0};const i={x:(n.x-s.x)/a,y:(n.y-s.y)/a};return i.x===1/0&&(i.x=0),i.y===1/0&&(i.y=0),i}function o6(e,{min:t,max:r},s){return t!==void 0&&e<t?e=s?Et(t,e,s.min):Math.max(e,t):r!==void 0&&e>r&&(e=s?Et(r,e,s.max):Math.min(e,r)),e}function uy(e,t,r){return{min:t!==void 0?e.min+t:void 0,max:r!==void 0?e.max+r-(e.max-e.min):void 0}}function l6(e,{top:t,left:r,bottom:s,right:n}){return{x:uy(e.x,r,n),y:uy(e.y,t,s)}}function dy(e,t){let r=t.min-e.min,s=t.max-e.max;return t.max-t.min<e.max-e.min&&([r,s]=[s,r]),{min:r,max:s}}function c6(e,t){return{x:dy(e.x,t.x),y:dy(e.y,t.y)}}function u6(e,t){let r=.5;const s=Dr(e),n=Dr(t);return n>s?r=Yl(t.min,t.max-s,e.min):s>n&&(r=Yl(e.min,e.max-n,t.min)),Fn(0,1,r)}function d6(e,t){const r={};return t.min!==void 0&&(r.min=t.min-e.min),t.max!==void 0&&(r.max=t.max-e.min),r}const nm=.35;function f6(e=nm){return e===!1?e=0:e===!0&&(e=nm),{x:fy(e,"left","right"),y:fy(e,"top","bottom")}}function fy(e,t,r){return{min:hy(e,t),max:hy(e,r)}}function hy(e,t){return typeof e=="number"?e:e[t]||0}const h6=new WeakMap;class m6{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Bt(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=t}start(t,{snapToCursor:r=!1,distanceThreshold:s}={}){const{presenceContext:n}=this.visualElement;if(n&&n.isPresent===!1)return;const a=f=>{const{dragSnapToOrigin:h}=this.getProps();h?this.pauseAnimation():this.stopAnimation(),r&&this.snapToCursor(Tc(f).point)},i=(f,h)=>{const{drag:p,dragPropagation:m,onDragStart:x}=this.getProps();if(p&&!m&&(this.openDragLock&&this.openDragLock(),this.openDragLock=wC(p),!this.openDragLock))return;this.latestPointerEvent=f,this.latestPanInfo=h,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),_s(y=>{let w=this.getAxisMotionValue(y).get()||0;if(dn.test(w)){const{projection:v}=this.visualElement;if(v&&v.layout){const b=v.layout.layoutBox[y];b&&(w=Dr(b)*(parseFloat(w)/100))}}this.originPoint[y]=w}),x&&wt.postRender(()=>x(f,h)),rm(this.visualElement,"transform");const{animationState:g}=this.visualElement;g&&g.setActive("whileDrag",!0)},l=(f,h)=>{this.latestPointerEvent=f,this.latestPanInfo=h;const{dragPropagation:p,dragDirectionLock:m,onDirectionLock:x,onDrag:g}=this.getProps();if(!p&&!this.openDragLock)return;const{offset:y}=h;if(m&&this.currentDirection===null){this.currentDirection=p6(y),this.currentDirection!==null&&x&&x(this.currentDirection);return}this.updateAxis("x",h.point,y),this.updateAxis("y",h.point,y),this.visualElement.render(),g&&g(f,h)},c=(f,h)=>{this.latestPointerEvent=f,this.latestPanInfo=h,this.stop(f,h),this.latestPointerEvent=null,this.latestPanInfo=null},u=()=>_s(f=>{var h;return this.getAnimationState(f)==="paused"&&((h=this.getAxisMotionValue(f).animation)==null?void 0:h.play())}),{dragSnapToOrigin:d}=this.getProps();this.panSession=new xS(t,{onSessionStart:a,onStart:i,onMove:l,onSessionEnd:c,resumeAnimation:u},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:d,distanceThreshold:s,contextWindow:pS(this.visualElement)})}stop(t,r){const s=t||this.latestPointerEvent,n=r||this.latestPanInfo,a=this.isDragging;if(this.cancel(),!a||!n||!s)return;const{velocity:i}=n;this.startAnimation(i);const{onDragEnd:l}=this.getProps();l&&wt.postRender(()=>l(s,n))}cancel(){this.isDragging=!1;const{projection:t,animationState:r}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:s}=this.getProps();!s&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(t,r,s){const{drag:n}=this.getProps();if(!s||!uu(t,n,this.currentDirection))return;const a=this.getAxisMotionValue(t);let i=this.originPoint[t]+s[t];this.constraints&&this.constraints[t]&&(i=o6(i,this.constraints[t],this.elastic[t])),a.set(i)}resolveConstraints(){var a;const{dragConstraints:t,dragElastic:r}=this.getProps(),s=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(a=this.visualElement.projection)==null?void 0:a.layout,n=this.constraints;t&&Wi(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&s?this.constraints=l6(s.layoutBox,t):this.constraints=!1,this.elastic=f6(r),n!==this.constraints&&s&&this.constraints&&!this.hasMutatedConstraints&&_s(i=>{this.constraints!==!1&&this.getAxisMotionValue(i)&&(this.constraints[i]=d6(s.layoutBox[i],this.constraints[i]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:r}=this.getProps();if(!t||!Wi(t))return!1;const s=t.current,{projection:n}=this.visualElement;if(!n||!n.layout)return!1;const a=xA(s,n.root,this.visualElement.getTransformPagePoint());let i=c6(n.layout.layoutBox,a);if(r){const l=r(hA(i));this.hasMutatedConstraints=!!l,l&&(i=eS(l))}return i}startAnimation(t){const{drag:r,dragMomentum:s,dragElastic:n,dragTransition:a,dragSnapToOrigin:i,onDragTransitionEnd:l}=this.getProps(),c=this.constraints||{},u=_s(d=>{if(!uu(d,r,this.currentDirection))return;let f=c&&c[d]||{};i&&(f={min:0,max:0});const h=n?200:1e6,p=n?40:1e7,m={type:"inertia",velocity:s?t[d]:0,bounceStiffness:h,bounceDamping:p,timeConstant:750,restDelta:1,restSpeed:10,...a,...f};return this.startAxisValueAnimation(d,m)});return Promise.all(u).then(l)}startAxisValueAnimation(t,r){const s=this.getAxisMotionValue(t);return rm(this.visualElement,t),s.start(ux(t,s,0,r,this.visualElement,!1))}stopAnimation(){_s(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){_s(t=>{var r;return(r=this.getAxisMotionValue(t).animation)==null?void 0:r.pause()})}getAnimationState(t){var r;return(r=this.getAxisMotionValue(t).animation)==null?void 0:r.state}getAxisMotionValue(t){const r=`_drag${t.toUpperCase()}`,s=this.visualElement.getProps(),n=s[r];return n||this.visualElement.getValue(t,(s.initial?s.initial[t]:void 0)||0)}snapToCursor(t){_s(r=>{const{drag:s}=this.getProps();if(!uu(r,s,this.currentDirection))return;const{projection:n}=this.visualElement,a=this.getAxisMotionValue(r);if(n&&n.layout){const{min:i,max:l}=n.layout.layoutBox[r];a.set(t[r]-Et(i,l,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:r}=this.getProps(),{projection:s}=this.visualElement;if(!Wi(r)||!s||!this.constraints)return;this.stopAnimation();const n={x:0,y:0};_s(i=>{const l=this.getAxisMotionValue(i);if(l&&this.constraints!==!1){const c=l.get();n[i]=u6({min:c,max:c},this.constraints[i])}});const{transformTemplate:a}=this.visualElement.getProps();this.visualElement.current.style.transform=a?a({},""):"none",s.root&&s.root.updateScroll(),s.updateLayout(),this.resolveConstraints(),_s(i=>{if(!uu(i,t,null))return;const l=this.getAxisMotionValue(i),{min:c,max:u}=this.constraints[i];l.set(Et(c,u,n[i]))})}addListeners(){if(!this.visualElement.current)return;h6.set(this.visualElement,this);const t=this.visualElement.current,r=wl(t,"pointerdown",c=>{const{drag:u,dragListener:d=!0}=this.getProps();u&&d&&this.start(c)}),s=()=>{const{dragConstraints:c}=this.getProps();Wi(c)&&c.current&&(this.constraints=this.resolveRefConstraints())},{projection:n}=this.visualElement,a=n.addEventListener("measure",s);n&&!n.layout&&(n.root&&n.root.updateScroll(),n.updateLayout()),wt.read(s);const i=tc(window,"resize",()=>this.scalePositionWithinConstraints()),l=n.addEventListener("didUpdate",({delta:c,hasLayoutChanged:u})=>{this.isDragging&&u&&(_s(d=>{const f=this.getAxisMotionValue(d);f&&(this.originPoint[d]+=c[d].translate,f.set(f.get()+c[d].translate))}),this.visualElement.render())});return()=>{i(),r(),a(),l&&l()}}getProps(){const t=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:s=!1,dragPropagation:n=!1,dragConstraints:a=!1,dragElastic:i=nm,dragMomentum:l=!0}=t;return{...t,drag:r,dragDirectionLock:s,dragPropagation:n,dragConstraints:a,dragElastic:i,dragMomentum:l}}}function uu(e,t,r){return(t===!0||t===e)&&(r===null||r===e)}function p6(e,t=10){let r=null;return Math.abs(e.y)>t?r="y":Math.abs(e.x)>t&&(r="x"),r}class x6 extends ga{constructor(t){super(t),this.removeGroupControls=Fs,this.removeListeners=Fs,this.controls=new m6(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Fs}unmount(){this.removeGroupControls(),this.removeListeners()}}const my=e=>(t,r)=>{e&&wt.postRender(()=>e(t,r))};class g6 extends ga{constructor(){super(...arguments),this.removePointerDownListener=Fs}onPointerDown(t){this.session=new xS(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:pS(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:r,onPan:s,onPanEnd:n}=this.node.getProps();return{onSessionStart:my(t),onStart:my(r),onMove:s,onEnd:(a,i)=>{delete this.session,n&&wt.postRender(()=>n(a,i))}}}mount(){this.removePointerDownListener=wl(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const qu={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function py(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const Qo={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if($e.test(e))e=parseFloat(e);else return e;const r=py(e,t.target.x),s=py(e,t.target.y);return`${r}% ${s}%`}},v6={correct:(e,{treeScale:t,projectionDelta:r})=>{const s=e,n=ca.parse(e);if(n.length>5)return s;const a=ca.createTransformer(e),i=typeof n[0]!="number"?1:0,l=r.x.scale*t.x,c=r.y.scale*t.y;n[0+i]/=l,n[1+i]/=c;const u=Et(l,c,.5);return typeof n[2+i]=="number"&&(n[2+i]/=u),typeof n[3+i]=="number"&&(n[3+i]/=u),a(n)}};let mf=!1;class y6 extends T.Component{componentDidMount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:s,layoutId:n}=this.props,{projection:a}=t;$C(w6),a&&(r.group&&r.group.add(a),s&&s.register&&n&&s.register(a),mf&&a.root.didUpdate(),a.addEventListener("animationComplete",()=>{this.safeToRemove()}),a.setOptions({...a.options,onExitComplete:()=>this.safeToRemove()})),qu.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:r,visualElement:s,drag:n,isPresent:a}=this.props,{projection:i}=s;return i&&(i.isPresent=a,mf=!0,n||t.layoutDependency!==r||r===void 0||t.isPresent!==a?i.willUpdate():this.safeToRemove(),t.isPresent!==a&&(a?i.promote():i.relegate()||wt.postRender(()=>{const l=i.getStack();(!l||!l.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),Qp.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:s}=this.props,{projection:n}=t;mf=!0,n&&(n.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(n),s&&s.deregister&&s.deregister(n))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function vS(e){const[t,r]=U_(),s=T.useContext(Ap);return o.jsx(y6,{...e,layoutGroup:s,switchLayoutGroup:T.useContext(Q_),isPresent:t,safeToRemove:r})}const w6={borderRadius:{...Qo,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Qo,borderTopRightRadius:Qo,borderBottomLeftRadius:Qo,borderBottomRightRadius:Qo,boxShadow:v6};function b6(e,t,r){const s=jr(e)?e:xo(e);return s.start(ux("",s,t,r)),s.animation}const _6=(e,t)=>e.depth-t.depth;class S6{constructor(){this.children=[],this.isDirty=!1}add(t){Rp(this.children,t),this.isDirty=!0}remove(t){Ip(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(_6),this.isDirty=!1,this.children.forEach(t)}}function k6(e,t){const r=qr.now(),s=({timestamp:n})=>{const a=n-r;a>=t&&(la(s),e(a-t))};return wt.setup(s,!0),()=>la(s)}const yS=["TopLeft","TopRight","BottomLeft","BottomRight"],N6=yS.length,xy=e=>typeof e=="string"?parseFloat(e):e,gy=e=>typeof e=="number"||$e.test(e);function j6(e,t,r,s,n,a){n?(e.opacity=Et(0,r.opacity??1,E6(s)),e.opacityExit=Et(t.opacity??1,0,T6(s))):a&&(e.opacity=Et(t.opacity??1,r.opacity??1,s));for(let i=0;i<N6;i++){const l=`border${yS[i]}Radius`;let c=vy(t,l),u=vy(r,l);if(c===void 0&&u===void 0)continue;c||(c=0),u||(u=0),c===0||u===0||gy(c)===gy(u)?(e[l]=Math.max(Et(xy(c),xy(u),s),0),(dn.test(u)||dn.test(c))&&(e[l]+="%")):e[l]=u}(t.rotate||r.rotate)&&(e.rotate=Et(t.rotate||0,r.rotate||0,s))}function vy(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const E6=wS(0,.5,i_),T6=wS(.5,.95,Fs);function wS(e,t,r){return s=>s<e?0:s>t?1:r(Yl(e,t,s))}function yy(e,t){e.min=t.min,e.max=t.max}function gs(e,t){yy(e.x,t.x),yy(e.y,t.y)}function wy(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function by(e,t,r,s,n){return e-=t,e=_d(e,1/r,s),n!==void 0&&(e=_d(e,1/n,s)),e}function C6(e,t=0,r=1,s=.5,n,a=e,i=e){if(dn.test(t)&&(t=parseFloat(t),t=Et(i.min,i.max,t/100)-i.min),typeof t!="number")return;let l=Et(a.min,a.max,s);e===a&&(l-=t),e.min=by(e.min,t,r,l,n),e.max=by(e.max,t,r,l,n)}function _y(e,t,[r,s,n],a,i){C6(e,t[r],t[s],t[n],t.scale,a,i)}const A6=["x","scaleX","originX"],F6=["y","scaleY","originY"];function Sy(e,t,r,s){_y(e.x,t,A6,r?r.x:void 0,s?s.x:void 0),_y(e.y,t,F6,r?r.y:void 0,s?s.y:void 0)}function ky(e){return e.translate===0&&e.scale===1}function bS(e){return ky(e.x)&&ky(e.y)}function Ny(e,t){return e.min===t.min&&e.max===t.max}function P6(e,t){return Ny(e.x,t.x)&&Ny(e.y,t.y)}function jy(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function _S(e,t){return jy(e.x,t.x)&&jy(e.y,t.y)}function Ey(e){return Dr(e.x)/Dr(e.y)}function Ty(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class R6{constructor(){this.members=[]}add(t){Rp(this.members,t),t.scheduleRender()}remove(t){if(Ip(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(t){const r=this.members.findIndex(n=>t===n);if(r===0)return!1;let s;for(let n=r;n>=0;n--){const a=this.members[n];if(a.isPresent!==!1){s=a;break}}return s?(this.promote(s),!0):!1}promote(t,r){const s=this.lead;if(t!==s&&(this.prevLead=s,this.lead=t,t.show(),s)){s.instance&&s.scheduleRender(),t.scheduleRender(),t.resumeFrom=s,r&&(t.resumeFrom.preserveOpacity=!0),s.snapshot&&(t.snapshot=s.snapshot,t.snapshot.latestValues=s.animationValues||s.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:n}=t.options;n===!1&&s.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:r,resumingFrom:s}=t;r.onExitComplete&&r.onExitComplete(),s&&s.options.onExitComplete&&s.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function I6(e,t,r){let s="";const n=e.x.translate/t.x,a=e.y.translate/t.y,i=(r==null?void 0:r.z)||0;if((n||a||i)&&(s=`translate3d(${n}px, ${a}px, ${i}px) `),(t.x!==1||t.y!==1)&&(s+=`scale(${1/t.x}, ${1/t.y}) `),r){const{transformPerspective:u,rotate:d,rotateX:f,rotateY:h,skewX:p,skewY:m}=r;u&&(s=`perspective(${u}px) ${s}`),d&&(s+=`rotate(${d}deg) `),f&&(s+=`rotateX(${f}deg) `),h&&(s+=`rotateY(${h}deg) `),p&&(s+=`skewX(${p}deg) `),m&&(s+=`skewY(${m}deg) `)}const l=e.x.scale*t.x,c=e.y.scale*t.y;return(l!==1||c!==1)&&(s+=`scale(${l}, ${c})`),s||"none"}const pf=["","X","Y","Z"],O6=1e3;let D6=0;function xf(e,t,r,s){const{latestValues:n}=t;n[e]&&(r[e]=n[e],t.setStaticValue(e,0),s&&(s[e]=0))}function SS(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const r=lS(t);if(window.MotionHasOptimisedAnimation(r,"transform")){const{layout:n,layoutId:a}=e.options;window.MotionCancelOptimisedAnimation(r,"transform",wt,!(n||a))}const{parent:s}=e;s&&!s.hasCheckedOptimisedAppear&&SS(s)}function kS({attachResizeListener:e,defaultParent:t,measureScroll:r,checkIsScrollRoot:s,resetTransform:n}){return class{constructor(i={},l=t==null?void 0:t()){this.id=D6++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(B6),this.nodes.forEach(V6),this.nodes.forEach(W6),this.nodes.forEach(U6)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=i,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new S6)}addEventListener(i,l){return this.eventHandlers.has(i)||this.eventHandlers.set(i,new Lp),this.eventHandlers.get(i).add(l)}notifyListeners(i,...l){const c=this.eventHandlers.get(i);c&&c.notify(...l)}hasListeners(i){return this.eventHandlers.has(i)}mount(i){if(this.instance)return;this.isSVG=B_(i)&&!jC(i),this.instance=i;const{layoutId:l,layout:c,visualElement:u}=this.options;if(u&&!u.current&&u.mount(i),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(c||l)&&(this.isLayoutDirty=!0),e){let d,f=0;const h=()=>this.root.updateBlockedByResize=!1;wt.read(()=>{f=window.innerWidth}),e(i,()=>{const p=window.innerWidth;p!==f&&(f=p,this.root.updateBlockedByResize=!0,d&&d(),d=k6(h,250),qu.hasAnimatedSinceResize&&(qu.hasAnimatedSinceResize=!1,this.nodes.forEach(Fy)))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&u&&(l||c)&&this.addEventListener("didUpdate",({delta:d,hasLayoutChanged:f,hasRelativeLayoutChanged:h,layout:p})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const m=this.options.transition||u.getDefaultTransition()||X6,{onLayoutAnimationStart:x,onLayoutAnimationComplete:g}=u.getProps(),y=!this.targetLayout||!_S(this.targetLayout,p),w=!f&&h;if(this.options.layoutRoot||this.resumeFrom||w||f&&(y||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const v={...Yp(m,"layout"),onPlay:x,onComplete:g};(u.shouldReduceMotion||this.options.layoutRoot)&&(v.delay=0,v.type=!1),this.startAnimation(v),this.setAnimationOrigin(d,w)}else f||Fy(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=p})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const i=this.getStack();i&&i.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),la(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(H6),this.animationId++)}getTransformTemplate(){const{visualElement:i}=this.options;return i&&i.getProps().transformTemplate}willUpdate(i=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&SS(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let d=0;d<this.path.length;d++){const f=this.path[d];f.shouldResetTransform=!0,f.updateScroll("snapshot"),f.options.layoutRoot&&f.willUpdate(!1)}const{layoutId:l,layout:c}=this.options;if(l===void 0&&!c)return;const u=this.getTransformTemplate();this.prevTransformTemplateValue=u?u(this.latestValues,""):void 0,this.updateSnapshot(),i&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(Cy);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(Ay);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(z6),this.nodes.forEach(L6),this.nodes.forEach(M6)):this.nodes.forEach(Ay),this.clearAllSnapshots();const l=qr.now();ur.delta=Fn(0,1e3/60,l-ur.timestamp),ur.timestamp=l,ur.isProcessing=!0,sf.update.process(ur),sf.preRender.process(ur),sf.render.process(ur),ur.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,Qp.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach($6),this.sharedNodes.forEach(q6)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,wt.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){wt.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!Dr(this.snapshot.measuredBox.x)&&!Dr(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const i=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Bt(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:l}=this.options;l&&l.notify("LayoutMeasure",this.layout.layoutBox,i?i.layoutBox:void 0)}updateScroll(i="measure"){let l=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===i&&(l=!1),l&&this.instance){const c=s(this.instance);this.scroll={animationId:this.root.animationId,phase:i,isRoot:c,offset:r(this.instance),wasRoot:this.scroll?this.scroll.isRoot:c}}}resetTransform(){if(!n)return;const i=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,l=this.projectionDelta&&!bS(this.projectionDelta),c=this.getTransformTemplate(),u=c?c(this.latestValues,""):void 0,d=u!==this.prevTransformTemplateValue;i&&this.instance&&(l||Ca(this.latestValues)||d)&&(n(this.instance,u),this.shouldResetTransform=!1,this.scheduleRender())}measure(i=!0){const l=this.measurePageBox();let c=this.removeElementScroll(l);return i&&(c=this.removeTransform(c)),Y6(c),{animationId:this.root.animationId,measuredBox:l,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){var u;const{visualElement:i}=this.options;if(!i)return Bt();const l=i.measureViewportBox();if(!(((u=this.scroll)==null?void 0:u.wasRoot)||this.path.some(J6))){const{scroll:d}=this.root;d&&(Hi(l.x,d.offset.x),Hi(l.y,d.offset.y))}return l}removeElementScroll(i){var c;const l=Bt();if(gs(l,i),(c=this.scroll)!=null&&c.wasRoot)return l;for(let u=0;u<this.path.length;u++){const d=this.path[u],{scroll:f,options:h}=d;d!==this.root&&f&&h.layoutScroll&&(f.wasRoot&&gs(l,i),Hi(l.x,f.offset.x),Hi(l.y,f.offset.y))}return l}applyTransform(i,l=!1){const c=Bt();gs(c,i);for(let u=0;u<this.path.length;u++){const d=this.path[u];!l&&d.options.layoutScroll&&d.scroll&&d!==d.root&&qi(c,{x:-d.scroll.offset.x,y:-d.scroll.offset.y}),Ca(d.latestValues)&&qi(c,d.latestValues)}return Ca(this.latestValues)&&qi(c,this.latestValues),c}removeTransform(i){const l=Bt();gs(l,i);for(let c=0;c<this.path.length;c++){const u=this.path[c];if(!u.instance||!Ca(u.latestValues))continue;Qh(u.latestValues)&&u.updateSnapshot();const d=Bt(),f=u.measurePageBox();gs(d,f),Sy(l,u.latestValues,u.snapshot?u.snapshot.layoutBox:void 0,d)}return Ca(this.latestValues)&&Sy(l,this.latestValues),l}setTargetDelta(i){this.targetDelta=i,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(i){this.options={...this.options,...i,crossfade:i.crossfade!==void 0?i.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==ur.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(i=!1){var h;const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const c=!!this.resumingFrom||this!==l;if(!(i||c&&this.isSharedProjectionDirty||this.isProjectionDirty||(h=this.parent)!=null&&h.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:d,layoutId:f}=this.options;if(!(!this.layout||!(d||f))){if(this.resolvedRelativeTargetAt=ur.timestamp,!this.targetDelta&&!this.relativeTarget){const p=this.getClosestProjectingParent();p&&p.layout&&this.animationProgress!==1?(this.relativeParent=p,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Bt(),this.relativeTargetOrigin=Bt(),_l(this.relativeTargetOrigin,this.layout.layoutBox,p.layout.layoutBox),gs(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=Bt(),this.targetWithTransforms=Bt()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),s6(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):gs(this.target,this.layout.layoutBox),rS(this.target,this.targetDelta)):gs(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const p=this.getClosestProjectingParent();p&&!!p.resumingFrom==!!this.resumingFrom&&!p.options.layoutScroll&&p.target&&this.animationProgress!==1?(this.relativeParent=p,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Bt(),this.relativeTargetOrigin=Bt(),_l(this.relativeTargetOrigin,this.target,p.target),gs(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||Qh(this.parent.latestValues)||tS(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var m;const i=this.getLead(),l=!!this.resumingFrom||this!==i;let c=!0;if((this.isProjectionDirty||(m=this.parent)!=null&&m.isProjectionDirty)&&(c=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),this.resolvedRelativeTargetAt===ur.timestamp&&(c=!1),c)return;const{layout:u,layoutId:d}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(u||d))return;gs(this.layoutCorrected,this.layout.layoutBox);const f=this.treeScale.x,h=this.treeScale.y;pA(this.layoutCorrected,this.treeScale,this.path,l),i.layout&&!i.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(i.target=i.layout.layoutBox,i.targetWithTransforms=Bt());const{target:p}=i;if(!p){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(wy(this.prevProjectionDelta.x,this.projectionDelta.x),wy(this.prevProjectionDelta.y,this.projectionDelta.y)),bl(this.projectionDelta,this.layoutCorrected,p,this.latestValues),(this.treeScale.x!==f||this.treeScale.y!==h||!Ty(this.projectionDelta.x,this.prevProjectionDelta.x)||!Ty(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",p))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(i=!0){var l;if((l=this.options.visualElement)==null||l.scheduleRender(),i){const c=this.getStack();c&&c.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Gi(),this.projectionDelta=Gi(),this.projectionDeltaWithTransform=Gi()}setAnimationOrigin(i,l=!1){const c=this.snapshot,u=c?c.latestValues:{},d={...this.latestValues},f=Gi();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!l;const h=Bt(),p=c?c.source:void 0,m=this.layout?this.layout.source:void 0,x=p!==m,g=this.getStack(),y=!g||g.members.length<=1,w=!!(x&&!y&&this.options.crossfade===!0&&!this.path.some(K6));this.animationProgress=0;let v;this.mixTargetDelta=b=>{const _=b/1e3;Py(f.x,i.x,_),Py(f.y,i.y,_),this.setTargetDelta(f),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(_l(h,this.layout.layoutBox,this.relativeParent.layout.layoutBox),G6(this.relativeTarget,this.relativeTargetOrigin,h,_),v&&P6(this.relativeTarget,v)&&(this.isProjectionDirty=!1),v||(v=Bt()),gs(v,this.relativeTarget)),x&&(this.animationValues=d,j6(d,u,this.latestValues,_,w,y)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=_},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(i){var l,c,u;this.notifyListeners("animationStart"),(l=this.currentAnimation)==null||l.stop(),(u=(c=this.resumingFrom)==null?void 0:c.currentAnimation)==null||u.stop(),this.pendingAnimation&&(la(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=wt.update(()=>{qu.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=xo(0)),this.currentAnimation=b6(this.motionValue,[0,1e3],{...i,velocity:0,isSync:!0,onUpdate:d=>{this.mixTargetDelta(d),i.onUpdate&&i.onUpdate(d)},onStop:()=>{},onComplete:()=>{i.onComplete&&i.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const i=this.getStack();i&&i.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(O6),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const i=this.getLead();let{targetWithTransforms:l,target:c,layout:u,latestValues:d}=i;if(!(!l||!c||!u)){if(this!==i&&this.layout&&u&&NS(this.options.animationType,this.layout.layoutBox,u.layoutBox)){c=this.target||Bt();const f=Dr(this.layout.layoutBox.x);c.x.min=i.target.x.min,c.x.max=c.x.min+f;const h=Dr(this.layout.layoutBox.y);c.y.min=i.target.y.min,c.y.max=c.y.min+h}gs(l,c),qi(l,d),bl(this.projectionDeltaWithTransform,this.layoutCorrected,l,d)}}registerSharedNode(i,l){this.sharedNodes.has(i)||this.sharedNodes.set(i,new R6),this.sharedNodes.get(i).add(l);const u=l.options.initialPromotionConfig;l.promote({transition:u?u.transition:void 0,preserveFollowOpacity:u&&u.shouldPreserveFollowOpacity?u.shouldPreserveFollowOpacity(l):void 0})}isLead(){const i=this.getStack();return i?i.lead===this:!0}getLead(){var l;const{layoutId:i}=this.options;return i?((l=this.getStack())==null?void 0:l.lead)||this:this}getPrevLead(){var l;const{layoutId:i}=this.options;return i?(l=this.getStack())==null?void 0:l.prevLead:void 0}getStack(){const{layoutId:i}=this.options;if(i)return this.root.sharedNodes.get(i)}promote({needsReset:i,transition:l,preserveFollowOpacity:c}={}){const u=this.getStack();u&&u.promote(this,c),i&&(this.projectionDelta=void 0,this.needsReset=!0),l&&this.setOptions({transition:l})}relegate(){const i=this.getStack();return i?i.relegate(this):!1}resetSkewAndRotation(){const{visualElement:i}=this.options;if(!i)return;let l=!1;const{latestValues:c}=i;if((c.z||c.rotate||c.rotateX||c.rotateY||c.rotateZ||c.skewX||c.skewY)&&(l=!0),!l)return;const u={};c.z&&xf("z",i,u,this.animationValues);for(let d=0;d<pf.length;d++)xf(`rotate${pf[d]}`,i,u,this.animationValues),xf(`skew${pf[d]}`,i,u,this.animationValues);i.render();for(const d in u)i.setStaticValue(d,u[d]),this.animationValues&&(this.animationValues[d]=u[d]);i.scheduleRender()}applyProjectionStyles(i,l){if(!this.instance||this.isSVG)return;if(!this.isVisible){i.visibility="hidden";return}const c=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,i.visibility="",i.opacity="",i.pointerEvents=Hu(l==null?void 0:l.pointerEvents)||"",i.transform=c?c(this.latestValues,""):"none";return}const u=this.getLead();if(!this.projectionDelta||!this.layout||!u.target){this.options.layoutId&&(i.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,i.pointerEvents=Hu(l==null?void 0:l.pointerEvents)||""),this.hasProjected&&!Ca(this.latestValues)&&(i.transform=c?c({},""):"none",this.hasProjected=!1);return}i.visibility="";const d=u.animationValues||u.latestValues;this.applyTransformsToTarget();let f=I6(this.projectionDeltaWithTransform,this.treeScale,d);c&&(f=c(d,f)),i.transform=f;const{x:h,y:p}=this.projectionDelta;i.transformOrigin=`${h.origin*100}% ${p.origin*100}% 0`,u.animationValues?i.opacity=u===this?d.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:d.opacityExit:i.opacity=u===this?d.opacity!==void 0?d.opacity:"":d.opacityExit!==void 0?d.opacityExit:0;for(const m in ec){if(d[m]===void 0)continue;const{correct:x,applyTo:g,isCSSVariable:y}=ec[m],w=f==="none"?d[m]:x(d[m],u);if(g){const v=g.length;for(let b=0;b<v;b++)i[g[b]]=w}else y?this.options.visualElement.renderState.vars[m]=w:i[m]=w}this.options.layoutId&&(i.pointerEvents=u===this?Hu(l==null?void 0:l.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(i=>{var l;return(l=i.currentAnimation)==null?void 0:l.stop()}),this.root.nodes.forEach(Cy),this.root.sharedNodes.clear()}}}function L6(e){e.updateLayout()}function M6(e){var r;const t=((r=e.resumeFrom)==null?void 0:r.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&t&&e.hasListeners("didUpdate")){const{layoutBox:s,measuredBox:n}=e.layout,{animationType:a}=e.options,i=t.source!==e.layout.source;a==="size"?_s(f=>{const h=i?t.measuredBox[f]:t.layoutBox[f],p=Dr(h);h.min=s[f].min,h.max=h.min+p}):NS(a,t.layoutBox,s)&&_s(f=>{const h=i?t.measuredBox[f]:t.layoutBox[f],p=Dr(s[f]);h.max=h.min+p,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[f].max=e.relativeTarget[f].min+p)});const l=Gi();bl(l,s,t.layoutBox);const c=Gi();i?bl(c,e.applyTransform(n,!0),t.measuredBox):bl(c,s,t.layoutBox);const u=!bS(l);let d=!1;if(!e.resumeFrom){const f=e.getClosestProjectingParent();if(f&&!f.resumeFrom){const{snapshot:h,layout:p}=f;if(h&&p){const m=Bt();_l(m,t.layoutBox,h.layoutBox);const x=Bt();_l(x,s,p.layoutBox),_S(m,x)||(d=!0),f.options.layoutRoot&&(e.relativeTarget=x,e.relativeTargetOrigin=m,e.relativeParent=f)}}}e.notifyListeners("didUpdate",{layout:s,snapshot:t,delta:c,layoutDelta:l,hasLayoutChanged:u,hasRelativeLayoutChanged:d})}else if(e.isLead()){const{onExitComplete:s}=e.options;s&&s()}e.options.transition=void 0}function B6(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function U6(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function $6(e){e.clearSnapshot()}function Cy(e){e.clearMeasurements()}function Ay(e){e.isLayoutDirty=!1}function z6(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function Fy(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function V6(e){e.resolveTargetDelta()}function W6(e){e.calcProjection()}function H6(e){e.resetSkewAndRotation()}function q6(e){e.removeLeadSnapshot()}function Py(e,t,r){e.translate=Et(t.translate,0,r),e.scale=Et(t.scale,1,r),e.origin=t.origin,e.originPoint=t.originPoint}function Ry(e,t,r,s){e.min=Et(t.min,r.min,s),e.max=Et(t.max,r.max,s)}function G6(e,t,r,s){Ry(e.x,t.x,r.x,s),Ry(e.y,t.y,r.y,s)}function K6(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const X6={duration:.45,ease:[.4,0,.1,1]},Iy=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),Oy=Iy("applewebkit/")&&!Iy("chrome/")?Math.round:Fs;function Dy(e){e.min=Oy(e.min),e.max=Oy(e.max)}function Y6(e){Dy(e.x),Dy(e.y)}function NS(e,t,r){return e==="position"||e==="preserve-aspect"&&!r6(Ey(t),Ey(r),.2)}function J6(e){var t;return e!==e.root&&((t=e.scroll)==null?void 0:t.wasRoot)}const Q6=kS({attachResizeListener:(e,t)=>tc(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),gf={current:void 0},jS=kS({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!gf.current){const e=new Q6({});e.mount(window),e.setOptions({layoutScroll:!0}),gf.current=e}return gf.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),Z6={pan:{Feature:g6},drag:{Feature:x6,ProjectionNode:jS,MeasureLayout:vS}};function Ly(e,t,r){const{props:s}=e;e.animationState&&s.whileHover&&e.animationState.setActive("whileHover",r==="Start");const n="onHover"+r,a=s[n];a&&wt.postRender(()=>a(t,Tc(t)))}class eF extends ga{mount(){const{current:t}=this.node;t&&(this.unmount=bC(t,(r,s)=>(Ly(this.node,s,"Start"),n=>Ly(this.node,n,"End"))))}unmount(){}}class tF extends ga{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Nc(tc(this.node.current,"focus",()=>this.onFocus()),tc(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function My(e,t,r){const{props:s}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&s.whileTap&&e.animationState.setActive("whileTap",r==="Start");const n="onTap"+(r==="End"?"":r),a=s[n];a&&wt.postRender(()=>a(t,Tc(t)))}class rF extends ga{mount(){const{current:t}=this.node;t&&(this.unmount=NC(t,(r,s)=>(My(this.node,s,"Start"),(n,{success:a})=>My(this.node,n,a?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const am=new WeakMap,vf=new WeakMap,sF=e=>{const t=am.get(e.target);t&&t(e)},nF=e=>{e.forEach(sF)};function aF({root:e,...t}){const r=e||document;vf.has(r)||vf.set(r,{});const s=vf.get(r),n=JSON.stringify(t);return s[n]||(s[n]=new IntersectionObserver(nF,{root:e,...t})),s[n]}function iF(e,t,r){const s=aF(t);return am.set(e,r),s.observe(e),()=>{am.delete(e),s.unobserve(e)}}const oF={some:0,all:1};class lF extends ga{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:r,margin:s,amount:n="some",once:a}=t,i={root:r?r.current:void 0,rootMargin:s,threshold:typeof n=="number"?n:oF[n]},l=c=>{const{isIntersecting:u}=c;if(this.isInView===u||(this.isInView=u,a&&!u&&this.hasEnteredView))return;u&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",u);const{onViewportEnter:d,onViewportLeave:f}=this.node.getProps(),h=u?d:f;h&&h(c)};return iF(this.node.current,i,l)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:r}=this.node;["amount","margin","root"].some(cF(t,r))&&this.startObserver()}unmount(){}}function cF({viewport:e={}},{viewport:t={}}={}){return r=>e[r]!==t[r]}const uF={inView:{Feature:lF},tap:{Feature:rF},focus:{Feature:tF},hover:{Feature:eF}},dF={layout:{ProjectionNode:jS,MeasureLayout:vS}},fF={...YA,...uF,...Z6,...dF},vo=fA(fF,NA);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var hF={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mF=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Te=(e,t)=>{const r=T.forwardRef(({color:s="currentColor",size:n=24,strokeWidth:a=2,absoluteStrokeWidth:i,className:l="",children:c,...u},d)=>T.createElement("svg",{ref:d,...hF,width:n,height:n,stroke:s,strokeWidth:i?Number(a)*24/Number(n):a,className:["lucide",`lucide-${mF(e)}`,l].join(" "),...u},[...t.map(([f,h])=>T.createElement(f,h)),...Array.isArray(c)?c:[c]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const By=Te("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const it=Te("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qa=Te("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d0=Te("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pF=Te("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uy=Te("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xF=Te("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gF=Te("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vF=Te("BookDashed",[["path",{d:"M20 22h-2",key:"1rpnb6"}],["path",{d:"M20 15v2h-2",key:"fph276"}],["path",{d:"M4 19.5V15",key:"6gr39e"}],["path",{d:"M20 8v3",key:"deu0bs"}],["path",{d:"M18 2h2v2",key:"180o53"}],["path",{d:"M4 11V9",key:"v3xsx8"}],["path",{d:"M12 2h2",key:"cvn524"}],["path",{d:"M12 22h2",key:"kn7ki6"}],["path",{d:"M12 17h2",key:"13u4lk"}],["path",{d:"M8 22H6.5a2.5 2.5 0 0 1 0-5H8",key:"fiseg2"}],["path",{d:"M4 5v-.5A2.5 2.5 0 0 1 6.5 2H8",key:"wywhs9"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ES=Te("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yo=Te("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TS=Te("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sd=Te("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kr=Te("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $y=Te("CheckSquare",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dx=Te("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wo=Te("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fx=Te("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cc=Te("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yF=Te("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zy=Te("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wF=Te("ClipboardCheck",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bF=Te("Clipboard",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ac=Te("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _F=Te("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SF=Te("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ki=Te("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const si=Te("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kF=Te("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NF=Te("FileDown",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jF=Te("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $t=Te("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vy=Te("FileUp",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"m15 15-3-3-3 3",key:"15xj92"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CS=Te("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EF=Te("Flame",[["path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z",key:"96xj49"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const im=Te("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TF=Te("FormInput",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["path",{d:"M12 12h.01",key:"1mp3jc"}],["path",{d:"M17 12h.01",key:"1m0b6t"}],["path",{d:"M7 12h.01",key:"eqddd0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CF=Te("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AF=Te("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FF=Te("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kd=Te("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PF=Te("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const om=Te("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RF=Te("Library",[["path",{d:"m16 6 4 14",key:"ji33uf"}],["path",{d:"M12 6v14",key:"1n7gus"}],["path",{d:"M8 8v12",key:"1gg7y9"}],["path",{d:"M4 4v16",key:"6qkkli"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IF=Te("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qs=Te("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OF=Te("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AS=Te("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DF=Te("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FS=Te("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yf=Te("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ga=Te("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hx=Te("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cs=Te("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lm=Te("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nd=Te("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LF=Te("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jd=Te("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MF=Te("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f0=Te("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fc=Te("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BF=Te("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wy=Te("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PS=Te("Table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RS=Te("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bo=Te("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Po=Te("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rc=Te("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mx=Te("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IS=Te("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UF=Te("Wand2",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72Z",key:"1bcowg"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wf=Te("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h0=Te("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qr=Te("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $F=Te("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);var cm=function(e,t){return cm=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,s){r.__proto__=s}||function(r,s){for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(r[n]=s[n])},cm(e,t)};function OS(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");cm(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var Ed=function(){return Ed=Object.assign||function(t){for(var r,s=1,n=arguments.length;s<n;s++){r=arguments[s];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a])}return t},Ed.apply(this,arguments)};function Ro(e,t){var r={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(r[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(e);n<s.length;n++)t.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(e,s[n])&&(r[s[n]]=e[s[n]]);return r}function DS(e,t,r,s){var n=arguments.length,a=n<3?t:s===null?s=Object.getOwnPropertyDescriptor(t,r):s,i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(e,t,r,s);else for(var l=e.length-1;l>=0;l--)(i=e[l])&&(a=(n<3?i(a):n>3?i(t,r,a):i(t,r))||a);return n>3&&a&&Object.defineProperty(t,r,a),a}function LS(e,t){return function(r,s){t(r,s,e)}}function MS(e,t,r,s,n,a){function i(y){if(y!==void 0&&typeof y!="function")throw new TypeError("Function expected");return y}for(var l=s.kind,c=l==="getter"?"get":l==="setter"?"set":"value",u=!t&&e?s.static?e:e.prototype:null,d=t||(u?Object.getOwnPropertyDescriptor(u,s.name):{}),f,h=!1,p=r.length-1;p>=0;p--){var m={};for(var x in s)m[x]=x==="access"?{}:s[x];for(var x in s.access)m.access[x]=s.access[x];m.addInitializer=function(y){if(h)throw new TypeError("Cannot add initializers after decoration has completed");a.push(i(y||null))};var g=(0,r[p])(l==="accessor"?{get:d.get,set:d.set}:d[c],m);if(l==="accessor"){if(g===void 0)continue;if(g===null||typeof g!="object")throw new TypeError("Object expected");(f=i(g.get))&&(d.get=f),(f=i(g.set))&&(d.set=f),(f=i(g.init))&&n.unshift(f)}else(f=i(g))&&(l==="field"?n.unshift(f):d[c]=f)}u&&Object.defineProperty(u,s.name,d),h=!0}function BS(e,t,r){for(var s=arguments.length>2,n=0;n<t.length;n++)r=s?t[n].call(e,r):t[n].call(e);return s?r:void 0}function US(e){return typeof e=="symbol"?e:"".concat(e)}function $S(e,t,r){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function zS(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function Ie(e,t,r,s){function n(a){return a instanceof r?a:new r(function(i){i(a)})}return new(r||(r=Promise))(function(a,i){function l(d){try{u(s.next(d))}catch(f){i(f)}}function c(d){try{u(s.throw(d))}catch(f){i(f)}}function u(d){d.done?a(d.value):n(d.value).then(l,c)}u((s=s.apply(e,t||[])).next())})}function VS(e,t){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},s,n,a,i=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function l(u){return function(d){return c([u,d])}}function c(u){if(s)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(r=0)),r;)try{if(s=1,n&&(a=u[0]&2?n.return:u[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,u[1])).done)return a;switch(n=0,a&&(u=[u[0]&2,a.value]),u[0]){case 0:case 1:a=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,n=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!a||u[1]>a[0]&&u[1]<a[3])){r.label=u[1];break}if(u[0]===6&&r.label<a[1]){r.label=a[1],a=u;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(u);break}a[2]&&r.ops.pop(),r.trys.pop();continue}u=t.call(e,r)}catch(d){u=[6,d],n=0}finally{s=a=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}var m0=Object.create?function(e,t,r,s){s===void 0&&(s=r);var n=Object.getOwnPropertyDescriptor(t,r);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,s,n)}:function(e,t,r,s){s===void 0&&(s=r),e[s]=t[r]};function WS(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&m0(t,e,r)}function Td(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],s=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&s>=e.length&&(e=void 0),{value:e&&e[s++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function px(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var s=r.call(e),n,a=[],i;try{for(;(t===void 0||t-- >0)&&!(n=s.next()).done;)a.push(n.value)}catch(l){i={error:l}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return a}function HS(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(px(arguments[t]));return e}function qS(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var s=Array(e),n=0,t=0;t<r;t++)for(var a=arguments[t],i=0,l=a.length;i<l;i++,n++)s[n]=a[i];return s}function GS(e,t,r){if(r||arguments.length===2)for(var s=0,n=t.length,a;s<n;s++)(a||!(s in t))&&(a||(a=Array.prototype.slice.call(t,0,s)),a[s]=t[s]);return e.concat(a||Array.prototype.slice.call(t))}function _o(e){return this instanceof _o?(this.v=e,this):new _o(e)}function KS(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=r.apply(e,t||[]),n,a=[];return n=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),l("next"),l("throw"),l("return",i),n[Symbol.asyncIterator]=function(){return this},n;function i(p){return function(m){return Promise.resolve(m).then(p,f)}}function l(p,m){s[p]&&(n[p]=function(x){return new Promise(function(g,y){a.push([p,x,g,y])>1||c(p,x)})},m&&(n[p]=m(n[p])))}function c(p,m){try{u(s[p](m))}catch(x){h(a[0][3],x)}}function u(p){p.value instanceof _o?Promise.resolve(p.value.v).then(d,f):h(a[0][2],p)}function d(p){c("next",p)}function f(p){c("throw",p)}function h(p,m){p(m),a.shift(),a.length&&c(a[0][0],a[0][1])}}function XS(e){var t,r;return t={},s("next"),s("throw",function(n){throw n}),s("return"),t[Symbol.iterator]=function(){return this},t;function s(n,a){t[n]=e[n]?function(i){return(r=!r)?{value:_o(e[n](i)),done:!1}:a?a(i):i}:a}}function YS(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof Td=="function"?Td(e):e[Symbol.iterator](),r={},s("next"),s("throw"),s("return"),r[Symbol.asyncIterator]=function(){return this},r);function s(a){r[a]=e[a]&&function(i){return new Promise(function(l,c){i=e[a](i),n(l,c,i.done,i.value)})}}function n(a,i,l,c){Promise.resolve(c).then(function(u){a({value:u,done:l})},i)}}function JS(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var zF=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t},um=function(e){return um=Object.getOwnPropertyNames||function(t){var r=[];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(r[r.length]=s);return r},um(e)};function QS(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r=um(e),s=0;s<r.length;s++)r[s]!=="default"&&m0(t,e,r[s]);return zF(t,e),t}function ZS(e){return e&&e.__esModule?e:{default:e}}function ek(e,t,r,s){if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?s:r==="a"?s.call(e):s?s.value:t.get(e)}function tk(e,t,r,s,n){if(s==="m")throw new TypeError("Private method is not writable");if(s==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return s==="a"?n.call(e,r):n?n.value=r:t.set(e,r),r}function rk(e,t){if(t===null||typeof t!="object"&&typeof t!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof e=="function"?t===e:e.has(t)}function sk(e,t,r){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var s,n;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");s=t[Symbol.asyncDispose]}if(s===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");s=t[Symbol.dispose],r&&(n=s)}if(typeof s!="function")throw new TypeError("Object not disposable.");n&&(s=function(){try{n.call(this)}catch(a){return Promise.reject(a)}}),e.stack.push({value:t,dispose:s,async:r})}else r&&e.stack.push({async:!0});return t}var VF=typeof SuppressedError=="function"?SuppressedError:function(e,t,r){var s=new Error(r);return s.name="SuppressedError",s.error=e,s.suppressed=t,s};function nk(e){function t(a){e.error=e.hasError?new VF(a,e.error,"An error was suppressed during disposal."):a,e.hasError=!0}var r,s=0;function n(){for(;r=e.stack.pop();)try{if(!r.async&&s===1)return s=0,e.stack.push(r),Promise.resolve().then(n);if(r.dispose){var a=r.dispose.call(r.value);if(r.async)return s|=2,Promise.resolve(a).then(n,function(i){return t(i),n()})}else s|=1}catch(i){t(i)}if(s===1)return e.hasError?Promise.reject(e.error):Promise.resolve();if(e.hasError)throw e.error}return n()}function ak(e,t){return typeof e=="string"&&/^\.\.?\//.test(e)?e.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(r,s,n,a,i){return s?t?".jsx":".js":n&&(!a||!i)?r:n+a+"."+i.toLowerCase()+"js"}):e}const WF={__extends:OS,__assign:Ed,__rest:Ro,__decorate:DS,__param:LS,__esDecorate:MS,__runInitializers:BS,__propKey:US,__setFunctionName:$S,__metadata:zS,__awaiter:Ie,__generator:VS,__createBinding:m0,__exportStar:WS,__values:Td,__read:px,__spread:HS,__spreadArrays:qS,__spreadArray:GS,__await:_o,__asyncGenerator:KS,__asyncDelegator:XS,__asyncValues:YS,__makeTemplateObject:JS,__importStar:QS,__importDefault:ZS,__classPrivateFieldGet:ek,__classPrivateFieldSet:tk,__classPrivateFieldIn:rk,__addDisposableResource:sk,__disposeResources:nk,__rewriteRelativeImportExtension:ak},HF=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:sk,get __assign(){return Ed},__asyncDelegator:XS,__asyncGenerator:KS,__asyncValues:YS,__await:_o,__awaiter:Ie,__classPrivateFieldGet:ek,__classPrivateFieldIn:rk,__classPrivateFieldSet:tk,__createBinding:m0,__decorate:DS,__disposeResources:nk,__esDecorate:MS,__exportStar:WS,__extends:OS,__generator:VS,__importDefault:ZS,__importStar:QS,__makeTemplateObject:JS,__metadata:zS,__param:LS,__propKey:US,__read:px,__rest:Ro,__rewriteRelativeImportExtension:ak,__runInitializers:BS,__setFunctionName:$S,__spread:HS,__spreadArray:GS,__spreadArrays:qS,__values:Td,default:WF},Symbol.toStringTag,{value:"Module"})),qF=e=>e?(...t)=>e(...t):(...t)=>fetch(...t);class xx extends Error{constructor(t,r="FunctionsError",s){super(t),this.name=r,this.context=s}}class GF extends xx{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class Hy extends xx{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class qy extends xx{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var dm;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(dm||(dm={}));class KF{constructor(t,{headers:r={},customFetch:s,region:n=dm.Any}={}){this.url=t,this.headers=r,this.region=n,this.fetch=qF(s)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return Ie(this,arguments,void 0,function*(r,s={}){var n;let a,i;try{const{headers:l,method:c,body:u,signal:d,timeout:f}=s;let h={},{region:p}=s;p||(p=this.region);const m=new URL(`${this.url}/${r}`);p&&p!=="any"&&(h["x-region"]=p,m.searchParams.set("forceFunctionRegion",p));let x;u&&(l&&!Object.prototype.hasOwnProperty.call(l,"Content-Type")||!l)?typeof Blob<"u"&&u instanceof Blob||u instanceof ArrayBuffer?(h["Content-Type"]="application/octet-stream",x=u):typeof u=="string"?(h["Content-Type"]="text/plain",x=u):typeof FormData<"u"&&u instanceof FormData?x=u:(h["Content-Type"]="application/json",x=JSON.stringify(u)):x=u;let g=d;f&&(i=new AbortController,a=setTimeout(()=>i.abort(),f),d?(g=i.signal,d.addEventListener("abort",()=>i.abort())):g=i.signal);const y=yield this.fetch(m.toString(),{method:c||"POST",headers:Object.assign(Object.assign(Object.assign({},h),this.headers),l),body:x,signal:g}).catch(_=>{throw new GF(_)}),w=y.headers.get("x-relay-error");if(w&&w==="true")throw new Hy(y);if(!y.ok)throw new qy(y);let v=((n=y.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),b;return v==="application/json"?b=yield y.json():v==="application/octet-stream"||v==="application/pdf"?b=yield y.blob():v==="text/event-stream"?b=y:v==="multipart/form-data"?b=yield y.formData():b=yield y.text(),{data:b,error:null,response:y}}catch(l){return{data:null,error:l,response:l instanceof qy||l instanceof Hy?l.context:void 0}}finally{a&&clearTimeout(a)}})}}var Or={};const Io=aE(HF);var du={},fu={},hu={},mu={},pu={},xu={},Gy;function ik(){if(Gy)return xu;Gy=1,Object.defineProperty(xu,"__esModule",{value:!0});class e extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}}return xu.default=e,xu}var Ky;function ok(){if(Ky)return pu;Ky=1,Object.defineProperty(pu,"__esModule",{value:!0});const t=Io.__importDefault(ik());class r{constructor(n){var a,i;this.shouldThrowOnError=!1,this.method=n.method,this.url=n.url,this.headers=new Headers(n.headers),this.schema=n.schema,this.body=n.body,this.shouldThrowOnError=(a=n.shouldThrowOnError)!==null&&a!==void 0?a:!1,this.signal=n.signal,this.isMaybeSingle=(i=n.isMaybeSingle)!==null&&i!==void 0?i:!1,n.fetch?this.fetch=n.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(n,a){return this.headers=new Headers(this.headers),this.headers.set(n,a),this}then(n,a){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const i=this.fetch;let l=i(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async c=>{var u,d,f,h;let p=null,m=null,x=null,g=c.status,y=c.statusText;if(c.ok){if(this.method!=="HEAD"){const _=await c.text();_===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((u=this.headers.get("Accept"))===null||u===void 0)&&u.includes("application/vnd.pgrst.plan+text"))?m=_:m=JSON.parse(_))}const v=(d=this.headers.get("Prefer"))===null||d===void 0?void 0:d.match(/count=(exact|planned|estimated)/),b=(f=c.headers.get("content-range"))===null||f===void 0?void 0:f.split("/");v&&b&&b.length>1&&(x=parseInt(b[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(m)&&(m.length>1?(p={code:"PGRST116",details:`Results contain ${m.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},m=null,x=null,g=406,y="Not Acceptable"):m.length===1?m=m[0]:m=null)}else{const v=await c.text();try{p=JSON.parse(v),Array.isArray(p)&&c.status===404&&(m=[],p=null,g=200,y="OK")}catch{c.status===404&&v===""?(g=204,y="No Content"):p={message:v}}if(p&&this.isMaybeSingle&&(!((h=p==null?void 0:p.details)===null||h===void 0)&&h.includes("0 rows"))&&(p=null,g=200,y="OK"),p&&this.shouldThrowOnError)throw new t.default(p)}return{error:p,data:m,count:x,status:g,statusText:y}});return this.shouldThrowOnError||(l=l.catch(c=>{var u,d,f,h,p,m;let x="";const g=c==null?void 0:c.cause;if(g){const y=(u=g==null?void 0:g.message)!==null&&u!==void 0?u:"",w=(d=g==null?void 0:g.code)!==null&&d!==void 0?d:"";x=`${(f=c==null?void 0:c.name)!==null&&f!==void 0?f:"FetchError"}: ${c==null?void 0:c.message}`,x+=`

Caused by: ${(h=g==null?void 0:g.name)!==null&&h!==void 0?h:"Error"}: ${y}`,w&&(x+=` (${w})`),g!=null&&g.stack&&(x+=`
${g.stack}`)}else x=(p=c==null?void 0:c.stack)!==null&&p!==void 0?p:"";return{error:{message:`${(m=c==null?void 0:c.name)!==null&&m!==void 0?m:"FetchError"}: ${c==null?void 0:c.message}`,details:x,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),l.then(n,a)}returns(){return this}overrideTypes(){return this}}return pu.default=r,pu}var Xy;function lk(){if(Xy)return mu;Xy=1,Object.defineProperty(mu,"__esModule",{value:!0});const t=Io.__importDefault(ok());class r extends t.default{select(n){let a=!1;const i=(n??"*").split("").map(l=>/\s/.test(l)&&!a?"":(l==='"'&&(a=!a),l)).join("");return this.url.searchParams.set("select",i),this.headers.append("Prefer","return=representation"),this}order(n,{ascending:a=!0,nullsFirst:i,foreignTable:l,referencedTable:c=l}={}){const u=c?`${c}.order`:"order",d=this.url.searchParams.get(u);return this.url.searchParams.set(u,`${d?`${d},`:""}${n}.${a?"asc":"desc"}${i===void 0?"":i?".nullsfirst":".nullslast"}`),this}limit(n,{foreignTable:a,referencedTable:i=a}={}){const l=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(l,`${n}`),this}range(n,a,{foreignTable:i,referencedTable:l=i}={}){const c=typeof l>"u"?"offset":`${l}.offset`,u=typeof l>"u"?"limit":`${l}.limit`;return this.url.searchParams.set(c,`${n}`),this.url.searchParams.set(u,`${a-n+1}`),this}abortSignal(n){return this.signal=n,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:n=!1,verbose:a=!1,settings:i=!1,buffers:l=!1,wal:c=!1,format:u="text"}={}){var d;const f=[n?"analyze":null,a?"verbose":null,i?"settings":null,l?"buffers":null,c?"wal":null].filter(Boolean).join("|"),h=(d=this.headers.get("Accept"))!==null&&d!==void 0?d:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${u}; for="${h}"; options=${f};`),u==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(n){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${n}`),this}}return mu.default=r,mu}var Yy;function gx(){if(Yy)return hu;Yy=1,Object.defineProperty(hu,"__esModule",{value:!0});const t=Io.__importDefault(lk()),r=new RegExp("[,()]");class s extends t.default{eq(a,i){return this.url.searchParams.append(a,`eq.${i}`),this}neq(a,i){return this.url.searchParams.append(a,`neq.${i}`),this}gt(a,i){return this.url.searchParams.append(a,`gt.${i}`),this}gte(a,i){return this.url.searchParams.append(a,`gte.${i}`),this}lt(a,i){return this.url.searchParams.append(a,`lt.${i}`),this}lte(a,i){return this.url.searchParams.append(a,`lte.${i}`),this}like(a,i){return this.url.searchParams.append(a,`like.${i}`),this}likeAllOf(a,i){return this.url.searchParams.append(a,`like(all).{${i.join(",")}}`),this}likeAnyOf(a,i){return this.url.searchParams.append(a,`like(any).{${i.join(",")}}`),this}ilike(a,i){return this.url.searchParams.append(a,`ilike.${i}`),this}ilikeAllOf(a,i){return this.url.searchParams.append(a,`ilike(all).{${i.join(",")}}`),this}ilikeAnyOf(a,i){return this.url.searchParams.append(a,`ilike(any).{${i.join(",")}}`),this}is(a,i){return this.url.searchParams.append(a,`is.${i}`),this}in(a,i){const l=Array.from(new Set(i)).map(c=>typeof c=="string"&&r.test(c)?`"${c}"`:`${c}`).join(",");return this.url.searchParams.append(a,`in.(${l})`),this}contains(a,i){return typeof i=="string"?this.url.searchParams.append(a,`cs.${i}`):Array.isArray(i)?this.url.searchParams.append(a,`cs.{${i.join(",")}}`):this.url.searchParams.append(a,`cs.${JSON.stringify(i)}`),this}containedBy(a,i){return typeof i=="string"?this.url.searchParams.append(a,`cd.${i}`):Array.isArray(i)?this.url.searchParams.append(a,`cd.{${i.join(",")}}`):this.url.searchParams.append(a,`cd.${JSON.stringify(i)}`),this}rangeGt(a,i){return this.url.searchParams.append(a,`sr.${i}`),this}rangeGte(a,i){return this.url.searchParams.append(a,`nxl.${i}`),this}rangeLt(a,i){return this.url.searchParams.append(a,`sl.${i}`),this}rangeLte(a,i){return this.url.searchParams.append(a,`nxr.${i}`),this}rangeAdjacent(a,i){return this.url.searchParams.append(a,`adj.${i}`),this}overlaps(a,i){return typeof i=="string"?this.url.searchParams.append(a,`ov.${i}`):this.url.searchParams.append(a,`ov.{${i.join(",")}}`),this}textSearch(a,i,{config:l,type:c}={}){let u="";c==="plain"?u="pl":c==="phrase"?u="ph":c==="websearch"&&(u="w");const d=l===void 0?"":`(${l})`;return this.url.searchParams.append(a,`${u}fts${d}.${i}`),this}match(a){return Object.entries(a).forEach(([i,l])=>{this.url.searchParams.append(i,`eq.${l}`)}),this}not(a,i,l){return this.url.searchParams.append(a,`not.${i}.${l}`),this}or(a,{foreignTable:i,referencedTable:l=i}={}){const c=l?`${l}.or`:"or";return this.url.searchParams.append(c,`(${a})`),this}filter(a,i,l){return this.url.searchParams.append(a,`${i}.${l}`),this}}return hu.default=s,hu}var Jy;function ck(){if(Jy)return fu;Jy=1,Object.defineProperty(fu,"__esModule",{value:!0});const t=Io.__importDefault(gx());class r{constructor(n,{headers:a={},schema:i,fetch:l}){this.url=n,this.headers=new Headers(a),this.schema=i,this.fetch=l}select(n,a){const{head:i=!1,count:l}=a??{},c=i?"HEAD":"GET";let u=!1;const d=(n??"*").split("").map(f=>/\s/.test(f)&&!u?"":(f==='"'&&(u=!u),f)).join("");return this.url.searchParams.set("select",d),l&&this.headers.append("Prefer",`count=${l}`),new t.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(n,{count:a,defaultToNull:i=!0}={}){var l;const c="POST";if(a&&this.headers.append("Prefer",`count=${a}`),i||this.headers.append("Prefer","missing=default"),Array.isArray(n)){const u=n.reduce((d,f)=>d.concat(Object.keys(f)),[]);if(u.length>0){const d=[...new Set(u)].map(f=>`"${f}"`);this.url.searchParams.set("columns",d.join(","))}}return new t.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}upsert(n,{onConflict:a,ignoreDuplicates:i=!1,count:l,defaultToNull:c=!0}={}){var u;const d="POST";if(this.headers.append("Prefer",`resolution=${i?"ignore":"merge"}-duplicates`),a!==void 0&&this.url.searchParams.set("on_conflict",a),l&&this.headers.append("Prefer",`count=${l}`),c||this.headers.append("Prefer","missing=default"),Array.isArray(n)){const f=n.reduce((h,p)=>h.concat(Object.keys(p)),[]);if(f.length>0){const h=[...new Set(f)].map(p=>`"${p}"`);this.url.searchParams.set("columns",h.join(","))}}return new t.default({method:d,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:(u=this.fetch)!==null&&u!==void 0?u:fetch})}update(n,{count:a}={}){var i;const l="PATCH";return a&&this.headers.append("Prefer",`count=${a}`),new t.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}delete({count:n}={}){var a;const i="DELETE";return n&&this.headers.append("Prefer",`count=${n}`),new t.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}}return fu.default=r,fu}var Qy;function XF(){if(Qy)return du;Qy=1,Object.defineProperty(du,"__esModule",{value:!0});const e=Io,t=e.__importDefault(ck()),r=e.__importDefault(gx());class s{constructor(a,{headers:i={},schema:l,fetch:c}={}){this.url=a,this.headers=new Headers(i),this.schemaName=l,this.fetch=c}from(a){const i=new URL(`${this.url}/${a}`);return new t.default(i,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(a){return new s(this.url,{headers:this.headers,schema:a,fetch:this.fetch})}rpc(a,i={},{head:l=!1,get:c=!1,count:u}={}){var d;let f;const h=new URL(`${this.url}/rpc/${a}`);let p;l||c?(f=l?"HEAD":"GET",Object.entries(i).filter(([x,g])=>g!==void 0).map(([x,g])=>[x,Array.isArray(g)?`{${g.join(",")}}`:`${g}`]).forEach(([x,g])=>{h.searchParams.append(x,g)})):(f="POST",p=i);const m=new Headers(this.headers);return u&&m.set("Prefer",`count=${u}`),new r.default({method:f,url:h,headers:m,schema:this.schemaName,body:p,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}}return du.default=s,du}Object.defineProperty(Or,"__esModule",{value:!0});var uk=Or.PostgrestError=wk=Or.PostgrestBuilder=vk=Or.PostgrestTransformBuilder=xk=Or.PostgrestFilterBuilder=mk=Or.PostgrestQueryBuilder=fk=Or.PostgrestClient=void 0;const Oo=Io,dk=Oo.__importDefault(XF());var fk=Or.PostgrestClient=dk.default;const hk=Oo.__importDefault(ck());var mk=Or.PostgrestQueryBuilder=hk.default;const pk=Oo.__importDefault(gx());var xk=Or.PostgrestFilterBuilder=pk.default;const gk=Oo.__importDefault(lk());var vk=Or.PostgrestTransformBuilder=gk.default;const yk=Oo.__importDefault(ok());var wk=Or.PostgrestBuilder=yk.default;const bk=Oo.__importDefault(ik());uk=Or.PostgrestError=bk.default;var _k=Or.default={PostgrestClient:dk.default,PostgrestQueryBuilder:hk.default,PostgrestFilterBuilder:pk.default,PostgrestTransformBuilder:gk.default,PostgrestBuilder:yk.default,PostgrestError:bk.default};const YF=sE({__proto__:null,get PostgrestBuilder(){return wk},get PostgrestClient(){return fk},get PostgrestError(){return uk},get PostgrestFilterBuilder(){return xk},get PostgrestQueryBuilder(){return mk},get PostgrestTransformBuilder(){return vk},default:_k},[Or]),{PostgrestClient:JF,PostgrestQueryBuilder:iW,PostgrestFilterBuilder:oW,PostgrestTransformBuilder:lW,PostgrestBuilder:cW,PostgrestError:uW}=_k||YF;class QF{constructor(){}static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const s=r.node,n=parseInt(s.replace(/^v/,"").split(".")[0]);return n>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${n} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${n} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const s=this.getWebSocketConstructor();return new s(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const ZF="2.83.0",e5=`realtime-js/${ZF}`,Sk="1.0.0",t5="2.0.0",Zy=Sk,fm=1e4,r5=1e3,s5=100;var Fa;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(Fa||(Fa={}));var Jt;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Jt||(Jt={}));var Ns;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Ns||(Ns={}));var hm;(function(e){e.websocket="websocket"})(hm||(hm={}));var Pa;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Pa||(Pa={}));class n5{constructor(){this.HEADER_LENGTH=1,this.META_LENGTH=4,this.USER_BROADCAST_PUSH_META_LENGTH=5,this.KINDS={push:0,reply:1,broadcast:2,userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST="broadcast"}encode(t,r){if(this._isArrayBuffer(t.payload))return r(this._binaryEncodePush(t));if(t.event===this.BROADCAST&&!(t.payload instanceof ArrayBuffer)&&typeof t.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(t));let s=[t.join_ref,t.ref,t.topic,t.event,t.payload];return r(JSON.stringify(s))}_binaryEncodePush(t){var r,s;const{event:n,topic:a,payload:i}=t,l=(r=t.ref)!==null&&r!==void 0?r:"",c=(s=t.join_ref)!==null&&s!==void 0?s:"",u=this.META_LENGTH+c.length+l.length+a.length+n.length,d=new ArrayBuffer(this.HEADER_LENGTH+u);let f=new DataView(d),h=0;f.setUint8(h++,this.KINDS.push),f.setUint8(h++,c.length),f.setUint8(h++,l.length),f.setUint8(h++,a.length),f.setUint8(h++,n.length),Array.from(c,m=>f.setUint8(h++,m.charCodeAt(0))),Array.from(l,m=>f.setUint8(h++,m.charCodeAt(0))),Array.from(a,m=>f.setUint8(h++,m.charCodeAt(0))),Array.from(n,m=>f.setUint8(h++,m.charCodeAt(0)));var p=new Uint8Array(d.byteLength+i.byteLength);return p.set(new Uint8Array(d),0),p.set(new Uint8Array(i),d.byteLength),p.buffer}_binaryEncodeUserBroadcastPush(t){var r;return this._isArrayBuffer((r=t.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(t):this._encodeJsonUserBroadcastPush(t)}_encodeBinaryUserBroadcastPush(t){var r,s,n,a;const i=t.topic,l=(r=t.ref)!==null&&r!==void 0?r:"",c=(s=t.join_ref)!==null&&s!==void 0?s:"",u=t.payload.event,d=(a=(n=t.payload)===null||n===void 0?void 0:n.payload)!==null&&a!==void 0?a:new ArrayBuffer(0),f=this.USER_BROADCAST_PUSH_META_LENGTH+c.length+l.length+i.length+u.length,h=new ArrayBuffer(this.HEADER_LENGTH+f);let p=new DataView(h),m=0;p.setUint8(m++,this.KINDS.userBroadcastPush),p.setUint8(m++,c.length),p.setUint8(m++,l.length),p.setUint8(m++,i.length),p.setUint8(m++,u.length),p.setUint8(m++,this.BINARY_ENCODING),Array.from(c,g=>p.setUint8(m++,g.charCodeAt(0))),Array.from(l,g=>p.setUint8(m++,g.charCodeAt(0))),Array.from(i,g=>p.setUint8(m++,g.charCodeAt(0))),Array.from(u,g=>p.setUint8(m++,g.charCodeAt(0)));var x=new Uint8Array(h.byteLength+d.byteLength);return x.set(new Uint8Array(h),0),x.set(new Uint8Array(d),h.byteLength),x.buffer}_encodeJsonUserBroadcastPush(t){var r,s,n,a;const i=t.topic,l=(r=t.ref)!==null&&r!==void 0?r:"",c=(s=t.join_ref)!==null&&s!==void 0?s:"",u=t.payload.event,d=(a=(n=t.payload)===null||n===void 0?void 0:n.payload)!==null&&a!==void 0?a:{},h=new TextEncoder().encode(JSON.stringify(d)).buffer,p=this.USER_BROADCAST_PUSH_META_LENGTH+c.length+l.length+i.length+u.length,m=new ArrayBuffer(this.HEADER_LENGTH+p);let x=new DataView(m),g=0;x.setUint8(g++,this.KINDS.userBroadcastPush),x.setUint8(g++,c.length),x.setUint8(g++,l.length),x.setUint8(g++,i.length),x.setUint8(g++,u.length),x.setUint8(g++,this.JSON_ENCODING),Array.from(c,w=>x.setUint8(g++,w.charCodeAt(0))),Array.from(l,w=>x.setUint8(g++,w.charCodeAt(0))),Array.from(i,w=>x.setUint8(g++,w.charCodeAt(0))),Array.from(u,w=>x.setUint8(g++,w.charCodeAt(0)));var y=new Uint8Array(m.byteLength+h.byteLength);return y.set(new Uint8Array(m),0),y.set(new Uint8Array(h),m.byteLength),y.buffer}decode(t,r){if(this._isArrayBuffer(t)){let s=this._binaryDecode(t);return r(s)}if(typeof t=="string"){const s=JSON.parse(t),[n,a,i,l,c]=s;return r({join_ref:n,ref:a,topic:i,event:l,payload:c})}return r({})}_binaryDecode(t){const r=new DataView(t),s=r.getUint8(0),n=new TextDecoder;switch(s){case this.KINDS.push:return this._decodePush(t,r,n);case this.KINDS.reply:return this._decodeReply(t,r,n);case this.KINDS.broadcast:return this._decodeBroadcast(t,r,n);case this.KINDS.userBroadcast:return this._decodeUserBroadcast(t,r,n)}}_decodePush(t,r,s){const n=r.getUint8(1),a=r.getUint8(2),i=r.getUint8(3);let l=this.HEADER_LENGTH+this.META_LENGTH-1;const c=s.decode(t.slice(l,l+n));l=l+n;const u=s.decode(t.slice(l,l+a));l=l+a;const d=s.decode(t.slice(l,l+i));l=l+i;const f=JSON.parse(s.decode(t.slice(l,t.byteLength)));return{join_ref:c,ref:null,topic:u,event:d,payload:f}}_decodeReply(t,r,s){const n=r.getUint8(1),a=r.getUint8(2),i=r.getUint8(3),l=r.getUint8(4);let c=this.HEADER_LENGTH+this.META_LENGTH;const u=s.decode(t.slice(c,c+n));c=c+n;const d=s.decode(t.slice(c,c+a));c=c+a;const f=s.decode(t.slice(c,c+i));c=c+i;const h=s.decode(t.slice(c,c+l));c=c+l;const p=JSON.parse(s.decode(t.slice(c,t.byteLength))),m={status:h,response:p};return{join_ref:u,ref:d,topic:f,event:Ns.reply,payload:m}}_decodeBroadcast(t,r,s){const n=r.getUint8(1),a=r.getUint8(2);let i=this.HEADER_LENGTH+2;const l=s.decode(t.slice(i,i+n));i=i+n;const c=s.decode(t.slice(i,i+a));i=i+a;const u=JSON.parse(s.decode(t.slice(i,t.byteLength)));return{join_ref:null,ref:null,topic:l,event:c,payload:u}}_decodeUserBroadcast(t,r,s){const n=r.getUint8(1),a=r.getUint8(2),i=r.getUint8(3),l=r.getUint8(4);let c=this.HEADER_LENGTH+4;const u=s.decode(t.slice(c,c+n));c=c+n;const d=s.decode(t.slice(c,c+a));c=c+a;const f=s.decode(t.slice(c,c+i));c=c+i;const h=t.slice(c,t.byteLength),p=l===this.JSON_ENCODING?JSON.parse(s.decode(h)):h,m={type:this.BROADCAST,event:d,payload:p};return i>0&&(m.meta=JSON.parse(f)),{join_ref:null,ref:null,topic:u,event:this.BROADCAST,payload:m}}_isArrayBuffer(t){var r;return t instanceof ArrayBuffer||((r=t==null?void 0:t.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}}class kk{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var ut;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(ut||(ut={}));const e1=(e,t,r={})=>{var s;const n=(s=r.skipTypes)!==null&&s!==void 0?s:[];return t?Object.keys(t).reduce((a,i)=>(a[i]=a5(i,e,t,n),a),{}):{}},a5=(e,t,r,s)=>{const n=t.find(l=>l.name===e),a=n==null?void 0:n.type,i=r[e];return a&&!s.includes(a)?Nk(a,i):mm(i)},Nk=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return c5(t,r)}switch(e){case ut.bool:return i5(t);case ut.float4:case ut.float8:case ut.int2:case ut.int4:case ut.int8:case ut.numeric:case ut.oid:return o5(t);case ut.json:case ut.jsonb:return l5(t);case ut.timestamp:return u5(t);case ut.abstime:case ut.date:case ut.daterange:case ut.int4range:case ut.int8range:case ut.money:case ut.reltime:case ut.text:case ut.time:case ut.timestamptz:case ut.timetz:case ut.tsrange:case ut.tstzrange:return mm(t);default:return mm(t)}},mm=e=>e,i5=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},o5=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},l5=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},c5=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,s=e[r];if(e[0]==="{"&&s==="}"){let a;const i=e.slice(1,r);try{a=JSON.parse("["+i+"]")}catch{a=i?i.split(","):[]}return a.map(l=>Nk(t,l))}return e},u5=e=>typeof e=="string"?e.replace(" ","T"):e,jk=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class bf{constructor(t,r,s={},n=fm){this.channel=t,this.event=r,this.payload=s,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var s;return this._hasReceived(t)&&r((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(s=>s.status===t).forEach(s=>s.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var t1;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(t1||(t1={}));class Sl{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},n=>{const{onJoin:a,onLeave:i,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Sl.syncState(this.state,n,a,i),this.pendingDiffs.forEach(c=>{this.state=Sl.syncDiff(this.state,c,a,i)}),this.pendingDiffs=[],l()}),this.channel._on(s.diff,{},n=>{const{onJoin:a,onLeave:i,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=Sl.syncDiff(this.state,n,a,i),l())}),this.onJoin((n,a,i)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:a,newPresences:i})}),this.onLeave((n,a,i)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:a,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,s,n){const a=this.cloneDeep(t),i=this.transformState(r),l={},c={};return this.map(a,(u,d)=>{i[u]||(c[u]=d)}),this.map(i,(u,d)=>{const f=a[u];if(f){const h=d.map(g=>g.presence_ref),p=f.map(g=>g.presence_ref),m=d.filter(g=>p.indexOf(g.presence_ref)<0),x=f.filter(g=>h.indexOf(g.presence_ref)<0);m.length>0&&(l[u]=m),x.length>0&&(c[u]=x)}else l[u]=d}),this.syncDiff(a,{joins:l,leaves:c},s,n)}static syncDiff(t,r,s,n){const{joins:a,leaves:i}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return s||(s=()=>{}),n||(n=()=>{}),this.map(a,(l,c)=>{var u;const d=(u=t[l])!==null&&u!==void 0?u:[];if(t[l]=this.cloneDeep(c),d.length>0){const f=t[l].map(p=>p.presence_ref),h=d.filter(p=>f.indexOf(p.presence_ref)<0);t[l].unshift(...h)}s(l,d,c)}),this.map(i,(l,c)=>{let u=t[l];if(!u)return;const d=c.map(f=>f.presence_ref);u=u.filter(f=>d.indexOf(f.presence_ref)<0),t[l]=u,n(l,u,c),u.length===0&&delete t[l]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(s=>r(s,t[s]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,s)=>{const n=t[s];return"metas"in n?r[s]=n.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):r[s]=n,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var r1;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(r1||(r1={}));var kl;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(kl||(kl={}));var vn;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(vn||(vn={}));class vx{constructor(t,r={config:{}},s){var n,a;if(this.topic=t,this.params=r,this.socket=s,this.bindings={},this.state=Jt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new bf(this,Ns.join,this.params,this.timeout),this.rejoinTimer=new kk(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Jt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Jt.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=Jt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Jt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=Jt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Ns.reply,{},(i,l)=>{this._trigger(this._replyEventName(l),i)}),this.presence=new Sl(this),this.broadcastEndpointURL=jk(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((a=(n=this.params.config)===null||n===void 0?void 0:n.broadcast)===null||a===void 0)&&a.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var s,n,a;if(this.socket.isConnected()||this.socket.connect(),this.state==Jt.closed){const{config:{broadcast:i,presence:l,private:c}}=this.params,u=(n=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(p=>p.filter))!==null&&n!==void 0?n:[],d=!!this.bindings[kl.PRESENCE]&&this.bindings[kl.PRESENCE].length>0||((a=this.params.config.presence)===null||a===void 0?void 0:a.enabled)===!0,f={},h={broadcast:i,presence:Object.assign(Object.assign({},l),{enabled:d}),postgres_changes:u,private:c};this.socket.accessTokenValue&&(f.access_token=this.socket.accessTokenValue),this._onError(p=>t==null?void 0:t(vn.CHANNEL_ERROR,p)),this._onClose(()=>t==null?void 0:t(vn.CLOSED)),this.updateJoinPayload(Object.assign({config:h},f)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:p})=>{var m;if(this.socket.setAuth(),p===void 0){t==null||t(vn.SUBSCRIBED);return}else{const x=this.bindings.postgres_changes,g=(m=x==null?void 0:x.length)!==null&&m!==void 0?m:0,y=[];for(let w=0;w<g;w++){const v=x[w],{filter:{event:b,schema:_,table:k,filter:S}}=v,E=p&&p[w];if(E&&E.event===b&&E.schema===_&&E.table===k&&E.filter===S)y.push(Object.assign(Object.assign({},v),{id:E.id}));else{this.unsubscribe(),this.state=Jt.errored,t==null||t(vn.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=y,t&&t(vn.SUBSCRIBED);return}}).receive("error",p=>{this.state=Jt.errored,t==null||t(vn.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(p).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(vn.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,s){return this.state===Jt.joined&&t===kl.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,r,s)}async httpSend(t,r,s={}){var n;const a=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(r==null)return Promise.reject("Payload is required for httpSend()");const i={method:"POST",headers:{Authorization:a,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:r,private:this.private}]})},l=await this._fetchWithTimeout(this.broadcastEndpointURL,i,(n=s.timeout)!==null&&n!==void 0?n:this.timeout);if(l.status===202)return{success:!0};let c=l.statusText;try{const u=await l.json();c=u.error||u.message||c}catch{}return Promise.reject(new Error(c))}async send(t,r={}){var s,n;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:a,payload:i}=t,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:i,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(s=r.timeout)!==null&&s!==void 0?s:this.timeout);return await((n=u.body)===null||n===void 0?void 0:n.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(a=>{var i,l,c;const u=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((c=(l=(i=this.params)===null||i===void 0?void 0:i.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&a("ok"),u.receive("ok",()=>a("ok")),u.receive("error",()=>a("error")),u.receive("timeout",()=>a("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Jt.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Ns.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(n=>{s=new bf(this,Ns.leave,{},t),s.receive("ok",()=>{r(),n("ok")}).receive("timeout",()=>{r(),n("timed out")}).receive("error",()=>{n("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s==null||s.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Jt.closed,this.bindings={}}async _fetchWithTimeout(t,r,s){const n=new AbortController,a=setTimeout(()=>n.abort(),s),i=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:n.signal}));return clearTimeout(a),i}_push(t,r,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new bf(this,t,r,s);return this._canPush()?n.send():this._addToPushBuffer(n),n}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>s5){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,s){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,s){var n,a;const i=t.toLocaleLowerCase(),{close:l,error:c,leave:u,join:d}=Ns;if(s&&[l,c,u,d].indexOf(i)>=0&&s!==this._joinRef())return;let h=this._onMessage(i,r,s);if(r&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(p=>{var m,x,g;return((m=p.filter)===null||m===void 0?void 0:m.event)==="*"||((g=(x=p.filter)===null||x===void 0?void 0:x.event)===null||g===void 0?void 0:g.toLocaleLowerCase())===i}).map(p=>p.callback(h,s)):(a=this.bindings[i])===null||a===void 0||a.filter(p=>{var m,x,g,y,w,v;if(["broadcast","presence","postgres_changes"].includes(i))if("id"in p){const b=p.id,_=(m=p.filter)===null||m===void 0?void 0:m.event;return b&&((x=r.ids)===null||x===void 0?void 0:x.includes(b))&&(_==="*"||(_==null?void 0:_.toLocaleLowerCase())===((g=r.data)===null||g===void 0?void 0:g.type.toLocaleLowerCase()))}else{const b=(w=(y=p==null?void 0:p.filter)===null||y===void 0?void 0:y.event)===null||w===void 0?void 0:w.toLocaleLowerCase();return b==="*"||b===((v=r==null?void 0:r.event)===null||v===void 0?void 0:v.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===i}).map(p=>{if(typeof h=="object"&&"ids"in h){const m=h.data,{schema:x,table:g,commit_timestamp:y,type:w,errors:v}=m;h=Object.assign(Object.assign({},{schema:x,table:g,commit_timestamp:y,eventType:w,new:{},old:{},errors:v}),this._getPayloadRecords(m))}p.callback(h,s)})}_isClosed(){return this.state===Jt.closed}_isJoined(){return this.state===Jt.joined}_isJoining(){return this.state===Jt.joining}_isLeaving(){return this.state===Jt.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,s){const n=t.toLocaleLowerCase(),a={type:n,filter:r,callback:s};return this.bindings[n]?this.bindings[n].push(a):this.bindings[n]=[a],this}_off(t,r){const s=t.toLocaleLowerCase();return this.bindings[s]&&(this.bindings[s]=this.bindings[s].filter(n=>{var a;return!(((a=n.type)===null||a===void 0?void 0:a.toLocaleLowerCase())===s&&vx.isEqual(n.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const s in t)if(t[s]!==r[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Ns.close,{},t)}_onError(t){this._on(Ns.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Jt.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=e1(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=e1(t.columns,t.old_record)),r}}const _f=()=>{},gu={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},d5=[1e3,2e3,5e3,1e4],f5=1e4,h5=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class m5{constructor(t,r){var s;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=fm,this.transport=null,this.heartbeatIntervalMs=gu.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=_f,this.ref=0,this.reconnectTimer=null,this.vsn=Zy,this.logger=_f,this.conn=null,this.sendBuffer=[],this.serializer=new n5,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=n=>n?(...a)=>n(...a):(...a)=>fetch(...a),!(!((s=r==null?void 0:r.params)===null||s===void 0)&&s.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${hm.websocket}`,this.httpEndpoint=jk(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=QF.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const s=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(s),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(t?this.conn.close(t,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,s){this.logger(t,r,s)}connectionState(){switch(this.conn&&this.conn.readyState){case Fa.connecting:return Pa.Connecting;case Fa.open:return Pa.Open;case Fa.closing:return Pa.Closing;default:return Pa.Closed}}isConnected(){return this.connectionState()===Pa.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const s=`realtime:${t}`,n=this.getChannels().find(a=>a.topic===s);if(n)return n;{const a=new vx(`realtime:${t}`,r,this);return this.channels.push(a),a}}push(t){const{topic:r,event:s,payload:n,ref:a}=t,i=()=>{this.encode(t,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${r} ${s} (${a})`,n),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(r5,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},gu.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(s=>s.topic===t&&(s._isJoined()||s._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(u){this.log("error","error in heartbeat callback",u)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:s,event:n,payload:a,ref:i}=r,l=i?`(${i})`:"",c=a.status||"";this.log("receive",`${c} ${s} ${n} ${l}`.trim(),a),this.channels.filter(u=>u._isMember(s)).forEach(u=>u._trigger(n,a,i)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){if(this.conn){if(this.conn.readyState===Fa.open||this.conn.readyState===Fa.connecting)try{this.conn.close()}catch(t){this.log("error","Error closing connection",t)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(Ns.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const s=t.match(/\?/)?"&":"?",n=new URLSearchParams(r);return`${t}${s}${n}`}_workerObjectUrl(t){let r;if(t)r=t;else{const s=new Blob([h5],{type:"application/javascript"});r=URL.createObjectURL(s)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r;t?r=t:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(s=>{const n={access_token:r,version:e5};r&&s.updateJoinPayload(n),s.joinedOnce&&s._isJoined()&&s._push(Ns.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(s=>{try{s(r)}catch(n){this.log("error",`error in ${t} callback`,n)}})}catch(s){this.log("error",`error triggering ${t} callbacks`,s)}}_setupReconnectionTimer(){this.reconnectTimer=new kk(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},gu.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,s,n,a,i,l,c,u,d,f,h,p;switch(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(s=t==null?void 0:t.timeout)!==null&&s!==void 0?s:fm,this.heartbeatIntervalMs=(n=t==null?void 0:t.heartbeatIntervalMs)!==null&&n!==void 0?n:gu.HEARTBEAT_INTERVAL,this.worker=(a=t==null?void 0:t.worker)!==null&&a!==void 0?a:!1,this.accessToken=(i=t==null?void 0:t.accessToken)!==null&&i!==void 0?i:null,this.heartbeatCallback=(l=t==null?void 0:t.heartbeatCallback)!==null&&l!==void 0?l:_f,this.vsn=(c=t==null?void 0:t.vsn)!==null&&c!==void 0?c:Zy,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(u=t==null?void 0:t.reconnectAfterMs)!==null&&u!==void 0?u:m=>d5[m-1]||f5,this.vsn){case Sk:this.encode=(d=t==null?void 0:t.encode)!==null&&d!==void 0?d:(m,x)=>x(JSON.stringify(m)),this.decode=(f=t==null?void 0:t.decode)!==null&&f!==void 0?f:(m,x)=>x(JSON.parse(m));break;case t5:this.encode=(h=t==null?void 0:t.encode)!==null&&h!==void 0?h:this.serializer.encode.bind(this.serializer),this.decode=(p=t==null?void 0:t.decode)!==null&&p!==void 0?p:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}class yx extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function Nt(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class p5 extends yx{constructor(t,r,s){super(t),this.name="StorageApiError",this.status=r,this.statusCode=s}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class pm extends yx{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}const wx=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),x5=()=>Response,xm=e=>{if(Array.isArray(e))return e.map(r=>xm(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,s])=>{const n=r.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""));t[n]=xm(s)}),t},g5=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},Sf=e=>{var t;return e.msg||e.message||e.error_description||(typeof e.error=="string"?e.error:(t=e.error)===null||t===void 0?void 0:t.message)||JSON.stringify(e)},v5=(e,t,r)=>Ie(void 0,void 0,void 0,function*(){const s=yield x5();e instanceof s&&!(r!=null&&r.noResolveJson)?e.json().then(n=>{const a=e.status||500,i=(n==null?void 0:n.statusCode)||a+"";t(new p5(Sf(n),a,i))}).catch(n=>{t(new pm(Sf(n),n))}):t(new pm(Sf(e),e))}),y5=(e,t,r,s)=>{const n={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||!s?n:(g5(s)?(n.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),n.body=JSON.stringify(s)):n.body=s,t!=null&&t.duplex&&(n.duplex=t.duplex),Object.assign(Object.assign({},n),r))};function Pc(e,t,r,s,n,a){return Ie(this,void 0,void 0,function*(){return new Promise((i,l)=>{e(r,y5(t,s,n,a)).then(c=>{if(!c.ok)throw c;return s!=null&&s.noResolveJson?c:c.json()}).then(c=>i(c)).catch(c=>v5(c,l,s))})})}function sc(e,t,r,s){return Ie(this,void 0,void 0,function*(){return Pc(e,"GET",t,r,s)})}function zs(e,t,r,s,n){return Ie(this,void 0,void 0,function*(){return Pc(e,"POST",t,s,n,r)})}function gm(e,t,r,s,n){return Ie(this,void 0,void 0,function*(){return Pc(e,"PUT",t,s,n,r)})}function w5(e,t,r,s){return Ie(this,void 0,void 0,function*(){return Pc(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),s)})}function bx(e,t,r,s,n){return Ie(this,void 0,void 0,function*(){return Pc(e,"DELETE",t,s,n,r)})}class b5{constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r}then(t,r){return this.execute().then(t,r)}execute(){return Ie(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Nt(t))return{data:null,error:t};throw t}})}}var Ek;class _5{constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r,this[Ek]="BlobDownloadBuilder",this.promise=null}asStream(){return new b5(this.downloadFn,this.shouldThrowOnError)}then(t,r){return this.getPromise().then(t,r)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return Ie(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Nt(t))return{data:null,error:t};throw t}})}}Ek=Symbol.toStringTag;const S5={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},s1={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class k5{constructor(t,r={},s,n){this.shouldThrowOnError=!1,this.url=t,this.headers=r,this.bucketId=s,this.fetch=wx(n)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(t,r,s,n){return Ie(this,void 0,void 0,function*(){try{let a;const i=Object.assign(Object.assign({},s1),n);let l=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(i.upsert)});const c=i.metadata;typeof Blob<"u"&&s instanceof Blob?(a=new FormData,a.append("cacheControl",i.cacheControl),c&&a.append("metadata",this.encodeMetadata(c)),a.append("",s)):typeof FormData<"u"&&s instanceof FormData?(a=s,a.has("cacheControl")||a.append("cacheControl",i.cacheControl),c&&!a.has("metadata")&&a.append("metadata",this.encodeMetadata(c))):(a=s,l["cache-control"]=`max-age=${i.cacheControl}`,l["content-type"]=i.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c))),(typeof ReadableStream<"u"&&a instanceof ReadableStream||a&&typeof a=="object"&&"pipe"in a&&typeof a.pipe=="function")&&!i.duplex&&(i.duplex="half")),n!=null&&n.headers&&(l=Object.assign(Object.assign({},l),n.headers));const u=this._removeEmptyFolders(r),d=this._getFinalPath(u),f=yield(t=="PUT"?gm:zs)(this.fetch,`${this.url}/object/${d}`,a,Object.assign({headers:l},i!=null&&i.duplex?{duplex:i.duplex}:{}));return{data:{path:u,id:f.Id,fullPath:f.Key},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Nt(a))return{data:null,error:a};throw a}})}upload(t,r,s){return Ie(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,s)})}uploadToSignedUrl(t,r,s,n){return Ie(this,void 0,void 0,function*(){const a=this._removeEmptyFolders(t),i=this._getFinalPath(a),l=new URL(this.url+`/object/upload/sign/${i}`);l.searchParams.set("token",r);try{let c;const u=Object.assign({upsert:s1.upsert},n),d=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&s instanceof Blob?(c=new FormData,c.append("cacheControl",u.cacheControl),c.append("",s)):typeof FormData<"u"&&s instanceof FormData?(c=s,c.append("cacheControl",u.cacheControl)):(c=s,d["cache-control"]=`max-age=${u.cacheControl}`,d["content-type"]=u.contentType);const f=yield gm(this.fetch,l.toString(),c,{headers:d});return{data:{path:a,fullPath:f.Key},error:null}}catch(c){if(this.shouldThrowOnError)throw c;if(Nt(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(t,r){return Ie(this,void 0,void 0,function*(){try{let s=this._getFinalPath(t);const n=Object.assign({},this.headers);r!=null&&r.upsert&&(n["x-upsert"]="true");const a=yield zs(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:n}),i=new URL(this.url+a.url),l=i.searchParams.get("token");if(!l)throw new yx("No token returned by API");return{data:{signedUrl:i.toString(),path:t,token:l},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Nt(s))return{data:null,error:s};throw s}})}update(t,r,s){return Ie(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,s)})}move(t,r,s){return Ie(this,void 0,void 0,function*(){try{return{data:yield zs(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Nt(n))return{data:null,error:n};throw n}})}copy(t,r,s){return Ie(this,void 0,void 0,function*(){try{return{data:{path:(yield zs(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers})).Key},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Nt(n))return{data:null,error:n};throw n}})}createSignedUrl(t,r,s){return Ie(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t),a=yield zs(this.fetch,`${this.url}/object/sign/${n}`,Object.assign({expiresIn:r},s!=null&&s.transform?{transform:s.transform}:{}),{headers:this.headers});const i=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return a={signedUrl:encodeURI(`${this.url}${a.signedURL}${i}`)},{data:a,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Nt(n))return{data:null,error:n};throw n}})}createSignedUrls(t,r,s){return Ie(this,void 0,void 0,function*(){try{const n=yield zs(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),a=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return{data:n.map(i=>Object.assign(Object.assign({},i),{signedUrl:i.signedURL?encodeURI(`${this.url}${i.signedURL}${a}`):null})),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Nt(n))return{data:null,error:n};throw n}})}download(t,r){const n=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",a=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),i=a?`?${a}`:"",l=this._getFinalPath(t),c=()=>sc(this.fetch,`${this.url}/${n}/${l}${i}`,{headers:this.headers,noResolveJson:!0});return new _5(c,this.shouldThrowOnError)}info(t){return Ie(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const s=yield sc(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:xm(s),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Nt(s))return{data:null,error:s};throw s}})}exists(t){return Ie(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield w5(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Nt(s)&&s instanceof pm){const n=s.originalError;if([400,404].includes(n==null?void 0:n.status))return{data:!1,error:s}}throw s}})}getPublicUrl(t,r){const s=this._getFinalPath(t),n=[],a=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";a!==""&&n.push(a);const l=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});c!==""&&n.push(c);let u=n.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${s}${u}`)}}}remove(t){return Ie(this,void 0,void 0,function*(){try{return{data:yield bx(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Nt(r))return{data:null,error:r};throw r}})}list(t,r,s){return Ie(this,void 0,void 0,function*(){try{const n=Object.assign(Object.assign(Object.assign({},S5),r),{prefix:t||""});return{data:yield zs(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},s),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Nt(n))return{data:null,error:n};throw n}})}listV2(t,r){return Ie(this,void 0,void 0,function*(){try{const s=Object.assign({},t);return{data:yield zs(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,s,{headers:this.headers},r),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Nt(s))return{data:null,error:s};throw s}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const Tk="2.83.0",Ck={"X-Client-Info":`storage-js/${Tk}`};class N5{constructor(t,r={},s,n){this.shouldThrowOnError=!1;const a=new URL(t);n!=null&&n.useNewHostname&&/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase.")),this.url=a.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Ck),r),this.fetch=wx(s)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(t){return Ie(this,void 0,void 0,function*(){try{const r=this.listBucketOptionsToQueryString(t);return{data:yield sc(this.fetch,`${this.url}/bucket${r}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Nt(r))return{data:null,error:r};throw r}})}getBucket(t){return Ie(this,void 0,void 0,function*(){try{return{data:yield sc(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Nt(r))return{data:null,error:r};throw r}})}createBucket(t){return Ie(this,arguments,void 0,function*(r,s={public:!1}){try{return{data:yield zs(this.fetch,`${this.url}/bucket`,{id:r,name:r,type:s.type,public:s.public,file_size_limit:s.fileSizeLimit,allowed_mime_types:s.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Nt(n))return{data:null,error:n};throw n}})}updateBucket(t,r){return Ie(this,void 0,void 0,function*(){try{return{data:yield gm(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Nt(s))return{data:null,error:s};throw s}})}emptyBucket(t){return Ie(this,void 0,void 0,function*(){try{return{data:yield zs(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Nt(r))return{data:null,error:r};throw r}})}deleteBucket(t){return Ie(this,void 0,void 0,function*(){try{return{data:yield bx(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Nt(r))return{data:null,error:r};throw r}})}listBucketOptionsToQueryString(t){const r={};return t&&("limit"in t&&(r.limit=String(t.limit)),"offset"in t&&(r.offset=String(t.offset)),t.search&&(r.search=t.search),t.sortColumn&&(r.sortColumn=t.sortColumn),t.sortOrder&&(r.sortOrder=t.sortOrder)),Object.keys(r).length>0?"?"+new URLSearchParams(r).toString():""}}class j5{constructor(t,r={},s){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Ck),r),this.fetch=wx(s)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return Ie(this,void 0,void 0,function*(){try{return{data:yield zs(this.fetch,`${this.url}/bucket`,{name:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Nt(r))return{data:null,error:r};throw r}})}listBuckets(t){return Ie(this,void 0,void 0,function*(){try{const r=new URLSearchParams;(t==null?void 0:t.limit)!==void 0&&r.set("limit",t.limit.toString()),(t==null?void 0:t.offset)!==void 0&&r.set("offset",t.offset.toString()),t!=null&&t.sortColumn&&r.set("sortColumn",t.sortColumn),t!=null&&t.sortOrder&&r.set("sortOrder",t.sortOrder),t!=null&&t.search&&r.set("search",t.search);const s=r.toString(),n=s?`${this.url}/bucket?${s}`:`${this.url}/bucket`;return{data:yield sc(this.fetch,n,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Nt(r))return{data:null,error:r};throw r}})}deleteBucket(t){return Ie(this,void 0,void 0,function*(){try{return{data:yield bx(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Nt(r))return{data:null,error:r};throw r}})}}const _x={"X-Client-Info":`storage-js/${Tk}`,"Content-Type":"application/json"};class Ak extends Error{constructor(t){super(t),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function ns(e){return typeof e=="object"&&e!==null&&"__isStorageVectorsError"in e}class kf extends Ak{constructor(t,r,s){super(t),this.name="StorageVectorsApiError",this.status=r,this.statusCode=s}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class E5 extends Ak{constructor(t,r){super(t),this.name="StorageVectorsUnknownError",this.originalError=r}}var n1;(function(e){e.InternalError="InternalError",e.S3VectorConflictException="S3VectorConflictException",e.S3VectorNotFoundException="S3VectorNotFoundException",e.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",e.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",e.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(n1||(n1={}));const Sx=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),T5=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},a1=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),C5=(e,t,r)=>Ie(void 0,void 0,void 0,function*(){if(e&&typeof e=="object"&&"status"in e&&"ok"in e&&typeof e.status=="number"&&!(r!=null&&r.noResolveJson)){const n=e.status||500,a=e;if(typeof a.json=="function")a.json().then(i=>{const l=(i==null?void 0:i.statusCode)||(i==null?void 0:i.code)||n+"";t(new kf(a1(i),n,l))}).catch(()=>{const i=n+"",l=a.statusText||`HTTP ${n} error`;t(new kf(l,n,i))});else{const i=n+"",l=a.statusText||`HTTP ${n} error`;t(new kf(l,n,i))}}else t(new E5(a1(e),e))}),A5=(e,t,r,s)=>{const n={method:e,headers:(t==null?void 0:t.headers)||{}};return s?(T5(s)?(n.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),n.body=JSON.stringify(s)):n.body=s,Object.assign(Object.assign({},n),r)):n};function F5(e,t,r,s,n,a){return Ie(this,void 0,void 0,function*(){return new Promise((i,l)=>{e(r,A5(t,s,n,a)).then(c=>{if(!c.ok)throw c;if(s!=null&&s.noResolveJson)return c;const u=c.headers.get("content-type");return!u||!u.includes("application/json")?{}:c.json()}).then(c=>i(c)).catch(c=>C5(c,l,s))})})}function as(e,t,r,s,n){return Ie(this,void 0,void 0,function*(){return F5(e,"POST",t,s,n,r)})}class P5{constructor(t,r={},s){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},_x),r),this.fetch=Sx(s)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(t){return Ie(this,void 0,void 0,function*(){try{return{data:(yield as(this.fetch,`${this.url}/CreateIndex`,t,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ns(r))return{data:null,error:r};throw r}})}getIndex(t,r){return Ie(this,void 0,void 0,function*(){try{return{data:yield as(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:t,indexName:r},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ns(s))return{data:null,error:s};throw s}})}listIndexes(t){return Ie(this,void 0,void 0,function*(){try{return{data:yield as(this.fetch,`${this.url}/ListIndexes`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ns(r))return{data:null,error:r};throw r}})}deleteIndex(t,r){return Ie(this,void 0,void 0,function*(){try{return{data:(yield as(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:t,indexName:r},{headers:this.headers}))||{},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ns(s))return{data:null,error:s};throw s}})}}class R5{constructor(t,r={},s){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},_x),r),this.fetch=Sx(s)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(t){return Ie(this,void 0,void 0,function*(){try{if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield as(this.fetch,`${this.url}/PutVectors`,t,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ns(r))return{data:null,error:r};throw r}})}getVectors(t){return Ie(this,void 0,void 0,function*(){try{return{data:yield as(this.fetch,`${this.url}/GetVectors`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ns(r))return{data:null,error:r};throw r}})}listVectors(t){return Ie(this,void 0,void 0,function*(){try{if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return{data:yield as(this.fetch,`${this.url}/ListVectors`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ns(r))return{data:null,error:r};throw r}})}queryVectors(t){return Ie(this,void 0,void 0,function*(){try{return{data:yield as(this.fetch,`${this.url}/QueryVectors`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ns(r))return{data:null,error:r};throw r}})}deleteVectors(t){return Ie(this,void 0,void 0,function*(){try{if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield as(this.fetch,`${this.url}/DeleteVectors`,t,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ns(r))return{data:null,error:r};throw r}})}}class I5{constructor(t,r={},s){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},_x),r),this.fetch=Sx(s)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return Ie(this,void 0,void 0,function*(){try{return{data:(yield as(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ns(r))return{data:null,error:r};throw r}})}getBucket(t){return Ie(this,void 0,void 0,function*(){try{return{data:yield as(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ns(r))return{data:null,error:r};throw r}})}listBuckets(){return Ie(this,arguments,void 0,function*(t={}){try{return{data:yield as(this.fetch,`${this.url}/ListVectorBuckets`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ns(r))return{data:null,error:r};throw r}})}deleteBucket(t){return Ie(this,void 0,void 0,function*(){try{return{data:(yield as(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ns(r))return{data:null,error:r};throw r}})}}class O5 extends I5{constructor(t,r={}){super(t,r.headers||{},r.fetch)}from(t){return new D5(this.url,this.headers,t,this.fetch)}}class D5 extends P5{constructor(t,r,s,n){super(t,r,n),this.vectorBucketName=s}createIndex(t){const r=Object.create(null,{createIndex:{get:()=>super.createIndex}});return Ie(this,void 0,void 0,function*(){return r.createIndex.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const t=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return Ie(this,arguments,void 0,function*(r={}){return t.listIndexes.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName}))})}getIndex(t){const r=Object.create(null,{getIndex:{get:()=>super.getIndex}});return Ie(this,void 0,void 0,function*(){return r.getIndex.call(this,this.vectorBucketName,t)})}deleteIndex(t){const r=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return Ie(this,void 0,void 0,function*(){return r.deleteIndex.call(this,this.vectorBucketName,t)})}index(t){return new L5(this.url,this.headers,this.vectorBucketName,t,this.fetch)}}class L5 extends R5{constructor(t,r,s,n,a){super(t,r,a),this.vectorBucketName=s,this.indexName=n}putVectors(t){const r=Object.create(null,{putVectors:{get:()=>super.putVectors}});return Ie(this,void 0,void 0,function*(){return r.putVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(t){const r=Object.create(null,{getVectors:{get:()=>super.getVectors}});return Ie(this,void 0,void 0,function*(){return r.getVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const t=Object.create(null,{listVectors:{get:()=>super.listVectors}});return Ie(this,arguments,void 0,function*(r={}){return t.listVectors.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(t){const r=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return Ie(this,void 0,void 0,function*(){return r.queryVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(t){const r=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return Ie(this,void 0,void 0,function*(){return r.deleteVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class M5 extends N5{constructor(t,r={},s,n){super(t,r,s,n)}from(t){return new k5(this.url,this.headers,t,this.fetch)}get vectors(){return new O5(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new j5(this.url+"/iceberg",this.headers,this.fetch)}}const B5="2.83.0";let al="";typeof Deno<"u"?al="deno":typeof document<"u"?al="web":typeof navigator<"u"&&navigator.product==="ReactNative"?al="react-native":al="node";const U5={"X-Client-Info":`supabase-js-${al}/${B5}`},$5={headers:U5},z5={schema:"public"},V5={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},W5={},H5=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),q5=()=>Headers,G5=(e,t,r)=>{const s=H5(r),n=q5();return async(a,i)=>{var l;const c=(l=await t())!==null&&l!==void 0?l:e;let u=new n(i==null?void 0:i.headers);return u.has("apikey")||u.set("apikey",e),u.has("Authorization")||u.set("Authorization",`Bearer ${c}`),s(a,Object.assign(Object.assign({},i),{headers:u}))}};function K5(e){return e.endsWith("/")?e:e+"/"}function X5(e,t){var r,s;const{db:n,auth:a,realtime:i,global:l}=e,{db:c,auth:u,realtime:d,global:f}=t,h={db:Object.assign(Object.assign({},c),n),auth:Object.assign(Object.assign({},u),a),realtime:Object.assign(Object.assign({},d),i),storage:{},global:Object.assign(Object.assign(Object.assign({},f),l),{headers:Object.assign(Object.assign({},(r=f==null?void 0:f.headers)!==null&&r!==void 0?r:{}),(s=l==null?void 0:l.headers)!==null&&s!==void 0?s:{})}),accessToken:async()=>""};return e.accessToken?h.accessToken=e.accessToken:delete h.accessToken,h}function Y5(e){const t=e==null?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(K5(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const Fk="2.83.0",Ti=30*1e3,vm=3,Nf=vm*Ti,J5="http://localhost:9999",Q5="supabase.auth.token",Z5={"X-Client-Info":`gotrue-js/${Fk}`},ym="X-Supabase-Api-Version",Pk={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},eP=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,tP=10*60*1e3;class nc extends Error{constructor(t,r,s){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=s}}function Oe(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class rP extends nc{constructor(t,r,s){super(t,r,s),this.name="AuthApiError",this.status=r,this.code=s}}function sP(e){return Oe(e)&&e.name==="AuthApiError"}class Ra extends nc{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class va extends nc{constructor(t,r,s,n){super(t,s,n),this.name=r,this.status=s}}class es extends va{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function nP(e){return Oe(e)&&e.name==="AuthSessionMissingError"}class wi extends va{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class vu extends va{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class yu extends va{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function aP(e){return Oe(e)&&e.name==="AuthImplicitGrantRedirectError"}class i1 extends va{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class wm extends va{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function jf(e){return Oe(e)&&e.name==="AuthRetryableFetchError"}class o1 extends va{constructor(t,r,s){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=s}}class bm extends va{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Cd="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),l1=` 	
\r=`.split(""),iP=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<l1.length;t+=1)e[l1[t].charCodeAt(0)]=-2;for(let t=0;t<Cd.length;t+=1)e[Cd[t].charCodeAt(0)]=t;return e})();function c1(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const s=t.queue>>t.queuedBits-6&63;r(Cd[s]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const s=t.queue>>t.queuedBits-6&63;r(Cd[s]),t.queuedBits-=6}}function Rk(e,t,r){const s=iP[e];if(s>-1)for(t.queue=t.queue<<6|s,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function u1(e){const t=[],r=i=>{t.push(String.fromCodePoint(i))},s={utf8seq:0,codepoint:0},n={queue:0,queuedBits:0},a=i=>{cP(i,s,r)};for(let i=0;i<e.length;i+=1)Rk(e.charCodeAt(i),n,a);return t.join("")}function oP(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function lP(e,t){for(let r=0;r<e.length;r+=1){let s=e.charCodeAt(r);if(s>55295&&s<=56319){const n=(s-55296)*1024&65535;s=(e.charCodeAt(r+1)-56320&65535|n)+65536,r+=1}oP(s,t)}}function cP(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let s=1;s<6;s+=1)if(!(e>>7-s&1)){t.utf8seq=s;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function so(e){const t=[],r={queue:0,queuedBits:0},s=n=>{t.push(n)};for(let n=0;n<e.length;n+=1)Rk(e.charCodeAt(n),r,s);return new Uint8Array(t)}function uP(e){const t=[];return lP(e,r=>t.push(r)),new Uint8Array(t)}function Ua(e){const t=[],r={queue:0,queuedBits:0},s=n=>{t.push(n)};return e.forEach(n=>c1(n,r,s)),c1(null,r,s),t.join("")}function dP(e){return Math.round(Date.now()/1e3)+e}function fP(){return Symbol("auth-callback")}const or=()=>typeof window<"u"&&typeof document<"u",Na={tested:!1,writable:!1},Ik=()=>{if(!or())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Na.tested)return Na.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Na.tested=!0,Na.writable=!0}catch{Na.tested=!0,Na.writable=!1}return Na.writable};function hP(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((n,a)=>{t[a]=n})}catch{}return r.searchParams.forEach((s,n)=>{t[n]=s}),t}const Ok=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),mP=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",Ci=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},ja=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Un=async(e,t)=>{await e.removeItem(t)};class p0{constructor(){this.promise=new p0.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}p0.promiseConstructor=Promise;function Ef(e){const t=e.split(".");if(t.length!==3)throw new bm("Invalid JWT structure");for(let s=0;s<t.length;s++)if(!eP.test(t[s]))throw new bm("JWT not in base64url format");return{header:JSON.parse(u1(t[0])),payload:JSON.parse(u1(t[1])),signature:so(t[2]),raw:{header:t[0],payload:t[1]}}}async function pP(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function xP(e,t){return new Promise((s,n)=>{(async()=>{for(let a=0;a<1/0;a++)try{const i=await e(a);if(!t(a,null,i)){s(i);return}}catch(i){if(!t(a,i)){n(i);return}}})()})}function gP(e){return("0"+e.toString(16)).substr(-2)}function vP(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=r.length;let n="";for(let a=0;a<56;a++)n+=r.charAt(Math.floor(Math.random()*s));return n}return crypto.getRandomValues(t),Array.from(t,gP).join("")}async function yP(e){const r=new TextEncoder().encode(e),s=await crypto.subtle.digest("SHA-256",r),n=new Uint8Array(s);return Array.from(n).map(a=>String.fromCharCode(a)).join("")}async function wP(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await yP(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function bi(e,t,r=!1){const s=vP();let n=s;r&&(n+="/PASSWORD_RECOVERY"),await Ci(e,`${t}-code-verifier`,n);const a=await wP(s);return[a,s===a?"plain":"s256"]}const bP=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function _P(e){const t=e.headers.get(ym);if(!t||!t.match(bP))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function SP(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function kP(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const NP=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function _i(e){if(!NP.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Tf(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const s=r.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function jP(e,t){return new Proxy(e,{get:(r,s,n)=>{if(s==="__isInsecureUserWarningProxy")return!0;if(typeof s=="symbol"){const a=s.toString();if(a==="Symbol(Symbol.toPrimitive)"||a==="Symbol(Symbol.toStringTag)"||a==="Symbol(util.inspect.custom)"||a==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,s,n)}return!t.value&&typeof s=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(r,s,n)}})}function d1(e){return JSON.parse(JSON.stringify(e))}const Aa=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),EP=[502,503,504];async function f1(e){var t;if(!mP(e))throw new wm(Aa(e),0);if(EP.includes(e.status))throw new wm(Aa(e),e.status);let r;try{r=await e.json()}catch(a){throw new Ra(Aa(a),a)}let s;const n=_P(e);if(n&&n.getTime()>=Pk["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?s=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(s=r.error_code),s){if(s==="weak_password")throw new o1(Aa(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(s==="session_not_found")throw new es}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((a,i)=>a&&typeof i=="string",!0))throw new o1(Aa(r),e.status,r.weak_password.reasons);throw new rP(Aa(r),e.status||500,s)}const TP=(e,t,r,s)=>{const n={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),n.body=JSON.stringify(s),Object.assign(Object.assign({},n),r))};async function Me(e,t,r,s){var n;const a=Object.assign({},s==null?void 0:s.headers);a[ym]||(a[ym]=Pk["2024-01-01"].name),s!=null&&s.jwt&&(a.Authorization=`Bearer ${s.jwt}`);const i=(n=s==null?void 0:s.query)!==null&&n!==void 0?n:{};s!=null&&s.redirectTo&&(i.redirect_to=s.redirectTo);const l=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",c=await CP(e,t,r+l,{headers:a,noResolveJson:s==null?void 0:s.noResolveJson},{},s==null?void 0:s.body);return s!=null&&s.xform?s==null?void 0:s.xform(c):{data:Object.assign({},c),error:null}}async function CP(e,t,r,s,n,a){const i=TP(t,s,n,a);let l;try{l=await e(r,Object.assign({},i))}catch(c){throw console.error(c),new wm(Aa(c),0)}if(l.ok||await f1(l),s!=null&&s.noResolveJson)return l;try{return await l.json()}catch(c){await f1(c)}}function Bs(e){var t;let r=null;PP(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=dP(e.expires_in)));const s=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:s},error:null}}function h1(e){const t=Bs(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,s)=>r&&typeof s=="string",!0)&&(t.data.weak_password=e.weak_password),t}function Gn(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function AP(e){return{data:e,error:null}}function FP(e){const{action_link:t,email_otp:r,hashed_token:s,redirect_to:n,verification_type:a}=e,i=Ro(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:t,email_otp:r,hashed_token:s,redirect_to:n,verification_type:a},c=Object.assign({},i);return{data:{properties:l,user:c},error:null}}function m1(e){return e}function PP(e){return e.access_token&&e.refresh_token&&e.expires_in}const Cf=["global","local","others"];class RP{constructor({url:t="",headers:r={},fetch:s}){this.url=t,this.headers=r,this.fetch=Ok(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=Cf[0]){if(Cf.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Cf.join(", ")}`);try{return await Me(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(s){if(Oe(s))return{data:null,error:s};throw s}}async inviteUserByEmail(t,r={}){try{return await Me(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Gn})}catch(s){if(Oe(s))return{data:{user:null},error:s};throw s}}async generateLink(t){try{const{options:r}=t,s=Ro(t,["options"]),n=Object.assign(Object.assign({},s),r);return"newEmail"in s&&(n.new_email=s==null?void 0:s.newEmail,delete n.newEmail),await Me(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:FP,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(Oe(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await Me(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Gn})}catch(r){if(Oe(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,s,n,a,i,l,c;try{const u={nextPage:null,lastPage:0,total:0},d=await Me(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:"",per_page:(a=(n=t==null?void 0:t.perPage)===null||n===void 0?void 0:n.toString())!==null&&a!==void 0?a:""},xform:m1});if(d.error)throw d.error;const f=await d.json(),h=(i=d.headers.get("x-total-count"))!==null&&i!==void 0?i:0,p=(c=(l=d.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return p.length>0&&(p.forEach(m=>{const x=parseInt(m.split(";")[0].split("=")[1].substring(0,1)),g=JSON.parse(m.split(";")[1].split("=")[1]);u[`${g}Page`]=x}),u.total=parseInt(h)),{data:Object.assign(Object.assign({},f),u),error:null}}catch(u){if(Oe(u))return{data:{users:[]},error:u};throw u}}async getUserById(t){_i(t);try{return await Me(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Gn})}catch(r){if(Oe(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){_i(t);try{return await Me(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:Gn})}catch(s){if(Oe(s))return{data:{user:null},error:s};throw s}}async deleteUser(t,r=!1){_i(t);try{return await Me(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:Gn})}catch(s){if(Oe(s))return{data:{user:null},error:s};throw s}}async _listFactors(t){_i(t.userId);try{const{data:r,error:s}=await Me(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:r,error:s}}catch(r){if(Oe(r))return{data:null,error:r};throw r}}async _deleteFactor(t){_i(t.userId),_i(t.id);try{return{data:await Me(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Oe(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,s,n,a,i,l,c;try{const u={nextPage:null,lastPage:0,total:0},d=await Me(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:"",per_page:(a=(n=t==null?void 0:t.perPage)===null||n===void 0?void 0:n.toString())!==null&&a!==void 0?a:""},xform:m1});if(d.error)throw d.error;const f=await d.json(),h=(i=d.headers.get("x-total-count"))!==null&&i!==void 0?i:0,p=(c=(l=d.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return p.length>0&&(p.forEach(m=>{const x=parseInt(m.split(";")[0].split("=")[1].substring(0,1)),g=JSON.parse(m.split(";")[1].split("=")[1]);u[`${g}Page`]=x}),u.total=parseInt(h)),{data:Object.assign(Object.assign({},f),u),error:null}}catch(u){if(Oe(u))return{data:{clients:[]},error:u};throw u}}async _createOAuthClient(t){try{return await Me(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Oe(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await Me(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Oe(r))return{data:null,error:r};throw r}}async _updateOAuthClient(t,r){try{return await Me(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:r,headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(Oe(s))return{data:null,error:s};throw s}}async _deleteOAuthClient(t){try{return await Me(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Oe(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await Me(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Oe(r))return{data:null,error:r};throw r}}}function p1(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const Si={debug:!!(globalThis&&Ik()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Dk extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class IP extends Dk{}async function OP(e,t,r){Si.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const s=new globalThis.AbortController;return t>0&&setTimeout(()=>{s.abort(),Si.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async n=>{if(n){Si.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,n.name);try{return await r()}finally{Si.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,n.name)}}else{if(t===0)throw Si.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new IP(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Si.debug)try{const a=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function DP(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function Lk(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function LP(e){return parseInt(e,16)}function MP(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,s=>s.toString(16).padStart(2,"0")).join("")}function BP(e){var t;const{chainId:r,domain:s,expirationTime:n,issuedAt:a=new Date,nonce:i,notBefore:l,requestId:c,resources:u,scheme:d,uri:f,version:h}=e;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!s)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(i&&i.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${i}`);if(!f)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(h!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${h}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const p=Lk(e.address),m=d?`${d}://${s}`:s,x=e.statement?`${e.statement}
`:"",g=`${m} wants you to sign in with your Ethereum account:
${p}

${x}`;let y=`URI: ${f}
Version: ${h}
Chain ID: ${r}${i?`
Nonce: ${i}`:""}
Issued At: ${a.toISOString()}`;if(n&&(y+=`
Expiration Time: ${n.toISOString()}`),l&&(y+=`
Not Before: ${l.toISOString()}`),c&&(y+=`
Request ID: ${c}`),u){let w=`
Resources:`;for(const v of u){if(!v||typeof v!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${v}`);w+=`
- ${v}`}y+=w}return`${g}
${y}`}class Kt extends Error{constructor({message:t,code:r,cause:s,name:n}){var a;super(t,{cause:s}),this.__isWebAuthnError=!0,this.name=(a=n??(s instanceof Error?s.name:void 0))!==null&&a!==void 0?a:"Unknown Error",this.code=r}}class Ad extends Kt{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function UP({error:e,options:t}){var r,s,n;const{publicKey:a}=t;if(!a)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Kt({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((r=a.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new Kt({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((s=a.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new Kt({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((n=a.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new Kt({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new Kt({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new Kt({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return a.pubKeyCredParams.filter(l=>l.type==="public-key").length===0?new Kt({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new Kt({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const i=window.location.hostname;if(Mk(i)){if(a.rp.id!==i)return new Kt({message:`The RP ID "${a.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Kt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(a.user.id.byteLength<1||a.user.id.byteLength>64)return new Kt({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new Kt({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Kt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function $P({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Kt({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new Kt({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const s=window.location.hostname;if(Mk(s)){if(r.rpId!==s)return new Kt({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Kt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new Kt({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Kt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}class zP{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const VP=new zP;function WP(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:s}=e,n=Ro(e,["challenge","user","excludeCredentials"]),a=so(t).buffer,i=Object.assign(Object.assign({},r),{id:so(r.id).buffer}),l=Object.assign(Object.assign({},n),{challenge:a,user:i});if(s&&s.length>0){l.excludeCredentials=new Array(s.length);for(let c=0;c<s.length;c++){const u=s[c];l.excludeCredentials[c]=Object.assign(Object.assign({},u),{id:so(u.id).buffer,type:u.type||"public-key",transports:u.transports})}}return l}function HP(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,s=Ro(e,["challenge","allowCredentials"]),n=so(t).buffer,a=Object.assign(Object.assign({},s),{challenge:n});if(r&&r.length>0){a.allowCredentials=new Array(r.length);for(let i=0;i<r.length;i++){const l=r[i];a.allowCredentials[i]=Object.assign(Object.assign({},l),{id:so(l.id).buffer,type:l.type||"public-key",transports:l.transports})}}return a}function qP(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:Ua(new Uint8Array(e.response.attestationObject)),clientDataJSON:Ua(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function GP(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e,s=e.getClientExtensionResults(),n=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:Ua(new Uint8Array(n.authenticatorData)),clientDataJSON:Ua(new Uint8Array(n.clientDataJSON)),signature:Ua(new Uint8Array(n.signature)),userHandle:n.userHandle?Ua(new Uint8Array(n.userHandle)):void 0},type:"public-key",clientExtensionResults:s,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function Mk(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function x1(){var e,t;return!!(or()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.get)=="function")}async function KP(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Ad("Browser returned unexpected credential type",t)}:{data:null,error:new Ad("Empty credential response",t)}}catch(t){return{data:null,error:UP({error:t,options:e})}}}async function XP(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Ad("Browser returned unexpected credential type",t)}:{data:null,error:new Ad("Empty credential response",t)}}catch(t){return{data:null,error:$P({error:t,options:e})}}}const YP={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},JP={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Fd(...e){const t=n=>n!==null&&typeof n=="object"&&!Array.isArray(n),r=n=>n instanceof ArrayBuffer||ArrayBuffer.isView(n),s={};for(const n of e)if(n)for(const a in n){const i=n[a];if(i!==void 0)if(Array.isArray(i))s[a]=i;else if(r(i))s[a]=i;else if(t(i)){const l=s[a];t(l)?s[a]=Fd(l,i):s[a]=Fd(i)}else s[a]=i}return s}function QP(e,t){return Fd(YP,e,t||{})}function ZP(e,t){return Fd(JP,e,t||{})}class eR{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:s,signal:n},a){try{const{data:i,error:l}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!i)return{data:null,error:l};const c=n??VP.createNewAbortSignal();if(i.webauthn.type==="create"){const{user:u}=i.webauthn.credential_options.publicKey;u.name||(u.name=`${u.id}:${s}`),u.displayName||(u.displayName=u.name)}switch(i.webauthn.type){case"create":{const u=QP(i.webauthn.credential_options.publicKey,a==null?void 0:a.create),{data:d,error:f}=await KP({publicKey:u,signal:c});return d?{data:{factorId:t,challengeId:i.id,webauthn:{type:i.webauthn.type,credential_response:d}},error:null}:{data:null,error:f}}case"request":{const u=ZP(i.webauthn.credential_options.publicKey,a==null?void 0:a.request),{data:d,error:f}=await XP(Object.assign(Object.assign({},i.webauthn.credential_options),{publicKey:u,signal:c}));return d?{data:{factorId:t,challengeId:i.id,webauthn:{type:i.webauthn.type,credential_response:d}},error:null}:{data:null,error:f}}}}catch(i){return Oe(i)?{data:null,error:i}:{data:null,error:new Ra("Unexpected error in challenge",i)}}}async _verify({challengeId:t,factorId:r,webauthn:s}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:s})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:n}={}},a){if(!r)return{data:null,error:new nc("rpId is required for WebAuthn authentication")};try{if(!x1())return{data:null,error:new Ra("Browser does not support WebAuthn",null)};const{data:i,error:l}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:s},signal:n},{request:a});if(!i)return{data:null,error:l};const{webauthn:c}=i;return this._verify({factorId:t,challengeId:i.challengeId,webauthn:{type:c.type,rpId:r,rpOrigins:s,credential_response:c.credential_response}})}catch(i){return Oe(i)?{data:null,error:i}:{data:null,error:new Ra("Unexpected error in authenticate",i)}}}async _register({friendlyName:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:n}={}},a){if(!r)return{data:null,error:new nc("rpId is required for WebAuthn registration")};try{if(!x1())return{data:null,error:new Ra("Browser does not support WebAuthn",null)};const{data:i,error:l}=await this._enroll({friendlyName:t});if(!i)return await this.client.mfa.listFactors().then(d=>{var f;return(f=d.data)===null||f===void 0?void 0:f.all.find(h=>h.factor_type==="webauthn"&&h.friendly_name===t&&h.status!=="unverified")}).then(d=>d?this.client.mfa.unenroll({factorId:d==null?void 0:d.id}):void 0),{data:null,error:l};const{data:c,error:u}=await this._challenge({factorId:i.id,friendlyName:i.friendly_name,webauthn:{rpId:r,rpOrigins:s},signal:n},{create:a});return c?this._verify({factorId:i.id,challengeId:c.challengeId,webauthn:{rpId:r,rpOrigins:s,type:c.webauthn.type,credential_response:c.webauthn.credential_response}}):{data:null,error:u}}catch(i){return Oe(i)?{data:null,error:i}:{data:null,error:new Ra("Unexpected error in register",i)}}}}DP();const tR={url:J5,storageKey:Q5,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Z5,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function g1(e,t,r){return await r()}const ki={};class ac{get jwks(){var t,r;return(r=(t=ki[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){ki[this.storageKey]=Object.assign(Object.assign({},ki[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=ki[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){ki[this.storageKey]=Object.assign(Object.assign({},ki[this.storageKey]),{cachedAt:t})}constructor(t){var r,s,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const a=Object.assign(Object.assign({},tR),t);if(this.storageKey=a.storageKey,this.instanceID=(r=ac.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,ac.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.instanceID>0&&or()){const i=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(i),this.logDebugMessages&&console.trace(i)}if(this.persistSession=a.persistSession,this.autoRefreshToken=a.autoRefreshToken,this.admin=new RP({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=Ok(a.fetch),this.lock=a.lock||g1,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,this.throwOnError=a.throwOnError,a.lock?this.lock=a.lock:or()&&(!((s=globalThis==null?void 0:globalThis.navigator)===null||s===void 0)&&s.locks)?this.lock=OP:this.lock=g1,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new eR(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:Ik()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=p1(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=p1(this.memoryStorage)),or()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${Fk}) ${new Date().toISOString()}`}_debug(...t){return this.logDebugMessages&&this.logger(this._logPrefix(),...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let r={},s="none";if(or()&&(r=hP(window.location.href),this._isImplicitGrantCallback(r)?s="implicit":await this._isPKCECallback(r)&&(s="pkce")),or()&&this.detectSessionInUrl&&s!=="none"){const{data:n,error:a}=await this._getSessionFromURL(r,s);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),aP(a)){const c=(t=a.details)===null||t===void 0?void 0:t.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:a}}return await this._removeSession(),{error:a}}const{session:i,redirectType:l}=n;return this._debug("#_initialize()","detected session in URL",i,"redirect type",l),await this._saveSession(i),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Oe(r)?this._returnResult({error:r}):this._returnResult({error:new Ra("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,s,n;try{const a=await Me(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(n=t==null?void 0:t.options)===null||n===void 0?void 0:n.captchaToken}},xform:Bs}),{data:i,error:l}=a;if(l||!i)return this._returnResult({data:{user:null,session:null},error:l});const c=i.session,u=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:u,session:c},error:null})}catch(a){if(Oe(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signUp(t){var r,s,n;try{let a;if("email"in t){const{email:d,password:f,options:h}=t;let p=null,m=null;this.flowType==="pkce"&&([p,m]=await bi(this.storage,this.storageKey)),a=await Me(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h==null?void 0:h.emailRedirectTo,body:{email:d,password:f,data:(r=h==null?void 0:h.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:p,code_challenge_method:m},xform:Bs})}else if("phone"in t){const{phone:d,password:f,options:h}=t;a=await Me(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:f,data:(s=h==null?void 0:h.data)!==null&&s!==void 0?s:{},channel:(n=h==null?void 0:h.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:Bs})}else throw new vu("You must provide either an email or phone number and a password");const{data:i,error:l}=a;if(l||!i)return this._returnResult({data:{user:null,session:null},error:l});const c=i.session,u=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:u,session:c},error:null})}catch(a){if(Oe(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithPassword(t){try{let r;if("email"in t){const{email:a,password:i,options:l}=t;r=await Me(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:a,password:i,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:h1})}else if("phone"in t){const{phone:a,password:i,options:l}=t;r=await Me(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:a,password:i,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:h1})}else throw new vu("You must provide either an email or phone number and a password");const{data:s,error:n}=r;if(n)return this._returnResult({data:{user:null,session:null},error:n});if(!s||!s.session||!s.user){const a=new wi;return this._returnResult({data:{user:null,session:null},error:a})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:n})}catch(r){if(Oe(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(t){var r,s,n,a;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(s=t.options)===null||s===void 0?void 0:s.scopes,queryParams:(n=t.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(a=t.options)===null||a===void 0?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,s,n,a,i,l,c,u,d,f,h;let p,m;if("message"in t)p=t.message,m=t.signature;else{const{chain:x,wallet:g,statement:y,options:w}=t;let v;if(or())if(typeof g=="object")v=g;else{const C=window;if("ethereum"in C&&typeof C.ethereum=="object"&&"request"in C.ethereum&&typeof C.ethereum.request=="function")v=C.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof g!="object"||!(w!=null&&w.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");v=g}const b=new URL((r=w==null?void 0:w.url)!==null&&r!==void 0?r:window.location.href),_=await v.request({method:"eth_requestAccounts"}).then(C=>C).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!_||_.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const k=Lk(_[0]);let S=(s=w==null?void 0:w.signInWithEthereum)===null||s===void 0?void 0:s.chainId;if(!S){const C=await v.request({method:"eth_chainId"});S=LP(C)}const E={domain:b.host,address:k,statement:y,uri:b.href,version:"1",chainId:S,nonce:(n=w==null?void 0:w.signInWithEthereum)===null||n===void 0?void 0:n.nonce,issuedAt:(i=(a=w==null?void 0:w.signInWithEthereum)===null||a===void 0?void 0:a.issuedAt)!==null&&i!==void 0?i:new Date,expirationTime:(l=w==null?void 0:w.signInWithEthereum)===null||l===void 0?void 0:l.expirationTime,notBefore:(c=w==null?void 0:w.signInWithEthereum)===null||c===void 0?void 0:c.notBefore,requestId:(u=w==null?void 0:w.signInWithEthereum)===null||u===void 0?void 0:u.requestId,resources:(d=w==null?void 0:w.signInWithEthereum)===null||d===void 0?void 0:d.resources};p=BP(E),m=await v.request({method:"personal_sign",params:[MP(p),k]})}try{const{data:x,error:g}=await Me(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:p,signature:m},!((f=t.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(h=t.options)===null||h===void 0?void 0:h.captchaToken}}:null),xform:Bs});if(g)throw g;if(!x||!x.session||!x.user){const y=new wi;return this._returnResult({data:{user:null,session:null},error:y})}return x.session&&(await this._saveSession(x.session),await this._notifyAllSubscribers("SIGNED_IN",x.session)),this._returnResult({data:Object.assign({},x),error:g})}catch(x){if(Oe(x))return this._returnResult({data:{user:null,session:null},error:x});throw x}}async signInWithSolana(t){var r,s,n,a,i,l,c,u,d,f,h,p;let m,x;if("message"in t)m=t.message,x=t.signature;else{const{chain:g,wallet:y,statement:w,options:v}=t;let b;if(or())if(typeof y=="object")b=y;else{const k=window;if("solana"in k&&typeof k.solana=="object"&&("signIn"in k.solana&&typeof k.solana.signIn=="function"||"signMessage"in k.solana&&typeof k.solana.signMessage=="function"))b=k.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof y!="object"||!(v!=null&&v.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");b=y}const _=new URL((r=v==null?void 0:v.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in b&&b.signIn){const k=await b.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},v==null?void 0:v.signInWithSolana),{version:"1",domain:_.host,uri:_.href}),w?{statement:w}:null));let S;if(Array.isArray(k)&&k[0]&&typeof k[0]=="object")S=k[0];else if(k&&typeof k=="object"&&"signedMessage"in k&&"signature"in k)S=k;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in S&&"signature"in S&&(typeof S.signedMessage=="string"||S.signedMessage instanceof Uint8Array)&&S.signature instanceof Uint8Array)m=typeof S.signedMessage=="string"?S.signedMessage:new TextDecoder().decode(S.signedMessage),x=S.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in b)||typeof b.signMessage!="function"||!("publicKey"in b)||typeof b!="object"||!b.publicKey||!("toBase58"in b.publicKey)||typeof b.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");m=[`${_.host} wants you to sign in with your Solana account:`,b.publicKey.toBase58(),...w?["",w,""]:[""],"Version: 1",`URI: ${_.href}`,`Issued At: ${(n=(s=v==null?void 0:v.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&n!==void 0?n:new Date().toISOString()}`,...!((a=v==null?void 0:v.signInWithSolana)===null||a===void 0)&&a.notBefore?[`Not Before: ${v.signInWithSolana.notBefore}`]:[],...!((i=v==null?void 0:v.signInWithSolana)===null||i===void 0)&&i.expirationTime?[`Expiration Time: ${v.signInWithSolana.expirationTime}`]:[],...!((l=v==null?void 0:v.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${v.signInWithSolana.chainId}`]:[],...!((c=v==null?void 0:v.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${v.signInWithSolana.nonce}`]:[],...!((u=v==null?void 0:v.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${v.signInWithSolana.requestId}`]:[],...!((f=(d=v==null?void 0:v.signInWithSolana)===null||d===void 0?void 0:d.resources)===null||f===void 0)&&f.length?["Resources",...v.signInWithSolana.resources.map(S=>`- ${S}`)]:[]].join(`
`);const k=await b.signMessage(new TextEncoder().encode(m),"utf8");if(!k||!(k instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");x=k}}try{const{data:g,error:y}=await Me(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:m,signature:Ua(x)},!((h=t.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(p=t.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:Bs});if(y)throw y;if(!g||!g.session||!g.user){const w=new wi;return this._returnResult({data:{user:null,session:null},error:w})}return g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),this._returnResult({data:Object.assign({},g),error:y})}catch(g){if(Oe(g))return this._returnResult({data:{user:null,session:null},error:g});throw g}}async _exchangeCodeForSession(t){const r=await ja(this.storage,`${this.storageKey}-code-verifier`),[s,n]=(r??"").split("/");try{const{data:a,error:i}=await Me(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:s},xform:Bs});if(await Un(this.storage,`${this.storageKey}-code-verifier`),i)throw i;if(!a||!a.session||!a.user){const l=new wi;return this._returnResult({data:{user:null,session:null,redirectType:null},error:l})}return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),this._returnResult({data:Object.assign(Object.assign({},a),{redirectType:n??null}),error:i})}catch(a){if(Oe(a))return this._returnResult({data:{user:null,session:null,redirectType:null},error:a});throw a}}async signInWithIdToken(t){try{const{options:r,provider:s,token:n,access_token:a,nonce:i}=t,l=await Me(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:n,access_token:a,nonce:i,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:Bs}),{data:c,error:u}=l;if(u)return this._returnResult({data:{user:null,session:null},error:u});if(!c||!c.session||!c.user){const d=new wi;return this._returnResult({data:{user:null,session:null},error:d})}return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),this._returnResult({data:c,error:u})}catch(r){if(Oe(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(t){var r,s,n,a,i;try{if("email"in t){const{email:l,options:c}=t;let u=null,d=null;this.flowType==="pkce"&&([u,d]=await bi(this.storage,this.storageKey));const{error:f}=await Me(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(r=c==null?void 0:c.data)!==null&&r!==void 0?r:{},create_user:(s=c==null?void 0:c.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:u,code_challenge_method:d},redirectTo:c==null?void 0:c.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:f})}if("phone"in t){const{phone:l,options:c}=t,{data:u,error:d}=await Me(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(n=c==null?void 0:c.data)!==null&&n!==void 0?n:{},create_user:(a=c==null?void 0:c.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(i=c==null?void 0:c.channel)!==null&&i!==void 0?i:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:d})}throw new vu("You must provide either an email or phone number.")}catch(l){if(Oe(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async verifyOtp(t){var r,s;try{let n,a;"options"in t&&(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo,a=(s=t.options)===null||s===void 0?void 0:s.captchaToken);const{data:i,error:l}=await Me(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:a}}),redirectTo:n,xform:Bs});if(l)throw l;if(!i)throw new Error("An error occurred on token verification.");const c=i.session,u=i.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),this._returnResult({data:{user:u,session:c},error:null})}catch(n){if(Oe(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithSSO(t){var r,s,n,a,i;try{let l=null,c=null;this.flowType==="pkce"&&([l,c]=await bi(this.storage,this.storageKey));const u=await Me(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(s=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&s!==void 0?s:void 0}),!((n=t==null?void 0:t.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:c}),headers:this.headers,xform:AP});return!((a=u.data)===null||a===void 0)&&a.url&&or()&&!(!((i=t.options)===null||i===void 0)&&i.skipBrowserRedirect)&&window.location.assign(u.data.url),this._returnResult(u)}catch(l){if(Oe(l))return this._returnResult({data:null,error:l});throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:s}=t;if(s)throw s;if(!r)throw new es;const{error:n}=await Me(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:n})})}catch(t){if(Oe(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:s,type:n,options:a}=t,{error:i}=await Me(this.fetch,"POST",r,{headers:this.headers,body:{email:s,type:n,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},redirectTo:a==null?void 0:a.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:i})}else if("phone"in t){const{phone:s,type:n,options:a}=t,{data:i,error:l}=await Me(this.fetch,"POST",r,{headers:this.headers,body:{phone:s,type:n,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:i==null?void 0:i.message_id},error:l})}throw new vu("You must provide either an email or phone number and a type")}catch(r){if(Oe(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await s,await r()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=r();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await ja(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const s=t.expires_at?t.expires_at*1e3-Date.now()<Nf:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",t.expires_at),!s){if(this.userStorage){const i=await ja(this.userStorage,this.storageKey+"-user");i!=null&&i.user?t.user=i.user:t.user=Tf()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const i={value:this.suppressGetSessionWarning};t.user=jP(t.user,i),i.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:n,error:a}=await this._callRefreshToken(t.refresh_token);return a?this._returnResult({data:{session:null},error:a}):this._returnResult({data:{session:n},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await Me(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Gn}):await this._useSession(async r=>{var s,n,a;const{data:i,error:l}=r;if(l)throw l;return!(!((s=i.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new es}:await Me(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0,xform:Gn})})}catch(r){if(Oe(r))return nP(r)&&(await this._removeSession(),await Un(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async s=>{const{data:n,error:a}=s;if(a)throw a;if(!n.session)throw new es;const i=n.session;let l=null,c=null;this.flowType==="pkce"&&t.email!=null&&([l,c]=await bi(this.storage,this.storageKey));const{data:u,error:d}=await Me(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:l,code_challenge_method:c}),jwt:i.access_token,xform:Gn});if(d)throw d;return i.user=u.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),this._returnResult({data:{user:i.user},error:null})})}catch(s){if(Oe(s))return this._returnResult({data:{user:null},error:s});throw s}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new es;const r=Date.now()/1e3;let s=r,n=!0,a=null;const{payload:i}=Ef(t.access_token);if(i.exp&&(s=i.exp,n=s<=r),n){const{data:l,error:c}=await this._callRefreshToken(t.refresh_token);if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!l)return{data:{user:null,session:null},error:null};a=l}else{const{data:l,error:c}=await this._getUser(t.access_token);if(c)throw c;a={access_token:t.access_token,refresh_token:t.refresh_token,user:l.user,token_type:"bearer",expires_in:s-r,expires_at:s},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return this._returnResult({data:{user:a.user,session:a},error:null})}catch(r){if(Oe(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var s;if(!t){const{data:i,error:l}=r;if(l)throw l;t=(s=i.session)!==null&&s!==void 0?s:void 0}if(!(t!=null&&t.refresh_token))throw new es;const{data:n,error:a}=await this._callRefreshToken(t.refresh_token);return a?this._returnResult({data:{user:null,session:null},error:a}):n?this._returnResult({data:{user:n.user,session:n},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(Oe(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(t,r){try{if(!or())throw new yu("No browser detected.");if(t.error||t.error_description||t.error_code)throw new yu(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new i1("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new yu("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new i1("No code detected.");const{data:w,error:v}=await this._exchangeCodeForSession(t.code);if(v)throw v;const b=new URL(window.location.href);return b.searchParams.delete("code"),window.history.replaceState(window.history.state,"",b.toString()),{data:{session:w.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:n,access_token:a,refresh_token:i,expires_in:l,expires_at:c,token_type:u}=t;if(!a||!l||!i||!u)throw new yu("No session defined in URL");const d=Math.round(Date.now()/1e3),f=parseInt(l);let h=d+f;c&&(h=parseInt(c));const p=h-d;p*1e3<=Ti&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${f}s`);const m=h-f;d-m>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",m,h,d):d-m<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",m,h,d);const{data:x,error:g}=await this._getUser(a);if(g)throw g;const y={provider_token:s,provider_refresh_token:n,access_token:a,expires_in:f,expires_at:h,refresh_token:i,token_type:u,user:x.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:y,redirectType:t.type},error:null})}catch(s){if(Oe(s))return this._returnResult({data:{session:null,redirectType:null},error:s});throw s}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await ja(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var s;const{data:n,error:a}=r;if(a)return this._returnResult({error:a});const i=(s=n.session)===null||s===void 0?void 0:s.access_token;if(i){const{error:l}=await this.admin.signOut(i,t);if(l&&!(sP(l)&&(l.status===404||l.status===401||l.status===403)))return this._returnResult({error:l})}return t!=="others"&&(await this._removeSession(),await Un(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const r=fP(),s={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:s}}}async _emitInitialSession(t){return await this._useSession(async r=>{var s,n;try{const{data:{session:a},error:i}=r;if(i)throw i;await((s=this.stateChangeEmitters.get(t))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",t,"session",a)}catch(a){await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",a),console.error(a)}})}async resetPasswordForEmail(t,r={}){let s=null,n=null;this.flowType==="pkce"&&([s,n]=await bi(this.storage,this.storageKey,!0));try{return await Me(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:s,code_challenge_method:n,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(a){if(Oe(a))return this._returnResult({data:null,error:a});throw a}}async getUserIdentities(){var t;try{const{data:r,error:s}=await this.getUser();if(s)throw s;return this._returnResult({data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(r){if(Oe(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:s,error:n}=await this._useSession(async a=>{var i,l,c,u,d;const{data:f,error:h}=a;if(h)throw h;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(i=t.options)===null||i===void 0?void 0:i.redirectTo,scopes:(l=t.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=t.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await Me(this.fetch,"GET",p,{headers:this.headers,jwt:(d=(u=f.session)===null||u===void 0?void 0:u.access_token)!==null&&d!==void 0?d:void 0})});if(n)throw n;return or()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(s==null?void 0:s.url),this._returnResult({data:{provider:t.provider,url:s==null?void 0:s.url},error:null})}catch(s){if(Oe(s))return this._returnResult({data:{provider:t.provider,url:null},error:s});throw s}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var s;try{const{error:n,data:{session:a}}=r;if(n)throw n;const{options:i,provider:l,token:c,access_token:u,nonce:d}=t,f=await Me(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(s=a==null?void 0:a.access_token)!==null&&s!==void 0?s:void 0,body:{provider:l,id_token:c,access_token:u,nonce:d,link_identity:!0,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},xform:Bs}),{data:h,error:p}=f;return p?this._returnResult({data:{user:null,session:null},error:p}):!h||!h.session||!h.user?this._returnResult({data:{user:null,session:null},error:new wi}):(h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("USER_UPDATED",h.session)),this._returnResult({data:h,error:p}))}catch(n){if(Oe(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var s,n;const{data:a,error:i}=r;if(i)throw i;return await Me(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(n=(s=a.session)===null||s===void 0?void 0:s.access_token)!==null&&n!==void 0?n:void 0})})}catch(r){if(Oe(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const s=Date.now();return await xP(async n=>(n>0&&await pP(200*Math.pow(2,n-1)),this._debug(r,"refreshing attempt",n),await Me(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Bs})),(n,a)=>{const i=200*Math.pow(2,n);return a&&jf(a)&&Date.now()+i-s<Ti})}catch(s){if(this._debug(r,"error",s),Oe(s))return this._returnResult({data:{session:null,user:null},error:s});throw s}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const s=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",s),or()&&!r.skipBrowserRedirect&&window.location.assign(s),{data:{provider:t,url:s},error:null}}async _recoverAndRefresh(){var t,r;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const n=await ja(this.storage,this.storageKey);if(n&&this.userStorage){let i=await ja(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!i&&(i={user:n.user},await Ci(this.userStorage,this.storageKey+"-user",i)),n.user=(t=i==null?void 0:i.user)!==null&&t!==void 0?t:Tf()}else if(n&&!n.user&&!n.user){const i=await ja(this.storage,this.storageKey+"-user");i&&(i!=null&&i.user)?(n.user=i.user,await Un(this.storage,this.storageKey+"-user"),await Ci(this.storage,this.storageKey,n)):n.user=Tf()}if(this._debug(s,"session from storage",n),!this._isValidSession(n)){this._debug(s,"session is not valid"),n!==null&&await this._removeSession();return}const a=((r=n.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<Nf;if(this._debug(s,`session has${a?"":" not"} expired with margin of ${Nf}s`),a){if(this.autoRefreshToken&&n.refresh_token){const{error:i}=await this._callRefreshToken(n.refresh_token);i&&(console.error(i),jf(i)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else if(n.user&&n.user.__isUserNotAvailableProxy===!0)try{const{data:i,error:l}=await this._getUser(n.access_token);!l&&(i!=null&&i.user)?(n.user=i.user,await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(i){console.error("Error getting user data:",i),this._debug(s,"error getting user data, skipping SIGNED_IN notification",i)}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(s,"error",n),console.error(n);return}finally{this._debug(s,"end")}}async _callRefreshToken(t){var r,s;if(!t)throw new es;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new p0;const{data:a,error:i}=await this._refreshAccessToken(t);if(i)throw i;if(!a.session)throw new es;await this._saveSession(a.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const l={data:a.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(a){if(this._debug(n,"error",a),Oe(a)){const i={data:null,error:a};return jf(a)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(i),i}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(a),a}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(t,r,s=!0){const n=`#_notifyAllSubscribers(${t})`;this._debug(n,"begin",r,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:t,session:r});const a=[],i=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(t,r)}catch(c){a.push(c)}});if(await Promise.all(i),a.length>0){for(let l=0;l<a.length;l+=1)console.error(a[l]);throw a[0]}}finally{this._debug(n,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const r=Object.assign({},t),s=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!s&&r.user&&await Ci(this.userStorage,this.storageKey+"-user",{user:r.user});const n=Object.assign({},r);delete n.user;const a=d1(n);await Ci(this.storage,this.storageKey,a)}else{const n=d1(r);await Ci(this.storage,this.storageKey,n)}}async _removeSession(){this._debug("#_removeSession()"),await Un(this.storage,this.storageKey),await Un(this.storage,this.storageKey+"-code-verifier"),await Un(this.storage,this.storageKey+"-user"),this.userStorage&&await Un(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&or()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Ti);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:s}}=r;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((s.expires_at*1e3-t)/Ti);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${Ti}ms, refresh threshold is ${vm} ticks`),n<=vm&&await this._callRefreshToken(s.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof Dk)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!or()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,s){const n=[`provider=${encodeURIComponent(r)}`];if(s!=null&&s.redirectTo&&n.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s!=null&&s.scopes&&n.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[a,i]=await bi(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(i)}`});n.push(l.toString())}if(s!=null&&s.queryParams){const a=new URLSearchParams(s.queryParams);n.push(a.toString())}return s!=null&&s.skipBrowserRedirect&&n.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${t}?${n.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var s;const{data:n,error:a}=r;return a?this._returnResult({data:null,error:a}):await Me(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token})})}catch(r){if(Oe(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(t){try{return await this._useSession(async r=>{var s,n;const{data:a,error:i}=r;if(i)return this._returnResult({data:null,error:i});const l=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:c,error:u}=await Me(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(s=a==null?void 0:a.session)===null||s===void 0?void 0:s.access_token});return u?this._returnResult({data:null,error:u}):(t.factorType==="totp"&&c.type==="totp"&&(!((n=c==null?void 0:c.totp)===null||n===void 0)&&n.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),this._returnResult({data:c,error:null}))})}catch(r){if(Oe(r))return this._returnResult({data:null,error:r});throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var s;const{data:n,error:a}=r;if(a)return this._returnResult({data:null,error:a});const i=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?qP(t.webauthn.credential_response):GP(t.webauthn.credential_response)})}:{code:t.code}),{data:l,error:c}=await Me(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:i,headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token});return c?this._returnResult({data:null,error:c}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),this._returnResult({data:l,error:c}))})}catch(r){if(Oe(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var s;const{data:n,error:a}=r;if(a)return this._returnResult({data:null,error:a});const i=await Me(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token});if(i.error)return i;const{data:l}=i;if(l.type!=="webauthn")return{data:l,error:null};switch(l.webauthn.type){case"create":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:WP(l.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:HP(l.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(Oe(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(t){const{data:r,error:s}=await this._challenge({factorId:t.factorId});return s?this._returnResult({data:null,error:s}):await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:s}=await this.getUser();if(s)return{data:null,error:s};const n={all:[],phone:[],totp:[],webauthn:[]};for(const a of(t=r==null?void 0:r.factors)!==null&&t!==void 0?t:[])n.all.push(a),a.status==="verified"&&n[a.factor_type].push(a);return{data:n,error:null}}async _getAuthenticatorAssuranceLevel(){var t,r;const{data:{session:s},error:n}=await this.getSession();if(n)return this._returnResult({data:null,error:n});if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=Ef(s.access_token);let i=null;a.aal&&(i=a.aal);let l=i;((r=(t=s.user.factors)===null||t===void 0?void 0:t.filter(d=>d.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(l="aal2");const u=a.amr||[];return{data:{currentLevel:i,nextLevel:l,currentAuthenticationMethods:u},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async r=>{const{data:{session:s},error:n}=r;return n?this._returnResult({data:null,error:n}):s?await Me(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:s.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new es})})}catch(r){if(Oe(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(t,r){try{return await this._useSession(async s=>{const{data:{session:n},error:a}=s;if(a)return this._returnResult({data:null,error:a});if(!n)return this._returnResult({data:null,error:new es});const i=await Me(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:n.access_token,body:{action:"approve"},xform:l=>({data:l,error:null})});return i.data&&i.data.redirect_url&&or()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(i.data.redirect_url),i})}catch(s){if(Oe(s))return this._returnResult({data:null,error:s});throw s}}async _denyAuthorization(t,r){try{return await this._useSession(async s=>{const{data:{session:n},error:a}=s;if(a)return this._returnResult({data:null,error:a});if(!n)return this._returnResult({data:null,error:new es});const i=await Me(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:n.access_token,body:{action:"deny"},xform:l=>({data:l,error:null})});return i.data&&i.data.redirect_url&&or()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(i.data.redirect_url),i})}catch(s){if(Oe(s))return this._returnResult({data:null,error:s});throw s}}async _listOAuthGrants(){try{return await this._useSession(async t=>{const{data:{session:r},error:s}=t;return s?this._returnResult({data:null,error:s}):r?await Me(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:n=>({data:n,error:null})}):this._returnResult({data:null,error:new es})})}catch(t){if(Oe(t))return this._returnResult({data:null,error:t});throw t}}async _revokeOAuthGrant(t){try{return await this._useSession(async r=>{const{data:{session:s},error:n}=r;return n?this._returnResult({data:null,error:n}):s?await Me(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:s.access_token,query:{client_id:t.clientId},xform:()=>({data:{},error:null})}):this._returnResult({data:null,error:new es})})}catch(r){if(Oe(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(t,r={keys:[]}){let s=r.keys.find(l=>l.kid===t);if(s)return s;const n=Date.now();if(s=this.jwks.keys.find(l=>l.kid===t),s&&this.jwks_cached_at+tP>n)return s;const{data:a,error:i}=await Me(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;return!a.keys||a.keys.length===0||(this.jwks=a,this.jwks_cached_at=n,s=a.keys.find(l=>l.kid===t),!s)?null:s}async getClaims(t,r={}){try{let s=t;if(!s){const{data:p,error:m}=await this.getSession();if(m||!p.session)return this._returnResult({data:null,error:m});s=p.session.access_token}const{header:n,payload:a,signature:i,raw:{header:l,payload:c}}=Ef(s);r!=null&&r.allowExpired||SP(a.exp);const u=!n.alg||n.alg.startsWith("HS")||!n.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(n.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!u){const{error:p}=await this.getUser(s);if(p)throw p;return{data:{claims:a,header:n,signature:i},error:null}}const d=kP(n.alg),f=await crypto.subtle.importKey("jwk",u,d,!0,["verify"]);if(!await crypto.subtle.verify(d,f,i,uP(`${l}.${c}`)))throw new bm("Invalid JWT signature");return{data:{claims:a,header:n,signature:i},error:null}}catch(s){if(Oe(s))return this._returnResult({data:null,error:s});throw s}}}ac.nextInstanceID={};const rR=ac;class sR extends rR{constructor(t){super(t)}}class nR{constructor(t,r,s){var n,a,i;this.supabaseUrl=t,this.supabaseKey=r;const l=Y5(t);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,u={db:z5,realtime:W5,auth:Object.assign(Object.assign({},V5),{storageKey:c}),global:$5},d=X5(s??{},u);this.storageKey=(n=d.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(a=d.global.headers)!==null&&a!==void 0?a:{},d.accessToken?(this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(f,h)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(h)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((i=d.auth)!==null&&i!==void 0?i:{},this.headers,d.global.fetch),this.fetch=G5(r,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.accessToken&&this.accessToken().then(f=>this.realtime.setAuth(f)).catch(f=>console.warn("Failed to set initial Realtime auth token:",f)),this.rest=new JF(new URL("rest/v1",l).href,{headers:this.headers,schema:d.db.schema,fetch:this.fetch}),this.storage=new M5(this.storageUrl.href,this.headers,this.fetch,s==null?void 0:s.storage),d.accessToken||this._listenForAuthEvents()}get functions(){return new KF(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},s={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,r,s)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var t,r;if(this.accessToken)return await this.accessToken();const{data:s}=await this.auth.getSession();return(r=(t=s.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:s,storage:n,userStorage:a,storageKey:i,flowType:l,lock:c,debug:u,throwOnError:d},f,h){const p={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new sR({url:this.authUrl.href,headers:Object.assign(Object.assign({},p),f),storageKey:i,autoRefreshToken:t,persistSession:r,detectSessionInUrl:s,storage:n,userStorage:a,flowType:l,lock:c,debug:u,throwOnError:d,fetch:h,hasCustomAuthorizationHeader:Object.keys(this.headers).some(m=>m.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new m5(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,s)=>{this._handleTokenChanged(r,"CLIENT",s==null?void 0:s.access_token)})}_handleTokenChanged(t,r,s){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==s?(this.changedAccessToken=s,this.realtime.setAuth(s)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const aR=(e,t,r)=>new nR(e,t,r);function iR(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}iR()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const oR="https://cbankidsdfsvsgfygbzt.supabase.co",lR="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNiYW5raWRzZGZzdnNnZnlnYnp0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMzMTk3NDgsImV4cCI6MjA3ODg5NTc0OH0.SXgc-9ZamplKeJm5_nl8J2-UzO7A0f8KbAnPZEmsiSo",ie=aR(oR,lR,{auth:{persistSession:!0,autoRefreshToken:!0}}),cR=["your-email@domain.com","backup@domain.com"];function Bk(e){return e?cR.includes(e.toLowerCase()):!1}async function uR(e,t,r,s){const{data:{session:n}}=await ie.auth.getSession();if(!n||!Bk(n.user.email)){console.warn("Attempted admin action without super admin access");return}try{const{error:a}=await ie.rpc("log_admin_action",{p_admin_email:n.user.email,p_action:e,p_target_type:t||null,p_target_id:r||null,p_details:s||{}});a&&console.error("Failed to log admin action:",a)}catch(a){console.error("Error logging admin action:",a)}}async function dR(){const{data:e,error:t}=await ie.from("admin_organisations_dashboard").select("*").order("created_at",{ascending:!1});if(t)throw t;return e||[]}async function fR(e){let t=ie.from("admin_global_quotes").select("*").order("created_at",{ascending:!1});const{data:r,error:s}=await t.limit(1e3);if(s)throw s;return r||[]}async function hR(e,t){const{data:{session:r}}=await ie.auth.getSession();if(!(r!=null&&r.user.email))throw new Error("Not authenticated");const{data:s,error:n}=await ie.rpc("admin_extend_trial",{p_admin_email:r.user.email,p_org_id:e,p_days:t});if(n)throw n;return{success:s.success,newTrialEndDate:s.new_trial_end_date}}async function mR(e,t){const{data:{session:r}}=await ie.auth.getSession();if(!(r!=null&&r.user.email))throw new Error("Not authenticated");const{data:s,error:n}=await ie.rpc("admin_update_subscription",{p_admin_email:r.user.email,p_org_id:e,p_new_status:t});if(n)throw n;return{success:s.success,newStatus:s.new_status}}async function pR(e){await uR("impersonate_org","organisation",e),localStorage.setItem("admin_impersonate_org",e),window.location.href="/dashboard"}async function xR(){localStorage.removeItem("admin_impersonate_org"),window.location.href="/admin/dashboard"}function gR(){return localStorage.getItem("admin_impersonate_org")}function vR(){return!!localStorage.getItem("admin_impersonate_org")}async function yR(e,t){const{data:{session:r}}=await ie.auth.getSession();if(!(r!=null&&r.user.email))throw new Error("Not authenticated");const{data:s,error:n}=await ie.rpc("admin_add_trade_license",{p_admin_email:r.user.email,p_org_id:e,p_trade:t});if(n)throw n;return{success:s.success,message:s.message,licensedTrades:s.licensed_trades}}async function wR(e,t){const{data:{session:r}}=await ie.auth.getSession();if(!(r!=null&&r.user.email))throw new Error("Not authenticated");const{data:s,error:n}=await ie.rpc("admin_remove_trade_license",{p_admin_email:r.user.email,p_org_id:e,p_trade:t});if(n)throw n;return{success:s.success,message:s.message,licensedTrades:s.licensed_trades}}const kx={passive_fire:"PassiveFire Verify+",electrical:"Electrical Verify+",plumbing:"Plumbing Verify+",mechanical:"Mechanical Verify+",other:"Other"},Hs=[{value:"passive_fire",label:"PassiveFire Verify+",price:299,color:"orange"},{value:"electrical",label:"Electrical Verify+",price:349,color:"yellow"},{value:"plumbing",label:"Plumbing Verify+",price:329,color:"blue"},{value:"mechanical",label:"Mechanical Verify+",price:399,color:"green"}];function bR({currentTrades:e,subscriptionStatus:t,onDismiss:r}){const[s,n]=T.useState(!1);if(s||e.length>=4||t==="trial")return null;const a=Hs.filter(p=>!e.includes(p.value));if(a.length===0)return null;const i=()=>{const p=e.reduce((m,x)=>{const g=Hs.find(y=>y.value===x);return m+((g==null?void 0:g.price)||0)},0);return e.length===2?p*.85:e.length===3?p*.75:p},l=p=>{const m=e.length+p,x=e.reduce((g,y)=>{const w=Hs.find(v=>v.value===y);return g+((w==null?void 0:w.price)||0)},0)+a.slice(0,p).reduce((g,y)=>g+y.price,0);return m===2?x*.85:m===3?x*.75:m>=4?x*.65:x},c=i(),u=l(a.length),d=u-c,f=()=>{n(!0),r&&r()},h=()=>{alert(`Contact your account manager to add trades to your license.

Or email: support@verifyhub.com`)};return o.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 text-white px-6 py-4 shadow-lg",children:o.jsxs("div",{className:"max-w-7xl mx-auto flex items-center justify-between gap-4",children:[o.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[o.jsx("div",{className:"hidden md:flex items-center justify-center w-12 h-12 bg-white/20 rounded-full",children:o.jsx(Po,{size:24})}),o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"font-bold text-lg mb-1",children:["Unlock ",a.length," More Trade",a.length>1?"s":""]}),o.jsxs("div",{className:"text-blue-100 text-sm",children:["Add ",a.slice(0,3).map(p=>{var m;return(m=kx[p.value])==null?void 0:m.replace(" Verify+","")}).join(", "),a.length>3&&` + ${a.length-3} more`," ","for only ",o.jsxs("span",{className:"font-bold text-white",children:["$",Math.round(d),"/mo more"]})," "," Total $",Math.round(u),"/mo",e.length+a.length>=4&&o.jsx("span",{className:"ml-1",children:"(35% bundle discount)"})]})]})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("button",{onClick:h,className:"px-6 py-2 bg-white text-blue-700 rounded-md hover:bg-blue-50 font-semibold transition-colors whitespace-nowrap",children:"Upgrade Now"}),o.jsx("button",{onClick:f,className:"p-2 hover:bg-white/10 rounded transition-colors",title:"Dismiss",children:o.jsx(Qr,{size:20})})]})]})})}function Gu(e){return e}const Uk=T.createContext(void 0);function _R({children:e}){const[t,r]=T.useState(null),[s,n]=T.useState([]),[a,i]=T.useState(!0);T.useEffect(()=>{l()},[]);const l=async()=>{i(!0);const{data:{user:f}}=await ie.auth.getUser();if(!f){i(!1);return}const h=gR();if(h){const{data:m}=await ie.from("organisations").select("*").eq("id",h).single();if(m){n([m]),r(m),i(!1);return}}const{data:p}=await ie.from("organisation_members").select("organisation_id, organisations(*)").eq("user_id",f.id);if(p){const m=p.map(g=>g.organisations).filter(Boolean);n(m);const x=localStorage.getItem("passivefire_current_organisation_id");if(x){const g=m.find(y=>y.id===x);g?r(g):m.length>0&&(r(m[0]),localStorage.setItem("passivefire_current_organisation_id",m[0].id))}else m.length>0&&(r(m[0]),localStorage.setItem("passivefire_current_organisation_id",m[0].id))}i(!1)},c=async()=>{await l()},u=f=>{r(f),f?localStorage.setItem("passivefire_current_organisation_id",f.id):localStorage.removeItem("passivefire_current_organisation_id")},d=f=>!0;return o.jsx(Uk.Provider,{value:{currentOrganisation:t,organisations:s,loading:a,setCurrentOrganisation:u,refreshOrganisations:c,hasPermission:d},children:e})}function ya(){const e=T.useContext(Uk);if(e===void 0)throw new Error("useOrganisation must be used within an OrganisationProvider");return e}const SR=[{id:"dashboard",label:"Project Dashboard",icon:om},{id:"quotes",label:"Import Quotes",icon:$t},{id:"review",label:"Review & Clean",icon:wF},{id:"reviewqueue",label:"Review Queue",icon:it},{id:"quoteintel",label:"Quote Intelligence",icon:Fc},{id:"scope",label:"Scope Matrix",icon:AF},{id:"reports",label:"Reports",icon:xF},{id:"contract",label:"Contract Manager",icon:ES},{id:"library",label:"sidebar.library",icon:RF},{id:"settings",label:"Settings",icon:jd,requiresManagePermission:!0}];function kR({activeTab:e,onTabChange:t}){const[r,s]=T.useState(!1),{hasPermission:n}=ya();return o.jsxs("div",{className:`${r?"w-20":"w-64"} bg-white border-r border-gray-200 flex flex-col transition-all duration-200 relative`,children:[o.jsx("div",{className:"p-6 border-b border-gray-200",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-10 h-10 bg-brand-primary rounded-lg flex items-center justify-center flex-shrink-0",children:o.jsx(EF,{className:"w-6 h-6 text-white"})}),!r&&o.jsxs("div",{children:[o.jsx("h1",{className:"text-base font-bold brand-navy leading-tight",children:"PassiveFire"}),o.jsx("p",{className:"text-xs text-gray-600",children:"Verify+"})]})]})}),o.jsx("nav",{className:"flex-1 p-4 space-y-1",children:SR.map(a=>{if(a.requiresManagePermission&&!n("manage"))return null;const i=a.icon,l=e===a.id;return o.jsxs("button",{onClick:()=>t(a.id),className:`
                w-full flex items-center gap-3 px-4 py-3 rounded-lg text-sm font-medium transition-all
                ${l?"bg-orange-50 brand-primary border-l-3 border-brand-primary":"text-gray-700 hover:bg-gray-50"}
                ${r?"justify-center":""}
              `,title:r?a.label:void 0,children:[o.jsx(i,{size:20,className:"flex-shrink-0"}),!r&&o.jsx("span",{children:a.label})]},a.id)})}),o.jsx("button",{onClick:()=>s(!r),className:"absolute -right-3 top-20 w-6 h-6 bg-white border border-gray-200 rounded-full flex items-center justify-center hover:bg-gray-50 transition-colors shadow-sm",children:r?o.jsx(Cc,{size:14}):o.jsx(fx,{size:14})})]})}function NR({currentProjectId:e,currentProjectName:t,onProjectChange:r,onBackToDashboard:s,notificationCount:n=0,onNavigateToAccount:a,onSwitchOrganisation:i}){const[l,c]=T.useState([]),[u,d]=T.useState(!1),[f,h]=T.useState(!1),[p,m]=T.useState(""),{currentOrganisation:x}=ya();T.useEffect(()=>{g(),y()},[x]);const g=async()=>{if(!x)return;const{data:v}=await ie.from("projects").select("id, name, client, reference").eq("organisation_id",x.id).order("updated_at",{ascending:!1});v&&c(v)},y=async()=>{const{data:v}=await ie.auth.getUser();v.user&&m(v.user.email||"")},w=async()=>{await ie.auth.signOut(),window.location.href="/"};return o.jsx("header",{className:"bg-white border-b border-gray-200 px-6 py-4",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"PassiveFire Verify+"}),x&&o.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[o.jsx(yo,{size:16}),o.jsx("span",{children:x.name})]}),e&&o.jsxs("div",{className:"relative",children:[o.jsxs("button",{onClick:()=>d(!u),className:"flex items-center gap-2 px-3 py-2 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:[o.jsx("span",{className:"font-medium",children:t||"Select Project"}),o.jsx(wo,{size:16})]}),u&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>d(!1)}),o.jsx("div",{className:"absolute top-full left-0 mt-2 w-64 bg-white rounded-lg shadow-lg border border-gray-200 z-20 max-h-96 overflow-y-auto",children:o.jsxs("div",{className:"p-2",children:[o.jsx("button",{onClick:()=>{s(),d(!1)},className:"w-full text-left px-3 py-2 hover:bg-gray-100 rounded-lg text-sm font-medium text-blue-600",children:"All Projects"}),o.jsx("div",{className:"border-t border-gray-200 my-2"}),l.map(v=>o.jsxs("button",{onClick:()=>{r(v.id),d(!1)},className:`w-full text-left px-3 py-2 hover:bg-gray-100 rounded-lg text-sm ${v.id===e?"bg-blue-50 text-blue-600":""}`,children:[o.jsx("div",{className:"font-medium",children:v.name}),v.client&&o.jsx("div",{className:"text-xs text-gray-500",children:v.client})]},v.id))]})})]})]})]}),o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsxs("button",{className:"relative p-2 hover:bg-gray-100 rounded-lg transition-colors",children:[o.jsx(gF,{size:20}),n>0&&o.jsx("span",{className:"absolute top-1 right-1 w-4 h-4 bg-red-500 text-white text-xs rounded-full flex items-center justify-center",children:n})]}),o.jsxs("div",{className:"relative",children:[o.jsxs("button",{onClick:()=>h(!f),className:"flex items-center gap-2 p-2 hover:bg-gray-100 rounded-lg transition-colors",children:[o.jsx(mx,{size:20}),o.jsx(wo,{size:16})]}),f&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>h(!1)}),o.jsxs("div",{className:"absolute top-full right-0 mt-2 w-64 bg-white rounded-lg shadow-lg border border-gray-200 z-20",children:[o.jsxs("div",{className:"p-4 border-b border-gray-200",children:[o.jsx("div",{className:"text-sm font-medium text-gray-900",children:p}),x&&o.jsx("div",{className:"text-xs text-gray-500 mt-1",children:x.name})]}),o.jsxs("div",{className:"p-2",children:[o.jsx("button",{onClick:()=>{a(),h(!1)},className:"w-full text-left px-3 py-2 hover:bg-gray-100 rounded-lg text-sm",children:"Account Settings"}),o.jsx("button",{onClick:()=>{i(),h(!1)},className:"w-full text-left px-3 py-2 hover:bg-gray-100 rounded-lg text-sm",children:"Switch Organisation"}),o.jsx("div",{className:"border-t border-gray-200 my-2"}),o.jsx("button",{onClick:w,className:"w-full text-left px-3 py-2 hover:bg-gray-100 rounded-lg text-sm text-red-600",children:"Sign Out"})]})]})]})]})]})]})})}function Rn({title:e,subtitle:t,metadata:r}){return o.jsxs("div",{className:"flex items-start justify-between mb-6",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-1",children:e}),o.jsx("p",{className:"text-sm text-gray-600",children:t})]}),r&&r.length>0&&o.jsx("div",{className:"flex items-center gap-2",children:r.map((s,n)=>o.jsxs("div",{className:"px-3 py-1.5 rounded-full bg-gray-100 border border-gray-200 text-xs",children:[o.jsxs("span",{className:"text-gray-600",children:[s.label,":"]})," ",o.jsx("span",{className:"font-medium text-gray-900",children:s.value})]},n))})]})}function xn({projectId:e,projectName:t,allProjects:r,onProjectSelect:s,onCreateProject:n,onNavigateToQuotes:a,onNavigateToMatrix:i,onNavigateToReports:l,onNavigateToLibrary:c}){const{currentOrganisation:u}=ya(),[d,f]=T.useState(!1),[h,p]=T.useState(""),[m,x]=T.useState(""),[g,y]=T.useState(""),[w,v]=T.useState(!1),[b,_]=T.useState(!0),[k,S]=T.useState({quoteCount:0,totalValue:0,supplierCount:0,hasQuotes:!1,hasReviewedItems:!1,hasScopeMatrix:!1,hasReports:!1}),[E,C]=T.useState([]);T.useEffect(()=>{e?U():_(!1)},[e]);const U=async()=>{if(e){_(!0);try{const{data:L}=await ie.from("quotes").select("id, supplier_name, total_amount").eq("project_id",e),X=(L==null?void 0:L.length)||0,K=(L==null?void 0:L.reduce((M,D)=>M+(D.total_amount||0),0))||0,V=new Set(L==null?void 0:L.map(M=>M.supplier_name)).size,{data:fe}=await ie.from("project_settings").select("*").eq("project_id",e).maybeSingle(),{data:ve}=await ie.from("award_reports").select("id").eq("project_id",e).eq("status","ready"),P={quoteCount:X,totalValue:K,supplierCount:V,hasQuotes:X>0,hasReviewedItems:(fe==null?void 0:fe.review_clean_completed)||!1,hasScopeMatrix:(fe==null?void 0:fe.scope_matrix_completed)||!1,hasReports:((ve==null?void 0:ve.length)||0)>0};S(P),H(P)}catch(L){console.error("Error loading project data:",L)}finally{_(!1)}}},H=L=>{const X=[{id:"import",name:"Import Quotes",status:L.hasQuotes?"completed":"not_started",route:"quotes"},{id:"review",name:"Review & Clean",status:L.hasReviewedItems?"completed":L.hasQuotes?"in_progress":"not_started",route:"review-clean"},{id:"queue",name:"Review Queue",status:L.hasReviewedItems?"completed":"not_started",route:"review-queue"},{id:"intelligence",name:"Quote Intelligence",status:L.hasReviewedItems?"completed":"not_started",route:"quote-intelligence"},{id:"matrix",name:"Scope Matrix",status:L.hasScopeMatrix?"completed":L.hasReviewedItems?"in_progress":"not_started",route:"scope-matrix"},{id:"reports",name:"Reports",status:L.hasReports?"completed":"not_started",route:"reports"}];C(X)},W=L=>{switch(L){case"quotes":a();break;case"scope-matrix":i();break;case"reports":l();break;case"library":c();break;default:console.log("Navigation to",L,"not yet implemented")}},q=()=>{f(!0)},z=()=>{f(!1),p(""),x(""),y("")},Q=async L=>{if(L.preventDefault(),!h.trim())return;v(!0);const X=await n(h,m,g);v(!1),X&&z()};return o.jsx("div",{className:"min-h-screen",children:o.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-6",children:[o.jsx(Rn,{title:e?t||"Project Dashboard":"All Projects",description:e?"Manage your quote analysis workflow":"Select or create a project"}),e?b?o.jsx("div",{className:"flex items-center justify-center py-12",children:o.jsx("div",{className:"text-gray-400",children:"Loading project dashboard..."})}):o.jsxs("div",{className:"mt-6 space-y-6",children:[o.jsxs("div",{className:"bg-white rounded-xl p-5 border border-gray-200 shadow-sm",children:[o.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 mb-2",children:[o.jsx(yo,{size:14}),o.jsxs("span",{children:["Organisation: ",(u==null?void 0:u.name)||"Loading..."]})]}),o.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:t||"Unnamed Project"}),o.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[o.jsx(Ac,{size:12}),o.jsxs("span",{children:["Last updated: ",new Date().toLocaleDateString()]})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[o.jsxs("div",{className:"bg-white rounded-xl p-5 border border-gray-200 shadow-sm",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[o.jsx("div",{className:"p-2 bg-blue-50 rounded-lg",children:o.jsx($t,{className:"text-blue-600",size:20})}),o.jsx("h3",{className:"text-sm font-semibold text-gray-700",children:"Quotes"})]}),o.jsx("p",{className:"text-3xl font-bold text-gray-900 mb-1",children:k.quoteCount}),o.jsxs("p",{className:"text-xs text-gray-500",children:["from ",k.supplierCount," ",k.supplierCount===1?"supplier":"suppliers"]})]}),o.jsxs("div",{className:"bg-white rounded-xl p-5 border border-gray-200 shadow-sm",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[o.jsx("div",{className:"p-2 bg-green-50 rounded-lg",children:o.jsx(Po,{className:"text-green-600",size:20})}),o.jsx("h3",{className:"text-sm font-semibold text-gray-700",children:"Total Value"})]}),o.jsxs("p",{className:"text-3xl font-bold text-gray-900 mb-1",children:["$",k.totalValue.toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0})]}),o.jsx("p",{className:"text-xs text-gray-500",children:"Combined quote value"})]}),o.jsxs("div",{className:"bg-white rounded-xl p-5 border border-gray-200 shadow-sm",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[o.jsx("div",{className:"p-2 bg-purple-50 rounded-lg",children:o.jsx(im,{className:"text-purple-600",size:20})}),o.jsx("h3",{className:"text-sm font-semibold text-gray-700",children:"Progress"})]}),o.jsxs("p",{className:"text-3xl font-bold text-gray-900 mb-1",children:[E.filter(L=>L.status==="completed").length,"/",E.length]}),o.jsx("p",{className:"text-xs text-gray-500",children:"Steps completed"})]})]}),o.jsxs("div",{className:"bg-white rounded-xl p-6 border border-gray-200 shadow-sm",children:[o.jsx("h2",{className:"text-lg font-bold text-gray-900 mb-4",children:"Project Workflow"}),o.jsx("div",{className:"space-y-2",children:E.map((L,X)=>o.jsxs("button",{onClick:()=>W(L.route),className:"w-full flex items-center gap-4 p-4 bg-gray-50 hover:bg-blue-50 rounded-lg transition-all border border-gray-200 hover:border-blue-300 hover:shadow-sm text-left group",children:[o.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-white border border-gray-300 text-sm font-semibold text-gray-700 group-hover:border-blue-400 group-hover:text-blue-600 transition-colors",children:X+1}),o.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[L.status==="completed"?o.jsx(Sd,{className:"text-green-600 flex-shrink-0",size:22}):L.status==="in_progress"?o.jsx(zy,{className:"text-blue-600 fill-blue-100 flex-shrink-0",size:22}):o.jsx(zy,{className:"text-gray-400 flex-shrink-0",size:22}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:"font-medium text-gray-900 text-sm",children:L.name}),o.jsx("div",{className:"text-xs text-gray-500 capitalize",children:L.status.replace("_"," ")})]})]}),o.jsx(pF,{className:"text-gray-400 group-hover:text-blue-600 transition-colors flex-shrink-0",size:18})]},L.id))})]})]}):o.jsxs("div",{className:"mt-6",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[o.jsxs("button",{onClick:q,className:"p-6 border-2 border-dashed border-gray-300 rounded-xl hover:border-blue-500 hover:bg-blue-50 transition-colors",children:[o.jsx(Ga,{className:"mx-auto mb-2 text-gray-400",size:32}),o.jsx("div",{className:"font-medium",children:"Create New Project"})]}),r.map(L=>o.jsxs("button",{onClick:()=>s(L.id),className:"p-6 bg-white border border-gray-200 rounded-xl hover:border-blue-500 hover:shadow-lg transition-all text-left",children:[o.jsx(im,{className:"mb-2 text-blue-600",size:24}),o.jsx("div",{className:"font-semibold text-gray-900 mb-1",children:L.name}),o.jsx("div",{className:"text-sm text-gray-500",children:L.client_reference})]},L.id))]}),d&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 w-full max-w-md",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Create New Project"}),o.jsx("button",{onClick:z,className:"text-gray-400 hover:text-gray-600 transition-colors",children:o.jsx(Qr,{size:24})})]}),o.jsxs("form",{onSubmit:Q,children:[o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsxs("label",{htmlFor:"projectName",className:"block text-sm font-medium text-gray-700 mb-1",children:["Project Name ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{id:"projectName",type:"text",value:h,onChange:L=>p(L.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter project name",required:!0,autoFocus:!0})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"projectClient",className:"block text-sm font-medium text-gray-700 mb-1",children:"Client Name"}),o.jsx("input",{id:"projectClient",type:"text",value:m,onChange:L=>x(L.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter client name"})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"projectReference",className:"block text-sm font-medium text-gray-700 mb-1",children:"Project Reference"}),o.jsx("input",{id:"projectReference",type:"text",value:g,onChange:L=>y(L.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter project reference"})]})]}),o.jsxs("div",{className:"flex gap-3 mt-6",children:[o.jsx("button",{type:"button",onClick:z,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",disabled:w,children:"Cancel"}),o.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed",disabled:w||!h.trim(),children:w?"Creating...":"Create Project"})]})]})]})})]})]})})}async function jR(e){return console.log("PDF Parser not fully implemented",e.name),{pages:[],text:"",metadata:{}}}async function ER(e){return console.log("Excel Parser not fully implemented",e.name),{sheets:[],data:[]}}async function TR(e){return console.log("CSV Parser not fully implemented",e.name),{data:[]}}function CR({value:e,onChange:t,error:r}){return o.jsxs("div",{className:"w-full",children:[o.jsx("input",{type:"text",value:e,onChange:s=>t(s.target.value),placeholder:"Supplier name...",className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 ${r?"border-red-500":"border-gray-300"}`}),r&&o.jsx("p",{className:"text-sm text-red-500 mt-1",children:r})]})}const AR=[{name:"Electrical Services",enabled:!0,count:0},{name:"Fire Protection Services",enabled:!0,count:0},{name:"Hydraulics Services",enabled:!0,count:0},{name:"Mechanical Services",enabled:!0,count:0},{name:"Structural Penetrations",enabled:!0,count:0},{name:"Passive Fire (General)",enabled:!0,count:0},{name:"Optional Extras",enabled:!1,count:0},{name:"Excluded",enabled:!1,count:0},{name:"Summary Blocks",enabled:!1,count:0},{name:"Admin / Notes / T&Cs",enabled:!1,count:0}];function FR({projectId:e,lines:t,summaryBlocks:r,supplierName:s,onSupplierNameChange:n,onLineUpdate:a,onSave:i,onCancel:l,isSaving:c=!1,demoMode:u=!1}){console.log("[ImportPreviewNew] Rendering with",t.length,"lines"),console.log("[ImportPreviewNew] Supplier name:",s);const[d,f]=T.useState(()=>{const q=new Set(t.map(z=>z.section));return console.log("[ImportPreviewNew] All unique sections in lines:",Array.from(q)),console.log("[ImportPreviewNew] Lines sample:",t.slice(0,5).map(z=>({section:z.section,desc:z.description.substring(0,50)}))),AR.map(z=>{const Q=t.filter(L=>L.section===z.name).length;return console.log(`[ImportPreviewNew] Section "${z.name}": ${Q} items`),{...z,count:Q}})}),[h,p]=T.useState(!1),[m,x]=T.useState(null),[g,y]=T.useState({}),[w,v]=T.useState(!0),b=T.useMemo(()=>{let q=t.filter(z=>{const Q=d.find(L=>L.name===z.section);return(Q==null?void 0:Q.enabled)??!1});return h&&(q=q.filter(z=>z.flags.length>0)),q.sort((z,Q)=>z.flags.length>0&&Q.flags.length===0?-1:z.flags.length===0&&Q.flags.length>0?1:0)},[t,d,h]),_=T.useMemo(()=>{const q=t.filter(X=>X.flags.length===0).length,z=t.filter(X=>X.flags.length>0).length,Q=t.filter(X=>!X.unit||!X.size||!X.qty).length,L=b.reduce((X,K)=>X+(K.total||0),0);return{detectedLines:q,flaggedLines:z,gapLines:Q,selectedCount:b.length,selectedSum:L}},[t,b]),k=q=>{f(z=>z.map(Q=>Q.name===q?{...Q,enabled:!Q.enabled}:Q))},S=()=>{f(q=>q.map(z=>({...z,enabled:!0})))},E=()=>{f(q=>q.map(z=>({...z,enabled:!1})))},C=q=>{x(q.id),y({...q})},U=()=>{m&&g&&(a(m,g),x(null),y({}))},H=()=>{x(null),y({})},W=()=>{i(b)};return o.jsxs("div",{className:"flex gap-6 h-[calc(100vh-12rem)]",children:[o.jsxs("div",{className:"w-64 flex-shrink-0 bg-white rounded-lg shadow-sm border border-gray-200 p-4 overflow-y-auto",children:[o.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-4",children:"Include in schedule"}),o.jsx("div",{className:"space-y-2",children:d.map(q=>o.jsxs("label",{className:"flex items-center justify-between p-2 hover:bg-gray-50 rounded cursor-pointer group",children:[o.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[o.jsx("input",{type:"checkbox",checked:q.enabled,onChange:()=>k(q.name),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500 flex-shrink-0"}),o.jsx("span",{className:"text-xs text-gray-700 truncate",title:q.name,children:q.name})]}),o.jsx("span",{className:"text-xs font-medium text-gray-500 ml-2 flex-shrink-0",children:q.count})]},q.name))})]}),o.jsxs("div",{className:"flex-1 flex flex-col min-w-0 gap-4",children:[o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:[o.jsx("div",{className:"flex items-center justify-between mb-4",children:o.jsx("div",{className:"flex-1 max-w-md",children:o.jsx(CR,{projectId:e,value:s,onChange:n,error:!s.trim()&&b.length>0?"Supplier name is required":void 0})})}),o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-green-50 border border-green-200 rounded-md",children:[o.jsx(kr,{size:16,className:"text-green-600"}),o.jsxs("span",{className:"text-sm font-medium text-green-900",children:[_.detectedLines," Detected"]})]}),o.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-amber-50 border border-amber-200 rounded-md",children:[o.jsx(it,{size:16,className:"text-amber-600"}),o.jsxs("span",{className:"text-sm font-medium text-amber-900",children:[_.flaggedLines," Flagged"]})]}),o.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-blue-50 border border-blue-200 rounded-md",children:[o.jsx(CS,{size:16,className:"text-blue-600"}),o.jsxs("span",{className:"text-sm font-medium text-blue-900",children:[_.gapLines," Gaps"]})]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("button",{onClick:S,className:"px-3 py-1.5 text-xs font-medium text-blue-600 hover:bg-blue-50 rounded-md transition-colors",children:"Select All"}),o.jsx("button",{onClick:E,className:"px-3 py-1.5 text-xs font-medium text-gray-600 hover:bg-gray-50 rounded-md transition-colors",children:"Select None"}),o.jsx("button",{onClick:()=>p(!h),className:`px-3 py-1.5 text-xs font-medium rounded-md transition-colors ${h?"bg-amber-100 text-amber-900":"text-gray-600 hover:bg-gray-50"}`,children:"Show Flagged Only"})]})]})]}),o.jsx("div",{className:"flex-1 bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden flex flex-col",children:o.jsx("div",{className:"flex-1 overflow-auto",children:o.jsxs("table",{className:"w-full",children:[o.jsx("thead",{className:"bg-gray-50 border-b border-gray-200 sticky top-0",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Section"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Description"}),o.jsx("th",{className:"px-3 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Qty"}),o.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Unit"}),o.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Rate"}),o.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Total"}),o.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Flags"}),o.jsx("th",{className:"px-3 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),o.jsx("tbody",{className:"divide-y divide-gray-200",children:b.map(q=>o.jsx("tr",{className:`${q.flags.length>0?"bg-amber-50":""} ${m===q.id?"bg-blue-50":""}`,children:m===q.id?o.jsxs(o.Fragment,{children:[o.jsx("td",{className:"px-3 py-2",children:o.jsx("input",{type:"text",value:g.section||"",onChange:z=>y({...g,section:z.target.value}),className:"w-full px-2 py-1 border border-gray-300 rounded text-xs"})}),o.jsx("td",{className:"px-4 py-2",children:o.jsx("input",{type:"text",value:g.description||"",onChange:z=>y({...g,description:z.target.value}),className:"w-full px-2 py-1 border border-gray-300 rounded text-xs"})}),o.jsx("td",{className:"px-3 py-2",children:o.jsx("input",{type:"number",value:g.qty||"",onChange:z=>y({...g,qty:parseFloat(z.target.value)||void 0}),className:"w-16 px-2 py-1 border border-gray-300 rounded text-xs text-right"})}),o.jsx("td",{className:"px-3 py-2",children:o.jsx("input",{type:"text",value:g.unit||"",onChange:z=>y({...g,unit:z.target.value}),className:"w-16 px-2 py-1 border border-gray-300 rounded text-xs"})}),o.jsx("td",{className:"px-4 py-2",children:o.jsx("input",{type:"number",value:g.rate||"",onChange:z=>y({...g,rate:parseFloat(z.target.value)||void 0}),className:"w-20 px-2 py-1 border border-gray-300 rounded text-xs text-right"})}),o.jsx("td",{className:"px-4 py-2",children:o.jsx("input",{type:"number",value:g.total||"",onChange:z=>y({...g,total:parseFloat(z.target.value)||void 0}),className:"w-20 px-2 py-1 border border-gray-300 rounded text-xs text-right"})}),o.jsx("td",{className:"px-3 py-2"}),o.jsx("td",{className:"px-3 py-2",children:o.jsxs("div",{className:"flex items-center justify-center gap-1",children:[o.jsx("button",{onClick:U,className:"p-1 text-green-600 hover:bg-green-50 rounded",title:"Save",children:o.jsx(lm,{size:14})}),o.jsx("button",{onClick:H,className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"Cancel",children:o.jsx(Qr,{size:14})})]})})]}):o.jsxs(o.Fragment,{children:[o.jsx("td",{className:"px-3 py-2 text-xs text-gray-600",children:q.section}),o.jsx("td",{className:"px-4 py-2 text-xs text-gray-900",children:q.description}),o.jsx("td",{className:"px-3 py-2 text-xs text-gray-900 text-right",children:q.qty||"-"}),o.jsx("td",{className:"px-3 py-2 text-xs text-gray-600",children:q.unit||"-"}),o.jsx("td",{className:"px-4 py-2 text-xs text-gray-900 text-right",children:q.rate?`$${q.rate.toFixed(2)}`:"-"}),o.jsx("td",{className:"px-4 py-2 text-xs text-gray-900 text-right font-medium",children:q.total?`$${q.total.toFixed(2)}`:"-"}),o.jsx("td",{className:"px-3 py-2",children:o.jsx("div",{className:"flex flex-wrap gap-1",children:q.flags.map((z,Q)=>o.jsx("span",{className:"px-1.5 py-0.5 text-[10px] font-medium bg-amber-100 text-amber-800 rounded",children:z},Q))})}),o.jsx("td",{className:"px-3 py-2",children:o.jsx("button",{onClick:()=>C(q),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",title:"Edit",children:o.jsx(FS,{size:14})})})]})},q.id))})]})})}),o.jsxs("div",{className:"flex items-center justify-between bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:[o.jsxs("div",{className:"flex items-center gap-6",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-xs text-gray-500",children:"Selected Lines"}),o.jsx("p",{className:"text-lg font-bold text-gray-900",children:_.selectedCount})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-xs text-gray-500",children:"Selected Sum"}),o.jsxs("p",{className:"text-lg font-bold text-green-600",children:["$",_.selectedSum.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("button",{onClick:l,className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 transition-colors",children:"Cancel"}),o.jsxs("button",{onClick:W,disabled:!s.trim()||b.length===0||c||u,className:"flex items-center gap-2 px-8 py-3 bg-gradient-to-r from-green-600 to-green-500 text-white text-lg font-bold rounded-lg hover:from-green-700 hover:to-green-600 shadow-lg hover:shadow-xl transition-all disabled:bg-gray-400 disabled:cursor-not-allowed transform hover:scale-105",children:[o.jsx(dx,{size:20}),c?"Saving...":u?"Demo Mode":"Proceed with Mapping"]})]})]})]}),r.length>0&&o.jsxs("div",{className:"w-64 flex-shrink-0 bg-white rounded-lg shadow-sm border border-gray-200 p-4 overflow-y-auto",children:[o.jsxs("button",{onClick:()=>v(!w),className:"flex items-center justify-between w-full mb-3",children:[o.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Quote Summary"}),w?o.jsx(wo,{size:16}):o.jsx(Cc,{size:16})]}),w&&o.jsx("div",{className:"space-y-2",children:r.map((q,z)=>o.jsxs("div",{className:`flex justify-between items-center py-2 px-3 rounded ${q.type==="grand_total"?"bg-blue-50 border border-blue-200":"bg-gray-50"}`,children:[o.jsx("span",{className:`text-xs ${q.type==="grand_total"?"font-semibold text-gray-900":"text-gray-600"}`,children:q.label}),o.jsxs("span",{className:`text-xs font-medium ${q.type==="grand_total"?"text-blue-900":"text-gray-900"}`,children:["$",q.value.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]},z))})]})]})}function PR({projectId:e,onJobCompleted:t}){const[r,s]=T.useState([]),[n,a]=T.useState(!0),[i,l]=T.useState(new Set);T.useEffect(()=>{c();const m=ie.channel("parsing_jobs_changes").on("postgres_changes",{event:"*",schema:"public",table:"parsing_jobs",filter:`project_id=eq.${e}`},g=>{if(g.eventType==="INSERT")s(y=>[g.new,...y]);else if(g.eventType==="UPDATE"){const y=g.new;s(w=>w.map(v=>v.id===y.id?y:v)),y.status==="completed"&&y.quote_id&&(t==null||t(y.id,y.quote_id))}else g.eventType==="DELETE"&&s(y=>y.filter(w=>w.id!==g.old.id))}).subscribe(),x=setInterval(()=>{r.some(y=>y.status==="pending"||y.status==="processing")&&c()},3e3);return()=>{m.unsubscribe(),clearInterval(x)}},[e,r]);const c=async()=>{try{const{data:m,error:x}=await ie.from("parsing_jobs").select("*").eq("project_id",e).order("created_at",{ascending:!1}).limit(10);!x&&m&&s(m)}catch(m){console.error("Error loading parsing jobs:",m)}finally{a(!1)}},u=m=>{if(m.status!=="processing")return!1;const x=new Date(m.updated_at);return(new Date().getTime()-x.getTime())/1e3/60>3},d=async m=>{l(x=>new Set(x).add(m));try{const y=await fetch("https://cbankidsdfsvsgfygbzt.supabase.co/functions/v1/resume_parsing_job",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNiYW5raWRzZGZzdnNnZnlnYnp0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMzMTk3NDgsImV4cCI6MjA3ODg5NTc0OH0.SXgc-9ZamplKeJm5_nl8J2-UzO7A0f8KbAnPZEmsiSo"},body:JSON.stringify({jobId:m})}),w=await y.json();if(!y.ok)throw new Error(w.error||"Failed to resume job");w.success&&w.quoteId?(t==null||t(m,w.quoteId),alert(w.message||`Successfully recovered ${w.recoveredItems} items`)):alert(w.message||"Job was too incomplete to recover"),await c()}catch(x){console.error("Error resuming job:",x),alert(`Failed to resume job: ${x instanceof Error?x.message:"Unknown error"}`)}finally{l(x=>{const g=new Set(x);return g.delete(m),g})}},f=m=>{switch(m){case"pending":return o.jsx(Ac,{className:"w-5 h-5 text-gray-400"});case"processing":return o.jsx(qs,{className:"w-5 h-5 text-blue-500 animate-spin"});case"completed":return o.jsx(kr,{className:"w-5 h-5 text-green-500"});case"failed":return o.jsx(h0,{className:"w-5 h-5 text-red-500"});default:return null}},h=m=>{switch(m){case"pending":return"Waiting to start";case"processing":return"Processing";case"completed":return"Completed";case"failed":return"Failed";default:return m}},p=m=>{switch(m){case"pending":return"bg-gray-100 text-gray-700";case"processing":return"bg-blue-100 text-blue-700";case"completed":return"bg-green-100 text-green-700";case"failed":return"bg-red-100 text-red-700";default:return"bg-gray-100 text-gray-700"}};return n?o.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:o.jsxs("div",{className:"flex items-center justify-center",children:[o.jsx(qs,{className:"w-5 h-5 text-gray-400 animate-spin"}),o.jsx("span",{className:"ml-2 text-sm text-gray-600",children:"Loading jobs..."})]})}):r.length===0?null:o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4 mb-4",children:[o.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Background Parsing Jobs"}),o.jsx("div",{className:"space-y-2",children:r.map(m=>o.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[o.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[f(m.status),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:m.supplier_name}),o.jsx("span",{className:`px-2 py-0.5 text-xs font-medium rounded-full ${p(m.status)}`,children:h(m.status)})]}),o.jsx("p",{className:"text-xs text-gray-500 truncate",children:m.file_name}),m.error_message&&o.jsx("p",{className:`text-xs mt-1 ${m.status==="completed"?"text-orange-600":"text-red-600"}`,children:m.error_message})]})]}),(m.status==="processing"||m.status==="pending")&&o.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[o.jsx("div",{className:"w-32 bg-gray-200 rounded-full h-2",children:o.jsx("div",{className:"bg-blue-500 h-2 rounded-full transition-all duration-300",style:{width:`${m.progress}%`}})}),o.jsxs("span",{className:"text-xs text-gray-600 w-10 text-right",children:[m.progress,"%"]}),u(m)&&o.jsxs("button",{onClick:()=>d(m.id),disabled:i.has(m.id),className:"flex items-center gap-1 px-2 py-1 text-xs font-medium text-orange-700 bg-orange-100 hover:bg-orange-200 rounded disabled:opacity-50 disabled:cursor-not-allowed",title:"This job appears stuck. Click to recover and complete with partial data.",children:[i.has(m.id)?o.jsx(qs,{className:"w-3 h-3 animate-spin"}):o.jsx(cs,{className:"w-3 h-3"}),o.jsx("span",{children:"Resume"})]})]}),m.status==="completed"&&m.parsed_lines&&o.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[o.jsxs("span",{className:"text-xs text-gray-600",children:[m.parsed_lines.length," items"]}),m.error_message&&m.error_message.includes("chunks failed")&&o.jsxs("button",{onClick:()=>d(m.id),disabled:i.has(m.id),className:"flex items-center gap-1 px-2 py-1 text-xs font-medium text-orange-700 bg-orange-100 hover:bg-orange-200 rounded disabled:opacity-50 disabled:cursor-not-allowed",title:"Some chunks failed. Click to retry and potentially recover more items.",children:[i.has(m.id)?o.jsx(qs,{className:"w-3 h-3 animate-spin"}):o.jsx(cs,{className:"w-3 h-3"}),o.jsx("span",{children:"Retry Failed"})]})]})]},m.id))})]})}function RR(e){return console.log("Quote Adapter not fully implemented"),e}function IR({projectId:e,onQuotesImported:t,onNavigateToDashboard:r}){const[s,n]=T.useState([]),[a,i]=T.useState(!1),[l,c]=T.useState(!0),[u,d]=T.useState([]),[f,h]=T.useState([]),[p,m]=T.useState([]),[x,g]=T.useState(""),[y,w]=T.useState(!1),[v,b]=T.useState(null),[_,k]=T.useState(!1),[S,E]=T.useState(null),[C,U]=T.useState(0),[H,W]=T.useState(!0),[q,z]=T.useState(null),Q=T.useRef(null);T.useEffect(()=>{e?L():W(!1)},[e]);const L=async()=>{if(e){W(!0);try{const{data:se}=await ie.from("projects").select("id, name, client, updated_at").eq("id",e).maybeSingle();if(se){E(se);const{data:ne,error:be}=await ie.from("quotes").select("supplier_name").eq("project_id",e);if(!be&&ne){const N=new Set(ne.map(G=>G.supplier_name));U(N.size)}}}catch(se){console.error("Error loading project info:",se)}finally{W(!1)}}},X=[".pdf",".xlsx",".xls",".csv","application/pdf","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","text/csv"],K=se=>{se.preventDefault(),k(!0)},V=()=>{k(!1)},fe=async se=>{se.preventDefault(),k(!1);const ne=Array.from(se.dataTransfer.files);await P(ne)},ve=async se=>{const ne=se.target.files;ne&&ne.length>0&&await P(Array.from(ne))},P=async se=>{const ne=se.filter(N=>{var ce;const G="."+((ce=N.name.split(".").pop())==null?void 0:ce.toLowerCase());return X.includes(G)||X.includes(N.type)});if(ne.length===0){b({type:"error",text:"No valid files selected. Please upload PDF, Excel, or CSV files."});return}n(ne);const be=ne.find(N=>N.name.toLowerCase().endsWith(".pdf"));b(be?{type:"success",text:`PDF file attached: ${be.name}. Enter supplier name and click "Parse Quote" to process with external extractor.`}:{type:"success",text:'File attached. Enter supplier name and click "Parse Quote" to continue.'})},M=async se=>{if(!e||!x.trim()){b({type:"error",text:"Please provide a supplier name."});return}i(!0),b(null);try{const{data:{session:ne}}=await ie.auth.getSession();if(!ne)throw new Error("No active session");for(const be of se){if(be.name.toLowerCase().endsWith(".pdf")){console.log(`PDF detected: ${be.name}, trying external extractor first...`);const le=new FormData;le.append("file",be),le.append("projectId",e),le.append("supplierName",x.trim());const je="https://cbankidsdfsvsgfygbzt.supabase.co/functions/v1/parse_quote_with_extractor",Ae={Authorization:`Bearer ${ne.access_token}`};try{const Se=await fetch(je,{method:"POST",headers:Ae,body:le}),Le=await Se.json();if(Se.ok&&Le.success){console.log("Extractor  Import Quotes:",Le),b({type:"success",text:`${be.name} successfully parsed using external extractor! Found ${Le.itemsCount} items. Redirecting to review...`}),n([]),g(""),await L(),t(),setTimeout(()=>{r&&r()},1500);continue}else if(Le.fallback_required)console.log("Extractor failed, falling back to background job...");else throw new Error(Le.error||"Extractor failed")}catch(Se){console.error("External extractor error, falling back to background job:",Se),b({type:"info",text:`External extractor unavailable for ${be.name}, using background parser...`})}}const ce=new FormData;ce.append("file",be),ce.append("projectId",e),ce.append("supplierName",x.trim());const te="https://cbankidsdfsvsgfygbzt.supabase.co/functions/v1/start_parsing_job",ue={Authorization:`Bearer ${ne.access_token}`},ae=await fetch(te,{method:"POST",headers:ue,body:ce});if(!ae.ok){const le=await ae.json();throw new Error(le.error||"Failed to start parsing job")}const ge=await ae.json();b({type:"success",text:`${be.name} is being parsed in the background. You can navigate away and it will continue processing.`})}n([]),g("")}catch(ne){console.error("Background parsing error:",ne),b({type:"error",text:ne.message||"Failed to start background parsing"})}finally{i(!1)}},D=async se=>{var ne;i(!0),b(null),d([]);try{const be=[];for(const N of se){const G=(ne=N.name.split(".").pop())==null?void 0:ne.toLowerCase();let ce=[];try{if(G==="pdf"?(b({type:"info",text:`Parsing PDF: ${N.name}...`}),ce=await jR(N)):G==="xlsx"||G==="xls"?(b({type:"info",text:`Parsing Excel: ${N.name}...`}),ce=await ER(N)):G==="csv"&&(b({type:"info",text:`Parsing CSV: ${N.name}...`}),ce=await TR(N)),ce.length>0){const te=crypto.randomUUID();ce.forEach(ue=>{ue.supplierId=te,ue.supplierName=x.trim()}),be.push(...ce)}}catch(te){console.error(`Error parsing ${N.name}:`,te),b({type:"error",text:`Failed to parse ${N.name}. The file format may not be supported or the content is unreadable.`})}}if(be.length>0){d(be);const N=RR(be);h(N),m([]),b({type:"success",text:`Successfully parsed ${be.length} line items from ${x}`})}else b({type:"error",text:"No data could be extracted from the files. Please check the file format and content."})}catch(be){console.error("Parsing error:",be),b({type:"error",text:"An error occurred while parsing the files."})}finally{i(!1)}},B=(se,ne)=>{h(be=>be.map(N=>N.id===se?{...N,...ne}:N))},Y=async()=>{if(!e||!x.trim()){b({type:"error",text:"Please provide a supplier name."});return}w(!0),b(null);try{const se=f.filter(te=>te.include!==!1);if(se.length===0){b({type:"error",text:"No items selected for import."}),w(!1);return}const{data:{session:ne}}=await ie.auth.getSession();if(!ne)throw new Error("No active session");let be=q;if(!be){const te=`https://cbankidsdfsvsgfygbzt.supabase.co/functions/v1/upload_quote/projects/${e}/quotes/upload`,ue={Authorization:`Bearer ${ne.access_token}`},ae=new FormData;if(s&&s.length>0)ae.append("file",s[0]);else{const je=new File([""],"quote.pdf",{type:"application/pdf"});ae.append("file",je)}ae.append("vendorName",x);const ge=await fetch(te,{method:"POST",headers:ue,body:ae});if(!ge.ok){const je=await ge.json();throw new Error(`Failed to create quote: ${je.error||ge.statusText}`)}be=(await ge.json()).quoteId,z(be)}const N=`https://cbankidsdfsvsgfygbzt.supabase.co/functions/v1/apply_selections/projects/${e}/selections/apply`,G={Authorization:`Bearer ${ne.access_token}`,"Content-Type":"application/json"},ce=await fetch(N,{method:"POST",headers:G,body:JSON.stringify({quoteId:be,items:se.map(te=>({lineId:te.id,mapKey:te.normalised_key||"",description:te.description,qty:te.qty||0,unit:te.unit||"",unitPrice:te.unit_price||0,total:te.total||0}))})});if(!ce.ok){const te=await ce.json();throw new Error(`Failed to apply selections: ${te.error||ce.statusText}`)}b({type:"success",text:`Successfully saved ${se.length} items!`}),n([]),d([]),h([]),m([]),g(""),z(null),await L(),t(),setTimeout(()=>{r&&r()},1500)}catch(se){console.error("Save error:",se),b({type:"error",text:se instanceof Error?se.message:"Failed to save selections"})}finally{w(!1)}},he=()=>{n([]),d([]),h([]),m([]),g(""),b(null)};if(H)return o.jsx("div",{className:"flex items-center justify-center min-h-96",children:o.jsx("div",{className:"text-gray-600",children:"Loading project information..."})});if(u.length>0)return o.jsxs("div",{className:"p-6 max-w-full",children:[o.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-5 mb-6",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-10 h-10 rounded-full bg-orange-50 flex items-center justify-center",children:o.jsx(Vy,{className:"text-brand-primary",size:20})}),o.jsxs("div",{children:[o.jsx("h2",{className:"text-lg font-bold text-gray-900",children:"Import Preview"}),o.jsx("p",{className:"text-sm text-gray-600",children:x||"No supplier name provided"})]})]}),o.jsx("button",{onClick:he,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",title:"Cancel and start over",children:o.jsx(Qr,{size:20})})]})}),v&&o.jsx("div",{className:`p-4 rounded-xl mb-6 ${v.type==="success"?"bg-green-50 border border-green-200":v.type==="error"?"bg-red-50 border border-red-200":"bg-blue-50 border border-blue-200"}`,children:o.jsxs("div",{className:"flex items-start gap-2",children:[o.jsx(it,{size:18,className:`mt-0.5 flex-shrink-0 ${v.type==="success"?"text-green-600":v.type==="error"?"text-red-600":"text-blue-600"}`}),o.jsx("span",{className:v.type==="success"?"text-green-800":v.type==="error"?"text-red-800":"text-blue-800",children:v.text})]})}),o.jsx(FR,{projectId:e||"",lines:f,summaryBlocks:p,supplierName:x,onSupplierNameChange:g,onLineUpdate:B,onSave:Y,onCancel:he,isSaving:y,demoMode:!1})]});if(!e||!S)return o.jsx("div",{className:"flex items-center justify-center min-h-96",children:o.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-8 text-center max-w-md",children:[o.jsx(it,{className:"mx-auto mb-4 text-yellow-500",size:48}),o.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:"No Project Selected"}),o.jsx("p",{className:"text-gray-600 mb-6",children:"You need to select or create a project before importing quotes."}),o.jsx("button",{onClick:r,className:"btn-primary inline-flex items-center gap-2",children:"Go to Project Dashboard"})]})});const xe=[{label:"Project",value:S.name},{label:"Suppliers",value:C.toString()},{label:"Last Updated",value:new Date(S.updated_at).toLocaleDateString()}];return o.jsxs("div",{className:"p-6 max-w-full",children:[o.jsx(Rn,{title:"Quotes",subtitle:"Import supplier quotes and prepare them for analysis.",metadata:xe}),e&&o.jsx(PR,{projectId:e,onJobCompleted:L}),v&&o.jsx("div",{className:`p-4 rounded-xl mb-6 ${v.type==="success"?"bg-green-50 border border-green-200":v.type==="error"?"bg-red-50 border border-red-200":"bg-blue-50 border border-blue-200"}`,children:o.jsxs("div",{className:"flex items-start gap-2",children:[v.type==="success"?o.jsx(kr,{size:18,className:"mt-0.5 flex-shrink-0 text-green-600"}):o.jsx(it,{size:18,className:"mt-0.5 flex-shrink-0 text-blue-600"}),o.jsx("span",{className:v.type==="success"?"text-green-800":v.type==="error"?"text-red-800":"text-blue-800",children:v.text})]})}),o.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 mb-6",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[o.jsx("div",{className:"w-10 h-10 rounded-full bg-orange-50 flex items-center justify-center",children:o.jsx(rc,{className:"text-brand-primary",size:20})}),o.jsxs("div",{children:[o.jsx("h2",{className:"text-lg font-bold text-gray-900",children:"Import Quotes"}),o.jsx("p",{className:"text-sm text-gray-600",children:"Upload PDF, Excel, or CSV files from suppliers."})]})]}),o.jsxs("div",{className:"mb-6",children:[o.jsx("label",{htmlFor:"supplier-name-input",className:"block text-sm font-medium text-gray-700 mb-2",children:"Supplier Name"}),o.jsx("input",{id:"supplier-name-input",type:"text",value:x,onChange:se=>g(se.target.value),placeholder:"Enter supplier name...",className:"w-full max-w-md px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#0A66C2] focus:border-[#0A66C2] transition"}),o.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"This name will be displayed throughout the analysis instead of the file name"})]}),o.jsx("div",{onDragOver:K,onDragLeave:V,onDrop:fe,className:`rounded-xl p-12 text-center transition-all border-2 border-dashed ${_?"border-brand-primary bg-orange-50":s.length>0?"border-green-300 bg-green-50":"border-gray-300 bg-gray-50 hover:border-gray-400"}`,children:s.length>0?o.jsxs("div",{children:[o.jsx(kr,{className:"mx-auto mb-4 text-green-600",size:48}),o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"File Attached"}),o.jsx("p",{className:"text-sm text-gray-600 mb-4",children:s[0].name}),o.jsxs("div",{className:"flex items-center justify-center gap-3",children:[o.jsx("button",{onClick:()=>{n([]),b(null)},className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors text-sm font-medium",children:"Remove File"}),o.jsxs("button",{onClick:()=>{if(!x.trim()){b({type:"error",text:"Please enter a supplier name first."});return}l?M(s):D(s)},disabled:a||!x.trim(),className:"btn-primary disabled:opacity-50 disabled:cursor-not-allowed inline-flex items-center gap-2",children:[a&&o.jsx(qs,{className:"animate-spin",size:18}),a?"Starting Parse...":"Parse Quote (Background)"]})]})]}):o.jsxs(o.Fragment,{children:[o.jsx(Vy,{className:`mx-auto mb-4 ${_?"text-brand-primary":"text-gray-400"}`,size:48}),o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:_?"Drop file here":"Drag and drop file here"}),o.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"or click to browse"}),o.jsx("input",{ref:Q,type:"file",accept:".pdf,.xlsx,.xls,.csv",multiple:!1,onChange:ve,className:"hidden"}),o.jsx("button",{onClick:()=>{var se;return(se=Q.current)==null?void 0:se.click()},disabled:a,className:"btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:"Attach File"}),o.jsx("p",{className:"text-xs text-gray-500 mt-4",children:"Supported formats: PDF, Excel (.xlsx, .xls), CSV"})]})})]}),a&&o.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-xl mb-6 p-4",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(qs,{className:"animate-spin text-blue-600 flex-shrink-0",size:20}),o.jsxs("div",{children:[o.jsx("div",{className:"font-medium text-blue-900",children:"Processing Quote..."}),o.jsx("div",{className:"text-sm text-blue-700 mt-0.5",children:"Extracting and analyzing quote data. This may take a minute for complex documents."})]})]})}),o.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[o.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Import Engine Features"}),o.jsxs("ul",{className:"text-sm text-gray-600 space-y-2",children:[o.jsxs("li",{className:"flex items-start gap-2",children:[o.jsx(kr,{size:16,className:"text-green-600 mt-0.5 flex-shrink-0"}),o.jsx("span",{children:"Automatic table detection for most supplier quote formats"})]}),o.jsxs("li",{className:"flex items-start gap-2",children:[o.jsx(kr,{size:16,className:"text-green-600 mt-0.5 flex-shrink-0"}),o.jsx("span",{children:"Fallback text parsing when tables can't be detected"})]}),o.jsxs("li",{className:"flex items-start gap-2",children:[o.jsx(kr,{size:16,className:"text-green-600 mt-0.5 flex-shrink-0"}),o.jsx("span",{children:"Support for multiple files per supplier"})]})]})]})]})}function OR(e){return o.jsx(IR,{...e})}const DR=[{normalized:"ea",displayName:"Each",aliases:[/^ea$/i,/^each$/i,/^nr$/i,/^no\.?$/i,/^number$/i,/^per$/i,/^item$/i,/^unit$/i,/^pce$/i,/^piece$/i]},{normalized:"m",displayName:"Square Meters",aliases:[/^m$/i,/^m2$/i,/^sqm$/i,/^sq\.?\s*m$/i,/^square\s*m(eter)?s?$/i,/^msq$/i]},{normalized:"m",displayName:"Linear Meters",aliases:[/^m$/i,/^lm$/i,/^lin\.?\s*m$/i,/^linear\s*m(eter)?s?$/i,/^metre?s?$/i,/^meter?s?$/i,/^mtrs?$/i,/^per\s*m(etre)?$/i,/^running\s*m(etre)?$/i]},{normalized:"L",displayName:"Liters",aliases:[/^l$/i,/^litre?s?$/i]},{normalized:"m",displayName:"Cubic Meters",aliases:[/^m$/i,/^m3$/i,/^cum$/i,/^cu\.?\s*m$/i,/^cubic\s*m(eter)?s?$/i]},{normalized:"hr",displayName:"Hours",aliases:[/^hr$/i,/^hrs?$/i,/^hour?s?$/i]},{normalized:"kg",displayName:"Kilograms",aliases:[/^kg$/i,/^kgs?$/i,/^kilogram?s?$/i]},{normalized:"t",displayName:"Tons",aliases:[/^t$/i,/^ton?s?$/i,/^tonne?s?$/i]},{normalized:"sum",displayName:"Sum",aliases:[/^sum$/i,/^p\.?s\.?$/i,/^prov\.?\s*sum$/i]}];function v1(e){if(!e)return{original:"",normalized:"ea",displayName:"Each",confidence:.5};const t=e.trim();if(t.length===0)return{original:e,normalized:"ea",displayName:"Each",confidence:.5};for(const r of DR)for(const s of r.aliases)if(s.test(t))return{original:e,normalized:r.normalized,displayName:r.displayName,confidence:1};return{original:e,normalized:t.toLowerCase(),displayName:t,confidence:.3}}function Af(e){if(typeof e=="number")return e;if(typeof e=="string"){const t=parseFloat(e.replace(/[^0-9.-]/g,""));return isNaN(t)?null:t}return null}function LR(e,t){return e&&t&&e!==0?t/e:null}function MR(e,t){return e&&t?e*t:null}function y1(e){return console.log("Attribute Extractor not fully implemented"),{}}function w1(e){let t=0;return e.qty&&e.rate&&(t+=40),e.unit&&(t+=20),e.description&&e.description.length>10&&(t+=20),e.system_id&&(t+=20),Math.min(t,100)}function BR(e){return e>=80?"text-green-600":e>=60?"text-amber-600":"text-red-600"}function UR(e){return e>=80?"High":e>=60?"Medium":"Low"}async function $R(e){return console.log("System matcher not fully implemented"),null}async function zR(e){return $R()}const VR=[{id:"PE_50_PEN",label:"50mm Penetration Seal",service:"penetration",size_min:0,size_max:75},{id:"PE_150_PEN",label:"150mm Penetration Seal",service:"penetration",size_min:76,size_max:200},{id:"LJ_25_PERIMETER",label:"25mm Linear Joint",service:"joint",size_min:0,size_max:50}];function WR(){return VR.reduce((e,t)=>(e[t.id]=t.label,e),{})}function $k({currentStep:e,totalSteps:t=5,onBack:r,onNext:s,backLabel:n,nextLabel:a,disabledNext:i=!1}){return o.jsx("div",{className:"border-t border-gray-200 bg-white px-8 py-4",children:o.jsxs("div",{className:"flex items-center justify-between max-w-7xl mx-auto",children:[o.jsx("div",{className:"flex-1",children:r&&o.jsxs("button",{onClick:r,className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:[o.jsx(fx,{size:16}),n||"Back"]})}),o.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:["Step ",e+1," of ",t]}),o.jsx("div",{className:"flex-1 flex justify-end",children:s&&o.jsxs("button",{onClick:s,disabled:i,className:`inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-white rounded-lg transition-colors ${i?"bg-gray-300 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:[a||"Next step",o.jsx(Cc,{size:16})]})})]})})}function Nx(e){return e.quantity===null||e.quantity===void 0||e.quantity===0}function HR(e){return e.toLowerCase().replace(/\s+/g," ").replace(/(\d+(\.\d+)?\s*mm)/g,"").replace(/fc\s*\d+/g,"").replace(/[-,]/g," ").trim()}function qR(e){return e.replace(/\s+/g," ").split(" ").slice(0,8).join(" ")}const Ff={ea:"No",each:"No",nr:"No",no:"No",m:"lm","linear meter":"lm","lineal meter":"lm",meter:"lm",metres:"lm",meters:"lm"};function GR({rawUnit:e,normalizedUnit:t,canonicalUnit:r}){const s=t||r,n=s||Ff[e.toLowerCase()]||e,a=s?s.toLowerCase()!==e.toLowerCase():Ff[e.toLowerCase()]&&Ff[e.toLowerCase()]!==e;return o.jsxs("div",{className:"flex flex-col text-sm",children:[o.jsx("span",{className:"font-medium text-gray-900",children:n}),a&&o.jsxs("span",{className:"text-[10px] text-slate-500",children:['normalised from "',e,'"']})]})}function KR({rawDescription:e,normalizedDescription:t}){const r=t||e,s=t&&t.trim()!==e.trim();return o.jsxs("div",{className:"flex flex-col text-sm max-w-xs",children:[o.jsx("span",{className:"font-medium text-gray-900 truncate",title:r,children:r}),s&&o.jsxs("span",{className:"text-[11px] text-slate-500 truncate",title:e,children:["original: ",e]})]})}function XR({mappedServiceType:e,mappedSystem:t,mappedPenetration:r,mappingConfidence:s,size:n,frr:a,service:i,subclass:l,material:c}){const u=e||t||r;return o.jsx("div",{className:"text-xs space-y-1",children:u?o.jsxs("div",{className:"flex flex-wrap gap-1",children:[e&&o.jsx("span",{className:"px-2 py-0.5 rounded-full bg-blue-50 text-blue-700 font-medium",children:e}),t&&o.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-50 text-emerald-700 font-medium",children:t}),r&&o.jsx("span",{className:"px-2 py-0.5 rounded-full bg-purple-50 text-purple-700 font-medium",children:r}),typeof s=="number"&&o.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-slate-100 text-slate-600 font-medium",children:[(s*100).toFixed(0),"%"]})]}):o.jsxs(o.Fragment,{children:[n&&o.jsxs("div",{className:"text-gray-600",children:["Size: ",n]}),a&&o.jsxs("div",{className:"text-gray-600",children:["FRR: ",a]}),i&&o.jsxs("div",{className:"text-blue-600",children:["Service: ",i]}),l&&o.jsxs("div",{className:"text-gray-600",children:["Type: ",l]}),c&&o.jsxs("div",{className:"text-gray-600",children:["Material: ",c]})]})})}function YR({projectId:e,onNavigateBack:t,onNavigateNext:r}){const[s,n]=T.useState([]),[a,i]=T.useState(null),[l,c]=T.useState([]),[u,d]=T.useState(null),[f,h]=T.useState({}),[p,m]=T.useState(!0),[x,g]=T.useState(!1),[y,w]=T.useState(!1),[v,b]=T.useState(!1),[_,k]=T.useState(!1),[S,E]=T.useState(null),[C,U]=T.useState(null),[H,W]=T.useState(null),q=WR(),z=async()=>{await ie.from("projects").update({updated_at:new Date().toISOString()}).eq("id",e)},Q=async()=>{try{await ie.from("project_settings").upsert({project_id:e,review_clean_completed:!0,updated_at:new Date().toISOString()},{onConflict:"project_id"})}catch(G){console.error("Error marking Review & Clean as complete:",G)}};T.useEffect(()=>{L()},[e]),T.useEffect(()=>{a&&X(a)},[a]);const L=async()=>{m(!0);const{data:G,error:ce}=await ie.from("quotes").select("*").eq("project_id",e).order("import_date",{ascending:!1});!ce&&G&&(n(G),G.length>0&&!a&&i(G[0].id)),m(!1)},X=async G=>{const{data:ce,error:te}=await ie.from("quote_items").select("*").eq("quote_id",G).order("created_at",{ascending:!0});!te&&ce&&c(ce)},K=async G=>{if(!a){console.error("normaliseAllItems: No selectedQuote");return}g(!0),E({type:"info",text:"Normalising items..."});const ce=G||l;console.log("normaliseAllItems: Processing",ce.length,"items");try{const te=ce.map(ae=>{const ge=Af(ae.quantity),le=Af(ae.unit_price);let je=Af(ae.total_price);const Ae=LR(je,ge),Se=MR(ge,le),Le=le||Ae,We=je||Se,rt=v1(ae.unit),vt=y1(ae.description),{confidence:$r,issues:Lt}=w1(ae.description,ge,ae.unit,rt.canonical,Le,We,vt.confidence);return{id:ae.id,quantity:ge||ae.quantity,unit_price:Le||ae.unit_price,total_price:We||ae.total_price,canonical_unit:rt.canonical||"",size:vt.size||"",frr:vt.frr||"",service:vt.service||"",subclass:vt.subclass||"",material:vt.material||"",confidence:$r,issues:JSON.stringify(Lt)}});console.log("normaliseAllItems: Saving",te.length,"updates to database");for(const ae of te){const{id:ge,...le}=ae,{error:je}=await ie.from("quote_items").update(le).eq("id",ge);je&&console.error("normaliseAllItems: Error updating item",ge,je)}await z(),await X(a),await L();const ue=te.filter(ae=>ae.confidence<.6).length;console.log("normaliseAllItems: Complete!",te.length,"items,",ue,"low confidence"),E({type:"success",text:`Normalisation complete! ${te.length} items processed. ${ue} items need review.`})}catch(te){console.error("Normalisation error:",te),E({type:"error",text:"Failed to normalise items. Please try again."})}finally{g(!1)}},V=async G=>{if(!a){console.error("mapAllItemsToSystems: No selectedQuote");return}w(!0),E({type:"info",text:"Mapping items to systems..."});const ce=G||l;console.log("mapAllItemsToSystems: Processing",ce.length,"items");try{const te=ce.map(ge=>{const le=zR({description:ge.description,size:ge.size,frr:ge.frr,service:ge.service,subclass:ge.subclass,material:ge.material});return{id:ge.id,system_id:le.systemId||"",system_label:le.systemLabel||"",system_confidence:le.confidence,system_needs_review:le.needsReview,system_manual_override:!1,matched_factors:JSON.stringify(le.matchedFactors),missed_factors:JSON.stringify(le.missedFactors)}});console.log("mapAllItemsToSystems: Saving",te.length,"updates to database");for(const ge of te){const{id:le,...je}=ge,{error:Ae}=await ie.from("quote_items").update(je).eq("id",le);Ae&&console.error("mapAllItemsToSystems: Error updating item",le,Ae)}await z(),await X(a),await Q();const ue=te.filter(ge=>ge.system_needs_review).length,ae=te.filter(ge=>ge.system_id).length;console.log("mapAllItemsToSystems: Complete!",ae,"/",te.length,"mapped,",ue,"need review"),E({type:"success",text:`Mapping complete! ${ae}/${te.length} items mapped. ${ue} need review.`})}catch(te){console.error("Mapping error:",te),E({type:"error",text:"Failed to map items to systems. Please try again."})}finally{w(!1)}},fe=async G=>{if(!a||x||y||v)return;b(!0),E({type:"info",text:"Step 1/2: Normalising items..."});const ce=G||l;try{let te=!0;try{await K(ce)}catch(ge){console.error("Normalise step failed:",ge),E({type:"error",text:"Normalise failed  please try again."}),te=!1}if(!te)return;E({type:"info",text:"Step 2/2: Mapping items to systems..."}),await new Promise(ge=>setTimeout(ge,200));const{data:ue}=await ie.from("quote_items").select("*").eq("quote_id",a).order("created_at",{ascending:!0});let ae=!0;try{await V(ue||ce)}catch(ge){console.error("Mapping step failed:",ge),E({type:"error",text:"System mapping failed  please review items."}),ae=!1}if(!ae)return;E({type:"success",text:"Smart Clean complete! All items normalised and mapped."})}catch(te){console.error("Smart Clean error:",te),E({type:"error",text:"Smart Clean failed. Please try individual steps."})}finally{b(!1)}},ve=async()=>{if(!(x||y||v||_)&&s.length!==0){console.log("========== PROCESS ALL QUOTES STARTED =========="),console.log("Processing",s.length,"quotes"),k(!0);try{for(let G=0;G<s.length;G++){const ce=s[G];console.log(`
--- Processing quote ${G+1}/${s.length}: ${ce.supplier_name} ---`),E({type:"info",text:`Processing quote ${G+1}/${s.length}: ${ce.supplier_name}`}),i(ce.id);const{data:te}=await ie.from("quote_items").select("*").eq("quote_id",ce.id).order("created_at",{ascending:!0});if(!te||te.length===0){console.warn(`No items found for quote ${ce.supplier_name}`);continue}console.log("Loaded",te.length,"items for quote",ce.supplier_name),c(te);try{await fe(te),console.log("Successfully processed quote:",ce.supplier_name)}catch(ue){console.error(`Processing failed for quote ${ce.supplier_name}:`,ue)}}console.log(`
========== PROCESS ALL QUOTES COMPLETE ==========`),a&&await X(a),await L(),E({type:"success",text:"All quotes processed successfully."})}catch(G){console.error("Process All Quotes error:",G),E({type:"error",text:"Failed to process all quotes. Some quotes may have been processed."})}finally{k(!1)}}},P=async(G,ce)=>{const te=q.find(ae=>ae.id===ce);if(!te)return;const{error:ue}=await ie.from("quote_items").update({system_id:ce,system_label:te.label,system_manual_override:!0,system_needs_review:!1}).eq("id",G);!ue&&a&&(await z(),X(a))},M=G=>{d(G.id),h({description:G.description,quantity:G.quantity,unit:G.unit,unit_price:G.unit_price,canonical_unit:G.canonical_unit,size:G.size,frr:G.frr,service:G.service,subclass:G.subclass,material:G.material})},D=()=>{d(null),h({})},B=async G=>{const ce=(f.quantity||0)*(f.unit_price||0),te=v1(f.unit);y1(f.description||"");const{confidence:ue,issues:ae}=w1(f.description,f.quantity,f.unit,f.canonical_unit||te.canonical,f.unit_price),{error:ge}=await ie.from("quote_items").update({...f,total_price:ce,canonical_unit:f.canonical_unit||te.canonical||"",confidence:ue,issues:JSON.stringify(ae)}).eq("id",G);ge||(await z(),d(null),h({}),X(a),L())},Y=async(G,ce)=>{const{error:te}=await ie.from("quote_items").update({is_excluded:!ce}).eq("id",G);!te&&a&&(await z(),X(a))},he=async G=>{if(!confirm("Are you sure you want to delete this item?"))return;const{error:ce}=await ie.from("quote_items").delete().eq("id",G);!ce&&a&&(await z(),X(a),L())},xe=async G=>{if(!confirm("Are you sure you want to delete this entire quote?"))return;const{error:ce}=await ie.from("quotes").delete().eq("id",G);ce||(a===G&&(i(null),c([])),L())},se=G=>{if(G===void 0||G===0)return o.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-medium rounded-full bg-gray-100 text-gray-600",children:"Not analysed"});const ce=BR(G),te=UR(G),ue={green:"bg-green-100 text-green-800",amber:"bg-yellow-100 text-yellow-800",red:"bg-red-100 text-red-800"};return o.jsxs("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${ue[ce]}`,children:[te," (",Math.round(G*100),"%)"]})},ne=G=>{if(!G)return[];if(typeof G=="string")try{return JSON.parse(G)}catch{return[]}return Array.isArray(G)?G:[]};if(p)return o.jsx("div",{className:"flex items-center justify-center h-64",children:o.jsx("div",{className:"text-gray-500",children:"Loading quotes..."})});if(s.length===0)return o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center",children:[o.jsx("p",{className:"text-gray-500 text-lg",children:"No quotes imported yet."}),o.jsx("p",{className:"text-gray-400 mt-2",children:"Go to Import Quotes to add your first quote."})]});const be=s.find(G=>G.id===a),N=(be==null?void 0:be.reconciliation_status)==="failed";return o.jsxs("div",{className:"space-y-6",children:[N&&be&&o.jsx("div",{className:"bg-red-50 border-2 border-red-400 rounded-lg p-4",children:o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx(it,{size:24,className:"text-red-600 flex-shrink-0 mt-0.5"}),o.jsxs("div",{className:"flex-1",children:[o.jsx("h4",{className:"font-bold text-red-900 text-lg",children:" Totals Reconciliation Failed"}),o.jsx("p",{className:"text-red-800 mt-1",children:be.reconciliation_notes}),o.jsxs("p",{className:"text-red-700 mt-2 text-sm",children:[o.jsx("strong",{children:"Variance:"})," ",((be.reconciliation_variance||0)*100).toFixed(2),"%",be.quoted_total&&o.jsxs(o.Fragment,{children:[" | ",o.jsx("strong",{children:"PDF Total:"})," $",be.quoted_total.toLocaleString()," | ",o.jsx("strong",{children:"Extracted Total:"})," $",be.total_amount.toLocaleString()]})]}),o.jsx("p",{className:"text-red-800 mt-3 font-medium",children:"This quote requires manual review. Possible causes: column swap, missing items, or incorrect extraction."})]})]})}),S&&o.jsx("div",{className:`p-4 rounded-md ${S.type==="success"?"bg-green-50 text-green-800":S.type==="error"?"bg-red-50 text-red-800":"bg-blue-50 text-blue-800"}`,children:o.jsxs("div",{className:"flex items-start gap-2",children:[o.jsx(it,{size:18,className:"mt-0.5 flex-shrink-0"}),o.jsx("span",{children:S.text})]})}),o.jsxs("div",{className:"grid grid-cols-12 gap-6",children:[o.jsx("div",{className:"col-span-3",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[o.jsx("div",{className:"p-4 border-b border-gray-200",children:o.jsx("h3",{className:"font-semibold text-gray-900",children:"Quotes"})}),o.jsx("div",{className:"divide-y divide-gray-200",children:s.map(G=>o.jsx("div",{className:`p-4 cursor-pointer hover:bg-gray-50 transition-colors ${a===G.id?"bg-blue-50 border-l-4 border-blue-600":""}`,onClick:()=>i(G.id),children:o.jsxs("div",{className:"flex items-start justify-between",children:[o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("p",{className:"font-medium text-gray-900 truncate",children:G.supplier_name}),o.jsx("p",{className:"text-sm text-gray-500 truncate",children:G.quote_reference||"No ref"}),o.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[o.jsxs("span",{className:"text-sm font-medium text-gray-900",children:["$",G.total_amount.toLocaleString()]}),o.jsx("span",{className:`inline-flex px-2 py-0.5 text-xs font-medium rounded-full ${G.status==="pending"?"bg-yellow-100 text-yellow-800":G.status==="reviewed"?"bg-blue-100 text-blue-800":G.status==="accepted"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:G.status})]})]}),o.jsx("button",{onClick:ce=>{ce.stopPropagation(),xe(G.id)},className:"p-1 text-red-600 hover:bg-red-50 rounded",children:o.jsx(bo,{size:16})})]})},G.id))})]})}),o.jsx("div",{className:"col-span-9",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[o.jsxs("div",{className:"p-4 border-b border-gray-200 flex items-center justify-between",children:[o.jsx("h3",{className:"font-semibold text-gray-900",children:"Quote Items"}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("button",{onClick:K,disabled:x||l.length===0,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed",children:[o.jsx(UF,{size:18}),x?"Normalising...":"Normalise All"]}),o.jsxs("button",{onClick:fe,disabled:v||x||y||l.length===0,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed",title:"Runs Normalise All and Map Systems together in one step",children:[o.jsx(Fc,{size:18}),v?"Smart Cleaning...":" Smart Clean"]}),o.jsxs("button",{onClick:V,disabled:y||l.length===0,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed",children:[o.jsx(RS,{size:18}),y?"Mapping...":"Map Systems"]}),o.jsx("div",{className:"border-l border-gray-300 h-8 mx-2"}),o.jsxs("button",{onClick:ve,disabled:_||x||y||v||s.length===0,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed",title:"Process all quotes sequentially with normalise, clean, and map",children:[o.jsx($F,{size:18}),_?"Processing All...":"Process All Quotes"]})]})]}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full",children:[o.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Description"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Qty"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Unit"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Rate"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Total"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Attributes"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Suggest System"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Confidence"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),o.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),o.jsx("tbody",{className:"divide-y divide-gray-200",children:l.map(G=>{const ce=ne(G.issues);return o.jsx("tr",{className:G.is_excluded?"bg-gray-50 opacity-60":"",children:u===G.id?o.jsxs(o.Fragment,{children:[o.jsx("td",{className:"px-4 py-3",children:o.jsx("input",{type:"text",value:f.description||"",onChange:te=>h({...f,description:te.target.value}),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm text-gray-900"})}),o.jsx("td",{className:"px-4 py-3",children:o.jsx("input",{type:"number",value:f.quantity||"",onChange:te=>h({...f,quantity:parseFloat(te.target.value)||0}),className:"w-20 px-2 py-1 border border-gray-300 rounded text-sm text-gray-900",step:"0.01"})}),o.jsx("td",{className:"px-4 py-3",children:o.jsx("input",{type:"text",value:f.unit||"",onChange:te=>h({...f,unit:te.target.value}),className:"w-20 px-2 py-1 border border-gray-300 rounded text-sm text-gray-900"})}),o.jsx("td",{className:"px-4 py-3",children:o.jsx("input",{type:"number",value:f.unit_price||"",onChange:te=>h({...f,unit_price:parseFloat(te.target.value)||0}),className:"w-24 px-2 py-1 border border-gray-300 rounded text-sm text-gray-900",step:"0.01"})}),o.jsxs("td",{className:"px-4 py-3 text-sm text-gray-900",children:["$",((f.quantity||0)*(f.unit_price||0)).toFixed(2)]}),o.jsx("td",{className:"px-4 py-3",children:o.jsxs("div",{className:"text-xs space-y-1",children:[f.canonical_unit&&o.jsxs("div",{children:["Unit: ",f.canonical_unit]}),f.service&&o.jsxs("div",{children:["Service: ",f.service]})]})}),o.jsx("td",{className:"px-4 py-3",children:o.jsx("span",{className:"text-sm text-gray-500",children:"Editing..."})}),o.jsx("td",{className:"px-4 py-3",children:o.jsx("span",{className:"text-sm text-gray-500",children:"Editing"})}),o.jsx("td",{className:"px-4 py-3",children:o.jsx("span",{className:"text-sm text-gray-500",children:"-"})}),o.jsx("td",{className:"px-4 py-3 text-right",children:o.jsxs("div",{className:"flex items-center justify-end gap-2",children:[o.jsx("button",{onClick:()=>B(G.id),className:"p-1 text-green-600 hover:bg-green-50 rounded",children:o.jsx(dx,{size:18})}),o.jsx("button",{onClick:D,className:"p-1 text-red-600 hover:bg-red-50 rounded",children:o.jsx(Qr,{size:18})})]})})]}):o.jsxs(o.Fragment,{children:[o.jsx("td",{className:"px-4 py-3 max-w-xs",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(KR,{rawDescription:G.raw_description||G.description,normalizedDescription:G.normalized_description}),Nx(G)&&o.jsx("span",{className:"inline-flex px-2 py-0.5 text-xs font-medium rounded-full bg-yellow-100 text-yellow-800 whitespace-nowrap",children:"Needs quantity"})]})}),o.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:G.quantity}),o.jsx("td",{className:"px-4 py-3",children:o.jsx(GR,{rawUnit:G.raw_unit||G.unit,normalizedUnit:G.normalized_unit,canonicalUnit:G.canonical_unit})}),o.jsxs("td",{className:"px-4 py-3 text-sm text-gray-900",children:["$",G.unit_price.toFixed(2)]}),o.jsxs("td",{className:"px-4 py-3 text-sm text-gray-900",children:["$",G.total_price.toFixed(2)]}),o.jsx("td",{className:"px-4 py-3",children:o.jsx(XR,{mappedServiceType:G.mapped_service_type,mappedSystem:G.mapped_system,mappedPenetration:G.mapped_penetration,mappingConfidence:G.mapping_confidence,size:G.size,frr:G.frr,service:G.service,subclass:G.subclass,material:G.material})}),o.jsx("td",{className:"px-4 py-3",children:G.system_label?o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex items-start gap-2",children:[o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:"text-xs font-medium text-gray-900 truncate",title:G.system_label,children:G.system_label}),o.jsx("div",{className:"text-xs text-gray-500",children:G.system_id}),G.system_manual_override&&o.jsx("div",{className:"text-xs text-blue-600 mt-0.5",children:"Manual override"})]}),G.system_confidence!==void 0&&o.jsxs("span",{className:`inline-flex px-1.5 py-0.5 text-xs font-medium rounded ${G.system_confidence>=.7?"bg-green-100 text-green-800":G.system_confidence>=.5?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:[Math.round(G.system_confidence*100),"%"]})]}),o.jsxs("select",{value:G.system_id||"",onChange:te=>P(G.id,te.target.value),className:"w-full text-xs border border-gray-300 rounded px-2 py-1 focus:ring-2 focus:ring-blue-500 focus:border-transparent text-gray-900",children:[o.jsx("option",{value:"",children:"-- Change System --"}),q.map(te=>o.jsx("option",{value:te.id,children:te.label},te.id))]}),(G.matched_factors||G.missed_factors)&&o.jsxs("button",{onClick:()=>W(H===G.id?null:G.id),className:"text-xs text-blue-600 hover:text-blue-800 flex items-center gap-1",children:[o.jsx(it,{size:12}),"Match details"]}),H===G.id&&o.jsxs("div",{className:"mt-1 p-2 bg-gray-50 rounded text-xs",children:[G.matched_factors&&JSON.parse(G.matched_factors).length>0&&o.jsxs("div",{className:"mb-2",children:[o.jsx("div",{className:"font-medium text-green-700 mb-1",children:"Matched:"}),o.jsx("ul",{className:"list-disc list-inside text-green-600 space-y-0.5",children:JSON.parse(G.matched_factors).map((te,ue)=>o.jsx("li",{children:te},ue))})]}),G.missed_factors&&JSON.parse(G.missed_factors).length>0&&o.jsxs("div",{children:[o.jsx("div",{className:"font-medium text-red-700 mb-1",children:"Missed:"}),o.jsx("ul",{className:"list-disc list-inside text-red-600 space-y-0.5",children:JSON.parse(G.missed_factors).map((te,ue)=>o.jsx("li",{children:te},ue))})]})]})]}):o.jsx("div",{className:"text-xs text-gray-400",children:"Not mapped"})}),o.jsxs("td",{className:"px-4 py-3",children:[o.jsxs("div",{className:"space-y-1",children:[se(G.confidence),ce.length>0&&o.jsxs("button",{onClick:()=>U(C===G.id?null:G.id),className:"text-xs text-red-600 hover:text-red-800 flex items-center gap-1",children:[o.jsx(it,{size:12}),ce.length," issue",ce.length!==1?"s":""]})]}),C===G.id&&ce.length>0&&o.jsx("div",{className:"mt-2 p-2 bg-red-50 rounded text-xs text-red-800",children:o.jsx("ul",{className:"list-disc list-inside space-y-1",children:ce.map((te,ue)=>o.jsx("li",{children:te},ue))})})]}),o.jsx("td",{className:"px-4 py-3",children:o.jsx("button",{onClick:()=>Y(G.id,G.is_excluded),className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${G.is_excluded?"bg-red-100 text-red-800 hover:bg-red-200":"bg-green-100 text-green-800 hover:bg-green-200"}`,children:G.is_excluded?"Excluded":"Included"})}),o.jsx("td",{className:"px-4 py-3 text-right",children:o.jsxs("div",{className:"flex items-center justify-end gap-2",children:[o.jsx("button",{onClick:()=>M(G),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",children:o.jsx(FS,{size:16})}),o.jsx("button",{onClick:()=>he(G.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",children:o.jsx(bo,{size:16})})]})})]})},G.id)})})]})})]})})]}),o.jsx($k,{currentStep:2,onBack:t,onNext:r,backLabel:"Back: Import Quotes",nextLabel:"Next: Quote Intelligence"})]})}function JR(){const{currentOrganisation:e}=ya(),[t,r]=T.useState([]),[s,n]=T.useState(null),[a,i]=T.useState(!0),[l,c]=T.useState(null),[u,d]=T.useState(null),[f,h]=T.useState(!1),[p,m]=T.useState(""),[x,g]=T.useState("all"),[y,w]=T.useState("all"),[v,b]=T.useState(null);T.useEffect(()=>{e!=null&&e.id&&(_(),k())},[e==null?void 0:e.id]);const _=async()=>{if(e!=null&&e.id){i(!0);try{const{data:z,error:Q}=await ie.from("review_queue_with_details").select("*").eq("organisation_id",e.id).in("status",["pending","in_review"]).order("priority").order("created_at");if(Q)throw Q;r(z||[])}catch(z){console.error("Failed to load review queue:",z),b({type:"error",text:"Failed to load review queue"})}finally{i(!1)}}},k=async()=>{if(e!=null&&e.id)try{const{data:z,error:Q}=await ie.rpc("get_review_queue_stats",{org_id:e.id});if(Q)throw Q;n(z)}catch(z){console.error("Failed to load stats:",z)}},S=z=>{c(z.id),d({description:z.description,quantity:z.quantity,unit:z.unit,unit_price:z.unit_price,total_price:z.total_price,system_label:z.system_label||""}),m("")},E=async(z=!1)=>{var Q;if(!(!l||!u)){h(!0);try{z?await ie.from("review_queue").update({status:"skipped",correction_notes:"Skipped by user",resolved_by:(Q=(await ie.auth.getUser()).data.user)==null?void 0:Q.id,resolved_at:new Date().toISOString()}).eq("id",l):await ie.rpc("resolve_review_queue_item",{review_id:l,corrected_data:u,notes:p||"Corrected by reviewer"}),b({type:"success",text:z?"Item skipped":"Item resolved successfully"}),await _(),await k();const L=t.findIndex(X=>X.id===l);L<t.length-1?S(t[L+1]):(c(null),d(null))}catch(L){console.error("Failed to resolve item:",L),b({type:"error",text:"Failed to resolve item"})}finally{h(!1)}}},C=T.useCallback(z=>{l&&(z.ctrlKey&&z.key==="Enter"?(z.preventDefault(),E(!1)):z.ctrlKey&&z.key==="s"&&(z.preventDefault(),E(!0)))},[l,u]);T.useEffect(()=>(window.addEventListener("keydown",C),()=>window.removeEventListener("keydown",C)),[C]);const U=z=>{switch(z){case"critical":return"bg-red-100 text-red-800 border-red-300";case"high":return"bg-orange-100 text-orange-800 border-orange-300";case"medium":return"bg-yellow-100 text-yellow-800 border-yellow-300";case"low":return"bg-blue-100 text-blue-800 border-blue-300";default:return"bg-gray-100 text-gray-800 border-gray-300"}},H=z=>({low_confidence:"Low Confidence",missing_quantity:"Missing Quantity",missing_unit:"Missing Unit",invalid_unit:"Invalid Unit",unclear_description:"Unclear Description",arithmetic_error:"Arithmetic Error",system_match_unclear:"System Match Unclear",duplicate_suspected:"Duplicate Suspected",outlier_price:"Outlier Price"})[z]||z,W=t.filter(z=>!(x!=="all"&&z.priority!==x||y!=="all"&&z.issue_type!==y)),q=t.find(z=>z.id===l);return a?o.jsx("div",{className:"flex items-center justify-center h-64",children:o.jsx("div",{className:"text-gray-500",children:"Loading review queue..."})}):o.jsxs("div",{className:"space-y-6",children:[o.jsx(Rn,{title:"Review Queue",subtitle:"Items requiring human review and correction"}),v&&o.jsx("div",{className:`p-4 rounded-md ${v.type==="success"?"bg-green-50 text-green-800":v.type==="error"?"bg-red-50 text-red-800":"bg-blue-50 text-blue-800"}`,children:o.jsxs("div",{className:"flex items-start gap-2",children:[o.jsx(it,{size:18,className:"mt-0.5 flex-shrink-0"}),o.jsx("span",{children:v.text})]})}),s&&o.jsxs("div",{className:"grid grid-cols-5 gap-4",children:[o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:[o.jsx("div",{className:"text-sm text-gray-600",children:"Pending"}),o.jsx("div",{className:"text-2xl font-bold text-gray-900 mt-1",children:s.total_pending})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:[o.jsx("div",{className:"text-sm text-gray-600",children:"In Review"}),o.jsx("div",{className:"text-2xl font-bold text-blue-600 mt-1",children:s.in_review})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:[o.jsx("div",{className:"text-sm text-gray-600",children:"Resolved Today"}),o.jsx("div",{className:"text-2xl font-bold text-green-600 mt-1",children:s.resolved_today})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-red-200 p-4",children:[o.jsx("div",{className:"text-sm text-red-600",children:"Critical Priority"}),o.jsx("div",{className:"text-2xl font-bold text-red-600 mt-1",children:s.critical})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-orange-200 p-4",children:[o.jsx("div",{className:"text-sm text-orange-600",children:"High Priority"}),o.jsx("div",{className:"text-2xl font-bold text-orange-600 mt-1",children:s.high})]})]}),o.jsxs("div",{className:"grid grid-cols-12 gap-6",children:[o.jsx("div",{className:"col-span-5",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[o.jsxs("div",{className:"p-4 border-b border-gray-200",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsx("h3",{className:"font-semibold text-gray-900",children:"Items Needing Review"}),o.jsxs("span",{className:"text-sm text-gray-600",children:[W.length," items"]})]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsxs("select",{value:x,onChange:z=>g(z.target.value),className:"flex-1 px-3 py-1 text-sm border border-gray-300 rounded-md",children:[o.jsx("option",{value:"all",children:"All Priorities"}),o.jsx("option",{value:"critical",children:"Critical"}),o.jsx("option",{value:"high",children:"High"}),o.jsx("option",{value:"medium",children:"Medium"}),o.jsx("option",{value:"low",children:"Low"})]}),o.jsxs("select",{value:y,onChange:z=>w(z.target.value),className:"flex-1 px-3 py-1 text-sm border border-gray-300 rounded-md",children:[o.jsx("option",{value:"all",children:"All Issue Types"}),o.jsx("option",{value:"low_confidence",children:"Low Confidence"}),o.jsx("option",{value:"missing_quantity",children:"Missing Quantity"}),o.jsx("option",{value:"system_match_unclear",children:"System Match Unclear"})]})]})]}),o.jsx("div",{className:"divide-y divide-gray-200 max-h-[600px] overflow-y-auto",children:W.length===0?o.jsxs("div",{className:"p-8 text-center text-gray-500",children:[o.jsx(kr,{size:48,className:"mx-auto mb-3 text-green-500"}),o.jsx("p",{className:"font-medium",children:"All clear!"}),o.jsx("p",{className:"text-sm mt-1",children:"No items need review"})]}):W.map(z=>o.jsxs("div",{className:`p-4 cursor-pointer hover:bg-gray-50 transition-colors ${l===z.id?"bg-blue-50 border-l-4 border-blue-600":""}`,onClick:()=>S(z),children:[o.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[o.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded border ${U(z.priority)}`,children:z.priority.toUpperCase()}),o.jsx("span",{className:"text-xs text-gray-500",children:H(z.issue_type)})]}),o.jsx("p",{className:"text-sm font-medium text-gray-900 mb-1 line-clamp-2",children:z.description}),o.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-600",children:[o.jsx("span",{children:z.supplier_name}),o.jsx("span",{children:""}),o.jsx("span",{children:z.project_name})]}),z.confidence!==null&&o.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[o.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-1.5",children:o.jsx("div",{className:`h-1.5 rounded-full ${z.confidence<.5?"bg-red-600":z.confidence<.75?"bg-yellow-600":"bg-green-600"}`,style:{width:`${z.confidence*100}%`}})}),o.jsxs("span",{className:"text-xs text-gray-600",children:[(z.confidence*100).toFixed(0),"%"]})]})]},z.id))})]})}),o.jsx("div",{className:"col-span-7",children:q?o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[o.jsxs("div",{className:"p-4 border-b border-gray-200",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("h3",{className:"font-semibold text-gray-900",children:"Review & Correct"}),o.jsx("div",{className:"flex items-center gap-2",children:o.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded border ${U(q.priority)}`,children:q.priority.toUpperCase()})})]}),o.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Issue: ",o.jsx("span",{className:"font-medium",children:H(q.issue_type)})]})]}),o.jsxs("div",{className:"p-6 space-y-4",children:[o.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-md p-3 mb-4",children:[o.jsx("div",{className:"text-xs font-medium text-gray-600 mb-1",children:"Context"}),o.jsxs("div",{className:"text-sm text-gray-900",children:[o.jsx("strong",{children:q.supplier_name}),"  ",q.project_name]}),q.confidence!==null&&o.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:["Confidence: ",(q.confidence*100).toFixed(1),"%"]})]}),u&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),o.jsx("textarea",{value:u.description,onChange:z=>d({...u,description:z.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Quantity"}),o.jsx("input",{type:"number",value:u.quantity,onChange:z=>d({...u,quantity:parseFloat(z.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Unit"}),o.jsx("input",{type:"text",value:u.unit,onChange:z=>d({...u,unit:z.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Unit Price ($)"}),o.jsx("input",{type:"number",step:"0.01",value:u.unit_price,onChange:z=>d({...u,unit_price:parseFloat(z.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Total Price ($)"}),o.jsx("input",{type:"number",step:"0.01",value:u.total_price,onChange:z=>d({...u,total_price:parseFloat(z.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"System Label"}),o.jsx("input",{type:"text",value:u.system_label,onChange:z=>d({...u,system_label:z.target.value}),placeholder:"e.g., Hilti CFS-F, Nullifire FS702",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Correction Notes"}),o.jsx("textarea",{value:p,onChange:z=>m(z.target.value),rows:2,placeholder:"Optional: Explain what was corrected...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),o.jsxs("div",{className:"flex gap-3 pt-4 border-t border-gray-200",children:[o.jsxs("button",{onClick:()=>E(!1),disabled:f,className:"flex-1 flex items-center justify-center gap-2 px-4 py-3 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors disabled:bg-gray-400 font-medium",children:[o.jsx(kr,{size:18}),f?"Saving...":"Save & Resolve",o.jsx("span",{className:"text-xs opacity-80",children:"(Ctrl+Enter)"})]}),o.jsxs("button",{onClick:()=>E(!0),disabled:f,className:"flex items-center justify-center gap-2 px-4 py-3 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 transition-colors disabled:bg-gray-200",children:[o.jsx(Qr,{size:18}),"Skip",o.jsx("span",{className:"text-xs opacity-80",children:"(Ctrl+S)"})]})]}),o.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-3 text-sm text-blue-800",children:[o.jsx("div",{className:"font-medium mb-1",children:"Keyboard Shortcuts"}),o.jsxs("div",{className:"text-xs space-y-1",children:[o.jsxs("div",{children:[o.jsx("kbd",{className:"px-1.5 py-0.5 bg-white border border-blue-300 rounded",children:"Ctrl + Enter"})," Save & Resolve"]}),o.jsxs("div",{children:[o.jsx("kbd",{className:"px-1.5 py-0.5 bg-white border border-blue-300 rounded",children:"Ctrl + S"})," Skip Item"]})]})]})]})]})]}):o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center",children:[o.jsx(Cc,{size:48,className:"mx-auto mb-3 text-gray-400"}),o.jsx("p",{className:"text-gray-500",children:"Select an item to review and edit"})]})})]})]})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Pd={};Pd.version="0.18.5";var zk=1252,QR=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],jx={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Ex=function(e){QR.indexOf(e)!=-1&&(zk=jx[0]=e)};function ZR(){Ex(1252)}var Gs=function(e){Ex(e)};function Tx(){Gs(1200),ZR()}function b1(e){for(var t=[],r=0,s=e.length;r<s;++r)t[r]=e.charCodeAt(r);return t}function e8(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function Vk(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var il=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?e8(e.slice(2)):t==254&&r==255?Vk(e.slice(2)):t==65279?e.slice(1):e},wu=function(t){return String.fromCharCode(t)},_1=function(t){return String.fromCharCode(t)},ic,Yn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function oc(e){for(var t="",r=0,s=0,n=0,a=0,i=0,l=0,c=0,u=0;u<e.length;)r=e.charCodeAt(u++),a=r>>2,s=e.charCodeAt(u++),i=(r&3)<<4|s>>4,n=e.charCodeAt(u++),l=(s&15)<<2|n>>6,c=n&63,isNaN(s)?l=c=64:isNaN(n)&&(c=64),t+=Yn.charAt(a)+Yn.charAt(i)+Yn.charAt(l)+Yn.charAt(c);return t}function fs(e){var t="",r=0,s=0,n=0,a=0,i=0,l=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)a=Yn.indexOf(e.charAt(u++)),i=Yn.indexOf(e.charAt(u++)),r=a<<2|i>>4,t+=String.fromCharCode(r),l=Yn.indexOf(e.charAt(u++)),s=(i&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(s)),c=Yn.indexOf(e.charAt(u++)),n=(l&3)<<6|c,c!==64&&(t+=String.fromCharCode(n));return t}var Ke=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Dn=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function ua(e){return Ke?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function S1(e){return Ke?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var is=function(t){return Ke?Dn(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function x0(e){if(typeof ArrayBuffer>"u")return is(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),s=0;s!=e.length;++s)r[s]=e.charCodeAt(s)&255;return t}function wa(e){if(Array.isArray(e))return e.map(function(s){return String.fromCharCode(s)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function t8(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function Cx(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Cx(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var nr=Ke?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Dn(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var s=new Uint8Array(r),n=0;for(t=0,r=0;t<e.length;r+=n,++t)if(n=e[t].length,e[t]instanceof Uint8Array)s.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";s.set(new Uint8Array(e[t]),r)}return s}return[].concat.apply([],e.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function r8(e){for(var t=[],r=0,s=e.length+250,n=ua(e.length+255),a=0;a<e.length;++a){var i=e.charCodeAt(a);if(i<128)n[r++]=i;else if(i<2048)n[r++]=192|i>>6&31,n[r++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var l=e.charCodeAt(++a)&1023;n[r++]=240|i>>8&7,n[r++]=128|i>>2&63,n[r++]=128|l>>6&15|(i&3)<<4,n[r++]=128|l&63}else n[r++]=224|i>>12&15,n[r++]=128|i>>6&63,n[r++]=128|i&63;r>s&&(t.push(n.slice(0,r)),r=0,n=ua(65535),s=65530)}return t.push(n.slice(0,r)),nr(t)}var Mr=/\u0000/g,ol=/[\u0001-\u0006]/g;function no(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Ks(e,t){var r=""+e;return r.length>=t?r:It("0",t-r.length)+r}function Ax(e,t){var r=""+e;return r.length>=t?r:It(" ",t-r.length)+r}function Rd(e,t){var r=""+e;return r.length>=t?r:r+It(" ",t-r.length)}function s8(e,t){var r=""+Math.round(e);return r.length>=t?r:It("0",t-r.length)+r}function n8(e,t){var r=""+e;return r.length>=t?r:It("0",t-r.length)+r}var k1=Math.pow(2,32);function Ni(e,t){if(e>k1||e<-k1)return s8(e,t);var r=Math.round(e);return n8(r,t)}function Id(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var N1=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Pf=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function a8(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Be={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},j1={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},i8={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Od(e,t,r){for(var s=e<0?-1:1,n=e*s,a=0,i=1,l=0,c=1,u=0,d=0,f=Math.floor(n);u<t&&(f=Math.floor(n),l=f*i+a,d=f*u+c,!(n-f<5e-8));)n=1/(n-f),a=i,i=l,c=u,u=d;if(d>t&&(u>t?(d=c,l=a):(d=u,l=i)),!r)return[0,s*l,d];var h=Math.floor(s*l/d);return[h,s*l-h*d,d]}function $a(e,t,r){if(e>2958465||e<0)return null;var s=e|0,n=Math.floor(86400*(e-s)),a=0,i=[],l={D:s,T:n,u:86400*(e-s)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(s+=1462),l.u>.9999&&(l.u=0,++n==86400&&(l.T=n=0,++s,++l.D)),s===60)i=r?[1317,10,29]:[1900,2,29],a=3;else if(s===0)i=r?[1317,8,29]:[1900,1,0],a=6;else{s>60&&--s;var c=new Date(1900,0,1);c.setDate(c.getDate()+s-1),i=[c.getFullYear(),c.getMonth()+1,c.getDate()],a=c.getDay(),s<60&&(a=(a+6)%7),r&&(a=f8(c,i))}return l.y=i[0],l.m=i[1],l.d=i[2],l.S=n%60,n=Math.floor(n/60),l.M=n%60,n=Math.floor(n/60),l.H=n,l.q=a,l}var Wk=new Date(1899,11,31,0,0,0),o8=Wk.getTime(),l8=new Date(1900,2,1,0,0,0);function Hk(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=l8&&(r+=24*60*60*1e3),(r-(o8+(e.getTimezoneOffset()-Wk.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Fx(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function c8(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function u8(e){var t=e<0?12:11,r=Fx(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function d8(e){var t=Fx(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function lc(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=u8(e):t===10?r=e.toFixed(10).substr(0,12):r=d8(e),Fx(c8(r.toUpperCase()))}function ni(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):lc(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Os(14,Hk(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function f8(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function h8(e,t,r,s){var n="",a=0,i=0,l=r.y,c,u=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:c=l%100,u=2;break;default:c=l%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,u=t.length;break;case 3:return Pf[r.m-1][1];case 5:return Pf[r.m-1][0];default:return Pf[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,u=t.length;break;case 3:return N1[r.q][0];default:return N1[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Ks(r.S,t.length):(s>=2?i=s===3?1e3:100:i=s===1?10:1,a=Math.round(i*(r.S+r.u)),a>=60*i&&(a=0),t==="s"?a===0?"0":""+a/i:(n=Ks(a,2+s),t==="ss"?n.substr(0,2):"."+n.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:c=l,u=1;break}var d=u>0?Ks(c,u):"";return d}function Jn(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,s=e.substr(0,r);r!=e.length;r+=t)s+=(s.length>0?",":"")+e.substr(r,t);return s}var qk=/%/g;function m8(e,t,r){var s=t.replace(qk,""),n=t.length-s.length;return kn(e,s,r*Math.pow(10,2*n))+It("%",n)}function p8(e,t,r){for(var s=t.length-1;t.charCodeAt(s-1)===44;)--s;return kn(e,t.substr(0,s),r/Math.pow(10,3*(t.length-s)))}function Gk(e,t){var r,s=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Gk(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%n;if(a<0&&(a+=n),r=(t/Math.pow(10,a)).toPrecision(s+1+(n+a)%n),r.indexOf("e")===-1){var i=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,n)+"."+r.substr(2+n),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,d){return c+u+d.substr(0,(n+a)%n)+"."+d.substr(a)+"E"})}else r=t.toExponential(s);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var Kk=/# (\?+)( ?)\/( ?)(\d+)/;function x8(e,t,r){var s=parseInt(e[4],10),n=Math.round(t*s),a=Math.floor(n/s),i=n-a*s,l=s;return r+(a===0?"":""+a)+" "+(i===0?It(" ",e[1].length+1+e[4].length):Ax(i,e[1].length)+e[2]+"/"+e[3]+Ks(l,e[4].length))}function g8(e,t,r){return r+(t===0?"":""+t)+It(" ",e[1].length+2+e[4].length)}var Xk=/^#*0*\.([0#]+)/,Yk=/\).*[0#]/,Jk=/\(###\) ###\\?-####/;function Rr(e){for(var t="",r,s=0;s!=e.length;++s)switch(r=e.charCodeAt(s)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function E1(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function T1(e,t){var r=e-Math.floor(e),s=Math.pow(10,t);return t<(""+Math.round(r*s)).length?0:Math.round(r*s)}function v8(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function y8(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function ys(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Yk)){var s=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ys("n",s,r):"("+ys("n",s,-r)+")"}if(t.charCodeAt(t.length-1)===44)return p8(e,t,r);if(t.indexOf("%")!==-1)return m8(e,t,r);if(t.indexOf("E")!==-1)return Gk(t,r);if(t.charCodeAt(0)===36)return"$"+ys(e,t.substr(t.charAt(1)==" "?2:1),r);var n,a,i,l,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Ni(c,t.length);if(t.match(/^[#?]+$/))return n=Ni(r,0),n==="0"&&(n=""),n.length>t.length?n:Rr(t.substr(0,t.length-n.length))+n;if(a=t.match(Kk))return x8(a,c,u);if(t.match(/^#+0+$/))return u+Ni(c,t.length-t.indexOf("0"));if(a=t.match(Xk))return n=E1(r,a[1].length).replace(/^([^\.]+)$/,"$1."+Rr(a[1])).replace(/\.$/,"."+Rr(a[1])).replace(/\.(\d*)$/,function(m,x){return"."+x+It("0",Rr(a[1]).length-x.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return u+E1(c,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return u+Jn(Ni(c,0));if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ys(e,t,-r):Jn(""+(Math.floor(r)+v8(r,a[1].length)))+"."+Ks(T1(r,a[1].length),a[1].length);if(a=t.match(/^#,#*,#0/))return ys(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=no(ys(e,t.replace(/[\\-]/g,""),r)),i=0,no(no(t.replace(/\\/g,"")).replace(/[0#]/g,function(m){return i<n.length?n.charAt(i++):m==="0"?"0":""}));if(t.match(Jk))return n=ys(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var d="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),l=Od(c,Math.pow(10,i)-1,!1),n=""+u,d=kn("n",a[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),n+=d+a[2]+"/"+a[3],d=Rd(l[2],i),d.length<a[4].length&&(d=Rr(a[4].substr(a[4].length-d.length))+d),n+=d,n;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),l=Od(c,Math.pow(10,i)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Ax(l[1],i)+a[2]+"/"+a[3]+Rd(l[2],i):It(" ",2*i+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return n=Ni(r,0),t.length<=n.length?n:Rr(t.substr(0,t.length-n.length))+n;if(a=t.match(/^([#0?]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=n.indexOf(".");var f=t.indexOf(".")-i,h=t.length-n.length-f;return Rr(t.substr(0,f)+n+t.substr(t.length-h))}if(a=t.match(/^00,000\.([#0]*0)$/))return i=T1(r,a[1].length),r<0?"-"+ys(e,t,-r):Jn(y8(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?Ks(0,3-m.length):"")+m})+"."+Ks(i,a[1].length);switch(t){case"###,##0.00":return ys(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=Jn(Ni(c,0));return p!=="0"?u+p:"";case"###,###.00":return ys(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return ys(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function w8(e,t,r){for(var s=t.length-1;t.charCodeAt(s-1)===44;)--s;return kn(e,t.substr(0,s),r/Math.pow(10,3*(t.length-s)))}function b8(e,t,r){var s=t.replace(qk,""),n=t.length-s.length;return kn(e,s,r*Math.pow(10,2*n))+It("%",n)}function Qk(e,t){var r,s=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Qk(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%n;if(a<0&&(a+=n),r=(t/Math.pow(10,a)).toPrecision(s+1+(n+a)%n),!r.match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,d){return c+u+d.substr(0,(n+a)%n)+"."+d.substr(a)+"E"})}else r=t.toExponential(s);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function rn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Yk)){var s=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?rn("n",s,r):"("+rn("n",s,-r)+")"}if(t.charCodeAt(t.length-1)===44)return w8(e,t,r);if(t.indexOf("%")!==-1)return b8(e,t,r);if(t.indexOf("E")!==-1)return Qk(t,r);if(t.charCodeAt(0)===36)return"$"+rn(e,t.substr(t.charAt(1)==" "?2:1),r);var n,a,i,l,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Ks(c,t.length);if(t.match(/^[#?]+$/))return n=""+r,r===0&&(n=""),n.length>t.length?n:Rr(t.substr(0,t.length-n.length))+n;if(a=t.match(Kk))return g8(a,c,u);if(t.match(/^#+0+$/))return u+Ks(c,t.length-t.indexOf("0"));if(a=t.match(Xk))return n=(""+r).replace(/^([^\.]+)$/,"$1."+Rr(a[1])).replace(/\.$/,"."+Rr(a[1])),n=n.replace(/\.(\d*)$/,function(m,x){return"."+x+It("0",Rr(a[1]).length-x.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return u+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return u+Jn(""+c);if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+rn(e,t,-r):Jn(""+r)+"."+It("0",a[1].length);if(a=t.match(/^#,#*,#0/))return rn(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=no(rn(e,t.replace(/[\\-]/g,""),r)),i=0,no(no(t.replace(/\\/g,"")).replace(/[0#]/g,function(m){return i<n.length?n.charAt(i++):m==="0"?"0":""}));if(t.match(Jk))return n=rn(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var d="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),l=Od(c,Math.pow(10,i)-1,!1),n=""+u,d=kn("n",a[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),n+=d+a[2]+"/"+a[3],d=Rd(l[2],i),d.length<a[4].length&&(d=Rr(a[4].substr(a[4].length-d.length))+d),n+=d,n;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),l=Od(c,Math.pow(10,i)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Ax(l[1],i)+a[2]+"/"+a[3]+Rd(l[2],i):It(" ",2*i+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return n=""+r,t.length<=n.length?n:Rr(t.substr(0,t.length-n.length))+n;if(a=t.match(/^([#0]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=n.indexOf(".");var f=t.indexOf(".")-i,h=t.length-n.length-f;return Rr(t.substr(0,f)+n+t.substr(t.length-h))}if(a=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+rn(e,t,-r):Jn(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?Ks(0,3-m.length):"")+m})+"."+Ks(0,a[1].length);switch(t){case"###,###":case"##,###":case"#,###":var p=Jn(""+c);return p!=="0"?u+p:"";default:if(t.match(/\.[0#?]*$/))return rn(e,t.slice(0,t.lastIndexOf(".")),r)+Rr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function kn(e,t,r){return(r|0)===r?rn(e,t,r):ys(e,t,r)}function _8(e){for(var t=[],r=!1,s=0,n=0;s<e.length;++s)switch(e.charCodeAt(s)){case 34:r=!r;break;case 95:case 42:case 92:++s;break;case 59:t[t.length]=e.substr(n,s-n),n=s+1}if(t[t.length]=e.substr(n),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var Zk=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Do(e){for(var t=0,r="",s="";t<e.length;)switch(r=e.charAt(t)){case"G":Id(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(s=r;e.charAt(t++)!=="]"&&t<e.length;)s+=e.charAt(t);if(s.match(Zk))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function S8(e,t,r,s){for(var n=[],a="",i=0,l="",c="t",u,d,f,h="H";i<e.length;)switch(l=e.charAt(i)){case"G":if(!Id(e,i))throw new Error("unrecognized character "+l+" in "+e);n[n.length]={t:"G",v:"General"},i+=7;break;case'"':for(a="";(f=e.charCodeAt(++i))!==34&&i<e.length;)a+=String.fromCharCode(f);n[n.length]={t:"t",v:a},++i;break;case"\\":var p=e.charAt(++i),m=p==="("||p===")"?p:"t";n[n.length]={t:m,v:p},++i;break;case"_":n[n.length]={t:"t",v:" "},i+=2;break;case"@":n[n.length]={t:"T",v:t},++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2"){if(u==null&&(u=$a(t,r,e.charAt(i+1)==="2"),u==null))return"";n[n.length]={t:"X",v:e.substr(i,2)},c=l,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=$a(t,r),u==null))return"";for(a=l;++i<e.length&&e.charAt(i).toLowerCase()===l;)a+=l;l==="m"&&c.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=h),n[n.length]={t:l,v:a},c=l;break;case"A":case"a":case"":var x={t:l,v:l};if(u==null&&(u=$a(t,r)),e.substr(i,3).toUpperCase()==="A/P"?(u!=null&&(x.v=u.H>=12?"P":"A"),x.t="T",h="h",i+=3):e.substr(i,5).toUpperCase()==="AM/PM"?(u!=null&&(x.v=u.H>=12?"PM":"AM"),x.t="T",i+=5,h="h"):e.substr(i,5).toUpperCase()==="/"?(u!=null&&(x.v=u.H>=12?"":""),x.t="T",i+=5,h="h"):(x.t="t",++i),u==null&&x.t==="T")return"";n[n.length]=x,c=l;break;case"[":for(a=l;e.charAt(i++)!=="]"&&i<e.length;)a+=e.charAt(i);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(Zk)){if(u==null&&(u=$a(t,r),u==null))return"";n[n.length]={t:"Z",v:a.toLowerCase()},c=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",Do(e)||(n[n.length]={t:"t",v:a}));break;case".":if(u!=null){for(a=l;++i<e.length&&(l=e.charAt(i))==="0";)a+=l;n[n.length]={t:"s",v:a};break}case"0":case"#":for(a=l;++i<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(i))>-1;)a+=l;n[n.length]={t:"n",v:a};break;case"?":for(a=l;e.charAt(++i)===l;)a+=l;n[n.length]={t:l,v:a},c=l;break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":n[n.length]={t:s===1?"t":l,v:l},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=l;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;)a+=e.charAt(i);n[n.length]={t:"D",v:a};break;case" ":n[n.length]={t:l,v:l},++i;break;case"$":n[n.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);n[n.length]={t:"t",v:l},++i;break}var g=0,y=0,w;for(i=n.length-1,c="t";i>=0;--i)switch(n[i].t){case"h":case"H":n[i].t=h,c="h",g<1&&(g=1);break;case"s":(w=n[i].v.match(/\.0+$/))&&(y=Math.max(y,w[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":c=n[i].t;break;case"m":c==="s"&&(n[i].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&n[i].v.match(/[Hh]/)&&(g=1),g<2&&n[i].v.match(/[Mm]/)&&(g=2),g<3&&n[i].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var v="",b;for(i=0;i<n.length;++i)switch(n[i].t){case"t":case"T":case" ":case"D":break;case"X":n[i].v="",n[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":n[i].v=h8(n[i].t.charCodeAt(0),n[i].v,u,y),n[i].t="t";break;case"n":case"?":for(b=i+1;n[b]!=null&&((l=n[b].t)==="?"||l==="D"||(l===" "||l==="t")&&n[b+1]!=null&&(n[b+1].t==="?"||n[b+1].t==="t"&&n[b+1].v==="/")||n[i].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(n[b].v==="/"||n[b].v===" "&&n[b+1]!=null&&n[b+1].t=="?"));)n[i].v+=n[b].v,n[b]={v:"",t:";"},++b;v+=n[i].v,i=b-1;break;case"G":n[i].t="t",n[i].v=ni(t,r);break}var _="",k,S;if(v.length>0){v.charCodeAt(0)==40?(k=t<0&&v.charCodeAt(0)===45?-t:t,S=kn("n",v,k)):(k=t<0&&s>1?-t:t,S=kn("n",v,k),k<0&&n[0]&&n[0].t=="t"&&(S=S.substr(1),n[0].v="-"+n[0].v)),b=S.length-1;var E=n.length;for(i=0;i<n.length;++i)if(n[i]!=null&&n[i].t!="t"&&n[i].v.indexOf(".")>-1){E=i;break}var C=n.length;if(E===n.length&&S.indexOf("E")===-1){for(i=n.length-1;i>=0;--i)n[i]==null||"n?".indexOf(n[i].t)===-1||(b>=n[i].v.length-1?(b-=n[i].v.length,n[i].v=S.substr(b+1,n[i].v.length)):b<0?n[i].v="":(n[i].v=S.substr(0,b+1),b=-1),n[i].t="t",C=i);b>=0&&C<n.length&&(n[C].v=S.substr(0,b+1)+n[C].v)}else if(E!==n.length&&S.indexOf("E")===-1){for(b=S.indexOf(".")-1,i=E;i>=0;--i)if(!(n[i]==null||"n?".indexOf(n[i].t)===-1)){for(d=n[i].v.indexOf(".")>-1&&i===E?n[i].v.indexOf(".")-1:n[i].v.length-1,_=n[i].v.substr(d+1);d>=0;--d)b>=0&&(n[i].v.charAt(d)==="0"||n[i].v.charAt(d)==="#")&&(_=S.charAt(b--)+_);n[i].v=_,n[i].t="t",C=i}for(b>=0&&C<n.length&&(n[C].v=S.substr(0,b+1)+n[C].v),b=S.indexOf(".")+1,i=E;i<n.length;++i)if(!(n[i]==null||"n?(".indexOf(n[i].t)===-1&&i!==E)){for(d=n[i].v.indexOf(".")>-1&&i===E?n[i].v.indexOf(".")+1:0,_=n[i].v.substr(0,d);d<n[i].v.length;++d)b<S.length&&(_+=S.charAt(b++));n[i].v=_,n[i].t="t",C=i}}}for(i=0;i<n.length;++i)n[i]!=null&&"n?".indexOf(n[i].t)>-1&&(k=s>1&&t<0&&i>0&&n[i-1].v==="-"?-t:t,n[i].v=kn(n[i].t,n[i].v,k),n[i].t="t");var U="";for(i=0;i!==n.length;++i)n[i]!=null&&(U+=n[i].v);return U}var C1=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function A1(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function k8(e,t){var r=_8(e),s=r.length,n=r[s-1].indexOf("@");if(s<4&&n>-1&&--s,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||n>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=n>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=n>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=n>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[s,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var i=r[0].match(C1),l=r[1].match(C1);return A1(t,i)?[s,r[0]]:A1(t,l)?[s,r[1]]:[s,r[i!=null&&l!=null?2:1]]}return[s,a]}function Os(e,t,r){r==null&&(r={});var s="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?s=r.dateNF:s=e;break;case"number":e==14&&r.dateNF?s=r.dateNF:s=(r.table!=null?r.table:Be)[e],s==null&&(s=r.table&&r.table[j1[e]]||Be[j1[e]]),s==null&&(s=i8[e]||"General");break}if(Id(s,0))return ni(t,r);t instanceof Date&&(t=Hk(t,r.date1904));var n=k8(s,t);if(Id(n[1]))return ni(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return S8(n[1],t,r,n[0])}function Nn(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Be[r]==null){t<0&&(t=r);continue}if(Be[r]==e){t=r;break}}t<0&&(t=391)}return Be[t]=e,t}function g0(e){for(var t=0;t!=392;++t)e[t]!==void 0&&Nn(e[t],t)}function Lo(){Be=a8()}var N8={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},eN=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function j8(e){var t=typeof e=="number"?Be[e]:e;return t=t.replace(eN,"(\\d+)"),new RegExp("^"+t+"$")}function E8(e,t,r){var s=-1,n=-1,a=-1,i=-1,l=-1,c=-1;(t.match(eN)||[]).forEach(function(f,h){var p=parseInt(r[h+1],10);switch(f.toLowerCase().charAt(0)){case"y":s=p;break;case"d":a=p;break;case"h":i=p;break;case"s":c=p;break;case"m":i>=0?l=p:n=p;break}}),c>=0&&l==-1&&n>=0&&(l=n,n=-1);var u=(""+(s>=0?s:new Date().getFullYear())).slice(-4)+"-"+("00"+(n>=1?n:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var d=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return i==-1&&l==-1&&c==-1?u:s==-1&&n==-1&&a==-1?d:u+"T"+d}var T8=function(){var e={};e.version="1.2.0";function t(){for(var S=0,E=new Array(256),C=0;C!=256;++C)S=C,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,E[C]=S;return typeof Int32Array<"u"?new Int32Array(E):E}var r=t();function s(S){var E=0,C=0,U=0,H=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(U=0;U!=256;++U)H[U]=S[U];for(U=0;U!=256;++U)for(C=S[U],E=256+U;E<4096;E+=256)C=H[E]=C>>>8^S[C&255];var W=[];for(U=1;U!=16;++U)W[U-1]=typeof Int32Array<"u"?H.subarray(U*256,U*256+256):H.slice(U*256,U*256+256);return W}var n=s(r),a=n[0],i=n[1],l=n[2],c=n[3],u=n[4],d=n[5],f=n[6],h=n[7],p=n[8],m=n[9],x=n[10],g=n[11],y=n[12],w=n[13],v=n[14];function b(S,E){for(var C=E^-1,U=0,H=S.length;U<H;)C=C>>>8^r[(C^S.charCodeAt(U++))&255];return~C}function _(S,E){for(var C=E^-1,U=S.length-15,H=0;H<U;)C=v[S[H++]^C&255]^w[S[H++]^C>>8&255]^y[S[H++]^C>>16&255]^g[S[H++]^C>>>24]^x[S[H++]]^m[S[H++]]^p[S[H++]]^h[S[H++]]^f[S[H++]]^d[S[H++]]^u[S[H++]]^c[S[H++]]^l[S[H++]]^i[S[H++]]^a[S[H++]]^r[S[H++]];for(U+=15;H<U;)C=C>>>8^r[(C^S[H++])&255];return~C}function k(S,E){for(var C=E^-1,U=0,H=S.length,W=0,q=0;U<H;)W=S.charCodeAt(U++),W<128?C=C>>>8^r[(C^W)&255]:W<2048?(C=C>>>8^r[(C^(192|W>>6&31))&255],C=C>>>8^r[(C^(128|W&63))&255]):W>=55296&&W<57344?(W=(W&1023)+64,q=S.charCodeAt(U++)&1023,C=C>>>8^r[(C^(240|W>>8&7))&255],C=C>>>8^r[(C^(128|W>>2&63))&255],C=C>>>8^r[(C^(128|q>>6&15|(W&3)<<4))&255],C=C>>>8^r[(C^(128|q&63))&255]):(C=C>>>8^r[(C^(224|W>>12&15))&255],C=C>>>8^r[(C^(128|W>>6&63))&255],C=C>>>8^r[(C^(128|W&63))&255]);return~C}return e.table=r,e.bstr=b,e.buf=_,e.str=k,e}(),De=function(){var t={};t.version="1.2.1";function r(j,R){for(var A=j.split("/"),F=R.split("/"),I=0,O=0,Z=Math.min(A.length,F.length);I<Z;++I){if(O=A[I].length-F[I].length)return O;if(A[I]!=F[I])return A[I]<F[I]?-1:1}return A.length-F.length}function s(j){if(j.charAt(j.length-1)=="/")return j.slice(0,-1).indexOf("/")===-1?j:s(j.slice(0,-1));var R=j.lastIndexOf("/");return R===-1?j:j.slice(0,R+1)}function n(j){if(j.charAt(j.length-1)=="/")return n(j.slice(0,-1));var R=j.lastIndexOf("/");return R===-1?j:j.slice(R+1)}function a(j,R){typeof R=="string"&&(R=new Date(R));var A=R.getHours();A=A<<6|R.getMinutes(),A=A<<5|R.getSeconds()>>>1,j.write_shift(2,A);var F=R.getFullYear()-1980;F=F<<4|R.getMonth()+1,F=F<<5|R.getDate(),j.write_shift(2,F)}function i(j){var R=j.read_shift(2)&65535,A=j.read_shift(2)&65535,F=new Date,I=A&31;A>>>=5;var O=A&15;A>>>=4,F.setMilliseconds(0),F.setFullYear(A+1980),F.setMonth(O-1),F.setDate(I);var Z=R&31;R>>>=5;var de=R&63;return R>>>=6,F.setHours(R),F.setMinutes(de),F.setSeconds(Z<<1),F}function l(j){dr(j,0);for(var R={},A=0;j.l<=j.length-4;){var F=j.read_shift(2),I=j.read_shift(2),O=j.l+I,Z={};switch(F){case 21589:A=j.read_shift(1),A&1&&(Z.mtime=j.read_shift(4)),I>5&&(A&2&&(Z.atime=j.read_shift(4)),A&4&&(Z.ctime=j.read_shift(4))),Z.mtime&&(Z.mt=new Date(Z.mtime*1e3));break}j.l=O,R[F]=Z}return R}var c;function u(){return c||(c={})}function d(j,R){if(j[0]==80&&j[1]==75)return xs(j,R);if((j[0]|32)==109&&(j[1]|32)==105)return Uo(j,R);if(j.length<512)throw new Error("CFB file size "+j.length+" < 512");var A=3,F=512,I=0,O=0,Z=0,de=0,J=0,ee=[],re=j.slice(0,512);dr(re,0);var ye=f(re);switch(A=ye[0],A){case 3:F=512;break;case 4:F=4096;break;case 0:if(ye[1]==0)return xs(j,R);default:throw new Error("Major Version: Expected 3 or 4 saw "+A)}F!==512&&(re=j.slice(0,F),dr(re,28));var Ee=j.slice(0,F);h(re,A);var Fe=re.read_shift(4,"i");if(A===3&&Fe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Fe);re.l+=4,Z=re.read_shift(4,"i"),re.l+=4,re.chk("00100000","Mini Stream Cutoff Size: "),de=re.read_shift(4,"i"),I=re.read_shift(4,"i"),J=re.read_shift(4,"i"),O=re.read_shift(4,"i");for(var _e=-1,Ce=0;Ce<109&&(_e=re.read_shift(4,"i"),!(_e<0));++Ce)ee[Ce]=_e;var Ve=p(j,F);g(J,O,Ve,F,ee);var St=w(Ve,Z,ee,F);St[Z].name="!Directory",I>0&&de!==q&&(St[de].name="!MiniFAT"),St[ee[0]].name="!FAT",St.fat_addrs=ee,St.ssz=F;var kt={},xr=[],$o=[],zo=[];v(Z,St,Ve,xr,I,kt,$o,de),m($o,zo,xr),xr.shift();var Vo={FileIndex:$o,FullPaths:zo};return R&&R.raw&&(Vo.raw={header:Ee,sectors:Ve}),Vo}function f(j){if(j[j.l]==80&&j[j.l+1]==75)return[0,0];j.chk(z,"Header Signature: "),j.l+=16;var R=j.read_shift(2,"u");return[j.read_shift(2,"u"),R]}function h(j,R){var A=9;switch(j.l+=2,A=j.read_shift(2)){case 9:if(R!=3)throw new Error("Sector Shift: Expected 9 saw "+A);break;case 12:if(R!=4)throw new Error("Sector Shift: Expected 12 saw "+A);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+A)}j.chk("0600","Mini Sector Shift: "),j.chk("000000000000","Reserved: ")}function p(j,R){for(var A=Math.ceil(j.length/R)-1,F=[],I=1;I<A;++I)F[I-1]=j.slice(I*R,(I+1)*R);return F[A-1]=j.slice(A*R),F}function m(j,R,A){for(var F=0,I=0,O=0,Z=0,de=0,J=A.length,ee=[],re=[];F<J;++F)ee[F]=re[F]=F,R[F]=A[F];for(;de<re.length;++de)F=re[de],I=j[F].L,O=j[F].R,Z=j[F].C,ee[F]===F&&(I!==-1&&ee[I]!==I&&(ee[F]=ee[I]),O!==-1&&ee[O]!==O&&(ee[F]=ee[O])),Z!==-1&&(ee[Z]=F),I!==-1&&F!=ee[F]&&(ee[I]=ee[F],re.lastIndexOf(I)<de&&re.push(I)),O!==-1&&F!=ee[F]&&(ee[O]=ee[F],re.lastIndexOf(O)<de&&re.push(O));for(F=1;F<J;++F)ee[F]===F&&(O!==-1&&ee[O]!==O?ee[F]=ee[O]:I!==-1&&ee[I]!==I&&(ee[F]=ee[I]));for(F=1;F<J;++F)if(j[F].type!==0){if(de=F,de!=ee[de])do de=ee[de],R[F]=R[de]+"/"+R[F];while(de!==0&&ee[de]!==-1&&de!=ee[de]);ee[F]=-1}for(R[0]+="/",F=1;F<J;++F)j[F].type!==2&&(R[F]+="/")}function x(j,R,A){for(var F=j.start,I=j.size,O=[],Z=F;A&&I>0&&Z>=0;)O.push(R.slice(Z*W,Z*W+W)),I-=W,Z=Ia(A,Z*4);return O.length===0?oe(0):nr(O).slice(0,j.size)}function g(j,R,A,F,I){var O=q;if(j===q){if(R!==0)throw new Error("DIFAT chain shorter than expected")}else if(j!==-1){var Z=A[j],de=(F>>>2)-1;if(!Z)return;for(var J=0;J<de&&(O=Ia(Z,J*4))!==q;++J)I.push(O);g(Ia(Z,F-4),R-1,A,F,I)}}function y(j,R,A,F,I){var O=[],Z=[];I||(I=[]);var de=F-1,J=0,ee=0;for(J=R;J>=0;){I[J]=!0,O[O.length]=J,Z.push(j[J]);var re=A[Math.floor(J*4/F)];if(ee=J*4&de,F<4+ee)throw new Error("FAT boundary crossed: "+J+" 4 "+F);if(!j[re])break;J=Ia(j[re],ee)}return{nodes:O,data:z1([Z])}}function w(j,R,A,F){var I=j.length,O=[],Z=[],de=[],J=[],ee=F-1,re=0,ye=0,Ee=0,Fe=0;for(re=0;re<I;++re)if(de=[],Ee=re+R,Ee>=I&&(Ee-=I),!Z[Ee]){J=[];var _e=[];for(ye=Ee;ye>=0;){_e[ye]=!0,Z[ye]=!0,de[de.length]=ye,J.push(j[ye]);var Ce=A[Math.floor(ye*4/F)];if(Fe=ye*4&ee,F<4+Fe)throw new Error("FAT boundary crossed: "+ye+" 4 "+F);if(!j[Ce]||(ye=Ia(j[Ce],Fe),_e[ye]))break}O[Ee]={nodes:de,data:z1([J])}}return O}function v(j,R,A,F,I,O,Z,de){for(var J=0,ee=F.length?2:0,re=R[j].data,ye=0,Ee=0,Fe;ye<re.length;ye+=128){var _e=re.slice(ye,ye+128);dr(_e,64),Ee=_e.read_shift(2),Fe=Mx(_e,0,Ee-ee),F.push(Fe);var Ce={name:Fe,type:_e.read_shift(1),color:_e.read_shift(1),L:_e.read_shift(4,"i"),R:_e.read_shift(4,"i"),C:_e.read_shift(4,"i"),clsid:_e.read_shift(16),state:_e.read_shift(4,"i"),start:0,size:0},Ve=_e.read_shift(2)+_e.read_shift(2)+_e.read_shift(2)+_e.read_shift(2);Ve!==0&&(Ce.ct=b(_e,_e.l-8));var St=_e.read_shift(2)+_e.read_shift(2)+_e.read_shift(2)+_e.read_shift(2);St!==0&&(Ce.mt=b(_e,_e.l-8)),Ce.start=_e.read_shift(4,"i"),Ce.size=_e.read_shift(4,"i"),Ce.size<0&&Ce.start<0&&(Ce.size=Ce.type=0,Ce.start=q,Ce.name=""),Ce.type===5?(J=Ce.start,I>0&&J!==q&&(R[J].name="!StreamData")):Ce.size>=4096?(Ce.storage="fat",R[Ce.start]===void 0&&(R[Ce.start]=y(A,Ce.start,R.fat_addrs,R.ssz)),R[Ce.start].name=Ce.name,Ce.content=R[Ce.start].data.slice(0,Ce.size)):(Ce.storage="minifat",Ce.size<0?Ce.size=0:J!==q&&Ce.start!==q&&R[J]&&(Ce.content=x(Ce,R[J].data,(R[de]||{}).data))),Ce.content&&dr(Ce.content,0),O[Fe]=Ce,Z.push(Ce)}}function b(j,R){return new Date((ss(j,R+4)/1e7*Math.pow(2,32)+ss(j,R)/1e7-11644473600)*1e3)}function _(j,R){return u(),d(c.readFileSync(j),R)}function k(j,R){var A=R&&R.type;switch(A||Ke&&Buffer.isBuffer(j)&&(A="buffer"),A||"base64"){case"file":return _(j,R);case"base64":return d(is(fs(j)),R);case"binary":return d(is(j),R)}return d(j,R)}function S(j,R){var A=R||{},F=A.root||"Root Entry";if(j.FullPaths||(j.FullPaths=[]),j.FileIndex||(j.FileIndex=[]),j.FullPaths.length!==j.FileIndex.length)throw new Error("inconsistent CFB structure");j.FullPaths.length===0&&(j.FullPaths[0]=F+"/",j.FileIndex[0]={name:F,type:5}),A.CLSID&&(j.FileIndex[0].clsid=A.CLSID),E(j)}function E(j){var R="Sh33tJ5";if(!De.find(j,"/"+R)){var A=oe(4);A[0]=55,A[1]=A[3]=50,A[2]=54,j.FileIndex.push({name:R,type:2,content:A,size:4,L:69,R:69,C:69}),j.FullPaths.push(j.FullPaths[0]+R),C(j)}}function C(j,R){S(j);for(var A=!1,F=!1,I=j.FullPaths.length-1;I>=0;--I){var O=j.FileIndex[I];switch(O.type){case 0:F?A=!0:(j.FileIndex.pop(),j.FullPaths.pop());break;case 1:case 2:case 5:F=!0,isNaN(O.R*O.L*O.C)&&(A=!0),O.R>-1&&O.L>-1&&O.R==O.L&&(A=!0);break;default:A=!0;break}}if(!(!A&&!R)){var Z=new Date(1987,1,19),de=0,J=Object.create?Object.create(null):{},ee=[];for(I=0;I<j.FullPaths.length;++I)J[j.FullPaths[I]]=!0,j.FileIndex[I].type!==0&&ee.push([j.FullPaths[I],j.FileIndex[I]]);for(I=0;I<ee.length;++I){var re=s(ee[I][0]);F=J[re],F||(ee.push([re,{name:n(re).replace("/",""),type:1,clsid:L,ct:Z,mt:Z,content:null}]),J[re]=!0)}for(ee.sort(function(Fe,_e){return r(Fe[0],_e[0])}),j.FullPaths=[],j.FileIndex=[],I=0;I<ee.length;++I)j.FullPaths[I]=ee[I][0],j.FileIndex[I]=ee[I][1];for(I=0;I<ee.length;++I){var ye=j.FileIndex[I],Ee=j.FullPaths[I];if(ye.name=n(Ee).replace("/",""),ye.L=ye.R=ye.C=-(ye.color=1),ye.size=ye.content?ye.content.length:0,ye.start=0,ye.clsid=ye.clsid||L,I===0)ye.C=ee.length>1?1:-1,ye.size=0,ye.type=5;else if(Ee.slice(-1)=="/"){for(de=I+1;de<ee.length&&s(j.FullPaths[de])!=Ee;++de);for(ye.C=de>=ee.length?-1:de,de=I+1;de<ee.length&&s(j.FullPaths[de])!=s(Ee);++de);ye.R=de>=ee.length?-1:de,ye.type=1}else s(j.FullPaths[I+1]||"")==s(Ee)&&(ye.R=I+1),ye.type=2}}}function U(j,R){var A=R||{};if(A.fileType=="mad")return mg(j,A);switch(C(j),A.fileType){case"zip":return Zr(j,A)}var F=function(Fe){for(var _e=0,Ce=0,Ve=0;Ve<Fe.FileIndex.length;++Ve){var St=Fe.FileIndex[Ve];if(St.content){var kt=St.content.length;kt>0&&(kt<4096?_e+=kt+63>>6:Ce+=kt+511>>9)}}for(var xr=Fe.FullPaths.length+3>>2,$o=_e+7>>3,zo=_e+127>>7,Vo=$o+Ce+xr+zo,Sa=Vo+127>>7,C0=Sa<=109?0:Math.ceil((Sa-109)/127);Vo+Sa+C0+127>>7>Sa;)C0=++Sa<=109?0:Math.ceil((Sa-109)/127);var pn=[1,C0,Sa,zo,xr,Ce,_e,0];return Fe.FileIndex[0].size=_e<<6,pn[7]=(Fe.FileIndex[0].start=pn[0]+pn[1]+pn[2]+pn[3]+pn[4]+pn[5])+(pn[6]+7>>3),pn}(j),I=oe(F[7]<<9),O=0,Z=0;{for(O=0;O<8;++O)I.write_shift(1,Q[O]);for(O=0;O<8;++O)I.write_shift(2,0);for(I.write_shift(2,62),I.write_shift(2,3),I.write_shift(2,65534),I.write_shift(2,9),I.write_shift(2,6),O=0;O<3;++O)I.write_shift(2,0);for(I.write_shift(4,0),I.write_shift(4,F[2]),I.write_shift(4,F[0]+F[1]+F[2]+F[3]-1),I.write_shift(4,0),I.write_shift(4,4096),I.write_shift(4,F[3]?F[0]+F[1]+F[2]-1:q),I.write_shift(4,F[3]),I.write_shift(-4,F[1]?F[0]-1:q),I.write_shift(4,F[1]),O=0;O<109;++O)I.write_shift(-4,O<F[2]?F[1]+O:-1)}if(F[1])for(Z=0;Z<F[1];++Z){for(;O<236+Z*127;++O)I.write_shift(-4,O<F[2]?F[1]+O:-1);I.write_shift(-4,Z===F[1]-1?q:Z+1)}var de=function(Fe){for(Z+=Fe;O<Z-1;++O)I.write_shift(-4,O+1);Fe&&(++O,I.write_shift(-4,q))};for(Z=O=0,Z+=F[1];O<Z;++O)I.write_shift(-4,X.DIFSECT);for(Z+=F[2];O<Z;++O)I.write_shift(-4,X.FATSECT);de(F[3]),de(F[4]);for(var J=0,ee=0,re=j.FileIndex[0];J<j.FileIndex.length;++J)re=j.FileIndex[J],re.content&&(ee=re.content.length,!(ee<4096)&&(re.start=Z,de(ee+511>>9)));for(de(F[6]+7>>3);I.l&511;)I.write_shift(-4,X.ENDOFCHAIN);for(Z=O=0,J=0;J<j.FileIndex.length;++J)re=j.FileIndex[J],re.content&&(ee=re.content.length,!(!ee||ee>=4096)&&(re.start=Z,de(ee+63>>6)));for(;I.l&511;)I.write_shift(-4,X.ENDOFCHAIN);for(O=0;O<F[4]<<2;++O){var ye=j.FullPaths[O];if(!ye||ye.length===0){for(J=0;J<17;++J)I.write_shift(4,0);for(J=0;J<3;++J)I.write_shift(4,-1);for(J=0;J<12;++J)I.write_shift(4,0);continue}re=j.FileIndex[O],O===0&&(re.start=re.size?re.start-1:q);var Ee=O===0&&A.root||re.name;if(ee=2*(Ee.length+1),I.write_shift(64,Ee,"utf16le"),I.write_shift(2,ee),I.write_shift(1,re.type),I.write_shift(1,re.color),I.write_shift(-4,re.L),I.write_shift(-4,re.R),I.write_shift(-4,re.C),re.clsid)I.write_shift(16,re.clsid,"hex");else for(J=0;J<4;++J)I.write_shift(4,0);I.write_shift(4,re.state||0),I.write_shift(4,0),I.write_shift(4,0),I.write_shift(4,0),I.write_shift(4,0),I.write_shift(4,re.start),I.write_shift(4,re.size),I.write_shift(4,0)}for(O=1;O<j.FileIndex.length;++O)if(re=j.FileIndex[O],re.size>=4096)if(I.l=re.start+1<<9,Ke&&Buffer.isBuffer(re.content))re.content.copy(I,I.l,0,re.size),I.l+=re.size+511&-512;else{for(J=0;J<re.size;++J)I.write_shift(1,re.content[J]);for(;J&511;++J)I.write_shift(1,0)}for(O=1;O<j.FileIndex.length;++O)if(re=j.FileIndex[O],re.size>0&&re.size<4096)if(Ke&&Buffer.isBuffer(re.content))re.content.copy(I,I.l,0,re.size),I.l+=re.size+63&-64;else{for(J=0;J<re.size;++J)I.write_shift(1,re.content[J]);for(;J&63;++J)I.write_shift(1,0)}if(Ke)I.l=I.length;else for(;I.l<I.length;)I.write_shift(1,0);return I}function H(j,R){var A=j.FullPaths.map(function(J){return J.toUpperCase()}),F=A.map(function(J){var ee=J.split("/");return ee[ee.length-(J.slice(-1)=="/"?2:1)]}),I=!1;R.charCodeAt(0)===47?(I=!0,R=A[0].slice(0,-1)+R):I=R.indexOf("/")!==-1;var O=R.toUpperCase(),Z=I===!0?A.indexOf(O):F.indexOf(O);if(Z!==-1)return j.FileIndex[Z];var de=!O.match(ol);for(O=O.replace(Mr,""),de&&(O=O.replace(ol,"!")),Z=0;Z<A.length;++Z)if((de?A[Z].replace(ol,"!"):A[Z]).replace(Mr,"")==O||(de?F[Z].replace(ol,"!"):F[Z]).replace(Mr,"")==O)return j.FileIndex[Z];return null}var W=64,q=-2,z="d0cf11e0a1b11ae1",Q=[208,207,17,224,161,177,26,225],L="00000000000000000000000000000000",X={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:q,FREESECT:-1,HEADER_SIGNATURE:z,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:L,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function K(j,R,A){u();var F=U(j,A);c.writeFileSync(R,F)}function V(j){for(var R=new Array(j.length),A=0;A<j.length;++A)R[A]=String.fromCharCode(j[A]);return R.join("")}function fe(j,R){var A=U(j,R);switch(R&&R.type||"buffer"){case"file":return u(),c.writeFileSync(R.filename,A),A;case"binary":return typeof A=="string"?A:V(A);case"base64":return oc(typeof A=="string"?A:V(A));case"buffer":if(Ke)return Buffer.isBuffer(A)?A:Dn(A);case"array":return typeof A=="string"?is(A):A}return A}var ve;function P(j){try{var R=j.InflateRaw,A=new R;if(A._processChunk(new Uint8Array([3,0]),A._finishFlushFlag),A.bytesRead)ve=j;else throw new Error("zlib does not expose bytesRead")}catch(F){console.error("cannot use native zlib: "+(F.message||F))}}function M(j,R){if(!ve)return Fr(j,R);var A=ve.InflateRaw,F=new A,I=F._processChunk(j.slice(j.l),F._finishFlushFlag);return j.l+=F.bytesRead,I}function D(j){return ve?ve.deflateRawSync(j):Re(j)}var B=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Y=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],he=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function xe(j){var R=(j<<1|j<<11)&139536|(j<<5|j<<15)&558144;return(R>>16|R>>8|R)&255}for(var se=typeof Uint8Array<"u",ne=se?new Uint8Array(256):[],be=0;be<256;++be)ne[be]=xe(be);function N(j,R){var A=ne[j&255];return R<=8?A>>>8-R:(A=A<<8|ne[j>>8&255],R<=16?A>>>16-R:(A=A<<8|ne[j>>16&255],A>>>24-R))}function G(j,R){var A=R&7,F=R>>>3;return(j[F]|(A<=6?0:j[F+1]<<8))>>>A&3}function ce(j,R){var A=R&7,F=R>>>3;return(j[F]|(A<=5?0:j[F+1]<<8))>>>A&7}function te(j,R){var A=R&7,F=R>>>3;return(j[F]|(A<=4?0:j[F+1]<<8))>>>A&15}function ue(j,R){var A=R&7,F=R>>>3;return(j[F]|(A<=3?0:j[F+1]<<8))>>>A&31}function ae(j,R){var A=R&7,F=R>>>3;return(j[F]|(A<=1?0:j[F+1]<<8))>>>A&127}function ge(j,R,A){var F=R&7,I=R>>>3,O=(1<<A)-1,Z=j[I]>>>F;return A<8-F||(Z|=j[I+1]<<8-F,A<16-F)||(Z|=j[I+2]<<16-F,A<24-F)||(Z|=j[I+3]<<24-F),Z&O}function le(j,R,A){var F=R&7,I=R>>>3;return F<=5?j[I]|=(A&7)<<F:(j[I]|=A<<F&255,j[I+1]=(A&7)>>8-F),R+3}function je(j,R,A){var F=R&7,I=R>>>3;return A=(A&1)<<F,j[I]|=A,R+1}function Ae(j,R,A){var F=R&7,I=R>>>3;return A<<=F,j[I]|=A&255,A>>>=8,j[I+1]=A,R+8}function Se(j,R,A){var F=R&7,I=R>>>3;return A<<=F,j[I]|=A&255,A>>>=8,j[I+1]=A&255,j[I+2]=A>>>8,R+16}function Le(j,R){var A=j.length,F=2*A>R?2*A:R+5,I=0;if(A>=R)return j;if(Ke){var O=S1(F);if(j.copy)j.copy(O);else for(;I<j.length;++I)O[I]=j[I];return O}else if(se){var Z=new Uint8Array(F);if(Z.set)Z.set(j);else for(;I<A;++I)Z[I]=j[I];return Z}return j.length=F,j}function We(j){for(var R=new Array(j),A=0;A<j;++A)R[A]=0;return R}function rt(j,R,A){var F=1,I=0,O=0,Z=0,de=0,J=j.length,ee=se?new Uint16Array(32):We(32);for(O=0;O<32;++O)ee[O]=0;for(O=J;O<A;++O)j[O]=0;J=j.length;var re=se?new Uint16Array(J):We(J);for(O=0;O<J;++O)ee[I=j[O]]++,F<I&&(F=I),re[O]=0;for(ee[0]=0,O=1;O<=F;++O)ee[O+16]=de=de+ee[O-1]<<1;for(O=0;O<J;++O)de=j[O],de!=0&&(re[O]=ee[de+16]++);var ye=0;for(O=0;O<J;++O)if(ye=j[O],ye!=0)for(de=N(re[O],F)>>F-ye,Z=(1<<F+4-ye)-1;Z>=0;--Z)R[de|Z<<ye]=ye&15|O<<4;return F}var vt=se?new Uint16Array(512):We(512),$r=se?new Uint16Array(32):We(32);if(!se){for(var Lt=0;Lt<512;++Lt)vt[Lt]=0;for(Lt=0;Lt<32;++Lt)$r[Lt]=0}(function(){for(var j=[],R=0;R<32;R++)j.push(5);rt(j,$r,32);var A=[];for(R=0;R<=143;R++)A.push(8);for(;R<=255;R++)A.push(9);for(;R<=279;R++)A.push(7);for(;R<=287;R++)A.push(8);rt(A,vt,288)})();var zr=function(){for(var R=se?new Uint8Array(32768):[],A=0,F=0;A<he.length-1;++A)for(;F<he[A+1];++F)R[F]=A;for(;F<32768;++F)R[F]=29;var I=se?new Uint8Array(259):[];for(A=0,F=0;A<Y.length-1;++A)for(;F<Y[A+1];++F)I[F]=A;function O(de,J){for(var ee=0;ee<de.length;){var re=Math.min(65535,de.length-ee),ye=ee+re==de.length;for(J.write_shift(1,+ye),J.write_shift(2,re),J.write_shift(2,~re&65535);re-- >0;)J[J.l++]=de[ee++]}return J.l}function Z(de,J){for(var ee=0,re=0,ye=se?new Uint16Array(32768):[];re<de.length;){var Ee=Math.min(65535,de.length-re);if(Ee<10){for(ee=le(J,ee,+(re+Ee==de.length)),ee&7&&(ee+=8-(ee&7)),J.l=ee/8|0,J.write_shift(2,Ee),J.write_shift(2,~Ee&65535);Ee-- >0;)J[J.l++]=de[re++];ee=J.l*8;continue}ee=le(J,ee,+(re+Ee==de.length)+2);for(var Fe=0;Ee-- >0;){var _e=de[re];Fe=(Fe<<5^_e)&32767;var Ce=-1,Ve=0;if((Ce=ye[Fe])&&(Ce|=re&-32768,Ce>re&&(Ce-=32768),Ce<re))for(;de[Ce+Ve]==de[re+Ve]&&Ve<250;)++Ve;if(Ve>2){_e=I[Ve],_e<=22?ee=Ae(J,ee,ne[_e+1]>>1)-1:(Ae(J,ee,3),ee+=5,Ae(J,ee,ne[_e-23]>>5),ee+=3);var St=_e<8?0:_e-4>>2;St>0&&(Se(J,ee,Ve-Y[_e]),ee+=St),_e=R[re-Ce],ee=Ae(J,ee,ne[_e]>>3),ee-=3;var kt=_e<4?0:_e-2>>1;kt>0&&(Se(J,ee,re-Ce-he[_e]),ee+=kt);for(var xr=0;xr<Ve;++xr)ye[Fe]=re&32767,Fe=(Fe<<5^de[re])&32767,++re;Ee-=Ve-1}else _e<=143?_e=_e+48:ee=je(J,ee,1),ee=Ae(J,ee,ne[_e]),ye[Fe]=re&32767,++re}ee=Ae(J,ee,0)-1}return J.l=(ee+7)/8|0,J.l}return function(J,ee){return J.length<8?O(J,ee):Z(J,ee)}}();function Re(j){var R=oe(50+Math.floor(j.length*1.1)),A=zr(j,R);return R.slice(0,A)}var st=se?new Uint16Array(32768):We(32768),pr=se?new Uint16Array(32768):We(32768),bt=se?new Uint16Array(128):We(128),ps=1,pe=1;function He(j,R){var A=ue(j,R)+257;R+=5;var F=ue(j,R)+1;R+=5;var I=te(j,R)+4;R+=4;for(var O=0,Z=se?new Uint8Array(19):We(19),de=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],J=1,ee=se?new Uint8Array(8):We(8),re=se?new Uint8Array(8):We(8),ye=Z.length,Ee=0;Ee<I;++Ee)Z[B[Ee]]=O=ce(j,R),J<O&&(J=O),ee[O]++,R+=3;var Fe=0;for(ee[0]=0,Ee=1;Ee<=J;++Ee)re[Ee]=Fe=Fe+ee[Ee-1]<<1;for(Ee=0;Ee<ye;++Ee)(Fe=Z[Ee])!=0&&(de[Ee]=re[Fe]++);var _e=0;for(Ee=0;Ee<ye;++Ee)if(_e=Z[Ee],_e!=0){Fe=ne[de[Ee]]>>8-_e;for(var Ce=(1<<7-_e)-1;Ce>=0;--Ce)bt[Fe|Ce<<_e]=_e&7|Ee<<3}var Ve=[];for(J=1;Ve.length<A+F;)switch(Fe=bt[ae(j,R)],R+=Fe&7,Fe>>>=3){case 16:for(O=3+G(j,R),R+=2,Fe=Ve[Ve.length-1];O-- >0;)Ve.push(Fe);break;case 17:for(O=3+ce(j,R),R+=3;O-- >0;)Ve.push(0);break;case 18:for(O=11+ae(j,R),R+=7;O-- >0;)Ve.push(0);break;default:Ve.push(Fe),J<Fe&&(J=Fe);break}var St=Ve.slice(0,A),kt=Ve.slice(A);for(Ee=A;Ee<286;++Ee)St[Ee]=0;for(Ee=F;Ee<30;++Ee)kt[Ee]=0;return ps=rt(St,st,286),pe=rt(kt,pr,30),R}function _t(j,R){if(j[0]==3&&!(j[1]&3))return[ua(R),2];for(var A=0,F=0,I=S1(R||1<<18),O=0,Z=I.length>>>0,de=0,J=0;!(F&1);){if(F=ce(j,A),A+=3,F>>>1)F>>1==1?(de=9,J=5):(A=He(j,A),de=ps,J=pe);else{A&7&&(A+=8-(A&7));var ee=j[A>>>3]|j[(A>>>3)+1]<<8;if(A+=32,ee>0)for(!R&&Z<O+ee&&(I=Le(I,O+ee),Z=I.length);ee-- >0;)I[O++]=j[A>>>3],A+=8;continue}for(;;){!R&&Z<O+32767&&(I=Le(I,O+32767),Z=I.length);var re=ge(j,A,de),ye=F>>>1==1?vt[re]:st[re];if(A+=ye&15,ye>>>=4,!(ye>>>8&255))I[O++]=ye;else{if(ye==256)break;ye-=257;var Ee=ye<8?0:ye-4>>2;Ee>5&&(Ee=0);var Fe=O+Y[ye];Ee>0&&(Fe+=ge(j,A,Ee),A+=Ee),re=ge(j,A,J),ye=F>>>1==1?$r[re]:pr[re],A+=ye&15,ye>>>=4;var _e=ye<4?0:ye-2>>1,Ce=he[ye];for(_e>0&&(Ce+=ge(j,A,_e),A+=_e),!R&&Z<Fe&&(I=Le(I,Fe+100),Z=I.length);O<Fe;)I[O]=I[O-Ce],++O}}}return R?[I,A+7>>>3]:[I.slice(0,O),A+7>>>3]}function Fr(j,R){var A=j.slice(j.l||0),F=_t(A,R);return j.l+=F[1],F[0]}function Wt(j,R){if(j)typeof console<"u"&&console.error(R);else throw new Error(R)}function xs(j,R){var A=j;dr(A,0);var F=[],I=[],O={FileIndex:F,FullPaths:I};S(O,{root:R.root});for(var Z=A.length-4;(A[Z]!=80||A[Z+1]!=75||A[Z+2]!=5||A[Z+3]!=6)&&Z>=0;)--Z;A.l=Z+4,A.l+=4;var de=A.read_shift(2);A.l+=6;var J=A.read_shift(4);for(A.l=J,Z=0;Z<de;++Z){A.l+=20;var ee=A.read_shift(4),re=A.read_shift(4),ye=A.read_shift(2),Ee=A.read_shift(2),Fe=A.read_shift(2);A.l+=8;var _e=A.read_shift(4),Ce=l(A.slice(A.l+ye,A.l+ye+Ee));A.l+=ye+Ee+Fe;var Ve=A.l;A.l=_e+4,mn(A,ee,re,O,Ce),A.l=Ve}return O}function mn(j,R,A,F,I){j.l+=2;var O=j.read_shift(2),Z=j.read_shift(2),de=i(j);if(O&8257)throw new Error("Unsupported ZIP encryption");for(var J=j.read_shift(4),ee=j.read_shift(4),re=j.read_shift(4),ye=j.read_shift(2),Ee=j.read_shift(2),Fe="",_e=0;_e<ye;++_e)Fe+=String.fromCharCode(j[j.l++]);if(Ee){var Ce=l(j.slice(j.l,j.l+Ee));(Ce[21589]||{}).mt&&(de=Ce[21589].mt),((I||{})[21589]||{}).mt&&(de=I[21589].mt)}j.l+=Ee;var Ve=j.slice(j.l,j.l+ee);switch(Z){case 8:Ve=M(j,re);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Z)}var St=!1;O&8&&(J=j.read_shift(4),J==134695760&&(J=j.read_shift(4),St=!0),ee=j.read_shift(4),re=j.read_shift(4)),ee!=R&&Wt(St,"Bad compressed size: "+R+" != "+ee),re!=A&&Wt(St,"Bad uncompressed size: "+A+" != "+re),zc(F,Fe,Ve,{unsafe:!0,mt:de})}function Zr(j,R){var A=R||{},F=[],I=[],O=oe(1),Z=A.compression?8:0,de=0,J=0,ee=0,re=0,ye=0,Ee=j.FullPaths[0],Fe=Ee,_e=j.FileIndex[0],Ce=[],Ve=0;for(J=1;J<j.FullPaths.length;++J)if(Fe=j.FullPaths[J].slice(Ee.length),_e=j.FileIndex[J],!(!_e.size||!_e.content||Fe=="Sh33tJ5")){var St=re,kt=oe(Fe.length);for(ee=0;ee<Fe.length;++ee)kt.write_shift(1,Fe.charCodeAt(ee)&127);kt=kt.slice(0,kt.l),Ce[ye]=T8.buf(_e.content,0);var xr=_e.content;Z==8&&(xr=D(xr)),O=oe(30),O.write_shift(4,67324752),O.write_shift(2,20),O.write_shift(2,de),O.write_shift(2,Z),_e.mt?a(O,_e.mt):O.write_shift(4,0),O.write_shift(-4,Ce[ye]),O.write_shift(4,xr.length),O.write_shift(4,_e.content.length),O.write_shift(2,kt.length),O.write_shift(2,0),re+=O.length,F.push(O),re+=kt.length,F.push(kt),re+=xr.length,F.push(xr),O=oe(46),O.write_shift(4,33639248),O.write_shift(2,0),O.write_shift(2,20),O.write_shift(2,de),O.write_shift(2,Z),O.write_shift(4,0),O.write_shift(-4,Ce[ye]),O.write_shift(4,xr.length),O.write_shift(4,_e.content.length),O.write_shift(2,kt.length),O.write_shift(2,0),O.write_shift(2,0),O.write_shift(2,0),O.write_shift(2,0),O.write_shift(4,0),O.write_shift(4,St),Ve+=O.l,I.push(O),Ve+=kt.length,I.push(kt),++ye}return O=oe(22),O.write_shift(4,101010256),O.write_shift(2,0),O.write_shift(2,0),O.write_shift(2,ye),O.write_shift(2,ye),O.write_shift(4,Ve),O.write_shift(4,re),O.write_shift(2,0),nr([nr(F),nr(I),O])}var Je={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function vi(j,R){if(j.ctype)return j.ctype;var A=j.name||"",F=A.match(/\.([^\.]+)$/);return F&&Je[F[1]]||R&&(F=(A=R).match(/[\.\\]([^\.\\])+$/),F&&Je[F[1]])?Je[F[1]]:"application/octet-stream"}function N0(j){for(var R=oc(j),A=[],F=0;F<R.length;F+=76)A.push(R.slice(F,F+76));return A.join(`\r
`)+`\r
`}function j0(j){var R=j.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ee){var re=ee.charCodeAt(0).toString(16).toUpperCase();return"="+(re.length==1?"0"+re:re)});R=R.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),R.charAt(0)==`
`&&(R="=0D"+R.slice(1)),R=R.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var A=[],F=R.split(`\r
`),I=0;I<F.length;++I){var O=F[I];if(O.length==0){A.push("");continue}for(var Z=0;Z<O.length;){var de=76,J=O.slice(Z,Z+de);J.charAt(de-1)=="="?de--:J.charAt(de-2)=="="?de-=2:J.charAt(de-3)=="="&&(de-=3),J=O.slice(Z,Z+de),Z+=de,Z<O.length&&(J+="="),A.push(J)}}return A.join(`\r
`)}function $c(j){for(var R=[],A=0;A<j.length;++A){for(var F=j[A];A<=j.length&&F.charAt(F.length-1)=="=";)F=F.slice(0,F.length-1)+j[++A];R.push(F)}for(var I=0;I<R.length;++I)R[I]=R[I].replace(/[=][0-9A-Fa-f]{2}/g,function(O){return String.fromCharCode(parseInt(O.slice(1),16))});return is(R.join(`\r
`))}function E0(j,R,A){for(var F="",I="",O="",Z,de=0;de<10;++de){var J=R[de];if(!J||J.match(/^\s*$/))break;var ee=J.match(/^(.*?):\s*([^\s].*)$/);if(ee)switch(ee[1].toLowerCase()){case"content-location":F=ee[2].trim();break;case"content-type":O=ee[2].trim();break;case"content-transfer-encoding":I=ee[2].trim();break}}switch(++de,I.toLowerCase()){case"base64":Z=is(fs(R.slice(de).join("")));break;case"quoted-printable":Z=$c(R.slice(de));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+I)}var re=zc(j,F.slice(A.length),Z,{unsafe:!0});O&&(re.ctype=O)}function Uo(j,R){if(V(j.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var A=R&&R.root||"",F=(Ke&&Buffer.isBuffer(j)?j.toString("binary"):V(j)).split(`\r
`),I=0,O="";for(I=0;I<F.length;++I)if(O=F[I],!!/^Content-Location:/i.test(O)&&(O=O.slice(O.indexOf("file")),A||(A=O.slice(0,O.lastIndexOf("/")+1)),O.slice(0,A.length)!=A))for(;A.length>0&&(A=A.slice(0,A.length-1),A=A.slice(0,A.lastIndexOf("/")+1),O.slice(0,A.length)!=A););var Z=(F[1]||"").match(/boundary="(.*?)"/);if(!Z)throw new Error("MAD cannot find boundary");var de="--"+(Z[1]||""),J=[],ee=[],re={FileIndex:J,FullPaths:ee};S(re);var ye,Ee=0;for(I=0;I<F.length;++I){var Fe=F[I];Fe!==de&&Fe!==de+"--"||(Ee++&&E0(re,F.slice(ye,I),A),ye=I)}return re}function mg(j,R){var A=R||{},F=A.boundary||"SheetJS";F="------="+F;for(var I=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+F.slice(2)+'"',"","",""],O=j.FullPaths[0],Z=O,de=j.FileIndex[0],J=1;J<j.FullPaths.length;++J)if(Z=j.FullPaths[J].slice(O.length),de=j.FileIndex[J],!(!de.size||!de.content||Z=="Sh33tJ5")){Z=Z.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ve){return"_x"+Ve.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ve){return"_u"+Ve.charCodeAt(0).toString(16)+"_"});for(var ee=de.content,re=Ke&&Buffer.isBuffer(ee)?ee.toString("binary"):V(ee),ye=0,Ee=Math.min(1024,re.length),Fe=0,_e=0;_e<=Ee;++_e)(Fe=re.charCodeAt(_e))>=32&&Fe<128&&++ye;var Ce=ye>=Ee*4/5;I.push(F),I.push("Content-Location: "+(A.root||"file:///C:/SheetJS/")+Z),I.push("Content-Transfer-Encoding: "+(Ce?"quoted-printable":"base64")),I.push("Content-Type: "+vi(de,Z)),I.push(""),I.push(Ce?j0(re):N0(re))}return I.push(F+`--\r
`),I.join(`\r
`)}function pg(j){var R={};return S(R,j),R}function zc(j,R,A,F){var I=F&&F.unsafe;I||S(j);var O=!I&&De.find(j,R);if(!O){var Z=j.FullPaths[0];R.slice(0,Z.length)==Z?Z=R:(Z.slice(-1)!="/"&&(Z+="/"),Z=(Z+R).replace("//","/")),O={name:n(R),type:2},j.FileIndex.push(O),j.FullPaths.push(Z),I||De.utils.cfb_gc(j)}return O.content=A,O.size=A?A.length:0,F&&(F.CLSID&&(O.clsid=F.CLSID),F.mt&&(O.mt=F.mt),F.ct&&(O.ct=F.ct)),O}function xg(j,R){S(j);var A=De.find(j,R);if(A){for(var F=0;F<j.FileIndex.length;++F)if(j.FileIndex[F]==A)return j.FileIndex.splice(F,1),j.FullPaths.splice(F,1),!0}return!1}function T0(j,R,A){S(j);var F=De.find(j,R);if(F){for(var I=0;I<j.FileIndex.length;++I)if(j.FileIndex[I]==F)return j.FileIndex[I].name=n(A),j.FullPaths[I]=A,!0}return!1}function Vc(j){C(j,!0)}return t.find=H,t.read=k,t.parse=d,t.write=fe,t.writeFile=K,t.utils={cfb_new:pg,cfb_add:zc,cfb_del:xg,cfb_mov:T0,cfb_gc:Vc,ReadShift:Nl,CheckField:_N,prep_blob:dr,bconcat:nr,use_zlib:P,_deflateRaw:Re,_inflateRaw:Fr,consts:X},t}();function C8(e){return typeof e=="string"?x0(e):Array.isArray(e)?t8(e):e}function Rc(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=x0(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var s=r=="utf8"?on(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(s,e);if(typeof Blob<"u"){var n=new Blob([C8(s)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(n,e);if(typeof saveAs<"u")return saveAs(n,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var a=URL.createObjectURL(n);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),chrome.downloads.download({url:a,filename:e,saveAs:!0});var i=document.createElement("a");if(i.download!=null)return i.download=e,i.href=a,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),a}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(e);return l.open("w"),l.encoding="binary",Array.isArray(t)&&(t=wa(t)),l.write(t),l.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function A8(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(s){if(!s.message||!s.message.match(/onstruct/))throw s}throw new Error("Cannot access file "+e)}function Dt(e){for(var t=Object.keys(e),r=[],s=0;s<t.length;++s)Object.prototype.hasOwnProperty.call(e,t[s])&&r.push(t[s]);return r}function F1(e,t){for(var r=[],s=Dt(e),n=0;n!==s.length;++n)r[e[s[n]][t]]==null&&(r[e[s[n]][t]]=s[n]);return r}function v0(e){for(var t=[],r=Dt(e),s=0;s!==r.length;++s)t[e[r[s]]]=r[s];return t}function y0(e){for(var t=[],r=Dt(e),s=0;s!==r.length;++s)t[e[r[s]]]=parseInt(r[s],10);return t}function F8(e){for(var t=[],r=Dt(e),s=0;s!==r.length;++s)t[e[r[s]]]==null&&(t[e[r[s]]]=[]),t[e[r[s]]].push(r[s]);return t}var Dd=new Date(1899,11,30,0,0,0);function tr(e,t){var r=e.getTime(),s=Dd.getTime()+(e.getTimezoneOffset()-Dd.getTimezoneOffset())*6e4;return(r-s)/(24*60*60*1e3)}var tN=new Date,P8=Dd.getTime()+(tN.getTimezoneOffset()-Dd.getTimezoneOffset())*6e4,P1=tN.getTimezoneOffset();function w0(e){var t=new Date;return t.setTime(e*24*60*60*1e3+P8),t.getTimezoneOffset()!==P1&&t.setTime(t.getTime()+(t.getTimezoneOffset()-P1)*6e4),t}function R8(e){var t=0,r=0,s=!1,n=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!n)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var a=1;a!=n.length;++a)if(n[a]){switch(r=1,a>3&&(s=!0),n[a].slice(n[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+n[a].slice(n[a].length-1));case"D":r*=24;case"H":r*=60;case"M":if(s)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(n[a],10)}return t}var R1=new Date("2017-02-19T19:06:09.000Z"),rN=isNaN(R1.getFullYear())?new Date("2/19/17"):R1,I8=rN.getFullYear()==2017;function xt(e,t){var r=new Date(e);if(I8)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(rN.getFullYear()==1917&&!isNaN(r.getFullYear())){var s=r.getFullYear();return e.indexOf(""+s)>-1||r.setFullYear(r.getFullYear()+100),r}var n=e.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function ai(e,t){if(Ke&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return on(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return on(Vk(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return on(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return on(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(a){return r[a]||a})}catch{}for(var s=[],n=0;n!=e.length;++n)s.push(String.fromCharCode(e[n]));return s.join("")}function gt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=gt(e[r]));return t}function It(e,t){for(var r="";r.length<t;)r+=e;return r}function Js(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,s=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(s))||(s=s.replace(/[(](.*)[)]/,function(n,a){return r=-r,a}),!isNaN(t=Number(s)))?t/r:t}var O8=["january","february","march","april","may","june","july","august","september","october","november","december"];function So(e){var t=new Date(e),r=new Date(NaN),s=t.getYear(),n=t.getMonth(),a=t.getDate();if(isNaN(a))return r;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&O8.indexOf(i)==-1)return r}else if(i.match(/[a-z]/))return r;return s<0||s>8099?r:(n>0||a>1)&&s!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var D8=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,s,n){if(e||typeof s=="string")return r.split(s);for(var a=r.split(s),i=[a[0]],l=1;l<a.length;++l)i.push(n),i.push(a[l]);return i}}();function sN(e){return e?e.content&&e.type?ai(e.content,!0):e.data?il(e.data):e.asNodeBuffer&&Ke?il(e.asNodeBuffer().toString("binary")):e.asBinary?il(e.asBinary()):e._data&&e._data.getContent?il(ai(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function nN(e){if(!e)return null;if(e.data)return b1(e.data);if(e.asNodeBuffer&&Ke)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?b1(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function L8(e){return e&&e.name.slice(-4)===".bin"?nN(e):sN(e)}function Ss(e,t){for(var r=e.FullPaths||Dt(e.files),s=t.toLowerCase().replace(/[\/]/g,"\\"),n=s.replace(/\\/g,"/"),a=0;a<r.length;++a){var i=r[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(s==i||n==i)return e.files?e.files[r[a]]:e.FileIndex[a]}return null}function Px(e,t){var r=Ss(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function qt(e,t,r){if(!r)return L8(Px(e,t));if(!t)return null;try{return qt(e,t)}catch{return null}}function os(e,t,r){if(!r)return sN(Px(e,t));if(!t)return null;try{return os(e,t)}catch{return null}}function M8(e,t,r){return nN(Px(e,t))}function I1(e){for(var t=e.FullPaths||Dt(e.files),r=[],s=0;s<t.length;++s)t[s].slice(-1)!="/"&&r.push(t[s].replace(/^Root Entry[\/]/,""));return r.sort()}function Ge(e,t,r){if(e.FullPaths){if(typeof r=="string"){var s;return Ke?s=Dn(r):s=r8(r),De.utils.cfb_add(e,t,s)}De.utils.cfb_add(e,t,r)}else e.file(t,r)}function Rx(){return De.utils.cfb_new()}function aN(e,t){switch(t.type){case"base64":return De.read(e,{type:"base64"});case"binary":return De.read(e,{type:"binary"});case"buffer":case"array":return De.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function ll(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var s=e.split("/");s.length!==0;){var n=s.shift();n===".."?r.pop():n!=="."&&r.push(n)}return r.join("/")}var Vt=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,B8=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,O1=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,U8=/<[^>]*>/g,Ar=Vt.match(O1)?O1:U8,$8=/<\w*:/,z8=/<(\/?)\w+:/;function ze(e,t,r){for(var s={},n=0,a=0;n!==e.length&&!((a=e.charCodeAt(n))===32||a===10||a===13);++n);if(t||(s[0]=e.slice(0,n)),n===e.length)return s;var i=e.match(B8),l=0,c="",u=0,d="",f="",h=1;if(i)for(u=0;u!=i.length;++u){for(f=i[u],a=0;a!=f.length&&f.charCodeAt(a)!==61;++a);for(d=f.slice(0,a).trim();f.charCodeAt(a+1)==32;)++a;for(h=(n=f.charCodeAt(a+1))==34||n==39?1:0,c=f.slice(a+1+h,f.length-h),l=0;l!=d.length&&d.charCodeAt(l)!==58;++l);if(l===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),s[d]=c,s[d.toLowerCase()]=c;else{var p=(l===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(l+1);if(s[p]&&d.slice(l-3,l)=="ext")continue;s[p]=c,s[p.toLowerCase()]=c}}return s}function fn(e){return e.replace(z8,"<$1")}var iN={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Ix=v0(iN),Ze=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(s){var n=s+"",a=n.indexOf("<![CDATA[");if(a==-1)return n.replace(e,function(l,c){return iN[l]||String.fromCharCode(parseInt(c,l.indexOf("x")>-1?16:10))||l}).replace(t,function(l,c){return String.fromCharCode(parseInt(c,16))});var i=n.indexOf("]]>");return r(n.slice(0,a))+n.slice(a+9,i)+r(n.slice(i+3))}}(),Ox=/[&<>'"]/g,V8=/[\u0000-\u0008\u000b-\u001f]/g;function ot(e){var t=e+"";return t.replace(Ox,function(r){return Ix[r]}).replace(V8,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function D1(e){return ot(e).replace(/ /g,"_x0020_")}var oN=/[\u0000-\u001f]/g;function Dx(e){var t=e+"";return t.replace(Ox,function(r){return Ix[r]}).replace(/\n/g,"<br/>").replace(oN,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function W8(e){var t=e+"";return t.replace(Ox,function(r){return Ix[r]}).replace(oN,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var L1=function(){var e=/&#(\d+);/g;function t(r,s){return String.fromCharCode(parseInt(s,10))}return function(s){return s.replace(e,t)}}();function H8(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function mt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Rf(e){for(var t="",r=0,s=0,n=0,a=0,i=0,l=0;r<e.length;){if(s=e.charCodeAt(r++),s<128){t+=String.fromCharCode(s);continue}if(n=e.charCodeAt(r++),s>191&&s<224){i=(s&31)<<6,i|=n&63,t+=String.fromCharCode(i);continue}if(a=e.charCodeAt(r++),s<240){t+=String.fromCharCode((s&15)<<12|(n&63)<<6|a&63);continue}i=e.charCodeAt(r++),l=((s&7)<<18|(n&63)<<12|(a&63)<<6|i&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function M1(e){var t=ua(2*e.length),r,s,n=1,a=0,i=0,l;for(s=0;s<e.length;s+=n)n=1,(l=e.charCodeAt(s))<128?r=l:l<224?(r=(l&31)*64+(e.charCodeAt(s+1)&63),n=2):l<240?(r=(l&15)*4096+(e.charCodeAt(s+1)&63)*64+(e.charCodeAt(s+2)&63),n=3):(n=4,r=(l&7)*262144+(e.charCodeAt(s+1)&63)*4096+(e.charCodeAt(s+2)&63)*64+(e.charCodeAt(s+3)&63),r-=65536,i=55296+(r>>>10&1023),r=56320+(r&1023)),i!==0&&(t[a++]=i&255,t[a++]=i>>>8,i=0),t[a++]=r%256,t[a++]=r>>>8;return t.slice(0,a).toString("ucs2")}function B1(e){return Dn(e,"binary").toString("utf8")}var bu="foo bar baz",ct=Ke&&(B1(bu)==Rf(bu)&&B1||M1(bu)==Rf(bu)&&M1)||Rf,on=Ke?function(e){return Dn(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,s=0,n=0;r<e.length;)switch(s=e.charCodeAt(r++),!0){case s<128:t.push(String.fromCharCode(s));break;case s<2048:t.push(String.fromCharCode(192+(s>>6))),t.push(String.fromCharCode(128+(s&63)));break;case(s>=55296&&s<57344):s-=55296,n=e.charCodeAt(r++)-56320+(s<<10),t.push(String.fromCharCode(240+(n>>18&7))),t.push(String.fromCharCode(144+(n>>12&63))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)));break;default:t.push(String.fromCharCode(224+(s>>12))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)))}return t.join("")},cc=function(){var e={};return function(r,s){var n=r+"|"+(s||"");return e[n]?e[n]:e[n]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",s||"")}}(),lN=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var s=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),n=0;n<e.length;++n)s=s.replace(e[n][0],e[n][1]);return s}}(),q8=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),G8=/<\/?(?:vt:)?variant>/g,K8=/<(?:vt:)([^>]*)>([\s\S]*)</;function U1(e,t){var r=ze(e),s=e.match(q8(r.baseType))||[],n=[];if(s.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+s.length+" != "+r.size);return n}return s.forEach(function(a){var i=a.replace(G8,"").match(K8);i&&n.push({v:ct(i[2]),t:i[1]})}),n}var cN=/(^\s|\s$|\n)/;function fr(e,t){return"<"+e+(t.match(cN)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function uc(e){return Dt(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function ke(e,t,r){return"<"+e+(r!=null?uc(r):"")+(t!=null?(t.match(cN)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function _m(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function X8(e,t){switch(typeof e){case"string":var r=ke("vt:lpwstr",ot(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return ke((e|0)==e?"vt:i4":"vt:r8",ot(String(e)));case"boolean":return ke("vt:bool",e?"true":"false")}if(e instanceof Date)return ke("vt:filetime",_m(e));throw new Error("Unable to serialize "+e)}function Lx(e){if(Ke&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return ct(wa(Cx(e)));throw new Error("Bad input format: expected Buffer or string")}var dc=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Zt={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},fi=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],rs={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function Y8(e,t){for(var r=1-2*(e[t+7]>>>7),s=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),n=e[t+6]&15,a=5;a>=0;--a)n=n*256+e[t+a];return s==2047?n==0?r*(1/0):NaN:(s==0?s=-1022:(s-=1023,n+=Math.pow(2,52)),r*Math.pow(2,s-52)*n)}function J8(e,t,r){var s=(t<0||1/t==-1/0?1:0)<<7,n=0,a=0,i=s?-t:t;isFinite(i)?i==0?n=a=0:(n=Math.floor(Math.log(i)/Math.LN2),a=i*Math.pow(2,52-n),n<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?n=-1022:(a-=Math.pow(2,52),n+=1023)):(n=2047,a=isNaN(t)?26985:0);for(var l=0;l<=5;++l,a/=256)e[r+l]=a&255;e[r+6]=(n&15)<<4|a&15,e[r+7]=n>>4|s}var $1=function(e){for(var t=[],r=10240,s=0;s<e[0].length;++s)if(e[0][s])for(var n=0,a=e[0][s].length;n<a;n+=r)t.push.apply(t,e[0][s].slice(n,n+r));return t},z1=Ke?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Dn(t)})):$1(e)}:$1,V1=function(e,t,r){for(var s=[],n=t;n<r;n+=2)s.push(String.fromCharCode(_n(e,n)));return s.join("").replace(Mr,"")},Mx=Ke?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Mr,""):V1(e,t,r)}:V1,W1=function(e,t,r){for(var s=[],n=t;n<t+r;++n)s.push(("0"+e[n].toString(16)).slice(-2));return s.join("")},uN=Ke?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):W1(e,t,r)}:W1,H1=function(e,t,r){for(var s=[],n=t;n<r;n++)s.push(String.fromCharCode(Ai(e,n)));return s.join("")},Ic=Ke?function(t,r,s){return Buffer.isBuffer(t)?t.toString("utf8",r,s):H1(t,r,s)}:H1,dN=function(e,t){var r=ss(e,t);return r>0?Ic(e,t+4,t+4+r-1):""},fN=dN,hN=function(e,t){var r=ss(e,t);return r>0?Ic(e,t+4,t+4+r-1):""},mN=hN,pN=function(e,t){var r=2*ss(e,t);return r>0?Ic(e,t+4,t+4+r-1):""},xN=pN,gN=function(t,r){var s=ss(t,r);return s>0?Mx(t,r+4,r+4+s):""},vN=gN,yN=function(e,t){var r=ss(e,t);return r>0?Ic(e,t+4,t+4+r):""},wN=yN,bN=function(e,t){return Y8(e,t)},Ld=bN,Bx=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Ke&&(fN=function(t,r){if(!Buffer.isBuffer(t))return dN(t,r);var s=t.readUInt32LE(r);return s>0?t.toString("utf8",r+4,r+4+s-1):""},mN=function(t,r){if(!Buffer.isBuffer(t))return hN(t,r);var s=t.readUInt32LE(r);return s>0?t.toString("utf8",r+4,r+4+s-1):""},xN=function(t,r){if(!Buffer.isBuffer(t))return pN(t,r);var s=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+s-1)},vN=function(t,r){if(!Buffer.isBuffer(t))return gN(t,r);var s=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+s)},wN=function(t,r){if(!Buffer.isBuffer(t))return yN(t,r);var s=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+s)},Ld=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):bN(t,r)},Bx=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Ai=function(e,t){return e[t]},_n=function(e,t){return e[t+1]*256+e[t]},Q8=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},ss=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Ia=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},Z8=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Nl(e,t){var r="",s,n,a=[],i,l,c,u;switch(t){case"dbcs":if(u=this.l,Ke&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(_n(this,u)),u+=2;e*=2;break;case"utf8":r=Ic(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Mx(this,this.l,this.l+e);break;case"wstr":return Nl.call(this,e,"dbcs");case"lpstr-ansi":r=fN(this,this.l),e=4+ss(this,this.l);break;case"lpstr-cp":r=mN(this,this.l),e=4+ss(this,this.l);break;case"lpwstr":r=xN(this,this.l),e=4+2*ss(this,this.l);break;case"lpp4":e=4+ss(this,this.l),r=vN(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+ss(this,this.l),r=wN(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(i=Ai(this,this.l+e++))!==0;)a.push(wu(i));r=a.join("");break;case"_wstr":for(e=0,r="";(i=_n(this,this.l+e))!==0;)a.push(wu(i)),e+=2;e+=2,r=a.join("");break;case"dbcs-cont":for(r="",u=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return i=Ai(this,u),this.l=u+1,l=Nl.call(this,e-c,i?"dbcs-cont":"sbcs-cont"),a.join("")+l;a.push(wu(_n(this,u))),u+=2}r=a.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return i=Ai(this,u),this.l=u+1,l=Nl.call(this,e-c,i?"dbcs-cont":"sbcs-cont"),a.join("")+l;a.push(wu(Ai(this,u))),u+=1}r=a.join("");break;default:switch(e){case 1:return s=Ai(this,this.l),this.l++,s;case 2:return s=(t==="i"?Q8:_n)(this,this.l),this.l+=2,s;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(s=(e>0?Ia:Z8)(this,this.l),this.l+=4,s):(n=ss(this,this.l),this.l+=4,n);case 8:case-8:if(t==="f")return e==8?n=Ld(this,this.l):n=Ld([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;e=8;case 16:r=uN(this,this.l,e);break}}return this.l+=e,r}var eI=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},tI=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},rI=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function sI(e,t,r){var s=0,n=0;if(r==="dbcs"){for(n=0;n!=t.length;++n)rI(this,t.charCodeAt(n),this.l+2*n);s=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=t.length;++n)this[this.l+n]=t.charCodeAt(n)&255;s=t.length}else if(r==="hex"){for(;n<e;++n)this[this.l++]=parseInt(t.slice(2*n,2*n+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+e,this.length);for(n=0;n<Math.min(t.length,e);++n){var i=t.charCodeAt(n);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(e){case 1:s=1,this[this.l]=t&255;break;case 2:s=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:s=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:s=4,eI(this,t,this.l);break;case 8:if(s=8,r==="f"){J8(this,t,this.l);break}case 16:break;case-4:s=4,tI(this,t,this.l);break}return this.l+=s,this}function _N(e,t){var r=uN(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function dr(e,t){e.l=t,e.read_shift=Nl,e.chk=_N,e.write_shift=sI}function Cr(e,t){e.l+=t}function oe(e){var t=ua(e);return dr(t,0),t}function Ln(e,t,r){if(e){var s,n,a;dr(e,e.l||0);for(var i=e.length,l=0,c=0;e.l<i;){l=e.read_shift(1),l&128&&(l=(l&127)+((e.read_shift(1)&127)<<7));var u=gc[l]||gc[65535];for(s=e.read_shift(1),a=s&127,n=1;n<4&&s&128;++n)a+=((s=e.read_shift(1))&127)<<7*n;c=e.l+a;var d=u.f&&u.f(e,a,r);if(e.l=c,t(d,u,l))return}}}function Yr(){var e=[],t=Ke?256:2048,r=function(u){var d=oe(u);return dr(d,0),d},s=r(t),n=function(){s&&(s.length>s.l&&(s=s.slice(0,s.l),s.l=s.length),s.length>0&&e.push(s),s=null)},a=function(u){return s&&u<s.length-s.l?s:(n(),s=r(Math.max(u+1,t)))},i=function(){return n(),nr(e)},l=function(u){n(),s=u,s.l==null&&(s.l=s.length),a(t)};return{next:a,push:l,end:i,_bufs:e}}function me(e,t,r,s){var n=+t,a;if(!isNaN(n)){s||(s=gc[n].p||(r||[]).length||0),a=1+(n>=128?1:0)+1,s>=128&&++a,s>=16384&&++a,s>=2097152&&++a;var i=e.next(a);n<=127?i.write_shift(1,n):(i.write_shift(1,(n&127)+128),i.write_shift(1,n>>7));for(var l=0;l!=4;++l)if(s>=128)i.write_shift(1,(s&127)+128),s>>=7;else{i.write_shift(1,s);break}s>0&&Bx(r)&&e.push(r)}}function jl(e,t,r){var s=gt(e);if(t.s?(s.cRel&&(s.c+=t.s.c),s.rRel&&(s.r+=t.s.r)):(s.cRel&&(s.c+=t.c),s.rRel&&(s.r+=t.r)),!r||r.biff<12){for(;s.c>=256;)s.c-=256;for(;s.r>=65536;)s.r-=65536}return s}function q1(e,t,r){var s=gt(e);return s.s=jl(s.s,t.s,r),s.e=jl(s.e,t.s,r),s}function El(e,t){if(e.cRel&&e.c<0)for(e=gt(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=gt(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Ue(e);return!e.cRel&&e.cRel!=null&&(r=iI(r)),!e.rRel&&e.rRel!=null&&(r=nI(r)),r}function If(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Tt(e.s.c)+":"+(e.e.cRel?"":"$")+Tt(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+zt(e.s.r)+":"+(e.e.rRel?"":"$")+zt(e.e.r):El(e.s,t.biff)+":"+El(e.e,t.biff)}function Ux(e){return parseInt(aI(e),10)-1}function zt(e){return""+(e+1)}function nI(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function aI(e){return e.replace(/\$(\d+)$/,"$1")}function $x(e){for(var t=oI(e),r=0,s=0;s!==t.length;++s)r=26*r+t.charCodeAt(s)-64;return r-1}function Tt(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function iI(e){return e.replace(/^([A-Z])/,"$$$1")}function oI(e){return e.replace(/^\$([A-Z])/,"$1")}function lI(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Ct(e){for(var t=0,r=0,s=0;s<e.length;++s){var n=e.charCodeAt(s);n>=48&&n<=57?t=10*t+(n-48):n>=65&&n<=90&&(r=26*r+(n-64))}return{c:r-1,r:t-1}}function Ue(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Jr(e){var t=e.indexOf(":");return t==-1?{s:Ct(e),e:Ct(e)}:{s:Ct(e.slice(0,t)),e:Ct(e.slice(t+1))}}function qe(e,t){return typeof t>"u"||typeof t=="number"?qe(e.s,e.e):(typeof e!="string"&&(e=Ue(e)),typeof t!="string"&&(t=Ue(t)),e==t?e:e+":"+t)}function et(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,s=0,n=0,a=e.length;for(r=0;s<a&&!((n=e.charCodeAt(s)-64)<1||n>26);++s)r=26*r+n;for(t.s.c=--r,r=0;s<a&&!((n=e.charCodeAt(s)-48)<0||n>9);++s)r=10*r+n;if(t.s.r=--r,s===a||n!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++s,r=0;s!=a&&!((n=e.charCodeAt(s)-64)<1||n>26);++s)r=26*r+n;for(t.e.c=--r,r=0;s!=a&&!((n=e.charCodeAt(s)-48)<0||n>9);++s)r=10*r+n;return t.e.r=--r,t}function G1(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Os(e.z,r?tr(t):t)}catch{}try{return e.w=Os((e.XF||{}).numFmtId||(r?14:0),r?tr(t):t)}catch{return""+t}}function In(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Mn[e.v]||e.v:t==null?G1(e,e.v):G1(e,t))}function ba(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",s={};return s[r]=e,{SheetNames:[r],Sheets:s}}function SN(e,t,r){var s=r||{},n=e?Array.isArray(e):s.dense,a=e||(n?[]:{}),i=0,l=0;if(a&&s.origin!=null){if(typeof s.origin=="number")i=s.origin;else{var c=typeof s.origin=="string"?Ct(s.origin):s.origin;i=c.r,l=c.c}a["!ref"]||(a["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var d=et(a["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),i==-1&&(u.e.r=i=d.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[f].length;++h)if(!(typeof t[f][h]>"u")){var p={v:t[f][h]},m=i+f,x=l+h;if(u.s.r>m&&(u.s.r=m),u.s.c>x&&(u.s.c=x),u.e.r<m&&(u.e.r=m),u.e.c<x&&(u.e.c=x),t[f][h]&&typeof t[f][h]=="object"&&!Array.isArray(t[f][h])&&!(t[f][h]instanceof Date))p=t[f][h];else if(Array.isArray(p.v)&&(p.f=t[f][h][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(s.nullError)p.t="e",p.v=0;else if(s.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=s.dateNF||Be[14],s.cellDates?(p.t="d",p.w=Os(p.z,tr(p.v))):(p.t="n",p.v=tr(p.v),p.w=Os(p.z,p.v))):p.t="s";if(n)a[m]||(a[m]=[]),a[m][x]&&a[m][x].z&&(p.z=a[m][x].z),a[m][x]=p;else{var g=Ue({c:x,r:m});a[g]&&a[g].z&&(p.z=a[g].z),a[g]=p}}}return u.s.c<1e7&&(a["!ref"]=qe(u)),a}function Mo(e,t){return SN(null,e,t)}function cI(e){return e.read_shift(4,"i")}function Qs(e,t){return t||(t=oe(4)),t.write_shift(4,e),t}function Er(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function ar(e,t){var r=!1;return t==null&&(r=!0,t=oe(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function uI(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function dI(e,t){return t||(t=oe(4)),t.write_shift(2,0),t.write_shift(2,0),t}function zx(e,t){var r=e.l,s=e.read_shift(1),n=Er(e),a=[],i={t:n,h:n};if(s&1){for(var l=e.read_shift(4),c=0;c!=l;++c)a.push(uI(e));i.r=a}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}function fI(e,t){var r=!1;return t==null&&(r=!0,t=oe(15+4*e.t.length)),t.write_shift(1,0),ar(e.t,t),r?t.slice(0,t.l):t}var hI=zx;function mI(e,t){var r=!1;return t==null&&(r=!0,t=oe(23+4*e.t.length)),t.write_shift(1,1),ar(e.t,t),t.write_shift(4,1),dI({},t),r?t.slice(0,t.l):t}function Ds(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function hi(e,t){return t==null&&(t=oe(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function mi(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function pi(e,t){return t==null&&(t=oe(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var pI=Er,kN=ar;function Vx(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Md(e,t){var r=!1;return t==null&&(r=!0,t=oe(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var xI=Er,Sm=Vx,Wx=Md;function Hx(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,s=t[0]&2;e.l+=4;var n=s===0?Ld([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Ia(t,0)>>2;return r?n/100:n}function NN(e,t){t==null&&(t=oe(4));var r=0,s=0,n=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?s=1:n==(n|0)&&n>=-536870912&&n<1<<29&&(s=1,r=1),s)t.write_shift(-4,((r?n:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function jN(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function gI(e,t){return t||(t=oe(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var xi=jN,Bo=gI;function Nr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function ii(e,t){return(t||oe(8)).write_shift(8,e,"f")}function vI(e){var t={},r=e.read_shift(1),s=r>>>1,n=e.read_shift(1),a=e.read_shift(2,"i"),i=e.read_shift(1),l=e.read_shift(1),c=e.read_shift(1);switch(e.l++,s){case 0:t.auto=1;break;case 1:t.index=n;var u=Ka[n];u&&(t.rgb=hc(u));break;case 2:t.rgb=hc([i,l,c]);break;case 3:t.theme=n;break}return a!=0&&(t.tint=a>0?a/32767:a/32768),t}function Bd(e,t){if(t||(t=oe(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var s=e.rgb||"FFFFFF";typeof s=="number"&&(s=("000000"+s.toString(16)).slice(-6)),t.write_shift(1,parseInt(s.slice(0,2),16)),t.write_shift(1,parseInt(s.slice(2,4),16)),t.write_shift(1,parseInt(s.slice(4,6),16)),t.write_shift(1,255)}return t}function yI(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function wI(e,t){t||(t=oe(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function EN(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},s=e.read_shift(4);switch(s){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(s>400)throw new Error("Unsupported Clipboard: "+s.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function bI(e){return EN(e,1)}function _I(e){return EN(e,2)}var qx=2,Vr=3,_u=11,K1=12,Ud=19,Su=64,SI=65,kI=71,NI=4108,jI=4126,rr=80,TN=81,EI=[rr,TN],km={1:{n:"CodePage",t:qx},2:{n:"Category",t:rr},3:{n:"PresentationFormat",t:rr},4:{n:"ByteCount",t:Vr},5:{n:"LineCount",t:Vr},6:{n:"ParagraphCount",t:Vr},7:{n:"SlideCount",t:Vr},8:{n:"NoteCount",t:Vr},9:{n:"HiddenCount",t:Vr},10:{n:"MultimediaClipCount",t:Vr},11:{n:"ScaleCrop",t:_u},12:{n:"HeadingPairs",t:NI},13:{n:"TitlesOfParts",t:jI},14:{n:"Manager",t:rr},15:{n:"Company",t:rr},16:{n:"LinksUpToDate",t:_u},17:{n:"CharacterCount",t:Vr},19:{n:"SharedDoc",t:_u},22:{n:"HyperlinksChanged",t:_u},23:{n:"AppVersion",t:Vr,p:"version"},24:{n:"DigSig",t:SI},26:{n:"ContentType",t:rr},27:{n:"ContentStatus",t:rr},28:{n:"Language",t:rr},29:{n:"Version",t:rr},255:{},2147483648:{n:"Locale",t:Ud},2147483651:{n:"Behavior",t:Ud},1919054434:{}},Nm={1:{n:"CodePage",t:qx},2:{n:"Title",t:rr},3:{n:"Subject",t:rr},4:{n:"Author",t:rr},5:{n:"Keywords",t:rr},6:{n:"Comments",t:rr},7:{n:"Template",t:rr},8:{n:"LastAuthor",t:rr},9:{n:"RevNumber",t:rr},10:{n:"EditTime",t:Su},11:{n:"LastPrinted",t:Su},12:{n:"CreatedDate",t:Su},13:{n:"ModifiedDate",t:Su},14:{n:"PageCount",t:Vr},15:{n:"WordCount",t:Vr},16:{n:"CharCount",t:Vr},17:{n:"Thumbnail",t:kI},18:{n:"Application",t:rr},19:{n:"DocSecurity",t:Vr},255:{},2147483648:{n:"Locale",t:Ud},2147483651:{n:"Behavior",t:Ud},1919054434:{}},X1={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},TI=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function CI(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var AI=CI([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Ka=gt(AI),Mn={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},CN={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},jm={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},ku={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Gx(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function FI(e){var t=Gx();if(!e||!e.match)return t;var r={};if((e.match(Ar)||[]).forEach(function(s){var n=ze(s);switch(n[0].replace($8,"<")){case"<?xml":break;case"<Types":t.xmlns=n["xmlns"+(n[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[n.Extension]=n.ContentType;break;case"<Override":t[jm[n.ContentType]]!==void 0&&t[jm[n.ContentType]].push(n.PartName);break}}),t.xmlns!==Zt.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function AN(e,t){var r=F8(jm),s=[],n;s[s.length]=Vt,s[s.length]=ke("Types",null,{xmlns:Zt.CT,"xmlns:xsd":Zt.xsd,"xmlns:xsi":Zt.xsi}),s=s.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return ke("Default",null,{Extension:c[0],ContentType:c[1]})}));var a=function(c){e[c]&&e[c].length>0&&(n=e[c][0],s[s.length]=ke("Override",null,{PartName:(n[0]=="/"?"":"/")+n,ContentType:ku[c][t.bookType]||ku[c].xlsx}))},i=function(c){(e[c]||[]).forEach(function(u){s[s.length]=ke("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:ku[c][t.bookType]||ku[c].xlsx})})},l=function(c){(e[c]||[]).forEach(function(u){s[s.length]=ke("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[c][0]})})};return a("workbooks"),i("sheets"),i("charts"),l("themes"),["strs","styles"].forEach(a),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),i("metadata"),l("people"),s.length>2&&(s[s.length]="</Types>",s[1]=s[1].replace("/>",">")),s.join("")}var Xe={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function fc(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Tl(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var s={};return(e.match(Ar)||[]).forEach(function(n){var a=ze(n);if(a[0]==="<Relationship"){var i={};i.Type=a.Type,i.Target=a.Target,i.Id=a.Id,a.TargetMode&&(i.TargetMode=a.TargetMode);var l=a.TargetMode==="External"?a.Target:ll(a.Target,t);r[l]=i,s[a.Id]=i}}),r["!id"]=s,r}function ao(e){var t=[Vt,ke("Relationships",null,{xmlns:Zt.RELS})];return Dt(e["!id"]).forEach(function(r){t[t.length]=ke("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function at(e,t,r,s,n,a){if(n||(n={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,n.Id="rId"+t,n.Type=s,n.Target=r,[Xe.HLINK,Xe.XPATH,Xe.XMISS].indexOf(n.Type)>-1&&(n.TargetMode="External"),e["!id"][n.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][n.Id]=n,e[("/"+n.Target).replace("//","/")]=n,t}var PI="application/vnd.oasis.opendocument.spreadsheet";function RI(e,t){for(var r=Lx(e),s,n;s=dc.exec(r);)switch(s[3]){case"manifest":break;case"file-entry":if(n=ze(s[0],!1),n.path=="/"&&n.type!==PI)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw s}}function II(e){var t=[Vt];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function Y1(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function OI(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function DI(e){var t=[Vt];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(Y1(e[r][0],e[r][1])),t.push(OI("",e[r][0]));return t.push(Y1("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function FN(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Pd.version+"</meta:generator></office:meta></office:document-meta>"}var Ps=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],LI=function(){for(var e=new Array(Ps.length),t=0;t<Ps.length;++t){var r=Ps[t],s="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+s+"[^>]*>([\\s\\S]*?)</"+s+">")}return e}();function PN(e){var t={};e=ct(e);for(var r=0;r<Ps.length;++r){var s=Ps[r],n=e.match(LI[r]);n!=null&&n.length>0&&(t[s[1]]=Ze(n[1])),s[2]==="date"&&t[s[1]]&&(t[s[1]]=xt(t[s[1]]))}return t}function Of(e,t,r,s,n){n[e]!=null||t==null||t===""||(n[e]=t,t=ot(t),s[s.length]=r?ke(e,t,r):fr(e,t))}function RN(e,t){var r=t||{},s=[Vt,ke("cp:coreProperties",null,{"xmlns:cp":Zt.CORE_PROPS,"xmlns:dc":Zt.dc,"xmlns:dcterms":Zt.dcterms,"xmlns:dcmitype":Zt.dcmitype,"xmlns:xsi":Zt.xsi})],n={};if(!e&&!r.Props)return s.join("");e&&(e.CreatedDate!=null&&Of("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:_m(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},s,n),e.ModifiedDate!=null&&Of("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:_m(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},s,n));for(var a=0;a!=Ps.length;++a){var i=Ps[a],l=r.Props&&r.Props[i[1]]!=null?r.Props[i[1]]:e?e[i[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&Of(i[0],l,null,s,n)}return s.length>2&&(s[s.length]="</cp:coreProperties>",s[1]=s[1].replace("/>",">")),s.join("")}var Xa=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],IN=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function ON(e,t,r,s){var n=[];if(typeof e=="string")n=U1(e,s);else for(var a=0;a<e.length;++a)n=n.concat(e[a].map(function(d){return{v:d}}));var i=typeof t=="string"?U1(t,s).map(function(d){return d.v}):t,l=0,c=0;if(i.length>0)for(var u=0;u!==n.length;u+=2){switch(c=+n[u+1].v,n[u].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=i.slice(l,l+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=c,r.DefinedNames=i.slice(l,l+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=i.slice(l,l+c);break}l+=c}}function MI(e,t,r){var s={};return t||(t={}),e=ct(e),Xa.forEach(function(n){var a=(e.match(cc(n[0]))||[])[1];switch(n[2]){case"string":a&&(t[n[1]]=Ze(a));break;case"bool":t[n[1]]=a==="true";break;case"raw":var i=e.match(new RegExp("<"+n[0]+"[^>]*>([\\s\\S]*?)</"+n[0]+">"));i&&i.length>0&&(s[n[1]]=i[1]);break}}),s.HeadingPairs&&s.TitlesOfParts&&ON(s.HeadingPairs,s.TitlesOfParts,t,r),t}function DN(e){var t=[],r=ke;return e||(e={}),e.Application="SheetJS",t[t.length]=Vt,t[t.length]=ke("Properties",null,{xmlns:Zt.EXT_PROPS,"xmlns:vt":Zt.vt}),Xa.forEach(function(s){if(e[s[1]]!==void 0){var n;switch(s[2]){case"string":n=ot(String(e[s[1]]));break;case"bool":n=e[s[1]]?"true":"false";break}n!==void 0&&(t[t.length]=r(s[0],n))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(s){return"<vt:lpstr>"+ot(s)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var BI=/<[^>]+>[^<]*/g;function UI(e,t){var r={},s="",n=e.match(BI);if(n)for(var a=0;a!=n.length;++a){var i=n[a],l=ze(i);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":s=Ze(l.name);break;case"</property>":s=null;break;default:if(i.indexOf("<vt:")===0){var c=i.split(">"),u=c[0].slice(4),d=c[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[s]=Ze(d);break;case"bool":r[s]=mt(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[s]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[s]=parseFloat(d);break;case"filetime":case"date":r[s]=xt(d);break;case"cy":case"error":r[s]=Ze(d);break;default:if(u.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",i,u,c)}}else if(i.slice(0,2)!=="</"){if(t.WTF)throw new Error(i)}}}return r}function LN(e){var t=[Vt,ke("Properties",null,{xmlns:Zt.CUST_PROPS,"xmlns:vt":Zt.vt})];if(!e)return t.join("");var r=1;return Dt(e).forEach(function(n){++r,t[t.length]=ke("property",X8(e[n]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:ot(n)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Em={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Df;function $I(e,t,r){Df||(Df=v0(Em)),t=Df[t]||t,e[t]=r}function zI(e,t){var r=[];return Dt(Em).map(function(s){for(var n=0;n<Ps.length;++n)if(Ps[n][1]==s)return Ps[n];for(n=0;n<Xa.length;++n)if(Xa[n][1]==s)return Xa[n];throw s}).forEach(function(s){if(e[s[1]]!=null){var n=t&&t.Props&&t.Props[s[1]]!=null?t.Props[s[1]]:e[s[1]];switch(s[2]){case"date":n=new Date(n).toISOString().replace(/\.\d*Z/,"Z");break}typeof n=="number"?n=String(n):n===!0||n===!1?n=n?"1":"0":n instanceof Date&&(n=new Date(n).toISOString().replace(/\.\d*Z/,"")),r.push(fr(Em[s[1]]||s[1],n))}}),ke("DocumentProperties",r.join(""),{xmlns:rs.o})}function VI(e,t){var r=["Worksheets","SheetNames"],s="CustomDocumentProperties",n=[];return e&&Dt(e).forEach(function(a){if(Object.prototype.hasOwnProperty.call(e,a)){for(var i=0;i<Ps.length;++i)if(a==Ps[i][1])return;for(i=0;i<Xa.length;++i)if(a==Xa[i][1])return;for(i=0;i<r.length;++i)if(a==r[i])return;var l=e[a],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l=String(l),n.push(ke(D1(a),l,{"dt:dt":c}))}}),t&&Dt(t).forEach(function(a){if(Object.prototype.hasOwnProperty.call(t,a)&&!(e&&Object.prototype.hasOwnProperty.call(e,a))){var i=t[a],l="string";typeof i=="number"?(l="float",i=String(i)):i===!0||i===!1?(l="boolean",i=i?"1":"0"):i instanceof Date?(l="dateTime.tz",i=i.toISOString()):i=String(i),n.push(ke(D1(a),i,{"dt:dt":l}))}}),"<"+s+' xmlns="'+rs.o+'">'+n.join("")+"</"+s+">"}function Kx(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function WI(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,s=r%Math.pow(2,32),n=(r-s)/Math.pow(2,32);s*=1e7,n*=1e7;var a=s/Math.pow(2,32)|0;a>0&&(s=s%Math.pow(2,32),n+=a);var i=oe(8);return i.write_shift(4,s),i.write_shift(4,n),i}function MN(e,t,r){var s=e.l,n=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-s&3;)++e.l;return n}function BN(e,t,r){var s=e.read_shift(0,"lpwstr");return s}function UN(e,t,r){return t===31?BN(e):MN(e,t,r)}function Tm(e,t,r){return UN(e,t,r===!1?0:4)}function HI(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return UN(e,t,0)}function qI(e){for(var t=e.read_shift(4),r=[],s=0;s!=t;++s){var n=e.l;r[s]=e.read_shift(0,"lpwstr").replace(Mr,""),e.l-n&2&&(e.l+=2)}return r}function GI(e){for(var t=e.read_shift(4),r=[],s=0;s!=t;++s)r[s]=e.read_shift(0,"lpstr-cp").replace(Mr,"");return r}function KI(e){var t=e.l,r=$d(e,TN);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var s=$d(e,Vr);return[r,s]}function XI(e){for(var t=e.read_shift(4),r=[],s=0;s<t/2;++s)r.push(KI(e));return r}function J1(e,t){for(var r=e.read_shift(4),s={},n=0;n!=r;++n){var a=e.read_shift(4),i=e.read_shift(4);s[a]=e.read_shift(i,t===1200?"utf16le":"utf8").replace(Mr,"").replace(ol,"!"),t===1200&&i%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),s}function $N(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function YI(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function $d(e,t,r){var s=e.read_shift(2),n,a=r||{};if(e.l+=2,t!==K1&&s!==t&&EI.indexOf(t)===-1&&!((t&65534)==4126&&(s&65534)==4126))throw new Error("Expected type "+t+" saw "+s);switch(t===K1?s:t){case 2:return n=e.read_shift(2,"i"),a.raw||(e.l+=2),n;case 3:return n=e.read_shift(4,"i"),n;case 11:return e.read_shift(4)!==0;case 19:return n=e.read_shift(4),n;case 30:return MN(e,s,4).replace(Mr,"");case 31:return BN(e);case 64:return Kx(e);case 65:return $N(e);case 71:return YI(e);case 80:return Tm(e,s,!a.raw).replace(Mr,"");case 81:return HI(e,s).replace(Mr,"");case 4108:return XI(e);case 4126:case 4127:return s==4127?qI(e):GI(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+s)}}function Q1(e,t){var r=oe(4),s=oe(4);switch(r.write_shift(4,e==80?31:e),e){case 3:s.write_shift(-4,t);break;case 5:s=oe(8),s.write_shift(8,t,"f");break;case 11:s.write_shift(4,t?1:0);break;case 64:s=WI(t);break;case 31:case 80:for(s=oe(4+2*(t.length+1)+(t.length%2?0:2)),s.write_shift(4,t.length+1),s.write_shift(0,t,"dbcs");s.l!=s.length;)s.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return nr([r,s])}function Z1(e,t){var r=e.l,s=e.read_shift(4),n=e.read_shift(4),a=[],i=0,l=0,c=-1,u={};for(i=0;i!=n;++i){var d=e.read_shift(4),f=e.read_shift(4);a[i]=[d,f+r]}a.sort(function(w,v){return w[1]-v[1]});var h={};for(i=0;i!=n;++i){if(e.l!==a[i][1]){var p=!0;if(i>0&&t)switch(t[a[i-1][0]].t){case 2:e.l+2===a[i][1]&&(e.l+=2,p=!1);break;case 80:e.l<=a[i][1]&&(e.l=a[i][1],p=!1);break;case 4108:e.l<=a[i][1]&&(e.l=a[i][1],p=!1);break}if((!t||i==0)&&e.l<=a[i][1]&&(p=!1,e.l=a[i][1]),p)throw new Error("Read Error: Expected address "+a[i][1]+" at "+e.l+" :"+i)}if(t){var m=t[a[i][0]];if(h[m.n]=$d(e,m.t,{raw:!0}),m.p==="version"&&(h[m.n]=String(h[m.n]>>16)+"."+("0000"+String(h[m.n]&65535)).slice(-4)),m.n=="CodePage")switch(h[m.n]){case 0:h[m.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Gs(l=h[m.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[m.n])}}else if(a[i][0]===1){if(l=h.CodePage=$d(e,qx),Gs(l),c!==-1){var x=e.l;e.l=a[c][1],u=J1(e,l),e.l=x}}else if(a[i][0]===0){if(l===0){c=i,e.l=a[i+1][1];continue}u=J1(e,l)}else{var g=u[a[i][0]],y;switch(e[e.l]){case 65:e.l+=4,y=$N(e);break;case 30:e.l+=4,y=Tm(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,y=Tm(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,y=e.read_shift(4,"i");break;case 19:e.l+=4,y=e.read_shift(4);break;case 5:e.l+=4,y=e.read_shift(8,"f");break;case 11:e.l+=4,y=Mt(e,4);break;case 64:e.l+=4,y=xt(Kx(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[g]=y}}return e.l=r+s,h}var zN=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function JI(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function ew(e,t,r){var s=oe(8),n=[],a=[],i=8,l=0,c=oe(8),u=oe(8);if(c.write_shift(4,2),c.write_shift(4,1200),u.write_shift(4,1),a.push(c),n.push(u),i+=8+c.length,!t){u=oe(8),u.write_shift(4,0),n.unshift(u);var d=[oe(4)];for(d[0].write_shift(4,e.length),l=0;l<e.length;++l){var f=e[l][0];for(c=oe(8+2*(f.length+1)+(f.length%2?0:2)),c.write_shift(4,l+2),c.write_shift(4,f.length+1),c.write_shift(0,f,"dbcs");c.l!=c.length;)c.write_shift(1,0);d.push(c)}c=nr(d),a.unshift(c),i+=8+c.length}for(l=0;l<e.length;++l)if(!(t&&!t[e[l][0]])&&!(zN.indexOf(e[l][0])>-1||IN.indexOf(e[l][0])>-1)&&e[l][1]!=null){var h=e[l][1],p=0;if(t){p=+t[e[l][0]];var m=r[p];if(m.p=="version"&&typeof h=="string"){var x=h.split(".");h=(+x[0]<<16)+(+x[1]||0)}c=Q1(m.t,h)}else{var g=JI(h);g==-1&&(g=31,h=String(h)),c=Q1(g,h)}a.push(c),u=oe(8),u.write_shift(4,t?p:2+l),n.push(u),i+=8+c.length}var y=8*(a.length+1);for(l=0;l<a.length;++l)n[l].write_shift(4,y),y+=a[l].length;return s.write_shift(4,i),s.write_shift(4,a.length),nr([s].concat(n).concat(a))}function tw(e,t,r){var s=e.content;if(!s)return{};dr(s,0);var n,a,i,l,c=0;s.chk("feff","Byte Order: "),s.read_shift(2);var u=s.read_shift(4),d=s.read_shift(16);if(d!==De.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(n=s.read_shift(4),n!==1&&n!==2)throw new Error("Unrecognized #Sets: "+n);if(a=s.read_shift(16),l=s.read_shift(4),n===1&&l!==s.l)throw new Error("Length mismatch: "+l+" !== "+s.l);n===2&&(i=s.read_shift(16),c=s.read_shift(4));var f=Z1(s,t),h={SystemIdentifier:u};for(var p in f)h[p]=f[p];if(h.FMTID=a,n===1)return h;if(c-s.l==2&&(s.l+=2),s.l!==c)throw new Error("Length mismatch 2: "+s.l+" !== "+c);var m;try{m=Z1(s,null)}catch{}for(p in m)h[p]=m[p];return h.FMTID=[a,i],h}function rw(e,t,r,s,n,a){var i=oe(n?68:48),l=[i];i.write_shift(2,65534),i.write_shift(2,0),i.write_shift(4,842412599),i.write_shift(16,De.utils.consts.HEADER_CLSID,"hex"),i.write_shift(4,n?2:1),i.write_shift(16,t,"hex"),i.write_shift(4,n?68:48);var c=ew(e,r,s);if(l.push(c),n){var u=ew(n,null,null);i.write_shift(16,a,"hex"),i.write_shift(4,68+c.length),l.push(u)}return nr(l)}function $n(e,t){return e.read_shift(t),null}function QI(e,t){t||(t=oe(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function ZI(e,t,r){for(var s=[],n=e.l+t;e.l<n;)s.push(r(e,n-e.l));if(n!==e.l)throw new Error("Slurp error");return s}function Mt(e,t){return e.read_shift(t)===1}function Ir(e,t){return t||(t=oe(2)),t.write_shift(2,+!!e),t}function Gt(e){return e.read_shift(2,"u")}function ks(e,t){return t||(t=oe(2)),t.write_shift(2,e),t}function VN(e,t){return ZI(e,t,Gt)}function eO(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function WN(e,t,r){return r||(r=oe(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function Oc(e,t,r){var s=e.read_shift(r&&r.biff>=12?2:1),n="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=e.read_shift(1);a&&(n="dbcs-cont")}else r.biff==12&&(n="wstr");r.biff>=2&&r.biff<=5&&(n="cpstr");var i=s?e.read_shift(s,n):"";return i}function tO(e){var t=e.read_shift(2),r=e.read_shift(1),s=r&4,n=r&8,a=1+(r&1),i=0,l,c={};n&&(i=e.read_shift(2)),s&&(l=e.read_shift(4));var u=a==2?"dbcs-cont":"sbcs-cont",d=t===0?"":e.read_shift(t,u);return n&&(e.l+=4*i),s&&(e.l+=l),c.t=d,n||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function rO(e){var t=e.t||"",r=oe(3);r.write_shift(2,t.length),r.write_shift(1,1);var s=oe(2*t.length);s.write_shift(2*t.length,t,"utf16le");var n=[r,s];return nr(n)}function oi(e,t,r){var s;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var n=e.read_shift(1);return n===0?s=e.read_shift(t,"sbcs-cont"):s=e.read_shift(t,"dbcs-cont"),s}function Dc(e,t,r){var s=e.read_shift(r&&r.biff==2?1:2);return s===0?(e.l++,""):oi(e,s,r)}function gi(e,t,r){if(r.biff>5)return Dc(e,t,r);var s=e.read_shift(1);return s===0?(e.l++,""):e.read_shift(s,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function HN(e,t,r){return r||(r=oe(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function sO(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function nO(e){var t=e.read_shift(4),r=e.l,s=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(s=!0),e.l=r);var n=e.read_shift((s?t-24:t)>>1,"utf16le").replace(Mr,"");return s&&(e.l+=24),n}function aO(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var s=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var n=e.read_shift(4);if(n===0)return r+s.replace(/\\/g,"/");var a=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=e.read_shift(a>>1,"utf16le").replace(Mr,"");return r+i}function iO(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return nO(e);case"0303000000000000c000000000000046":return aO(e);default:throw new Error("Unsupported Moniker "+r)}}function Nu(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Mr,""):"";return r}function sw(e,t){t||(t=oe(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function oO(e,t){var r=e.l+t,s=e.read_shift(4);if(s!==2)throw new Error("Unrecognized streamVersion: "+s);var n=e.read_shift(2);e.l+=2;var a,i,l,c,u="",d,f;n&16&&(a=Nu(e,r-e.l)),n&128&&(i=Nu(e,r-e.l)),(n&257)===257&&(l=Nu(e,r-e.l)),(n&257)===1&&(c=iO(e,r-e.l)),n&8&&(u=Nu(e,r-e.l)),n&32&&(d=e.read_shift(16)),n&64&&(f=Kx(e)),e.l=r;var h=i||l||c||"";h&&u&&(h+="#"+u),h||(h="#"+u),n&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var p={Target:h};return d&&(p.guid=d),f&&(p.time=f),a&&(p.Tooltip=a),p}function lO(e){var t=oe(512),r=0,s=e.Target;s.slice(0,7)=="file://"&&(s=s.slice(7));var n=s.indexOf("#"),a=n>-1?31:23;switch(s.charAt(0)){case"#":a=28;break;case".":a&=-3;break}t.write_shift(4,2),t.write_shift(4,a);var i=[8,6815827,6619237,4849780,83];for(r=0;r<i.length;++r)t.write_shift(4,i[r]);if(a==28)s=s.slice(1),sw(s,t);else if(a&2){for(i="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));var l=n>-1?s.slice(0,n):s;for(t.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)t.write_shift(2,l.charCodeAt(r));t.write_shift(2,0),a&8&&sw(n>-1?s.slice(n+1):"",t)}else{for(i="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));for(var c=0;s.slice(c*3,c*3+3)=="../"||s.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,s.length-3*c+1),r=0;r<s.length-3*c;++r)t.write_shift(1,s.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function qN(e){var t=e.read_shift(1),r=e.read_shift(1),s=e.read_shift(1),n=e.read_shift(1);return[t,r,s,n]}function GN(e,t){var r=qN(e);return r[3]=0,r}function hn(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2);return{r:t,c:r,ixfe:s}}function li(e,t,r,s){return s||(s=oe(6)),s.write_shift(2,e),s.write_shift(2,t),s.write_shift(2,r||0),s}function cO(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function uO(e,t,r){return t===0?"":gi(e,t,r)}function dO(e,t,r){var s=r.biff>8?4:2,n=e.read_shift(s),a=e.read_shift(s,"i"),i=e.read_shift(s,"i");return[n,a,i]}function KN(e){var t=e.read_shift(2),r=Hx(e);return[t,r]}function fO(e,t,r){e.l+=4,t-=4;var s=e.l+t,n=Oc(e,t,r),a=e.read_shift(2);if(s-=e.l,a!==s)throw new Error("Malformed AddinUdf: padding = "+s+" != "+a);return e.l+=a,n}function b0(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2),n=e.read_shift(2);return{s:{c:s,r:t},e:{c:n,r}}}function XN(e,t){return t||(t=oe(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function YN(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(1),n=e.read_shift(1);return{s:{c:s,r:t},e:{c:n,r}}}var hO=YN;function JN(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2);return e.l+=12,[r,t,s]}function mO(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function pO(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function yr(e){e.l+=2,e.l+=e.read_shift(2)}var xO={0:yr,4:yr,5:yr,6:yr,7:pO,8:yr,9:yr,10:yr,11:yr,12:yr,13:mO,14:yr,15:yr,16:yr,17:yr,18:yr,19:yr,20:yr,21:JN};function gO(e,t){for(var r=e.l+t,s=[];e.l<r;){var n=e.read_shift(2);e.l-=2;try{s.push(xO[n](e,r-e.l))}catch{return e.l=r,s}}return e.l!=r&&(e.l=r),s}function ju(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function Xx(e,t,r){var s=1536,n=16;switch(r.bookType){case"biff8":break;case"biff5":s=1280,n=8;break;case"biff4":s=4,n=6;break;case"biff3":s=3,n=6;break;case"biff2":s=2,n=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var a=oe(n);return a.write_shift(2,s),a.write_shift(2,t),n>4&&a.write_shift(2,29282),n>6&&a.write_shift(2,1997),n>8&&(a.write_shift(2,49161),a.write_shift(2,1),a.write_shift(2,1798),a.write_shift(2,0)),a}function vO(e,t){return t===0||e.read_shift(2),1200}function yO(e,t,r){if(r.enc)return e.l+=t,"";var s=e.l,n=gi(e,0,r);return e.read_shift(t+s-e.l),n}function wO(e,t){var r=!t||t.biff==8,s=oe(r?112:54);for(s.write_shift(t.biff==8?2:1,7),r&&s.write_shift(1,0),s.write_shift(4,859007059),s.write_shift(4,5458548|(r?0:536870912));s.l<s.length;)s.write_shift(1,r?0:32);return s}function bO(e,t,r){var s=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:s&16,fBelow:s&64,fRight:s&128}}function _O(e,t,r){var s=e.read_shift(4),n=e.read_shift(1)&3,a=e.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var i=Oc(e,0,r);return i.length===0&&(i="Sheet1"),{pos:s,hs:n,dt:a,name:i}}function SO(e,t){var r=!t||t.biff>=8?2:1,s=oe(8+r*e.name.length);s.write_shift(4,e.pos),s.write_shift(1,e.hs||0),s.write_shift(1,e.dt),s.write_shift(1,e.name.length),t.biff>=8&&s.write_shift(1,1),s.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var n=s.slice(0,s.l);return n.l=s.l,n}function kO(e,t){for(var r=e.l+t,s=e.read_shift(4),n=e.read_shift(4),a=[],i=0;i!=n&&e.l<r;++i)a.push(tO(e));return a.Count=s,a.Unique=n,a}function NO(e,t){var r=oe(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var s=[],n=0;n<e.length;++n)s[n]=rO(e[n]);var a=nr([r].concat(s));return a.parts=[r.length].concat(s.map(function(i){return i.length})),a}function jO(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function EO(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var s=e.read_shift(1);return e.l+=3,s&7&&(t.level=s&7),s&32&&(t.hidden=!0),s&64&&(t.hpt=r/20),t}function TO(e){var t=cO(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function CO(e){return e.read_shift(2),e.read_shift(4)}function nw(e,t,r){var s=0;r&&r.biff==2||(s=e.read_shift(2));var n=e.read_shift(2);r&&r.biff==2&&(s=1-(n>>15),n&=32767);var a={Unsynced:s&1,DyZero:(s&2)>>1,ExAsc:(s&4)>>2,ExDsc:(s&8)>>3};return[a,n]}function AO(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),u=e.read_shift(2);return{Pos:[t,r],Dim:[s,n],Flags:a,CurTab:i,FirstTab:l,Selected:c,TabRatio:u}}function FO(){var e=oe(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function PO(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var s=e.read_shift(2);return{RTL:s&64}}function RO(e){var t=oe(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function IO(){}function OO(e,t,r){var s={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return s.name=Oc(e,0,r),s}function DO(e,t){var r=e.name||"Arial",s=t&&t.biff==5,n=s?15+r.length:16+2*r.length,a=oe(n);return a.write_shift(2,e.sz*20),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,r.length),s||a.write_shift(1,1),a.write_shift((s?1:2)*r.length,r,s?"sbcs":"utf16le"),a}function LO(e){var t=hn(e);return t.isst=e.read_shift(4),t}function MO(e,t,r,s){var n=oe(10);return li(e,t,s,n),n.write_shift(4,r),n}function BO(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var s=e.l+t,n=hn(e);r.biff==2&&e.l++;var a=Dc(e,s-e.l,r);return n.val=a,n}function UO(e,t,r,s,n){var a=!n||n.biff==8,i=oe(8+ +a+(1+a)*r.length);return li(e,t,s,i),i.write_shift(2,r.length),a&&i.write_shift(1,1),i.write_shift((1+a)*r.length,r,a?"utf16le":"sbcs"),i}function $O(e,t,r){var s=e.read_shift(2),n=gi(e,0,r);return[s,n]}function zO(e,t,r,s){var n=r&&r.biff==5;s||(s=oe(n?3+t.length:5+2*t.length)),s.write_shift(2,e),s.write_shift(n?1:2,t.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*t.length,t,n?"sbcs":"utf16le");var a=s.length>s.l?s.slice(0,s.l):s;return a.l==null&&(a.l=a.length),a}var VO=gi;function aw(e,t,r){var s=e.l+t,n=r.biff==8||!r.biff?4:2,a=e.read_shift(n),i=e.read_shift(n),l=e.read_shift(2),c=e.read_shift(2);return e.l=s,{s:{r:a,c:l},e:{r:i,c}}}function WO(e,t){var r=t.biff==8||!t.biff?4:2,s=oe(2*r+6);return s.write_shift(r,e.s.r),s.write_shift(r,e.e.r+1),s.write_shift(2,e.s.c),s.write_shift(2,e.e.c+1),s.write_shift(2,0),s}function HO(e){var t=e.read_shift(2),r=e.read_shift(2),s=KN(e);return{r:t,c:r,ixfe:s[0],rknum:s[1]}}function qO(e,t){for(var r=e.l+t-2,s=e.read_shift(2),n=e.read_shift(2),a=[];e.l<r;)a.push(KN(e));if(e.l!==r)throw new Error("MulRK read error");var i=e.read_shift(2);if(a.length!=i-n+1)throw new Error("MulRK length mismatch");return{r:s,c:n,C:i,rkrec:a}}function GO(e,t){for(var r=e.l+t-2,s=e.read_shift(2),n=e.read_shift(2),a=[];e.l<r;)a.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var i=e.read_shift(2);if(a.length!=i-n+1)throw new Error("MulBlank length mismatch");return{r:s,c:n,C:i,ixfe:a}}function KO(e,t,r,s){var n={},a=e.read_shift(4),i=e.read_shift(4),l=e.read_shift(4),c=e.read_shift(2);return n.patternType=TI[l>>26],s.cellStyles&&(n.alc=a&7,n.fWrap=a>>3&1,n.alcV=a>>4&7,n.fJustLast=a>>7&1,n.trot=a>>8&255,n.cIndent=a>>16&15,n.fShrinkToFit=a>>20&1,n.iReadOrder=a>>22&2,n.fAtrNum=a>>26&1,n.fAtrFnt=a>>27&1,n.fAtrAlc=a>>28&1,n.fAtrBdr=a>>29&1,n.fAtrPat=a>>30&1,n.fAtrProt=a>>31&1,n.dgLeft=i&15,n.dgRight=i>>4&15,n.dgTop=i>>8&15,n.dgBottom=i>>12&15,n.icvLeft=i>>16&127,n.icvRight=i>>23&127,n.grbitDiag=i>>30&3,n.icvTop=l&127,n.icvBottom=l>>7&127,n.icvDiag=l>>14&127,n.dgDiag=l>>21&15,n.icvFore=c&127,n.icvBack=c>>7&127,n.fsxButton=c>>14&1),n}function XO(e,t,r){var s={};return s.ifnt=e.read_shift(2),s.numFmtId=e.read_shift(2),s.flags=e.read_shift(2),s.fStyle=s.flags>>2&1,t-=6,s.data=KO(e,t,s.fStyle,r),s}function iw(e,t,r,s){var n=r&&r.biff==5;s||(s=oe(n?16:20)),s.write_shift(2,0),e.style?(s.write_shift(2,e.numFmtId||0),s.write_shift(2,65524)):(s.write_shift(2,e.numFmtId||0),s.write_shift(2,t<<4));var a=0;return e.numFmtId>0&&n&&(a|=1024),s.write_shift(4,a),s.write_shift(4,0),n||s.write_shift(4,0),s.write_shift(2,0),s}function YO(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function JO(e){var t=oe(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function ow(e,t,r){var s=hn(e);(r.biff==2||t==9)&&++e.l;var n=eO(e);return s.val=n,s.t=n===!0||n===!1?"b":"e",s}function QO(e,t,r,s,n,a){var i=oe(8);return li(e,t,s,i),WN(r,a,i),i}function ZO(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var s=hn(e),n=Nr(e);return s.val=n,s}function eD(e,t,r,s){var n=oe(14);return li(e,t,s,n),ii(r,n),n}var lw=uO;function tD(e,t,r){var s=e.l+t,n=e.read_shift(2),a=e.read_shift(2);if(r.sbcch=a,a==1025||a==14849)return[a,n];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var i=oi(e,a),l=[];s>e.l;)l.push(Dc(e));return[a,n,i,l]}function cw(e,t,r){var s=e.read_shift(2),n,a={fBuiltIn:s&1,fWantAdvise:s>>>1&1,fWantPict:s>>>2&1,fOle:s>>>3&1,fOleLink:s>>>4&1,cf:s>>>5&1023,fIcon:s>>>15&1};return r.sbcch===14849&&(n=fO(e,t-2,r)),a.body=n||e.read_shift(t-2),typeof n=="string"&&(a.Name=n),a}var rD=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function uw(e,t,r){var s=e.l+t,n=e.read_shift(2),a=e.read_shift(1),i=e.read_shift(1),l=e.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),c=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var u=oi(e,i,r);n&32&&(u=rD[u.charCodeAt(0)]);var d=s-e.l;r&&r.biff==2&&--d;var f=s==e.l||l===0||!(d>0)?[]:g9(e,d,r,l);return{chKey:a,Name:u,itab:c,rgce:f}}function QN(e,t,r){if(r.biff<8)return sD(e,t,r);for(var s=[],n=e.l+t,a=e.read_shift(r.biff>8?4:2);a--!==0;)s.push(dO(e,r.biff>8?12:6,r));if(e.l!=n)throw new Error("Bad ExternSheet: "+e.l+" != "+n);return s}function sD(e,t,r){e[e.l+1]==3&&e[e.l]++;var s=Oc(e,t,r);return s.charCodeAt(0)==3?s.slice(1):s}function nD(e,t,r){if(r.biff<8){e.l+=t;return}var s=e.read_shift(2),n=e.read_shift(2),a=oi(e,s,r),i=oi(e,n,r);return[a,i]}function aD(e,t,r){var s=YN(e);e.l++;var n=e.read_shift(1);return t-=8,[v9(e,t,r),n,s]}function dw(e,t,r){var s=hO(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[s,p9(e,t,r)]}function iD(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,s=e.read_shift(4);return[t,r,s]}function oD(e,t,r){if(!(r.biff<8)){var s=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),l=gi(e,0,r);return r.biff<8&&e.read_shift(1),[{r:s,c:n},l,i,a]}}function lD(e,t,r){return oD(e,t,r)}function cD(e,t){for(var r=[],s=e.read_shift(2);s--;)r.push(b0(e));return r}function uD(e){var t=oe(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)XN(e[r],t);return t}function dD(e,t,r){if(r&&r.biff<8)return hD(e,t,r);var s=JN(e),n=gO(e,t-22,s[1]);return{cmo:s,ft:n}}var fD={8:function(e,t){var r=e.l+t;e.l+=10;var s=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var n=e.read_shift(1);return e.l+=n,e.l=r,{fmt:s}}};function hD(e,t,r){e.l+=4;var s=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var i=[];return i.push((fD[s]||Cr)(e,t,r)),{cmo:[n,s,a],ft:i}}function mD(e,t,r){var s=e.l,n="";try{e.l+=4;var a=(r.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(a)==-1?e.l+=6:i=sO(e,6,r);var l=e.read_shift(2);e.read_shift(2),Gt(e,2);var c=e.read_shift(2);e.l+=c;for(var u=1;u<e.lens.length-1;++u){if(e.l-s!=e.lens[u])throw new Error("TxO: bad continue record");var d=e[e.l],f=oi(e,e.lens[u+1]-e.lens[u]-1);if(n+=f,n.length>=(d?l:2*l))break}if(n.length!==l&&n.length!==l*2)throw new Error("cchText: "+l+" != "+n.length);return e.l=s+t,{t:n}}catch{return e.l=s+t,{t:n}}}function pD(e,t){var r=b0(e);e.l+=16;var s=oO(e,t-24);return[r,s]}function xD(e){var t=oe(24),r=Ct(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var s="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<16;++n)t.write_shift(1,parseInt(s[n],16));return nr([t,lO(e[1])])}function gD(e,t){e.read_shift(2);var r=b0(e),s=e.read_shift((t-10)/2,"dbcs-cont");return s=s.replace(Mr,""),[r,s]}function vD(e){var t=e[1].Tooltip,r=oe(10+2*(t.length+1));r.write_shift(2,2048);var s=Ct(e[0]);r.write_shift(2,s.r),r.write_shift(2,s.r),r.write_shift(2,s.c),r.write_shift(2,s.c);for(var n=0;n<t.length;++n)r.write_shift(2,t.charCodeAt(n));return r.write_shift(2,0),r}function yD(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=X1[r]||r,r=e.read_shift(2),t[1]=X1[r]||r,t}function wD(e){return e||(e=oe(4)),e.write_shift(2,1),e.write_shift(2,1),e}function bD(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(GN(e));return r}function _D(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(GN(e));return r}function SD(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function ZN(e,t,r){if(!r.cellStyles)return Cr(e,t);var s=r&&r.biff>=12?4:2,n=e.read_shift(s),a=e.read_shift(s),i=e.read_shift(s),l=e.read_shift(s),c=e.read_shift(2);s==2&&(e.l+=2);var u={s:n,e:a,w:i,ixfe:l,flags:c};return(r.biff>=5||!r.biff)&&(u.level=c>>8&7),u}function kD(e,t){var r=oe(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var s=0;return e.hidden&&(s|=1),r.write_shift(1,s),s=e.level||0,r.write_shift(1,s),r.write_shift(2,0),r}function ND(e,t){var r={};return t<32||(e.l+=16,r.header=Nr(e),r.footer=Nr(e),e.l+=2),r}function jD(e,t,r){var s={area:!1};if(r.biff!=5)return e.l+=t,s;var n=e.read_shift(1);return e.l+=3,n&16&&(s.area=!0),s}function ED(e){for(var t=oe(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var TD=hn,CD=VN,AD=Dc;function FD(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(4),n={fmt:t,env:r,len:s,data:e.slice(e.l,e.l+s)};return e.l+=s,n}function PD(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var s=hn(e);++e.l;var n=gi(e,t-7,r);return s.t="str",s.val=n,s}function RD(e){var t=hn(e);++e.l;var r=Nr(e);return t.t="n",t.val=r,t}function ID(e,t,r){var s=oe(15);return Uc(s,e,t),s.write_shift(8,r,"f"),s}function OD(e){var t=hn(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function DD(e,t,r){var s=oe(9);return Uc(s,e,t),s.write_shift(2,r),s}function LD(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function MD(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function BD(e,t,r){var s=e.l+t,n=hn(e),a=e.read_shift(2),i=oi(e,a,r);return e.l=s,n.t="str",n.val=i,n}var UD=[2,3,48,49,131,139,140,245],Cm=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=v0({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,c){var u=[],d=ua(1);switch(c.type){case"base64":d=is(fs(l));break;case"binary":d=is(l);break;case"buffer":case"array":d=l;break}dr(d,0);var f=d.read_shift(1),h=!!(f&136),p=!1,m=!1;switch(f){case 2:break;case 3:break;case 48:p=!0,h=!0;break;case 49:p=!0,h=!0;break;case 131:break;case 139:break;case 140:m=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var x=0,g=521;f==2&&(x=d.read_shift(2)),d.l+=3,f!=2&&(x=d.read_shift(4)),x>1048576&&(x=1e6),f!=2&&(g=d.read_shift(2));var y=d.read_shift(2),w=c.codepage||1252;f!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(w=e[d[d.l]]),d.l+=1,d.l+=2),m&&(d.l+=36);for(var v=[],b={},_=Math.min(d.length,f==2?521:g-10-(p?264:0)),k=m?32:11;d.l<_&&d[d.l]!=13;)switch(b={},b.name=ic.utils.decode(w,d.slice(d.l,d.l+k)).replace(/[\u0000\r\n].*$/g,""),d.l+=k,b.type=String.fromCharCode(d.read_shift(1)),f!=2&&!m&&(b.offset=d.read_shift(4)),b.len=d.read_shift(1),f==2&&(b.offset=d.read_shift(2)),b.dec=d.read_shift(1),b.name.length&&v.push(b),f!=2&&(d.l+=m?13:14),b.type){case"B":(!p||b.len!=8)&&c.WTF&&console.log("Skipping "+b.name+":"+b.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+b.name+":"+b.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+b.type)}if(d[d.l]!==13&&(d.l=g-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=g;var S=0,E=0;for(u[0]=[],E=0;E!=v.length;++E)u[0][E]=v[E].name;for(;x-- >0;){if(d[d.l]===42){d.l+=y;continue}for(++d.l,u[++S]=[],E=0,E=0;E!=v.length;++E){var C=d.slice(d.l,d.l+v[E].len);d.l+=v[E].len,dr(C,0);var U=ic.utils.decode(w,C);switch(v[E].type){case"C":U.trim().length&&(u[S][E]=U.replace(/\s+$/,""));break;case"D":U.length===8?u[S][E]=new Date(+U.slice(0,4),+U.slice(4,6)-1,+U.slice(6,8)):u[S][E]=U;break;case"F":u[S][E]=parseFloat(U.trim());break;case"+":case"I":u[S][E]=m?C.read_shift(-4,"i")^2147483648:C.read_shift(4,"i");break;case"L":switch(U.trim().toUpperCase()){case"Y":case"T":u[S][E]=!0;break;case"N":case"F":u[S][E]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+U+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));u[S][E]="##MEMO##"+(m?parseInt(U.trim(),10):C.read_shift(4));break;case"N":U=U.replace(/\u0000/g,"").trim(),U&&U!="."&&(u[S][E]=+U||0);break;case"@":u[S][E]=new Date(C.read_shift(-8,"f")-621356832e5);break;case"T":u[S][E]=new Date((C.read_shift(4)-2440588)*864e5+C.read_shift(4));break;case"Y":u[S][E]=C.read_shift(4,"i")/1e4+C.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[S][E]=-C.read_shift(-8,"f");break;case"B":if(p&&v[E].len==8){u[S][E]=C.read_shift(8,"f");break}case"G":case"P":C.l+=v[E].len;break;case"0":if(v[E].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+v[E].type)}}}if(f!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=v,u}function s(l,c){var u=c||{};u.dateNF||(u.dateNF="yyyymmdd");var d=Mo(r(l,u),u);return d["!cols"]=u.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete u.DBF,d}function n(l,c){try{return ba(s(l,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function i(l,c){var u=c||{};if(+u.codepage>=0&&Gs(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var d=Yr(),f=Wd(l,{header:1,raw:!0,cellDates:!0}),h=f[0],p=f.slice(1),m=l["!cols"]||[],x=0,g=0,y=0,w=1;for(x=0;x<h.length;++x){if(((m[x]||{}).DBF||{}).name){h[x]=m[x].DBF.name,++y;continue}if(h[x]!=null){if(++y,typeof h[x]=="number"&&(h[x]=h[x].toString(10)),typeof h[x]!="string")throw new Error("DBF Invalid column name "+h[x]+" |"+typeof h[x]+"|");if(h.indexOf(h[x])!==x){for(g=0;g<1024;++g)if(h.indexOf(h[x]+"_"+g)==-1){h[x]+="_"+g;break}}}}var v=et(l["!ref"]),b=[],_=[],k=[];for(x=0;x<=v.e.c-v.s.c;++x){var S="",E="",C=0,U=[];for(g=0;g<p.length;++g)p[g][x]!=null&&U.push(p[g][x]);if(U.length==0||h[x]==null){b[x]="?";continue}for(g=0;g<U.length;++g){switch(typeof U[g]){case"number":E="B";break;case"string":E="C";break;case"boolean":E="L";break;case"object":E=U[g]instanceof Date?"D":"C";break;default:E="C"}C=Math.max(C,String(U[g]).length),S=S&&S!=E?"C":E}C>250&&(C=250),E=((m[x]||{}).DBF||{}).type,E=="C"&&m[x].DBF.len>C&&(C=m[x].DBF.len),S=="B"&&E=="N"&&(S="N",k[x]=m[x].DBF.dec,C=m[x].DBF.len),_[x]=S=="C"||E=="N"?C:a[S]||0,w+=_[x],b[x]=S}var H=d.next(32);for(H.write_shift(4,318902576),H.write_shift(4,p.length),H.write_shift(2,296+32*y),H.write_shift(2,w),x=0;x<4;++x)H.write_shift(4,0);for(H.write_shift(4,0|(+t[zk]||3)<<8),x=0,g=0;x<h.length;++x)if(h[x]!=null){var W=d.next(32),q=(h[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);W.write_shift(1,q,"sbcs"),W.write_shift(1,b[x]=="?"?"C":b[x],"sbcs"),W.write_shift(4,g),W.write_shift(1,_[x]||a[b[x]]||0),W.write_shift(1,k[x]||0),W.write_shift(1,2),W.write_shift(4,0),W.write_shift(1,0),W.write_shift(4,0),W.write_shift(4,0),g+=_[x]||a[b[x]]||0}var z=d.next(264);for(z.write_shift(4,13),x=0;x<65;++x)z.write_shift(4,0);for(x=0;x<p.length;++x){var Q=d.next(w);for(Q.write_shift(1,0),g=0;g<h.length;++g)if(h[g]!=null)switch(b[g]){case"L":Q.write_shift(1,p[x][g]==null?63:p[x][g]?84:70);break;case"B":Q.write_shift(8,p[x][g]||0,"f");break;case"N":var L="0";for(typeof p[x][g]=="number"&&(L=p[x][g].toFixed(k[g]||0)),y=0;y<_[g]-L.length;++y)Q.write_shift(1,32);Q.write_shift(1,L,"sbcs");break;case"D":p[x][g]?(Q.write_shift(4,("0000"+p[x][g].getFullYear()).slice(-4),"sbcs"),Q.write_shift(2,("00"+(p[x][g].getMonth()+1)).slice(-2),"sbcs"),Q.write_shift(2,("00"+p[x][g].getDate()).slice(-2),"sbcs")):Q.write_shift(8,"00000000","sbcs");break;case"C":var X=String(p[x][g]!=null?p[x][g]:"").slice(0,_[g]);for(Q.write_shift(1,X,"sbcs"),y=0;y<_[g]-X.length;++y)Q.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:n,to_sheet:s,from_sheet:i}}(),ej=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Dt(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,p){var m=e[p];return typeof m=="number"?_1(m):m},s=function(h,p,m){var x=p.charCodeAt(0)-32<<4|m.charCodeAt(0)-48;return x==59?h:_1(x)};e["|"]=254;function n(h,p){switch(p.type){case"base64":return a(fs(h),p);case"binary":return a(h,p);case"buffer":return a(Ke&&Buffer.isBuffer(h)?h.toString("binary"):wa(h),p);case"array":return a(ai(h),p)}throw new Error("Unrecognized type "+p.type)}function a(h,p){var m=h.split(/[\n\r]+/),x=-1,g=-1,y=0,w=0,v=[],b=[],_=null,k={},S=[],E=[],C=[],U=0,H;for(+p.codepage>=0&&Gs(+p.codepage);y!==m.length;++y){U=0;var W=m[y].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,s).replace(t,r),q=W.replace(/;;/g,"\0").split(";").map(function(B){return B.replace(/\u0000/g,";")}),z=q[0],Q;if(W.length>0)switch(z){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":q[1].charAt(0)=="P"&&b.push(W.slice(3).replace(/;;/g,";"));break;case"C":var L=!1,X=!1,K=!1,V=!1,fe=-1,ve=-1;for(w=1;w<q.length;++w)switch(q[w].charAt(0)){case"A":break;case"X":g=parseInt(q[w].slice(1))-1,X=!0;break;case"Y":for(x=parseInt(q[w].slice(1))-1,X||(g=0),H=v.length;H<=x;++H)v[H]=[];break;case"K":Q=q[w].slice(1),Q.charAt(0)==='"'?Q=Q.slice(1,Q.length-1):Q==="TRUE"?Q=!0:Q==="FALSE"?Q=!1:isNaN(Js(Q))?isNaN(So(Q).getDate())||(Q=xt(Q)):(Q=Js(Q),_!==null&&Do(_)&&(Q=w0(Q))),L=!0;break;case"E":V=!0;var P=io(q[w].slice(1),{r:x,c:g});v[x][g]=[v[x][g],P];break;case"S":K=!0,v[x][g]=[v[x][g],"S5S"];break;case"G":break;case"R":fe=parseInt(q[w].slice(1))-1;break;case"C":ve=parseInt(q[w].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+W)}if(L&&(v[x][g]&&v[x][g].length==2?v[x][g][0]=Q:v[x][g]=Q,_=null),K){if(V)throw new Error("SYLK shared formula cannot have own formula");var M=fe>-1&&v[fe][ve];if(!M||!M[1])throw new Error("SYLK shared formula cannot find base");v[x][g][1]=vj(M[1],{r:x-fe,c:g-ve})}break;case"F":var D=0;for(w=1;w<q.length;++w)switch(q[w].charAt(0)){case"X":g=parseInt(q[w].slice(1))-1,++D;break;case"Y":for(x=parseInt(q[w].slice(1))-1,H=v.length;H<=x;++H)v[H]=[];break;case"M":U=parseInt(q[w].slice(1))/20;break;case"F":break;case"G":break;case"P":_=b[parseInt(q[w].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(C=q[w].slice(1).split(" "),H=parseInt(C[0],10);H<=parseInt(C[1],10);++H)U=parseInt(C[2],10),E[H-1]=U===0?{hidden:!0}:{wch:U},da(E[H-1]);break;case"C":g=parseInt(q[w].slice(1))-1,E[g]||(E[g]={});break;case"R":x=parseInt(q[w].slice(1))-1,S[x]||(S[x]={}),U>0?(S[x].hpt=U,S[x].hpx=No(U)):U===0&&(S[x].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+W)}D<1&&(_=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+W)}}return S.length>0&&(k["!rows"]=S),E.length>0&&(k["!cols"]=E),p&&p.sheetRows&&(v=v.slice(0,p.sheetRows)),[v,k]}function i(h,p){var m=n(h,p),x=m[0],g=m[1],y=Mo(x,p);return Dt(g).forEach(function(w){y[w]=g[w]}),y}function l(h,p){return ba(i(h,p),p)}function c(h,p,m,x){var g="C;Y"+(m+1)+";X"+(x+1)+";K";switch(h.t){case"n":g+=h.v||0,h.f&&!h.F&&(g+=";E"+tg(h.f,{r:m,c:x}));break;case"b":g+=h.v?"TRUE":"FALSE";break;case"e":g+=h.w||h.v;break;case"d":g+='"'+(h.w||h.v)+'"';break;case"s":g+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function u(h,p){p.forEach(function(m,x){var g="F;W"+(x+1)+" "+(x+1)+" ";m.hidden?g+="0":(typeof m.width=="number"&&!m.wpx&&(m.wpx=mc(m.width)),typeof m.wpx=="number"&&!m.wch&&(m.wch=pc(m.wpx)),typeof m.wch=="number"&&(g+=Math.round(m.wch))),g.charAt(g.length-1)!=" "&&h.push(g)})}function d(h,p){p.forEach(function(m,x){var g="F;";m.hidden?g+="M0;":m.hpt?g+="M"+20*m.hpt+";":m.hpx&&(g+="M"+20*xc(m.hpx)+";"),g.length>2&&h.push(g+"R"+(x+1))})}function f(h,p){var m=["ID;PWXL;N;E"],x=[],g=et(h["!ref"]),y,w=Array.isArray(h),v=`\r
`;m.push("P;PGeneral"),m.push("F;P0;DG0G8;M255"),h["!cols"]&&u(m,h["!cols"]),h["!rows"]&&d(m,h["!rows"]),m.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var b=g.s.r;b<=g.e.r;++b)for(var _=g.s.c;_<=g.e.c;++_){var k=Ue({r:b,c:_});y=w?(h[b]||[])[_]:h[k],!(!y||y.v==null&&(!y.f||y.F))&&x.push(c(y,h,b,_))}return m.join(v)+v+x.join(v)+v+"E"+v}return{to_workbook:l,to_sheet:i,from_sheet:f}}(),tj=function(){function e(a,i){switch(i.type){case"base64":return t(fs(a),i);case"binary":return t(a,i);case"buffer":return t(Ke&&Buffer.isBuffer(a)?a.toString("binary"):wa(a),i);case"array":return t(ai(a),i)}throw new Error("Unrecognized type "+i.type)}function t(a,i){for(var l=a.split(`
`),c=-1,u=-1,d=0,f=[];d!==l.length;++d){if(l[d].trim()==="BOT"){f[++c]=[],u=0;continue}if(!(c<0)){var h=l[d].trim().split(","),p=h[0],m=h[1];++d;for(var x=l[d]||"";(x.match(/["]/g)||[]).length&1&&d<l.length-1;)x+=`
`+l[++d];switch(x=x.trim(),+p){case-1:if(x==="BOT"){f[++c]=[],u=0;continue}else if(x!=="EOD")throw new Error("Unrecognized DIF special command "+x);break;case 0:x==="TRUE"?f[c][u]=!0:x==="FALSE"?f[c][u]=!1:isNaN(Js(m))?isNaN(So(m).getDate())?f[c][u]=m:f[c][u]=xt(m):f[c][u]=Js(m),++u;break;case 1:x=x.slice(1,x.length-1),x=x.replace(/""/g,'"'),x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),f[c][u++]=x!==""?x:null;break}if(x==="EOD")break}}return i&&i.sheetRows&&(f=f.slice(0,i.sheetRows)),f}function r(a,i){return Mo(e(a,i),i)}function s(a,i){return ba(r(a,i),i)}var n=function(){var a=function(c,u,d,f,h){c.push(u),c.push(d+","+f),c.push('"'+h.replace(/"/g,'""')+'"')},i=function(c,u,d,f){c.push(u+","+d),c.push(u==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(c){var u=[],d=et(c["!ref"]),f,h=Array.isArray(c);a(u,"TABLE",0,1,"sheetjs"),a(u,"VECTORS",0,d.e.r-d.s.r+1,""),a(u,"TUPLES",0,d.e.c-d.s.c+1,""),a(u,"DATA",0,0,"");for(var p=d.s.r;p<=d.e.r;++p){i(u,-1,0,"BOT");for(var m=d.s.c;m<=d.e.c;++m){var x=Ue({r:p,c:m});if(f=h?(c[p]||[])[m]:c[x],!f){i(u,1,0,"");continue}switch(f.t){case"n":var g=f.w;!g&&f.v!=null&&(g=f.v),g==null?f.f&&!f.F?i(u,1,0,"="+f.f):i(u,1,0,""):i(u,0,g,"V");break;case"b":i(u,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":i(u,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=Os(f.z||Be[14],tr(xt(f.v)))),i(u,0,f.w,"V");break;default:i(u,1,0,"")}}}i(u,-1,0,"EOD");var y=`\r
`,w=u.join(y);return w}}();return{to_workbook:s,to_sheet:r,from_sheet:n}}(),rj=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,h){for(var p=f.split(`
`),m=-1,x=-1,g=0,y=[];g!==p.length;++g){var w=p[g].trim().split(":");if(w[0]==="cell"){var v=Ct(w[1]);if(y.length<=v.r)for(m=y.length;m<=v.r;++m)y[m]||(y[m]=[]);switch(m=v.r,x=v.c,w[2]){case"t":y[m][x]=e(w[3]);break;case"v":y[m][x]=+w[3];break;case"vtf":var b=w[w.length-1];case"vtc":switch(w[3]){case"nl":y[m][x]=!!+w[4];break;default:y[m][x]=+w[4];break}w[2]=="vtf"&&(y[m][x]=[y[m][x],b])}}}return h&&h.sheetRows&&(y=y.slice(0,h.sheetRows)),y}function s(f,h){return Mo(r(f,h),h)}function n(f,h){return ba(s(f,h),h)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function u(f){if(!f||!f["!ref"])return"";for(var h=[],p=[],m,x="",g=Jr(f["!ref"]),y=Array.isArray(f),w=g.s.r;w<=g.e.r;++w)for(var v=g.s.c;v<=g.e.c;++v)if(x=Ue({r:w,c:v}),m=y?(f[w]||[])[v]:f[x],!(!m||m.v==null||m.t==="z")){switch(p=["cell",x,"t"],m.t){case"s":case"str":p.push(t(m.v));break;case"n":m.f?(p[2]="vtf",p[3]="n",p[4]=m.v,p[5]=t(m.f)):(p[2]="v",p[3]=m.v);break;case"b":p[2]="vt"+(m.f?"f":"c"),p[3]="nl",p[4]=m.v?"1":"0",p[5]=t(m.f||(m.v?"TRUE":"FALSE"));break;case"d":var b=tr(xt(m.v));p[2]="vtc",p[3]="nd",p[4]=""+b,p[5]=m.w||Os(m.z||Be[14],b);break;case"e":continue}h.push(p.join(":"))}return h.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function d(f){return[a,i,l,i,u(f),c].join(`
`)}return{to_workbook:n,to_sheet:s,from_sheet:d}}(),ko=function(){function e(d,f,h,p,m){m.raw?f[h][p]=d:d===""||(d==="TRUE"?f[h][p]=!0:d==="FALSE"?f[h][p]=!1:isNaN(Js(d))?isNaN(So(d).getDate())?f[h][p]=d:f[h][p]=xt(d):f[h][p]=Js(d))}function t(d,f){var h=f||{},p=[];if(!d||d.length===0)return p;for(var m=d.split(/[\r\n]/),x=m.length-1;x>=0&&m[x].length===0;)--x;for(var g=10,y=0,w=0;w<=x;++w)y=m[w].indexOf(" "),y==-1?y=m[w].length:y++,g=Math.max(g,y);for(w=0;w<=x;++w){p[w]=[];var v=0;for(e(m[w].slice(0,g).trim(),p,w,v,h),v=1;v<=(m[w].length-g)/10+1;++v)e(m[w].slice(g+(v-1)*10,g+v*10).trim(),p,w,v,h)}return h.sheetRows&&(p=p.slice(0,h.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},s={44:3,9:2,59:1,124:0};function n(d){for(var f={},h=!1,p=0,m=0;p<d.length;++p)(m=d.charCodeAt(p))==34?h=!h:!h&&m in r&&(f[m]=(f[m]||0)+1);m=[];for(p in f)Object.prototype.hasOwnProperty.call(f,p)&&m.push([f[p],p]);if(!m.length){f=s;for(p in f)Object.prototype.hasOwnProperty.call(f,p)&&m.push([f[p],p])}return m.sort(function(x,g){return x[0]-g[0]||s[x[1]]-s[g[1]]}),r[m.pop()[1]]||44}function a(d,f){var h=f||{},p="",m=h.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(p=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(p=d.charAt(4),d=d.slice(6)):p=n(d.slice(0,1024)):h&&h.FS?p=h.FS:p=n(d.slice(0,1024));var g=0,y=0,w=0,v=0,b=0,_=p.charCodeAt(0),k=!1,S=0,E=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var C=h.dateNF!=null?j8(h.dateNF):null;function U(){var H=d.slice(v,b),W={};if(H.charAt(0)=='"'&&H.charAt(H.length-1)=='"'&&(H=H.slice(1,-1).replace(/""/g,'"')),H.length===0)W.t="z";else if(h.raw)W.t="s",W.v=H;else if(H.trim().length===0)W.t="s",W.v=H;else if(H.charCodeAt(0)==61)H.charCodeAt(1)==34&&H.charCodeAt(H.length-1)==34?(W.t="s",W.v=H.slice(2,-1).replace(/""/g,'"')):t7(H)?(W.t="n",W.f=H.slice(1)):(W.t="s",W.v=H);else if(H=="TRUE")W.t="b",W.v=!0;else if(H=="FALSE")W.t="b",W.v=!1;else if(!isNaN(w=Js(H)))W.t="n",h.cellText!==!1&&(W.w=H),W.v=w;else if(!isNaN(So(H).getDate())||C&&H.match(C)){W.z=h.dateNF||Be[14];var q=0;C&&H.match(C)&&(H=E8(H,h.dateNF,H.match(C)||[]),q=1),h.cellDates?(W.t="d",W.v=xt(H,q)):(W.t="n",W.v=tr(xt(H,q))),h.cellText!==!1&&(W.w=Os(W.z,W.v instanceof Date?tr(W.v):W.v)),h.cellNF||delete W.z}else W.t="s",W.v=H;if(W.t=="z"||(h.dense?(m[g]||(m[g]=[]),m[g][y]=W):m[Ue({c:y,r:g})]=W),v=b+1,E=d.charCodeAt(v),x.e.c<y&&(x.e.c=y),x.e.r<g&&(x.e.r=g),S==_)++y;else if(y=0,++g,h.sheetRows&&h.sheetRows<=g)return!0}e:for(;b<d.length;++b)switch(S=d.charCodeAt(b)){case 34:E===34&&(k=!k);break;case _:case 10:case 13:if(!k&&U())break e;break}return b-v>0&&U(),m["!ref"]=qe(x),m}function i(d,f){return!(f&&f.PRN)||f.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?a(d,f):Mo(t(d,f),f)}function l(d,f){var h="",p=f.type=="string"?[0,0,0,0]:cg(d,f);switch(f.type){case"base64":h=fs(d);break;case"binary":h=d;break;case"buffer":f.codepage==65001?h=d.toString("utf8"):f.codepage&&typeof ic<"u"||(h=Ke&&Buffer.isBuffer(d)?d.toString("binary"):wa(d));break;case"array":h=ai(d);break;case"string":h=d;break;default:throw new Error("Unrecognized type "+f.type)}return p[0]==239&&p[1]==187&&p[2]==191?h=ct(h.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?h=ct(h):f.type=="binary"&&typeof ic<"u",h.slice(0,19)=="socialcalc:version:"?rj.to_sheet(f.type=="string"?h:ct(h),f):i(h,f)}function c(d,f){return ba(l(d,f),f)}function u(d){for(var f=[],h=et(d["!ref"]),p,m=Array.isArray(d),x=h.s.r;x<=h.e.r;++x){for(var g=[],y=h.s.c;y<=h.e.c;++y){var w=Ue({r:x,c:y});if(p=m?(d[x]||[])[y]:d[w],!p||p.v==null){g.push("          ");continue}for(var v=(p.w||(In(p),p.w)||"").slice(0,10);v.length<10;)v+=" ";g.push(v+(y===0?" ":""))}f.push(g.join(""))}return f.join(`
`)}return{to_workbook:c,to_sheet:l,from_sheet:u}}();function $D(e,t){var r=t||{},s=!!r.WTF;r.WTF=!0;try{var n=ej.to_workbook(e,r);return r.WTF=s,n}catch(a){if(r.WTF=s,!a.message.match(/SYLK bad record ID/)&&s)throw a;return ko.to_workbook(e,t)}}var Ya=function(){function e(P,M,D){if(P){dr(P,P.l||0);for(var B=D.Enum||fe;P.l<P.length;){var Y=P.read_shift(2),he=B[Y]||B[65535],xe=P.read_shift(2),se=P.l+xe,ne=he.f&&he.f(P,xe,D);if(P.l=se,M(ne,he,Y))return}}}function t(P,M){switch(M.type){case"base64":return r(is(fs(P)),M);case"binary":return r(is(P),M);case"buffer":case"array":return r(P,M)}throw"Unsupported type "+M.type}function r(P,M){if(!P)return P;var D=M||{},B=D.dense?[]:{},Y="Sheet1",he="",xe=0,se={},ne=[],be=[],N={s:{r:0,c:0},e:{r:0,c:0}},G=D.sheetRows||0;if(P[2]==0&&(P[3]==8||P[3]==9)&&P.length>=16&&P[14]==5&&P[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(P[2]==2)D.Enum=fe,e(P,function(ae,ge,le){switch(le){case 0:D.vers=ae,ae>=4096&&(D.qpro=!0);break;case 6:N=ae;break;case 204:ae&&(he=ae);break;case 222:he=ae;break;case 15:case 51:D.qpro||(ae[1].v=ae[1].v.slice(1));case 13:case 14:case 16:le==14&&(ae[2]&112)==112&&(ae[2]&15)>1&&(ae[2]&15)<15&&(ae[1].z=D.dateNF||Be[14],D.cellDates&&(ae[1].t="d",ae[1].v=w0(ae[1].v))),D.qpro&&ae[3]>xe&&(B["!ref"]=qe(N),se[Y]=B,ne.push(Y),B=D.dense?[]:{},N={s:{r:0,c:0},e:{r:0,c:0}},xe=ae[3],Y=he||"Sheet"+(xe+1),he="");var je=D.dense?(B[ae[0].r]||[])[ae[0].c]:B[Ue(ae[0])];if(je){je.t=ae[1].t,je.v=ae[1].v,ae[1].z!=null&&(je.z=ae[1].z),ae[1].f!=null&&(je.f=ae[1].f);break}D.dense?(B[ae[0].r]||(B[ae[0].r]=[]),B[ae[0].r][ae[0].c]=ae[1]):B[Ue(ae[0])]=ae[1];break}},D);else if(P[2]==26||P[2]==14)D.Enum=ve,P[2]==14&&(D.qpro=!0,P.l=0),e(P,function(ae,ge,le){switch(le){case 204:Y=ae;break;case 22:ae[1].v=ae[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ae[3]>xe&&(B["!ref"]=qe(N),se[Y]=B,ne.push(Y),B=D.dense?[]:{},N={s:{r:0,c:0},e:{r:0,c:0}},xe=ae[3],Y="Sheet"+(xe+1)),G>0&&ae[0].r>=G)break;D.dense?(B[ae[0].r]||(B[ae[0].r]=[]),B[ae[0].r][ae[0].c]=ae[1]):B[Ue(ae[0])]=ae[1],N.e.c<ae[0].c&&(N.e.c=ae[0].c),N.e.r<ae[0].r&&(N.e.r=ae[0].r);break;case 27:ae[14e3]&&(be[ae[14e3][0]]=ae[14e3][1]);break;case 1537:be[ae[0]]=ae[1],ae[0]==xe&&(Y=ae[1]);break}},D);else throw new Error("Unrecognized LOTUS BOF "+P[2]);if(B["!ref"]=qe(N),se[he||Y]=B,ne.push(he||Y),!be.length)return{SheetNames:ne,Sheets:se};for(var ce={},te=[],ue=0;ue<be.length;++ue)se[ne[ue]]?(te.push(be[ue]||ne[ue]),ce[be[ue]]=se[be[ue]]||se[ne[ue]]):(te.push(be[ue]),ce[be[ue]]={"!ref":"A1"});return{SheetNames:te,Sheets:ce}}function s(P,M){var D=M||{};if(+D.codepage>=0&&Gs(+D.codepage),D.type=="string")throw new Error("Cannot write WK1 to JS string");var B=Yr(),Y=et(P["!ref"]),he=Array.isArray(P),xe=[];Ne(B,0,a(1030)),Ne(B,6,c(Y));for(var se=Math.min(Y.e.r,8191),ne=Y.s.r;ne<=se;++ne)for(var be=zt(ne),N=Y.s.c;N<=Y.e.c;++N){ne===Y.s.r&&(xe[N]=Tt(N));var G=xe[N]+be,ce=he?(P[ne]||[])[N]:P[G];if(!(!ce||ce.t=="z"))if(ce.t=="n")(ce.v|0)==ce.v&&ce.v>=-32768&&ce.v<=32767?Ne(B,13,p(ne,N,ce.v)):Ne(B,14,x(ne,N,ce.v));else{var te=In(ce);Ne(B,15,f(ne,N,te.slice(0,239)))}}return Ne(B,1),B.end()}function n(P,M){var D=M||{};if(+D.codepage>=0&&Gs(+D.codepage),D.type=="string")throw new Error("Cannot write WK3 to JS string");var B=Yr();Ne(B,0,i(P));for(var Y=0,he=0;Y<P.SheetNames.length;++Y)(P.Sheets[P.SheetNames[Y]]||{})["!ref"]&&Ne(B,27,V(P.SheetNames[Y],he++));var xe=0;for(Y=0;Y<P.SheetNames.length;++Y){var se=P.Sheets[P.SheetNames[Y]];if(!(!se||!se["!ref"])){for(var ne=et(se["!ref"]),be=Array.isArray(se),N=[],G=Math.min(ne.e.r,8191),ce=ne.s.r;ce<=G;++ce)for(var te=zt(ce),ue=ne.s.c;ue<=ne.e.c;++ue){ce===ne.s.r&&(N[ue]=Tt(ue));var ae=N[ue]+te,ge=be?(se[ce]||[])[ue]:se[ae];if(!(!ge||ge.t=="z"))if(ge.t=="n")Ne(B,23,U(ce,ue,xe,ge.v));else{var le=In(ge);Ne(B,22,S(ce,ue,xe,le.slice(0,239)))}}++xe}}return Ne(B,1),B.end()}function a(P){var M=oe(2);return M.write_shift(2,P),M}function i(P){var M=oe(26);M.write_shift(2,4096),M.write_shift(2,4),M.write_shift(4,0);for(var D=0,B=0,Y=0,he=0;he<P.SheetNames.length;++he){var xe=P.SheetNames[he],se=P.Sheets[xe];if(!(!se||!se["!ref"])){++Y;var ne=Jr(se["!ref"]);D<ne.e.r&&(D=ne.e.r),B<ne.e.c&&(B=ne.e.c)}}return D>8191&&(D=8191),M.write_shift(2,D),M.write_shift(1,Y),M.write_shift(1,B),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(1,1),M.write_shift(1,2),M.write_shift(4,0),M.write_shift(4,0),M}function l(P,M,D){var B={s:{c:0,r:0},e:{c:0,r:0}};return M==8&&D.qpro?(B.s.c=P.read_shift(1),P.l++,B.s.r=P.read_shift(2),B.e.c=P.read_shift(1),P.l++,B.e.r=P.read_shift(2),B):(B.s.c=P.read_shift(2),B.s.r=P.read_shift(2),M==12&&D.qpro&&(P.l+=2),B.e.c=P.read_shift(2),B.e.r=P.read_shift(2),M==12&&D.qpro&&(P.l+=2),B.s.c==65535&&(B.s.c=B.e.c=B.s.r=B.e.r=0),B)}function c(P){var M=oe(8);return M.write_shift(2,P.s.c),M.write_shift(2,P.s.r),M.write_shift(2,P.e.c),M.write_shift(2,P.e.r),M}function u(P,M,D){var B=[{c:0,r:0},{t:"n",v:0},0,0];return D.qpro&&D.vers!=20768?(B[0].c=P.read_shift(1),B[3]=P.read_shift(1),B[0].r=P.read_shift(2),P.l+=2):(B[2]=P.read_shift(1),B[0].c=P.read_shift(2),B[0].r=P.read_shift(2)),B}function d(P,M,D){var B=P.l+M,Y=u(P,M,D);if(Y[1].t="s",D.vers==20768){P.l++;var he=P.read_shift(1);return Y[1].v=P.read_shift(he,"utf8"),Y}return D.qpro&&P.l++,Y[1].v=P.read_shift(B-P.l,"cstr"),Y}function f(P,M,D){var B=oe(7+D.length);B.write_shift(1,255),B.write_shift(2,M),B.write_shift(2,P),B.write_shift(1,39);for(var Y=0;Y<B.length;++Y){var he=D.charCodeAt(Y);B.write_shift(1,he>=128?95:he)}return B.write_shift(1,0),B}function h(P,M,D){var B=u(P,M,D);return B[1].v=P.read_shift(2,"i"),B}function p(P,M,D){var B=oe(7);return B.write_shift(1,255),B.write_shift(2,M),B.write_shift(2,P),B.write_shift(2,D,"i"),B}function m(P,M,D){var B=u(P,M,D);return B[1].v=P.read_shift(8,"f"),B}function x(P,M,D){var B=oe(13);return B.write_shift(1,255),B.write_shift(2,M),B.write_shift(2,P),B.write_shift(8,D,"f"),B}function g(P,M,D){var B=P.l+M,Y=u(P,M,D);if(Y[1].v=P.read_shift(8,"f"),D.qpro)P.l=B;else{var he=P.read_shift(2);b(P.slice(P.l,P.l+he),Y),P.l+=he}return Y}function y(P,M,D){var B=M&32768;return M&=-32769,M=(B?P:0)+(M>=8192?M-16384:M),(B?"":"$")+(D?Tt(M):zt(M))}var w={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},v=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function b(P,M){dr(P,0);for(var D=[],B=0,Y="",he="",xe="",se="";P.l<P.length;){var ne=P[P.l++];switch(ne){case 0:D.push(P.read_shift(8,"f"));break;case 1:he=y(M[0].c,P.read_shift(2),!0),Y=y(M[0].r,P.read_shift(2),!1),D.push(he+Y);break;case 2:{var be=y(M[0].c,P.read_shift(2),!0),N=y(M[0].r,P.read_shift(2),!1);he=y(M[0].c,P.read_shift(2),!0),Y=y(M[0].r,P.read_shift(2),!1),D.push(be+N+":"+he+Y)}break;case 3:if(P.l<P.length){console.error("WK1 premature formula end");return}break;case 4:D.push("("+D.pop()+")");break;case 5:D.push(P.read_shift(2));break;case 6:{for(var G="";ne=P[P.l++];)G+=String.fromCharCode(ne);D.push('"'+G.replace(/"/g,'""')+'"')}break;case 8:D.push("-"+D.pop());break;case 23:D.push("+"+D.pop());break;case 22:D.push("NOT("+D.pop()+")");break;case 20:case 21:se=D.pop(),xe=D.pop(),D.push(["AND","OR"][ne-20]+"("+xe+","+se+")");break;default:if(ne<32&&v[ne])se=D.pop(),xe=D.pop(),D.push(xe+v[ne]+se);else if(w[ne]){if(B=w[ne][1],B==69&&(B=P[P.l++]),B>D.length){console.error("WK1 bad formula parse 0x"+ne.toString(16)+":|"+D.join("|")+"|");return}var ce=D.slice(-B);D.length-=B,D.push(w[ne][0]+"("+ce.join(",")+")")}else return ne<=7?console.error("WK1 invalid opcode "+ne.toString(16)):ne<=24?console.error("WK1 unsupported op "+ne.toString(16)):ne<=30?console.error("WK1 invalid opcode "+ne.toString(16)):ne<=115?console.error("WK1 unsupported function opcode "+ne.toString(16)):console.error("WK1 unrecognized opcode "+ne.toString(16))}}D.length==1?M[1].f=""+D[0]:console.error("WK1 bad formula parse |"+D.join("|")+"|")}function _(P){var M=[{c:0,r:0},{t:"n",v:0},0];return M[0].r=P.read_shift(2),M[3]=P[P.l++],M[0].c=P[P.l++],M}function k(P,M){var D=_(P);return D[1].t="s",D[1].v=P.read_shift(M-4,"cstr"),D}function S(P,M,D,B){var Y=oe(6+B.length);Y.write_shift(2,P),Y.write_shift(1,D),Y.write_shift(1,M),Y.write_shift(1,39);for(var he=0;he<B.length;++he){var xe=B.charCodeAt(he);Y.write_shift(1,xe>=128?95:xe)}return Y.write_shift(1,0),Y}function E(P,M){var D=_(P);D[1].v=P.read_shift(2);var B=D[1].v>>1;if(D[1].v&1)switch(B&7){case 0:B=(B>>3)*5e3;break;case 1:B=(B>>3)*500;break;case 2:B=(B>>3)/20;break;case 3:B=(B>>3)/200;break;case 4:B=(B>>3)/2e3;break;case 5:B=(B>>3)/2e4;break;case 6:B=(B>>3)/16;break;case 7:B=(B>>3)/64;break}return D[1].v=B,D}function C(P,M){var D=_(P),B=P.read_shift(4),Y=P.read_shift(4),he=P.read_shift(2);if(he==65535)return B===0&&Y===3221225472?(D[1].t="e",D[1].v=15):B===0&&Y===3489660928?(D[1].t="e",D[1].v=42):D[1].v=0,D;var xe=he&32768;return he=(he&32767)-16446,D[1].v=(1-xe*2)*(Y*Math.pow(2,he+32)+B*Math.pow(2,he)),D}function U(P,M,D,B){var Y=oe(14);if(Y.write_shift(2,P),Y.write_shift(1,D),Y.write_shift(1,M),B==0)return Y.write_shift(4,0),Y.write_shift(4,0),Y.write_shift(2,65535),Y;var he=0,xe=0,se=0,ne=0;return B<0&&(he=1,B=-B),xe=Math.log2(B)|0,B/=Math.pow(2,xe-31),ne=B>>>0,ne&2147483648||(B/=2,++xe,ne=B>>>0),B-=ne,ne|=2147483648,ne>>>=0,B*=Math.pow(2,32),se=B>>>0,Y.write_shift(4,se),Y.write_shift(4,ne),xe+=16383+(he?32768:0),Y.write_shift(2,xe),Y}function H(P,M){var D=C(P);return P.l+=M-14,D}function W(P,M){var D=_(P),B=P.read_shift(4);return D[1].v=B>>6,D}function q(P,M){var D=_(P),B=P.read_shift(8,"f");return D[1].v=B,D}function z(P,M){var D=q(P);return P.l+=M-10,D}function Q(P,M){return P[P.l+M-1]==0?P.read_shift(M,"cstr"):""}function L(P,M){var D=P[P.l++];D>M-1&&(D=M-1);for(var B="";B.length<D;)B+=String.fromCharCode(P[P.l++]);return B}function X(P,M,D){if(!(!D.qpro||M<21)){var B=P.read_shift(1);P.l+=17,P.l+=1,P.l+=2;var Y=P.read_shift(M-21,"cstr");return[B,Y]}}function K(P,M){for(var D={},B=P.l+M;P.l<B;){var Y=P.read_shift(2);if(Y==14e3){for(D[Y]=[0,""],D[Y][0]=P.read_shift(2);P[P.l];)D[Y][1]+=String.fromCharCode(P[P.l]),P.l++;P.l++}}return D}function V(P,M){var D=oe(5+P.length);D.write_shift(2,14e3),D.write_shift(2,M);for(var B=0;B<P.length;++B){var Y=P.charCodeAt(B);D[D.l++]=Y>127?95:Y}return D[D.l++]=0,D}var fe={0:{n:"BOF",f:Gt},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:m},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Q},222:{n:"SHEETNAMELP",f:L},65535:{n:""}},ve={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:k},23:{n:"NUMBER17",f:C},24:{n:"NUMBER18",f:E},25:{n:"FORMULA19",f:H},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:K},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:W},38:{n:"??"},39:{n:"NUMBER27",f:q},40:{n:"FORMULA28",f:z},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Q},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:X},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:s,book_to_wk3:n,to_workbook:t}}();function zD(e){var t={},r=e.match(Ar),s=0,n=!1;if(r)for(;s!=r.length;++s){var a=ze(r[s]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;t.cp=jx[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=a.val;break;case"<sz":t.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":a.rgb&&(t.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(a[0].charCodeAt(1)!==47&&!n)throw new Error("Unrecognized rich format "+a[0])}}return t}var VD=function(){var e=cc("t"),t=cc("rPr");function r(a){var i=a.match(e);if(!i)return{t:"s",v:""};var l={t:"s",v:Ze(i[1])},c=a.match(t);return c&&(l.s=zD(c[1])),l}var s=/<(?:\w+:)?r>/g,n=/<\/(?:\w+:)?r>/;return function(i){return i.replace(s,"").split(n).map(r).filter(function(l){return l.v})}}(),WD=function(){var t=/(\r\n|\n)/g;function r(n,a,i){var l=[];n.u&&l.push("text-decoration: underline;"),n.uval&&l.push("text-underline-style:"+n.uval+";"),n.sz&&l.push("font-size:"+n.sz+"pt;"),n.outline&&l.push("text-effect: outline;"),n.shadow&&l.push("text-shadow: auto;"),a.push('<span style="'+l.join("")+'">'),n.b&&(a.push("<b>"),i.push("</b>")),n.i&&(a.push("<i>"),i.push("</i>")),n.strike&&(a.push("<s>"),i.push("</s>"));var c=n.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(a.push("<"+c+">"),i.push("</"+c+">")),i.push("</span>"),n}function s(n){var a=[[],n.v,[]];return n.v?(n.s&&r(n.s,a[0],a[2]),a[0].join("")+a[1].replace(t,"<br/>")+a[2].join("")):""}return function(a){return a.map(s).join("")}}(),HD=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,qD=/<(?:\w+:)?r>/,GD=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Yx(e,t){var r=t?t.cellHTML:!0,s={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(s.t=Ze(ct(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),s.r=ct(e),r&&(s.h=Dx(s.t))):e.match(qD)&&(s.r=ct(e),s.t=Ze(ct((e.replace(GD,"").match(HD)||[]).join("").replace(Ar,""))),r&&(s.h=WD(VD(s.r)))),s):{t:""}}var KD=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,XD=/<(?:\w+:)?(?:si|sstItem)>/g,YD=/<\/(?:\w+:)?(?:si|sstItem)>/;function JD(e,t){var r=[],s="";if(!e)return r;var n=e.match(KD);if(n){s=n[2].replace(XD,"").split(YD);for(var a=0;a!=s.length;++a){var i=Yx(s[a].trim(),t);i!=null&&(r[r.length]=i)}n=ze(n[1]),r.Count=n.count,r.Unique=n.uniqueCount}return r}var QD=/^\s|\s$|[\t\n\r]/;function sj(e,t){if(!t.bookSST)return"";var r=[Vt];r[r.length]=ke("sst",null,{xmlns:fi[0],count:e.Count,uniqueCount:e.Unique});for(var s=0;s!=e.length;++s)if(e[s]!=null){var n=e[s],a="<si>";n.r?a+=n.r:(a+="<t",n.t||(n.t=""),n.t.match(QD)&&(a+=' xml:space="preserve"'),a+=">"+ot(n.t)+"</t>"),a+="</si>",r[r.length]=a}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function ZD(e){return[e.read_shift(4),e.read_shift(4)]}function eL(e,t){var r=[],s=!1;return Ln(e,function(a,i,l){switch(l){case 159:r.Count=a[0],r.Unique=a[1];break;case 19:r.push(a);break;case 160:return!0;case 35:s=!0;break;case 36:s=!1;break;default:if(i.T,!s||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),r}function tL(e,t){return t||(t=oe(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var rL=fI;function sL(e){var t=Yr();me(t,159,tL(e));for(var r=0;r<e.length;++r)me(t,19,rL(e[r]));return me(t,160),t.end()}function nj(e){for(var t=[],r=e.split(""),s=0;s<r.length;++s)t[s]=r[s].charCodeAt(0);return t}function jn(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function nL(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=jn(e,4),t.U=jn(e,4),t.W=jn(e,4),t}function aL(e){for(var t=e.read_shift(4),r=e.l+t-4,s={},n=e.read_shift(4),a=[];n-- >0;)a.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(s.name=e.read_shift(0,"lpp4"),s.comps=a,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return s}function iL(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(aL(e));return t}function oL(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function lL(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=jn(e,4),t.U=jn(e,4),t.W=jn(e,4),t}function cL(e){var t=lL(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function aj(e,t){var r=e.l+t,s={};s.Flags=e.read_shift(4)&63,e.l+=4,s.AlgID=e.read_shift(4);var n=!1;switch(s.AlgID){case 26126:case 26127:case 26128:n=s.Flags==36;break;case 26625:n=s.Flags==4;break;case 0:n=s.Flags==16||s.Flags==4||s.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+s.AlgID}if(!n)throw new Error("Encryption Flags/AlgID mismatch");return s.AlgIDHash=e.read_shift(4),s.KeySize=e.read_shift(4),s.ProviderType=e.read_shift(4),e.l+=8,s.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,s}function ij(e,t){var r={},s=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,s),e.l=s,r}function uL(e){var t=jn(e);switch(t.Minor){case 2:return[t.Minor,dL(e)];case 3:return[t.Minor,fL()];case 4:return[t.Minor,hL(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function dL(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),s=aj(e,r),n=ij(e,e.length-e.l);return{t:"Std",h:s,v:n}}function fL(){throw new Error("File is password-protected: ECMA-376 Extensible")}function hL(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),s={};return r.replace(Ar,function(a){var i=ze(a);switch(fn(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(l){s[l]=i[l]});break;case"<dataIntegrity":s.encryptedHmacKey=i.encryptedHmacKey,s.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":s.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":s.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":s.encs.push(i);break;default:throw i[0]}}),s}function mL(e,t){var r={},s=r.EncryptionVersionInfo=jn(e,4);if(t-=4,s.Minor!=2)throw new Error("unrecognized minor version code: "+s.Minor);if(s.Major>4||s.Major<2)throw new Error("unrecognized major version code: "+s.Major);r.Flags=e.read_shift(4),t-=4;var n=e.read_shift(4);return t-=4,r.EncryptionHeader=aj(e,n),t-=n,r.EncryptionVerifier=ij(e,t),r}function pL(e){var t={},r=t.EncryptionVersionInfo=jn(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function Jx(e){var t=0,r,s=nj(e),n=s.length+1,a,i,l,c,u;for(r=ua(n),r[0]=s.length,a=1;a!=n;++a)r[a]=s[a-1];for(a=n-1;a>=0;--a)i=r[a],l=t&16384?1:0,c=t<<1&32767,u=l|c,t=u^i;return t^52811}var oj=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],s=function(i){return(i/2|i*128)&255},n=function(i,l){return s(i^l)},a=function(i){for(var l=t[i.length-1],c=104,u=i.length-1;u>=0;--u)for(var d=i[u],f=0;f!=7;++f)d&64&&(l^=r[c]),d*=2,--c;return l};return function(i){for(var l=nj(i),c=a(l),u=l.length,d=ua(16),f=0;f!=16;++f)d[f]=0;var h,p,m;for((u&1)===1&&(h=c>>8,d[u]=n(e[0],h),--u,h=c&255,p=l[l.length-1],d[u]=n(p,h));u>0;)--u,h=c>>8,d[u]=n(l[u],h),--u,h=c&255,d[u]=n(l[u],h);for(u=15,m=15-l.length;m>0;)h=c>>8,d[u]=n(e[m],h),--u,--m,h=c&255,d[u]=n(l[u],h),--u,--m;return d}}(),xL=function(e,t,r,s,n){n||(n=t),s||(s=oj(e));var a,i;for(a=0;a!=t.length;++a)i=t[a],i^=s[r],i=(i>>5|i<<3)&255,n[a]=i,++r;return[n,r,s]},gL=function(e){var t=0,r=oj(e);return function(s){var n=xL("",s,t,r);return t=n[1],n[0]}};function vL(e,t,r,s){var n={key:Gt(e),verificationBytes:Gt(e)};return r.password&&(n.verifier=Jx(r.password)),s.valid=n.verificationBytes===n.verifier,s.valid&&(s.insitu=gL(r.password)),n}function yL(e,t,r){var s=r||{};return s.Info=e.read_shift(2),e.l-=2,s.Info===1?s.Data=pL(e):s.Data=mL(e,t),s}function wL(e,t,r){var s={Type:r.biff>=8?e.read_shift(2):0};return s.Type?yL(e,t-2,s):vL(e,r.biff>=8?t:t-2,r,s),s}var lj=function(){function e(n,a){switch(a.type){case"base64":return t(fs(n),a);case"binary":return t(n,a);case"buffer":return t(Ke&&Buffer.isBuffer(n)?n.toString("binary"):wa(n),a);case"array":return t(ai(n),a)}throw new Error("Unrecognized type "+a.type)}function t(n,a){var i=a||{},l=i.dense?[]:{},c=n.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(d,f){Array.isArray(l)&&(l[f]=[]);for(var h=/\\\w+\b/g,p=0,m,x=-1;m=h.exec(d);){switch(m[0]){case"\\cell":var g=d.slice(p,h.lastIndex-m[0].length);if(g[0]==" "&&(g=g.slice(1)),++x,g.length){var y={v:g,t:"s"};Array.isArray(l)?l[f][x]=y:l[Ue({r:f,c:x})]=y}break}p=h.lastIndex}x>u.e.c&&(u.e.c=x)}),l["!ref"]=qe(u),l}function r(n,a){return ba(e(n,a),a)}function s(n){for(var a=["{\\rtf1\\ansi"],i=et(n["!ref"]),l,c=Array.isArray(n),u=i.s.r;u<=i.e.r;++u){a.push("\\trowd\\trautofit1");for(var d=i.s.c;d<=i.e.c;++d)a.push("\\cellx"+(d+1));for(a.push("\\pard\\intbl"),d=i.s.c;d<=i.e.c;++d){var f=Ue({r:u,c:d});l=c?(n[u]||[])[d]:n[f],!(!l||l.v==null&&(!l.f||l.F))&&(a.push(" "+(l.w||(In(l),l.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:s}}();function bL(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function hc(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function _L(e){var t=e[0]/255,r=e[1]/255,s=e[2]/255,n=Math.max(t,r,s),a=Math.min(t,r,s),i=n-a;if(i===0)return[0,0,t];var l=0,c=0,u=n+a;switch(c=i/(u>1?2-u:u),n){case t:l=((r-s)/i+6)%6;break;case r:l=(s-t)/i+2;break;case s:l=(t-r)/i+4;break}return[l/6,c,u/2]}function SL(e){var t=e[0],r=e[1],s=e[2],n=r*2*(s<.5?s:1-s),a=s-n/2,i=[a,a,a],l=6*t,c;if(r!==0)switch(l|0){case 0:case 6:c=n*l,i[0]+=n,i[1]+=c;break;case 1:c=n*(2-l),i[0]+=c,i[1]+=n;break;case 2:c=n*(l-2),i[1]+=n,i[2]+=c;break;case 3:c=n*(4-l),i[1]+=c,i[2]+=n;break;case 4:c=n*(l-4),i[2]+=n,i[0]+=c;break;case 5:c=n*(6-l),i[2]+=c,i[0]+=n;break}for(var u=0;u!=3;++u)i[u]=Math.round(i[u]*255);return i}function zd(e,t){if(t===0)return e;var r=_L(bL(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),hc(SL(r))}var cj=6,kL=15,NL=1,Sr=cj;function mc(e){return Math.floor((e+Math.round(128/Sr)/256)*Sr)}function pc(e){return Math.floor((e-5)/Sr*100+.5)/100}function Vd(e){return Math.round((e*Sr+5)/Sr*256)/256}function Lf(e){return Vd(pc(mc(e)))}function Qx(e){var t=Math.abs(e-Lf(e)),r=Sr;if(t>.005)for(Sr=NL;Sr<kL;++Sr)Math.abs(e-Lf(e))<=t&&(t=Math.abs(e-Lf(e)),r=Sr);Sr=r}function da(e){e.width?(e.wpx=mc(e.width),e.wch=pc(e.wpx),e.MDW=Sr):e.wpx?(e.wch=pc(e.wpx),e.width=Vd(e.wch),e.MDW=Sr):typeof e.wch=="number"&&(e.width=Vd(e.wch),e.wpx=mc(e.width),e.MDW=Sr),e.customWidth&&delete e.customWidth}var jL=96,uj=jL;function xc(e){return e*96/uj}function No(e){return e*uj/96}var EL={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function TL(e,t,r,s){t.Borders=[];var n={},a=!1;(e[0].match(Ar)||[]).forEach(function(i){var l=ze(i);switch(fn(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":n={},l.diagonalUp&&(n.diagonalUp=mt(l.diagonalUp)),l.diagonalDown&&(n.diagonalDown=mt(l.diagonalDown)),t.Borders.push(n);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(s&&s.WTF&&!a)throw new Error("unrecognized "+l[0]+" in borders")}})}function CL(e,t,r,s){t.Fills=[];var n={},a=!1;(e[0].match(Ar)||[]).forEach(function(i){var l=ze(i);switch(fn(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":n={},t.Fills.push(n);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(n),n={};break;case"<patternFill":case"<patternFill>":l.patternType&&(n.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":n.bgColor||(n.bgColor={}),l.indexed&&(n.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(n.bgColor.theme=parseInt(l.theme,10)),l.tint&&(n.bgColor.tint=parseFloat(l.tint)),l.rgb&&(n.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":n.fgColor||(n.fgColor={}),l.theme&&(n.fgColor.theme=parseInt(l.theme,10)),l.tint&&(n.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(n.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(s&&s.WTF&&!a)throw new Error("unrecognized "+l[0]+" in fills")}})}function AL(e,t,r,s){t.Fonts=[];var n={},a=!1;(e[0].match(Ar)||[]).forEach(function(i){var l=ze(i);switch(fn(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(n),n={};break;case"<name":l.val&&(n.name=ct(l.val));break;case"<name/>":case"</name>":break;case"<b":n.bold=l.val?mt(l.val):1;break;case"<b/>":n.bold=1;break;case"<i":n.italic=l.val?mt(l.val):1;break;case"<i/>":n.italic=1;break;case"<u":switch(l.val){case"none":n.underline=0;break;case"single":n.underline=1;break;case"double":n.underline=2;break;case"singleAccounting":n.underline=33;break;case"doubleAccounting":n.underline=34;break}break;case"<u/>":n.underline=1;break;case"<strike":n.strike=l.val?mt(l.val):1;break;case"<strike/>":n.strike=1;break;case"<outline":n.outline=l.val?mt(l.val):1;break;case"<outline/>":n.outline=1;break;case"<shadow":n.shadow=l.val?mt(l.val):1;break;case"<shadow/>":n.shadow=1;break;case"<condense":n.condense=l.val?mt(l.val):1;break;case"<condense/>":n.condense=1;break;case"<extend":n.extend=l.val?mt(l.val):1;break;case"<extend/>":n.extend=1;break;case"<sz":l.val&&(n.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(n.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(n.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(n.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=jx[parseInt(l.val,10)];break;case"<color":if(n.color||(n.color={}),l.auto&&(n.color.auto=mt(l.auto)),l.rgb)n.color.rgb=l.rgb.slice(-6);else if(l.indexed){n.color.index=parseInt(l.indexed,10);var c=Ka[n.color.index];n.color.index==81&&(c=Ka[1]),c||(c=Ka[1]),n.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else l.theme&&(n.color.theme=parseInt(l.theme,10),l.tint&&(n.color.tint=parseFloat(l.tint)),l.theme&&r.themeElements&&r.themeElements.clrScheme&&(n.color.rgb=zd(r.themeElements.clrScheme[n.color.theme].rgb,n.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(s&&s.WTF&&!a)throw new Error("unrecognized "+l[0]+" in fonts")}})}function FL(e,t,r){t.NumberFmt=[];for(var s=Dt(Be),n=0;n<s.length;++n)t.NumberFmt[s[n]]=Be[s[n]];var a=e[0].match(Ar);if(a)for(n=0;n<a.length;++n){var i=ze(a[n]);switch(fn(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=Ze(ct(i.formatCode)),c=parseInt(i.numFmtId,10);if(t.NumberFmt[c]=l,c>0){if(c>392){for(c=392;c>60&&t.NumberFmt[c]!=null;--c);t.NumberFmt[c]=l}Nn(l,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}function PL(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var s=r[0];s<=r[1];++s)e[s]!=null&&(t[t.length]=ke("numFmt",null,{numFmtId:s,formatCode:ot(e[s])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=ke("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Eu=["numFmtId","fillId","fontId","borderId","xfId"],Tu=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function RL(e,t,r){t.CellXf=[];var s,n=!1;(e[0].match(Ar)||[]).forEach(function(a){var i=ze(a),l=0;switch(fn(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(s=i,delete s[0],l=0;l<Eu.length;++l)s[Eu[l]]&&(s[Eu[l]]=parseInt(s[Eu[l]],10));for(l=0;l<Tu.length;++l)s[Tu[l]]&&(s[Tu[l]]=mt(s[Tu[l]]));if(t.NumberFmt&&s.numFmtId>392){for(l=392;l>60;--l)if(t.NumberFmt[s.numFmtId]==t.NumberFmt[l]){s.numFmtId=l;break}}t.CellXf.push(s);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};i.vertical&&(c.vertical=i.vertical),i.horizontal&&(c.horizontal=i.horizontal),i.textRotation!=null&&(c.textRotation=i.textRotation),i.indent&&(c.indent=i.indent),i.wrapText&&(c.wrapText=mt(i.wrapText)),s.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":n=!0;break;case"</AlternateContent>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(r&&r.WTF&&!n)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}function IL(e){var t=[];return t[t.length]=ke("cellXfs",null),e.forEach(function(r){t[t.length]=ke("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=ke("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var OL=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,s=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,n=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,c,u){var d={};if(!l)return d;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=l.match(t))&&FL(f,d,u),(f=l.match(n))&&AL(f,d,c,u),(f=l.match(s))&&CL(f,d,c,u),(f=l.match(a))&&TL(f,d,c,u),(f=l.match(r))&&RL(f,d,u),d}}();function dj(e,t){var r=[Vt,ke("styleSheet",null,{xmlns:fi[0],"xmlns:vt":Zt.vt})],s;return e.SSF&&(s=PL(e.SSF))!=null&&(r[r.length]=s),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(s=IL(t.cellXfs))&&(r[r.length]=s),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function DL(e,t){var r=e.read_shift(2),s=Er(e);return[r,s]}function LL(e,t,r){r||(r=oe(6+4*t.length)),r.write_shift(2,e),ar(t,r);var s=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),s}function ML(e,t,r){var s={};s.sz=e.read_shift(2)/20;var n=yI(e);n.fItalic&&(s.italic=1),n.fCondense&&(s.condense=1),n.fExtend&&(s.extend=1),n.fShadow&&(s.shadow=1),n.fOutline&&(s.outline=1),n.fStrikeout&&(s.strike=1);var a=e.read_shift(2);switch(a===700&&(s.bold=1),e.read_shift(2)){case 1:s.vertAlign="superscript";break;case 2:s.vertAlign="subscript";break}var i=e.read_shift(1);i!=0&&(s.underline=i);var l=e.read_shift(1);l>0&&(s.family=l);var c=e.read_shift(1);switch(c>0&&(s.charset=c),e.l++,s.color=vI(e),e.read_shift(1)){case 1:s.scheme="major";break;case 2:s.scheme="minor";break}return s.name=Er(e),s}function BL(e,t){t||(t=oe(25+4*32)),t.write_shift(2,e.sz*20),wI(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Bd(e.color,t);var s=0;return s=2,t.write_shift(1,s),ar(e.name,t),t.length>t.l?t.slice(0,t.l):t}var UL=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Mf,$L=Cr;function fw(e,t){t||(t=oe(4*3+8*7+16*1)),Mf||(Mf=v0(UL));var r=Mf[e.patternType];r==null&&(r=40),t.write_shift(4,r);var s=0;if(r!=40)for(Bd({auto:1},t),Bd({auto:1},t);s<12;++s)t.write_shift(4,0);else{for(;s<4;++s)t.write_shift(4,0);for(;s<12;++s)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function zL(e,t){var r=e.l+t,s=e.read_shift(2),n=e.read_shift(2);return e.l=r,{ixfe:s,numFmtId:n}}function fj(e,t,r){r||(r=oe(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var s=0;return r.write_shift(1,s),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Zo(e,t){return t||(t=oe(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var VL=Cr;function WL(e,t){return t||(t=oe(51)),t.write_shift(1,0),Zo(null,t),Zo(null,t),Zo(null,t),Zo(null,t),Zo(null,t),t.length>t.l?t.slice(0,t.l):t}function HL(e,t){return t||(t=oe(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),Md(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function qL(e,t,r){var s=oe(2052);return s.write_shift(4,e),Md(t,s),Md(r,s),s.length>s.l?s.slice(0,s.l):s}function GL(e,t,r){var s={};s.NumberFmt=[];for(var n in Be)s.NumberFmt[n]=Be[n];s.CellXf=[],s.Fonts=[];var a=[],i=!1;return Ln(e,function(c,u,d){switch(d){case 44:s.NumberFmt[c[0]]=c[1],Nn(c[1],c[0]);break;case 43:s.Fonts.push(c),c.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(c.color.rgb=zd(t.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&s.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:a.push(d),i=!0;break;case 38:a.pop(),i=!1;break;default:if(u.T>0)a.push(d);else if(u.T<0)a.pop();else if(!i||r.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),s}function KL(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var n=s[0];n<=s[1];++n)t[n]!=null&&++r}),r!=0&&(me(e,615,Qs(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var n=s[0];n<=s[1];++n)t[n]!=null&&me(e,44,LL(n,t[n]))}),me(e,616))}}function XL(e){var t=1;me(e,611,Qs(t)),me(e,43,BL({sz:12,color:{theme:1},name:"Calibri",family:2})),me(e,612)}function YL(e){var t=2;me(e,603,Qs(t)),me(e,45,fw({patternType:"none"})),me(e,45,fw({patternType:"gray125"})),me(e,604)}function JL(e){var t=1;me(e,613,Qs(t)),me(e,46,WL()),me(e,614)}function QL(e){var t=1;me(e,626,Qs(t)),me(e,47,fj({numFmtId:0},65535)),me(e,627)}function ZL(e,t){me(e,617,Qs(t.length)),t.forEach(function(r){me(e,47,fj(r,0))}),me(e,618)}function eM(e){var t=1;me(e,619,Qs(t)),me(e,48,HL({xfId:0,name:"Normal"})),me(e,620)}function tM(e){var t=0;me(e,505,Qs(t)),me(e,506)}function rM(e){var t=0;me(e,508,qL(t,"TableStyleMedium9","PivotStyleMedium4")),me(e,509)}function sM(e,t){var r=Yr();return me(r,278),KL(r,e.SSF),XL(r),YL(r),JL(r),QL(r),ZL(r,t.cellXfs),eM(r),tM(r),rM(r),me(r,279),r.end()}var nM=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function aM(e,t,r){t.themeElements.clrScheme=[];var s={};(e[0].match(Ar)||[]).forEach(function(n){var a=ze(n);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":s.rgb=a.val;break;case"<a:sysClr":s.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(t.themeElements.clrScheme[nM.indexOf(a[0])]=s,s={}):s.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function iM(){}function oM(){}var lM=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,cM=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,uM=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function dM(e,t,r){t.themeElements={};var s;[["clrScheme",lM,aM],["fontScheme",cM,iM],["fmtScheme",uM,oM]].forEach(function(n){if(!(s=e.match(n[1])))throw new Error(n[0]+" not found in themeElements");n[2](s,t,r)})}var fM=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function hj(e,t){(!e||e.length===0)&&(e=Zx());var r,s={};if(!(r=e.match(fM)))throw new Error("themeElements not found in theme");return dM(r[0],s,t),s.raw=e,s}function Zx(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Vt];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function hM(e,t,r){var s=e.l+t,n=e.read_shift(4);if(n!==124226){if(!r.cellStyles){e.l=s;return}var a=e.slice(e.l);e.l=s;var i;try{i=aN(a,{type:"array"})}catch{return}var l=os(i,"theme/theme/theme1.xml",!0);if(l)return hj(l,r)}}function mM(e){return e.read_shift(4)}function pM(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=xM(e,4);break;case 2:t.xclrValue=qN(e);break;case 3:t.xclrValue=mM(e);break;case 4:e.l+=4;break}return e.l+=8,t}function xM(e,t){return Cr(e,t)}function gM(e,t){return Cr(e,t)}function vM(e){var t=e.read_shift(2),r=e.read_shift(2)-4,s=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:s[1]=pM(e);break;case 6:s[1]=gM(e,r);break;case 14:case 15:s[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return s}function yM(e,t){var r=e.l+t;e.l+=2;var s=e.read_shift(2);e.l+=2;for(var n=e.read_shift(2),a=[];n-- >0;)a.push(vM(e,r-e.l));return{ixfe:s,ext:a}}function wM(e,t){t.forEach(function(r){switch(r[0]){}})}function bM(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Er(e)}}function _M(e){var t=oe(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),ar(e.name,t),t.slice(0,t.l)}function SM(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function kM(e){var t=oe(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function NM(e,t){var r=oe(8+2*t.length);return r.write_shift(4,e),ar(t,r),r.slice(0,r.l)}function jM(e){return e.l+=4,e.read_shift(4)!=0}function EM(e,t){var r=oe(8);return r.write_shift(4,e),r.write_shift(4,1),r}function TM(e,t,r){var s={Types:[],Cell:[],Value:[]},n=r||{},a=[],i=!1,l=2;return Ln(e,function(c,u,d){switch(d){case 335:s.Types.push({name:c.name});break;case 51:c.forEach(function(f){l==1?s.Cell.push({type:s.Types[f[0]-1].name,index:f[1]}):l==0&&s.Value.push({type:s.Types[f[0]-1].name,index:f[1]})});break;case 337:l=c?1:0;break;case 338:l=2;break;case 35:a.push(d),i=!0;break;case 36:a.pop(),i=!1;break;default:if(!u.T){if(!i||n.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),s}function CM(){var e=Yr();return me(e,332),me(e,334,Qs(1)),me(e,335,_M({name:"XLDAPR",version:12e4,flags:3496657072})),me(e,336),me(e,339,NM(1,"XLDAPR")),me(e,52),me(e,35,Qs(514)),me(e,4096,Qs(0)),me(e,4097,ks(1)),me(e,36),me(e,53),me(e,340),me(e,337,EM(1)),me(e,51,kM([[1,0]])),me(e,338),me(e,333),e.end()}function AM(e,t,r){var s={Types:[],Cell:[],Value:[]};if(!e)return s;var n=!1,a=2,i;return e.replace(Ar,function(l){var c=ze(l);switch(fn(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":s.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<s.Types.length;++u)s.Types[u].name==c.name&&(i=s.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?s.Cell.push({type:s.Types[c.t-1].name,index:+c.v}):a==0&&s.Value.push({type:s.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+c.i);break;default:if(!n&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return l}),s}function mj(){var e=[Vt];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function FM(e){var t=[];if(!e)return t;var r=1;return(e.match(Ar)||[]).forEach(function(s){var n=ze(s);switch(n[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete n[0],n.i?r=n.i:n.i=r,t.push(n);break}}),t}function PM(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Ue(r);var s=e.read_shift(1);return s&2&&(t.l="1"),s&8&&(t.a="1"),t}function RM(e,t,r){var s=[];return Ln(e,function(a,i,l){switch(l){case 63:s.push(a);break;default:if(!i.T)throw new Error("Unexpected record 0x"+l.toString(16))}}),s}function IM(e,t,r,s){if(!e)return e;var n=s||{},a=!1;Ln(e,function(l,c,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!c.T){if(!a||n.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},n)}function OM(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var Xi=1024;function pj(e,t){for(var r=[21600,21600],s=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),n=[ke("xml",null,{"xmlns:v":rs.v,"xmlns:o":rs.o,"xmlns:x":rs.x,"xmlns:mv":rs.mv}).replace(/\/>/,">"),ke("o:shapelayout",ke("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),ke("v:shapetype",[ke("v:stroke",null,{joinstyle:"miter"}),ke("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:s})];Xi<e*1e3;)Xi+=1e3;return t.forEach(function(a){var i=Ct(a[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var c=l.type=="gradient"?ke("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=ke("v:fill",c,l),d={on:"t",obscured:"t"};++Xi,n=n.concat(["<v:shape"+uc({id:"_x0000_s"+Xi,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(a[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,ke("v:shadow",null,d),ke("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",fr("x:Anchor",[i.c+1,0,i.r+1,0,i.c+3,20,i.r+5,20].join(",")),fr("x:AutoFill","False"),fr("x:Row",String(i.r)),fr("x:Column",String(i.c)),a[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),n.push("</xml>"),n.join("")}function hw(e,t,r,s){var n=Array.isArray(e),a;t.forEach(function(i){var l=Ct(i.ref);if(n?(e[l.r]||(e[l.r]=[]),a=e[l.r][l.c]):a=e[i.ref],!a){a={t:"z"},n?e[l.r][l.c]=a:e[i.ref]=a;var c=et(e["!ref"]||"BDWGO1000001:A1");c.s.r>l.r&&(c.s.r=l.r),c.e.r<l.r&&(c.e.r=l.r),c.s.c>l.c&&(c.s.c=l.c),c.e.c<l.c&&(c.e.c=l.c);var u=qe(c);u!==e["!ref"]&&(e["!ref"]=u)}a.c||(a.c=[]);var d={a:i.author,t:i.t,r:i.r,T:r};i.h&&(d.h=i.h);for(var f=a.c.length-1;f>=0;--f){if(!r&&a.c[f].T)return;r&&!a.c[f].T&&a.c.splice(f,1)}if(r&&s){for(f=0;f<s.length;++f)if(d.a==s[f].id){d.a=s[f].name||d.a;break}}a.c.push(d)})}function DM(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],s=[],n=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);n&&n[1]&&n[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var l=i.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&r.push(l[1])}});var a=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var l=i.match(/<(?:\w+:)?comment[^>]*>/);if(l){var c=ze(l[0]),u={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},d=Ct(c.ref);if(!(t.sheetRows&&t.sheetRows<=d.r)){var f=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!f&&!!f[1]&&Yx(f[1])||{r:"",t:"",h:""};u.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),u.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(u.h=h.h),s.push(u)}}}}),s}function xj(e){var t=[Vt,ke("comments",null,{xmlns:fi[0]})],r=[];return t.push("<authors>"),e.forEach(function(s){s[1].forEach(function(n){var a=ot(n.a);r.indexOf(a)==-1&&(r.push(a),t.push("<author>"+a+"</author>")),n.T&&n.ID&&r.indexOf("tc="+n.ID)==-1&&(r.push("tc="+n.ID),t.push("<author>tc="+n.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(s){var n=0,a=[];if(s[1][0]&&s[1][0].T&&s[1][0].ID?n=r.indexOf("tc="+s[1][0].ID):s[1].forEach(function(c){c.a&&(n=r.indexOf(ot(c.a))),a.push(c.t||"")}),t.push('<comment ref="'+s[0]+'" authorId="'+n+'"><text>'),a.length<=1)t.push(fr("t",ot(a[0]||"")));else{for(var i=`Comment:
    `+a[0]+`
`,l=1;l<a.length;++l)i+=`Reply:
    `+a[l]+`
`;t.push(fr("t",ot(i)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function LM(e,t){var r=[],s=!1,n={},a=0;return e.replace(Ar,function(l,c){var u=ze(l);switch(fn(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":n={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":n.t!=null&&r.push(n);break;case"<text>":case"<text":a=c+l.length;break;case"</text>":n.t=e.slice(a,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":s=!0;break;case"</mentions>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(!s&&t.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return l}),r}function MM(e,t,r){var s=[Vt,ke("ThreadedComments",null,{xmlns:Zt.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(n){var a="";(n[1]||[]).forEach(function(i,l){if(!i.T){delete i.ID;return}i.a&&t.indexOf(i.a)==-1&&t.push(i.a);var c={ref:n[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};l==0?a=c.id:c.parentId=a,i.ID=c.id,i.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(i.a)).slice(-12)+"}"),s.push(ke("threadedComment",fr("text",i.t||""),c))})}),s.push("</ThreadedComments>"),s.join("")}function BM(e,t){var r=[],s=!1;return e.replace(Ar,function(a){var i=ze(a);switch(fn(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(!s&&t.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return a}),r}function UM(e){var t=[Vt,ke("personList",null,{xmlns:Zt.TCMNT,"xmlns:x":fi[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,s){t.push(ke("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+s).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function $M(e){var t={};t.iauthor=e.read_shift(4);var r=xi(e);return t.rfx=r.s,t.ref=Ue(r.s),e.l+=16,t}function zM(e,t){return t==null&&(t=oe(36)),t.write_shift(4,e[1].iauthor),Bo(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var VM=Er;function WM(e){return ar(e.slice(0,54))}function HM(e,t){var r=[],s=[],n={},a=!1;return Ln(e,function(l,c,u){switch(u){case 632:s.push(l);break;case 635:n=l;break;case 637:n.t=l.t,n.h=l.h,n.r=l.r;break;case 636:if(n.author=s[n.iauthor],delete n.iauthor,t.sheetRows&&n.rfx&&t.sheetRows<=n.rfx.r)break;n.t||(n.t=""),delete n.rfx,r.push(n);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!a||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}function qM(e){var t=Yr(),r=[];return me(t,628),me(t,630),e.forEach(function(s){s[1].forEach(function(n){r.indexOf(n.a)>-1||(r.push(n.a.slice(0,54)),me(t,632,WM(n.a)))})}),me(t,631),me(t,633),e.forEach(function(s){s[1].forEach(function(n){n.iauthor=r.indexOf(n.a);var a={s:Ct(s[0]),e:Ct(s[0])};me(t,635,zM([a,n])),n.t&&n.t.length>0&&me(t,637,mI(n)),me(t,636),delete n.iauthor})}),me(t,634),me(t,629),t.end()}var GM="application/vnd.ms-office.vbaProject";function KM(e){var t=De.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,s){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var n=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");De.utils.cfb_add(t,n,e.FileIndex[s].content)}}),De.write(t)}function XM(e,t){t.FullPaths.forEach(function(r,s){if(s!=0){var n=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");n.slice(-1)!=="/"&&De.utils.cfb_add(e,n,t.FileIndex[s].content)}})}var gj=["xlsb","xlsm","xlam","biff8","xla"];function YM(){return{"!type":"dialog"}}function JM(){return{"!type":"dialog"}}function QM(){return{"!type":"macro"}}function ZM(){return{"!type":"macro"}}var io=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(s,n,a,i){var l=!1,c=!1;a.length==0?c=!0:a.charAt(0)=="["&&(c=!0,a=a.slice(1,-1)),i.length==0?l=!0:i.charAt(0)=="["&&(l=!0,i=i.slice(1,-1));var u=a.length>0?parseInt(a,10)|0:0,d=i.length>0?parseInt(i,10)|0:0;return l?d+=t.c:--d,c?u+=t.r:--u,n+(l?"":"$")+Tt(d)+(c?"":"$")+zt(u)}return function(n,a){return t=a,n.replace(e,r)}}(),eg=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,tg=function(){return function(t,r){return t.replace(eg,function(s,n,a,i,l,c){var u=$x(i)-(a?0:r.c),d=Ux(c)-(l?0:r.r),f=d==0?"":l?d+1:"["+d+"]",h=u==0?"":a?u+1:"["+u+"]";return n+"R"+f+"C"+h})}}();function vj(e,t){return e.replace(eg,function(r,s,n,a,i,l){return s+(n=="$"?n+a:Tt($x(a)+t.c))+(i=="$"?i+l:zt(Ux(l)+t.r))})}function e7(e,t,r){var s=Jr(t),n=s.s,a=Ct(r),i={r:a.r-n.r,c:a.c-n.c};return vj(e,i)}function t7(e){return e.length!=1}function mw(e){return e.replace(/_xlfn\./g,"")}function Ht(e){e.l+=1}function fa(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function yj(e,t,r){var s=2;if(r){if(r.biff>=2&&r.biff<=5)return wj(e);r.biff==12&&(s=4)}var n=e.read_shift(s),a=e.read_shift(s),i=fa(e),l=fa(e);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:l[0],cRel:l[1],rRel:l[2]}}}function wj(e){var t=fa(e),r=fa(e),s=e.read_shift(1),n=e.read_shift(1);return{s:{r:t[0],c:s,cRel:t[1],rRel:t[2]},e:{r:r[0],c:n,cRel:r[1],rRel:r[2]}}}function r7(e,t,r){if(r.biff<8)return wj(e);var s=e.read_shift(r.biff==12?4:2),n=e.read_shift(r.biff==12?4:2),a=fa(e),i=fa(e);return{s:{r:s,c:a[0],cRel:a[1],rRel:a[2]},e:{r:n,c:i[0],cRel:i[1],rRel:i[2]}}}function bj(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return s7(e);var s=e.read_shift(r&&r.biff==12?4:2),n=fa(e);return{r:s,c:n[0],cRel:n[1],rRel:n[2]}}function s7(e){var t=fa(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function n7(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function a7(e,t,r){var s=r&&r.biff?r.biff:8;if(s>=2&&s<=5)return i7(e);var n=e.read_shift(s>=12?4:2),a=e.read_shift(2),i=(a&16384)>>14,l=(a&32768)>>15;if(a&=16383,l==1)for(;n>524287;)n-=1048576;if(i==1)for(;a>8191;)a=a-16384;return{r:n,c:a,cRel:i,rRel:l}}function i7(e){var t=e.read_shift(2),r=e.read_shift(1),s=(t&32768)>>15,n=(t&16384)>>14;return t&=16383,s==1&&t>=8192&&(t=t-16384),n==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:n,rRel:s}}function o7(e,t,r){var s=(e[e.l++]&96)>>5,n=yj(e,r.biff>=2&&r.biff<=5?6:8,r);return[s,n]}function l7(e,t,r){var s=(e[e.l++]&96)>>5,n=e.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}var i=yj(e,a,r);return[s,n,i]}function c7(e,t,r){var s=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[s]}function u7(e,t,r){var s=(e[e.l++]&96)>>5,n=e.read_shift(2),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}return e.l+=a,[s,n]}function d7(e,t,r){var s=(e[e.l++]&96)>>5,n=r7(e,t-1,r);return[s,n]}function f7(e,t,r){var s=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[s]}function pw(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function h7(e,t,r){e.l+=2;for(var s=e.read_shift(r&&r.biff==2?1:2),n=[],a=0;a<=s;++a)n.push(e.read_shift(r&&r.biff==2?1:2));return n}function m7(e,t,r){var s=e[e.l+1]&255?1:0;return e.l+=2,[s,e.read_shift(r&&r.biff==2?1:2)]}function p7(e,t,r){var s=e[e.l+1]&255?1:0;return e.l+=2,[s,e.read_shift(r&&r.biff==2?1:2)]}function x7(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function g7(e,t,r){var s=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[s]}function _j(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function v7(e){return e.read_shift(2),_j(e)}function y7(e){return e.read_shift(2),_j(e)}function w7(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var n=bj(e,0,r);return[s,n]}function b7(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var n=a7(e,0,r);return[s,n]}function _7(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var a=bj(e,0,r);return[s,n,a]}function S7(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(r&&r.biff<=3?1:2);return[j9[n],Nj[n],s]}function k7(e,t,r){var s=e[e.l++],n=e.read_shift(1),a=r&&r.biff<=3?[s==88?-1:0,e.read_shift(1)]:N7(e);return[n,(a[0]===0?Nj:N9)[a[1]]]}function N7(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function j7(e,t,r){e.l+=r&&r.biff==2?3:4}function E7(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var s=e.read_shift(2),n=e.read_shift(r&&r.biff==2?1:2);return[s,n]}function T7(e){return e.l++,Mn[e.read_shift(1)]}function C7(e){return e.l++,e.read_shift(2)}function A7(e){return e.l++,e.read_shift(1)!==0}function F7(e){return e.l++,Nr(e)}function P7(e,t,r){return e.l++,Oc(e,t-1,r)}function R7(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Mt(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Mn[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Nr(e);break;case 2:r[1]=gi(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function I7(e,t,r){for(var s=e.read_shift(r.biff==12?4:2),n=[],a=0;a!=s;++a)n.push((r.biff==12?xi:b0)(e));return n}function O7(e,t,r){var s=0,n=0;r.biff==12?(s=e.read_shift(4),n=e.read_shift(4)):(n=1+e.read_shift(1),s=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--s,--n==0&&(n=256));for(var a=0,i=[];a!=s&&(i[a]=[]);++a)for(var l=0;l!=n;++l)i[a][l]=R7(e,r.biff);return i}function D7(e,t,r){var s=e.read_shift(1)>>>5&3,n=!r||r.biff>=8?4:2,a=e.read_shift(n);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[s,0,a]}function L7(e,t,r){if(r.biff==5)return M7(e);var s=e.read_shift(1)>>>5&3,n=e.read_shift(2),a=e.read_shift(4);return[s,n,a]}function M7(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var s=e.read_shift(2);return e.l+=12,[t,r,s]}function B7(e,t,r){var s=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var n=e.read_shift(r&&r.biff==2?1:2);return[s,n]}function U7(e,t,r){var s=e.read_shift(1)>>>5&3,n=e.read_shift(r&&r.biff==2?1:2);return[s,n]}function $7(e,t,r){var s=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[s]}function z7(e,t,r){var s=(e[e.l++]&96)>>5,n=e.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return e.l+=a,[s,n]}var V7=Cr,W7=Cr,H7=Cr;function Lc(e,t,r){return e.l+=2,[n7(e)]}function rg(e){return e.l+=6,[]}var q7=Lc,G7=rg,K7=rg,X7=Lc;function Sj(e){return e.l+=2,[Gt(e),e.read_shift(2)&1]}var Y7=Lc,J7=Sj,Q7=rg,Z7=Lc,e9=Lc,t9=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function r9(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(4),n=e.read_shift(2),a=e.read_shift(2),i=t9[r>>2&31];return{ixti:t,coltype:r&3,rt:i,idx:s,c:n,C:a}}function s9(e){return e.l+=2,[e.read_shift(4)]}function n9(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function a9(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function i9(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function o9(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function l9(e){return e.l+=4,[0,0]}var xw={1:{n:"PtgExp",f:E7},2:{n:"PtgTbl",f:H7},3:{n:"PtgAdd",f:Ht},4:{n:"PtgSub",f:Ht},5:{n:"PtgMul",f:Ht},6:{n:"PtgDiv",f:Ht},7:{n:"PtgPower",f:Ht},8:{n:"PtgConcat",f:Ht},9:{n:"PtgLt",f:Ht},10:{n:"PtgLe",f:Ht},11:{n:"PtgEq",f:Ht},12:{n:"PtgGe",f:Ht},13:{n:"PtgGt",f:Ht},14:{n:"PtgNe",f:Ht},15:{n:"PtgIsect",f:Ht},16:{n:"PtgUnion",f:Ht},17:{n:"PtgRange",f:Ht},18:{n:"PtgUplus",f:Ht},19:{n:"PtgUminus",f:Ht},20:{n:"PtgPercent",f:Ht},21:{n:"PtgParen",f:Ht},22:{n:"PtgMissArg",f:Ht},23:{n:"PtgStr",f:P7},26:{n:"PtgSheet",f:n9},27:{n:"PtgEndSheet",f:a9},28:{n:"PtgErr",f:T7},29:{n:"PtgBool",f:A7},30:{n:"PtgInt",f:C7},31:{n:"PtgNum",f:F7},32:{n:"PtgArray",f:f7},33:{n:"PtgFunc",f:S7},34:{n:"PtgFuncVar",f:k7},35:{n:"PtgName",f:D7},36:{n:"PtgRef",f:w7},37:{n:"PtgArea",f:o7},38:{n:"PtgMemArea",f:B7},39:{n:"PtgMemErr",f:V7},40:{n:"PtgMemNoMem",f:W7},41:{n:"PtgMemFunc",f:U7},42:{n:"PtgRefErr",f:$7},43:{n:"PtgAreaErr",f:c7},44:{n:"PtgRefN",f:b7},45:{n:"PtgAreaN",f:d7},46:{n:"PtgMemAreaN",f:i9},47:{n:"PtgMemNoMemN",f:o9},57:{n:"PtgNameX",f:L7},58:{n:"PtgRef3d",f:_7},59:{n:"PtgArea3d",f:l7},60:{n:"PtgRefErr3d",f:z7},61:{n:"PtgAreaErr3d",f:u7},255:{}},c9={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},u9={1:{n:"PtgElfLel",f:Sj},2:{n:"PtgElfRw",f:Z7},3:{n:"PtgElfCol",f:q7},6:{n:"PtgElfRwV",f:e9},7:{n:"PtgElfColV",f:X7},10:{n:"PtgElfRadical",f:Y7},11:{n:"PtgElfRadicalS",f:Q7},13:{n:"PtgElfColS",f:G7},15:{n:"PtgElfColSV",f:K7},16:{n:"PtgElfRadicalLel",f:J7},25:{n:"PtgList",f:r9},29:{n:"PtgSxName",f:s9},255:{}},d9={0:{n:"PtgAttrNoop",f:l9},1:{n:"PtgAttrSemi",f:g7},2:{n:"PtgAttrIf",f:p7},4:{n:"PtgAttrChoose",f:h7},8:{n:"PtgAttrGoto",f:m7},16:{n:"PtgAttrSum",f:j7},32:{n:"PtgAttrBaxcel",f:pw},33:{n:"PtgAttrBaxcel",f:pw},64:{n:"PtgAttrSpace",f:v7},65:{n:"PtgAttrSpaceSemi",f:y7},128:{n:"PtgAttrIfError",f:x7},255:{}};function Mc(e,t,r,s){if(s.biff<8)return Cr(e,t);for(var n=e.l+t,a=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=O7(e,0,s),a.push(r[i][1]);break;case"PtgMemArea":r[i][2]=I7(e,r[i][1],s),a.push(r[i][2]);break;case"PtgExp":s&&s.biff==12&&(r[i][1][1]=e.read_shift(4),a.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return t=n-e.l,t!==0&&a.push(Cr(e,t)),a}function Bc(e,t,r){for(var s=e.l+t,n,a,i=[];s!=e.l;)t=s-e.l,a=e[e.l],n=xw[a]||xw[c9[a]],(a===24||a===25)&&(n=(a===24?u9:d9)[e[e.l+1]]),!n||!n.f?Cr(e,t):i.push([n.n,n.f(e,t,r)]);return i}function f9(e){for(var t=[],r=0;r<e.length;++r){for(var s=e[r],n=[],a=0;a<s.length;++a){var i=s[a];if(i)switch(i[0]){case 2:n.push('"'+i[1].replace(/"/g,'""')+'"');break;default:n.push(i[1])}else n.push("")}t.push(n.join(","))}return t.join(";")}var h9={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function m9(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function kj(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var s=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!s)return"SH33TJSERR1";var n="";if(r.biff>8)switch(e[s[0]][0]){case 357:return n=s[1]==-1?"#REF":e.SheetNames[s[1]],s[1]==s[2]?n:n+":"+e.SheetNames[s[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[s[0]][0];case 355:default:return"SH33TJSSRC"+e[s[0]][0]}switch(e[s[0]][0][0]){case 1025:return n=s[1]==-1?"#REF":e.SheetNames[s[1]]||"SH33TJSERR3",s[1]==s[2]?n:n+":"+e.SheetNames[s[2]];case 14849:return e[s[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return e[s[0]][0][3]?(n=s[1]==-1?"#REF":e[s[0]][0][3][s[1]]||"SH33TJSERR4",s[1]==s[2]?n:n+":"+e[s[0]][0][3][s[2]]):"SH33TJSERR2"}}function gw(e,t,r){var s=kj(e,t,r);return s=="#REF"?s:m9(s,r)}function br(e,t,r,s,n){var a=n&&n.biff||8,i={s:{c:0,r:0}},l=[],c,u,d,f=0,h=0,p,m="";if(!e[0]||!e[0][0])return"";for(var x=-1,g="",y=0,w=e[0].length;y<w;++y){var v=e[0][y];switch(v[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=l.pop(),u=l.pop(),x>=0){switch(e[0][x][1][0]){case 0:g=It(" ",e[0][x][1][1]);break;case 1:g=It("\r",e[0][x][1][1]);break;default:if(g="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}u=u+g,x=-1}l.push(u+h9[v[0]]+c);break;case"PtgIsect":c=l.pop(),u=l.pop(),l.push(u+" "+c);break;case"PtgUnion":c=l.pop(),u=l.pop(),l.push(u+","+c);break;case"PtgRange":c=l.pop(),u=l.pop(),l.push(u+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=jl(v[1][1],i,n),l.push(El(d,a));break;case"PtgRefN":d=r?jl(v[1][1],r,n):v[1][1],l.push(El(d,a));break;case"PtgRef3d":f=v[1][1],d=jl(v[1][2],i,n),m=gw(s,f,n),l.push(m+"!"+El(d,a));break;case"PtgFunc":case"PtgFuncVar":var b=v[1][0],_=v[1][1];b||(b=0),b&=127;var k=b==0?[]:l.slice(-b);l.length-=b,_==="User"&&(_=k.shift()),l.push(_+"("+k.join(",")+")");break;case"PtgBool":l.push(v[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(v[1]);break;case"PtgNum":l.push(String(v[1]));break;case"PtgStr":l.push('"'+v[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(v[1]);break;case"PtgAreaN":p=q1(v[1][1],r?{s:r}:i,n),l.push(If(p,n));break;case"PtgArea":p=q1(v[1][1],i,n),l.push(If(p,n));break;case"PtgArea3d":f=v[1][1],p=v[1][2],m=gw(s,f,n),l.push(m+"!"+If(p,n));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=v[1][2];var S=(s.names||[])[h-1]||(s[0]||[])[h],E=S?S.Name:"SH33TJSNAME"+String(h);E&&E.slice(0,6)=="_xlfn."&&!n.xlfn&&(E=E.slice(6)),l.push(E);break;case"PtgNameX":var C=v[1][1];h=v[1][2];var U;if(n.biff<=5)C<0&&(C=-C),s[C]&&(U=s[C][h]);else{var H="";if(((s[C]||[])[0]||[])[0]==14849||(((s[C]||[])[0]||[])[0]==1025?s[C][h]&&s[C][h].itab>0&&(H=s.SheetNames[s[C][h].itab-1]+"!"):H=s.SheetNames[h-1]+"!"),s[C]&&s[C][h])H+=s[C][h].Name;else if(s[0]&&s[0][h])H+=s[0][h].Name;else{var W=(kj(s,C,n)||"").split(";;");W[h-1]?H=W[h-1]:H+="SH33TJSERRX"}l.push(H);break}U||(U={Name:"SH33TJSERRY"}),l.push(U.Name);break;case"PtgParen":var q="(",z=")";if(x>=0){switch(g="",e[0][x][1][0]){case 2:q=It(" ",e[0][x][1][1])+q;break;case 3:q=It("\r",e[0][x][1][1])+q;break;case 4:z=It(" ",e[0][x][1][1])+z;break;case 5:z=It("\r",e[0][x][1][1])+z;break;default:if(n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}x=-1}l.push(q+l.pop()+z);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":d={c:v[1][1],r:v[1][0]};var Q={c:r.c,r:r.r};if(s.sharedf[Ue(d)]){var L=s.sharedf[Ue(d)];l.push(br(L,i,Q,s,n))}else{var X=!1;for(c=0;c!=s.arrayf.length;++c)if(u=s.arrayf[c],!(d.c<u[0].s.c||d.c>u[0].e.c)&&!(d.r<u[0].s.r||d.r>u[0].e.r)){l.push(br(u[1],i,Q,s,n)),X=!0;break}X||l.push(v[1])}break;case"PtgArray":l.push("{"+f9(v[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=y;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+v[1].idx+"[#"+v[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(v));default:throw new Error("Unrecognized Formula Token: "+String(v))}var K=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(n.biff!=3&&x>=0&&K.indexOf(e[0][y][0])==-1){v=e[0][x];var V=!0;switch(v[1][0]){case 4:V=!1;case 0:g=It(" ",v[1][1]);break;case 5:V=!1;case 1:g=It("\r",v[1][1]);break;default:if(g="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+v[1][0])}l.push((V?g:"")+l.pop()+(V?"":g)),x=-1}}if(l.length>1&&n.WTF)throw new Error("bad formula stack");return l[0]}function p9(e,t,r){var s=e.l+t,n=r.biff==2?1:2,a,i=e.read_shift(n);if(i==65535)return[[],Cr(e,t-2)];var l=Bc(e,i,r);return t!==i+n&&(a=Mc(e,t-i-n,l,r)),e.l=s,[l,a]}function x9(e,t,r){var s=e.l+t,n=r.biff==2?1:2,a,i=e.read_shift(n);if(i==65535)return[[],Cr(e,t-2)];var l=Bc(e,i,r);return t!==i+n&&(a=Mc(e,t-i-n,l,r)),e.l=s,[l,a]}function g9(e,t,r,s){var n=e.l+t,a=Bc(e,s,r),i;return n!==e.l&&(i=Mc(e,n-e.l,a,r)),[a,i]}function v9(e,t,r){var s=e.l+t,n,a=e.read_shift(2),i=Bc(e,a,r);return a==65535?[[],Cr(e,t-2)]:(t!==a+2&&(n=Mc(e,s-a-2,i,r)),[i,n])}function y9(e){var t;if(_n(e,e.l+6)!==65535)return[Nr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function w9(e){if(e==null){var t=oe(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return ii(e);return ii(0)}function Bf(e,t,r){var s=e.l+t,n=hn(e);r.biff==2&&++e.l;var a=y9(e),i=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var l=x9(e,s-e.l,r);return{cell:n,val:a[0],formula:l,shared:i>>3&1,tt:a[1]}}function b9(e,t,r,s,n){var a=li(t,r,n),i=w9(e.v),l=oe(6),c=33;l.write_shift(2,c),l.write_shift(4,0);for(var u=oe(e.bf.length),d=0;d<e.bf.length;++d)u[d]=e.bf[d];var f=nr([a,i,l,u]);return f}function _0(e,t,r){var s=e.read_shift(4),n=Bc(e,s,r),a=e.read_shift(4),i=a>0?Mc(e,a,n,r):null;return[n,i]}var _9=_0,S0=_0,S9=_0,k9=_0,N9={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Nj={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},j9={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function vw(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function E9(e){var t="of:="+e.replace(eg,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Uf(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function T9(e){return e.replace(/\./,"!")}var Cl={},oo={},Al=typeof Map<"u";function sg(e,t,r){var s=0,n=e.length;if(r){if(Al?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var a=Al?r.get(t):r[t];s<a.length;++s)if(e[a[s]].t===t)return e.Count++,a[s]}}else for(;s<n;++s)if(e[s].t===t)return e.Count++,s;return e[n]={t},e.Count++,e.Unique++,r&&(Al?(r.has(t)||r.set(t,[]),r.get(t).push(n)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(n))),n}function k0(e,t){var r={min:e+1,max:e+1},s=-1;return t.MDW&&(Sr=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?s=pc(t.wpx):t.wch!=null&&(s=t.wch),s>-1?(r.width=Vd(s),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function Ja(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function _a(e,t,r){var s=r.revssf[t.z!=null?t.z:"General"],n=60,a=e.length;if(s==null&&r.ssf){for(;n<392;++n)if(r.ssf[n]==null){Nn(t.z,n),r.ssf[n]=t.z,r.revssf[t.z]=s=n;break}}for(n=0;n!=a;++n)if(e[n].numFmtId===s)return n;return e[a]={numFmtId:s,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},a}function jj(e,t,r,s,n,a){try{s.cellNF&&(e.z=Be[t])}catch(l){if(s.WTF)throw l}if(!(e.t==="z"&&!s.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=xt(e.v)),(!s||s.cellText!==!1)&&e.t!=="z")try{if(Be[t]==null&&Nn(N8[t]||"General",t),e.t==="e")e.w=e.w||Mn[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=lc(e.v);else if(e.t==="d"){var i=tr(e.v);(i|0)===i?e.w=i.toString(10):e.w=lc(i)}else{if(e.v===void 0)return"";e.w=ni(e.v,oo)}else e.t==="d"?e.w=Os(t,tr(e.v),oo):e.w=Os(t,e.v,oo)}catch(l){if(s.WTF)throw l}if(s.cellStyles&&r!=null)try{e.s=a.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=zd(n.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),s.WTF&&(e.s.fgColor.raw_rgb=n.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=zd(n.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),s.WTF&&(e.s.bgColor.raw_rgb=n.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(l){if(s.WTF&&a.Fills)throw l}}}function C9(e,t,r){if(e&&e["!ref"]){var s=et(e["!ref"]);if(s.e.c<s.s.c||s.e.r<s.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function A9(e,t){var r=et(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=qe(r))}var F9=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,P9=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,R9=/<(?:\w:)?hyperlink [^>]*>/mg,I9=/"(\w*:\w*)"/,O9=/<(?:\w:)?col\b[^>]*[\/]?>/g,D9=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,L9=/<(?:\w:)?pageMargins[^>]*\/>/g,Ej=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,M9=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,B9=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function U9(e,t,r,s,n,a,i){if(!e)return e;s||(s={"!id":{}});var l=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",d="",f=e.match(P9);f?(u=e.slice(0,f.index),d=e.slice(f.index+f[0].length)):u=d=e;var h=u.match(Ej);h?ng(h[0],l,n,r):(h=u.match(M9))&&z9(h[0],h[1]||"",l,n,r);var p=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(p>0){var m=u.slice(p,p+50).match(I9);m&&A9(l,m[1])}var x=u.match(B9);x&&x[1]&&tB(x[1],n);var g=[];if(t.cellStyles){var y=u.match(O9);y&&Y9(g,y)}f&&nB(f[1],l,t,c,a,i);var w=d.match(D9);w&&(l["!autofilter"]=Q9(w[0]));var v=[],b=d.match(F9);if(b)for(p=0;p!=b.length;++p)v[p]=et(b[p].slice(b[p].indexOf('"')+1));var _=d.match(R9);_&&G9(l,_,s);var k=d.match(L9);if(k&&(l["!margins"]=K9(ze(k[0]))),!l["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(l["!ref"]=qe(c)),t.sheetRows>0&&l["!ref"]){var S=et(l["!ref"]);t.sheetRows<=+S.e.r&&(S.e.r=t.sheetRows-1,S.e.r>c.e.r&&(S.e.r=c.e.r),S.e.r<S.s.r&&(S.s.r=S.e.r),S.e.c>c.e.c&&(S.e.c=c.e.c),S.e.c<S.s.c&&(S.s.c=S.e.c),l["!fullref"]=l["!ref"],l["!ref"]=qe(S))}return g.length>0&&(l["!cols"]=g),v.length>0&&(l["!merges"]=v),l}function $9(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+qe(e[r])+'"/>';return t+"</mergeCells>"}function ng(e,t,r,s){var n=ze(e);r.Sheets[s]||(r.Sheets[s]={}),n.codeName&&(r.Sheets[s].CodeName=Ze(ct(n.codeName)))}function z9(e,t,r,s,n){ng(e.slice(0,e.indexOf(">")),r,s,n)}function V9(e,t,r,s,n){var a=!1,i={},l=null;if(s.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}a=!0,i.codeName=on(ot(c))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),l=(l||"")+ke("outlinePr",null,u)}!a&&!l||(n[n.length]=ke("sheetPr",l,i))}var W9=["objects","scenarios","selectLockedCells","selectUnlockedCells"],H9=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function q9(e){var t={sheet:1};return W9.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),H9.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=Jx(e.password).toString(16).toUpperCase()),ke("sheetProtection",null,t)}function G9(e,t,r){for(var s=Array.isArray(e),n=0;n!=t.length;++n){var a=ze(ct(t[n]),!0);if(!a.ref)return;var i=((r||{})["!id"]||[])[a.id];i?(a.Target=i.Target,a.location&&(a.Target+="#"+Ze(a.location))):(a.Target="#"+Ze(a.location),i={Target:a.Target,TargetMode:"Internal"}),a.Rel=i,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var l=et(a.ref),c=l.s.r;c<=l.e.r;++c)for(var u=l.s.c;u<=l.e.c;++u){var d=Ue({c:u,r:c});s?(e[c]||(e[c]=[]),e[c][u]||(e[c][u]={t:"z",v:void 0}),e[c][u].l=a):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=a)}}}function K9(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function X9(e){return Ja(e),ke("pageMargins",null,e)}function Y9(e,t){for(var r=!1,s=0;s!=t.length;++s){var n=ze(t[s],!0);n.hidden&&(n.hidden=mt(n.hidden));var a=parseInt(n.min,10)-1,i=parseInt(n.max,10)-1;for(n.outlineLevel&&(n.level=+n.outlineLevel||0),delete n.min,delete n.max,n.width=+n.width,!r&&n.width&&(r=!0,Qx(n.width)),da(n);a<=i;)e[a++]=gt(n)}}function J9(e,t){for(var r=["<cols>"],s,n=0;n!=t.length;++n)(s=t[n])&&(r[r.length]=ke("col",null,k0(n,s)));return r[r.length]="</cols>",r.join("")}function Q9(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function Z9(e,t,r,s){var n=typeof e.ref=="string"?e.ref:qe(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,i=Jr(n);i.s.r==i.e.r&&(i.e.r=Jr(t["!ref"]).e.r,n=qe(i));for(var l=0;l<a.length;++l){var c=a[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==s){c.Ref="'"+r.SheetNames[s]+"'!"+n;break}}return l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:s,Ref:"'"+r.SheetNames[s]+"'!"+n}),ke("autoFilter",null,{ref:n})}var eB=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function tB(e,t){t.Views||(t.Views=[{}]),(e.match(eB)||[]).forEach(function(r,s){var n=ze(r);t.Views[s]||(t.Views[s]={}),+n.zoomScale&&(t.Views[s].zoom=+n.zoomScale),mt(n.rightToLeft)&&(t.Views[s].RTL=!0)})}function rB(e,t,r,s){var n={workbookViewId:"0"};return(((s||{}).Workbook||{}).Views||[])[0]&&(n.rightToLeft=s.Workbook.Views[0].RTL?"1":"0"),ke("sheetViews",ke("sheetView",null,n),{})}function sB(e,t,r,s){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var n="",a=e.t,i=e.v;if(e.t!=="z")switch(e.t){case"b":n=e.v?"1":"0";break;case"n":n=""+e.v;break;case"e":n=Mn[e.v];break;case"d":s&&s.cellDates?n=xt(e.v,-1).toISOString():(e=gt(e),e.t="n",n=""+(e.v=tr(xt(e.v)))),typeof e.z>"u"&&(e.z=Be[14]);break;default:n=e.v;break}var l=fr("v",ot(n)),c={r:t},u=_a(s.cellXfs,e,s);switch(u!==0&&(c.s=u),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(s&&s.bookSST){l=fr("v",""+sg(s.Strings,e.v,s.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=a&&(e.t=a,e.v=i),typeof e.f=="string"&&e.f){var d=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;l=ke("f",ot(e.f),d)+(e.v!=null?l:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),ke("c",l,c)}var nB=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,s=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,n=/ref=["']([^"']*)["']/,a=cc("v"),i=cc("f");return function(c,u,d,f,h,p){for(var m=0,x="",g=[],y=[],w=0,v=0,b=0,_="",k,S,E=0,C=0,U,H,W=0,q=0,z=Array.isArray(p.CellXf),Q,L=[],X=[],K=Array.isArray(u),V=[],fe={},ve=!1,P=!!d.sheetStubs,M=c.split(t),D=0,B=M.length;D!=B;++D){x=M[D].trim();var Y=x.length;if(Y!==0){var he=0;e:for(m=0;m<Y;++m)switch(x[m]){case">":if(x[m-1]!="/"){++m;break e}if(d&&d.cellStyles){if(S=ze(x.slice(he,m),!0),E=S.r!=null?parseInt(S.r,10):E+1,C=-1,d.sheetRows&&d.sheetRows<E)continue;fe={},ve=!1,S.ht&&(ve=!0,fe.hpt=parseFloat(S.ht),fe.hpx=No(fe.hpt)),S.hidden=="1"&&(ve=!0,fe.hidden=!0),S.outlineLevel!=null&&(ve=!0,fe.level=+S.outlineLevel),ve&&(V[E-1]=fe)}break;case"<":he=m;break}if(he>=m)break;if(S=ze(x.slice(he,m),!0),E=S.r!=null?parseInt(S.r,10):E+1,C=-1,!(d.sheetRows&&d.sheetRows<E)){f.s.r>E-1&&(f.s.r=E-1),f.e.r<E-1&&(f.e.r=E-1),d&&d.cellStyles&&(fe={},ve=!1,S.ht&&(ve=!0,fe.hpt=parseFloat(S.ht),fe.hpx=No(fe.hpt)),S.hidden=="1"&&(ve=!0,fe.hidden=!0),S.outlineLevel!=null&&(ve=!0,fe.level=+S.outlineLevel),ve&&(V[E-1]=fe)),g=x.slice(m).split(e);for(var xe=0;xe!=g.length&&g[xe].trim().charAt(0)=="<";++xe);for(g=g.slice(xe),m=0;m!=g.length;++m)if(x=g[m].trim(),x.length!==0){if(y=x.match(r),w=m,v=0,b=0,x="<c "+(x.slice(0,1)=="<"?">":"")+x,y!=null&&y.length===2){for(w=0,_=y[1],v=0;v!=_.length&&!((b=_.charCodeAt(v)-64)<1||b>26);++v)w=26*w+b;--w,C=w}else++C;for(v=0;v!=x.length&&x.charCodeAt(v)!==62;++v);if(++v,S=ze(x.slice(0,v),!0),S.r||(S.r=Ue({r:E-1,c:C})),_=x.slice(v),k={t:""},(y=_.match(a))!=null&&y[1]!==""&&(k.v=Ze(y[1])),d.cellFormula){if((y=_.match(i))!=null&&y[1]!==""){if(k.f=Ze(ct(y[1])).replace(/\r\n/g,`
`),d.xlfn||(k.f=mw(k.f)),y[0].indexOf('t="array"')>-1)k.F=(_.match(n)||[])[1],k.F.indexOf(":")>-1&&L.push([et(k.F),k.F]);else if(y[0].indexOf('t="shared"')>-1){H=ze(y[0]);var se=Ze(ct(y[1]));d.xlfn||(se=mw(se)),X[parseInt(H.si,10)]=[H,se,S.r]}}else(y=_.match(/<f[^>]*\/>/))&&(H=ze(y[0]),X[H.si]&&(k.f=e7(X[H.si][1],X[H.si][2],S.r)));var ne=Ct(S.r);for(v=0;v<L.length;++v)ne.r>=L[v][0].s.r&&ne.r<=L[v][0].e.r&&ne.c>=L[v][0].s.c&&ne.c<=L[v][0].e.c&&(k.F=L[v][1])}if(S.t==null&&k.v===void 0)if(k.f||k.F)k.v=0,k.t="n";else if(P)k.t="z";else continue;else k.t=S.t||"n";switch(f.s.c>C&&(f.s.c=C),f.e.c<C&&(f.e.c=C),k.t){case"n":if(k.v==""||k.v==null){if(!P)continue;k.t="z"}else k.v=parseFloat(k.v);break;case"s":if(typeof k.v>"u"){if(!P)continue;k.t="z"}else U=Cl[parseInt(k.v,10)],k.v=U.t,k.r=U.r,d.cellHTML&&(k.h=U.h);break;case"str":k.t="s",k.v=k.v!=null?ct(k.v):"",d.cellHTML&&(k.h=Dx(k.v));break;case"inlineStr":y=_.match(s),k.t="s",y!=null&&(U=Yx(y[1]))?(k.v=U.t,d.cellHTML&&(k.h=U.h)):k.v="";break;case"b":k.v=mt(k.v);break;case"d":d.cellDates?k.v=xt(k.v,1):(k.v=tr(xt(k.v,1)),k.t="n");break;case"e":(!d||d.cellText!==!1)&&(k.w=k.v),k.v=CN[k.v];break}if(W=q=0,Q=null,z&&S.s!==void 0&&(Q=p.CellXf[S.s],Q!=null&&(Q.numFmtId!=null&&(W=Q.numFmtId),d.cellStyles&&Q.fillId!=null&&(q=Q.fillId))),jj(k,W,q,d,h,p),d.cellDates&&z&&k.t=="n"&&Do(Be[W])&&(k.t="d",k.v=w0(k.v)),S.cm&&d.xlmeta){var be=(d.xlmeta.Cell||[])[+S.cm-1];be&&be.type=="XLDAPR"&&(k.D=!0)}if(K){var N=Ct(S.r);u[N.r]||(u[N.r]=[]),u[N.r][N.c]=k}else u[S.r]=k}}}}V.length>0&&(u["!rows"]=V)}}();function aB(e,t,r,s){var n=[],a=[],i=et(e["!ref"]),l="",c,u="",d=[],f=0,h=0,p=e["!rows"],m=Array.isArray(e),x={r:u},g,y=-1;for(h=i.s.c;h<=i.e.c;++h)d[h]=Tt(h);for(f=i.s.r;f<=i.e.r;++f){for(a=[],u=zt(f),h=i.s.c;h<=i.e.c;++h){c=d[h]+u;var w=m?(e[f]||[])[h]:e[c];w!==void 0&&(l=sB(w,c,e,t))!=null&&a.push(l)}(a.length>0||p&&p[f])&&(x={r:u},p&&p[f]&&(g=p[f],g.hidden&&(x.hidden=1),y=-1,g.hpx?y=xc(g.hpx):g.hpt&&(y=g.hpt),y>-1&&(x.ht=y,x.customHeight=1),g.level&&(x.outlineLevel=g.level)),n[n.length]=ke("row",a.join(""),x))}if(p)for(;f<p.length;++f)p&&p[f]&&(x={r:f+1},g=p[f],g.hidden&&(x.hidden=1),y=-1,g.hpx?y=xc(g.hpx):g.hpt&&(y=g.hpt),y>-1&&(x.ht=y,x.customHeight=1),g.level&&(x.outlineLevel=g.level),n[n.length]=ke("row","",x));return n.join("")}function Tj(e,t,r,s){var n=[Vt,ke("worksheet",null,{xmlns:fi[0],"xmlns:r":Zt.r})],a=r.SheetNames[e],i=0,l="",c=r.Sheets[a];c==null&&(c={});var u=c["!ref"]||"A1",d=et(u);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),u=qe(d)}s||(s={}),c["!comments"]=[];var f=[];V9(c,r,e,t,n),n[n.length]=ke("dimension",null,{ref:u}),n[n.length]=rB(c,t,e,r),t.sheetFormat&&(n[n.length]=ke("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(n[n.length]=J9(c,c["!cols"])),n[i=n.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(l=aB(c,t),l.length>0&&(n[n.length]=l)),n.length>i+1&&(n[n.length]="</sheetData>",n[i]=n[i].replace("/>",">")),c["!protect"]&&(n[n.length]=q9(c["!protect"])),c["!autofilter"]!=null&&(n[n.length]=Z9(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(n[n.length]=$9(c["!merges"]));var h=-1,p,m=-1;return c["!links"].length>0&&(n[n.length]="<hyperlinks>",c["!links"].forEach(function(x){x[1].Target&&(p={ref:x[0]},x[1].Target.charAt(0)!="#"&&(m=at(s,-1,ot(x[1].Target).replace(/#.*$/,""),Xe.HLINK),p["r:id"]="rId"+m),(h=x[1].Target.indexOf("#"))>-1&&(p.location=ot(x[1].Target.slice(h+1))),x[1].Tooltip&&(p.tooltip=ot(x[1].Tooltip)),n[n.length]=ke("hyperlink",null,p))}),n[n.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(n[n.length]=X9(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(n[n.length]=fr("ignoredErrors",ke("ignoredError",null,{numberStoredAsText:1,sqref:u}))),f.length>0&&(m=at(s,-1,"../drawings/drawing"+(e+1)+".xml",Xe.DRAW),n[n.length]=ke("drawing",null,{"r:id":"rId"+m}),c["!drawing"]=f),c["!comments"].length>0&&(m=at(s,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Xe.VML),n[n.length]=ke("legacyDrawing",null,{"r:id":"rId"+m}),c["!legacy"]=m),n.length>1&&(n[n.length]="</worksheet>",n[1]=n[1].replace("/>",">")),n.join("")}function iB(e,t){var r={},s=e.l+t;r.r=e.read_shift(4),e.l+=4;var n=e.read_shift(2);e.l+=1;var a=e.read_shift(1);return e.l=s,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=n/20),r}function oB(e,t,r){var s=oe(145),n=(r["!rows"]||[])[e]||{};s.write_shift(4,e),s.write_shift(4,0);var a=320;n.hpx?a=xc(n.hpx)*20:n.hpt&&(a=n.hpt*20),s.write_shift(2,a),s.write_shift(1,0);var i=0;n.level&&(i|=n.level),n.hidden&&(i|=16),(n.hpx||n.hpt)&&(i|=32),s.write_shift(1,i),s.write_shift(1,0);var l=0,c=s.l;s.l+=4;for(var u={r:e,c:0},d=0;d<16;++d)if(!(t.s.c>d+1<<10||t.e.c<d<<10)){for(var f=-1,h=-1,p=d<<10;p<d+1<<10;++p){u.c=p;var m=Array.isArray(r)?(r[u.r]||[])[u.c]:r[Ue(u)];m&&(f<0&&(f=p),h=p)}f<0||(++l,s.write_shift(4,f),s.write_shift(4,h))}var x=s.l;return s.l=c,s.write_shift(4,l),s.l=x,s.length>s.l?s.slice(0,s.l):s}function lB(e,t,r,s){var n=oB(s,r,t);(n.length>17||(t["!rows"]||[])[s])&&me(e,0,n)}var cB=xi,uB=Bo;function dB(){}function fB(e,t){var r={},s=e[e.l];return++e.l,r.above=!(s&64),r.left=!(s&128),e.l+=18,r.name=pI(e),r}function hB(e,t,r){r==null&&(r=oe(84+4*e.length));var s=192;t&&(t.above&&(s&=-65),t.left&&(s&=-129)),r.write_shift(1,s);for(var n=1;n<3;++n)r.write_shift(1,0);return Bd({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),kN(e,r),r.slice(0,r.l)}function mB(e){var t=Ds(e);return[t]}function pB(e,t,r){return r==null&&(r=oe(8)),hi(t,r)}function xB(e){var t=mi(e);return[t]}function gB(e,t,r){return r==null&&(r=oe(4)),pi(t,r)}function vB(e){var t=Ds(e),r=e.read_shift(1);return[t,r,"b"]}function yB(e,t,r){return r==null&&(r=oe(9)),hi(t,r),r.write_shift(1,e.v?1:0),r}function wB(e){var t=mi(e),r=e.read_shift(1);return[t,r,"b"]}function bB(e,t,r){return r==null&&(r=oe(5)),pi(t,r),r.write_shift(1,e.v?1:0),r}function _B(e){var t=Ds(e),r=e.read_shift(1);return[t,r,"e"]}function SB(e,t,r){return r==null&&(r=oe(9)),hi(t,r),r.write_shift(1,e.v),r}function kB(e){var t=mi(e),r=e.read_shift(1);return[t,r,"e"]}function NB(e,t,r){return r==null&&(r=oe(8)),pi(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function jB(e){var t=Ds(e),r=e.read_shift(4);return[t,r,"s"]}function EB(e,t,r){return r==null&&(r=oe(12)),hi(t,r),r.write_shift(4,t.v),r}function TB(e){var t=mi(e),r=e.read_shift(4);return[t,r,"s"]}function CB(e,t,r){return r==null&&(r=oe(8)),pi(t,r),r.write_shift(4,t.v),r}function AB(e){var t=Ds(e),r=Nr(e);return[t,r,"n"]}function FB(e,t,r){return r==null&&(r=oe(16)),hi(t,r),ii(e.v,r),r}function Cj(e){var t=mi(e),r=Nr(e);return[t,r,"n"]}function PB(e,t,r){return r==null&&(r=oe(12)),pi(t,r),ii(e.v,r),r}function RB(e){var t=Ds(e),r=Hx(e);return[t,r,"n"]}function IB(e,t,r){return r==null&&(r=oe(12)),hi(t,r),NN(e.v,r),r}function OB(e){var t=mi(e),r=Hx(e);return[t,r,"n"]}function DB(e,t,r){return r==null&&(r=oe(8)),pi(t,r),NN(e.v,r),r}function LB(e){var t=Ds(e),r=zx(e);return[t,r,"is"]}function MB(e){var t=Ds(e),r=Er(e);return[t,r,"str"]}function BB(e,t,r){return r==null&&(r=oe(12+4*e.v.length)),hi(t,r),ar(e.v,r),r.length>r.l?r.slice(0,r.l):r}function UB(e){var t=mi(e),r=Er(e);return[t,r,"str"]}function $B(e,t,r){return r==null&&(r=oe(8+4*e.v.length)),pi(t,r),ar(e.v,r),r.length>r.l?r.slice(0,r.l):r}function zB(e,t,r){var s=e.l+t,n=Ds(e);n.r=r["!row"];var a=e.read_shift(1),i=[n,a,"b"];if(r.cellFormula){e.l+=2;var l=S0(e,s-e.l,r);i[3]=br(l,null,n,r.supbooks,r)}else e.l=s;return i}function VB(e,t,r){var s=e.l+t,n=Ds(e);n.r=r["!row"];var a=e.read_shift(1),i=[n,a,"e"];if(r.cellFormula){e.l+=2;var l=S0(e,s-e.l,r);i[3]=br(l,null,n,r.supbooks,r)}else e.l=s;return i}function WB(e,t,r){var s=e.l+t,n=Ds(e);n.r=r["!row"];var a=Nr(e),i=[n,a,"n"];if(r.cellFormula){e.l+=2;var l=S0(e,s-e.l,r);i[3]=br(l,null,n,r.supbooks,r)}else e.l=s;return i}function HB(e,t,r){var s=e.l+t,n=Ds(e);n.r=r["!row"];var a=Er(e),i=[n,a,"str"];if(r.cellFormula){e.l+=2;var l=S0(e,s-e.l,r);i[3]=br(l,null,n,r.supbooks,r)}else e.l=s;return i}var qB=xi,GB=Bo;function KB(e,t){return t==null&&(t=oe(4)),t.write_shift(4,e),t}function XB(e,t){var r=e.l+t,s=xi(e),n=Vx(e),a=Er(e),i=Er(e),l=Er(e);e.l=r;var c={rfx:s,relId:n,loc:a,display:l};return i&&(c.Tooltip=i),c}function YB(e,t){var r=oe(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Bo({s:Ct(e[0]),e:Ct(e[0])},r),Wx("rId"+t,r);var s=e[1].Target.indexOf("#"),n=s==-1?"":e[1].Target.slice(s+1);return ar(n||"",r),ar(e[1].Tooltip||"",r),ar("",r),r.slice(0,r.l)}function JB(){}function QB(e,t,r){var s=e.l+t,n=jN(e),a=e.read_shift(1),i=[n];if(i[2]=a,r.cellFormula){var l=_9(e,s-e.l,r);i[1]=l}else e.l=s;return i}function ZB(e,t,r){var s=e.l+t,n=xi(e),a=[n];if(r.cellFormula){var i=k9(e,s-e.l,r);a[1]=i,e.l=s}else e.l=s;return a}function eU(e,t,r){r==null&&(r=oe(18));var s=k0(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(s.width||10)*256),r.write_shift(4,0);var n=0;return t.hidden&&(n|=1),typeof s.width=="number"&&(n|=2),t.level&&(n|=t.level<<8),r.write_shift(2,n),r}var Aj=["left","right","top","bottom","header","footer"];function tU(e){var t={};return Aj.forEach(function(r){t[r]=Nr(e)}),t}function rU(e,t){return t==null&&(t=oe(6*8)),Ja(e),Aj.forEach(function(r){ii(e[r],t)}),t}function sU(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function nU(e,t,r){r==null&&(r=oe(30));var s=924;return(((t||{}).Views||[])[0]||{}).RTL&&(s|=32),r.write_shift(2,s),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function aU(e){var t=oe(24);return t.write_shift(4,4),t.write_shift(4,1),Bo(e,t),t}function iU(e,t){return t==null&&(t=oe(16*4+2)),t.write_shift(2,e.password?Jx(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function oU(){}function lU(){}function cU(e,t,r,s,n,a,i){if(!e)return e;var l=t||{};s||(s={"!id":{}});var c=l.dense?[]:{},u,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,h=!1,p,m,x,g,y,w,v,b,_,k=[];l.biff=12,l["!row"]=0;var S=0,E=!1,C=[],U={},H=l.supbooks||n.supbooks||[[]];if(H.sharedf=U,H.arrayf=C,H.SheetNames=n.SheetNames||n.Sheets.map(function(K){return K.name}),!l.supbooks&&(l.supbooks=H,n.Names))for(var W=0;W<n.Names.length;++W)H[0][W+1]=n.Names[W];var q=[],z=[],Q=!1;gc[16]={n:"BrtShortReal",f:Cj};var L;if(Ln(e,function(V,fe,ve){if(!h)switch(ve){case 148:u=V;break;case 0:p=V,l.sheetRows&&l.sheetRows<=p.r&&(h=!0),b=zt(g=p.r),l["!row"]=p.r,(V.hidden||V.hpt||V.level!=null)&&(V.hpt&&(V.hpx=No(V.hpt)),z[V.r]=V);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(m={t:V[2]},V[2]){case"n":m.v=V[1];break;case"s":v=Cl[V[1]],m.v=v.t,m.r=v.r;break;case"b":m.v=!!V[1];break;case"e":m.v=V[1],l.cellText!==!1&&(m.w=Mn[m.v]);break;case"str":m.t="s",m.v=V[1];break;case"is":m.t="s",m.v=V[1].t;break}if((x=i.CellXf[V[0].iStyleRef])&&jj(m,x.numFmtId,null,l,a,i),y=V[0].c==-1?y+1:V[0].c,l.dense?(c[g]||(c[g]=[]),c[g][y]=m):c[Tt(y)+b]=m,l.cellFormula){for(E=!1,S=0;S<C.length;++S){var P=C[S];p.r>=P[0].s.r&&p.r<=P[0].e.r&&y>=P[0].s.c&&y<=P[0].e.c&&(m.F=qe(P[0]),E=!0)}!E&&V.length>3&&(m.f=V[3])}if(d.s.r>p.r&&(d.s.r=p.r),d.s.c>y&&(d.s.c=y),d.e.r<p.r&&(d.e.r=p.r),d.e.c<y&&(d.e.c=y),l.cellDates&&x&&m.t=="n"&&Do(Be[x.numFmtId])){var M=$a(m.v);M&&(m.t="d",m.v=new Date(M.y,M.m-1,M.d,M.H,M.M,M.S,M.u))}L&&(L.type=="XLDAPR"&&(m.D=!0),L=void 0);break;case 1:case 12:if(!l.sheetStubs||f)break;m={t:"z",v:void 0},y=V[0].c==-1?y+1:V[0].c,l.dense?(c[g]||(c[g]=[]),c[g][y]=m):c[Tt(y)+b]=m,d.s.r>p.r&&(d.s.r=p.r),d.s.c>y&&(d.s.c=y),d.e.r<p.r&&(d.e.r=p.r),d.e.c<y&&(d.e.c=y),L&&(L.type=="XLDAPR"&&(m.D=!0),L=void 0);break;case 176:k.push(V);break;case 49:L=((l.xlmeta||{}).Cell||[])[V-1];break;case 494:var D=s["!id"][V.relId];for(D?(V.Target=D.Target,V.loc&&(V.Target+="#"+V.loc),V.Rel=D):V.relId==""&&(V.Target="#"+V.loc),g=V.rfx.s.r;g<=V.rfx.e.r;++g)for(y=V.rfx.s.c;y<=V.rfx.e.c;++y)l.dense?(c[g]||(c[g]=[]),c[g][y]||(c[g][y]={t:"z",v:void 0}),c[g][y].l=V):(w=Ue({c:y,r:g}),c[w]||(c[w]={t:"z",v:void 0}),c[w].l=V);break;case 426:if(!l.cellFormula)break;C.push(V),_=l.dense?c[g][y]:c[Tt(y)+b],_.f=br(V[1],d,{r:p.r,c:y},H,l),_.F=qe(V[0]);break;case 427:if(!l.cellFormula)break;U[Ue(V[0].s)]=V[1],_=l.dense?c[g][y]:c[Tt(y)+b],_.f=br(V[1],d,{r:p.r,c:y},H,l);break;case 60:if(!l.cellStyles)break;for(;V.e>=V.s;)q[V.e--]={width:V.w/256,hidden:!!(V.flags&1),level:V.level},Q||(Q=!0,Qx(V.w/256)),da(q[V.e+1]);break;case 161:c["!autofilter"]={ref:qe(V)};break;case 476:c["!margins"]=V;break;case 147:n.Sheets[r]||(n.Sheets[r]={}),V.name&&(n.Sheets[r].CodeName=V.name),(V.above||V.left)&&(c["!outline"]={above:V.above,left:V.left});break;case 137:n.Views||(n.Views=[{}]),n.Views[0]||(n.Views[0]={}),V.RTL&&(n.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!fe.T){if(!f||l.WTF)throw new Error("Unexpected record 0x"+ve.toString(16))}}},l),delete l.supbooks,delete l["!row"],!c["!ref"]&&(d.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(c["!ref"]=qe(u||d)),l.sheetRows&&c["!ref"]){var X=et(c["!ref"]);l.sheetRows<=+X.e.r&&(X.e.r=l.sheetRows-1,X.e.r>d.e.r&&(X.e.r=d.e.r),X.e.r<X.s.r&&(X.s.r=X.e.r),X.e.c>d.e.c&&(X.e.c=d.e.c),X.e.c<X.s.c&&(X.s.c=X.e.c),c["!fullref"]=c["!ref"],c["!ref"]=qe(X))}return k.length>0&&(c["!merges"]=k),q.length>0&&(c["!cols"]=q),z.length>0&&(c["!rows"]=z),c}function uU(e,t,r,s,n,a,i){if(t.v===void 0)return!1;var l="";switch(t.t){case"b":l=t.v?"1":"0";break;case"d":t=gt(t),t.z=t.z||Be[14],t.v=tr(xt(t.v)),t.t="n";break;case"n":case"e":l=""+t.v;break;default:l=t.v;break}var c={r,c:s};switch(c.s=_a(n.cellXfs,t,n),t.l&&a["!links"].push([Ue(c),t.l]),t.c&&a["!comments"].push([Ue(c),t.c]),t.t){case"s":case"str":return n.bookSST?(l=sg(n.Strings,t.v,n.revStrings),c.t="s",c.v=l,i?me(e,18,CB(t,c)):me(e,7,EB(t,c))):(c.t="str",i?me(e,17,$B(t,c)):me(e,6,BB(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?i?me(e,13,DB(t,c)):me(e,2,IB(t,c)):i?me(e,16,PB(t,c)):me(e,5,FB(t,c)),!0;case"b":return c.t="b",i?me(e,15,bB(t,c)):me(e,4,yB(t,c)),!0;case"e":return c.t="e",i?me(e,14,NB(t,c)):me(e,3,SB(t,c)),!0}return i?me(e,12,gB(t,c)):me(e,1,pB(t,c)),!0}function dU(e,t,r,s){var n=et(t["!ref"]||"A1"),a,i="",l=[];me(e,145);var c=Array.isArray(t),u=n.e.r;t["!rows"]&&(u=Math.max(n.e.r,t["!rows"].length-1));for(var d=n.s.r;d<=u;++d){i=zt(d),lB(e,t,n,d);var f=!1;if(d<=n.e.r)for(var h=n.s.c;h<=n.e.c;++h){d===n.s.r&&(l[h]=Tt(h)),a=l[h]+i;var p=c?(t[d]||[])[h]:t[a];if(!p){f=!1;continue}f=uU(e,p,d,h,s,t,f)}}me(e,146)}function fU(e,t){!t||!t["!merges"]||(me(e,177,KB(t["!merges"].length)),t["!merges"].forEach(function(r){me(e,176,GB(r))}),me(e,178))}function hU(e,t){!t||!t["!cols"]||(me(e,390),t["!cols"].forEach(function(r,s){r&&me(e,60,eU(s,r))}),me(e,391))}function mU(e,t){!t||!t["!ref"]||(me(e,648),me(e,649,aU(et(t["!ref"]))),me(e,650))}function pU(e,t,r){t["!links"].forEach(function(s){if(s[1].Target){var n=at(r,-1,s[1].Target.replace(/#.*$/,""),Xe.HLINK);me(e,494,YB(s,n))}}),delete t["!links"]}function xU(e,t,r,s){if(t["!comments"].length>0){var n=at(s,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Xe.VML);me(e,551,Wx("rId"+n)),t["!legacy"]=n}}function gU(e,t,r,s){if(t["!autofilter"]){var n=t["!autofilter"],a=typeof n.ref=="string"?n.ref:qe(n.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,l=Jr(a);l.s.r==l.e.r&&(l.e.r=Jr(t["!ref"]).e.r,a=qe(l));for(var c=0;c<i.length;++c){var u=i[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==s){u.Ref="'"+r.SheetNames[s]+"'!"+a;break}}c==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:s,Ref:"'"+r.SheetNames[s]+"'!"+a}),me(e,161,Bo(et(a))),me(e,162)}}function vU(e,t,r){me(e,133),me(e,137,nU(t,r)),me(e,138),me(e,134)}function yU(e,t){t["!protect"]&&me(e,535,iU(t["!protect"]))}function wU(e,t,r,s){var n=Yr(),a=r.SheetNames[e],i=r.Sheets[a]||{},l=a;try{r&&r.Workbook&&(l=r.Workbook.Sheets[e].CodeName||l)}catch{}var c=et(i["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return i["!links"]=[],i["!comments"]=[],me(n,129),(r.vbaraw||i["!outline"])&&me(n,147,hB(l,i["!outline"])),me(n,148,uB(c)),vU(n,i,r.Workbook),hU(n,i),dU(n,i,e,t),yU(n,i),gU(n,i,r,e),fU(n,i),pU(n,i,s),i["!margins"]&&me(n,476,rU(i["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&mU(n,i),xU(n,i,e,s),me(n,130),n.end()}function bU(e){var t=[],r=e.match(/^<c:numCache>/),s;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var i=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(t[+i[1]]=r?+i[2]:i[2])});var n=Ze((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){s=a.replace(/<.*?>/g,"")}),[t,n,s]}function _U(e,t,r,s,n,a){var i=a||{"!type":"chart"};if(!e)return a;var l=0,c=0,u="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var h=bU(f);d.s.r=d.s.c=0,d.e.c=l,u=Tt(l),h[0].forEach(function(p,m){i[u+zt(m)]={t:"n",v:p,z:h[1]},c=m}),d.e.r<c&&(d.e.r=c),++l}),l>0&&(i["!ref"]=qe(d)),i}function SU(e,t,r,s,n){if(!e)return e;s||(s={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i,l=e.match(Ej);return l&&ng(l[0],a,n,r),(i=e.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=i[1]),s["!id"][a["!rel"]]&&(a["!drawel"]=s["!id"][a["!rel"]]),a}function kU(e,t){e.l+=10;var r=Er(e);return{name:r}}function NU(e,t,r,s,n){if(!e)return e;s||(s={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i=!1;return Ln(e,function(c,u,d){switch(d){case 550:a["!rel"]=c;break;case 651:n.Sheets[r]||(n.Sheets[r]={}),c.name&&(n.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!i||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},t),s["!id"][a["!rel"]]&&(a["!drawel"]=s["!id"][a["!rel"]]),a}var ag=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],jU=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],EU=[],TU=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function yw(e,t){for(var r=0;r!=e.length;++r)for(var s=e[r],n=0;n!=t.length;++n){var a=t[n];if(s[a[0]]==null)s[a[0]]=a[1];else switch(a[2]){case"bool":typeof s[a[0]]=="string"&&(s[a[0]]=mt(s[a[0]]));break;case"int":typeof s[a[0]]=="string"&&(s[a[0]]=parseInt(s[a[0]],10));break}}}function ww(e,t){for(var r=0;r!=t.length;++r){var s=t[r];if(e[s[0]]==null)e[s[0]]=s[1];else switch(s[2]){case"bool":typeof e[s[0]]=="string"&&(e[s[0]]=mt(e[s[0]]));break;case"int":typeof e[s[0]]=="string"&&(e[s[0]]=parseInt(e[s[0]],10));break}}}function Fj(e){ww(e.WBProps,ag),ww(e.CalcPr,TU),yw(e.WBView,jU),yw(e.Sheets,EU),oo.date1904=mt(e.WBProps.date1904)}function CU(e){return!e.Workbook||!e.Workbook.WBProps?"false":mt(e.Workbook.WBProps.date1904)?"true":"false"}var AU="][*?/\\".split("");function Pj(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return AU.forEach(function(s){if(e.indexOf(s)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function FU(e,t,r){e.forEach(function(s,n){Pj(s);for(var a=0;a<n;++a)if(s==e[a])throw new Error("Duplicate Sheet Name: "+s);if(r){var i=t&&t[n]&&t[n].CodeName||s;if(i.charCodeAt(0)==95&&i.length>22)throw new Error("Bad Code Name: Worksheet"+i)}})}function PU(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];FU(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)C9(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var RU=/<\w+:workbook/;function IU(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},s=!1,n="xmlns",a={},i=0;if(e.replace(Ar,function(c,u){var d=ze(c);switch(fn(d[0])){case"<?xml":break;case"<workbook":c.match(RU)&&(n="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=d[n];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":ag.forEach(function(f){if(d[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=mt(d[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(d[f[0]],10);break;default:r.WBProps[f[0]]=d[f[0]]}}),d.codeName&&(r.WBProps.CodeName=ct(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=Ze(ct(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":s=!0;break;case"</definedNames>":s=!1;break;case"<definedName":a={},a.Name=ct(d.name),d.comment&&(a.Comment=d.comment),d.localSheetId&&(a.Sheet=+d.localSheetId),mt(d.hidden||"0")&&(a.Hidden=!0),i=u+c.length;break;case"</definedName>":a.Ref=Ze(ct(e.slice(i,u))),r.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":s=!0;break;case"</AlternateContent>":s=!1;break;case"<revisionPtr":break;default:if(!s&&t.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return c}),fi.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return Fj(r),r}function Rj(e){var t=[Vt];t[t.length]=ke("workbook",null,{xmlns:fi[0],"xmlns:r":Zt.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,s={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(ag.forEach(function(l){e.Workbook.WBProps[l[0]]!=null&&e.Workbook.WBProps[l[0]]!=l[1]&&(s[l[0]]=e.Workbook.WBProps[l[0]])}),e.Workbook.WBProps.CodeName&&(s.codeName=e.Workbook.WBProps.CodeName,delete s.CodeName)),t[t.length]=ke("workbookPr",null,s);var n=e.Workbook&&e.Workbook.Sheets||[],a=0;if(n&&n[0]&&n[0].Hidden){for(t[t.length]="<bookViews>",a=0;a!=e.SheetNames.length&&!(!n[a]||!n[a].Hidden);++a);a==e.SheetNames.length&&(a=0),t[t.length]='<workbookView firstSheet="'+a+'" activeTab="'+a+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",a=0;a!=e.SheetNames.length;++a){var i={name:ot(e.SheetNames[a].slice(0,31))};if(i.sheetId=""+(a+1),i["r:id"]="rId"+(a+1),n[a])switch(n[a].Hidden){case 1:i.state="hidden";break;case 2:i.state="veryHidden";break}t[t.length]=ke("sheet",null,i)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(l){var c={name:l.Name};l.Comment&&(c.comment=l.Comment),l.Sheet!=null&&(c.localSheetId=""+l.Sheet),l.Hidden&&(c.hidden="1"),l.Ref&&(t[t.length]=ke("definedName",ot(l.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function OU(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Sm(e),r.name=Er(e),r}function DU(e,t){return t||(t=oe(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Wx(e.strRelID,t),ar(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function LU(e,t){var r={},s=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var n=t>8?Er(e):"";return n.length>0&&(r.CodeName=n),r.autoCompressPictures=!!(s&65536),r.backupFile=!!(s&64),r.checkCompatibility=!!(s&4096),r.date1904=!!(s&1),r.filterPrivacy=!!(s&8),r.hidePivotFieldList=!!(s&1024),r.promptedSolutions=!!(s&16),r.publishItems=!!(s&2048),r.refreshAllConnections=!!(s&262144),r.saveExternalLinkValues=!!(s&128),r.showBorderUnselectedTables=!!(s&4),r.showInkAnnotation=!!(s&32),r.showObjects=["all","placeholders","none"][s>>13&3],r.showPivotChartFilter=!!(s&32768),r.updateLinks=["userSet","never","always"][s>>8&3],r}function MU(e,t){t||(t=oe(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),kN(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function BU(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function UU(e,t,r){var s=e.l+t;e.l+=4,e.l+=1;var n=e.read_shift(4),a=xI(e),i=S9(e,0,r),l=Vx(e);e.l=s;var c={Name:a,Ptg:i};return n<268435455&&(c.Sheet=n),l&&(c.Comment=l),c}function $U(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},s=[],n=!1;t||(t={}),t.biff=12;var a=[],i=[[]];return i.SheetNames=[],i.XTI=[],gc[16]={n:"BrtFRTArchID$",f:BU},Ln(e,function(c,u,d){switch(d){case 156:i.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(t.SID=c.Sheet),c.Ref=br(c.Ptg,null,null,i,t),delete t.SID,delete c.Ptg,a.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([d,c]):i[0]=[d,c],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(c),i.XTI=i.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:s.push(d),n=!0;break;case 36:s.pop(),n=!1;break;case 37:s.push(d),n=!0;break;case 38:s.pop(),n=!1;break;case 16:break;default:if(!u.T){if(!n||t.WTF&&s[s.length-1]!=37&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},t),Fj(r),r.Names=a,r.supbooks=i,r}function zU(e,t){me(e,143);for(var r=0;r!=t.SheetNames.length;++r){var s=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,n={Hidden:s,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};me(e,156,DU(n))}me(e,144)}function VU(e,t){t||(t=oe(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return ar("SheetJS",t),ar(Pd.version,t),ar(Pd.version,t),ar("7262",t),t.length>t.l?t.slice(0,t.l):t}function WU(e,t){t||(t=oe(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function HU(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,s=0,n=-1,a=-1;s<r.length;++s)!r[s]||!r[s].Hidden&&n==-1?n=s:r[s].Hidden==1&&a==-1&&(a=s);a>n||(me(e,135),me(e,158,WU(n)),me(e,136))}}function qU(e,t){var r=Yr();return me(r,131),me(r,128,VU()),me(r,153,MU(e.Workbook&&e.Workbook.WBProps||null)),HU(r,e),zU(r,e),me(r,132),r.end()}function GU(e,t,r){return t.slice(-4)===".bin"?$U(e,r):IU(e,r)}function KU(e,t,r,s,n,a,i,l){return t.slice(-4)===".bin"?cU(e,s,r,n,a,i,l):U9(e,s,r,n,a,i,l)}function XU(e,t,r,s,n,a,i,l){return t.slice(-4)===".bin"?NU(e,s,r,n,a):SU(e,s,r,n,a)}function YU(e,t,r,s,n,a,i,l){return t.slice(-4)===".bin"?QM():ZM()}function JU(e,t,r,s,n,a,i,l){return t.slice(-4)===".bin"?YM():JM()}function QU(e,t,r,s){return t.slice(-4)===".bin"?GL(e,r,s):OL(e,r,s)}function ZU(e,t,r){return hj(e,r)}function e$(e,t,r){return t.slice(-4)===".bin"?eL(e,r):JD(e,r)}function t$(e,t,r){return t.slice(-4)===".bin"?HM(e,r):DM(e,r)}function r$(e,t,r){return t.slice(-4)===".bin"?RM(e):FM(e)}function s$(e,t,r,s){return r.slice(-4)===".bin"?IM(e,t,r,s):void 0}function n$(e,t,r){return t.slice(-4)===".bin"?TM(e,t,r):AM(e,t,r)}function a$(e,t,r){return(t.slice(-4)===".bin"?qU:Rj)(e)}function i$(e,t,r,s,n){return(t.slice(-4)===".bin"?wU:Tj)(e,r,s,n)}function o$(e,t,r){return(t.slice(-4)===".bin"?sM:dj)(e,r)}function l$(e,t,r){return(t.slice(-4)===".bin"?sL:sj)(e,r)}function c$(e,t,r){return(t.slice(-4)===".bin"?qM:xj)(e)}function u$(e){return(e.slice(-4)===".bin"?CM:mj)()}var Ij=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Oj=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Ms(e,t){var r=e.split(/\s+/),s=[];if(s[0]=r[0],r.length===1)return s;var n=e.match(Ij),a,i,l,c;if(n)for(c=0;c!=n.length;++c)a=n[c].match(Oj),(i=a[1].indexOf(":"))===-1?s[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?l="xmlns"+a[1].slice(6):l=a[1].slice(i+1),s[l]=a[2].slice(1,a[2].length-1));return s}function d$(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var s=e.match(Ij),n,a,i,l;if(s)for(l=0;l!=s.length;++l)n=s[l].match(Oj),(a=n[1].indexOf(":"))===-1?r[n[1]]=n[2].slice(1,n[2].length-1):(n[1].slice(0,6)==="xmlns:"?i="xmlns"+n[1].slice(6):i=n[1].slice(a+1),r[i]=n[2].slice(1,n[2].length-1));return r}var Fl;function f$(e,t){var r=Fl[e]||Ze(e);return r==="General"?ni(t):Os(r,t)}function h$(e,t,r,s){var n=s;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":n=mt(s);break;case"i2":case"int":n=parseInt(s,10);break;case"r4":case"float":n=parseFloat(s);break;case"date":case"dateTime.tz":n=xt(s);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Ze(t)]=n}function m$(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Mn[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=lc(e.v):e.w=ni(e.v):e.w=f$(t||"General",e.v)}catch(a){if(r.WTF)throw a}try{var s=Fl[t]||t||"General";if(r.cellNF&&(e.z=s),r.cellDates&&e.t=="n"&&Do(s)){var n=$a(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}catch(a){if(r.WTF)throw a}}}function p$(e,t,r){if(r.cellStyles&&t.Interior){var s=t.Interior;s.Pattern&&(s.patternType=EL[s.Pattern]||s.Pattern)}e[t.ID]=t}function x$(e,t,r,s,n,a,i,l,c,u){var d="General",f=s.StyleID,h={};u=u||{};var p=[],m=0;for(f===void 0&&l&&(f=l.StyleID),f===void 0&&i&&(f=i.StyleID);a[f]!==void 0&&(a[f].nf&&(d=a[f].nf),a[f].Interior&&p.push(a[f].Interior),!!a[f].Parent);)f=a[f].Parent;switch(r.Type){case"Boolean":s.t="b",s.v=mt(e);break;case"String":s.t="s",s.r=L1(Ze(e)),s.v=e.indexOf("<")>-1?Ze(t||e).replace(/<.*?>/g,""):s.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),s.v=(xt(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),s.v!==s.v?s.v=Ze(e):s.v<60&&(s.v=s.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":s.v===void 0&&(s.v=+e),s.t||(s.t="n");break;case"Error":s.t="e",s.v=CN[e],u.cellText!==!1&&(s.w=e);break;default:e==""&&t==""?s.t="z":(s.t="s",s.v=L1(t||e));break}if(m$(s,d,u),u.cellFormula!==!1)if(s.Formula){var x=Ze(s.Formula);x.charCodeAt(0)==61&&(x=x.slice(1)),s.f=io(x,n),delete s.Formula,s.ArrayRange=="RC"?s.F=io("RC:RC",n):s.ArrayRange&&(s.F=io(s.ArrayRange,n),c.push([et(s.F),s.F]))}else for(m=0;m<c.length;++m)n.r>=c[m][0].s.r&&n.r<=c[m][0].e.r&&n.c>=c[m][0].s.c&&n.c<=c[m][0].e.c&&(s.F=c[m][1]);u.cellStyles&&(p.forEach(function(g){!h.patternType&&g.patternType&&(h.patternType=g.patternType)}),s.s=h),s.StyleID!==void 0&&(s.ixfe=s.StyleID)}function g$(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function $f(e,t){var r=t||{};Lo();var s=il(Lx(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(s=ct(s));var n=s.slice(0,1024).toLowerCase(),a=!1;if(n=n.replace(/".*?"/g,""),(n.indexOf(">")&1023)>Math.min(n.indexOf(",")&1023,n.indexOf(";")&1023)){var i=gt(r);return i.type="string",ko.to_workbook(s,i)}if(n.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(ge){n.indexOf("<"+ge)>=0&&(a=!0)}),a)return rz(s,r);Fl={"General Number":"General","General Date":Be[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Be[15],"Short Date":Be[14],"Long Time":Be[19],"Medium Time":Be[18],"Short Time":Be[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Be[2],Standard:Be[4],Percent:Be[10],Scientific:Be[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,c=[],u,d={},f=[],h=r.dense?[]:{},p="",m={},x={},g=Ms('<Data ss:Type="String">'),y=0,w=0,v=0,b={s:{r:2e6,c:2e6},e:{r:0,c:0}},_={},k={},S="",E=0,C=[],U={},H={},W=0,q=[],z=[],Q={},L=[],X,K=!1,V=[],fe=[],ve={},P=0,M=0,D={Sheets:[],WBProps:{date1904:!1}},B={};dc.lastIndex=0,s=s.replace(/<!--([\s\S]*?)-->/mg,"");for(var Y="";l=dc.exec(s);)switch(l[3]=(Y=l[3]).toLowerCase()){case"data":if(Y=="data"){if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break}if(c[c.length-1][1])break;l[1]==="/"?x$(s.slice(y,l.index),S,g,c[c.length-1][0]=="comment"?Q:m,{c:w,r:v},_,L[w],x,V,r):(S="",g=Ms(l[0]),y=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(z.length>0&&(m.c=z),(!r.sheetRows||r.sheetRows>v)&&m.v!==void 0&&(r.dense?(h[v]||(h[v]=[]),h[v][w]=m):h[Tt(w)+zt(v)]=m),m.HRef&&(m.l={Target:Ze(m.HRef)},m.HRefScreenTip&&(m.l.Tooltip=m.HRefScreenTip),delete m.HRef,delete m.HRefScreenTip),(m.MergeAcross||m.MergeDown)&&(P=w+(parseInt(m.MergeAcross,10)|0),M=v+(parseInt(m.MergeDown,10)|0),C.push({s:{c:w,r:v},e:{c:P,r:M}})),!r.sheetStubs)m.MergeAcross?w=P+1:++w;else if(m.MergeAcross||m.MergeDown){for(var he=w;he<=P;++he)for(var xe=v;xe<=M;++xe)(he>w||xe>v)&&(r.dense?(h[xe]||(h[xe]=[]),h[xe][he]={t:"z"}):h[Tt(he)+zt(xe)]={t:"z"});w=P+1}else++w;else m=d$(l[0]),m.Index&&(w=+m.Index-1),w<b.s.c&&(b.s.c=w),w>b.e.c&&(b.e.c=w),l[0].slice(-2)==="/>"&&++w,z=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(v<b.s.r&&(b.s.r=v),v>b.e.r&&(b.e.r=v),l[0].slice(-2)==="/>"&&(x=Ms(l[0]),x.Index&&(v=+x.Index-1)),w=0,++v):(x=Ms(l[0]),x.Index&&(v=+x.Index-1),ve={},(x.AutoFitHeight=="0"||x.Height)&&(ve.hpx=parseInt(x.Height,10),ve.hpt=xc(ve.hpx),fe[v]=ve),x.Hidden=="1"&&(ve.hidden=!0,fe[v]=ve));break;case"worksheet":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"));f.push(p),b.s.r<=b.e.r&&b.s.c<=b.e.c&&(h["!ref"]=qe(b),r.sheetRows&&r.sheetRows<=b.e.r&&(h["!fullref"]=h["!ref"],b.e.r=r.sheetRows-1,h["!ref"]=qe(b))),C.length&&(h["!merges"]=C),L.length>0&&(h["!cols"]=L),fe.length>0&&(h["!rows"]=fe),d[p]=h}else b={s:{r:2e6,c:2e6},e:{r:0,c:0}},v=w=0,c.push([l[3],!1]),u=Ms(l[0]),p=Ze(u.Name),h=r.dense?[]:{},C=[],V=[],fe=[],B={name:p,Hidden:0},D.Sheets.push(B);break;case"table":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else{if(l[0].slice(-2)=="/>")break;c.push([l[3],!1]),L=[],K=!1}break;case"style":l[1]==="/"?p$(_,k,r):k=Ms(l[0]);break;case"numberformat":k.nf=Ze(Ms(l[0]).Format||"General"),Fl[k.nf]&&(k.nf=Fl[k.nf]);for(var se=0;se!=392&&Be[se]!=k.nf;++se);if(se==392){for(se=57;se!=392;++se)if(Be[se]==null){Nn(k.nf,se);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(X=Ms(l[0]),X.Hidden&&(X.hidden=!0,delete X.Hidden),X.Width&&(X.wpx=parseInt(X.Width,10)),!K&&X.wpx>10){K=!0,Sr=cj;for(var ne=0;ne<L.length;++ne)L[ne]&&da(L[ne])}K&&da(X),L[X.Index-1||L.length]=X;for(var be=0;be<+X.Span;++be)L[L.length]=gt(X);break;case"namedrange":if(l[1]==="/")break;D.Names||(D.Names=[]);var N=ze(l[0]),G={Name:N.Name,Ref:io(N.RefersTo.slice(1),{r:0,c:0})};D.Sheets.length>0&&(G.Sheet=D.Sheets.length-1),D.Names.push(G);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?S+=s.slice(E,l.index):E=l.index+l[0].length;break;case"interior":if(!r.cellStyles)break;k.Interior=Ms(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?$I(U,Y,s.slice(W,l.index)):W=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else c.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"));g$(Q),z.push(Q)}else c.push([l[3],!1]),u=Ms(l[0]),Q={a:u.Author};break;case"autofilter":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var ce=Ms(l[0]);h["!autofilter"]={ref:io(ce.Range).replace(/\$/g,"")},c.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"null":break;default:if(c.length==0&&l[3]=="document"||c.length==0&&l[3]=="uof")return Nw(s,r);var te=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:te=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:te=!1}break;case"excelworkbook":switch(l[3]){case"date1904":D.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:te=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:te=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(s.slice(W,l.index)){case"SheetHidden":B.Hidden=1;break;case"SheetVeryHidden":B.Hidden=2;break}else W=l.index+l[0].length;break;case"header":h["!margins"]||Ja(h["!margins"]={},"xlml"),isNaN(+ze(l[0]).Margin)||(h["!margins"].header=+ze(l[0]).Margin);break;case"footer":h["!margins"]||Ja(h["!margins"]={},"xlml"),isNaN(+ze(l[0]).Margin)||(h["!margins"].footer=+ze(l[0]).Margin);break;case"pagemargins":var ue=ze(l[0]);h["!margins"]||Ja(h["!margins"]={},"xlml"),isNaN(+ue.Top)||(h["!margins"].top=+ue.Top),isNaN(+ue.Left)||(h["!margins"].left=+ue.Left),isNaN(+ue.Right)||(h["!margins"].right=+ue.Right),isNaN(+ue.Bottom)||(h["!margins"].bottom=+ue.Bottom);break;case"displayrighttoleft":D.Views||(D.Views=[]),D.Views[0]||(D.Views[0]={}),D.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:te=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:te=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:te=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:te=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:te=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:te=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:te=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:te=!1}break;case"smarttags":break;default:te=!1;break}if(te||l[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?h$(H,Y,q,s.slice(W,l.index)):(q=l,W=l.index+l[0].length);break}if(r.WTF)throw"Unrecognized tag: "+l[3]+"|"+c.join("|")}var ae={};return!r.bookSheets&&!r.bookProps&&(ae.Sheets=d),ae.SheetNames=f,ae.Workbook=D,ae.SSF=gt(Be),ae.Props=U,ae.Custprops=H,ae}function Am(e,t){switch(og(t=t||{}),t.type||"base64"){case"base64":return $f(fs(e),t);case"binary":case"buffer":case"file":return $f(e,t);case"array":return $f(wa(e),t)}}function v$(e,t){var r=[];return e.Props&&r.push(zI(e.Props,t)),e.Custprops&&r.push(VI(e.Props,e.Custprops)),r.join("")}function y$(){return""}function w$(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(s,n){var a=[];a.push(ke("NumberFormat",null,{"ss:Format":ot(Be[s.numFmtId])}));var i={"ss:ID":"s"+(21+n)};r.push(ke("Style",a.join(""),i))}),ke("Styles",r.join(""))}function Dj(e){return ke("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+tg(e.Ref,{r:0,c:0})})}function b$(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],s=0;s<t.length;++s){var n=t[s];n.Sheet==null&&(n.Name.match(/^_xlfn\./)||r.push(Dj(n)))}return ke("Names",r.join(""))}function _$(e,t,r,s){if(!e||!((s||{}).Workbook||{}).Names)return"";for(var n=s.Workbook.Names,a=[],i=0;i<n.length;++i){var l=n[i];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||a.push(Dj(l)))}return a.join("")}function S$(e,t,r,s){if(!e)return"";var n=[];if(e["!margins"]&&(n.push("<PageSetup>"),e["!margins"].header&&n.push(ke("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&n.push(ke("Footer",null,{"x:Margin":e["!margins"].footer})),n.push(ke("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),n.push("</PageSetup>")),s&&s.Workbook&&s.Workbook.Sheets&&s.Workbook.Sheets[r])if(s.Workbook.Sheets[r].Hidden)n.push(ke("Visible",s.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var a=0;a<r&&!(s.Workbook.Sheets[a]&&!s.Workbook.Sheets[a].Hidden);++a);a==r&&n.push("<Selected/>")}return((((s||{}).Workbook||{}).Views||[])[0]||{}).RTL&&n.push("<DisplayRightToLeft/>"),e["!protect"]&&(n.push(fr("ProtectContents","True")),e["!protect"].objects&&n.push(fr("ProtectObjects","True")),e["!protect"].scenarios&&n.push(fr("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?n.push(fr("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&n.push(fr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(i){e["!protect"][i[0]]&&n.push("<"+i[1]+"/>")})),n.length==0?"":ke("WorksheetOptions",n.join(""),{xmlns:rs.x})}function k$(e){return e.map(function(t){var r=H8(t.t||""),s=ke("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return ke("Comment",s,{"ss:Author":t.a})}).join("")}function N$(e,t,r,s,n,a,i){if(!e||e.v==null&&e.f==null)return"";var l={};if(e.f&&(l["ss:Formula"]="="+ot(tg(e.f,i))),e.F&&e.F.slice(0,t.length)==t){var c=Ct(e.F.slice(t.length+1));l["ss:ArrayRange"]="RC:R"+(c.r==i.r?"":"["+(c.r-i.r)+"]")+"C"+(c.c==i.c?"":"["+(c.c-i.c)+"]")}if(e.l&&e.l.Target&&(l["ss:HRef"]=ot(e.l.Target),e.l.Tooltip&&(l["x:HRefScreenTip"]=ot(e.l.Tooltip))),r["!merges"])for(var u=r["!merges"],d=0;d!=u.length;++d)u[d].s.c!=i.c||u[d].s.r!=i.r||(u[d].e.c>u[d].s.c&&(l["ss:MergeAcross"]=u[d].e.c-u[d].s.c),u[d].e.r>u[d].s.r&&(l["ss:MergeDown"]=u[d].e.r-u[d].s.r));var f="",h="";switch(e.t){case"z":if(!s.sheetStubs)return"";break;case"n":f="Number",h=String(e.v);break;case"b":f="Boolean",h=e.v?"1":"0";break;case"e":f="Error",h=Mn[e.v];break;case"d":f="DateTime",h=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Be[14]);break;case"s":f="String",h=W8(e.v||"");break}var p=_a(s.cellXfs,e,s);l["ss:StyleID"]="s"+(21+p),l["ss:Index"]=i.c+1;var m=e.v!=null?h:"",x=e.t=="z"?"":'<Data ss:Type="'+f+'">'+m+"</Data>";return(e.c||[]).length>0&&(x+=k$(e.c)),ke("Cell",x,l)}function j$(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=No(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function E$(e,t,r,s){if(!e["!ref"])return"";var n=et(e["!ref"]),a=e["!merges"]||[],i=0,l=[];e["!cols"]&&e["!cols"].forEach(function(g,y){da(g);var w=!!g.width,v=k0(y,g),b={"ss:Index":y+1};w&&(b["ss:Width"]=mc(v.width)),g.hidden&&(b["ss:Hidden"]="1"),l.push(ke("Column",null,b))});for(var c=Array.isArray(e),u=n.s.r;u<=n.e.r;++u){for(var d=[j$(u,(e["!rows"]||[])[u])],f=n.s.c;f<=n.e.c;++f){var h=!1;for(i=0;i!=a.length;++i)if(!(a[i].s.c>f)&&!(a[i].s.r>u)&&!(a[i].e.c<f)&&!(a[i].e.r<u)){(a[i].s.c!=f||a[i].s.r!=u)&&(h=!0);break}if(!h){var p={r:u,c:f},m=Ue(p),x=c?(e[u]||[])[f]:e[m];d.push(N$(x,m,e,t,r,s,p))}}d.push("</Row>"),d.length>2&&l.push(d.join(""))}return l.join("")}function T$(e,t,r){var s=[],n=r.SheetNames[e],a=r.Sheets[n],i=a?_$(a,t,e,r):"";return i.length>0&&s.push("<Names>"+i+"</Names>"),i=a?E$(a,t,e,r):"",i.length>0&&s.push("<Table>"+i+"</Table>"),s.push(S$(a,t,e,r)),s.join("")}function C$(e,t){t||(t={}),e.SSF||(e.SSF=gt(Be)),e.SSF&&(Lo(),g0(e.SSF),t.revssf=y0(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],_a(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(v$(e,t)),r.push(y$()),r.push(""),r.push("");for(var s=0;s<e.SheetNames.length;++s)r.push(ke("Worksheet",T$(s,t,e),{"ss:Name":ot(e.SheetNames[s])}));return r[2]=w$(e,t),r[3]=b$(e),Vt+ke("Workbook",r.join(""),{xmlns:rs.ss,"xmlns:o":rs.o,"xmlns:x":rs.x,"xmlns:ss":rs.ss,"xmlns:dt":rs.dt,"xmlns:html":rs.html})}function A$(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=bI(r),r.length-r.l<=4)return t;var s=r.read_shift(4);if(s==0||s>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(s=r.read_shift(4),s!==1907505652)||(t.UnicodeClipboardFormat=_I(r),s=r.read_shift(4),s==0||s>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var F$=[60,1084,2066,2165,2175];function P$(e,t,r,s,n){var a=s,i=[],l=r.slice(r.l,r.l+a);if(n&&n.enc&&n.enc.insitu&&l.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:n.enc.insitu(l)}i.push(l),r.l+=a;for(var c=_n(r,r.l),u=Fm[c],d=0;u!=null&&F$.indexOf(c)>-1;)a=_n(r,r.l+2),d=r.l+4,c==2066?d+=4:(c==2165||c==2175)&&(d+=12),l=r.slice(d,r.l+4+a),i.push(l),r.l+=4+a,u=Fm[c=_n(r,r.l)];var f=nr(i);dr(f,0);var h=0;f.lens=[];for(var p=0;p<i.length;++p)f.lens.push(h),h+=i[p].length;if(f.length<s)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+s;return t.f(f,f.length,n)}function tn(e,t,r){if(e.t!=="z"&&e.XF){var s=0;try{s=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Be[s])}catch(a){if(t.WTF)throw a}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Mn[e.v]:s===0||s=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=lc(e.v):e.w=ni(e.v):e.w=Os(s,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(a){if(t.WTF)throw a}if(t.cellDates&&s&&e.t=="n"&&Do(Be[s]||String(s))){var n=$a(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}}function Cu(e,t,r){return{v:e,ixfe:t,t:r}}function R$(e,t){var r={opts:{}},s={},n=t.dense?[]:{},a={},i={},l=null,c=[],u="",d={},f,h="",p,m,x,g,y={},w=[],v,b,_=[],k=[],S={Sheets:[],WBProps:{date1904:!1},Views:[{}]},E={},C=function(Re){return Re<8?Ka[Re]:Re<64&&k[Re-8]||Ka[Re]},U=function(Re,st,pr){var bt=st.XF.data;if(!(!bt||!bt.patternType||!pr||!pr.cellStyles)){st.s={},st.s.patternType=bt.patternType;var ps;(ps=hc(C(bt.icvFore)))&&(st.s.fgColor={rgb:ps}),(ps=hc(C(bt.icvBack)))&&(st.s.bgColor={rgb:ps})}},H=function(Re,st,pr){if(!(ve>1)&&!(pr.sheetRows&&Re.r>=pr.sheetRows)){if(pr.cellStyles&&st.XF&&st.XF.data&&U(Re,st,pr),delete st.ixfe,delete st.XF,f=Re,h=Ue(Re),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),Re.r<i.s.r&&(i.s.r=Re.r),Re.c<i.s.c&&(i.s.c=Re.c),Re.r+1>i.e.r&&(i.e.r=Re.r+1),Re.c+1>i.e.c&&(i.e.c=Re.c+1),pr.cellFormula&&st.f){for(var bt=0;bt<w.length;++bt)if(!(w[bt][0].s.c>Re.c||w[bt][0].s.r>Re.r)&&!(w[bt][0].e.c<Re.c||w[bt][0].e.r<Re.r)){st.F=qe(w[bt][0]),(w[bt][0].s.c!=Re.c||w[bt][0].s.r!=Re.r)&&delete st.f,st.f&&(st.f=""+br(w[bt][1],i,Re,V,W));break}}pr.dense?(n[Re.r]||(n[Re.r]=[]),n[Re.r][Re.c]=st):n[h]=st}},W={enc:!1,sbcch:0,snames:[],sharedf:y,arrayf:w,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(W.password=t.password);var q,z=[],Q=[],L=[],X=[],K=!1,V=[];V.SheetNames=W.snames,V.sharedf=W.sharedf,V.arrayf=W.arrayf,V.names=[],V.XTI=[];var fe=0,ve=0,P=0,M=[],D=[],B;W.codepage=1200,Gs(1200);for(var Y=!1;e.l<e.length-1;){var he=e.l,xe=e.read_shift(2);if(xe===0&&fe===10)break;var se=e.l===e.length?0:e.read_shift(2),ne=Fm[xe];if(ne&&ne.f){if(t.bookSheets&&fe===133&&xe!==133)break;if(fe=xe,ne.r===2||ne.r==12){var be=e.read_shift(2);if(se-=2,!W.enc&&be!==xe&&((be&255)<<8|be>>8)!==xe)throw new Error("rt mismatch: "+be+"!="+xe);ne.r==12&&(e.l+=10,se-=10)}var N={};if(xe===10?N=ne.f(e,se,W):N=P$(xe,ne,e,se,W),ve==0&&[9,521,1033,2057].indexOf(fe)===-1)continue;switch(xe){case 34:r.opts.Date1904=S.WBProps.date1904=N;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(W.enc||(e.l=0),W.enc=N,!t.password)throw new Error("File is password-protected");if(N.valid==null)throw new Error("Encryption scheme unsupported");if(!N.valid)throw new Error("Password is incorrect");break;case 92:W.lastuser=N;break;case 66:var G=Number(N);switch(G){case 21010:G=1200;break;case 32768:G=1e4;break;case 32769:G=1252;break}Gs(W.codepage=G),Y=!0;break;case 317:W.rrtabid=N;break;case 25:W.winlocked=N;break;case 439:r.opts.RefreshAll=N;break;case 12:r.opts.CalcCount=N;break;case 16:r.opts.CalcDelta=N;break;case 17:r.opts.CalcIter=N;break;case 13:r.opts.CalcMode=N;break;case 14:r.opts.CalcPrecision=N;break;case 95:r.opts.CalcSaveRecalc=N;break;case 15:W.CalcRefMode=N;break;case 2211:r.opts.FullCalc=N;break;case 129:N.fDialog&&(n["!type"]="dialog"),N.fBelow||((n["!outline"]||(n["!outline"]={})).above=!0),N.fRight||((n["!outline"]||(n["!outline"]={})).left=!0);break;case 224:_.push(N);break;case 430:V.push([N]),V[V.length-1].XTI=[];break;case 35:case 547:V[V.length-1].push(N);break;case 24:case 536:B={Name:N.Name,Ref:br(N.rgce,i,null,V,W)},N.itab>0&&(B.Sheet=N.itab-1),V.names.push(B),V[0]||(V[0]=[],V[0].XTI=[]),V[V.length-1].push(N),N.Name=="_xlnm._FilterDatabase"&&N.itab>0&&N.rgce&&N.rgce[0]&&N.rgce[0][0]&&N.rgce[0][0][0]=="PtgArea3d"&&(D[N.itab-1]={ref:qe(N.rgce[0][0][1][2])});break;case 22:W.ExternCount=N;break;case 23:V.length==0&&(V[0]=[],V[0].XTI=[]),V[V.length-1].XTI=V[V.length-1].XTI.concat(N),V.XTI=V.XTI.concat(N);break;case 2196:if(W.biff<8)break;B!=null&&(B.Comment=N[1]);break;case 18:n["!protect"]=N;break;case 19:N!==0&&W.WTF&&console.error("Password verifier: "+N);break;case 133:a[N.pos]=N,W.snames.push(N.name);break;case 10:{if(--ve)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,n["!ref"]=qe(i),t.sheetRows&&t.sheetRows<=i.e.r){var ce=i.e.r;i.e.r=t.sheetRows-1,n["!fullref"]=n["!ref"],n["!ref"]=qe(i),i.e.r=ce}i.e.r++,i.e.c++}z.length>0&&(n["!merges"]=z),Q.length>0&&(n["!objects"]=Q),L.length>0&&(n["!cols"]=L),X.length>0&&(n["!rows"]=X),S.Sheets.push(E)}u===""?d=n:s[u]=n,n=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(W.biff===8&&(W.biff={9:2,521:3,1033:4}[xe]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[N.BIFFVer]||8),W.biffguess=N.BIFFVer==0,N.BIFFVer==0&&N.dt==4096&&(W.biff=5,Y=!0,Gs(W.codepage=28591)),W.biff==8&&N.BIFFVer==0&&N.dt==16&&(W.biff=2),ve++)break;if(n=t.dense?[]:{},W.biff<8&&!Y&&(Y=!0,Gs(W.codepage=t.codepage||1252)),W.biff<5||N.BIFFVer==0&&N.dt==4096){u===""&&(u="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var te={pos:e.l-se,name:u};a[te.pos]=te,W.snames.push(u)}else u=(a[he]||{name:""}).name;N.dt==32&&(n["!type"]="chart"),N.dt==64&&(n["!type"]="macro"),z=[],Q=[],W.arrayf=w=[],L=[],X=[],K=!1,E={Hidden:(a[he]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:n["!type"]=="chart"&&(t.dense?(n[N.r]||[])[N.c]:n[Ue({c:N.c,r:N.r})])&&++N.c,v={ixfe:N.ixfe,XF:_[N.ixfe]||{},v:N.val,t:"n"},P>0&&(v.z=M[v.ixfe>>8&63]),tn(v,t,r.opts.Date1904),H({c:N.c,r:N.r},v,t);break;case 5:case 517:v={ixfe:N.ixfe,XF:_[N.ixfe],v:N.val,t:N.t},P>0&&(v.z=M[v.ixfe>>8&63]),tn(v,t,r.opts.Date1904),H({c:N.c,r:N.r},v,t);break;case 638:v={ixfe:N.ixfe,XF:_[N.ixfe],v:N.rknum,t:"n"},P>0&&(v.z=M[v.ixfe>>8&63]),tn(v,t,r.opts.Date1904),H({c:N.c,r:N.r},v,t);break;case 189:for(var ue=N.c;ue<=N.C;++ue){var ae=N.rkrec[ue-N.c][0];v={ixfe:ae,XF:_[ae],v:N.rkrec[ue-N.c][1],t:"n"},P>0&&(v.z=M[v.ixfe>>8&63]),tn(v,t,r.opts.Date1904),H({c:ue,r:N.r},v,t)}break;case 6:case 518:case 1030:{if(N.val=="String"){l=N;break}if(v=Cu(N.val,N.cell.ixfe,N.tt),v.XF=_[v.ixfe],t.cellFormula){var ge=N.formula;if(ge&&ge[0]&&ge[0][0]&&ge[0][0][0]=="PtgExp"){var le=ge[0][0][1][0],je=ge[0][0][1][1],Ae=Ue({r:le,c:je});y[Ae]?v.f=""+br(N.formula,i,N.cell,V,W):v.F=((t.dense?(n[le]||[])[je]:n[Ae])||{}).F}else v.f=""+br(N.formula,i,N.cell,V,W)}P>0&&(v.z=M[v.ixfe>>8&63]),tn(v,t,r.opts.Date1904),H(N.cell,v,t),l=N}break;case 7:case 519:if(l)l.val=N,v=Cu(N,l.cell.ixfe,"s"),v.XF=_[v.ixfe],t.cellFormula&&(v.f=""+br(l.formula,i,l.cell,V,W)),P>0&&(v.z=M[v.ixfe>>8&63]),tn(v,t,r.opts.Date1904),H(l.cell,v,t),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{w.push(N);var Se=Ue(N[0].s);if(p=t.dense?(n[N[0].s.r]||[])[N[0].s.c]:n[Se],t.cellFormula&&p){if(!l||!Se||!p)break;p.f=""+br(N[1],i,N[0],V,W),p.F=qe(N[0])}}break;case 1212:{if(!t.cellFormula)break;if(h){if(!l)break;y[Ue(l.cell)]=N[0],p=t.dense?(n[l.cell.r]||[])[l.cell.c]:n[Ue(l.cell)],(p||{}).f=""+br(N[0],i,f,V,W)}}break;case 253:v=Cu(c[N.isst].t,N.ixfe,"s"),c[N.isst].h&&(v.h=c[N.isst].h),v.XF=_[v.ixfe],P>0&&(v.z=M[v.ixfe>>8&63]),tn(v,t,r.opts.Date1904),H({c:N.c,r:N.r},v,t);break;case 513:t.sheetStubs&&(v={ixfe:N.ixfe,XF:_[N.ixfe],t:"z"},P>0&&(v.z=M[v.ixfe>>8&63]),tn(v,t,r.opts.Date1904),H({c:N.c,r:N.r},v,t));break;case 190:if(t.sheetStubs)for(var Le=N.c;Le<=N.C;++Le){var We=N.ixfe[Le-N.c];v={ixfe:We,XF:_[We],t:"z"},P>0&&(v.z=M[v.ixfe>>8&63]),tn(v,t,r.opts.Date1904),H({c:Le,r:N.r},v,t)}break;case 214:case 516:case 4:v=Cu(N.val,N.ixfe,"s"),v.XF=_[v.ixfe],P>0&&(v.z=M[v.ixfe>>8&63]),tn(v,t,r.opts.Date1904),H({c:N.c,r:N.r},v,t);break;case 0:case 512:ve===1&&(i=N);break;case 252:c=N;break;case 1054:if(W.biff==4){M[P++]=N[1];for(var rt=0;rt<P+163&&Be[rt]!=N[1];++rt);rt>=163&&Nn(N[1],P+163)}else Nn(N[1],N[0]);break;case 30:{M[P++]=N;for(var vt=0;vt<P+163&&Be[vt]!=N;++vt);vt>=163&&Nn(N,P+163)}break;case 229:z=z.concat(N);break;case 93:Q[N.cmo[0]]=W.lastobj=N;break;case 438:W.lastobj.TxO=N;break;case 127:W.lastobj.ImData=N;break;case 440:for(g=N[0].s.r;g<=N[0].e.r;++g)for(x=N[0].s.c;x<=N[0].e.c;++x)p=t.dense?(n[g]||[])[x]:n[Ue({c:x,r:g})],p&&(p.l=N[1]);break;case 2048:for(g=N[0].s.r;g<=N[0].e.r;++g)for(x=N[0].s.c;x<=N[0].e.c;++x)p=t.dense?(n[g]||[])[x]:n[Ue({c:x,r:g})],p&&p.l&&(p.l.Tooltip=N[1]);break;case 28:{if(W.biff<=5&&W.biff>=2)break;p=t.dense?(n[N[0].r]||[])[N[0].c]:n[Ue(N[0])];var $r=Q[N[2]];p||(t.dense?(n[N[0].r]||(n[N[0].r]=[]),p=n[N[0].r][N[0].c]={t:"z"}):p=n[Ue(N[0])]={t:"z"},i.e.r=Math.max(i.e.r,N[0].r),i.s.r=Math.min(i.s.r,N[0].r),i.e.c=Math.max(i.e.c,N[0].c),i.s.c=Math.min(i.s.c,N[0].c)),p.c||(p.c=[]),m={a:N[1],t:$r.TxO.t},p.c.push(m)}break;case 2173:wM(_[N.ixfe],N.ext);break;case 125:{if(!W.cellStyles)break;for(;N.e>=N.s;)L[N.e--]={width:N.w/256,level:N.level||0,hidden:!!(N.flags&1)},K||(K=!0,Qx(N.w/256)),da(L[N.e+1])}break;case 520:{var Lt={};N.level!=null&&(X[N.r]=Lt,Lt.level=N.level),N.hidden&&(X[N.r]=Lt,Lt.hidden=!0),N.hpt&&(X[N.r]=Lt,Lt.hpt=N.hpt,Lt.hpx=No(N.hpt))}break;case 38:case 39:case 40:case 41:n["!margins"]||Ja(n["!margins"]={}),n["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[xe]]=N;break;case 161:n["!margins"]||Ja(n["!margins"]={}),n["!margins"].header=N.header,n["!margins"].footer=N.footer;break;case 574:N.RTL&&(S.Views[0].RTL=!0);break;case 146:k=N;break;case 2198:q=N;break;case 140:b=N;break;case 442:u?E.CodeName=N||E.name:S.WBProps.CodeName=N||"ThisWorkbook";break}}else ne||console.error("Missing Info for XLS Record 0x"+xe.toString(16)),e.l+=se}return r.SheetNames=Dt(a).sort(function(zr,Re){return Number(zr)-Number(Re)}).map(function(zr){return a[zr].name}),t.bookSheets||(r.Sheets=s),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&D.forEach(function(zr,Re){r.Sheets[r.SheetNames[Re]]["!autofilter"]=zr}),r.Strings=c,r.SSF=gt(Be),W.enc&&(r.Encryption=W.enc),q&&(r.Themes=q),r.Metadata={},b!==void 0&&(r.Metadata.Country=b),V.names.length>0&&(S.Names=V.names),r.Workbook=S,r}var Pl={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function I$(e,t,r){var s=De.find(e,"/!DocumentSummaryInformation");if(s&&s.size>0)try{var n=tw(s,km,Pl.DSI);for(var a in n)t[a]=n[a]}catch(u){if(r.WTF)throw u}var i=De.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var l=tw(i,Nm,Pl.SI);for(var c in l)t[c]==null&&(t[c]=l[c])}catch(u){if(r.WTF)throw u}t.HeadingPairs&&t.TitlesOfParts&&(ON(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function O$(e,t){var r=[],s=[],n=[],a=0,i,l=F1(km,"n"),c=F1(Nm,"n");if(e.Props)for(i=Dt(e.Props),a=0;a<i.length;++a)(Object.prototype.hasOwnProperty.call(l,i[a])?r:Object.prototype.hasOwnProperty.call(c,i[a])?s:n).push([i[a],e.Props[i[a]]]);if(e.Custprops)for(i=Dt(e.Custprops),a=0;a<i.length;++a)Object.prototype.hasOwnProperty.call(e.Props||{},i[a])||(Object.prototype.hasOwnProperty.call(l,i[a])?r:Object.prototype.hasOwnProperty.call(c,i[a])?s:n).push([i[a],e.Custprops[i[a]]]);var u=[];for(a=0;a<n.length;++a)zN.indexOf(n[a][0])>-1||IN.indexOf(n[a][0])>-1||n[a][1]!=null&&u.push(n[a]);s.length&&De.utils.cfb_add(t,"/SummaryInformation",rw(s,Pl.SI,c,Nm)),(r.length||u.length)&&De.utils.cfb_add(t,"/DocumentSummaryInformation",rw(r,Pl.DSI,l,km,u.length?u:null,Pl.UDI))}function Lj(e,t){t||(t={}),og(t),Tx(),t.codepage&&Ex(t.codepage);var r,s;if(e.FullPaths){if(De.find(e,"/encryption"))throw new Error("File is password-protected");r=De.find(e,"!CompObj"),s=De.find(e,"/Workbook")||De.find(e,"/Book")}else{switch(t.type){case"base64":e=is(fs(e));break;case"binary":e=is(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}dr(e,0),s={content:e}}var n,a;if(r&&A$(r),t.bookProps&&!t.bookSheets)n={};else{var i=Ke?"buffer":"array";if(s&&s.content)n=R$(s.content,t);else if((a=De.find(e,"PerfectOffice_MAIN"))&&a.content)n=Ya.to_workbook(a.content,(t.type=i,t));else if((a=De.find(e,"NativeContent_MAIN"))&&a.content)n=Ya.to_workbook(a.content,(t.type=i,t));else throw(a=De.find(e,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&De.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(n.vbaraw=KM(e))}var l={};return e.FullPaths&&I$(e,l,t),n.Props=n.Custprops=l,t.bookFiles&&(n.cfb=e),n}function D$(e,t){var r=t||{},s=De.utils.cfb_new({root:"R"}),n="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":n="/Workbook",r.biff=8;break;case"biff5":n="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return De.utils.cfb_add(s,n,Mj(e,r)),r.biff==8&&(e.Props||e.Custprops)&&O$(e,s),r.biff==8&&e.vbaraw&&XM(s,De.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),s}var gc={0:{f:iB},1:{f:mB},2:{f:RB},3:{f:_B},4:{f:vB},5:{f:AB},6:{f:MB},7:{f:jB},8:{f:HB},9:{f:WB},10:{f:zB},11:{f:VB},12:{f:xB},13:{f:OB},14:{f:kB},15:{f:wB},16:{f:Cj},17:{f:UB},18:{f:TB},19:{f:zx},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:UU},40:{},42:{},43:{f:ML},44:{f:DL},45:{f:$L},46:{f:VL},47:{f:zL},48:{},49:{f:cI},50:{},51:{f:SM},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:ZN},62:{f:LB},63:{f:PM},64:{f:oU},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Cr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:sU},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:fB},148:{f:cB,p:16},151:{f:JB},152:{},153:{f:LU},154:{},155:{},156:{f:OU},157:{},158:{},159:{T:1,f:ZD},160:{T:-1},161:{T:1,f:xi},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:qB},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:bM},336:{T:-1},337:{f:jM,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Sm},357:{},358:{},359:{},360:{T:1},361:{},362:{f:QN},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:QB},427:{f:ZB},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:tU},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:dB},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:XB},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Sm},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:VM},633:{T:1},634:{T:-1},635:{T:1,f:$M},636:{T:-1},637:{f:hI},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:kU},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:lU},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Fm={6:{f:Bf},10:{f:$n},12:{f:Gt},13:{f:Gt},14:{f:Mt},15:{f:Mt},16:{f:Nr},17:{f:Mt},18:{f:Mt},19:{f:Gt},20:{f:lw},21:{f:lw},23:{f:QN},24:{f:uw},25:{f:Mt},26:{},27:{},28:{f:lD},29:{},34:{f:Mt},35:{f:cw},38:{f:Nr},39:{f:Nr},40:{f:Nr},41:{f:Nr},42:{f:Mt},43:{f:Mt},47:{f:wL},49:{f:OO},51:{f:Gt},60:{},61:{f:AO},64:{f:Mt},65:{f:IO},66:{f:Gt},77:{},80:{},81:{},82:{},85:{f:Gt},89:{},90:{},91:{},92:{f:yO},93:{f:dD},94:{},95:{f:Mt},96:{},97:{},99:{f:Mt},125:{f:ZN},128:{f:YO},129:{f:bO},130:{f:Gt},131:{f:Mt},132:{f:Mt},133:{f:_O},134:{},140:{f:yD},141:{f:Gt},144:{},146:{f:_D},151:{},152:{},153:{},154:{},155:{},156:{f:Gt},157:{},158:{},160:{f:CD},161:{f:ND},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:qO},190:{f:GO},193:{f:$n},197:{},198:{},199:{},200:{},201:{},202:{f:Mt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Gt},220:{},221:{f:Mt},222:{},224:{f:XO},225:{f:vO},226:{f:$n},227:{},229:{f:cD},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:kO},253:{f:LO},255:{f:jO},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:VN},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Mt},353:{f:$n},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:tD},431:{f:Mt},432:{},433:{},434:{},437:{},438:{f:mD},439:{f:Mt},440:{f:pD},441:{},442:{f:Dc},443:{},444:{f:Gt},445:{},446:{},448:{f:$n},449:{f:CO,r:2},450:{f:$n},512:{f:aw},513:{f:TD},515:{f:ZO},516:{f:BO},517:{f:ow},519:{f:AD},520:{f:EO},523:{},545:{f:dw},549:{f:nw},566:{},574:{f:PO},638:{f:HO},659:{},1048:{},1054:{f:$O},1084:{},1212:{f:aD},2048:{f:gD},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:ju},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:$n},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:SD,r:12},2173:{f:yM,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Mt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:nD,r:12},2197:{},2198:{f:hM,r:12},2199:{},2200:{},2201:{},2202:{f:iD,r:12},2203:{f:$n},2204:{},2205:{},2206:{},2207:{},2211:{f:TO},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Gt},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:jD},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:bD},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:aw},1:{},2:{f:OD},3:{f:RD},4:{f:PD},5:{f:ow},7:{f:LD},8:{},9:{f:ju},11:{},22:{f:Gt},30:{f:VO},31:{},32:{},33:{f:dw},36:{},37:{f:nw},50:{f:MD},62:{},52:{},67:{},68:{f:Gt},69:{},86:{},126:{},127:{f:FD},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:BD},223:{},234:{},354:{},421:{},518:{f:Bf},521:{f:ju},536:{f:uw},547:{f:cw},561:{},579:{},1030:{f:Bf},1033:{f:ju},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ne(e,t,r,s){var n=t;if(!isNaN(n)){var a=s||(r||[]).length||0,i=e.next(4);i.write_shift(2,n),i.write_shift(2,a),a>0&&Bx(r)&&e.push(r)}}function L$(e,t,r,s){var n=(r||[]).length||0;if(n<=8224)return Ne(e,t,r,n);var a=t;if(!isNaN(a)){for(var i=r.parts||[],l=0,c=0,u=0;u+(i[l]||8224)<=8224;)u+=i[l]||8224,l++;var d=e.next(4);for(d.write_shift(2,a),d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u;c<n;){for(d=e.next(4),d.write_shift(2,60),u=0;u+(i[l]||8224)<=8224;)u+=i[l]||8224,l++;d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u}}}function Uc(e,t,r){return e||(e=oe(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function M$(e,t,r,s){var n=oe(9);return Uc(n,e,t),WN(r,s||"b",n),n}function B$(e,t,r){var s=oe(8+2*r.length);return Uc(s,e,t),s.write_shift(1,r.length),s.write_shift(r.length,r,"sbcs"),s.l<s.length?s.slice(0,s.l):s}function U$(e,t,r,s){if(t.v!=null)switch(t.t){case"d":case"n":var n=t.t=="d"?tr(xt(t.v)):t.v;n==(n|0)&&n>=0&&n<65536?Ne(e,2,DD(r,s,n)):Ne(e,3,ID(r,s,n));return;case"b":case"e":Ne(e,5,M$(r,s,t.v,t.t));return;case"s":case"str":Ne(e,4,B$(r,s,(t.v||"").slice(0,255)));return}Ne(e,1,Uc(null,r,s))}function $$(e,t,r,s){var n=Array.isArray(t),a=et(t["!ref"]||"A1"),i,l="",c=[];if(a.e.c>255||a.e.r>16383){if(s.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.c,16383),i=qe(a)}for(var u=a.s.r;u<=a.e.r;++u){l=zt(u);for(var d=a.s.c;d<=a.e.c;++d){u===a.s.r&&(c[d]=Tt(d)),i=c[d]+l;var f=n?(t[u]||[])[d]:t[i];f&&U$(e,f,u,d)}}}function z$(e,t){for(var r=t||{},s=Yr(),n=0,a=0;a<e.SheetNames.length;++a)e.SheetNames[a]==r.sheet&&(n=a);if(n==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Ne(s,r.biff==4?1033:r.biff==3?521:9,Xx(e,16,r)),$$(s,e.Sheets[e.SheetNames[n]],n,r),Ne(s,10),s.end()}function V$(e,t,r){Ne(e,49,DO({sz:12,name:"Arial"},r))}function W$(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var n=s[0];n<=s[1];++n)t[n]!=null&&Ne(e,1054,zO(n,t[n],r))})}function H$(e,t){var r=oe(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Ne(e,2151,r),r=oe(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),XN(et(t["!ref"]||"A1"),r),r.write_shift(4,4),Ne(e,2152,r)}function q$(e,t){for(var r=0;r<16;++r)Ne(e,224,iw({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(s){Ne(e,224,iw(s,0,t))})}function G$(e,t){for(var r=0;r<t["!links"].length;++r){var s=t["!links"][r];Ne(e,440,xD(s)),s[1].Tooltip&&Ne(e,2048,vD(s))}delete t["!links"]}function K$(e,t){if(t){var r=0;t.forEach(function(s,n){++r<=256&&s&&Ne(e,125,kD(k0(n,s),n))})}}function X$(e,t,r,s,n){var a=16+_a(n.cellXfs,t,n);if(t.v==null&&!t.bf){Ne(e,513,li(r,s,a));return}if(t.bf)Ne(e,6,b9(t,r,s,n,a));else switch(t.t){case"d":case"n":var i=t.t=="d"?tr(xt(t.v)):t.v;Ne(e,515,eD(r,s,i,a));break;case"b":case"e":Ne(e,517,QO(r,s,t.v,a,n,t.t));break;case"s":case"str":if(n.bookSST){var l=sg(n.Strings,t.v,n.revStrings);Ne(e,253,MO(r,s,l,a))}else Ne(e,516,UO(r,s,(t.v||"").slice(0,255),a,n));break;default:Ne(e,513,li(r,s,a))}}function Y$(e,t,r){var s=Yr(),n=r.SheetNames[e],a=r.Sheets[n]||{},i=(r||{}).Workbook||{},l=(i.Sheets||[])[e]||{},c=Array.isArray(a),u=t.biff==8,d,f="",h=[],p=et(a["!ref"]||"A1"),m=u?65536:16384;if(p.e.c>255||p.e.r>=m){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");p.e.c=Math.min(p.e.c,255),p.e.r=Math.min(p.e.c,m-1)}Ne(s,2057,Xx(r,16,t)),Ne(s,13,ks(1)),Ne(s,12,ks(100)),Ne(s,15,Ir(!0)),Ne(s,17,Ir(!1)),Ne(s,16,ii(.001)),Ne(s,95,Ir(!0)),Ne(s,42,Ir(!1)),Ne(s,43,Ir(!1)),Ne(s,130,ks(1)),Ne(s,128,JO()),Ne(s,131,Ir(!1)),Ne(s,132,Ir(!1)),u&&K$(s,a["!cols"]),Ne(s,512,WO(p,t)),u&&(a["!links"]=[]);for(var x=p.s.r;x<=p.e.r;++x){f=zt(x);for(var g=p.s.c;g<=p.e.c;++g){x===p.s.r&&(h[g]=Tt(g)),d=h[g]+f;var y=c?(a[x]||[])[g]:a[d];y&&(X$(s,y,x,g,t),u&&y.l&&a["!links"].push([d,y.l]))}}var w=l.CodeName||l.name||n;return u&&Ne(s,574,RO((i.Views||[])[0])),u&&(a["!merges"]||[]).length&&Ne(s,229,uD(a["!merges"])),u&&G$(s,a),Ne(s,442,HN(w)),u&&H$(s,a),Ne(s,10),s.end()}function J$(e,t,r){var s=Yr(),n=(e||{}).Workbook||{},a=n.Sheets||[],i=n.WBProps||{},l=r.biff==8,c=r.biff==5;if(Ne(s,2057,Xx(e,5,r)),r.bookType=="xla"&&Ne(s,135),Ne(s,225,l?ks(1200):null),Ne(s,193,QI(2)),c&&Ne(s,191),c&&Ne(s,192),Ne(s,226),Ne(s,92,wO("SheetJS",r)),Ne(s,66,ks(l?1200:1252)),l&&Ne(s,353,ks(0)),l&&Ne(s,448),Ne(s,317,ED(e.SheetNames.length)),l&&e.vbaraw&&Ne(s,211),l&&e.vbaraw){var u=i.CodeName||"ThisWorkbook";Ne(s,442,HN(u))}Ne(s,156,ks(17)),Ne(s,25,Ir(!1)),Ne(s,18,Ir(!1)),Ne(s,19,ks(0)),l&&Ne(s,431,Ir(!1)),l&&Ne(s,444,ks(0)),Ne(s,61,FO()),Ne(s,64,Ir(!1)),Ne(s,141,ks(0)),Ne(s,34,Ir(CU(e)=="true")),Ne(s,14,Ir(!0)),l&&Ne(s,439,Ir(!1)),Ne(s,218,ks(0)),V$(s,e,r),W$(s,e.SSF,r),q$(s,r),l&&Ne(s,352,Ir(!1));var d=s.end(),f=Yr();l&&Ne(f,140,wD()),l&&r.Strings&&L$(f,252,NO(r.Strings)),Ne(f,10);var h=f.end(),p=Yr(),m=0,x=0;for(x=0;x<e.SheetNames.length;++x)m+=(l?12:11)+(l?2:1)*e.SheetNames[x].length;var g=d.length+m+h.length;for(x=0;x<e.SheetNames.length;++x){var y=a[x]||{};Ne(p,133,SO({pos:g,hs:y.Hidden||0,dt:0,name:e.SheetNames[x]},r)),g+=t[x].length}var w=p.end();if(m!=w.length)throw new Error("BS8 "+m+" != "+w.length);var v=[];return d.length&&v.push(d),w.length&&v.push(w),h.length&&v.push(h),nr(v)}function Q$(e,t){var r=t||{},s=[];e&&!e.SSF&&(e.SSF=gt(Be)),e&&e.SSF&&(Lo(),g0(e.SSF),r.revssf=y0(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,lg(r),r.cellXfs=[],_a(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var n=0;n<e.SheetNames.length;++n)s[s.length]=Y$(n,r,e);return s.unshift(J$(e,s,r)),nr(s)}function Mj(e,t){for(var r=0;r<=e.SheetNames.length;++r){var s=e.Sheets[e.SheetNames[r]];if(!(!s||!s["!ref"])){var n=Jr(s["!ref"]);n.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var a=t||{};switch(a.biff||2){case 8:case 5:return Q$(e,t);case 4:case 3:case 2:return z$(e,t)}throw new Error("invalid type "+a.bookType+" for BIFF")}function bw(e,t){var r=t||{},s=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var n=e.match(/<table/i);if(!n)throw new Error("Invalid HTML: could not find <table>");var a=e.match(/<\/table/i),i=n.index,l=a&&a.index||e.length,c=D8(e.slice(i,l),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,d=0,f=0,h=0,p={s:{r:1e7,c:1e7},e:{r:0,c:0}},m=[];for(i=0;i<c.length;++i){var x=c[i].trim(),g=x.slice(0,3).toLowerCase();if(g=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}d=0;continue}if(!(g!="<td"&&g!="<th")){var y=x.split(/<\/t[dh]>/i);for(l=0;l<y.length;++l){var w=y[l].trim();if(w.match(/<t[dh]/i)){for(var v=w,b=0;v.charAt(0)=="<"&&(b=v.indexOf(">"))>-1;)v=v.slice(b+1);for(var _=0;_<m.length;++_){var k=m[_];k.s.c==d&&k.s.r<u&&u<=k.e.r&&(d=k.e.c+1,_=-1)}var S=ze(w.slice(0,w.indexOf(">")));h=S.colspan?+S.colspan:1,((f=+S.rowspan)>1||h>1)&&m.push({s:{r:u,c:d},e:{r:u+(f||1)-1,c:d+h-1}});var E=S.t||S["data-t"]||"";if(!v.length){d+=h;continue}if(v=lN(v),p.s.r>u&&(p.s.r=u),p.e.r<u&&(p.e.r=u),p.s.c>d&&(p.s.c=d),p.e.c<d&&(p.e.c=d),!v.length){d+=h;continue}var C={t:"s",v};r.raw||!v.trim().length||E=="s"||(v==="TRUE"?C={t:"b",v:!0}:v==="FALSE"?C={t:"b",v:!1}:isNaN(Js(v))?isNaN(So(v).getDate())||(C={t:"d",v:xt(v)},r.cellDates||(C={t:"n",v:tr(C.v)}),C.z=r.dateNF||Be[14]):C={t:"n",v:Js(v)}),r.dense?(s[u]||(s[u]=[]),s[u][d]=C):s[Ue({r:u,c:d})]=C,d+=h}}}}return s["!ref"]=qe(p),m.length&&(s["!merges"]=m),s}function Z$(e,t,r,s){for(var n=e["!merges"]||[],a=[],i=t.s.c;i<=t.e.c;++i){for(var l=0,c=0,u=0;u<n.length;++u)if(!(n[u].s.r>r||n[u].s.c>i)&&!(n[u].e.r<r||n[u].e.c<i)){if(n[u].s.r<r||n[u].s.c<i){l=-1;break}l=n[u].e.r-n[u].s.r+1,c=n[u].e.c-n[u].s.c+1;break}if(!(l<0)){var d=Ue({r,c:i}),f=s.dense?(e[r]||[])[i]:e[d],h=f&&f.v!=null&&(f.h||Dx(f.w||(In(f),f.w)||""))||"",p={};l>1&&(p.rowspan=l),c>1&&(p.colspan=c),s.editable?h='<span contenteditable="true">'+h+"</span>":f&&(p["data-t"]=f&&f.t||"z",f.v!=null&&(p["data-v"]=f.v),f.z!=null&&(p["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+f.l.Target+'">'+h+"</a>")),p.id=(s.id||"sjs")+"-"+d,a.push(ke("td",h,p))}}var m="<tr>";return m+a.join("")+"</tr>"}var ez='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',tz="</body></html>";function rz(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return ba(bw(r[0],t),t);var s=fg();return r.forEach(function(n,a){hg(s,bw(n,t),"Sheet"+(a+1))}),s}function sz(e,t,r){var s=[];return s.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function Bj(e,t){var r=t||{},s=r.header!=null?r.header:ez,n=r.footer!=null?r.footer:tz,a=[s],i=Jr(e["!ref"]);r.dense=Array.isArray(e),a.push(sz(e,i,r));for(var l=i.s.r;l<=i.e.r;++l)a.push(Z$(e,i,l,r));return a.push("</table>"+n),a.join("")}function Uj(e,t,r){var s=r||{},n=0,a=0;if(s.origin!=null)if(typeof s.origin=="number")n=s.origin;else{var i=typeof s.origin=="string"?Ct(s.origin):s.origin;n=i.r,a=i.c}var l=t.getElementsByTagName("tr"),c=Math.min(s.sheetRows||1e7,l.length),u={s:{r:0,c:0},e:{r:n,c:a}};if(e["!ref"]){var d=Jr(e["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),n==-1&&(u.e.r=n=d.e.r+1)}var f=[],h=0,p=e["!rows"]||(e["!rows"]=[]),m=0,x=0,g=0,y=0,w=0,v=0;for(e["!cols"]||(e["!cols"]=[]);m<l.length&&x<c;++m){var b=l[m];if(_w(b)){if(s.display)continue;p[x]={hidden:!0}}var _=b.children;for(g=y=0;g<_.length;++g){var k=_[g];if(!(s.display&&_w(k))){var S=k.hasAttribute("data-v")?k.getAttribute("data-v"):k.hasAttribute("v")?k.getAttribute("v"):lN(k.innerHTML),E=k.getAttribute("data-z")||k.getAttribute("z");for(h=0;h<f.length;++h){var C=f[h];C.s.c==y+a&&C.s.r<x+n&&x+n<=C.e.r&&(y=C.e.c+1-a,h=-1)}v=+k.getAttribute("colspan")||1,((w=+k.getAttribute("rowspan")||1)>1||v>1)&&f.push({s:{r:x+n,c:y+a},e:{r:x+n+(w||1)-1,c:y+a+(v||1)-1}});var U={t:"s",v:S},H=k.getAttribute("data-t")||k.getAttribute("t")||"";S!=null&&(S.length==0?U.t=H||"z":s.raw||S.trim().length==0||H=="s"||(S==="TRUE"?U={t:"b",v:!0}:S==="FALSE"?U={t:"b",v:!1}:isNaN(Js(S))?isNaN(So(S).getDate())||(U={t:"d",v:xt(S)},s.cellDates||(U={t:"n",v:tr(U.v)}),U.z=s.dateNF||Be[14]):U={t:"n",v:Js(S)})),U.z===void 0&&E!=null&&(U.z=E);var W="",q=k.getElementsByTagName("A");if(q&&q.length)for(var z=0;z<q.length&&!(q[z].hasAttribute("href")&&(W=q[z].getAttribute("href"),W.charAt(0)!="#"));++z);W&&W.charAt(0)!="#"&&(U.l={Target:W}),s.dense?(e[x+n]||(e[x+n]=[]),e[x+n][y+a]=U):e[Ue({c:y+a,r:x+n})]=U,u.e.c<y+a&&(u.e.c=y+a),y+=v}}++x}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),u.e.r=Math.max(u.e.r,x-1+n),e["!ref"]=qe(u),x>=c&&(e["!fullref"]=qe((u.e.r=l.length-m+x-1+n,u))),e}function $j(e,t){var r=t||{},s=r.dense?[]:{};return Uj(s,e,t)}function nz(e,t){return ba($j(e,t),t)}function _w(e){var t="",r=az(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function az(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function iz(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(s,n){return Array(parseInt(n,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Ze(t.replace(/<[^>]*>/g,""));return[r]}var Sw={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function zj(e,t){var r=t||{},s=Lx(e),n=[],a,i,l={name:""},c="",u=0,d,f,h={},p=[],m=r.dense?[]:{},x,g,y={value:""},w="",v=0,b=[],_=-1,k=-1,S={s:{r:1e6,c:1e7},e:{r:0,c:0}},E=0,C={},U=[],H={},W=0,q=0,z=[],Q=1,L=1,X=[],K={Names:[]},V={},fe=["",""],ve=[],P={},M="",D=0,B=!1,Y=!1,he=0;for(dc.lastIndex=0,s=s.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");x=dc.exec(s);)switch(x[3]=x[3].replace(/_.*$/,"")){case"table":case"":x[1]==="/"?(S.e.c>=S.s.c&&S.e.r>=S.s.r?m["!ref"]=qe(S):m["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=S.e.r&&(m["!fullref"]=m["!ref"],S.e.r=r.sheetRows-1,m["!ref"]=qe(S)),U.length&&(m["!merges"]=U),z.length&&(m["!rows"]=z),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),p.push(d.name),h[d.name]=m,Y=!1):x[0].charAt(x[0].length-2)!=="/"&&(d=ze(x[0],!1),_=k=-1,S.s.r=S.s.c=1e7,S.e.r=S.e.c=0,m=r.dense?[]:{},U=[],z=[],Y=!0);break;case"table-row-group":x[1]==="/"?--E:++E;break;case"table-row":case"":if(x[1]==="/"){_+=Q,Q=1;break}if(f=ze(x[0],!1),f.?_=f.-1:_==-1&&(_=0),Q=+f["number-rows-repeated"]||1,Q<10)for(he=0;he<Q;++he)E>0&&(z[_+he]={level:E});k=-1;break;case"covered-table-cell":x[1]!=="/"&&++k,r.sheetStubs&&(r.dense?(m[_]||(m[_]=[]),m[_][k]={t:"z"}):m[Ue({r:_,c:k})]={t:"z"}),w="",b=[];break;case"table-cell":case"":if(x[0].charAt(x[0].length-2)==="/")++k,y=ze(x[0],!1),L=parseInt(y["number-columns-repeated"]||"1",10),g={t:"z",v:null},y.formula&&r.cellFormula!=!1&&(g.f=vw(Ze(y.formula))),(y.||y["value-type"])=="string"&&(g.t="s",g.v=Ze(y["string-value"]||""),r.dense?(m[_]||(m[_]=[]),m[_][k]=g):m[Ue({r:_,c:k})]=g),k+=L-1;else if(x[1]!=="/"){++k,w="",v=0,b=[],L=1;var xe=Q?_+Q-1:_;if(k>S.e.c&&(S.e.c=k),k<S.s.c&&(S.s.c=k),_<S.s.r&&(S.s.r=_),xe>S.e.r&&(S.e.r=xe),y=ze(x[0],!1),ve=[],P={},g={t:y.||y["value-type"],v:null},r.cellFormula)if(y.formula&&(y.formula=Ze(y.formula)),y["number-matrix-columns-spanned"]&&y["number-matrix-rows-spanned"]&&(W=parseInt(y["number-matrix-rows-spanned"],10)||0,q=parseInt(y["number-matrix-columns-spanned"],10)||0,H={s:{r:_,c:k},e:{r:_+W-1,c:k+q-1}},g.F=qe(H),X.push([H,g.F])),y.formula)g.f=vw(y.formula);else for(he=0;he<X.length;++he)_>=X[he][0].s.r&&_<=X[he][0].e.r&&k>=X[he][0].s.c&&k<=X[he][0].e.c&&(g.F=X[he][1]);switch((y["number-columns-spanned"]||y["number-rows-spanned"])&&(W=parseInt(y["number-rows-spanned"],10)||0,q=parseInt(y["number-columns-spanned"],10)||0,H={s:{r:_,c:k},e:{r:_+W-1,c:k+q-1}},U.push(H)),y["number-columns-repeated"]&&(L=parseInt(y["number-columns-repeated"],10)),g.t){case"boolean":g.t="b",g.v=mt(y["boolean-value"]);break;case"float":g.t="n",g.v=parseFloat(y.value);break;case"percentage":g.t="n",g.v=parseFloat(y.value);break;case"currency":g.t="n",g.v=parseFloat(y.value);break;case"date":g.t="d",g.v=xt(y["date-value"]),r.cellDates||(g.t="n",g.v=tr(g.v)),g.z="m/d/yy";break;case"time":g.t="n",g.v=R8(y["time-value"])/86400,r.cellDates&&(g.t="d",g.v=w0(g.v)),g.z="HH:MM:SS";break;case"number":g.t="n",g.v=parseFloat(y.);break;default:if(g.t==="string"||g.t==="text"||!g.t)g.t="s",y["string-value"]!=null&&(w=Ze(y["string-value"]),b=[]);else throw new Error("Unsupported value type "+g.t)}}else{if(B=!1,g.t==="s"&&(g.v=w||"",b.length&&(g.R=b),B=v==0),V.Target&&(g.l=V),ve.length>0&&(g.c=ve,ve=[]),w&&r.cellText!==!1&&(g.w=w),B&&(g.t="z",delete g.v),(!B||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=_))for(var se=0;se<Q;++se){if(L=parseInt(y["number-columns-repeated"]||"1",10),r.dense)for(m[_+se]||(m[_+se]=[]),m[_+se][k]=se==0?g:gt(g);--L>0;)m[_+se][k+L]=gt(g);else for(m[Ue({r:_+se,c:k})]=g;--L>0;)m[Ue({r:_+se,c:k+L})]=gt(g);S.e.c<=k&&(S.e.c=k)}L=parseInt(y["number-columns-repeated"]||"1",10),k+=L-1,L=0,g={},w="",b=[]}V={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(x[1]==="/"){if((a=n.pop())[0]!==x[3])throw"Bad state: "+a}else x[0].charAt(x[0].length-2)!=="/"&&n.push([x[3],!0]);break;case"annotation":if(x[1]==="/"){if((a=n.pop())[0]!==x[3])throw"Bad state: "+a;P.t=w,b.length&&(P.R=b),P.a=M,ve.push(P)}else x[0].charAt(x[0].length-2)!=="/"&&n.push([x[3],!1]);M="",D=0,w="",v=0,b=[];break;case"creator":x[1]==="/"?M=s.slice(D,x.index):D=x.index+x[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(x[1]==="/"){if((a=n.pop())[0]!==x[3])throw"Bad state: "+a}else x[0].charAt(x[0].length-2)!=="/"&&n.push([x[3],!1]);w="",v=0,b=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(x[1]==="/"){if(C[l.name]=c,(a=n.pop())[0]!==x[3])throw"Bad state: "+a}else x[0].charAt(x[0].length-2)!=="/"&&(c="",l=ze(x[0],!1),n.push([x[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(n[n.length-1][0]){case"time-style":case"date-style":i=ze(x[0],!1),c+=Sw[x[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(n[n.length-1][0]){case"time-style":case"date-style":i=ze(x[0],!1),c+=Sw[x[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(x[0].slice(-2)==="/>")break;if(x[1]==="/")switch(n[n.length-1][0]){case"number-style":case"date-style":case"time-style":c+=s.slice(u,x.index);break}else u=x.index+x[0].length;break;case"named-range":i=ze(x[0],!1),fe=Uf(i["cell-range-address"]);var ne={Name:i.name,Ref:fe[0]+"!"+fe[1]};Y&&(ne.Sheet=p.length),K.Names.push(ne);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(n[n.length-1][0])>-1)break;if(x[1]==="/"&&(!y||!y["string-value"])){var be=iz(s.slice(v,x.index));w=(w.length>0?w+`
`:"")+be[0]}else ze(x[0],!1),v=x.index+x[0].length;break;case"s":break;case"database-range":if(x[1]==="/")break;try{fe=Uf(ze(x[0])["target-range-address"]),h[fe[0]]["!autofilter"]={ref:fe[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(x[1]!=="/"){if(V=ze(x[0],!1),!V.href)break;V.Target=Ze(V.href),delete V.href,V.Target.charAt(0)=="#"&&V.Target.indexOf(".")>-1?(fe=Uf(V.Target.slice(1)),V.Target="#"+fe[0]+"!"+fe[1]):V.Target.match(/^\.\.[\\\/]/)&&(V.Target=V.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(x[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(x)}}var N={Sheets:h,SheetNames:p,Workbook:K};return r.bookSheets&&delete N.Sheets,N}function kw(e,t){t=t||{},Ss(e,"META-INF/manifest.xml")&&RI(qt(e,"META-INF/manifest.xml"),t);var r=os(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var s=zj(ct(r),t);return Ss(e,"meta.xml")&&(s.Props=PN(qt(e,"meta.xml"))),s}function Nw(e,t){return zj(e,t)}var oz=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+uc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Vt+t}}(),jw=function(){var e=function(a){return ot(a).replace(/  +/g,function(i){return'<text:s text:c="'+i.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,s=function(a,i,l){var c=[];c.push('      <table:table table:name="'+ot(i.SheetNames[l])+`" table:style-name="ta1">
`);var u=0,d=0,f=Jr(a["!ref"]||"A1"),h=a["!merges"]||[],p=0,m=Array.isArray(a);if(a["!cols"])for(d=0;d<=f.e.c;++d)c.push("        <table:table-column"+(a["!cols"][d]?' table:style-name="co'+a["!cols"][d].ods+'"':"")+`></table:table-column>
`);var x="",g=a["!rows"]||[];for(u=0;u<f.s.r;++u)x=g[u]?' table:style-name="ro'+g[u].ods+'"':"",c.push("        <table:table-row"+x+`></table:table-row>
`);for(;u<=f.e.r;++u){for(x=g[u]?' table:style-name="ro'+g[u].ods+'"':"",c.push("        <table:table-row"+x+`>
`),d=0;d<f.s.c;++d)c.push(t);for(;d<=f.e.c;++d){var y=!1,w={},v="";for(p=0;p!=h.length;++p)if(!(h[p].s.c>d)&&!(h[p].s.r>u)&&!(h[p].e.c<d)&&!(h[p].e.r<u)){(h[p].s.c!=d||h[p].s.r!=u)&&(y=!0),w["table:number-columns-spanned"]=h[p].e.c-h[p].s.c+1,w["table:number-rows-spanned"]=h[p].e.r-h[p].s.r+1;break}if(y){c.push(r);continue}var b=Ue({r:u,c:d}),_=m?(a[u]||[])[d]:a[b];if(_&&_.f&&(w["table:formula"]=ot(E9(_.f)),_.F&&_.F.slice(0,b.length)==b)){var k=Jr(_.F);w["table:number-matrix-columns-spanned"]=k.e.c-k.s.c+1,w["table:number-matrix-rows-spanned"]=k.e.r-k.s.r+1}if(!_){c.push(t);continue}switch(_.t){case"b":v=_.v?"TRUE":"FALSE",w["office:value-type"]="boolean",w["office:boolean-value"]=_.v?"true":"false";break;case"n":v=_.w||String(_.v||0),w["office:value-type"]="float",w["office:value"]=_.v||0;break;case"s":case"str":v=_.v==null?"":_.v,w["office:value-type"]="string";break;case"d":v=_.w||xt(_.v).toISOString(),w["office:value-type"]="date",w["office:date-value"]=xt(_.v).toISOString(),w["table:style-name"]="ce1";break;default:c.push(t);continue}var S=e(v);if(_.l&&_.l.Target){var E=_.l.Target;E=E.charAt(0)=="#"?"#"+T9(E.slice(1)):E,E.charAt(0)!="#"&&!E.match(/^\w+:/)&&(E="../"+E),S=ke("text:a",S,{"xlink:href":E.replace(/&/g,"&amp;")})}c.push("          "+ke("table:table-cell",ke("text:p",S,{}),w)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},n=function(a,i){a.push(` <office:automatic-styles>
`),a.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),a.push(`   <number:month number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:day number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:year/>
`),a.push(`  </number:date-style>
`);var l=0;i.SheetNames.map(function(u){return i.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var d=0;d<u["!cols"].length;++d)if(u["!cols"][d]){var f=u["!cols"][d];if(f.width==null&&f.wpx==null&&f.wch==null)continue;da(f),f.ods=l;var h=u["!cols"][d].wpx+"px";a.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),a.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+h+`"/>
`),a.push(`  </style:style>
`),++l}}});var c=0;i.SheetNames.map(function(u){return i.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var d=0;d<u["!rows"].length;++d)if(u["!rows"][d]){u["!rows"][d].ods=c;var f=u["!rows"][d].hpx+"px";a.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),a.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),a.push(`  </style:style>
`),++c}}}),a.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),a.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),a.push(`  </style:style>
`),a.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),a.push(` </office:automatic-styles>
`)};return function(i,l){var c=[Vt],u=uc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=uc({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(c.push("<office:document"+u+d+`>
`),c.push(FN().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+u+`>
`),n(c,i),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var f=0;f!=i.SheetNames.length;++f)c.push(s(i.Sheets[i.SheetNames[f]],i,f));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),l.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function Vj(e,t){if(t.bookType=="fods")return jw(e,t);var r=Rx(),s="",n=[],a=[];return s="mimetype",Ge(r,s,"application/vnd.oasis.opendocument.spreadsheet"),s="content.xml",Ge(r,s,jw(e,t)),n.push([s,"text/xml"]),a.push([s,"ContentFile"]),s="styles.xml",Ge(r,s,oz(e,t)),n.push([s,"text/xml"]),a.push([s,"StylesFile"]),s="meta.xml",Ge(r,s,Vt+FN()),n.push([s,"text/xml"]),a.push([s,"MetadataFile"]),s="manifest.rdf",Ge(r,s,DI(a)),n.push([s,"application/rdf+xml"]),s="META-INF/manifest.xml",Ge(r,s,II(n)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function ci(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Pm(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):ct(wa(e))}function lz(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):is(on(e))}function cz(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var s=0;s<t.length;++s)if(e[r+s]!=t[s])continue e;return!0}return!1}function ha(e){var t=e.reduce(function(n,a){return n+a.length},0),r=new Uint8Array(t),s=0;return e.forEach(function(n){r.set(n,s),s+=n.length}),r}function Ew(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function uz(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,s=e[t+14]&1,n=t+13;n>=t;--n)s=s*256+e[n];return(e[t+15]&128?-s:s)*Math.pow(10,r-6176)}function dz(e,t,r){var s=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,n=r/Math.pow(10,s-6176);e[t+15]|=s>>7,e[t+14]|=(s&127)<<1;for(var a=0;n>=1;++a,n/=256)e[t+a]=n&255;e[t+15]|=r>=0?0:128}function vc(e,t){var r=t?t[0]:0,s=e[r]&127;e:if(e[r++]>=128&&(s|=(e[r]&127)<<7,e[r++]<128||(s|=(e[r]&127)<<14,e[r++]<128)||(s|=(e[r]&127)<<21,e[r++]<128)||(s+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(s+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(s+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),s}function nt(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Ot(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function tt(e){for(var t=[],r=[0];r[0]<e.length;){var s=r[0],n=vc(e,r),a=n&7;n=Math.floor(n/8);var i=0,l;if(n==0)break;switch(a){case 0:{for(var c=r[0];e[r[0]++]>=128;);l=e.slice(c,r[0])}break;case 5:i=4,l=e.slice(r[0],r[0]+i),r[0]+=i;break;case 1:i=8,l=e.slice(r[0],r[0]+i),r[0]+=i;break;case 2:i=vc(e,r),l=e.slice(r[0],r[0]+i),r[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(n," at offset ").concat(s))}var u={data:l,type:a};t[n]==null?t[n]=[u]:t[n].push(u)}return t}function lr(e){var t=[];return e.forEach(function(r,s){r.forEach(function(n){n.data&&(t.push(nt(s*8+n.type)),n.type==2&&t.push(nt(n.data.length)),t.push(n.data))})}),ha(t)}function ig(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function ws(e){for(var t,r=[],s=[0];s[0]<e.length;){var n=vc(e,s),a=tt(e.slice(s[0],s[0]+n));s[0]+=n;var i={id:Ot(a[1][0].data),messages:[]};a[2].forEach(function(l){var c=tt(l.data),u=Ot(c[3][0].data);i.messages.push({meta:c,data:e.slice(s[0],s[0]+u)}),s[0]+=u}),(t=a[3])!=null&&t[0]&&(i.merge=Ot(a[3][0].data)>>>0>0),r.push(i)}return r}function ji(e){var t=[];return e.forEach(function(r){var s=[];s[1]=[{data:nt(r.id),type:0}],s[2]=[],r.merge!=null&&(s[3]=[{data:nt(+!!r.merge),type:0}]);var n=[];r.messages.forEach(function(i){n.push(i.data),i.meta[3]=[{type:0,data:nt(i.data.length)}],s[2].push({data:lr(i.meta),type:2})});var a=lr(s);t.push(nt(a.length)),t.push(a),n.forEach(function(i){return t.push(i)})}),ha(t)}function fz(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],s=vc(t,r),n=[];r[0]<t.length;){var a=t[r[0]]&3;if(a==0){var i=t[r[0]++]>>2;if(i<60)++i;else{var l=i-59;i=t[r[0]],l>1&&(i|=t[r[0]+1]<<8),l>2&&(i|=t[r[0]+2]<<16),l>3&&(i|=t[r[0]+3]<<24),i>>>=0,i++,r[0]+=l}n.push(t.slice(r[0],r[0]+i)),r[0]+=i;continue}else{var c=0,u=0;if(a==1?(u=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,a==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),n=[ha(n)],c==0)throw new Error("Invalid offset 0");if(c>n[0].length)throw new Error("Invalid offset beyond length");if(u>=c)for(n.push(n[0].slice(-c)),u-=c;u>=n[n.length-1].length;)n.push(n[n.length-1]),u-=n[n.length-1].length;n.push(n[0].slice(-c,-c+u))}}var d=ha(n);if(d.length!=s)throw new Error("Unexpected length: ".concat(d.length," != ").concat(s));return d}function bs(e){for(var t=[],r=0;r<e.length;){var s=e[r++],n=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(fz(s,e.slice(r,r+n))),r+=n}if(r!==e.length)throw new Error("data is not a valid framed stream!");return ha(t)}function Ei(e){for(var t=[],r=0;r<e.length;){var s=Math.min(e.length-r,268435455),n=new Uint8Array(4);t.push(n);var a=nt(s),i=a.length;t.push(a),s<=60?(i++,t.push(new Uint8Array([s-1<<2]))):s<=256?(i+=2,t.push(new Uint8Array([240,s-1&255]))):s<=65536?(i+=3,t.push(new Uint8Array([244,s-1&255,s-1>>8&255]))):s<=16777216?(i+=4,t.push(new Uint8Array([248,s-1&255,s-1>>8&255,s-1>>16&255]))):s<=4294967296&&(i+=5,t.push(new Uint8Array([252,s-1&255,s-1>>8&255,s-1>>16&255,s-1>>>24&255]))),t.push(e.slice(r,r+s)),i+=s,n[0]=0,n[1]=i&255,n[2]=i>>8&255,n[3]=i>>16&255,r+=s}return ha(t)}function hz(e,t,r,s){var n=ci(e),a=n.getUint32(4,!0),i=(s>1?12:8)+Ew(a&(s>1?3470:398))*4,l=-1,c=-1,u=NaN,d=new Date(2001,0,1);a&512&&(l=n.getUint32(i,!0),i+=4),i+=Ew(a&(s>1?12288:4096))*4,a&16&&(c=n.getUint32(i,!0),i+=4),a&32&&(u=n.getFloat64(i,!0),i+=8),a&64&&(d.setTime(d.getTime()+n.getFloat64(i,!0)*1e3),i+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:u};break;case 3:f={t:"s",v:t[c]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(l>-1)f={t:"s",v:r[l]};else if(c>-1)f={t:"s",v:t[c]};else if(!isNaN(u))f={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function mz(e,t,r){var s=ci(e),n=s.getUint32(8,!0),a=12,i=-1,l=-1,c=NaN,u=NaN,d=new Date(2001,0,1);n&1&&(c=uz(e,a),a+=16),n&2&&(u=s.getFloat64(a,!0),a+=8),n&4&&(d.setTime(d.getTime()+s.getFloat64(a,!0)*1e3),a+=8),n&8&&(l=s.getUint32(a,!0),a+=4),n&16&&(i=s.getUint32(a,!0),a+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:t[l]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(i>-1)f={t:"s",v:r[i]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)))}return f}function zf(e,t){var r=new Uint8Array(32),s=ci(r),n=12,a=0;switch(r[0]=5,e.t){case"n":r[1]=2,dz(r,n,e.v),a|=1,n+=16;break;case"b":r[1]=6,s.setFloat64(n,e.v?1:0,!0),a|=2,n+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,s.setUint32(n,t.indexOf(e.v),!0),a|=8,n+=4;break;default:throw"unsupported cell type "+e.t}return s.setUint32(8,a,!0),r.slice(0,n)}function Vf(e,t){var r=new Uint8Array(32),s=ci(r),n=12,a=0;switch(r[0]=3,e.t){case"n":r[2]=2,s.setFloat64(n,e.v,!0),a|=32,n+=8;break;case"b":r[2]=6,s.setFloat64(n,e.v?1:0,!0),a|=32,n+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,s.setUint32(n,t.indexOf(e.v),!0),a|=16,n+=4;break;default:throw"unsupported cell type "+e.t}return s.setUint32(4,a,!0),r.slice(0,n)}function pz(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return hz(e,t,r,e[0]);case 5:return mz(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function wr(e){var t=tt(e);return vc(t[1][0].data)}function Tw(e,t){var r=tt(t.data),s=Ot(r[1][0].data),n=r[3],a=[];return(n||[]).forEach(function(i){var l=tt(i.data),c=Ot(l[1][0].data)>>>0;switch(s){case 1:a[c]=Pm(l[3][0].data);break;case 8:{var u=e[wr(l[9][0].data)][0],d=tt(u.data),f=e[wr(d[1][0].data)][0],h=Ot(f.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var p=tt(f.data);a[c]=p[3].map(function(m){return Pm(m.data)}).join("")}break}}),a}function xz(e,t){var r,s,n,a,i,l,c,u,d,f,h,p,m,x,g=tt(e),y=Ot(g[1][0].data)>>>0,w=Ot(g[2][0].data)>>>0,v=((s=(r=g[8])==null?void 0:r[0])==null?void 0:s.data)&&Ot(g[8][0].data)>0||!1,b,_;if((a=(n=g[7])==null?void 0:n[0])!=null&&a.data&&t!=0)b=(l=(i=g[7])==null?void 0:i[0])==null?void 0:l.data,_=(u=(c=g[6])==null?void 0:c[0])==null?void 0:u.data;else if((f=(d=g[4])==null?void 0:d[0])!=null&&f.data&&t!=1)b=(p=(h=g[4])==null?void 0:h[0])==null?void 0:p.data,_=(x=(m=g[3])==null?void 0:m[0])==null?void 0:x.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var k=v?4:1,S=ci(b),E=[],C=0;C<b.length/2;++C){var U=S.getUint16(C*2,!0);U<65535&&E.push([C,U])}if(E.length!=w)throw"Expected ".concat(w," cells, found ").concat(E.length);var H=[];for(C=0;C<E.length-1;++C)H[E[C][0]]=_.subarray(E[C][1]*k,E[C+1][1]*k);return E.length>=1&&(H[E[E.length-1][0]]=_.subarray(E[E.length-1][1]*k)),{R:y,cells:H}}function gz(e,t){var r,s=tt(t.data),n=(r=s==null?void 0:s[7])!=null&&r[0]?Ot(s[7][0].data)>>>0>0?1:0:-1,a=ig(s[5],function(i){return xz(i,n)});return{nrows:Ot(s[4][0].data)>>>0,data:a.reduce(function(i,l){return i[l.R]||(i[l.R]=[]),l.cells.forEach(function(c,u){if(i[l.R][u])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(u));i[l.R][u]=c}),i},[])}}function vz(e,t,r){var s,n=tt(t.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(Ot(n[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(n[6][0].data));if(a.e.c=(Ot(n[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(n[7][0].data));r["!ref"]=qe(a);var i=tt(n[4][0].data),l=Tw(e,e[wr(i[4][0].data)][0]),c=(s=i[17])!=null&&s[0]?Tw(e,e[wr(i[17][0].data)][0]):[],u=tt(i[3][0].data),d=0;u[1].forEach(function(f){var h=tt(f.data),p=e[wr(h[2][0].data)][0],m=Ot(p.meta[1][0].data);if(m!=6002)throw new Error("6001 unexpected reference to ".concat(m));var x=gz(e,p);x.data.forEach(function(g,y){g.forEach(function(w,v){var b=Ue({r:d+y,c:v}),_=pz(w,l,c);_&&(r[b]=_)})}),d+=x.nrows})}function yz(e,t){var r=tt(t.data),s={"!ref":"A1"},n=e[wr(r[2][0].data)],a=Ot(n[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return vz(e,n[0],s),s}function wz(e,t){var r,s=tt(t.data),n={name:(r=s[1])!=null&&r[0]?Pm(s[1][0].data):"",sheets:[]},a=ig(s[2],wr);return a.forEach(function(i){e[i].forEach(function(l){var c=Ot(l.meta[1][0].data);c==6e3&&n.sheets.push(yz(e,l))})}),n}function bz(e,t){var r=fg(),s=tt(t.data),n=ig(s[1],wr);if(n.forEach(function(a){e[a].forEach(function(i){var l=Ot(i.meta[1][0].data);if(l==2){var c=wz(e,i);c.sheets.forEach(function(u,d){hg(r,u,d==0?c.name:c.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Wf(e){var t,r,s,n,a={},i=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var u;try{u=bs(c.content)}catch(f){return console.log("?? "+c.content.length+" "+(f.message||f))}var d;try{d=ws(u)}catch(f){return console.log("## "+(f.message||f))}d.forEach(function(f){a[f.id]=f.messages,i.push(f.id)})}}),!i.length)throw new Error("File has no messages");var l=((n=(s=(r=(t=a==null?void 0:a[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:s[1])==null?void 0:n[0].data)&&Ot(a[1][0].meta[1][0].data)==1&&a[1][0];if(l||i.forEach(function(c){a[c].forEach(function(u){var d=Ot(u.meta[1][0].data)>>>0;if(d==1)if(!l)l=u;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return bz(a,l)}function _z(e,t,r){var s,n,a,i;if(!((s=e[6])!=null&&s[0])||!((n=e[7])!=null&&n[0]))throw"Mutation only works on post-BNC storages!";var l=((i=(a=e[8])==null?void 0:a[0])==null?void 0:i.data)&&Ot(e[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var c=0,u=ci(e[7][0].data),d=0,f=[],h=ci(e[4][0].data),p=0,m=[],x=0;x<t.length;++x){if(t[x]==null){u.setUint16(x*2,65535,!0),h.setUint16(x*2,65535);continue}u.setUint16(x*2,d,!0),h.setUint16(x*2,p,!0);var g,y;switch(typeof t[x]){case"string":g=zf({t:"s",v:t[x]},r),y=Vf({t:"s",v:t[x]},r);break;case"number":g=zf({t:"n",v:t[x]},r),y=Vf({t:"n",v:t[x]},r);break;case"boolean":g=zf({t:"b",v:t[x]},r),y=Vf({t:"b",v:t[x]},r);break;default:throw new Error("Unsupported value "+t[x])}f.push(g),d+=g.length,m.push(y),p+=y.length,++c}for(e[2][0].data=nt(c);x<e[7][0].data.length/2;++x)u.setUint16(x*2,65535,!0),h.setUint16(x*2,65535,!0);return e[6][0].data=ha(f),e[3][0].data=ha(m),c}function Sz(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var s=Jr(r["!ref"]);s.s.r=s.s.c=0;var n=!1;s.e.c>9&&(n=!0,s.e.c=9),s.e.r>49&&(n=!0,s.e.r=49),n&&console.error("The Numbers writer is currently limited to ".concat(qe(s)));var a=Wd(r,{range:s,header:1}),i=["~Sh33tJ5~"];a.forEach(function(M){return M.forEach(function(D){typeof D=="string"&&i.push(D)})});var l={},c=[],u=De.read(t.numbers,{type:"base64"});u.FileIndex.map(function(M,D){return[M,u.FullPaths[D]]}).forEach(function(M){var D=M[0],B=M[1];if(D.type==2&&D.name.match(/\.iwa/)){var Y=D.content,he=bs(Y),xe=ws(he);xe.forEach(function(se){c.push(se.id),l[se.id]={deps:[],location:B,type:Ot(se.messages[0].meta[1][0].data)}})}}),c.sort(function(M,D){return M-D});var d=c.filter(function(M){return M>1}).map(function(M){return[M,nt(M)]});u.FileIndex.map(function(M,D){return[M,u.FullPaths[D]]}).forEach(function(M){var D=M[0];if(M[1],!!D.name.match(/\.iwa/)){var B=ws(bs(D.content));B.forEach(function(Y){Y.messages.forEach(function(he){d.forEach(function(xe){Y.messages.some(function(se){return Ot(se.meta[1][0].data)!=11006&&cz(se.data,xe[1])})&&l[xe[0]].deps.push(Y.id)})})})}});for(var f=De.find(u,l[1].location),h=ws(bs(f.content)),p,m=0;m<h.length;++m){var x=h[m];x.id==1&&(p=x)}var g=wr(tt(p.messages[0].data)[1][0].data);for(f=De.find(u,l[g].location),h=ws(bs(f.content)),m=0;m<h.length;++m)x=h[m],x.id==g&&(p=x);for(g=wr(tt(p.messages[0].data)[2][0].data),f=De.find(u,l[g].location),h=ws(bs(f.content)),m=0;m<h.length;++m)x=h[m],x.id==g&&(p=x);for(g=wr(tt(p.messages[0].data)[2][0].data),f=De.find(u,l[g].location),h=ws(bs(f.content)),m=0;m<h.length;++m)x=h[m],x.id==g&&(p=x);var y=tt(p.messages[0].data);{y[6][0].data=nt(s.e.r+1),y[7][0].data=nt(s.e.c+1);var w=wr(y[46][0].data),v=De.find(u,l[w].location),b=ws(bs(v.content));{for(var _=0;_<b.length&&b[_].id!=w;++_);if(b[_].id!=w)throw"Bad ColumnRowUIDMapArchive";var k=tt(b[_].messages[0].data);k[1]=[],k[2]=[],k[3]=[];for(var S=0;S<=s.e.c;++S){var E=[];E[1]=E[2]=[{type:0,data:nt(S+420690)}],k[1].push({type:2,data:lr(E)}),k[2].push({type:0,data:nt(S)}),k[3].push({type:0,data:nt(S)})}k[4]=[],k[5]=[],k[6]=[];for(var C=0;C<=s.e.r;++C)E=[],E[1]=E[2]=[{type:0,data:nt(C+726270)}],k[4].push({type:2,data:lr(E)}),k[5].push({type:0,data:nt(C)}),k[6].push({type:0,data:nt(C)});b[_].messages[0].data=lr(k)}v.content=Ei(ji(b)),v.size=v.content.length,delete y[46];var U=tt(y[4][0].data);{U[7][0].data=nt(s.e.r+1);var H=tt(U[1][0].data),W=wr(H[2][0].data);v=De.find(u,l[W].location),b=ws(bs(v.content));{if(b[0].id!=W)throw"Bad HeaderStorageBucket";var q=tt(b[0].messages[0].data);for(C=0;C<a.length;++C){var z=tt(q[2][0].data);z[1][0].data=nt(C),z[4][0].data=nt(a[C].length),q[2][C]={type:q[2][0].type,data:lr(z)}}b[0].messages[0].data=lr(q)}v.content=Ei(ji(b)),v.size=v.content.length;var Q=wr(U[2][0].data);v=De.find(u,l[Q].location),b=ws(bs(v.content));{if(b[0].id!=Q)throw"Bad HeaderStorageBucket";for(q=tt(b[0].messages[0].data),S=0;S<=s.e.c;++S)z=tt(q[2][0].data),z[1][0].data=nt(S),z[4][0].data=nt(s.e.r+1),q[2][S]={type:q[2][0].type,data:lr(z)};b[0].messages[0].data=lr(q)}v.content=Ei(ji(b)),v.size=v.content.length;var L=wr(U[4][0].data);(function(){for(var M=De.find(u,l[L].location),D=ws(bs(M.content)),B,Y=0;Y<D.length;++Y){var he=D[Y];he.id==L&&(B=he)}var xe=tt(B.messages[0].data);{xe[3]=[];var se=[];i.forEach(function(N,G){se[1]=[{type:0,data:nt(G)}],se[2]=[{type:0,data:nt(1)}],se[3]=[{type:2,data:lz(N)}],xe[3].push({type:2,data:lr(se)})})}B.messages[0].data=lr(xe);var ne=ji(D),be=Ei(ne);M.content=be,M.size=M.content.length})();var X=tt(U[3][0].data);{var K=X[1][0];delete X[2];var V=tt(K.data);{var fe=wr(V[2][0].data);(function(){for(var M=De.find(u,l[fe].location),D=ws(bs(M.content)),B,Y=0;Y<D.length;++Y){var he=D[Y];he.id==fe&&(B=he)}var xe=tt(B.messages[0].data);{delete xe[6],delete X[7];var se=new Uint8Array(xe[5][0].data);xe[5]=[];for(var ne=0,be=0;be<=s.e.r;++be){var N=tt(se);ne+=_z(N,a[be],i),N[1][0].data=nt(be),xe[5].push({data:lr(N),type:2})}xe[1]=[{type:0,data:nt(s.e.c+1)}],xe[2]=[{type:0,data:nt(s.e.r+1)}],xe[3]=[{type:0,data:nt(ne)}],xe[4]=[{type:0,data:nt(s.e.r+1)}]}B.messages[0].data=lr(xe);var G=ji(D),ce=Ei(G);M.content=ce,M.size=M.content.length})()}K.data=lr(V)}U[3][0].data=lr(X)}y[4][0].data=lr(U)}p.messages[0].data=lr(y);var ve=ji(h),P=Ei(ve);return f.content=P,f.size=f.content.length,u}function Wj(e){return function(r){for(var s=0;s!=e.length;++s){var n=e[s];r[n[0]]===void 0&&(r[n[0]]=n[1]),n[2]==="n"&&(r[n[0]]=Number(r[n[0]]))}}}function og(e){Wj([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function lg(e){Wj([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function kz(e){return Xe.WS.indexOf(e)>-1?"sheet":e==Xe.CS?"chart":e==Xe.DS?"dialog":e==Xe.MS?"macro":e&&e.length?e:"sheet"}function Nz(e,t){if(!e)return 0;try{e=t.map(function(s){return s.id||(s.id=s.strRelID),[s.name,e["!id"][s.id].Target,kz(e["!id"][s.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function jz(e,t,r,s,n,a,i,l,c,u,d,f){try{a[s]=Tl(os(e,r,!0),t);var h=qt(e,t),p;switch(l){case"sheet":p=KU(h,t,n,c,a[s],u,d,f);break;case"chart":if(p=XU(h,t,n,c,a[s],u,d,f),!p||!p["!drawel"])break;var m=ll(p["!drawel"].Target,t),x=fc(m),g=OM(os(e,m,!0),Tl(os(e,x,!0),m)),y=ll(g,m),w=fc(y);p=_U(os(e,y,!0),y,c,Tl(os(e,w,!0),y),u,p);break;case"macro":p=YU(h,t,n,c,a[s],u,d,f);break;case"dialog":p=JU(h,t,n,c,a[s],u,d,f);break;default:throw new Error("Unrecognized sheet type "+l)}i[s]=p;var v=[];a&&a[s]&&Dt(a[s]).forEach(function(b){var _="";if(a[s][b].Type==Xe.CMNT){_=ll(a[s][b].Target,t);var k=t$(qt(e,_,!0),_,c);if(!k||!k.length)return;hw(p,k,!1)}a[s][b].Type==Xe.TCMNT&&(_=ll(a[s][b].Target,t),v=v.concat(LM(qt(e,_,!0),c)))}),v&&v.length&&hw(p,v,!0,c.people||[])}catch(b){if(c.WTF)throw b}}function vs(e){return e.charAt(0)=="/"?e.slice(1):e}function Ez(e,t){if(Lo(),t=t||{},og(t),Ss(e,"META-INF/manifest.xml")||Ss(e,"objectdata.xml"))return kw(e,t);if(Ss(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Wf<"u"){if(e.FileIndex)return Wf(e);var r=De.utils.cfb_new();return I1(e).forEach(function(z){Ge(r,z,M8(e,z))}),Wf(r)}throw new Error("Unsupported NUMBERS file")}if(!Ss(e,"[Content_Types].xml"))throw Ss(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Ss(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var s=I1(e),n=FI(os(e,"[Content_Types].xml")),a=!1,i,l;if(n.workbooks.length===0&&(l="xl/workbook.xml",qt(e,l,!0)&&n.workbooks.push(l)),n.workbooks.length===0){if(l="xl/workbook.bin",!qt(e,l,!0))throw new Error("Could not find workbook");n.workbooks.push(l),a=!0}n.workbooks[0].slice(-3)=="bin"&&(a=!0);var c={},u={};if(!t.bookSheets&&!t.bookProps){if(Cl=[],n.sst)try{Cl=e$(qt(e,vs(n.sst)),n.sst,t)}catch(z){if(t.WTF)throw z}t.cellStyles&&n.themes.length&&(c=ZU(os(e,n.themes[0].replace(/^\//,""),!0)||"",n.themes[0],t)),n.style&&(u=QU(qt(e,vs(n.style)),n.style,c,t))}n.links.map(function(z){try{var Q=Tl(os(e,fc(vs(z))),z);return s$(qt(e,vs(z)),Q,z,t)}catch{}});var d=GU(qt(e,vs(n.workbooks[0])),n.workbooks[0],t),f={},h="";n.coreprops.length&&(h=qt(e,vs(n.coreprops[0]),!0),h&&(f=PN(h)),n.extprops.length!==0&&(h=qt(e,vs(n.extprops[0]),!0),h&&MI(h,f,t)));var p={};(!t.bookSheets||t.bookProps)&&n.custprops.length!==0&&(h=os(e,vs(n.custprops[0]),!0),h&&(p=UI(h,t)));var m={};if((t.bookSheets||t.bookProps)&&(d.Sheets?i=d.Sheets.map(function(Q){return Q.name}):f.Worksheets&&f.SheetNames.length>0&&(i=f.SheetNames),t.bookProps&&(m.Props=f,m.Custprops=p),t.bookSheets&&typeof i<"u"&&(m.SheetNames=i),t.bookSheets?m.SheetNames:t.bookProps))return m;i={};var x={};t.bookDeps&&n.calcchain&&(x=r$(qt(e,vs(n.calcchain)),n.calcchain));var g=0,y={},w,v;{var b=d.Sheets;f.Worksheets=b.length,f.SheetNames=[];for(var _=0;_!=b.length;++_)f.SheetNames[_]=b[_].name}var k=a?"bin":"xml",S=n.workbooks[0].lastIndexOf("/"),E=(n.workbooks[0].slice(0,S+1)+"_rels/"+n.workbooks[0].slice(S+1)+".rels").replace(/^\//,"");Ss(e,E)||(E="xl/_rels/workbook."+k+".rels");var C=Tl(os(e,E,!0),E.replace(/_rels.*/,"s5s"));(n.metadata||[]).length>=1&&(t.xlmeta=n$(qt(e,vs(n.metadata[0])),n.metadata[0],t)),(n.people||[]).length>=1&&(t.people=BM(qt(e,vs(n.people[0])),t)),C&&(C=Nz(C,d.Sheets));var U=qt(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(g=0;g!=f.Worksheets;++g){var H="sheet";if(C&&C[g]?(w="xl/"+C[g][1].replace(/[\/]?xl\//,""),Ss(e,w)||(w=C[g][1]),Ss(e,w)||(w=E.replace(/_rels\/.*$/,"")+C[g][1]),H=C[g][2]):(w="xl/worksheets/sheet"+(g+1-U)+"."+k,w=w.replace(/sheet0\./,"sheet.")),v=w.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(g!=t.sheets)continue e;break;case"string":if(f.SheetNames[g].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var W=!1,q=0;q!=t.sheets.length;++q)typeof t.sheets[q]=="number"&&t.sheets[q]==g&&(W=1),typeof t.sheets[q]=="string"&&t.sheets[q].toLowerCase()==f.SheetNames[g].toLowerCase()&&(W=1);if(!W)continue e}}jz(e,w,v,f.SheetNames[g],g,y,i,H,t,d,c,u)}return m={Directory:n,Workbook:d,Props:f,Custprops:p,Deps:x,Sheets:i,SheetNames:f.SheetNames,Strings:Cl,Styles:u,Themes:c,SSF:gt(Be)},t&&t.bookFiles&&(e.files?(m.keys=s,m.files=e.files):(m.keys=[],m.files={},e.FullPaths.forEach(function(z,Q){z=z.replace(/^Root Entry[\/]/,""),m.keys.push(z),m.files[z]=e.FileIndex[Q]}))),t&&t.bookVBA&&(n.vba.length>0?m.vbaraw=qt(e,vs(n.vba[0]),!0):n.defaults&&n.defaults.bin===GM&&(m.vbaraw=qt(e,"xl/vbaProject.bin",!0))),m}function Tz(e,t){var r=t||{},s="Workbook",n=De.find(e,s);try{if(s="/!DataSpaces/Version",n=De.find(e,s),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);if(nL(n.content),s="/!DataSpaces/DataSpaceMap",n=De.find(e,s),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);var a=iL(n.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+s);if(s="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",n=De.find(e,s),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);var i=oL(n.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+s);if(s="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",n=De.find(e,s),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);cL(n.content)}catch{}if(s="/EncryptionInfo",n=De.find(e,s),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);var l=uL(n.content);if(s="/EncryptedPackage",n=De.find(e,s),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);if(l[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(l[1],n.content,r.password||"",r);if(l[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(l[1],n.content,r.password||"",r);throw new Error("File is password-protected")}function Cz(e,t){return t.bookType=="ods"?Vj(e,t):t.bookType=="numbers"?Sz(e,t):t.bookType=="xlsb"?Az(e,t):Fz(e,t)}function Az(e,t){Xi=1024,e&&!e.SSF&&(e.SSF=gt(Be)),e&&e.SSF&&(Lo(),g0(e.SSF),t.revssf=y0(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Al?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",s=gj.indexOf(t.bookType)>-1,n=Gx();lg(t=t||{});var a=Rx(),i="",l=0;if(t.cellXfs=[],_a(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",Ge(a,i,RN(e.Props,t)),n.coreprops.push(i),at(t.rels,2,i,Xe.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,Ge(a,i,DN(e.Props)),n.extprops.push(i),at(t.rels,3,i,Xe.EXT_PROPS),e.Custprops!==e.Props&&Dt(e.Custprops||{}).length>0&&(i="docProps/custom.xml",Ge(a,i,LN(e.Custprops)),n.custprops.push(i),at(t.rels,4,i,Xe.CUST_PROPS)),l=1;l<=e.SheetNames.length;++l){var d={"!id":{}},f=e.Sheets[e.SheetNames[l-1]],h=(f||{})["!type"]||"sheet";switch(h){case"chart":default:i="xl/worksheets/sheet"+l+"."+r,Ge(a,i,i$(l-1,i,t,e,d)),n.sheets.push(i),at(t.wbrels,-1,"worksheets/sheet"+l+"."+r,Xe.WS[0])}if(f){var p=f["!comments"],m=!1,x="";p&&p.length>0&&(x="xl/comments"+l+"."+r,Ge(a,x,c$(p,x)),n.comments.push(x),at(d,-1,"../comments"+l+"."+r,Xe.CMNT),m=!0),f["!legacy"]&&m&&Ge(a,"xl/drawings/vmlDrawing"+l+".vml",pj(l,f["!comments"])),delete f["!comments"],delete f["!legacy"]}d["!id"].rId1&&Ge(a,fc(i),ao(d))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,Ge(a,i,l$(t.Strings,i,t)),n.strs.push(i),at(t.wbrels,-1,"sharedStrings."+r,Xe.SST)),i="xl/workbook."+r,Ge(a,i,a$(e,i)),n.workbooks.push(i),at(t.rels,1,i,Xe.WB),i="xl/theme/theme1.xml",Ge(a,i,Zx(e.Themes,t)),n.themes.push(i),at(t.wbrels,-1,"theme/theme1.xml",Xe.THEME),i="xl/styles."+r,Ge(a,i,o$(e,i,t)),n.styles.push(i),at(t.wbrels,-1,"styles."+r,Xe.STY),e.vbaraw&&s&&(i="xl/vbaProject.bin",Ge(a,i,e.vbaraw),n.vba.push(i),at(t.wbrels,-1,"vbaProject.bin",Xe.VBA)),i="xl/metadata."+r,Ge(a,i,u$(i)),n.metadata.push(i),at(t.wbrels,-1,"metadata."+r,Xe.XLMETA),Ge(a,"[Content_Types].xml",AN(n,t)),Ge(a,"_rels/.rels",ao(t.rels)),Ge(a,"xl/_rels/workbook."+r+".rels",ao(t.wbrels)),delete t.revssf,delete t.ssf,a}function Fz(e,t){Xi=1024,e&&!e.SSF&&(e.SSF=gt(Be)),e&&e.SSF&&(Lo(),g0(e.SSF),t.revssf=y0(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Al?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",s=gj.indexOf(t.bookType)>-1,n=Gx();lg(t=t||{});var a=Rx(),i="",l=0;if(t.cellXfs=[],_a(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",Ge(a,i,RN(e.Props,t)),n.coreprops.push(i),at(t.rels,2,i,Xe.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,Ge(a,i,DN(e.Props)),n.extprops.push(i),at(t.rels,3,i,Xe.EXT_PROPS),e.Custprops!==e.Props&&Dt(e.Custprops||{}).length>0&&(i="docProps/custom.xml",Ge(a,i,LN(e.Custprops)),n.custprops.push(i),at(t.rels,4,i,Xe.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,l=1;l<=e.SheetNames.length;++l){var f={"!id":{}},h=e.Sheets[e.SheetNames[l-1]],p=(h||{})["!type"]||"sheet";switch(p){case"chart":default:i="xl/worksheets/sheet"+l+"."+r,Ge(a,i,Tj(l-1,t,e,f)),n.sheets.push(i),at(t.wbrels,-1,"worksheets/sheet"+l+"."+r,Xe.WS[0])}if(h){var m=h["!comments"],x=!1,g="";if(m&&m.length>0){var y=!1;m.forEach(function(w){w[1].forEach(function(v){v.T==!0&&(y=!0)})}),y&&(g="xl/threadedComments/threadedComment"+l+"."+r,Ge(a,g,MM(m,d,t)),n.threadedcomments.push(g),at(f,-1,"../threadedComments/threadedComment"+l+"."+r,Xe.TCMNT)),g="xl/comments"+l+"."+r,Ge(a,g,xj(m)),n.comments.push(g),at(f,-1,"../comments"+l+"."+r,Xe.CMNT),x=!0}h["!legacy"]&&x&&Ge(a,"xl/drawings/vmlDrawing"+l+".vml",pj(l,h["!comments"])),delete h["!comments"],delete h["!legacy"]}f["!id"].rId1&&Ge(a,fc(i),ao(f))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,Ge(a,i,sj(t.Strings,t)),n.strs.push(i),at(t.wbrels,-1,"sharedStrings."+r,Xe.SST)),i="xl/workbook."+r,Ge(a,i,Rj(e)),n.workbooks.push(i),at(t.rels,1,i,Xe.WB),i="xl/theme/theme1.xml",Ge(a,i,Zx(e.Themes,t)),n.themes.push(i),at(t.wbrels,-1,"theme/theme1.xml",Xe.THEME),i="xl/styles."+r,Ge(a,i,dj(e,t)),n.styles.push(i),at(t.wbrels,-1,"styles."+r,Xe.STY),e.vbaraw&&s&&(i="xl/vbaProject.bin",Ge(a,i,e.vbaraw),n.vba.push(i),at(t.wbrels,-1,"vbaProject.bin",Xe.VBA)),i="xl/metadata."+r,Ge(a,i,mj()),n.metadata.push(i),at(t.wbrels,-1,"metadata."+r,Xe.XLMETA),d.length>1&&(i="xl/persons/person.xml",Ge(a,i,UM(d)),n.people.push(i),at(t.wbrels,-1,"persons/person.xml",Xe.PEOPLE)),Ge(a,"[Content_Types].xml",AN(n,t)),Ge(a,"_rels/.rels",ao(t.rels)),Ge(a,"xl/_rels/workbook."+r+".rels",ao(t.wbrels)),delete t.revssf,delete t.ssf,a}function cg(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=fs(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function Pz(e,t){return De.find(e,"EncryptedPackage")?Tz(e,t):Lj(e,t)}function Rz(e,t){var r,s=e,n=t||{};return n.type||(n.type=Ke&&Buffer.isBuffer(e)?"buffer":"base64"),r=aN(s,n),Ez(r,n)}function Hj(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Am(e.slice(r),t);default:break e}return ko.to_workbook(e,t)}function Iz(e,t){var r="",s=cg(e,t);switch(t.type){case"base64":r=fs(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=ai(e);break;default:throw new Error("Unrecognized type "+t.type)}return s[0]==239&&s[1]==187&&s[2]==191&&(r=ct(r)),t.type="binary",Hj(r,t)}function Oz(e,t){var r=e;return t.type=="base64"&&(r=fs(r)),r=ic.utils.decode(1200,r.slice(2),"str"),t.type="binary",Hj(r,t)}function Dz(e){return e.match(/[^\x00-\x7F]/)?on(e):e}function Hf(e,t,r,s){return s?(r.type="string",ko.to_workbook(e,r)):ko.to_workbook(t,r)}function Rm(e,t){Tx();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Rm(new Uint8Array(e),(r=gt(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var s=e,n=[0,0,0,0],a=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),oo={},r.dateNF&&(oo.dateNF=r.dateNF),r.type||(r.type=Ke&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Ke?"buffer":"binary",s=A8(e),typeof Uint8Array<"u"&&!Ke&&(r.type="array")),r.type=="string"&&(a=!0,r.type="binary",r.codepage=65001,s=Dz(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),l=new Uint8Array(i);if(l.foo="bar",!l.foo)return r=gt(r),r.type="array",Rm(Cx(s),r)}switch((n=cg(s,r))[0]){case 208:if(n[1]===207&&n[2]===17&&n[3]===224&&n[4]===161&&n[5]===177&&n[6]===26&&n[7]===225)return Pz(De.read(s,r),r);break;case 9:if(n[1]<=8)return Lj(s,r);break;case 60:return Am(s,r);case 73:if(n[1]===73&&n[2]===42&&n[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(n[1]===68)return $D(s,r);break;case 84:if(n[1]===65&&n[2]===66&&n[3]===76)return tj.to_workbook(s,r);break;case 80:return n[1]===75&&n[2]<9&&n[3]<9?Rz(s,r):Hf(e,s,r,a);case 239:return n[3]===60?Am(s,r):Hf(e,s,r,a);case 255:if(n[1]===254)return Oz(s,r);if(n[1]===0&&n[2]===2&&n[3]===0)return Ya.to_workbook(s,r);break;case 0:if(n[1]===0&&(n[2]>=2&&n[3]===0||n[2]===0&&(n[3]===8||n[3]===9)))return Ya.to_workbook(s,r);break;case 3:case 131:case 139:case 140:return Cm.to_workbook(s,r);case 123:if(n[1]===92&&n[2]===114&&n[3]===116)return lj.to_workbook(s,r);break;case 10:case 13:case 32:return Iz(s,r);case 137:if(n[1]===80&&n[2]===78&&n[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return UD.indexOf(n[0])>-1&&n[2]<=12&&n[3]<=31?Cm.to_workbook(s,r):Hf(e,s,r,a)}function qj(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Rc(t.file,De.write(e,{type:Ke?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return De.write(e,t)}function Lz(e,t){var r=gt(t||{}),s=Cz(e,r);return Mz(s,r)}function Mz(e,t){var r={},s=Ke?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=s;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=s;break;default:throw new Error("Unrecognized type "+t.type)}var n=e.FullPaths?De.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof n=="string"){if(t.type=="binary"||t.type=="base64")return n;n=new Uint8Array(x0(n))}return t.password&&typeof encrypt_agile<"u"?qj(encrypt_agile(n,t.password),t):t.type==="file"?Rc(t.file,n):t.type=="string"?ct(n):n}function Bz(e,t){var r=t||{},s=D$(e,r);return qj(s,r)}function sn(e,t,r){r||(r="");var s=r+e;switch(t.type){case"base64":return oc(on(s));case"binary":return on(s);case"string":return e;case"file":return Rc(t.file,s,"utf8");case"buffer":return Ke?Dn(s,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(s):sn(s,{type:"binary"}).split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Uz(e,t){switch(t.type){case"base64":return oc(e);case"binary":return e;case"string":return e;case"file":return Rc(t.file,e,"binary");case"buffer":return Ke?Dn(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Au(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",s=0;s<e.length;++s)r+=String.fromCharCode(e[s]);return t.type=="base64"?oc(r):t.type=="string"?ct(r):r;case"file":return Rc(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function Gj(e,t){Tx(),PU(e);var r=gt(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var s=Gj(e,r);return r.type="array",x0(s)}var n=0;if(r.sheet&&(typeof r.sheet=="number"?n=r.sheet:n=e.SheetNames.indexOf(r.sheet),!e.SheetNames[n]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return sn(C$(e,r),r);case"slk":case"sylk":return sn(ej.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"htm":case"html":return sn(Bj(e.Sheets[e.SheetNames[n]],r),r);case"txt":return Uz(Kj(e.Sheets[e.SheetNames[n]],r),r);case"csv":return sn(dg(e.Sheets[e.SheetNames[n]],r),r,"\uFEFF");case"dif":return sn(tj.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"dbf":return Au(Cm.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"prn":return sn(ko.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"rtf":return sn(lj.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"eth":return sn(rj.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"fods":return sn(Vj(e,r),r);case"wk1":return Au(Ya.sheet_to_wk1(e.Sheets[e.SheetNames[n]],r),r);case"wk3":return Au(Ya.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Au(Mj(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),Bz(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return Lz(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function $z(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function ug(e,t,r){var s={};return s.type="file",s.file=t,$z(s),Gj(e,s)}function zz(e,t,r,s,n,a,i,l){var c=zt(r),u=l.defval,d=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),f=!0,h=n===1?[]:{};if(n!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!i||e[r])for(var p=t.s.c;p<=t.e.c;++p){var m=i?e[r][p]:e[s[p]+c];if(m===void 0||m.t===void 0){if(u===void 0)continue;a[p]!=null&&(h[a[p]]=u);continue}var x=m.v;switch(m.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+m.t)}if(a[p]!=null){if(x==null)if(m.t=="e"&&x===null)h[a[p]]=null;else if(u!==void 0)h[a[p]]=u;else if(d&&x===null)h[a[p]]=null;else continue;else h[a[p]]=d&&(m.t!=="n"||m.t==="n"&&l.rawNumbers!==!1)?x:In(m,x,l);x!=null&&(f=!1)}}return{row:h,isempty:f}}function Wd(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},s=0,n=1,a=[],i=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},d=u.range!=null?u.range:e["!ref"];switch(u.header===1?s=1:u.header==="A"?s=2:Array.isArray(u.header)?s=3:u.header==null&&(s=0),typeof d){case"string":c=et(d);break;case"number":c=et(e["!ref"]),c.s.r=d;break;default:c=d}s>0&&(n=0);var f=zt(c.s.r),h=[],p=[],m=0,x=0,g=Array.isArray(e),y=c.s.r,w=0,v={};g&&!e[y]&&(e[y]=[]);var b=u.skipHidden&&e["!cols"]||[],_=u.skipHidden&&e["!rows"]||[];for(w=c.s.c;w<=c.e.c;++w)if(!(b[w]||{}).hidden)switch(h[w]=Tt(w),r=g?e[y][w]:e[h[w]+f],s){case 1:a[w]=w-c.s.c;break;case 2:a[w]=h[w];break;case 3:a[w]=u.header[w-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=i=In(r,null,u),x=v[i]||0,!x)v[i]=1;else{do l=i+"_"+x++;while(v[l]);v[i]=x,v[l]=1}a[w]=l}for(y=c.s.r+n;y<=c.e.r;++y)if(!(_[y]||{}).hidden){var k=zz(e,c,y,h,s,a,g,u);(k.isempty===!1||(s===1?u.blankrows!==!1:u.blankrows))&&(p[m++]=k.row)}return p.length=m,p}var Cw=/"/g;function Vz(e,t,r,s,n,a,i,l){for(var c=!0,u=[],d="",f=zt(r),h=t.s.c;h<=t.e.c;++h)if(s[h]){var p=l.dense?(e[r]||[])[h]:e[s[h]+f];if(p==null)d="";else if(p.v!=null){c=!1,d=""+(l.rawNumbers&&p.t=="n"?p.v:In(p,null,l));for(var m=0,x=0;m!==d.length;++m)if((x=d.charCodeAt(m))===n||x===a||x===34||l.forceQuotes){d='"'+d.replace(Cw,'""')+'"';break}d=="ID"&&(d='"ID"')}else p.f!=null&&!p.F?(c=!1,d="="+p.f,d.indexOf(",")>=0&&(d='"'+d.replace(Cw,'""')+'"')):d="";u.push(d)}return l.blankrows===!1&&c?null:u.join(i)}function dg(e,t){var r=[],s=t??{};if(e==null||e["!ref"]==null)return"";var n=et(e["!ref"]),a=s.FS!==void 0?s.FS:",",i=a.charCodeAt(0),l=s.RS!==void 0?s.RS:`
`,c=l.charCodeAt(0),u=new RegExp((a=="|"?"\\|":a)+"+$"),d="",f=[];s.dense=Array.isArray(e);for(var h=s.skipHidden&&e["!cols"]||[],p=s.skipHidden&&e["!rows"]||[],m=n.s.c;m<=n.e.c;++m)(h[m]||{}).hidden||(f[m]=Tt(m));for(var x=0,g=n.s.r;g<=n.e.r;++g)(p[g]||{}).hidden||(d=Vz(e,n,g,f,i,c,a,s),d!=null&&(s.strip&&(d=d.replace(u,"")),(d||s.blankrows!==!1)&&r.push((x++?l:"")+d)));return delete s.dense,r.join("")}function Kj(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=dg(e,t);return r}function Wz(e){var t="",r,s="";if(e==null||e["!ref"]==null)return[];var n=et(e["!ref"]),a="",i=[],l,c=[],u=Array.isArray(e);for(l=n.s.c;l<=n.e.c;++l)i[l]=Tt(l);for(var d=n.s.r;d<=n.e.r;++d)for(a=zt(d),l=n.s.c;l<=n.e.c;++l)if(t=i[l]+a,r=u?(e[d]||[])[l]:e[t],s="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;s=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)s=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)s=""+r.v;else if(r.t=="b")s=r.v?"TRUE":"FALSE";else if(r.w!==void 0)s="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?s="'"+r.v:s=""+r.v}}c[c.length]=t+"="+s}return c}function Xj(e,t,r){var s=r||{},n=+!s.skipHeader,a=e||{},i=0,l=0;if(a&&s.origin!=null)if(typeof s.origin=="number")i=s.origin;else{var c=typeof s.origin=="string"?Ct(s.origin):s.origin;i=c.r,l=c.c}var u,d={s:{c:0,r:0},e:{c:l,r:i+t.length-1+n}};if(a["!ref"]){var f=et(a["!ref"]);d.e.c=Math.max(d.e.c,f.e.c),d.e.r=Math.max(d.e.r,f.e.r),i==-1&&(i=f.e.r+1,d.e.r=i+t.length-1+n)}else i==-1&&(i=0,d.e.r=t.length-1+n);var h=s.header||[],p=0;t.forEach(function(x,g){Dt(x).forEach(function(y){(p=h.indexOf(y))==-1&&(h[p=h.length]=y);var w=x[y],v="z",b="",_=Ue({c:l+p,r:i+g+n});u=yc(a,_),w&&typeof w=="object"&&!(w instanceof Date)?a[_]=w:(typeof w=="number"?v="n":typeof w=="boolean"?v="b":typeof w=="string"?v="s":w instanceof Date?(v="d",s.cellDates||(v="n",w=tr(w)),b=s.dateNF||Be[14]):w===null&&s.nullError&&(v="e",w=0),u?(u.t=v,u.v=w,delete u.w,delete u.R,b&&(u.z=b)):a[_]=u={t:v,v:w},b&&(u.z=b))})}),d.e.c=Math.max(d.e.c,l+h.length-1);var m=zt(i);if(n)for(p=0;p<h.length;++p)a[Tt(p+l)+m]={t:"s",v:h[p]};return a["!ref"]=qe(d),a}function Hz(e,t){return Xj(null,e,t)}function yc(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var s=Ct(t);return e[s.r]||(e[s.r]=[]),e[s.r][s.c]||(e[s.r][s.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?yc(e,Ue(t)):yc(e,Ue({r:t,c:r||0}))}function qz(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function fg(){return{SheetNames:[],Sheets:{}}}function hg(e,t,r,s){var n=1;if(!r)for(;n<=65535&&e.SheetNames.indexOf(r="Sheet"+n)!=-1;++n,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(s&&e.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);n=a&&+a[2]||0;var i=a&&a[1]||r;for(++n;n<=65535&&e.SheetNames.indexOf(r=i+n)!=-1;++n);}if(Pj(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function Gz(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var s=qz(e,t);switch(e.Workbook.Sheets[s]||(e.Workbook.Sheets[s]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[s].Hidden=r}function Kz(e,t){return e.z=t,e}function Yj(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function Xz(e,t,r){return Yj(e,"#"+t,r)}function Yz(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function Jz(e,t,r,s){for(var n=typeof t!="string"?t:et(t),a=typeof t=="string"?t:qe(t),i=n.s.r;i<=n.e.r;++i)for(var l=n.s.c;l<=n.e.c;++l){var c=yc(e,i,l);c.t="n",c.F=a,delete c.v,i==n.s.r&&l==n.s.c&&(c.f=r,s&&(c.D=!0))}return e}var ht={encode_col:Tt,encode_row:zt,encode_cell:Ue,encode_range:qe,decode_col:$x,decode_row:Ux,split_cell:lI,decode_cell:Ct,decode_range:Jr,format_cell:In,sheet_add_aoa:SN,sheet_add_json:Xj,sheet_add_dom:Uj,aoa_to_sheet:Mo,json_to_sheet:Hz,table_to_sheet:$j,table_to_book:nz,sheet_to_csv:dg,sheet_to_txt:Kj,sheet_to_json:Wd,sheet_to_html:Bj,sheet_to_formulae:Wz,sheet_to_row_object_array:Wd,sheet_get_cell:yc,book_new:fg,book_append_sheet:hg,book_set_sheet_visibility:Gz,cell_set_number_format:Kz,cell_set_hyperlink:Yj,cell_set_internal_link:Xz,cell_add_comment:Yz,sheet_set_array_formula:Jz,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};async function Qz(e,t){let r=ie.from("quotes").select("*").eq("project_id",e);const{data:s,error:n}=await r;if(n)throw new Error(`Failed to fetch quotes: ${n.message}`);if(!s||s.length===0)return Zz(e,t);const a=s,i=a.map(v=>v.id),{data:l,error:c}=await ie.from("quote_items").select("*").in("quote_id",i).eq("is_excluded",!1);if(c)throw new Error(`Failed to fetch quote items: ${c.message}`);const u=l||[],d=a.map(v=>({quoteId:v.id,supplierName:v.supplier_name})),f=eV(a,u),h=tV(a,u),p=rV(a,u),m=sV(a,u),x=nV(a,u),g=aV(u),y=iV(a),w=oV(a,u);return{projectId:e,quoteIds:t,quotesAnalyzed:a.length,analyzedAt:new Date().toISOString(),summary:{totalRedFlags:f.length,criticalIssues:f.filter(v=>v.severity==="critical").length,coverageScore:x,averageQualityScore:g,bestValueSupplier:y,mostCompleteSupplier:w},redFlags:f,coverageGaps:h,systemsDetected:p,supplierInsights:m,normalizedItems:d}}function Zz(e,t){return{projectId:e,quoteIds:t,quotesAnalyzed:0,analyzedAt:new Date().toISOString(),summary:{totalRedFlags:0,criticalIssues:0,coverageScore:0,averageQualityScore:0,bestValueSupplier:"N/A",mostCompleteSupplier:"N/A"},redFlags:[],coverageGaps:[],systemsDetected:[],supplierInsights:[],normalizedItems:[]}}function eV(e,t){const r=[];for(const s of e){const n=t.filter(f=>f.quote_id===s.id),a=n.reduce((f,h)=>f+(h.total_price||0),0),i=s.quoted_total||s.total_amount||0,l=Math.abs(a-i),c=i>0?l/i*100:0;c>10&&r.push({id:`price-discrepancy-${s.id}`,quoteId:s.id,severity:c>20?"critical":"high",category:"Pricing",title:"Significant Price Discrepancy",description:`Quote total ($${i.toLocaleString()}) differs from line items sum ($${a.toLocaleString()}) by ${c.toFixed(1)}%`,recommendation:"Verify quoted total matches line items. Check for missing items or calculation errors."}),n.length===0&&r.push({id:`no-items-${s.id}`,quoteId:s.id,severity:"critical",category:"Completeness",title:"No Line Items",description:"Quote contains no line items",recommendation:"Ensure quote has been properly imported with all line items."});const u=n.filter(f=>!f.unit_price||f.unit_price===0);u.length>0&&r.push({id:`missing-prices-${s.id}`,quoteId:s.id,severity:u.length>n.length*.1?"high":"medium",category:"Pricing",title:"Items Missing Unit Prices",description:`${u.length} items have no unit price specified`,recommendation:"Request unit prices for all items to enable accurate comparison."});const d=n.filter(f=>f.confidence!==null&&f.confidence<.7);d.length>n.length*.2&&r.push({id:`low-confidence-${s.id}`,quoteId:s.id,severity:"medium",category:"Data Quality",title:"Poor Data Normalization Quality",description:`${Math.round(d.length/n.length*100)}% of items have low confidence scores`,recommendation:"Review and manually correct items with low confidence scores for better comparison accuracy."}),(!s.contingency_amount||s.contingency_amount===0)&&r.push({id:`no-contingency-${s.id}`,quoteId:s.id,severity:"low",category:"Commercial",title:"No Contingency Specified",description:"Quote does not include a contingency amount",recommendation:"Confirm if contingency is included in pricing or needs to be added separately."})}return r}function tV(e,t){const r=[];if(e.length<2)return r;const s=new Map;for(const n of t){const a=n.scope_category||"Uncategorized";s.has(a)||s.set(a,new Map);const i=s.get(a);i.has(n.quote_id)||i.set(n.quote_id,new Set),i.get(n.quote_id).add(n.description.toLowerCase().trim())}for(const[n,a]of s){const i=Array.from(a.keys());if(i.length<e.length){const l=e.filter(c=>!i.includes(c.id));r.push({id:`missing-category-${n}`,gapType:"Missing Category",title:`Category "${n}" not quoted by all suppliers`,description:`${l.length} supplier(s) did not quote this category`,missingIn:l.map(c=>c.supplier_name),presentIn:e.filter(c=>i.includes(c.id)).map(c=>c.supplier_name),estimatedImpact:0,recommendation:"Request quotes for this category from suppliers who did not include it."})}}return r}function rV(e,t){const r=[],s=new Map;for(const n of t)if(n.system_label&&n.system_id){const a=`${n.quote_id}-${n.system_id}`;s.has(a)||s.set(a,{quoteId:n.quote_id,items:[]}),s.get(a).items.push(n)}for(const[n,{quoteId:a,items:i}]of s){const l=i.reduce((u,d)=>u+(d.total_price||0),0),c=i.reduce((u,d)=>u+(d.confidence||0),0)/i.length;r.push({id:n,quoteId:a,systemName:i[0].system_label,systemType:i[0].system_id.split("-")[0]||"Unknown",itemCount:i.length,totalValue:l,confidence:c})}return r.sort((n,a)=>a.totalValue-n.totalValue)}function sV(e,t){const r=[];for(const s of e){const n=t.filter(c=>c.quote_id===s.id);if(n.length===0)continue;n.reduce((c,u)=>c+(u.unit_price||0),0)/n.length,n.filter(c=>c.unit_price>0).length/n.length*100===100&&r.push({id:`complete-${s.id}`,supplierName:s.supplier_name,insightType:"Positive",title:"Complete Pricing",description:"All items have unit prices specified, enabling full comparison.",recommendation:"This supplier has provided comprehensive pricing information."});const i=new Set(n.map(c=>c.scope_category)).size;i>5&&r.push({id:`comprehensive-${s.id}`,supplierName:s.supplier_name,insightType:"Positive",title:"Comprehensive Quote",description:`Quote covers ${i} different scope categories.`,recommendation:"This supplier has provided broad coverage across multiple work areas."});const l=new Set(n.filter(c=>c.system_id).map(c=>c.system_id)).size;l>3&&r.push({id:`systems-${s.id}`,supplierName:s.supplier_name,insightType:"Positive",title:"Multiple Systems Identified",description:`${l} fire protection systems detected in quote.`,recommendation:"Items have been successfully mapped to fire protection systems."})}return r}function nV(e,t){if(e.length===0)return 0;const r=new Set(t.map(n=>n.scope_category||"Uncategorized"));let s=0;for(const n of e){const a=t.filter(c=>c.quote_id===n.id),l=new Set(a.map(c=>c.scope_category||"Uncategorized")).size/r.size*100;s+=l}return Math.round(s/e.length)}function aV(e){if(e.length===0)return 0;const t=e.filter(l=>l.unit_price>0).length,r=e.filter(l=>l.system_id).length,s=e.reduce((l,c)=>l+(c.confidence||0),0)/e.length,n=t/e.length*40,a=r/e.length*30,i=s*30;return Math.round(n+a+i)}function iV(e){return e.length===0?"N/A":e.reduce((r,s)=>s.total_amount<r.total_amount?s:r).supplier_name}function oV(e,t){if(e.length===0)return"N/A";let r=e[0],s=0;for(const n of e){const a=t.filter(l=>l.quote_id===n.id),i=a.length+a.filter(l=>l.unit_price>0).length*2+a.filter(l=>l.system_id).length;i>s&&(s=i,r=n)}return r.supplier_name}async function lV(e,t){return Qz(e,t)}function cV({projectId:e,projectName:t}){const[r,s]=T.useState(null),[n,a]=T.useState(!0),[i,l]=T.useState(null);T.useEffect(()=>{c()},[e]);const c=async()=>{a(!0),l(null);try{const p=await lV(e);s(p)}catch(p){l(p instanceof Error?p.message:"Failed to analyze quotes"),console.error("Quote intelligence error:",p)}finally{a(!1)}},u=()=>{window.print()},d=()=>{window.print()},f=()=>{if(!r)return;const p=ht.book_new(),m=[["Quote Intelligence Report"],["Project:",t||"Unknown"],["Generated:",new Date(r.analyzedAt).toLocaleString()],[],["Summary"],["Quotes Analyzed:",r.quotesAnalyzed],["Total Red Flags:",r.summary.totalRedFlags],["Critical Issues:",r.summary.criticalIssues],["Coverage Score:",`${r.summary.coverageScore}%`],["Average Quality Score:",`${r.summary.averageQualityScore}%`],["Best Value Supplier:",r.summary.bestValueSupplier],["Most Complete Supplier:",r.summary.mostCompleteSupplier]],x=ht.aoa_to_sheet(m);ht.book_append_sheet(p,x,"Summary");const g=[["Severity","Category","Title","Description","Supplier","Recommendation"],...r.redFlags.map(C=>{const U=r.normalizedItems.find(H=>H.quoteId===C.quoteId);return[C.severity,C.category,C.title,C.description,(U==null?void 0:U.supplierName)||"Unknown",C.recommendation]})],y=ht.aoa_to_sheet(g);ht.book_append_sheet(p,y,"Red Flags");const w=[["Type","Title","Description","Missing In","Present In","Impact","Recommendation"],...r.coverageGaps.map(C=>[C.gapType,C.title,C.description,C.missingIn.join(", "),C.presentIn.join(", "),`$${C.estimatedImpact.toLocaleString()}`,C.recommendation])],v=ht.aoa_to_sheet(w);ht.book_append_sheet(p,v,"Coverage Gaps");const b=[["System Name","System Type","Supplier","Item Count","Total Value","Confidence"],...r.systemsDetected.map(C=>{const U=r.normalizedItems.find(H=>H.quoteId===C.quoteId);return[C.systemName,C.systemType,(U==null?void 0:U.supplierName)||"Unknown",C.itemCount,`$${C.totalValue.toLocaleString()}`,`${(C.confidence*100).toFixed(1)}%`]})],_=ht.aoa_to_sheet(b);ht.book_append_sheet(p,_,"Systems Detected");const k=[["Supplier","Type","Title","Description","Recommendation"],...r.supplierInsights.map(C=>[C.supplierName,C.insightType,C.title,C.description,C.recommendation])],S=ht.aoa_to_sheet(k);ht.book_append_sheet(p,S,"Supplier Insights");const E=`${t}_QuoteIntelligence.xlsx`;ug(p,E)},h=p=>{switch(p){case"critical":return"bg-red-100 text-red-800 border-red-300";case"high":return"bg-orange-100 text-orange-800 border-orange-300";case"medium":return"bg-yellow-100 text-yellow-800 border-yellow-300";case"low":return"bg-blue-100 text-blue-800 border-blue-300";default:return"bg-gray-100 text-gray-800 border-gray-300"}};return n?o.jsx("div",{className:"flex items-center justify-center h-64",children:o.jsxs("div",{className:"text-center",children:[o.jsx(qs,{className:"animate-spin mx-auto mb-4 text-blue-600",size:40}),o.jsx("p",{className:"text-lg font-medium text-gray-900",children:"Analyzing Quotes..."})]})}):i||!r?o.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx(qa,{className:"text-red-600 flex-shrink-0",size:24}),o.jsxs("div",{children:[o.jsx("h3",{className:"font-semibold text-red-900 mb-1",children:"Analysis Error"}),o.jsx("p",{className:"text-sm text-red-800",children:i||"No analysis data available"}),o.jsx("button",{onClick:c,className:"mt-3 px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 text-sm",children:"Retry Analysis"})]})]})}):o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 print:shadow-none",children:[o.jsxs("div",{className:"flex items-center justify-between mb-6 print:mb-4",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Quote Intelligence Report"}),o.jsx("p",{className:"text-sm text-gray-600 mt-1",children:t||"Project Analysis"}),o.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Generated: ",new Date(r.analyzedAt).toLocaleString()]})]}),o.jsxs("div",{className:"flex gap-2 print:hidden",children:[o.jsxs("button",{onClick:f,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[o.jsx(si,{size:18}),"Excel"]}),o.jsxs("button",{onClick:d,className:"flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:[o.jsx(NF,{size:18}),"PDF"]}),o.jsxs("button",{onClick:u,className:"flex items-center gap-2 px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:[o.jsx(hx,{size:18}),"Print"]})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8",children:[o.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 border border-blue-200",children:[o.jsx("div",{className:"text-sm text-blue-700 font-medium mb-1",children:"Quotes Analyzed"}),o.jsx("div",{className:"text-3xl font-bold text-blue-900",children:r.quotesAnalyzed})]}),o.jsxs("div",{className:"bg-red-50 rounded-lg p-4 border border-red-200",children:[o.jsx("div",{className:"text-sm text-red-700 font-medium mb-1",children:"Red Flags"}),o.jsx("div",{className:"text-3xl font-bold text-red-900",children:r.summary.totalRedFlags}),o.jsxs("div",{className:"text-xs text-red-600 mt-1",children:[r.summary.criticalIssues," critical"]})]}),o.jsxs("div",{className:"bg-green-50 rounded-lg p-4 border border-green-200",children:[o.jsx("div",{className:"text-sm text-green-700 font-medium mb-1",children:"Coverage Score"}),o.jsxs("div",{className:"text-3xl font-bold text-green-900",children:[r.summary.coverageScore,"%"]})]}),o.jsxs("div",{className:"bg-purple-50 rounded-lg p-4 border border-purple-200",children:[o.jsx("div",{className:"text-sm text-purple-700 font-medium mb-1",children:"Quality Score"}),o.jsxs("div",{className:"text-3xl font-bold text-purple-900",children:[Math.round(r.summary.averageQualityScore),"%"]})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-8",children:[o.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 rounded-lg p-4 border border-blue-200",children:[o.jsx("div",{className:"text-sm text-blue-700 font-semibold mb-2",children:"Best Value Supplier"}),o.jsx("div",{className:"text-xl font-bold text-blue-900",children:r.summary.bestValueSupplier})]}),o.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 rounded-lg p-4 border border-green-200",children:[o.jsx("div",{className:"text-sm text-green-700 font-semibold mb-2",children:"Most Complete Supplier"}),o.jsx("div",{className:"text-xl font-bold text-green-900",children:r.summary.mostCompleteSupplier})]})]})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 print:shadow-none print:break-after-page",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[o.jsx(qa,{className:"text-red-600",size:24}),o.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Red Flags"})]}),r.redFlags.length===0?o.jsx("p",{className:"text-gray-600 py-4",children:"No red flags detected."}):o.jsx("div",{className:"space-y-3",children:r.redFlags.map(p=>{const m=r.normalizedItems.find(x=>x.quoteId===p.quoteId);return o.jsxs("div",{className:`border rounded-lg p-4 ${h(p.severity)}`,children:[o.jsx("div",{className:"flex items-start justify-between mb-2",children:o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[o.jsx("span",{className:"text-xs font-bold uppercase px-2 py-1 bg-white rounded",children:p.severity}),o.jsx("span",{className:"text-sm font-medium",children:p.category})]}),o.jsx("h3",{className:"font-semibold text-lg",children:p.title}),o.jsx("p",{className:"text-sm mt-1",children:(m==null?void 0:m.supplierName)||"Unknown Supplier"})]})}),o.jsx("p",{className:"text-sm mb-2",children:p.description}),p.recommendation&&o.jsxs("div",{className:"mt-2 pt-2 border-t border-current border-opacity-20",children:[o.jsx("p",{className:"text-sm font-medium",children:"Recommendation:"}),o.jsx("p",{className:"text-sm",children:p.recommendation})]})]},p.id)})})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 print:shadow-none print:break-after-page",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[o.jsx(RS,{className:"text-orange-600",size:24}),o.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Coverage Gaps"})]}),r.coverageGaps.length===0?o.jsx("p",{className:"text-gray-600 py-4",children:"No coverage gaps identified."}):o.jsx("div",{className:"space-y-3",children:r.coverageGaps.map(p=>o.jsxs("div",{className:"border border-orange-200 rounded-lg p-4 bg-orange-50",children:[o.jsx("h3",{className:"font-semibold text-lg text-orange-900 mb-2",children:p.title}),o.jsx("p",{className:"text-sm text-orange-800 mb-3",children:p.description}),o.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-3 text-sm",children:[o.jsxs("div",{children:[o.jsx("p",{className:"font-medium text-orange-900",children:"Missing in:"}),o.jsx("p",{className:"text-orange-700",children:p.missingIn.join(", ")})]}),o.jsxs("div",{children:[o.jsx("p",{className:"font-medium text-orange-900",children:"Present in:"}),o.jsx("p",{className:"text-orange-700",children:p.presentIn.join(", ")})]})]}),p.estimatedImpact>0&&o.jsxs("p",{className:"text-sm font-semibold text-orange-900 mb-2",children:["Estimated Impact: $",p.estimatedImpact.toLocaleString()]}),p.recommendation&&o.jsxs("div",{className:"mt-2 pt-2 border-t border-orange-300",children:[o.jsx("p",{className:"text-sm font-medium text-orange-900",children:"Recommendation:"}),o.jsx("p",{className:"text-sm text-orange-800",children:p.recommendation})]})]},p.id))})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 print:shadow-none print:break-after-page",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[o.jsx(f0,{className:"text-blue-600",size:24}),o.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Systems Detected"})]}),r.systemsDetected.length===0?o.jsx("p",{className:"text-gray-600 py-4",children:"No systems detected."}):o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full text-sm",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"border-b border-gray-200",children:[o.jsx("th",{className:"text-left py-2 font-semibold",children:"System"}),o.jsx("th",{className:"text-left py-2 font-semibold",children:"Type"}),o.jsx("th",{className:"text-left py-2 font-semibold",children:"Supplier"}),o.jsx("th",{className:"text-right py-2 font-semibold",children:"Items"}),o.jsx("th",{className:"text-right py-2 font-semibold",children:"Total Value"}),o.jsx("th",{className:"text-right py-2 font-semibold",children:"Confidence"})]})}),o.jsx("tbody",{children:r.systemsDetected.map(p=>{const m=r.normalizedItems.find(x=>x.quoteId===p.quoteId);return o.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[o.jsx("td",{className:"py-2",children:p.systemName}),o.jsx("td",{className:"py-2 text-gray-600",children:p.systemType}),o.jsx("td",{className:"py-2 text-gray-600",children:(m==null?void 0:m.supplierName)||"Unknown"}),o.jsx("td",{className:"py-2 text-right",children:p.itemCount}),o.jsxs("td",{className:"py-2 text-right font-medium",children:["$",p.totalValue.toLocaleString()]}),o.jsx("td",{className:"py-2 text-right",children:o.jsxs("span",{className:`px-2 py-1 rounded text-xs font-medium ${p.confidence>.8?"bg-green-100 text-green-800":p.confidence>.6?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:[(p.confidence*100).toFixed(0),"%"]})})]},p.id)})})]})})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 print:shadow-none",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[o.jsx(Po,{className:"text-purple-600",size:24}),o.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Supplier Insights"})]}),r.supplierInsights.length===0?o.jsx("p",{className:"text-gray-600 py-4",children:"No supplier insights available."}):o.jsx("div",{className:"space-y-3",children:r.supplierInsights.map(p=>o.jsxs("div",{className:"border border-purple-200 rounded-lg p-4 bg-purple-50",children:[o.jsx("div",{className:"flex items-start justify-between mb-2",children:o.jsxs("div",{children:[o.jsx("h3",{className:"font-semibold text-lg text-purple-900",children:p.supplierName}),o.jsx("span",{className:"text-xs font-medium text-purple-700 uppercase",children:p.insightType})]})}),o.jsx("h4",{className:"font-semibold text-purple-900 mb-1",children:p.title}),o.jsx("p",{className:"text-sm text-purple-800 mb-3",children:p.description}),p.recommendation&&o.jsxs("div",{className:"mt-2 pt-2 border-t border-purple-300",children:[o.jsx("p",{className:"text-sm font-medium text-purple-900",children:"Recommendation:"}),o.jsx("p",{className:"text-sm text-purple-800",children:p.recommendation})]})]},p.id))})]})]})}function uV(e){return o.jsx(cV,{...e})}async function dV(e){return{}}async function fV(e,t){return null}async function Jj(e){return{getRate:async t=>fV(),getRates:async()=>dV()}}async function hV(e,t,r){console.log("compareAgainstModelHybrid: Processing",e.length,"lines"),console.log("compareAgainstModelHybrid: Mappings:",t.length);const s=[];let n=0,a=0;for(const i of e){const l=t.find(m=>m.quoteItemId===i.quoteItemId);if(!l||!l.systemId){n++,s.push({quoteId:i.quoteId,quoteItemId:i.quoteItemId,supplier:i.supplier,systemId:"UNMAPPED",systemLabel:"Unmapped Items",section:i.section,service:i.service||i.serviceType,subclass:i.subclass,frr:i.frr,sizeBucket:i.size,quantity:i.quantity,unitRate:i.rate,total:i.total,modelRate:null,componentCount:null,variancePct:null,flag:"NA"});continue}a++;const c={systemId:l.systemId,section:i.section,service:i.service||i.serviceType,subclass:i.subclass,frr:i.frr,size:i.size},u=r(c),d=(u==null?void 0:u.rate)||null,f=(u==null?void 0:u.componentCount)||null;let h=null,p="NA";d!==null&&i.rate>0&&(h=(i.rate-d)/d*100,Math.abs(h)<=10?p="GREEN":Math.abs(h)<=25?p="AMBER":p="RED"),s.push({quoteId:i.quoteId,quoteItemId:i.quoteItemId,supplier:i.supplier,systemId:l.systemId,systemLabel:l.systemLabel||"",section:i.section,service:i.service||i.serviceType,subclass:i.subclass,frr:i.frr,sizeBucket:i.size,quantity:i.quantity,unitRate:i.rate,total:i.total,modelRate:d,componentCount:f,variancePct:h,flag:p})}return console.log("compareAgainstModelHybrid: Generated",s.length,"comparison rows"),console.log("compareAgainstModelHybrid: Mapped items:",a),console.log("compareAgainstModelHybrid: Unmapped items:",n),s.length>0&&console.log("compareAgainstModelHybrid: Sample comparison row:",s[0]),s}function mV(e){const[t,r]=T.useState([]),[s,n]=T.useState(!0),[a,i]=T.useState(null),l=async()=>{if(!e){n(!1);return}n(!0),i(null);try{const{data:c}=await ie.from("quotes").select("id, supplier_name").eq("project_id",e);if(!c||c.length===0){r([]),n(!1);return}const u=c.map(g=>g.id),{data:d,error:f}=await ie.from("quote_items").select("id, description, unit_price, system_id, quantity, quote_id").in("quote_id",u);if(f)throw f;if(!d||d.length===0){r([]),n(!1);return}const p=d.map(g=>{const y=c.find(w=>w.id===g.quote_id);return{...g,supplier_name:(y==null?void 0:y.supplier_name)||"Unknown"}}).filter(g=>Nx(g)?!1:!g.system_id||g.system_id===""||g.system_id==="unknown"),m=new Map;p.forEach(g=>{const y=HR(g.description);y&&(m.has(y)||m.set(y,[]),m.get(y).push(g))});const x=[];m.forEach((g,y)=>{if(g.length<2)return;const w=[...new Set(g.map(E=>E.supplier_name))],v=g.map(E=>E.unit_price).filter(E=>E>0),b=v.length>0?Math.min(...v):0,_=v.length>0?Math.max(...v):0,k=g[0].description,S=qR(k);x.push({key:y,defaultName:S,exampleDescription:k,suppliers:w,count:g.length,rateMin:b,rateMax:_,itemIds:g.map(E=>E.id)})}),x.sort((g,y)=>y.count-g.count),r(x)}catch(c){console.error("Error loading suggested systems:",c),i(c instanceof Error?c.message:"Failed to load suggestions")}finally{n(!1)}};return T.useEffect(()=>{l()},[e]),{suggestions:t,loading:s,error:a,reload:l}}function pV(){return null}const xV=e=>{switch(e){case"GREEN":return"bg-green-100 text-green-900 border-green-300";case"AMBER":return"bg-amber-100 text-amber-900 border-amber-300";case"RED":return"bg-red-100 text-red-900 border-red-300";default:return"bg-gray-100 text-gray-600 border-gray-300"}};function gV({projectId:e,onNavigateBack:t,onNavigateNext:r}){const[s,n]=T.useState([]),[a,i]=T.useState([]),[l,c]=T.useState([]),[u,d]=T.useState(!1),[f,h]=T.useState(!1),[p,m]=T.useState(new Set),[x,g]=T.useState(!1),[y,w]=T.useState(!1),{currentOrganisation:v}=ya(),b=(v==null?void 0:v.id)||"",{suggestions:_}=mV(e),[k,S]=T.useState([]),[E,C]=T.useState([]),[U,H]=T.useState(!1),[W,q]=T.useState(!1),[z,Q]=T.useState(!0),[L,X]=T.useState({}),[K,V]=T.useState({sections:[],services:[],subclasses:[],frrs:[],sizeBuckets:[]});console.log("========== SCOPE MATRIX DEBUG =========="),console.log("ScopeMatrix render:",{projectId:e,comparisonDataLength:s.length,matrixRowsLength:a.length,suppliersCount:l.length,loading:u,hasFilters:Object.keys(L).length>0}),T.useEffect(()=>{fe()},[e]),T.useEffect(()=>{D()},[s,L]);const fe=async()=>{Q(!0);try{const{data:N}=await ie.from("quotes").select("id, supplier_name, quote_reference, total_amount").eq("project_id",e).order("supplier_name");if(N){const G=await Promise.all(N.map(async ce=>{const{count:te}=await ie.from("quote_items").select("*",{count:"exact",head:!0}).eq("quote_id",ce.id).not("system_id","is",null);return{...ce,is_normalized:(te||0)>0}}));S(G)}}catch(N){console.error("Error loading quotes:",N)}finally{Q(!1)}},ve=async()=>{E.length!==0&&(console.log("=== SCOPE MATRIX GENERATION START ==="),console.log("Selected Quote IDs:",E),console.log("Project ID:",e),H(!0),await P(),q(!0),H(!1),console.log("=== SCOPE MATRIX GENERATION END ==="))},P=async()=>{d(!0);try{const N=E.length>0?E:k.map(Se=>Se.id),{data:G}=await ie.from("quotes").select("id, supplier_name").in("id",N).order("supplier_name");if(!G||G.length===0){d(!1);return}const ce=G.map(Se=>Se.id),{data:te}=await ie.from("quote_items").select("*").in("quote_id",ce);if(!te){console.error("ScopeMatrix: No items data returned from database"),d(!1);return}console.log("ScopeMatrix: Loading data for project",e),console.log("ScopeMatrix: Found",G.length,"quotes and",te.length,"items");const ue=te.filter(Se=>Se.system_id);console.log("ScopeMatrix: Items with system_id:",ue.length),ue.length===0&&console.warn("ScopeMatrix: WARNING - No items have system_id mapped! Matrix will be empty.");const ae=new Set(te.filter(Se=>Nx(Se)).map(Se=>Se.id));m(ae);const ge=te.map(Se=>{const Le=G.find($r=>$r.id===Se.quote_id),We=Se.service||Se.mapped_service_type||Se.serviceType,rt=Se.mapped_system||Se.systemType,vt=Se.mapped_penetration||Se.penetrationType;return{quoteId:Se.quote_id,quoteItemId:Se.id,supplier:(Le==null?void 0:Le.supplier_name)||"Unknown",originalDescription:Se.description,quantity:Se.quantity||1,rate:Se.unit_price,total:Se.total_price,section:Se.section,service:We,serviceType:We,subclass:Se.subclass,frr:Se.frr,size:Se.size,systemType:rt,penetrationType:vt}});console.log("ScopeMatrix: Normalised",ge.length,"lines"),console.log("ScopeMatrix: Sample item:",ge[0]);const le=te.map(Se=>({quoteItemId:Se.id,systemId:Se.system_id,systemLabel:Se.system_label}));console.log("ScopeMatrix: Created",le.length,"mappings"),console.log("ScopeMatrix: Mappings with system_id:",le.filter(Se=>Se.systemId).length);const je=Jj(e);await je.loadSettings(),console.log("ScopeMatrix: Model rate provider loaded");const Ae=await hV(ge,le,Se=>je.getModelRate(Se));if(console.log("ScopeMatrix: Generated",Ae.length,"comparison rows"),Ae.length>0){console.log("ScopeMatrix: Sample comparison:",Ae[0]);const Se=Array.from(new Set(Ae.map(Le=>Le.supplier)));console.log("ScopeMatrix: Unique suppliers in comparisons:",Se)}else console.error("ScopeMatrix: ERROR - compareAgainstModelHybrid returned 0 rows!"),console.log("ScopeMatrix: Check if items have system_id and if model rates are configured");n(Ae),M(Ae),console.log("ScopeMatrix: comparisonData state set with",Ae.length,"rows"),await ie.from("project_settings").upsert({project_id:e,scope_matrix_completed:!0,updated_at:new Date().toISOString()},{onConflict:"project_id"})}catch(N){console.error("ScopeMatrix: Error loading data:",N),console.error("ScopeMatrix: Error details:",{message:N instanceof Error?N.message:"Unknown error",stack:N instanceof Error?N.stack:void 0}),n([])}finally{d(!1)}},M=N=>{const G=new Set,ce=new Set,te=new Set,ue=new Set,ae=new Set;N.forEach(ge=>{ge.section&&G.add(ge.section),ge.service&&ce.add(ge.service),ge.subclass&&te.add(ge.subclass),ge.frr&&ue.add(ge.frr),ge.sizeBucket&&ae.add(ge.sizeBucket)}),V({sections:Array.from(G).sort(),services:Array.from(ce).sort(),subclasses:Array.from(te).sort(),frrs:Array.from(ue).sort(),sizeBuckets:Array.from(ae).sort()})},D=()=>{console.log("=== BUILD MATRIX START ==="),console.log("buildMatrix: Starting with",s.length,"comparison rows"),console.log("buildMatrix: Has generated:",W),console.log("buildMatrix: Active filters:",L);let N=s;L.section&&(N=N.filter(ue=>ue.section===L.section)),L.service&&(N=N.filter(ue=>ue.service===L.service)),L.subclass&&(N=N.filter(ue=>ue.subclass===L.subclass)),L.frr&&(N=N.filter(ue=>ue.frr===L.frr)),L.sizeBucket&&(N=N.filter(ue=>ue.sizeBucket===L.sizeBucket)),console.log("buildMatrix: After filtering:",N.length,"rows");const G=Array.from(new Set(N.map(ue=>ue.supplier))).sort();c(G),console.log("buildMatrix: Found",G.length,"suppliers:",G);const ce=new Map;N.forEach(ue=>{const ae=`${ue.systemId}|${ue.systemLabel}`;ce.has(ae)||ce.set(ae,{systemId:ue.systemId,systemLabel:ue.systemLabel,section:ue.section,service:ue.service,subclass:ue.subclass,frr:ue.frr,sizeBucket:ue.sizeBucket,cells:{}});const ge=ce.get(ae);ge.cells[ue.supplier]||(ge.cells[ue.supplier]={unitRate:ue.unitRate,flag:ue.flag,modelRate:ue.modelRate,variancePct:ue.variancePct,componentCount:ue.componentCount,quoteId:ue.quoteId,quoteItemId:ue.quoteItemId})});const te=Array.from(ce.values()).sort((ue,ae)=>ue.systemId==="UNMAPPED"&&ae.systemId!=="UNMAPPED"?1:ae.systemId==="UNMAPPED"&&ue.systemId!=="UNMAPPED"?-1:ue.systemLabel.localeCompare(ae.systemLabel));console.log("buildMatrix: Generated",te.length,"matrix rows"),te.length>0?console.log("buildMatrix: Sample row:",te[0]):console.warn("buildMatrix: WARNING - No matrix rows generated! Check comparison data and filters."),i(te),console.log("=== BUILD MATRIX END ===")},B=()=>{try{if(console.log("Export CSV clicked",{matrixRowsCount:a.length,suppliersCount:l.length}),a.length===0){alert("No data available to export. Please ensure quotes are imported and the matrix has been generated.");return}const N=["System ID","System Label","Section","Service","Subclass","FRR","Size Bucket"];l.forEach(ge=>{N.push(`${ge} - Unit Rate`),N.push(`${ge} - Model Rate`),N.push(`${ge} - Variance %`),N.push(`${ge} - Flag`)});const G=a.map(ge=>{const le=[ge.systemId,ge.systemLabel,ge.section||"",ge.service||"",ge.subclass||"",ge.frr||"",ge.sizeBucket||""];return l.forEach(je=>{var Se,Le,We;const Ae=ge.cells[je];Ae?(le.push(((Se=Ae.unitRate)==null?void 0:Se.toFixed(2))||""),le.push(((Le=Ae.modelRate)==null?void 0:Le.toFixed(2))||""),le.push(((We=Ae.variancePct)==null?void 0:We.toFixed(2))||""),le.push(Ae.flag)):le.push("","","","")}),le}),ce=[N.join(","),...G.map(ge=>ge.map(le=>`"${le}"`).join(","))].join(`
`),te=new Blob([ce],{type:"text/csv;charset=utf-8;"}),ue=URL.createObjectURL(te),ae=document.createElement("a");ae.href=ue,ae.download=`scope-matrix-${e}-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(ae),ae.click(),document.body.removeChild(ae),URL.revokeObjectURL(ue),console.log("Export completed successfully")}catch(N){console.error("Error exporting CSV:",N),alert("Failed to export CSV. Check console for details.")}},Y=()=>{X({})},he=Object.values(L).some(N=>N),xe=N=>{C(G=>G.includes(N)?G.filter(ce=>ce!==N):[...G,N])},se=()=>{const N=k.filter(G=>G.is_normalized);E.length===N.length?C([]):C(N.map(G=>G.id))},ne=k.filter(N=>N.is_normalized),be=ne.length>0&&E.length===ne.length;return o.jsxs("div",{className:"min-h-screen",children:[o.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-6",children:[o.jsxs("div",{className:"mb-6",children:[o.jsxs("button",{onClick:t,className:"flex items-center gap-2 text-sm text-gray-600 hover:text-gray-900 mb-4 transition-colors",children:[o.jsx(d0,{size:16}),"Back to Project Dashboard"]}),o.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Scope Matrix"}),o.jsx("p",{className:"text-gray-600",children:"Select which supplier quotes to compare and generate your scope matrix."}),o.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Only quotes that have been imported, normalised, and mapped to systems will be available here."})]}),o.jsxs("div",{className:"bg-white rounded-xl p-6 border border-gray-200 shadow-sm mb-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsx("h2",{className:"text-lg font-bold text-gray-900",children:"Select Quotes to Compare"}),ne.length>0&&o.jsxs("button",{onClick:se,className:"flex items-center gap-2 text-sm text-blue-600 hover:text-blue-700 font-medium",children:[be?o.jsx($y,{size:18}):o.jsx(Wy,{size:18}),be?"Deselect All":"Select All"]})]}),z?o.jsx("div",{className:"text-center py-8 text-gray-500",children:"Loading quotes..."}):k.length===0?o.jsxs("div",{className:"text-center py-8",children:[o.jsx("p",{className:"text-gray-500 mb-2",children:"No quotes found for this project."}),o.jsx("p",{className:"text-sm text-gray-400",children:"Import quotes first to use the scope matrix."})]}):ne.length===0?o.jsxs("div",{className:"text-center py-8",children:[o.jsx("p",{className:"text-gray-500 mb-2",children:"No ready quotes found."}),o.jsxs("p",{className:"text-sm text-gray-400",children:["Go to"," ",o.jsx("button",{onClick:()=>{},className:"text-blue-600 hover:text-blue-700 underline",children:"Review & Clean"})," ",'and click "Process All Quotes" first.']})]}):o.jsx("div",{className:"space-y-2",children:k.map(N=>o.jsxs("button",{onClick:()=>N.is_normalized&&xe(N.id),disabled:!N.is_normalized,className:`w-full flex items-center gap-4 p-4 rounded-lg border transition-all text-left ${N.is_normalized?E.includes(N.id)?"bg-blue-50 border-blue-300 hover:bg-blue-100":"bg-white border-gray-200 hover:bg-gray-50":"bg-gray-50 border-gray-200 opacity-60 cursor-not-allowed"}`,children:[o.jsx("div",{className:"flex-shrink-0",children:N.is_normalized&&E.includes(N.id)?o.jsx($y,{className:"text-blue-600",size:20}):o.jsx(Wy,{className:"text-gray-400",size:20})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:"font-medium text-gray-900",children:N.supplier_name}),N.quote_reference&&o.jsx("div",{className:"text-sm text-gray-500",children:N.quote_reference})]}),o.jsxs("div",{className:"flex items-center gap-4",children:[N.total_amount&&o.jsxs("div",{className:"text-sm font-medium text-gray-700",children:["$",N.total_amount.toLocaleString()]}),o.jsx("div",{children:N.is_normalized?o.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Ready"}):o.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-600",children:"Pending mapping"})})]})]},N.id))}),o.jsxs("div",{className:"flex items-center justify-between mt-6 pt-4 border-t border-gray-200",children:[o.jsxs("div",{className:"text-sm text-gray-600",children:[E.length," ",E.length===1?"quote":"quotes"," selected"]}),o.jsx("button",{onClick:ve,disabled:E.length===0||U,className:"px-6 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed",children:U?"Building Matrix...":"Generate Scope Matrix"})]})]}),!W&&!u&&o.jsx("div",{className:"bg-white rounded-xl p-12 border border-gray-200 shadow-sm text-center",children:o.jsx("p",{className:"text-gray-500",children:'Select one or more quotes above and click "Generate Scope Matrix" to view the comparison.'})}),u&&o.jsx("div",{className:"bg-white rounded-xl p-12 border border-gray-200 shadow-sm text-center",children:o.jsx("div",{className:"text-gray-500",children:"Building scope matrix..."})}),W&&!u&&s.length===0&&o.jsx("div",{className:"bg-white rounded-xl p-12 border border-gray-200 shadow-sm",children:o.jsxs("div",{className:"text-center",children:[o.jsx(it,{className:"mx-auto mb-4 text-amber-500",size:48}),o.jsx("p",{className:"text-gray-900 text-lg font-semibold mb-2",children:"No comparison data available for the selected quotes"}),o.jsx("p",{className:"text-gray-600 mb-4",children:"This usually means the quote items haven't been fully processed yet."}),o.jsxs("div",{className:"text-left max-w-md mx-auto bg-gray-50 rounded-lg p-4 text-sm",children:[o.jsx("p",{className:"font-semibold text-gray-900 mb-2",children:"Please check:"}),o.jsxs("ul",{className:"space-y-1 text-gray-600",children:[o.jsx("li",{children:"1. Quotes have been imported"}),o.jsx("li",{children:'2. Items have been normalised (Run "Process All Quotes" in Review & Clean)'}),o.jsx("li",{children:"3. Items have been mapped to systems (system_id field populated)"}),o.jsx("li",{children:"4. Model rates are configured for your organisation"})]})]}),o.jsx("p",{className:"text-sm text-gray-500 mt-4",children:"Check the browser console (F12) for detailed diagnostic information."})]})}),W&&!u&&s.length>0&&o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsxs("button",{onClick:()=>h(!f),className:"flex items-center gap-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 transition-colors",children:[o.jsx(CS,{size:18}),"Filters",he&&o.jsx("span",{className:"ml-1 px-2 py-0.5 bg-blue-600 text-white text-xs rounded-full",children:Object.values(L).filter(N=>N).length})]}),he&&o.jsxs("button",{onClick:Y,className:"flex items-center gap-2 px-3 py-2 text-sm text-gray-600 hover:text-gray-900",children:[o.jsx(Qr,{size:16}),"Clear filters"]})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsxs("button",{onClick:()=>g(!0),disabled:_.length===0,className:"flex items-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed",children:[o.jsx(IF,{size:18}),"Suggested Systems",_.length>0&&o.jsx("span",{className:"ml-1 px-2 py-0.5 bg-purple-800 text-white text-xs rounded-full",children:_.length})]}),o.jsxs("button",{onClick:B,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:[o.jsx(si,{size:18}),"Export CSV"]})]})]}),f&&o.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Section"}),o.jsxs("select",{value:L.section||"",onChange:N=>X({...L,section:N.target.value||void 0}),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[o.jsx("option",{value:"",children:"All"}),K.sections.map(N=>o.jsx("option",{value:N,children:N},N))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Service"}),o.jsxs("select",{value:L.service||"",onChange:N=>X({...L,service:N.target.value||void 0}),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[o.jsx("option",{value:"",children:"All"}),K.services.map(N=>o.jsx("option",{value:N,children:N},N))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Subclass"}),o.jsxs("select",{value:L.subclass||"",onChange:N=>X({...L,subclass:N.target.value||void 0}),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[o.jsx("option",{value:"",children:"All"}),K.subclasses.map(N=>o.jsx("option",{value:N,children:N},N))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"FRR"}),o.jsxs("select",{value:L.frr||"",onChange:N=>X({...L,frr:N.target.value||void 0}),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[o.jsx("option",{value:"",children:"All"}),K.frrs.map(N=>o.jsx("option",{value:N,children:N},N))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Size Bucket"}),o.jsxs("select",{value:L.sizeBucket||"",onChange:N=>X({...L,sizeBucket:N.target.value||void 0}),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[o.jsx("option",{value:"",children:"All"}),K.sizeBuckets.map(N=>o.jsx("option",{value:N,children:N},N))]})]})]})}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-6",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Scope Matrix"}),o.jsxs("div",{className:"relative group",children:[o.jsx(kd,{size:18,className:"text-gray-400 hover:text-gray-600 cursor-help"}),o.jsxs("div",{className:"absolute left-1/2 -translate-x-1/2 bottom-full mb-2 hidden group-hover:block z-20 w-80 p-3 bg-gray-900 text-white text-sm rounded-lg shadow-lg",children:[o.jsx("div",{className:"font-semibold mb-1",children:"Scope Matrix"}),o.jsx("div",{className:"text-gray-200",children:"Compare supplier rates for each passive fire system and quickly see pricing differences and missing items."}),o.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 top-full w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-gray-900"})]})]})]}),o.jsxs("div",{className:"flex items-center gap-6 text-sm",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-4 h-4 bg-green-100 border-2 border-green-300 rounded"}),o.jsx("span",{className:"text-gray-600",children:"10%"})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-4 h-4 bg-amber-100 border-2 border-amber-300 rounded"}),o.jsx("span",{className:"text-gray-600",children:"20%"})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-4 h-4 bg-red-100 border-2 border-red-300 rounded"}),o.jsx("span",{className:"text-gray-600",children:">20%"})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-4 h-4 bg-gray-100 border-2 border-gray-300 rounded"}),o.jsx("span",{className:"text-gray-600",children:"N/A"})]})]})]}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full border-collapse text-sm",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"bg-gray-50",children:[o.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700 border border-gray-200 sticky left-0 bg-gray-50 z-10",children:"System"}),l.map(N=>o.jsx("th",{className:"px-3 py-2 text-center font-medium text-gray-700 border border-gray-200 min-w-[120px]",children:N},N))]})}),o.jsx("tbody",{children:a.map((N,G)=>o.jsxs("tr",{className:"hover:bg-gray-50",children:[o.jsx("td",{className:"px-3 py-2 text-sm font-medium text-gray-900 border border-gray-200 sticky left-0 bg-white z-10",children:o.jsxs("div",{className:"flex flex-col",children:[o.jsx("span",{className:"font-semibold",children:N.systemLabel}),N.systemId!==N.systemLabel&&o.jsx("span",{className:"text-xs text-gray-500",children:N.systemId})]})}),l.map(ce=>{const te=N.cells[ce];if(!te)return o.jsx("td",{className:"px-3 py-2 text-center border border-gray-200",children:o.jsx("span",{className:"text-gray-400",children:"-"})},ce);const ue=p.has(te.quoteItemId);return o.jsx("td",{className:"px-3 py-2 border border-gray-200",children:o.jsxs("div",{className:"relative group",children:[o.jsxs("div",{className:`px-2 py-1.5 rounded text-center font-medium border-2 ${xV(te.flag)} flex items-center justify-center gap-1`,children:[o.jsx("span",{children:te.unitRate!==null?`$${te.unitRate.toFixed(2)}`:"N/A"}),ue&&o.jsx(it,{size:14,className:"text-yellow-600"})]}),o.jsxs("div",{className:"absolute left-1/2 -translate-x-1/2 bottom-full mb-2 hidden group-hover:block z-20 w-48 p-3 bg-gray-900 text-white text-xs rounded-lg shadow-lg",children:[o.jsxs("div",{className:"space-y-1",children:[ue&&o.jsxs("div",{className:"pb-2 mb-2 border-b border-gray-700 text-yellow-300 flex items-start gap-1",children:[o.jsx(it,{size:14,className:"flex-shrink-0 mt-0.5"}),o.jsx("span",{children:"Quantity missing in source quote. Please review before finalising."})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-gray-300",children:"Unit Rate:"}),o.jsx("span",{className:"font-semibold",children:te.unitRate!==null?`$${te.unitRate.toFixed(2)}`:"N/A"})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-gray-300",children:"Model Rate:"}),o.jsx("span",{className:"font-semibold",children:te.modelRate!==null?`$${te.modelRate.toFixed(2)}`:"N/A"})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-gray-300",children:"Variance:"}),o.jsx("span",{className:"font-semibold",children:te.variancePct!==null?`${te.variancePct>0?"+":""}${te.variancePct.toFixed(1)}%`:"N/A"})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-gray-300",children:"Components:"}),o.jsx("span",{className:"font-semibold",children:te.componentCount||"N/A"})]})]}),o.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 top-full w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-gray-900"})]})]})},ce)})]},G))})]})}),a.length===0&&o.jsx("div",{className:"text-center py-8 text-gray-500",children:"No data matches the selected filters."}),o.jsxs("div",{className:"mt-6 pt-4 border-t border-gray-200",children:[o.jsx("button",{onClick:()=>w(!y),className:"flex items-center gap-2 text-sm text-gray-600 hover:text-gray-900 transition-colors",children:y?o.jsxs(o.Fragment,{children:[o.jsx(yF,{size:16}),o.jsx("span",{children:"Less Info"})]}):o.jsxs(o.Fragment,{children:[o.jsx(wo,{size:16}),o.jsx("span",{children:"More Info"})]})}),y&&o.jsxs("div",{className:"mt-4 p-4 bg-gray-50 border border-gray-200 rounded-lg",children:[o.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-2",children:"How to Read This Matrix"}),o.jsx("p",{className:"text-sm text-gray-700 leading-relaxed",children:"This matrix compares each supplier's rates for the same passive fire systems so you can accurately assess scope and pricing differences. Every row is a system type, and each column shows how each supplier priced that system. Colour indicators highlight where prices vary, helping you quickly identify mismatches, missing items, and potential scope gaps."})]})]})]}),o.jsx($k,{currentStep:4,onBack:t,onNext:r,backLabel:"Back: Quote Intelligence",nextLabel:"Next: Equalisation"})]})]}),x&&o.jsx(pV,{projectId:e,organisationId:b,onClose:()=>g(!1),onSystemCreated:()=>{P()}})]})}function vV({projectId:e}){const[t,r]=T.useState([]),[s,n]=T.useState(!0);T.useEffect(()=>{a()},[e]);const a=async()=>{n(!0);try{const{data:m,error:x}=await ie.from("base_tracker").select("*").eq("project_id",e).order("section",{ascending:!0}).order("system_id",{ascending:!0});if(x)throw x;const g=(m||[]).map(y=>({...y,claim_period:y.claim_period||null,claim_qty:y.claim_qty||0,previous_qty:y.previous_qty||0}));r(g)}catch(m){console.error("Error loading base tracker data:",m)}finally{n(!1)}},i=(m,x)=>m*x,l=(m,x)=>m+x,c=(m,x)=>m*x,u=(m,x)=>{const g=m-x;return g>0?g:0},d=()=>{const m=t.reduce((g,y)=>g+i(y.qty_base,y.unit_rate),0),x=t.reduce((g,y)=>g+c(y.claim_qty,y.unit_rate),0);return{contractSum:m,thisClaim:x}},f=()=>{const m=t.map(v=>{const b=i(v.qty_base,v.unit_rate),_=l(v.claim_qty,v.previous_qty),k=c(v.claim_qty,v.unit_rate),S=u(_,v.qty_base);return{Section:v.section,Code:v.system_id,Description:v.description,Size:v.size,"Substrate & Fire rating":`${v.material||""} ${v.frr||""}`.trim(),"Qty (Contract)":v.qty_base,Unit:v.unit,"Unit Rate":v.unit_rate,"Total Price (Contract)":b,"Claim Period":v.claim_period||"","Claim Qty":v.claim_qty,"Previous Qty":v.previous_qty,"Total Qty":_,Rates:v.unit_rate,"Claim Amount":k,"Exceeding contract works":S,Notes:v.notes,"Last Updated":new Date(v.updated_at).toLocaleDateString()}}),x=ht.json_to_sheet(m),g=ht.book_new();ht.book_append_sheet(g,x,"Base Tracker");const y=d(),w=[[""],["Summary"],["Contract Sum",y.contractSum],["This Claim",y.thisClaim]];ht.sheet_add_aoa(x,w,{origin:-1}),ug(g,`BaseTracker_${e}_${new Date().toISOString().split("T")[0]}.xlsx`)},h=()=>{const m=t.map(v=>{const b=i(v.qty_base,v.unit_rate),_=l(v.claim_qty,v.previous_qty),k=c(v.claim_qty,v.unit_rate),S=u(_,v.qty_base);return{Section:v.section,Code:v.system_id,Description:v.description,Size:v.size,"Substrate & Fire rating":`${v.material||""} ${v.frr||""}`.trim(),"Qty (Contract)":v.qty_base,Unit:v.unit,"Unit Rate":v.unit_rate,"Total Price (Contract)":b,"Claim Period":v.claim_period||"","Claim Qty":v.claim_qty,"Previous Qty":v.previous_qty,"Total Qty":_,Rates:v.unit_rate,"Claim Amount":k,"Exceeding contract works":S,Notes:v.notes,"Last Updated":new Date(v.updated_at).toLocaleDateString()}}),x=ht.json_to_sheet(m),g=ht.sheet_to_csv(x),y=new Blob([g],{type:"text/csv;charset=utf-8;"}),w=document.createElement("a");w.href=URL.createObjectURL(y),w.download=`BaseTracker_${e}_${new Date().toISOString().split("T")[0]}.csv`,w.click()};if(s)return o.jsx("div",{className:"flex items-center justify-center h-64",children:o.jsx("div",{className:"text-gray-500",children:"Loading base tracker data..."})});if(t.length===0)return o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center",children:[o.jsx(it,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),o.jsx("p",{className:"text-gray-500 text-lg mb-2",children:"No base tracker data available"}),o.jsx("p",{className:"text-gray-400",children:"Create base tracker items from the Award Report page"})]});const p=d();return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Base Tracker"}),o.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Contract baseline with ",t.length," items"]})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsxs("button",{onClick:f,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors",children:[o.jsx(jF,{size:18}),"Export Excel"]}),o.jsxs("button",{onClick:h,className:"flex items-center gap-2 px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors",children:[o.jsx(si,{size:18}),"Export CSV"]})]})]}),o.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full text-sm",children:[o.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-3 py-3 text-left text-xs font-semibold text-gray-700 uppercase",children:"Section"}),o.jsx("th",{className:"px-3 py-3 text-left text-xs font-semibold text-gray-700 uppercase",children:"Code"}),o.jsx("th",{className:"px-3 py-3 text-left text-xs font-semibold text-gray-700 uppercase",children:"Description"}),o.jsx("th",{className:"px-3 py-3 text-left text-xs font-semibold text-gray-700 uppercase",children:"Size"}),o.jsx("th",{className:"px-3 py-3 text-left text-xs font-semibold text-gray-700 uppercase",children:"Substrate & Fire Rating"}),o.jsx("th",{className:"px-3 py-3 text-right text-xs font-semibold text-gray-700 uppercase",children:"Qty (Contract)"}),o.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-gray-700 uppercase",children:"Unit"}),o.jsx("th",{className:"px-3 py-3 text-right text-xs font-semibold text-gray-700 uppercase",children:"Unit Rate"}),o.jsx("th",{className:"px-3 py-3 text-right text-xs font-semibold text-gray-700 uppercase bg-blue-50",children:"Total Price (Contract)"}),o.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-gray-700 uppercase",children:"Claim Period"}),o.jsx("th",{className:"px-3 py-3 text-right text-xs font-semibold text-gray-700 uppercase",children:"Claim Qty"}),o.jsx("th",{className:"px-3 py-3 text-right text-xs font-semibold text-gray-700 uppercase",children:"Previous Qty"}),o.jsx("th",{className:"px-3 py-3 text-right text-xs font-semibold text-gray-700 uppercase bg-blue-50",children:"Total Qty"}),o.jsx("th",{className:"px-3 py-3 text-right text-xs font-semibold text-gray-700 uppercase bg-blue-50",children:"Rates"}),o.jsx("th",{className:"px-3 py-3 text-right text-xs font-semibold text-gray-700 uppercase bg-green-50",children:"Claim Amount"}),o.jsx("th",{className:"px-3 py-3 text-right text-xs font-semibold text-gray-700 uppercase bg-amber-50",children:"Exceeding Contract Works"}),o.jsx("th",{className:"px-3 py-3 text-left text-xs font-semibold text-gray-700 uppercase",children:"Notes"}),o.jsx("th",{className:"px-3 py-3 text-left text-xs font-semibold text-gray-700 uppercase",children:"Last Updated"})]})}),o.jsx("tbody",{className:"divide-y divide-gray-200",children:t.map(m=>{const x=i(m.qty_base,m.unit_rate),g=l(m.claim_qty,m.previous_qty),y=c(m.claim_qty,m.unit_rate),w=u(g,m.qty_base);return o.jsxs("tr",{className:"hover:bg-gray-50",children:[o.jsx("td",{className:"px-3 py-2 text-gray-900",children:m.section}),o.jsx("td",{className:"px-3 py-2 text-gray-900 font-mono text-xs",children:m.system_id}),o.jsx("td",{className:"px-3 py-2 text-gray-900 max-w-xs",children:m.description}),o.jsx("td",{className:"px-3 py-2 text-gray-900",children:m.size}),o.jsx("td",{className:"px-3 py-2 text-gray-900",children:`${m.material||""} ${m.frr||""}`.trim()}),o.jsx("td",{className:"px-3 py-2 text-right text-gray-900",children:m.qty_base.toFixed(2)}),o.jsx("td",{className:"px-3 py-2 text-center text-gray-900",children:m.unit}),o.jsxs("td",{className:"px-3 py-2 text-right text-gray-900",children:["$",m.unit_rate.toFixed(2)]}),o.jsxs("td",{className:"px-3 py-2 text-right text-gray-900 font-semibold bg-blue-50",children:["$",x.toFixed(2)]}),o.jsx("td",{className:"px-3 py-2 text-center text-gray-600",children:m.claim_period||"-"}),o.jsx("td",{className:"px-3 py-2 text-right text-gray-900",children:m.claim_qty.toFixed(2)}),o.jsx("td",{className:"px-3 py-2 text-right text-gray-900",children:m.previous_qty.toFixed(2)}),o.jsx("td",{className:"px-3 py-2 text-right text-gray-900 font-semibold bg-blue-50",children:g.toFixed(2)}),o.jsxs("td",{className:"px-3 py-2 text-right text-gray-900 bg-blue-50",children:["$",m.unit_rate.toFixed(2)]}),o.jsxs("td",{className:"px-3 py-2 text-right text-gray-900 font-semibold bg-green-50",children:["$",y.toFixed(2)]}),o.jsx("td",{className:`px-3 py-2 text-right font-semibold ${w>0?"text-red-700 bg-red-50":"text-gray-900 bg-amber-50"}`,children:w.toFixed(2)}),o.jsx("td",{className:"px-3 py-2 text-gray-600 max-w-xs truncate",children:m.notes}),o.jsx("td",{className:"px-3 py-2 text-gray-600 text-xs",children:new Date(m.updated_at).toLocaleDateString()})]},m.id)})})]})})}),o.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:o.jsxs("div",{className:"grid grid-cols-2 gap-8",children:[o.jsxs("div",{children:[o.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Contract Sum"}),o.jsxs("div",{className:"text-3xl font-bold text-gray-900",children:["$",p.contractSum.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"This Claim"}),o.jsxs("div",{className:"text-3xl font-bold text-green-600",children:["$",p.thisClaim.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]})})]})}const Im={set:(e,t)=>localStorage.setItem(e,JSON.stringify(t)),get:e=>{const t=localStorage.getItem(e);return t?JSON.parse(t):null}};function Aw(e){return{get:t=>Im.get(`${e}_${t}`),set:(t,r)=>Im.set(`${e}_${t}`,r)}}function Fw(e,t,r){Im.set(`project_${e}_${t}`,r)}function yV({projectId:e,projectName:t}){const[r,s]=T.useState("claims"),[n,a]=T.useState(()=>{const c=Aw(e);return(c==null?void 0:c.period)||"all"}),[i,l]=T.useState(()=>{var u;const c=Aw(e);return((u=c==null?void 0:c.filters)==null?void 0:u.status)||[]});return T.useEffect(()=>{Fw(e,"claims",{period:n})},[e,n]),T.useEffect(()=>{Fw(e,"variations",{filters:{status:i}})},[e,i]),e?o.jsxs(vo.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},className:"space-y-6",children:[o.jsxs("div",{className:"card",children:[o.jsxs("div",{className:"flex items-center justify-between mb-6",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"metric-icon primary",children:o.jsx(Ki,{className:"w-6 h-6"})}),o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Claims & Variations"}),o.jsx("p",{className:"text-gray-600 mt-1",children:"Reconcile payment claims to baseline and manage change"})]})]}),o.jsx("div",{className:"px-4 py-2 bg-gray-100 rounded-lg",children:o.jsxs("span",{className:"text-sm font-medium text-gray-700",children:["Project: ",t]})})]}),o.jsxs("div",{className:"grid grid-cols-3 gap-6",children:[o.jsxs("div",{className:"metric-tile",children:[o.jsxs("div",{children:[o.jsx("div",{className:"metric-label",children:"Overclaimed"}),o.jsx("div",{className:"metric-value text-red-600",children:"$0"})]}),o.jsx("div",{className:"metric-icon danger",children:o.jsx(qa,{className:"w-6 h-6"})})]}),o.jsxs("div",{className:"metric-tile",children:[o.jsxs("div",{children:[o.jsx("div",{className:"metric-label",children:"Underclaimed"}),o.jsx("div",{className:"metric-value",style:"color: var(--warning)",children:"$0"})]}),o.jsx("div",{className:"metric-icon warning",children:o.jsx(Ki,{className:"w-6 h-6"})})]}),o.jsxs("div",{className:"metric-tile",children:[o.jsxs("div",{children:[o.jsx("div",{className:"metric-label",children:"Unmatched"}),o.jsx("div",{className:"metric-value",children:"0"})]}),o.jsx("div",{className:"metric-icon primary",children:o.jsx($t,{className:"w-6 h-6"})})]})]})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"bg-gray-100 p-1 rounded-lg flex gap-1",children:[o.jsx("button",{onClick:()=>s("claims"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${r==="claims"?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"Claims Reconciliation"}),o.jsx("button",{onClick:()=>s("variations"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${r==="variations"?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"Variations Register"})]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("button",{disabled:!0,className:"p-2 bg-white border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed shadow-sm",children:o.jsx(rc,{className:"w-5 h-5 text-gray-400"})}),o.jsx("button",{disabled:!0,className:"p-2 bg-white border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed shadow-sm",children:o.jsx(si,{className:"w-5 h-5 text-gray-400"})}),o.jsx("button",{disabled:!0,className:"p-2 bg-white border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed shadow-sm",children:o.jsx(jd,{className:"w-5 h-5 text-gray-400"})})]})]}),r==="claims"&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsxs("select",{value:n,onChange:c=>a(c.target.value),className:"input-field",children:[o.jsx("option",{value:"all",children:"All Periods"}),o.jsx("option",{value:"2024-01",children:"January 2024"}),o.jsx("option",{value:"2024-02",children:"February 2024"}),o.jsx("option",{value:"2024-03",children:"March 2024"})]}),o.jsxs("button",{disabled:!0,className:"btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:[o.jsx(rc,{className:"w-4 h-4"}),"Import Claim XLSX"]})]}),o.jsx("div",{className:"card p-0 overflow-hidden",children:o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"table-clean",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Item"}),o.jsx("th",{children:"Description"}),o.jsx("th",{children:"Unit"}),o.jsx("th",{className:"text-right",children:"Qty (Base)"}),o.jsx("th",{className:"text-right",children:"Qty (Claimed)"}),o.jsx("th",{className:"text-right",children:"Delta"}),o.jsx("th",{className:"text-right",children:"Rate"}),o.jsx("th",{className:"text-right",children:"Amount"}),o.jsx("th",{className:"text-center",children:"Match Status"})]})}),o.jsx("tbody",{children:o.jsx("tr",{children:o.jsxs("td",{colSpan:9,className:"px-4 py-16 text-center",children:[o.jsx(qa,{className:"w-12 h-12 mx-auto mb-3 text-gray-400"}),o.jsx("p",{className:"text-lg font-medium mb-2 text-gray-900",children:"No Claims Data"}),o.jsx("p",{className:"text-sm mb-4 text-gray-600",children:"Import payment claims to reconcile against baseline"}),o.jsxs("button",{className:"text-blue-600 hover:text-blue-700 transition-colors text-sm font-medium flex items-center gap-2 mx-auto",children:[o.jsx($t,{className:"w-4 h-4"}),"Learn more"]})]})})})]})})})]}),r==="variations"&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsx("div",{className:"flex gap-2",children:["Pending","Approved","Rejected"].map(c=>o.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-700",children:[o.jsx("input",{type:"checkbox",checked:i.includes(c),onChange:u=>{u.target.checked?l([...i,c]):l(i.filter(d=>d!==c))},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),c]},c))}),o.jsx("button",{disabled:!0,className:"ml-auto px-4 py-2 bg-amber-600 text-white rounded-lg text-sm font-medium hover:bg-amber-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:"Auto-Detect Variations"}),o.jsxs("button",{disabled:!0,className:"px-4 py-2 glass-card text-slate-300 rounded-lg text-sm font-medium hover:bg-slate-800/50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[o.jsx(si,{className:"w-4 h-4"}),"Export Register"]})]}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:o.jsxs("div",{className:"card text-center",children:[o.jsx(qa,{className:"w-12 h-12 mx-auto mb-3 text-gray-400"}),o.jsx("p",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Variations"}),o.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Variations will appear here once detected or manually added"}),o.jsxs("button",{className:"text-blue-600 hover:text-blue-700 transition-colors text-sm font-medium flex items-center gap-2 mx-auto",children:[o.jsx($t,{className:"w-4 h-4"}),"Learn more"]})]})})]}),o.jsxs("div",{className:"card flex items-center gap-3 text-gray-600 text-sm",children:[o.jsx(Ki,{className:"w-5 h-5 icon-blue"}),o.jsx("span",{children:"Claims & Variations: Reconciliation & Change Management"})]})]}):o.jsx("div",{className:"flex items-center justify-center min-h-[60vh] p-8",children:o.jsxs("div",{className:"card max-w-md text-center",children:[o.jsx("div",{className:"metric-icon primary mx-auto mb-4",children:o.jsx(Ki,{className:"w-8 h-8"})}),o.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Select or Create a Project"}),o.jsx("p",{className:"text-gray-600 mb-6",children:"Choose a project to access Claims & Variations features"}),o.jsx("button",{className:"btn-primary",children:"Go to Project Dashboard"})]})})}function wV({projectId:e}){const[t,r]=T.useState("basetracker");return o.jsxs("div",{className:"h-full flex flex-col bg-gray-50",children:[o.jsxs("div",{className:"bg-white border-b border-gray-200 px-8 py-6",children:[o.jsx("div",{className:"flex items-center justify-between mb-4",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-10 h-10 bg-blue-50 rounded-lg flex items-center justify-center",children:o.jsx(ES,{className:"w-5 h-5 text-blue-600"})}),o.jsxs("div",{children:[o.jsx("h1",{className:"text-3xl font-semibold brand-navy",children:"Contract Manager"}),o.jsx("p",{className:"text-gray-600 text-base",children:"Base contract tracking and management"})]})]})}),o.jsx("div",{className:"flex gap-2",children:o.jsxs("button",{onClick:()=>r("basetracker"),className:`flex items-center gap-2 px-4 py-2 rounded-full text-sm font-medium transition-colors ${t==="basetracker"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[o.jsx($t,{size:16}),"Base Tracker"]})})]}),o.jsxs("div",{className:"flex-1 overflow-auto",children:[t==="basetracker"&&o.jsx(vV,{projectId:e}),t==="claims"&&o.jsx(yV,{projectId:e})]})]})}function bV({projects:e,onNavigate:t}){const[r,s]=T.useState(""),[n,a]=T.useState(null),[i,l]=T.useState(!1),[c,u]=T.useState(null),d=e.filter(_=>_.name.toLowerCase().includes(r.toLowerCase())||_.client_reference.toLowerCase().includes(r.toLowerCase())),f=d.filter(_=>!_.has_report),h=d.filter(_=>_.has_report),p=()=>{n!=null&&n.report_id&&(t==null||t("award-report",n.report_id))},m=async(_=!1)=>{var k,S,E,C,U,H,W;if(n){l(!0),u(null);try{const Q=await fetch("https://cbankidsdfsvsgfygbzt.supabase.co/functions/v1/compute_award_report",{method:"POST",headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNiYW5raWRzZGZzdnNnZnlnYnp0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMzMTk3NDgsImV4cCI6MjA3ODg5NTc0OH0.SXgc-9ZamplKeJm5_nl8J2-UzO7A0f8KbAnPZEmsiSo","Content-Type":"application/json"},body:JSON.stringify({projectId:n.id,force:_})});if(!Q.ok){const fe=await Q.text();throw new Error(`Server returned ${Q.status}: ${fe}`)}const L=await Q.json();if(!L||!L.reportId)throw new Error("No report ID returned from server");const{data:X}=await ie.from("award_reports").select("id, generated_at, result_json").eq("id",L.reportId).single(),K=((E=(S=(k=X==null?void 0:X.result_json)==null?void 0:k.awardSummary)==null?void 0:S.suppliers)==null?void 0:E.length)||0,V=((W=(H=(U=(C=X==null?void 0:X.result_json)==null?void 0:C.awardSummary)==null?void 0:U.suppliers)==null?void 0:H[0])==null?void 0:W.coveragePercent)||0;a({...n,has_report:!0,report_id:L.reportId,report_generated_at:X==null?void 0:X.generated_at,report_quotes_count:K,report_coverage_percent:Math.round(V)}),t==null||t("award-report",L.reportId)}catch(q){console.error("Error computing award report:",q),u(q.message||"Failed to compute award report")}finally{l(!1)}}},x=()=>{m(!1)},g=()=>{m(!0)},y=async()=>{var _,k,S,E,C,U,H;if(n!=null&&n.report_id)try{const{data:W}=await ie.from("award_reports").select("id, generated_at, result_json").eq("id",n.report_id).single();if(W){const q=((S=(k=(_=W.result_json)==null?void 0:_.awardSummary)==null?void 0:k.suppliers)==null?void 0:S.length)||0,z=((H=(U=(C=(E=W.result_json)==null?void 0:E.awardSummary)==null?void 0:C.suppliers)==null?void 0:U[0])==null?void 0:H.coveragePercent)||0;a({...n,report_generated_at:W.generated_at,report_quotes_count:q,report_coverage_percent:Math.round(z)})}}catch(W){console.error("Error refreshing project metadata:",W)}};T.useEffect(()=>{n!=null&&n.has_report&&n.report_id&&y()},[n==null?void 0:n.id]);const w=async()=>{if(n!=null&&n.report_id)try{const{data:_,error:k}=await ie.from("award_reports").select("result_json, generated_at").eq("id",n.report_id).single();if(k||!_){console.error("Error loading report:",k);return}const E=_.result_json.awardSummary,C=`
        <!DOCTYPE html>
        <html>
        <head>
          <meta charset="UTF-8">
          <title>Award Report - ${n.name}</title>
          <style>
            body { font-family: Arial, sans-serif; padding: 40px; line-height: 1.6; color: #333; }
            h1 { color: #1e40af; border-bottom: 3px solid #3b82f6; padding-bottom: 10px; margin-bottom: 30px; }
            h2 { color: #1e40af; margin-top: 30px; margin-bottom: 15px; border-bottom: 1px solid #e5e7eb; padding-bottom: 8px; }
            h3 { color: #374151; margin-top: 20px; }
            table { width: 100%; border-collapse: collapse; margin: 20px 0; }
            th, td { padding: 12px; text-align: left; border: 1px solid #d1d5db; }
            th { background-color: #3b82f6; color: white; font-weight: 600; }
            tr:nth-child(even) { background-color: #f9fafb; }
            .meta { color: #6b7280; font-size: 14px; margin-bottom: 30px; }
            .supplier-section { margin: 30px 0; padding: 20px; background: #f9fafb; border-radius: 8px; }
            .recommendation { background: #dbeafe; padding: 15px; border-left: 4px solid #3b82f6; margin: 20px 0; }
          </style>
        </head>
        <body>
          <h1>Award Recommendation Report</h1>
          <div class="meta">
            <p><strong>Project:</strong> ${n.name}</p>
            <p><strong>Client:</strong> ${n.client_reference}</p>
            <p><strong>Generated:</strong> ${new Date(_.generated_at).toLocaleString()}</p>
            <p><strong>Equalisation Mode:</strong> ${E.equalisationMode}</p>
          </div>

          <h2>Supplier Rankings</h2>
          <table>
            <thead>
              <tr>
                <th>Rank</th>
                <th>Supplier</th>
                <th>Adjusted Total</th>
                <th>Risk Score</th>
                <th>Coverage %</th>
                <th>Items Quoted</th>
              </tr>
            </thead>
            <tbody>
              ${E.suppliers.map((q,z)=>`
                <tr>
                  <td>${z+1}</td>
                  <td>${q.supplierName}</td>
                  <td>$${q.adjustedTotal.toLocaleString()}</td>
                  <td>${q.riskScore}</td>
                  <td>${q.coveragePercent}%</td>
                  <td>${q.itemsQuoted}</td>
                </tr>
              `).join("")}
            </tbody>
          </table>

          <h2>Recommendations</h2>
          ${E.recommendations.map(q=>`
            <div class="recommendation">
              <h3>${q.type.replace("_"," ")}</h3>
              <p><strong>Supplier:</strong> ${q.supplier.supplierName}</p>
              <p><strong>Reason:</strong> ${q.reason}</p>
            </div>
          `).join("")}
        </body>
        </html>
      `,U=new Blob([C],{type:"text/html"}),H=URL.createObjectURL(U),W=window.open(H,"_blank","width=1024,height=768");if(W)W.onload=()=>{setTimeout(()=>{W.print(),setTimeout(()=>{URL.revokeObjectURL(H)},1e3)},500)};else{const q=document.createElement("a");q.href=H,q.download=`Award_Report_${n.name.replace(/[^a-z0-9]/gi,"_")}.html`,document.body.appendChild(q),q.click(),document.body.removeChild(q),setTimeout(()=>URL.revokeObjectURL(H),1e3)}}catch(_){console.error("Error exporting PDF:",_)}},v=()=>{n&&(t==null||t("award-report"))},b=_=>new Date(_).toLocaleDateString("en-NZ",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"});return o.jsxs("div",{className:"h-full flex flex-col bg-gray-50",children:[o.jsx("div",{className:"bg-white border-b border-gray-200 px-6 py-4",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-10 h-10 bg-blue-500 rounded-lg flex items-center justify-center",children:o.jsx($t,{className:"w-6 h-6 text-white"})}),o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Reports Hub"}),o.jsx("p",{className:"text-sm text-gray-500",children:"Manage and generate award reports"})]})]})}),o.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[o.jsxs("div",{className:"w-96 bg-white border-r border-gray-200 flex flex-col",children:[o.jsx("div",{className:"p-4 border-b border-gray-200",children:o.jsxs("div",{className:"relative",children:[o.jsx(Nd,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),o.jsx("input",{type:"text",placeholder:"Search projects...",value:r,onChange:_=>s(_.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),o.jsxs("div",{className:"flex-1 overflow-y-auto",children:[f.length>0&&o.jsxs("div",{className:"mb-6",children:[o.jsx("div",{className:"px-4 py-2 bg-amber-50 border-b border-amber-100",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(it,{className:"w-4 h-4 text-amber-600"}),o.jsxs("span",{className:"text-sm font-medium text-amber-900",children:["Needs Report (",f.length,")"]})]})}),o.jsx("div",{className:"divide-y divide-gray-100",children:f.map(_=>o.jsxs("button",{onClick:()=>a(_),className:`w-full text-left px-4 py-3 hover:bg-gray-50 transition-colors ${(n==null?void 0:n.id)===_.id?"bg-blue-50 border-l-4 border-blue-500":""}`,children:[o.jsx("div",{className:"font-medium text-gray-900 mb-1",children:_.name}),o.jsx("div",{className:"text-xs text-gray-500 mb-1",children:_.client_reference}),o.jsxs("div",{className:"text-xs text-gray-400",children:["Updated ",b(_.updated_at)]})]},_.id))})]}),h.length>0&&o.jsxs("div",{children:[o.jsx("div",{className:"px-4 py-2 bg-green-50 border-b border-green-100",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Sd,{className:"w-4 h-4 text-green-600"}),o.jsxs("span",{className:"text-sm font-medium text-green-900",children:["With Report (",h.length,")"]})]})}),o.jsx("div",{className:"divide-y divide-gray-100",children:h.map(_=>o.jsxs("button",{onClick:()=>a(_),className:`w-full text-left px-4 py-3 hover:bg-gray-50 transition-colors ${(n==null?void 0:n.id)===_.id?"bg-blue-50 border-l-4 border-blue-500":""}`,children:[o.jsx("div",{className:"font-medium text-gray-900 mb-1",children:_.name}),o.jsx("div",{className:"text-xs text-gray-500 mb-1",children:_.client_reference}),o.jsxs("div",{className:"text-xs text-gray-400",children:["Updated ",b(_.updated_at)]})]},_.id))})]}),d.length===0&&o.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-gray-400",children:[o.jsx(Nd,{className:"w-12 h-12 mb-3"}),o.jsx("p",{className:"text-sm",children:"No projects found"})]})]})]}),o.jsx("div",{className:"flex-1 overflow-y-auto",children:n?o.jsxs("div",{className:"p-8",children:[o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6",children:[o.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-4",children:n.name}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{className:"flex items-center gap-3 text-gray-600",children:[o.jsx(yo,{className:"w-5 h-5 text-gray-400"}),o.jsxs("div",{children:[o.jsx("div",{className:"text-xs text-gray-500 uppercase",children:"Client"}),o.jsx("div",{className:"font-medium",children:n.client_reference||"Not specified"})]})]}),o.jsxs("div",{className:"flex items-center gap-3 text-gray-600",children:[o.jsx(FF,{className:"w-5 h-5 text-gray-400"}),o.jsxs("div",{children:[o.jsx("div",{className:"text-xs text-gray-500 uppercase",children:"Reference"}),o.jsx("div",{className:"font-medium",children:n.client_reference||"N/A"})]})]})]})]}),n.has_report?o.jsxs(o.Fragment,{children:[c&&o.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:o.jsxs("div",{className:"flex items-center gap-2 text-red-800",children:[o.jsx(it,{className:"w-5 h-5"}),o.jsx("span",{className:"font-medium",children:c})]})}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Report Actions"}),o.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4",children:o.jsxs("div",{className:"flex items-start gap-2",children:[o.jsx(it,{className:"w-5 h-5 text-blue-600 mt-0.5 flex-shrink-0"}),o.jsx("p",{className:"text-sm text-blue-800",children:"This report is cached. Changes to quotes will show after you click Regenerate."})]})}),o.jsxs("div",{className:"flex flex-wrap gap-3",children:[o.jsx("button",{onClick:p,disabled:i,className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium",children:"View Report"}),o.jsx("button",{onClick:g,disabled:i,className:"flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium",children:i?o.jsxs(o.Fragment,{children:[o.jsx(qs,{className:"w-4 h-4 animate-spin"}),"Regenerating..."]}):o.jsxs(o.Fragment,{children:[o.jsx(cs,{className:"w-4 h-4"}),"Regenerate"]})}),o.jsxs("button",{onClick:w,disabled:i,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium",children:[o.jsx(hx,{className:"w-4 h-4"}),"Export PDF"]}),o.jsxs("button",{onClick:v,disabled:i,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium",children:[o.jsx(PS,{className:"w-4 h-4"}),"Export Excel"]})]})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Report Details"}),o.jsxs("div",{className:"grid grid-cols-3 gap-6",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:o.jsx(TS,{className:"w-5 h-5 text-blue-600"})}),o.jsxs("div",{children:[o.jsx("div",{className:"text-xs text-gray-500 uppercase",children:"Generated"}),o.jsx("div",{className:"font-medium text-gray-900",children:n.report_generated_at?b(n.report_generated_at):"N/A"})]})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:o.jsx($t,{className:"w-5 h-5 text-green-600"})}),o.jsxs("div",{children:[o.jsx("div",{className:"text-xs text-gray-500 uppercase",children:"Quotes Included"}),o.jsx("div",{className:"font-medium text-gray-900",children:n.report_quotes_count||0})]})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center",children:o.jsx(Po,{className:"w-5 h-5 text-purple-600"})}),o.jsxs("div",{children:[o.jsx("div",{className:"text-xs text-gray-500 uppercase",children:"Coverage"}),o.jsx("div",{className:"font-medium text-gray-900",children:n.report_coverage_percent?`${n.report_coverage_percent}%`:"N/A"})]})]})]})]})]}):o.jsxs(o.Fragment,{children:[c&&o.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:o.jsxs("div",{className:"flex items-center gap-2 text-red-800",children:[o.jsx(it,{className:"w-5 h-5"}),o.jsx("span",{className:"font-medium",children:c})]})}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center",children:[o.jsx("div",{className:"w-16 h-16 bg-amber-100 rounded-full flex items-center justify-center mx-auto mb-4",children:o.jsx(it,{className:"w-8 h-8 text-amber-600"})}),o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Report Available"}),o.jsx("p",{className:"text-gray-500 mb-6",children:"Generate an award report to compare quotes and make award decisions."}),o.jsx("button",{onClick:x,disabled:i,className:"px-6 py-3 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium inline-flex items-center gap-2",children:i?o.jsxs(o.Fragment,{children:[o.jsx(qs,{className:"w-5 h-5 animate-spin"}),"Generating Report..."]}):o.jsxs(o.Fragment,{children:[o.jsx($t,{className:"w-5 h-5"}),"Generate Award Report"]})})]})]})]}):o.jsx("div",{className:"flex items-center justify-center h-full",children:o.jsxs("div",{className:"text-center text-gray-400",children:[o.jsx(mx,{className:"w-16 h-16 mx-auto mb-4"}),o.jsx("p",{className:"text-lg",children:"Select a project to view details"})]})})})]})]})}function _V({projectId:e,reportId:t,onToast:r,onNavigate:s}){const[n,a]=T.useState([]),[i,l]=T.useState(null),[c,u]=T.useState(null),[d,f]=T.useState("MODEL"),[h,p]=T.useState(!0),[m,x]=T.useState([]),[g,y]=T.useState(null),[w,v]=T.useState(!1),[b,_]=T.useState(!1),[k,S]=T.useState("excel"),[E,C]=T.useState(null),[U,H]=T.useState(new Map),[W,q]=T.useState(!1),[z,Q]=T.useState(!1),[L,X]=T.useState(t||null),[K,V]=T.useState(null),fe=T.useRef(null),ve=T.useRef(null);T.useEffect(()=>{P(),t?Y(t):e?B():(p(!1),V("No project ID provided"))},[t,e]),T.useEffect(()=>{const le=je=>{ve.current&&!ve.current.contains(je.target)&&v(!1)};return document.addEventListener("mousedown",le),()=>document.removeEventListener("mousedown",le)},[]);const P=async()=>{try{const{data:le}=await ie.from("projects").select("id, name, client, approved_quote_id").order("last_accessed_at",{ascending:!1}).limit(10);if(le){x(le);const je=le.find(Ae=>Ae.id===e);y(je||null)}}catch(le){console.error("Error loading projects:",le)}},M=le=>{window.location.href=`?project=${le}`},D=()=>`05_Exports_Reports/VerifyPlus/${((g==null?void 0:g.name)||"Unknown-Project").replace(/[^a-zA-Z0-9-_]/g,"_")}/`,B=async()=>{var le;try{p(!0),V(null);const{data:je,error:Ae}=await ie.from("award_reports").select("*").eq("project_id",e).order("created_at",{ascending:!1}).limit(1).maybeSingle();if(Ae)throw new Error("Failed to load report");if(!je){V("No report found for this project. Generate one from the Reports Hub."),p(!1);return}je.result_json&&(a(je.result_json.comparisonData||[]),l(je.result_json.awardSummary||null),u(je.result_json.aiAnalysis||null),(le=je.params_json)!=null&&le.equalisationMode&&f(je.params_json.equalisationMode)),X(je.id);const{data:Se}=await ie.from("quotes").select("id, supplier_name").eq("project_id",je.project_id);if(Se){const Le=new Map;Se.forEach(We=>Le.set(We.supplier_name,We.id)),H(Le)}}catch(je){console.error("Error loading report:",je),V(je.message||"Failed to load report"),r==null||r(je.message||"Failed to load report","error")}finally{p(!1)}},Y=async le=>{var je;try{p(!0),V(null);const{data:Ae,error:Se}=await ie.from("award_reports").select("*").eq("id",le).maybeSingle();if(Se)throw new Error("Failed to load report");if(!Ae)throw new Error("Report not found");Ae.result_json&&(a(Ae.result_json.comparisonData||[]),l(Ae.result_json.awardSummary||null),u(Ae.result_json.aiAnalysis||null),(je=Ae.params_json)!=null&&je.equalisationMode&&f(Ae.params_json.equalisationMode)),X(Ae.id);const{data:Le}=await ie.from("quotes").select("id, supplier_name").eq("project_id",Ae.project_id);if(Le){const We=new Map;Le.forEach(rt=>We.set(rt.supplier_name,rt.id)),H(We)}}catch(Ae){console.error("Error loading report:",Ae),V(Ae.message||"Failed to load report"),r==null||r(Ae.message||"Failed to load report","error")}finally{p(!1)}},he=async()=>{try{p(!0),V(null),console.log("[Award Report] Regenerating report for project:",e);const le="https://cbankidsdfsvsgfygbzt.supabase.co/functions/v1/compute_award_report",je={Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNiYW5raWRzZGZzdnNnZnlnYnp0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMzMTk3NDgsImV4cCI6MjA3ODg5NTc0OH0.SXgc-9ZamplKeJm5_nl8J2-UzO7A0f8KbAnPZEmsiSo","Content-Type":"application/json"};console.log("[Award Report] Calling function:",le);const Ae=await fetch(le,{method:"POST",headers:je,body:JSON.stringify({projectId:e,force:!0})});if(console.log("[Award Report] Response status:",Ae.status),!Ae.ok){const Le=await Ae.text();throw console.error("[Award Report] Error response:",Le),new Error(`Server returned ${Ae.status}: ${Le}`)}const Se=await Ae.json();if(console.log("[Award Report] Response data:",Se),!Se||!Se.reportId)throw console.error("[Award Report] Invalid response:",Se),new Error((Se==null?void 0:Se.error)||(Se==null?void 0:Se.message)||"No report ID returned from server");X(Se.reportId),await Y(Se.reportId),V(null),r==null||r("Report generated successfully","success")}catch(le){console.error("Error regenerating report:",le),V(le.message||"Failed to regenerate report"),r==null||r(le.message||"Failed to regenerate report","error")}finally{p(!1)}},xe=()=>{window.print()},se=le=>{S(le),_(!0)},ne=()=>{_(!1),k==="excel"?be():N()},be=()=>{if(!i)return;const le=ht.book_new(),je=[["Award Summary Report"],["Generated:",new Date().toLocaleDateString()],["Equalisation Mode:",i.equalisationMode],["Total Systems:",i.totalSystems.toString()],[],["Supplier","Adjusted Total","Risk Score","Coverage %","Items Quoted","Notes"],...i.suppliers.map(Re=>[Re.supplierName,Re.adjustedTotal,Re.riskScore,Re.coveragePercent,Re.itemsQuoted,Re.notes.join("; ")])],Ae=ht.aoa_to_sheet(je);ht.book_append_sheet(le,Ae,"Summary");const Se=[["Recommendations"],[],["Type","Supplier","Reason"],...i.recommendations.map(Re=>[Re.type.replace("_"," "),Re.supplier.supplierName,Re.reason])],Le=ht.aoa_to_sheet(Se);ht.book_append_sheet(le,Le,"Recommendations");const We=["System ID","System Label"],rt=i.suppliers.map(Re=>Re.supplierName);We.push(...rt);const vt=new Map;n.forEach(Re=>{const st=`${Re.systemId}|${Re.systemLabel}`;vt.has(st)||vt.set(st,new Map),vt.get(st).set(Re.supplier,Re.unitRate)});const $r=[We];vt.forEach((Re,st)=>{const[pr,bt]=st.split("|"),ps=[pr,bt];rt.forEach(pe=>{const He=Re.get(pe);ps.push(He!=null?He.toFixed(2):"")}),$r.push(ps)});const Lt=ht.aoa_to_sheet($r);ht.book_append_sheet(le,Lt,"Matrix");const zr=`${e}_AwardReport.xlsx`;ug(le,zr)},N=()=>{xe()},G=async le=>{const je=U.get(le);if(!je){r==null||r("Quote not found","error");return}C(je);try{const Le=await fetch("https://cbankidsdfsvsgfygbzt.supabase.co/functions/v1/approve_quote",{method:"POST",headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNiYW5raWRzZGZzdnNnZnlnYnp0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMzMTk3NDgsImV4cCI6MjA3ODg5NTc0OH0.SXgc-9ZamplKeJm5_nl8J2-UzO7A0f8KbAnPZEmsiSo","Content-Type":"application/json"},body:JSON.stringify({projectId:e,quoteId:je})}),We=await Le.json();if(!Le.ok)throw new Error(We.message||"Failed to approve quote");r==null||r(`Approved ${le}`,"success"),g&&y({...g,approved_quote_id:je}),await P()}catch(Ae){console.error("Error approving quote:",Ae),r==null||r(Ae.message||"Failed to approve quote","error")}finally{C(null)}},ce=()=>{if(!(g!=null&&g.approved_quote_id)){r==null||r("No approved quote selected","error");return}q(!0)},te=async le=>{q(!1),Q(!0);try{const Se=await fetch("https://cbankidsdfsvsgfygbzt.supabase.co/functions/v1/generate_base_tracker",{method:"POST",headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNiYW5raWRzZGZzdnNnZnlnYnp0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMzMTk3NDgsImV4cCI6MjA3ODg5NTc0OH0.SXgc-9ZamplKeJm5_nl8J2-UzO7A0f8KbAnPZEmsiSo","Content-Type":"application/json"},body:JSON.stringify({projectId:e,mode:le})}),Le=await Se.json();if(!Se.ok)throw new Error(Le.message||"Failed to generate base tracker");r==null||r(`Base Tracker created: ${Le.rowsInserted} lines`,"success"),s&&s("base-tracker")}catch(je){console.error("Error generating base tracker:",je),r==null||r(je.message||"Failed to generate base tracker","error")}finally{Q(!1)}};if(h)return o.jsx("div",{className:"flex items-center justify-center h-64",children:o.jsx("div",{className:"text-gray-500",children:"Loading award report..."})});if(K)return o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center max-w-2xl mx-auto mt-12",children:[o.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:o.jsx($t,{className:"w-8 h-8 text-blue-600"})}),o.jsx("p",{className:"text-gray-900 text-lg font-semibold mb-2",children:"No Award Report Available"}),o.jsx("p",{className:"text-gray-600 mb-6",children:K}),o.jsxs("button",{onClick:he,disabled:h,className:"btn-primary disabled:opacity-50",children:[o.jsx(Uy,{className:"w-5 h-5"}),h?"Generating Report...":"Generate Award Report"]})]});if(!i||i.suppliers.length===0)return o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center",children:[o.jsx("p",{className:"text-gray-500 text-lg",children:"No data available."}),o.jsx("p",{className:"text-gray-400 mt-2",children:"No report data found. Please generate a report from the Reports Hub."})]});const ue=i.recommendations.find(le=>le.type==="BEST_VALUE"),ae=i.recommendations.find(le=>le.type==="LOWEST_RISK"),ge=i.recommendations.find(le=>le.type==="BALANCED");return o.jsxs("div",{id:"award-report-root","data-award-needs-project":"true",children:[o.jsx("style",{children:`
          @media print {
            body * {
              visibility: hidden;
            }
            #printable-report, #printable-report * {
              visibility: visible;
            }
            #printable-report {
              position: absolute;
              left: 0;
              top: 0;
              width: 100%;
            }
            .no-print {
              display: none !important;
            }
            .print-break {
              page-break-after: always;
            }
          }
        `}),o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"no-print flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Award Report"}),o.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Generated ",new Date(i.generatedAt).toLocaleString()]})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsxs("div",{className:"relative",ref:ve,children:[o.jsxs("button",{onClick:()=>v(!w),className:"flex items-center gap-2 px-3 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 transition-colors",children:[o.jsx(im,{size:16}),o.jsx("span",{className:"text-sm",children:(g==null?void 0:g.name)||"Select Project"}),o.jsx(wo,{size:14,className:`transition-transform ${w?"rotate-180":""}`})]}),w&&o.jsx("div",{className:"absolute right-0 mt-2 w-64 bg-white rounded-lg shadow-lg border border-gray-200 z-50",children:o.jsx("div",{className:"p-2 max-h-80 overflow-y-auto",children:m.map(le=>o.jsxs("button",{onClick:()=>{v(!1),le.id!==e&&M(le.id)},className:`w-full text-left px-3 py-2 rounded-md text-sm hover:bg-gray-100 transition-colors ${le.id===e?"bg-blue-50 text-blue-900 font-medium":"text-gray-700"}`,children:[o.jsx("div",{className:"font-medium",children:le.name}),le.client&&o.jsx("div",{className:"text-xs text-gray-500",children:le.client})]},le.id))})})]}),o.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-blue-50 text-blue-800 rounded-md border border-blue-200",children:[o.jsx($t,{size:16}),o.jsxs("span",{className:"text-sm font-semibold",children:["Mode: ",d]})]}),o.jsx("button",{onClick:()=>f(d==="MODEL"?"PEER_MEDIAN":"MODEL"),className:"px-3 py-2 text-sm bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 transition-colors",children:"Toggle Mode"}),o.jsxs("button",{onClick:he,disabled:h,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[o.jsx($t,{size:18}),h?"Regenerating...":"Regenerate"]}),o.jsxs("button",{onClick:()=>se("pdf"),className:"flex items-center gap-2 px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors",children:[o.jsx(hx,{size:18}),"Export PDF"]}),o.jsxs("button",{onClick:()=>se("excel"),className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors",children:[o.jsx(PS,{size:18}),"Export Excel"]}),o.jsxs("button",{onClick:ce,disabled:!(g!=null&&g.approved_quote_id)||z,"data-testid":"btn-generate-base-tracker",className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[o.jsx(bF,{size:18}),z?"Creating...":"Create Base Tracker"]})]})]}),W&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 max-w-md w-full mx-4",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Create Base Tracker"}),o.jsx("p",{className:"text-sm text-gray-700 mb-6",children:"Choose how to generate the base tracker from the approved quote:"}),o.jsxs("div",{className:"space-y-3 mb-6",children:[o.jsxs("button",{onClick:()=>te("replace"),className:"w-full text-left p-4 border-2 border-gray-300 rounded-lg hover:border-blue-500 hover:bg-blue-50 transition-colors",children:[o.jsx("div",{className:"font-semibold text-gray-900 mb-1",children:"Replace"}),o.jsx("div",{className:"text-sm text-gray-600",children:"Delete all existing base tracker items and create new ones from the approved quote"})]}),o.jsxs("button",{onClick:()=>te("append"),className:"w-full text-left p-4 border-2 border-gray-300 rounded-lg hover:border-blue-500 hover:bg-blue-50 transition-colors",children:[o.jsx("div",{className:"font-semibold text-gray-900 mb-1",children:"Append"}),o.jsx("div",{className:"text-sm text-gray-600",children:"Keep existing base tracker items and add new ones from the approved quote"})]})]}),o.jsx("div",{className:"flex gap-3 justify-end",children:o.jsx("button",{onClick:()=>q(!1),className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 transition-colors",children:"Cancel"})})]})}),b&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 max-w-md w-full mx-4",children:[o.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Export ",k==="pdf"?"PDF":"Excel"," Report"]}),o.jsxs("div",{className:"mb-4",children:[o.jsxs("p",{className:"text-sm text-gray-700 mb-2",children:[o.jsx("strong",{children:"Filename:"})," ",e,"_AwardReport.",k==="pdf"?"pdf":"xlsx"]}),o.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-3",children:[o.jsx("p",{className:"text-xs font-semibold text-blue-900 mb-1",children:"Suggested Save Location:"}),o.jsx("p",{className:"text-sm text-blue-800 font-mono break-all",children:D()})]})]}),o.jsx("p",{className:"text-sm text-gray-600 mb-6",children:k==="pdf"?"The report will open in your browser's print dialog. Save as PDF from there.":"The Excel file will be downloaded to your default downloads folder."}),o.jsxs("div",{className:"flex gap-3 justify-end",children:[o.jsx("button",{onClick:()=>_(!1),className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 transition-colors",children:"Cancel"}),o.jsx("button",{onClick:ne,className:`px-4 py-2 text-white rounded-md transition-colors ${k==="pdf"?"bg-gray-600 hover:bg-gray-700":"bg-green-600 hover:bg-green-700"}`,children:"Continue"})]})]})}),o.jsx("div",{id:"printable-report",ref:fe,children:o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-8",children:[o.jsxs("div",{className:"text-center mb-8 print:mb-6",children:[o.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Award Recommendation Report"}),o.jsx("p",{className:"text-gray-600",children:"Project Analysis & Supplier Evaluation"}),o.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:[new Date().toLocaleDateString()," | ",i.totalSystems," Systems | ",i.equalisationMode," Mode"]})]}),o.jsxs("div",{className:"grid grid-cols-3 gap-6 mb-8 print:mb-6",children:[o.jsxs("div",{className:"p-6 bg-gradient-to-br from-blue-50 to-blue-100 rounded-lg border-2 border-blue-300",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[o.jsx(Uy,{className:"text-blue-600",size:28}),o.jsx("h3",{className:"text-sm font-semibold text-blue-900 uppercase",children:"Best Value"})]}),ue&&o.jsxs(o.Fragment,{children:[o.jsx("p",{className:"text-2xl font-bold text-blue-900",children:ue.supplier.supplierName}),o.jsxs("p",{className:"text-lg text-blue-800 mt-1",children:["$",ue.supplier.adjustedTotal.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),o.jsx("p",{className:"text-sm text-blue-700 mt-2",children:ue.reason})]})]}),o.jsxs("div",{className:"p-6 bg-gradient-to-br from-green-50 to-green-100 rounded-lg border-2 border-green-300",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[o.jsx(f0,{className:"text-green-600",size:28}),o.jsx("h3",{className:"text-sm font-semibold text-green-900 uppercase",children:"Lowest Risk"})]}),ae&&o.jsxs(o.Fragment,{children:[o.jsx("p",{className:"text-2xl font-bold text-green-900",children:ae.supplier.supplierName}),o.jsxs("p",{className:"text-lg text-green-800 mt-1",children:["Risk Score: ",ae.supplier.riskScore.toFixed(1)]}),o.jsx("p",{className:"text-sm text-green-700 mt-2",children:ae.reason})]})]}),o.jsxs("div",{className:"p-6 bg-gradient-to-br from-purple-50 to-purple-100 rounded-lg border-2 border-purple-300",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[o.jsx(Po,{className:"text-purple-600",size:28}),o.jsx("h3",{className:"text-sm font-semibold text-purple-900 uppercase",children:"Balanced"})]}),ge&&o.jsxs(o.Fragment,{children:[o.jsx("p",{className:"text-2xl font-bold text-purple-900",children:ge.supplier.supplierName}),o.jsxs("p",{className:"text-lg text-purple-800 mt-1",children:["$",ge.supplier.adjustedTotal.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),o.jsx("p",{className:"text-sm text-purple-700 mt-2",children:ge.reason})]})]})]}),c&&o.jsxs("div",{className:"mb-8 print:mb-6 bg-gradient-to-br from-amber-50 to-yellow-50 rounded-lg border-2 border-amber-200 p-6",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[o.jsx("div",{className:"p-2 bg-amber-100 rounded-lg",children:o.jsx("svg",{className:"w-6 h-6 text-amber-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})})}),o.jsx("h2",{className:"text-xl font-bold text-amber-900",children:"AI Analysis & Insights"})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[o.jsxs("div",{className:"bg-white rounded-lg p-4 border border-amber-200",children:[o.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Items Compared"}),o.jsx("div",{className:"text-2xl font-bold text-gray-900",children:c.totalItemsCompared||0})]}),o.jsxs("div",{className:"bg-white rounded-lg p-4 border border-amber-200",children:[o.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Matched Items"}),o.jsx("div",{className:"text-2xl font-bold text-green-600",children:c.matchedItems||0})]}),o.jsxs("div",{className:"bg-white rounded-lg p-4 border border-amber-200",children:[o.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Unmatched Items"}),o.jsx("div",{className:"text-2xl font-bold text-blue-600",children:c.unmatchedItems||0})]})]}),c.priceVariances&&o.jsxs("div",{className:"bg-white rounded-lg p-4 border border-amber-200 mb-3",children:[o.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Price Variances"}),o.jsx("p",{className:"text-sm text-gray-700",children:c.priceVariances})]}),c.scopeGaps&&o.jsxs("div",{className:"bg-white rounded-lg p-4 border border-amber-200 mb-3",children:[o.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Scope Gaps"}),o.jsx("p",{className:"text-sm text-gray-700",children:c.scopeGaps})]}),c.recommendations&&o.jsxs("div",{className:"bg-white rounded-lg p-4 border border-amber-200",children:[o.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"AI Recommendations"}),o.jsx("p",{className:"text-sm text-gray-700",children:c.recommendations})]})]}),o.jsxs("div",{className:"mb-8 print:mb-6",children:[o.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Executive Summary"}),o.jsxs("div",{className:"prose prose-sm max-w-none text-gray-700",children:[o.jsxs("p",{className:"mb-3",children:["Analysis of ",i.suppliers.length," supplier quotes covering ",i.totalSystems," passive fire protection systems. Equalisation performed using ",o.jsx("strong",{children:i.equalisationMode})," methodology to ensure fair comparison."]}),o.jsx("p",{children:"The evaluation considers both financial value and risk factors including price variance from model rates, scope coverage completeness, and data quality. Three recommendations are provided based on different prioritization strategies."})]})]}),o.jsxs("div",{className:"mb-8 print:mb-6",children:[o.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Supplier Comparison"}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full border-collapse text-sm",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"bg-gray-50",children:[o.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700 border border-gray-300",children:"Supplier"}),o.jsx("th",{className:"px-4 py-3 text-right font-semibold text-gray-700 border border-gray-300",children:"Adjusted Total"}),o.jsx("th",{className:"px-4 py-3 text-right font-semibold text-gray-700 border border-gray-300",children:"Risk Score"}),o.jsx("th",{className:"px-4 py-3 text-right font-semibold text-gray-700 border border-gray-300",children:"Coverage"}),o.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700 border border-gray-300",children:"Notes"}),o.jsx("th",{className:"px-4 py-3 text-center font-semibold text-gray-700 border border-gray-300 no-print",children:"Actions"})]})}),o.jsx("tbody",{children:i.suppliers.map((le,je)=>{const Ae=U.get(le.supplierName),Se=(g==null?void 0:g.approved_quote_id)===Ae,Le=E===Ae;return o.jsxs("tr",{className:"hover:bg-gray-50",children:[o.jsxs("td",{className:"px-4 py-3 font-semibold text-gray-900 border border-gray-300",children:[le.supplierName,Se&&o.jsx("span",{className:"ml-2 inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-green-100 text-green-800",children:"Approved"})]}),o.jsxs("td",{className:"px-4 py-3 text-right text-gray-900 border border-gray-300",children:["$",le.adjustedTotal.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),o.jsx("td",{className:`px-4 py-3 text-right font-semibold border border-gray-300 ${le.riskScore<=2?"text-green-700":le.riskScore<=5?"text-amber-700":"text-red-700"}`,children:le.riskScore.toFixed(1)}),o.jsxs("td",{className:"px-4 py-3 text-right text-gray-900 border border-gray-300",children:[le.coveragePercent.toFixed(0),"%",o.jsxs("span",{className:"text-xs text-gray-600 ml-1",children:["(",le.itemsQuoted,"/",le.totalItems,")"]})]}),o.jsx("td",{className:"px-4 py-3 text-gray-700 border border-gray-300",children:o.jsx("ul",{className:"text-xs space-y-0.5",children:le.notes.slice(0,3).map((We,rt)=>o.jsxs("li",{children:[" ",We]},rt))})}),o.jsx("td",{className:"px-4 py-3 border border-gray-300 no-print",children:o.jsx("div",{className:"flex items-center justify-center gap-2",children:!Se&&o.jsxs("button",{onClick:()=>G(le.supplierName),disabled:Le,"data-testid":"btn-approve-quote",className:"flex items-center gap-1.5 px-3 py-1.5 bg-blue-600 text-white text-xs font-medium rounded hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[o.jsx(kr,{size:14}),Le?"Processing...":"Approve"]})})})]},je)})})]})})]}),n.length>0&&o.jsxs("div",{className:"mb-8 print:mb-6",children:[o.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Itemized Comparison"}),o.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Line-by-line comparison of all items across ",i.suppliers.length," suppliers"]}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full border-collapse text-xs",children:[o.jsxs("thead",{children:[o.jsxs("tr",{className:"bg-gray-50",children:[o.jsx("th",{className:"px-3 py-2 text-left font-semibold text-gray-700 border border-gray-300 sticky left-0 bg-gray-50 z-10",children:"Item Description"}),o.jsx("th",{className:"px-3 py-2 text-center font-semibold text-gray-700 border border-gray-300",children:"Qty"}),o.jsx("th",{className:"px-3 py-2 text-center font-semibold text-gray-700 border border-gray-300",children:"Unit"}),i.suppliers.map((le,je)=>o.jsx("th",{colSpan:2,className:"px-3 py-2 text-center font-semibold text-gray-700 border border-gray-300 bg-blue-50",children:le.supplierName},je))]}),o.jsxs("tr",{className:"bg-gray-50",children:[o.jsx("th",{className:"px-3 py-2 border border-gray-300 sticky left-0 bg-gray-50 z-10"}),o.jsx("th",{className:"px-3 py-2 border border-gray-300"}),o.jsx("th",{className:"px-3 py-2 border border-gray-300"}),i.suppliers.map((le,je)=>o.jsxs(o.Fragment,{children:[o.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-600 border border-gray-300 bg-blue-50",children:"Unit Rate"},`${je}-rate`),o.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-600 border border-gray-300 bg-blue-50",children:"Total"},`${je}-total`)]}))]})]}),o.jsx("tbody",{children:n.map((le,je)=>{const Ae=le.matchStatus==="unmatched";return o.jsxs("tr",{className:`hover:bg-gray-50 ${Ae?"bg-amber-50":""}`,children:[o.jsxs("td",{className:"px-3 py-2 text-gray-900 border border-gray-300 sticky left-0 bg-white z-10",children:[o.jsx("div",{className:"font-medium",children:le.description}),le.notes&&o.jsx("div",{className:"text-xs text-amber-600 mt-1",children:le.notes})]}),o.jsx("td",{className:"px-3 py-2 text-center text-gray-700 border border-gray-300",children:le.quantity}),o.jsx("td",{className:"px-3 py-2 text-center text-gray-700 border border-gray-300",children:le.unit}),i.suppliers.map((Se,Le)=>{const We=le.suppliers[Se.supplierName],rt=We&&We.unitPrice!==null;return o.jsxs(o.Fragment,{children:[o.jsx("td",{className:`px-3 py-2 text-right border border-gray-300 ${rt?"":"bg-gray-100 text-gray-400"}`,children:rt?`$${We.unitPrice.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}`:"N/A"},`${Le}-rate`),o.jsx("td",{className:`px-3 py-2 text-right font-medium border border-gray-300 ${rt?"":"bg-gray-100 text-gray-400"}`,children:rt?`$${We.total.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}`:"N/A"},`${Le}-total`)]})})]},je)})}),o.jsx("tfoot",{className:"bg-gray-50",children:o.jsxs("tr",{className:"font-bold",children:[o.jsx("td",{colSpan:3,className:"px-3 py-3 text-right text-gray-900 border border-gray-300",children:"Subtotals:"}),i.suppliers.map((le,je)=>o.jsxs(o.Fragment,{children:[o.jsx("td",{className:"border border-gray-300"},`${je}-spacer`),o.jsxs("td",{className:"px-3 py-3 text-right text-gray-900 border border-gray-300",children:["$",le.adjustedTotal.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]},`${je}-total`)]}))]})})]})})]}),o.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[o.jsx("h2",{className:"text-lg font-bold text-gray-900 mb-3",children:"Risk Scoring Methodology"}),o.jsxs("div",{className:"text-xs text-gray-600 space-y-1",children:[o.jsxs("p",{children:[" ",o.jsx("strong",{children:"+1 point"})," per RED variance cell (>20% from model rate)"]}),o.jsxs("p",{children:[" ",o.jsx("strong",{children:"+0.5 points"})," per AMBER variance cell (10-20% from model rate)"]}),o.jsxs("p",{children:[" ",o.jsx("strong",{children:"+1 point"})," per missing scope item requiring equalisation"]}),o.jsxs("p",{children:[" ",o.jsx("strong",{children:"+1 point"})," if >10% of items have low mapping confidence (<0.7)"]})]})]})]})})]})]})}function SV(e){const[t,r]=T.useState("hub"),[s,n]=T.useState(null),a=(l,c)=>{r(l)},i=()=>{r("hub"),n(null)};return t==="award-report"?o.jsx(_V,{projectId:e.projectId,reportId:s||void 0,onNavigate:i}):o.jsx(bV,{...e,onNavigate:l=>a(l)})}function kV({projectId:e}){return o.jsxs("div",{className:"p-8",children:[o.jsx(Rn,{title:"Insights Dashboard",description:"AI-powered insights and analytics"}),o.jsx("div",{className:"mt-6 p-6 bg-white rounded-lg border border-gray-200",children:o.jsx("p",{className:"text-gray-600",children:"Insights Dashboard - Analytics and intelligence coming soon"})})]})}function NV({onNavigateToTemplates:e}){return o.jsxs("div",{className:"p-8 max-w-7xl mx-auto",children:[o.jsxs("div",{className:"mb-8",children:[o.jsx("h1",{className:"text-3xl font-semibold brand-navy mb-2",children:"library.pageTitle"}),o.jsx("p",{className:"text-gray-600 text-base",children:"library.pageSubtitle"})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsx("button",{onClick:e,className:"bg-white rounded-xl shadow-sm border border-gray-200 p-8 hover:shadow-md hover:border-gray-300 transition-all text-left group",children:o.jsxs("div",{className:"flex items-start gap-4",children:[o.jsx("div",{className:"w-14 h-14 bg-blue-50 rounded-xl flex items-center justify-center flex-shrink-0 group-hover:bg-blue-100 transition-colors",children:o.jsx($t,{className:"w-7 h-7 text-blue-600"})}),o.jsxs("div",{className:"flex-1",children:[o.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2 group-hover:text-blue-600 transition-colors",children:"library.cards.projectTemplates.title"}),o.jsx("p",{className:"text-gray-600 text-sm leading-relaxed",children:"library.cards.projectTemplates.body"})]})]})}),o.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-8 opacity-50 cursor-not-allowed",children:o.jsxs("div",{className:"flex items-start gap-4",children:[o.jsx("div",{className:"w-14 h-14 bg-gray-100 rounded-xl flex items-center justify-center flex-shrink-0",children:o.jsx(TF,{className:"w-7 h-7 text-gray-400"})}),o.jsxs("div",{className:"flex-1",children:[o.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"library.cards.forms.title"}),o.jsx("p",{className:"text-gray-600 text-sm leading-relaxed",children:"library.cards.forms.body"})]})]})})]})]})}function jV(){return null}function EV({onBack:e,onNavigateToNewProject:t}){const[r,s]=T.useState([]),[n,a]=T.useState(!0),[i,l]=T.useState(!1),[c,u]=T.useState(null),[d,f]=T.useState(!1),[h,p]=T.useState(null),[m,x]=T.useState(null);T.useEffect(()=>{g()},[]),T.useEffect(()=>{if(m){const _=setTimeout(()=>x(null),5e3);return()=>clearTimeout(_)}},[m]);const g=async()=>{a(!0);try{const{data:_,error:k}=await ie.from("project_templates").select("*").order("updated_at",{ascending:!1});if(k)throw k;s(_||[])}catch(_){console.error("Error loading templates:",_),x({type:"error",message:"projectTemplates.toasts.loadError"})}finally{a(!1)}},y=_=>{p(_),f(!0)},w=async()=>{if(h)try{const{error:_}=await ie.from("project_templates").delete().eq("id",h.id);if(_)throw _;x({type:"success",message:Gu("projectTemplates.toasts.deleteSuccess",{templateName:h.name})}),await g()}catch(_){console.error("Error deleting template:",_),x({type:"error",message:"projectTemplates.toasts.loadError"})}finally{f(!1),p(null)}},v=async _=>{var k,S;try{const{data:E}=await ie.auth.getSession(),C=(S=(k=E==null?void 0:E.session)==null?void 0:k.user)==null?void 0:S.id;if(!C){x({type:"error",message:"You must be logged in to duplicate templates"});return}const U=`${_.name} (Copy)`,{error:H}=await ie.from("project_templates").insert({name:U,description:_.description,trade:_.trade,is_default:!1,created_by_user_id:C,project_settings:_.project_settings,analysis_settings:_.analysis_settings,report_settings:_.report_settings,compliance_settings:_.compliance_settings});if(H)throw H;x({type:"success",message:Gu("projectTemplates.toasts.duplicateSuccess",{newTemplateName:U})}),await g()}catch(E){console.error("Error duplicating template:",E),x({type:"error",message:"projectTemplates.toasts.loadError"})}},b=_=>new Date(_).toLocaleDateString("en-NZ",{day:"numeric",month:"short",year:"numeric"});return n?o.jsx("div",{className:"p-8",children:o.jsx("div",{className:"flex items-center justify-center py-12",children:o.jsx("div",{className:"text-gray-600",children:"Loading templates..."})})}):o.jsxs("div",{className:"p-8 max-w-7xl mx-auto",children:[m&&o.jsx("div",{className:`mb-4 p-4 rounded-lg ${m.type==="success"?"bg-green-50 text-green-800 border border-green-200":"bg-red-50 text-red-800 border border-red-200"}`,children:m.message}),o.jsxs("div",{className:"mb-6",children:[o.jsxs("button",{onClick:e,className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 mb-4 transition-colors",children:[o.jsx(fx,{size:20}),o.jsx("span",{className:"text-sm font-medium",children:"projectTemplates.backToLibrary"})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-10 h-10 bg-blue-50 rounded-lg flex items-center justify-center",children:o.jsx($t,{className:"w-5 h-5 text-blue-600"})}),o.jsxs("div",{children:[o.jsx("h1",{className:"text-3xl font-semibold brand-navy",children:"projectTemplates.pageTitle"}),o.jsx("p",{className:"text-gray-600 text-base",children:"projectTemplates.pageSubtitle"})]})]}),o.jsxs("button",{onClick:()=>{u(null),l(!0)},className:"flex items-center gap-2 px-4 py-2 bg-brand-primary text-white rounded-lg hover:bg-blue-600 transition-colors font-medium text-sm",children:[o.jsx(Ga,{size:18}),"projectTemplates.newTemplateButton"]})]})]}),r.length===0?o.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-12 text-center",children:o.jsxs("div",{className:"max-w-md mx-auto",children:[o.jsx("div",{className:"w-16 h-16 bg-gray-50 rounded-xl flex items-center justify-center mx-auto mb-4",children:o.jsx($t,{size:32,className:"text-gray-400"})}),o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"projectTemplates.emptyState.title"}),o.jsx("p",{className:"text-gray-600 text-sm mb-6 leading-relaxed",children:"projectTemplates.emptyState.body"}),o.jsxs("button",{onClick:()=>{u(null),l(!0)},className:"inline-flex items-center gap-2 px-4 py-2 bg-brand-primary text-white rounded-lg hover:bg-blue-600 transition-colors font-medium text-sm",children:[o.jsx(Ga,{size:18}),"projectTemplates.emptyState.button"]})]})}):o.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full",children:[o.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"projectTemplates.table.columns.template"}),o.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"projectTemplates.table.columns.trade"}),o.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"projectTemplates.table.columns.description"}),o.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"projectTemplates.table.columns.lastUpdated"}),o.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"projectTemplates.table.columns.actions"})]})}),o.jsx("tbody",{className:"divide-y divide-gray-200",children:r.map(_=>o.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[o.jsx("td",{className:"px-6 py-4",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"font-medium text-gray-900",children:_.name}),_.is_default&&o.jsx("span",{className:"px-2 py-0.5 bg-blue-100 text-blue-700 text-xs font-medium rounded-full",children:"Default"})]})}),o.jsx("td",{className:"px-6 py-4",children:o.jsx("span",{className:"text-sm text-gray-700",children:_.trade})}),o.jsx("td",{className:"px-6 py-4",children:o.jsx("span",{className:"text-sm text-gray-600 line-clamp-2",children:_.description||""})}),o.jsx("td",{className:"px-6 py-4",children:o.jsx("span",{className:"text-sm text-gray-600",children:b(_.updated_at)})}),o.jsx("td",{className:"px-6 py-4",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("button",{onClick:()=>t==null?void 0:t(),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"projectTemplates.table.rowActions.applyToNewProject",children:o.jsx(Ga,{size:16})}),o.jsx("button",{onClick:()=>{u(_),l(!0)},className:"p-2 text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",title:"projectTemplates.table.rowActions.edit",children:o.jsx(BF,{size:16})}),o.jsx("button",{onClick:()=>v(_),className:"p-2 text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",title:"projectTemplates.table.rowActions.duplicate",children:o.jsx(_F,{size:16})}),o.jsx("button",{onClick:()=>y(_),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"projectTemplates.table.rowActions.delete",children:o.jsx(bo,{size:16})})]})})]},_.id))})]})})}),i&&o.jsx(jV,{template:c,onClose:()=>{l(!1),u(null)},onSave:_=>{x({type:"success",message:c?"projectTemplates.toasts.updateSuccess":"projectTemplates.toasts.createSuccess"}),g()}}),d&&h&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:o.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full",children:[o.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:o.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"projectTemplates.deleteDialog.title"})}),o.jsx("div",{className:"px-6 py-4",children:o.jsx("p",{className:"text-gray-700",children:Gu("projectTemplates.deleteDialog.body",{templateName:h.name})})}),o.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex items-center justify-end gap-3",children:[o.jsx("button",{onClick:()=>{f(!1),p(null)},className:"px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg transition-colors font-medium text-sm",children:"projectTemplates.deleteDialog.cancel"}),o.jsx("button",{onClick:w,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors font-medium text-sm",children:"projectTemplates.deleteDialog.confirm"})]})]})})]})}function Qj(){const[e,t]=T.useState(!1),[r,s]=T.useState(null),[n,a]=T.useState(null),[i,l]=T.useState(null),[c,u]=T.useState(!1);T.useEffect(()=>{d()},[]);const d=async()=>{u(!0);try{const y=await fetch("https://cbankidsdfsvsgfygbzt.supabase.co/functions/v1/test_openai_connection",{method:"POST",headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNiYW5raWRzZGZzdnNnZnlnYnp0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMzMTk3NDgsImV4cCI6MjA3ODg5NTc0OH0.SXgc-9ZamplKeJm5_nl8J2-UzO7A0f8KbAnPZEmsiSo","Content-Type":"application/json"}});if(y.ok){const w=await y.json();l(w)}else l({ok:!1,error:"Failed to check OpenAI connection"})}catch{l({ok:!1,error:"Network error while checking OpenAI connection"})}finally{u(!1)}},f=async x=>{t(!0),a(null);try{const w=await fetch("https://cbankidsdfsvsgfygbzt.supabase.co/functions/v1/verify_installation",{method:"POST",headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNiYW5raWRzZGZzdnNnZnlnYnp0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMzMTk3NDgsImV4cCI6MjA3ODg5NTc0OH0.SXgc-9ZamplKeJm5_nl8J2-UzO7A0f8KbAnPZEmsiSo","Content-Type":"application/json"},body:JSON.stringify({autoFix:x})});if(!w.ok)throw new Error("Failed to run system check");const v=await w.json();s(v)}catch(g){a(g.message||"An error occurred while running the system check")}finally{t(!1)}},h=x=>{switch(x){case"pass":return o.jsx("span",{className:"text-2xl",children:""});case"fixed":return o.jsx("span",{className:"text-2xl",children:""});case"fail":return o.jsx("span",{className:"text-2xl",children:""})}},p=x=>{switch(x){case"pass":return"Pass";case"fixed":return"Fixed";case"fail":return"Fail"}},m=x=>new Date(x).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"});return o.jsxs("div",{className:"space-y-6 px-8 py-6",children:[o.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:o.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-6",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-3xl font-semibold brand-navy mb-2",children:"Verify+ System Audit"}),o.jsx("p",{className:"text-gray-600 text-base",children:"Comprehensive system health check and automatic issue resolution"})]}),o.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[o.jsx("button",{onClick:()=>f(!1),disabled:e,className:"flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:bg-gray-300 disabled:text-gray-500 disabled:cursor-not-allowed font-medium text-sm",children:e?o.jsxs(o.Fragment,{children:[o.jsx(cs,{size:18,className:"animate-spin"}),"Running..."]}):o.jsxs(o.Fragment,{children:[o.jsx(yf,{size:18}),"Run Check"]})}),o.jsx("button",{onClick:()=>f(!0),disabled:e,className:"flex items-center justify-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed font-medium text-sm",children:e?o.jsxs(o.Fragment,{children:[o.jsx(cs,{size:18,className:"animate-spin"}),"Running..."]}):o.jsxs(o.Fragment,{children:[o.jsx(wf,{size:18}),"Run & Auto-Fix"]})})]})]})}),o.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[o.jsxs("div",{className:"flex items-start justify-between mb-6",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-10 h-10 bg-blue-50 rounded-lg flex items-center justify-center flex-shrink-0",children:o.jsx(PF,{className:"text-blue-600",size:20})}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"OpenAI API Configuration"}),o.jsx("p",{className:"text-sm text-gray-600 mt-0.5",children:"Required for Verify+ Copilot functionality"})]})]}),o.jsxs("button",{onClick:d,disabled:c,className:"flex items-center gap-2 px-3 py-1.5 text-sm bg-white text-blue-700 rounded-full hover:bg-blue-50 transition-colors disabled:opacity-50 font-medium border border-blue-200",children:[o.jsx(cs,{size:14,className:c?"animate-spin":""}),"Recheck"]})]}),c&&o.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[o.jsx(cs,{size:16,className:"animate-spin"}),o.jsx("span",{className:"text-sm",children:"Checking OpenAI connection..."})]}),!c&&i&&o.jsx("div",{className:`rounded-lg p-4 ${i.ok?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"}`,children:o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 ${i.ok?"bg-green-100":"bg-red-100"}`,children:i.ok?o.jsx(Sd,{className:"text-green-600",size:18}):o.jsx(it,{className:"text-red-600",size:18})}),o.jsxs("div",{className:"flex-1",children:[o.jsx("h4",{className:`font-semibold text-sm mb-1 ${i.ok?"text-green-900":"text-red-900"}`,children:i.ok?"Connected":"Not Configured"}),o.jsx("p",{className:`text-xs mb-2 ${i.ok?"text-green-700":"text-red-700"}`,children:i.message||i.error||"Unknown status"}),i.ok&&o.jsxs("div",{className:"text-xs text-green-700 space-y-1 mt-2",children:[o.jsxs("div",{children:["Models available: ",o.jsx("span",{className:"font-semibold",children:i.modelCount})]}),o.jsxs("div",{children:["GPT-4 access: ",o.jsx("span",{className:"font-semibold",children:i.gpt4Available?"Yes":"No"})]})]}),!i.ok&&o.jsxs("div",{className:"mt-3 p-4 bg-white rounded-lg border border-red-200",children:[o.jsx("p",{className:"text-sm text-red-900 font-semibold mb-3",children:"Setup Instructions:"}),o.jsxs("ol",{className:"text-sm text-red-800 space-y-2 list-decimal list-inside",children:[o.jsx("li",{children:"Go to Supabase Dashboard"}),o.jsx("li",{children:"Navigate to Project Settings  Edge Functions  Secrets"}),o.jsxs("li",{children:["Add a new secret named ",o.jsx("code",{className:"bg-red-100 px-2 py-0.5 rounded font-mono text-xs",children:"OPENAI_API_KEY"})]}),o.jsx("li",{children:"Paste your OpenAI API key as the value"}),o.jsx("li",{children:'Click "Recheck" above to verify'})]})]})]})]})})]}),n&&o.jsx("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4",children:o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-full flex items-center justify-center flex-shrink-0",children:o.jsx(it,{className:"text-red-600",size:18})}),o.jsxs("div",{children:[o.jsx("h3",{className:"font-semibold text-red-900 mb-1 text-sm",children:"Error"}),o.jsx("p",{className:"text-red-700 text-xs",children:n})]})]})}),r&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-5",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("div",{className:"text-xs font-semibold text-gray-600 mb-2 uppercase",children:"Passed"}),o.jsx("div",{className:"text-2xl font-bold text-green-600",children:r.passed})]}),o.jsx("div",{className:"w-12 h-12 bg-green-50 rounded-lg flex items-center justify-center",children:o.jsx(Sd,{size:24,className:"text-green-600"})})]})}),o.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-5",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("div",{className:"text-xs font-semibold text-gray-600 mb-2 uppercase",children:"Failed"}),o.jsx("div",{className:"text-2xl font-bold text-red-600",children:r.failed})]}),o.jsx("div",{className:"w-12 h-12 bg-red-50 rounded-lg flex items-center justify-center",children:o.jsx(it,{size:24,className:"text-red-600"})})]})}),o.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-5",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("div",{className:"text-xs font-semibold text-gray-600 mb-2 uppercase",children:"Fixed"}),o.jsx("div",{className:"text-2xl font-bold text-amber-600",children:r.fixed})]}),o.jsx("div",{className:"w-12 h-12 bg-amber-50 rounded-lg flex items-center justify-center",children:o.jsx(wf,{size:24,className:"text-amber-600"})})]})})]}),r.failed>0&&o.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-xl p-4",children:o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx("div",{className:"w-8 h-8 bg-amber-100 rounded-full flex items-center justify-center flex-shrink-0",children:o.jsx(it,{className:"text-amber-600",size:18})}),o.jsxs("div",{children:[o.jsxs("h3",{className:"font-semibold text-amber-900 mb-1 text-sm",children:[r.failed," check",r.failed!==1?"s":""," failed"]}),o.jsx("p",{className:"text-amber-700 text-xs",children:"Run & Auto-Fix recommended to resolve these issues automatically"})]})]})}),o.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full",children:[o.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Area"}),o.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Name"}),o.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Status"}),o.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Detail"}),o.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Fix Hint"})]})}),o.jsx("tbody",{className:"divide-y divide-gray-200",children:r.checks.map((x,g)=>o.jsxs("tr",{className:`hover:bg-gray-50 transition-colors ${x.status==="fail"?"bg-red-50":""}`,children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:x.area}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:x.name}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxs("div",{className:"flex items-center gap-2",children:[h(x.status),o.jsx("span",{className:`text-sm font-medium ${x.status==="pass"?"text-green-700":x.status==="fixed"?"text-amber-700":"text-red-700"}`,children:p(x.status)})]})}),o.jsx("td",{className:"px-6 py-4 text-sm text-gray-700",children:x.detail}),o.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:x.fixHint||"-"})]},g))})]})})}),o.jsx("div",{className:"bg-gray-50 rounded-xl border border-gray-200 px-6 py-4",children:o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 text-sm",children:[o.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[o.jsx(Ac,{size:16}),o.jsxs("span",{children:["Last check: ",m(r.timestamp)]})]}),o.jsx("div",{className:"text-gray-500 font-medium",children:"PassiveFire Verify+ v1.0.0"})]})})]}),!r&&!e&&!n&&o.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-12 text-center",children:o.jsxs("div",{className:"max-w-md mx-auto",children:[o.jsx("div",{className:"w-16 h-16 bg-blue-50 rounded-xl flex items-center justify-center mx-auto mb-4",children:o.jsx(yf,{size:32,className:"text-blue-600"})}),o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Ready to Check System Health"}),o.jsx("p",{className:"text-gray-600 text-sm mb-6 leading-relaxed",children:"Run a comprehensive system audit to verify your installation and identify any issues. Use Auto-Fix to automatically resolve common problems."}),o.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 justify-center",children:[o.jsxs("button",{onClick:()=>f(!1),className:"flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium text-sm",children:[o.jsx(yf,{size:18}),"Run Check"]}),o.jsxs("button",{onClick:()=>f(!0),className:"flex items-center justify-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors font-medium text-sm",children:[o.jsx(wf,{size:18}),"Run & Auto-Fix"]})]})]})})]})}function Zj(){const[e,t]=T.useState([]),[r,s]=T.useState(!0),[n,a]=T.useState(new Set),[i,l]=T.useState("all"),c=async()=>{s(!0);try{let m=ie.from("copilot_audit").select("*").order("ts",{ascending:!1}).limit(100);i==="success"?m=m.eq("result_ok",!0):i==="failed"&&(m=m.eq("result_ok",!1));const{data:x,error:g}=await m;if(g){console.error("Error loading audit logs:",g);return}t(x||[])}finally{s(!1)}};T.useEffect(()=>{c()},[i]);const u=m=>{a(x=>{const g=new Set(x);return g.has(m)?g.delete(m):g.add(m),g})},d=m=>new Date(m).toLocaleString(),f=m=>m.includes("verify")?"bg-blue-50 text-blue-700 border-blue-200":m.includes("compute")?"bg-purple-50 text-purple-700 border-purple-200":m.includes("approve")?"bg-green-50 text-green-700 border-green-200":m.includes("generate")?"bg-amber-50 text-amber-700 border-amber-200":"bg-gray-100 text-gray-700 border-gray-200",h=m=>m==="owner"?"bg-red-50 text-red-700 border-red-200":m==="estimator"?"bg-orange-50 text-blue-700 border-orange-200":"bg-gray-100 text-gray-700 border-gray-200",p=e;return o.jsxs("div",{className:"space-y-6 p-6",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-3xl font-bold brand-navy mb-2",children:"Copilot Audit Logs"}),o.jsx("p",{className:"text-gray-600",children:"Last 100 Copilot actions for this project"})]}),o.jsxs("button",{onClick:c,disabled:r,className:"flex items-center justify-center gap-2 px-4 py-2 bg-blue-50 text-blue-700 rounded-lg hover:bg-blue-100 transition-colors disabled:opacity-50 font-medium border border-blue-100",children:[o.jsx(cs,{size:18,className:r?"animate-spin":""}),o.jsx("span",{children:"Refresh"})]})]}),o.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4",children:o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[o.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[o.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Filter:"}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("button",{onClick:()=>l("all"),className:`px-4 py-2 rounded-full text-sm font-medium transition-colors ${i==="all"?"bg-brand-primary text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"All"}),o.jsx("button",{onClick:()=>l("success"),className:`px-4 py-2 rounded-full text-sm font-medium transition-colors ${i==="success"?"bg-green-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Success"}),o.jsx("button",{onClick:()=>l("failed"),className:`px-4 py-2 rounded-full text-sm font-medium transition-colors ${i==="failed"?"bg-red-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Failed"})]})]}),o.jsxs("div",{className:"text-sm text-gray-600 font-medium",children:["Showing ",p.length," log",p.length!==1?"s":""]})]})}),r?o.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-12 text-center",children:[o.jsx(cs,{className:"animate-spin mx-auto mb-4 text-blue-600",size:48}),o.jsx("p",{className:"text-gray-600",children:"Loading audit logs..."})]}):p.length===0?o.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-12 text-center",children:o.jsx("p",{className:"text-gray-600",children:"No audit logs found"})}):o.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"bg-gray-50 border-b border-gray-200",children:[o.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Ac,{size:14}),o.jsx("span",{children:"Time"})]})}),o.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(mx,{size:14}),o.jsx("span",{children:"User"})]})}),o.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Role"}),o.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Tool"}),o.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Status"}),o.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Details"})]})}),o.jsx("tbody",{className:"divide-y divide-gray-200",children:p.map(m=>o.jsxs(vo.tr,{initial:{opacity:0},animate:{opacity:1},className:"hover:bg-gray-50 transition-colors",children:[o.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:d(m.ts)}),o.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:m.user_email}),o.jsx("td",{className:"px-6 py-4",children:o.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-medium border ${h(m.role)}`,children:m.role})}),o.jsx("td",{className:"px-6 py-4",children:o.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-medium border ${f(m.tool_name)}`,children:m.tool_name})}),o.jsx("td",{className:"px-6 py-4",children:m.result_ok?o.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 bg-green-50 text-green-700 rounded-full text-xs font-medium border border-green-200",children:[o.jsx(kr,{size:14}),o.jsx("span",{children:"Success"})]}):o.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 bg-red-50 text-red-700 rounded-full text-xs font-medium border border-red-200",children:[o.jsx(h0,{size:14}),o.jsx("span",{children:"Failed"})]})}),o.jsx("td",{className:"px-6 py-4",children:o.jsxs("button",{onClick:()=>u(m.id),className:"flex items-center gap-1 text-sm brand-primary hover:underline transition-colors font-medium",children:[n.has(m.id)?o.jsx(wo,{size:16}):o.jsx(Cc,{size:16}),o.jsx("span",{children:"View"})]})})]},m.id))})]})}),Array.from(n).map(m=>{const x=p.find(g=>g.id===m);return x?o.jsxs(vo.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"border-t border-gray-200 bg-gray-50 p-6",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{children:[o.jsx("h4",{className:"text-xs font-semibold text-gray-700 uppercase mb-3",children:"Arguments"}),o.jsx("pre",{className:"text-xs text-gray-900 bg-white p-4 rounded-lg border border-gray-200 overflow-x-auto",children:JSON.stringify(x.args_json,null,2)})]}),o.jsxs("div",{children:[o.jsx("h4",{className:"text-xs font-semibold text-gray-700 uppercase mb-3",children:"Result"}),o.jsx("pre",{className:"text-xs text-gray-900 bg-white p-4 rounded-lg border border-gray-200 overflow-x-auto",children:JSON.stringify(x.result_json,null,2)})]})]}),x.error_message&&o.jsxs("div",{className:"mt-6",children:[o.jsx("h4",{className:"text-xs font-semibold text-red-700 uppercase mb-3",children:"Error Message"}),o.jsx("p",{className:"text-sm text-red-700 bg-red-50 p-4 rounded-lg border border-red-200",children:x.error_message})]})]},`details-${m}`):null})]})]})}async function TV(e,t){console.log("Snapshot creation not implemented")}async function CV(e){return[]}async function AV(e){console.log("Snapshot restore not implemented")}async function FV(e,t){return TV()}async function PV(e){return AV()}async function RV(e){return CV()}async function IV(e){console.log("Delete snapshot not implemented")}async function OV(e){console.log("Legacy data migration not implemented")}async function Pw(e){return!1}function DV(){return null}const LV="https://verify-pdf-extractor.onrender.com";async function MV(){try{const e=await fetch(`${LV}/health`,{method:"GET"});if(!e.ok){const r=await e.text();throw new Error(`Health check failed: ${e.status} ${r}`)}return await e.json()}catch(e){throw console.error("PDF Extractor health check error:",e),new Error(e instanceof Error?`Health check failed: ${e.message}`:"Health check failed: Unknown error")}}function BV({projectId:e,onProjectDeleted:t,onNavigateToMatrix:r}){const[s,n]=T.useState("project"),[a,i]=T.useState(!1),[l,c]=T.useState(!1),[u,d]=T.useState(null),[f,h]=T.useState("api"),[p,m]=T.useState(""),[x,g]=T.useState([]),[y,w]=T.useState(!0),[v,b]=T.useState(!1),[_,k]=T.useState(!1),[S,E]=T.useState(!1),[C,U]=T.useState(!1),[H,W]=T.useState(!1),[q,z]=T.useState(!1),[Q,L]=T.useState(""),[X,K]=T.useState(""),[V,fe]=T.useState(!1),[ve,P]=T.useState([]),[M,D]=T.useState(!1),[B,Y]=T.useState(!1),[he,xe]=T.useState(!1),[se,ne]=T.useState(""),[be,N]=T.useState(""),[G,ce]=T.useState(""),[te,ue]=T.useState(null),[ae,ge]=T.useState(!1),le=Jj();T.useEffect(()=>{je(),Re(),Ae(),U(Pw())},[e]);const je=async()=>{w(!0);try{const pe=await le.loadSettings();pe&&(h(pe.model_rate_source),m(pe.api_base_url),pe.csv_data&&g(pe.csv_data))}catch(pe){console.error("Error loading settings:",pe)}w(!1)},Ae=async()=>{try{const{data:pe}=await ie.from("user_preferences").select("show_splash_on_load").eq("id","00000000-0000-0000-0000-000000000001").maybeSingle();pe&&(W(pe.show_splash_on_load),localStorage.setItem("showSplashOnLoad",String(pe.show_splash_on_load)))}catch(pe){console.error("Error loading user preferences:",pe)}},Se=async()=>{ge(!0),ue(null);try{const pe=await MV();ue(` Healthy - ${pe.status||"OK"}${pe.message?`: ${pe.message}`:""}`),d({type:"success",text:"PDF Extractor API is healthy and responding"})}catch(pe){const He=pe instanceof Error?pe.message:"Unknown error";ue(` Failed - ${He}`),d({type:"error",text:`PDF Extractor health check failed: ${He}`})}finally{ge(!1)}},Le=async pe=>{try{const{error:He}=await ie.from("user_preferences").update({show_splash_on_load:pe}).eq("id","00000000-0000-0000-0000-000000000001");if(He)throw He;W(pe),localStorage.setItem("showSplashOnLoad",String(pe)),d({type:"success",text:`Splash screen will ${pe?"show":"not show"} on every load`})}catch(He){console.error("Error updating splash preference:",He),d({type:"error",text:"Failed to update splash screen preference"})}},We=async()=>{i(!0),d(null);try{const{data:pe}=await ie.from("projects").select("*").eq("id",e).single(),{data:He}=await ie.from("quotes").select("*").eq("project_id",e),_t=(He==null?void 0:He.map(vi=>vi.id))||[],{data:Fr}=await ie.from("quote_items").select("*").in("quote_id",_t),{data:Wt}=await ie.from("scope_categories").select("*").eq("project_id",e),xs={version:"1.0",exported_at:new Date().toISOString(),project:pe,quotes:He||[],quote_items:Fr||[],scope_categories:Wt||[]},mn=new Blob([JSON.stringify(xs,null,2)],{type:"application/json"}),Zr=URL.createObjectURL(mn),Je=document.createElement("a");Je.href=Zr,Je.download=`passivefire-project-${e}-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(Je),Je.click(),document.body.removeChild(Je),URL.revokeObjectURL(Zr),d({type:"success",text:"Project data exported successfully!"})}catch(pe){console.error("Export error:",pe),d({type:"error",text:"Failed to export project data."})}finally{i(!1)}},rt=async pe=>{var _t;const He=(_t=pe.target.files)==null?void 0:_t[0];if(He){c(!0),d(null);try{const Fr=await He.text(),Wt=JSON.parse(Fr);if(!Wt.quotes||!Wt.quote_items)throw new Error("Invalid file format");for(const xs of Wt.quotes){const{id:mn,project_id:Zr,created_at:Je,updated_at:vi,...N0}=xs,{data:j0,error:$c}=await ie.from("quotes").insert({...N0,project_id:e}).select().single();if($c)throw $c;const E0=Wt.quote_items.filter(Uo=>Uo.quote_id===mn);for(const Uo of E0){const{id:mg,quote_id:pg,created_at:zc,updated_at:xg,...T0}=Uo,{error:Vc}=await ie.from("quote_items").insert({...T0,quote_id:j0.id});if(Vc)throw Vc}}if(Wt.scope_categories&&Wt.scope_categories.length>0)for(const xs of Wt.scope_categories){const{id:mn,project_id:Zr,created_at:Je,...vi}=xs;await ie.from("scope_categories").insert({...vi,project_id:e})}d({type:"success",text:`Imported ${Wt.quotes.length} quotes successfully!`}),pe.target.value=""}catch(Fr){console.error("Import error:",Fr),d({type:"error",text:"Failed to import project data. Please check the file format."})}finally{c(!1)}}},vt=async()=>{var pe,He;if(confirm("This will check for legacy data in localStorage and migrate it to a new project. Continue?")){E(!0),d(null);try{if(!Pw()){d({type:"error",text:"No legacy data found to migrate."}),U(!1);return}const _t=await OV();_t.success&&_t.projectId?(d({type:"success",text:`Legacy data migrated successfully! ${((pe=_t.itemsMigrated)==null?void 0:pe.lines)||0} items from ${((He=_t.itemsMigrated)==null?void 0:He.suppliers)||0} suppliers. Reload the page to see the new project.`}),U(!1)):d({type:"error",text:_t.error||"Failed to migrate legacy data."})}catch(_t){console.error("Migration error:",_t),d({type:"error",text:"An error occurred during migration."})}finally{E(!1)}}},$r=async()=>{if(confirm("Are you sure you want to delete this project? This will remove all quotes and data. This action cannot be undone."))try{const{error:pe}=await ie.from("projects").delete().eq("id",e);if(pe)throw pe;t()}catch(pe){console.error("Delete error:",pe),d({type:"error",text:"Failed to delete project."})}},Lt=async()=>{b(!0),d(null);try{await le.saveSettings({model_rate_source:f,api_base_url:p,csv_data:x.length>0?x:void 0})?(await ie.from("projects").update({updated_at:new Date().toISOString()}).eq("id",e),d({type:"success",text:"Settings saved successfully!"})):d({type:"error",text:"Failed to save settings."})}catch(pe){console.error("Save settings error:",pe),d({type:"error",text:"Failed to save settings."})}finally{b(!1)}},zr=async pe=>{var _t;const He=(_t=pe.target.files)==null?void 0:_t[0];if(He){k(!0),d(null);try{const Fr=await He.arrayBuffer(),Wt=Rm(Fr,{type:"array"}),xs=Wt.Sheets[Wt.SheetNames[0]],Zr=ht.sheet_to_json(xs).map(Je=>({systemId:String(Je.systemId||Je.SystemId||Je.system_id||"").trim(),sizeBucket:String(Je.sizeBucket||Je.SizeBucket||Je.size_bucket||"").trim(),frr:String(Je.frr||Je.FRR||"").trim(),service:String(Je.service||Je.Service||"").trim(),subclass:String(Je.subclass||Je.Subclass||Je.sub_class||"").trim(),componentCount:parseInt(Je.componentCount||Je.ComponentCount||Je.component_count||"0"),modelRate:parseFloat(Je.modelRate||Je.ModelRate||Je.model_rate||"0")})).filter(Je=>Je.systemId&&Je.modelRate>0);if(Zr.length===0)throw new Error("No valid data found in CSV file");g(Zr),d({type:"success",text:`Loaded ${Zr.length} model rates from CSV.`}),pe.target.value=""}catch(Fr){console.error("CSV upload error:",Fr),d({type:"error",text:"Failed to parse CSV file. Please check the format."})}finally{k(!1)}}},Re=async()=>{D(!0);const pe=await RV();P(pe),D(!1)},st=async()=>{if(!se||!be){d({type:"error",text:"Please provide snapshot key and name."});return}Y(!0),d(null);try{await FV(se,e,{name:be,client:G||"Unknown",created:new Date().toISOString().split("T")[0]})?(d({type:"success",text:`Snapshot "${se}" saved successfully!`}),ne(""),N(""),ce(""),await Re()):d({type:"error",text:"Failed to save snapshot."})}catch(pe){console.error("Save snapshot error:",pe),d({type:"error",text:"Failed to save snapshot."})}finally{Y(!1)}},pr=async pe=>{if(confirm(`Restore snapshot "${pe}"? This will replace all current project data.`)){xe(!0),d(null);try{await PV(pe,e)?(d({type:"success",text:`Snapshot "${pe}" restored successfully! Refresh the page to see changes.`}),await je()):d({type:"error",text:"Failed to restore snapshot."})}catch(He){console.error("Restore snapshot error:",He),d({type:"error",text:"Failed to restore snapshot."})}finally{xe(!1)}}},bt=async pe=>{if(confirm(`Delete snapshot "${pe}"? This action cannot be undone.`)){d(null);try{await IV(pe)?(d({type:"success",text:`Snapshot "${pe}" deleted successfully!`}),await Re()):d({type:"error",text:"Failed to delete snapshot."})}catch(He){console.error("Delete snapshot error:",He),d({type:"error",text:"Failed to delete snapshot."})}}},ps=async()=>{var pe,He;if(!Q.trim()){alert("Please enter a template name");return}fe(!0);try{const{data:_t}=await ie.auth.getSession(),Fr=(He=(pe=_t==null?void 0:_t.session)==null?void 0:pe.user)==null?void 0:He.id;if(!Fr){alert("You must be logged in to save templates");return}const{data:Wt}=await ie.from("projects").select("name").eq("id",e).maybeSingle(),xs=await le.loadSettings(),{data:mn}=await ie.from("project_settings").select("*").eq("project_id",e).maybeSingle(),{error:Zr}=await ie.from("project_templates").insert({name:Q.trim(),description:X.trim(),trade:"Passive Fire",is_default:!1,created_by_user_id:Fr,project_settings:{...xs,...mn},analysis_settings:{},report_settings:{},compliance_settings:{}});if(Zr)throw Zr;d({type:"success",text:Gu("saveProjectAsTemplate.toasts.success",{templateName:Q,projectName:(Wt==null?void 0:Wt.name)||"Project"})}),z(!1),L(""),K("")}catch(_t){console.error("Error saving template:",_t),alert("Failed to save template")}finally{fe(!1)}};return o.jsxs("div",{className:"space-y-6",children:[o.jsx("div",{className:"bg-white rounded-lg shadow-sm border-b border-gray-200",children:o.jsxs("div",{className:"flex gap-1 p-2",children:[o.jsxs("button",{onClick:()=>n("project"),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-colors ${s==="project"?"bg-orange-50 text-brand-primary border border-brand-primary":"text-gray-600 hover:bg-gray-50"}`,children:[o.jsx(jd,{size:18}),"Project Settings"]}),o.jsxs("button",{onClick:()=>n("systemcheck"),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-colors ${s==="systemcheck"?"bg-orange-50 text-brand-primary border border-brand-primary":"text-gray-600 hover:bg-gray-50"}`,children:[o.jsx(MF,{size:18}),"System Check"]}),o.jsxs("button",{onClick:()=>n("copilotaudit"),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-colors ${s==="copilotaudit"?"bg-orange-50 text-brand-primary border border-brand-primary":"text-gray-600 hover:bg-gray-50"}`,children:[o.jsx(f0,{size:18}),"Copilot Audit"]})]})}),u&&o.jsx("div",{className:`p-4 rounded-md ${u.type==="success"?"bg-green-50 text-green-800":"bg-red-50 text-red-800"}`,children:u.text}),s==="systemcheck"?o.jsx(Qj,{}):s==="copilotaudit"?o.jsx(Zj,{}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-6",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(jd,{size:20,className:"text-gray-700"}),o.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Project Settings"})]}),o.jsxs("button",{onClick:()=>{const{data:pe}=ie.from("projects").select("name").eq("id",e).maybeSingle().then(({data:He})=>{L(`${(He==null?void 0:He.name)||"Project"} Template`)});z(!0)},className:"flex items-center gap-2 px-4 py-2 text-blue-600 bg-blue-50 hover:bg-blue-100 rounded-lg transition-colors font-medium text-sm border border-blue-200",children:[o.jsx(vF,{size:16}),"saveProjectAsTemplate.buttonLabel"]})]}),o.jsx("h3",{className:"text-base font-semibold text-gray-900 mb-4",children:"Model Rate Provider"}),y?o.jsx("div",{className:"text-center py-8 text-gray-500",children:"Loading settings..."}):o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Model Rate Source"}),o.jsxs("div",{className:"flex gap-4",children:[o.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[o.jsx("input",{type:"radio",name:"modelRateSource",value:"api",checked:f==="api",onChange:pe=>h(pe.target.value),className:"w-4 h-4 text-blue-600"}),o.jsx(CF,{size:18,className:"text-gray-600"}),o.jsx("span",{className:"text-sm text-gray-700",children:"API"})]}),o.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[o.jsx("input",{type:"radio",name:"modelRateSource",value:"csv",checked:f==="csv",onChange:pe=>h(pe.target.value),className:"w-4 h-4 text-blue-600"}),o.jsx($t,{size:18,className:"text-gray-600"}),o.jsx("span",{className:"text-sm text-gray-700",children:"CSV"})]})]})]}),f==="api"&&o.jsxs("div",{children:[o.jsx("label",{htmlFor:"apiBaseUrl",className:"block text-sm font-medium text-gray-700 mb-2",children:"API Base URL"}),o.jsx("input",{id:"apiBaseUrl",type:"url",value:p,onChange:pe=>m(pe.target.value),placeholder:"https://gkdvcyocchnfwelrxvmz.supabase.co/functions/v1/rate-api",className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-gray-900"}),o.jsxs("div",{className:"mt-2 space-y-1",children:[o.jsx("p",{className:"text-xs text-gray-500",children:"Leave empty to use the default Verify+ Rate API"}),o.jsx("p",{className:"text-xs text-blue-600 font-mono",children:"Default: https://gkdvcyocchnfwelrxvmz.supabase.co/functions/v1/rate-api"}),o.jsxs("p",{className:"text-xs text-gray-500",children:["The API will be called as: POST ","{baseUrl}","/rate with system_label, size, frr, service, and subclass"]})]})]}),o.jsx(DV,{projectId:e}),o.jsxs("div",{className:"bg-gray-50 p-4 rounded-md border border-gray-200",children:[o.jsxs("p",{className:"text-sm text-gray-700 mb-2",children:[o.jsx("strong",{children:"Project ID:"})," ",o.jsx("code",{className:"text-xs bg-white px-2 py-1 rounded border border-gray-300",children:e})]}),o.jsx("p",{className:"text-xs text-gray-500",children:"Used for storage keys and data isolation"})]}),f==="csv"&&o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Upload ModelSolutions.csv"}),o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsxs("label",{className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors cursor-pointer",children:[o.jsx(rc,{size:18}),_?"Uploading...":"Upload CSV",o.jsx("input",{type:"file",accept:".csv,.xlsx,.xls",multiple:!1,onChange:zr,disabled:_,className:"hidden"})]}),x.length>0&&o.jsxs("span",{className:"text-sm text-gray-600",children:[x.length," model rates loaded"]})]}),o.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"Required columns: systemId, sizeBucket, frr, service, subclass, componentCount, modelRate"}),x.length>0&&o.jsxs("div",{className:"mt-4 border border-gray-200 rounded-md overflow-hidden",children:[o.jsx("div",{className:"max-h-64 overflow-y-auto",children:o.jsxs("table",{className:"w-full text-xs",children:[o.jsx("thead",{className:"bg-gray-50 border-b border-gray-200 sticky top-0",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700",children:"System ID"}),o.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700",children:"Size Bucket"}),o.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700",children:"FRR"}),o.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700",children:"Service"}),o.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700",children:"Subclass"}),o.jsx("th",{className:"px-3 py-2 text-right font-medium text-gray-700",children:"Components"}),o.jsx("th",{className:"px-3 py-2 text-right font-medium text-gray-700",children:"Model Rate"})]})}),o.jsx("tbody",{className:"divide-y divide-gray-200",children:x.slice(0,10).map((pe,He)=>o.jsxs("tr",{className:"hover:bg-gray-50",children:[o.jsx("td",{className:"px-3 py-2 text-gray-900",children:pe.systemId}),o.jsx("td",{className:"px-3 py-2 text-gray-600",children:pe.sizeBucket}),o.jsx("td",{className:"px-3 py-2 text-gray-600",children:pe.frr}),o.jsx("td",{className:"px-3 py-2 text-gray-600",children:pe.service}),o.jsx("td",{className:"px-3 py-2 text-gray-600",children:pe.subclass}),o.jsx("td",{className:"px-3 py-2 text-right text-gray-900",children:pe.componentCount}),o.jsxs("td",{className:"px-3 py-2 text-right text-gray-900",children:["$",pe.modelRate.toFixed(2)]})]},He))})]})}),x.length>10&&o.jsxs("div",{className:"px-3 py-2 bg-gray-50 border-t border-gray-200 text-xs text-gray-500",children:["Showing 10 of ",x.length," rows"]})]})]}),o.jsx("div",{className:"flex items-center gap-3 pt-4 border-t border-gray-200",children:o.jsx("button",{onClick:Lt,disabled:v||f==="csv"&&x.length===0,className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed",children:v?"Saving...":"Save Settings"})})]})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[o.jsx(Fc,{className:"text-cyan-600",size:24}),o.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"User Experience"})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg border border-gray-200",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"Show Splash Screen on Every Load"}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Display the animated BurnRatePro splash screen each time the app loads"})]}),o.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[o.jsx("input",{type:"checkbox",checked:H,onChange:pe=>Le(pe.target.checked),className:"sr-only peer"}),o.jsx("div",{className:"w-11 h-6 bg-gray-300 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-cyan-300 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-cyan-600"})]})]}),o.jsx("div",{className:"text-xs text-gray-500 bg-blue-50 border border-blue-200 rounded-lg p-3",children:o.jsxs("p",{children:[o.jsx("strong",{children:"Tip:"})," Press ",o.jsx("kbd",{className:"px-2 py-1 bg-white border border-blue-300 rounded text-xs",children:"Shift"})," + ",o.jsx("kbd",{className:"px-2 py-1 bg-white border border-blue-300 rounded text-xs",children:"S"})," to replay the splash screen at any time"]})})]})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[o.jsxs("h2",{className:"text-xl font-semibold text-gray-900 mb-6 flex items-center gap-2",children:[o.jsx(By,{size:20,className:"text-gray-700"}),"PDF Extractor API"]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg border border-gray-200",children:[o.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-2",children:"External PDF Extraction Service"}),o.jsx("p",{className:"text-xs text-gray-600 mb-3",children:"This service automatically extracts structured data from supplier quote PDFs."}),o.jsxs("div",{className:"text-xs text-gray-500 space-y-1 mb-4",children:[o.jsxs("div",{children:[o.jsx("strong",{children:"Endpoint:"})," https://verify-pdf-extractor.onrender.com"]}),o.jsxs("div",{children:[o.jsx("strong",{children:"Status:"})," ",te||"Not checked"]})]}),o.jsx("button",{onClick:Se,disabled:ae,className:"flex items-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed text-sm font-medium",children:ae?o.jsxs(o.Fragment,{children:[o.jsx(cs,{size:16,className:"animate-spin"}),"Checking..."]}):o.jsxs(o.Fragment,{children:[o.jsx(By,{size:16}),"Check Health"]})})]}),o.jsx("div",{className:"text-xs text-gray-500 bg-purple-50 border border-purple-200 rounded-lg p-3",children:o.jsxs("p",{children:[o.jsx("strong",{children:"Note:"})," The PDF extractor is called automatically when you upload a PDF in the Import Quotes screen. This health check verifies the service is online and responding."]})})]})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[o.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Project Data"}),o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"border-b border-gray-200 pb-6",children:[o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-3",children:"Export Data"}),o.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Export all project data including quotes, items, and categories to a JSON file."}),o.jsxs("button",{onClick:We,disabled:a,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed",children:[o.jsx(si,{size:18}),a?"Exporting...":"Export Project Data"]})]}),o.jsxs("div",{className:"border-b border-gray-200 pb-6",children:[o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-3",children:"Import Data"}),o.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Import quotes and items from a previously exported JSON file. This will add to existing data."}),o.jsxs("label",{className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors cursor-pointer inline-flex",children:[o.jsx(rc,{size:18}),l?"Importing...":"Import Project Data",o.jsx("input",{type:"file",accept:".json",multiple:!1,onChange:rt,disabled:l,className:"hidden"})]})]}),C&&o.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[o.jsxs("h3",{className:"text-lg font-medium text-yellow-900 mb-3 flex items-center gap-2",children:[o.jsx(qa,{size:20,className:"text-yellow-600"}),"Legacy Data Migration"]}),o.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Legacy data detected in localStorage. Click below to migrate it to a new project in the database."}),o.jsxs("button",{onClick:vt,disabled:S,className:"flex items-center gap-2 px-4 py-2 bg-yellow-600 text-white rounded-md hover:bg-yellow-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed",children:[o.jsx(cs,{size:18,className:S?"animate-spin":""}),S?"Migrating...":"Re-run Migration"]})]}),o.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[o.jsx("h3",{className:"text-lg font-medium text-red-900 mb-3",children:"Danger Zone"}),o.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Permanently delete this project and all associated data. This action cannot be undone."}),o.jsxs("button",{onClick:$r,className:"flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors",children:[o.jsx(bo,{size:18}),"Delete Project"]})]})]})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[o.jsx(SF,{size:20,className:"text-gray-700"}),o.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Project Snapshots"})]}),o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"border-b border-gray-200 pb-6",children:[o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-3",children:"Save Current Project"}),o.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Create a snapshot of the current project state including all quotes, mappings, comparisons, and settings."}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"snapshotKey",className:"block text-sm font-medium text-gray-700 mb-2",children:"Snapshot Key *"}),o.jsx("input",{id:"snapshotKey",type:"text",value:se,onChange:pe=>ne(pe.target.value),placeholder:"HowickLibrary_2025",className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-gray-900"})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"snapshotName",className:"block text-sm font-medium text-gray-700 mb-2",children:"Project Name *"}),o.jsx("input",{id:"snapshotName",type:"text",value:be,onChange:pe=>N(pe.target.value),placeholder:"Howick Library",className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-gray-900"})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"snapshotClient",className:"block text-sm font-medium text-gray-700 mb-2",children:"Client"}),o.jsx("input",{id:"snapshotClient",type:"text",value:G,onChange:pe=>ce(pe.target.value),placeholder:"Cassidy",className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-gray-900"})]})]}),o.jsxs("button",{onClick:st,disabled:B||!se||!be,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed",children:[o.jsx(lm,{size:18}),B?"Saving Snapshot...":"Save Snapshot"]})]}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Saved Snapshots"}),o.jsxs("button",{onClick:Re,disabled:M,className:"flex items-center gap-2 px-3 py-1 text-sm bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 transition-colors",children:[o.jsx(cs,{size:16}),"Refresh"]})]}),M?o.jsx("div",{className:"text-center py-8 text-gray-500",children:"Loading snapshots..."}):ve.length===0?o.jsx("div",{className:"text-center py-8 text-gray-500 bg-gray-50 rounded-md border border-gray-200",children:"No snapshots saved yet."}):o.jsx("div",{className:"space-y-3",children:ve.map(pe=>o.jsx("div",{className:"p-4 bg-gray-50 rounded-md border border-gray-200 hover:border-blue-300 transition-colors",children:o.jsxs("div",{className:"flex items-start justify-between",children:[o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[o.jsx("h4",{className:"font-semibold text-gray-900",children:pe.projectMeta.name}),o.jsx("code",{className:"px-2 py-0.5 text-xs bg-white rounded border border-gray-300 text-gray-700",children:pe.projectKey})]}),o.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[o.jsxs("p",{children:[o.jsx("strong",{children:"Client:"})," ",pe.projectMeta.client," |",o.jsx("strong",{className:"ml-2",children:"Created:"})," ",pe.projectMeta.created]}),o.jsxs("p",{children:[o.jsx("strong",{children:"Suppliers:"})," ",pe.suppliers.length," |",o.jsx("strong",{className:"ml-2",children:"Items:"})," ",pe.normalisedLines.length," |",o.jsx("strong",{className:"ml-2",children:"Saved:"})," ",new Date(pe.snapshotDate||"").toLocaleDateString()]})]})]}),o.jsxs("div",{className:"flex gap-2 ml-4",children:[o.jsxs("button",{onClick:()=>pr(pe.projectKey),disabled:he,className:"flex items-center gap-1 px-3 py-1 text-sm bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors disabled:bg-gray-400",children:[o.jsx(cs,{size:14}),"Restore"]}),o.jsxs("button",{onClick:()=>bt(pe.projectKey),className:"flex items-center gap-1 px-3 py-1 text-sm bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors",children:[o.jsx(bo,{size:14}),"Delete"]})]})]})},pe.id))})]})]})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Account"}),o.jsx("div",{className:"space-y-4",children:o.jsxs("button",{onClick:async()=>{await ie.auth.signOut()},className:"flex items-center gap-2 px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors",children:[o.jsx(AS,{size:18}),"Logout"]})})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"About PassiveFire Verify+"}),o.jsxs("div",{className:"text-sm text-gray-600 space-y-2",children:[o.jsx("p",{children:"Version 1.0"}),o.jsx("p",{children:"PassiveFire Verify+ helps you manage and analyze quotes for passive fire protection projects. Import quotes, review items, compare suppliers, and generate award reports."})]})]})]}),q&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:o.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full",children:[o.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:o.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"saveProjectAsTemplate.modal.title"})}),o.jsxs("div",{className:"px-6 py-4 space-y-4",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["saveProjectAsTemplate.modal.fields.name.label"," ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",value:Q,onChange:pe=>L(pe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"saveProjectAsTemplate.modal.fields.name.placeholder"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"saveProjectAsTemplate.modal.fields.description.label"}),o.jsx("textarea",{value:X,onChange:pe=>K(pe.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"saveProjectAsTemplate.modal.fields.description.placeholder"})]}),o.jsx("div",{className:"text-sm text-gray-600 bg-blue-50 border border-blue-200 rounded-lg p-3",children:"saveProjectAsTemplate.modal.description"})]}),o.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex items-center justify-end gap-3",children:[o.jsx("button",{onClick:()=>{z(!1),L(""),K("")},className:"px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg transition-colors font-medium text-sm",children:"saveProjectAsTemplate.modal.buttons.cancel"}),o.jsx("button",{onClick:ps,disabled:V||!Q.trim(),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium text-sm disabled:bg-gray-300 disabled:cursor-not-allowed",children:V?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Saving..."]}):o.jsxs(o.Fragment,{children:[o.jsx(lm,{size:16}),"saveProjectAsTemplate.modal.buttons.confirm"]})})]})]})})]})}function UV({message:e,type:t,onClose:r,duration:s=5e3}){T.useEffect(()=>{if(s>0){const c=setTimeout(()=>{r()},s);return()=>clearTimeout(c)}},[s,r]);const n={success:kr,error:h0,info:kd,warning:it},a={success:"bg-green-50 text-green-800 border-green-200",error:"bg-red-50 text-red-800 border-red-200",info:"bg-blue-50 text-blue-800 border-blue-200",warning:"bg-yellow-50 text-yellow-800 border-yellow-200"},i={success:"text-green-600",error:"text-red-600",info:"text-blue-600",warning:"text-yellow-600"},l=n[t];return o.jsxs("div",{className:`fixed top-4 right-4 z-50 flex items-start gap-3 min-w-80 max-w-md p-4 rounded-lg border shadow-lg ${a[t]} animate-slide-in`,children:[o.jsx(l,{size:20,className:`flex-shrink-0 mt-0.5 ${i[t]}`}),o.jsx("div",{className:"flex-1 text-sm font-medium",children:e}),o.jsx("button",{onClick:r,className:"flex-shrink-0 hover:opacity-70 transition-opacity",children:o.jsx(Qr,{size:18})})]})}class $V{constructor(){A0(this,"listeners",new Set);A0(this,"messages",[])}subscribe(t){return this.listeners.add(t),()=>this.listeners.delete(t)}notify(){this.listeners.forEach(t=>t([...this.messages]))}show(t){const r={...t,id:Math.random().toString(36).substring(2,11),createdAt:Date.now(),duration:t.duration||5e3};this.messages.push(r),this.notify(),r.duration&&r.duration>0&&setTimeout(()=>{this.dismiss(r.id)},r.duration)}dismiss(t){this.messages=this.messages.filter(r=>r.id!==t),this.notify()}remove(t){this.dismiss(t)}clear(){this.messages=[],this.notify()}showAccessDenied(t){this.show({type:"warning",title:"Access denied",body:t||"You don't have permission to manage organisation members. If you need access, please contact your organisation admin.",duration:6e3})}}const Om=new $V;function zV(){const[e,t]=T.useState([]);T.useEffect(()=>Om.subscribe(i=>{t(i.map(l=>({id:l.id,type:l.type,title:l.title,body:l.body||"",duration:l.duration||5e3})))}),[]);const r=a=>{Om.remove(a)},s=a=>{switch(a){case"success":return o.jsx(kr,{className:"text-green-500",size:20});case"error":return o.jsx(it,{className:"text-red-500",size:20});case"warning":return o.jsx(it,{className:"text-amber-500",size:20});case"info":return o.jsx(kd,{className:"text-blue-500",size:20});default:return o.jsx(kd,{className:"text-gray-500",size:20})}},n=a=>{switch(a){case"success":return"bg-green-50 border-green-200";case"error":return"bg-red-50 border-red-200";case"warning":return"bg-amber-50 border-amber-200";case"info":return"bg-blue-50 border-blue-200";default:return"bg-gray-50 border-gray-200"}};return o.jsx("div",{className:"fixed top-4 right-4 z-50 flex flex-col gap-2 pointer-events-none",children:o.jsx(tx,{children:e.map(a=>o.jsx(vo.div,{initial:{opacity:0,x:100,scale:.8},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:100,scale:.8},className:`min-w-80 max-w-md rounded-lg border shadow-lg p-4 pointer-events-auto ${n(a.type)}`,children:o.jsxs("div",{className:"flex items-start gap-3",children:[s(a.type),o.jsxs("div",{className:"flex-1 min-w-0",children:[a.title&&o.jsx("div",{className:"font-semibold text-gray-900 mb-1",children:a.title}),o.jsx("div",{className:"text-sm text-gray-700",children:a.body})]}),o.jsx("button",{onClick:()=>r(a.id),className:"text-gray-400 hover:text-gray-600 transition-colors",children:o.jsx(Qr,{size:18})})]})},a.id))})})}function VV(){return o.jsx("footer",{className:"py-4 px-6 flex justify-center lg:justify-end",children:o.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-full border border-gray-200 bg-white/90 text-xs text-gray-500",children:[o.jsx("span",{className:"font-medium",children:"PassiveFire Verify+"}),o.jsx("span",{className:"text-gray-300",children:""}),o.jsx("span",{children:"v1.9"}),o.jsx("span",{className:"text-gray-300",children:""}),o.jsx("span",{children:" 2025 PassiveFire Verify+. All rights reserved."})]})})}function WV({isOpen:e,onClose:t,currentProjectId:r,allProjects:s,onNavigate:n}){const[a,i]=T.useState(""),[l,c]=T.useState([{role:"assistant",content:"Hi! I'm your AI Copilot. I can help you navigate the app, answer questions about your quotes, and provide insights. What can I help you with?"}]),u=()=>{if(!a.trim())return;c(h=>[...h,{role:"user",content:a}]);const d=a.toLowerCase();let f="I'm still learning! This is a placeholder response. In production, I would be powered by AI to provide intelligent assistance.";d.includes("quote")||d.includes("import")?(f="To import quotes, navigate to the Quotes tab and upload your PDF or Excel files. I can help you with parsing issues if you encounter any.",setTimeout(()=>n("quotes",r),2e3)):d.includes("report")||d.includes("award")?(f="The Award Report is generated in the Reports section. It uses AI to analyze all quotes and recommend the best supplier based on price, coverage, and risk.",setTimeout(()=>n("reports",r),2e3)):(d.includes("scope")||d.includes("matrix"))&&(f="The Scope Matrix shows a side-by-side comparison of all suppliers' pricing. It highlights variances and helps identify gaps in coverage.",setTimeout(()=>n("scope",r),2e3)),setTimeout(()=>{c(h=>[...h,{role:"assistant",content:f}])},500),i("")};return o.jsx(tx,{children:e&&o.jsxs(o.Fragment,{children:[o.jsx(vo.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-30 z-40",onClick:t}),o.jsxs(vo.div,{initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:{type:"spring",damping:25,stiffness:200},className:"fixed right-0 top-0 h-full w-96 bg-white shadow-2xl z-50 flex flex-col",children:[o.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-purple-600 to-blue-600 rounded-full flex items-center justify-center",children:o.jsx(Fc,{size:18,className:"text-white"})}),o.jsx("h2",{className:"text-lg font-semibold",children:"AI Copilot"})]}),o.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:o.jsx(Qr,{size:20})})]}),o.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:l.map((d,f)=>o.jsx("div",{className:`flex ${d.role==="user"?"justify-end":"justify-start"}`,children:o.jsx("div",{className:`max-w-[80%] rounded-lg p-3 ${d.role==="user"?"bg-blue-600 text-white":"bg-gray-100 text-gray-900"}`,children:d.content})},f))}),o.jsx("div",{className:"p-4 border-t border-gray-200",children:o.jsxs("div",{className:"flex gap-2",children:[o.jsx("input",{type:"text",value:a,onChange:d=>i(d.target.value),onKeyPress:d=>d.key==="Enter"&&u(),placeholder:"Ask me anything...",className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),o.jsx("button",{onClick:u,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:o.jsx(LF,{size:18})})]})})]})]})})}function HV(){const[e,t]=T.useState(""),[r,s]=T.useState(""),[n,a]=T.useState(!1),[i,l]=T.useState(""),[c,u]=T.useState(!1),d=async f=>{f.preventDefault(),l(""),a(!0);try{if(c){const{error:h}=await ie.auth.signUp({email:e,password:r});if(h)throw h;l("Check your email for the confirmation link")}else{const{error:h}=await ie.auth.signInWithPassword({email:e,password:r});if(h)throw h}}catch(h){l(h.message||"An error occurred")}finally{a(!1)}};return o.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",children:o.jsxs("div",{className:"max-w-md w-full bg-white rounded-2xl shadow-xl p-8",children:[o.jsxs("div",{className:"text-center mb-8",children:[o.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-blue-600 rounded-full mb-4",children:o.jsx(f0,{className:"text-white",size:32})}),o.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"PassiveFire Verify+"}),o.jsx("p",{className:"text-gray-600",children:c?"Create your account":"Sign in to your account"})]}),o.jsxs("form",{onSubmit:d,className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),o.jsxs("div",{className:"relative",children:[o.jsx(DF,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:20}),o.jsx("input",{type:"email",value:e,onChange:f=>t(f.target.value),required:!0,className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"you@example.com"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),o.jsxs("div",{className:"relative",children:[o.jsx(OF,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:20}),o.jsx("input",{type:"password",value:r,onChange:f=>s(f.target.value),required:!0,className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:""})]})]}),i&&o.jsx("div",{className:`text-sm ${i.includes("email")?"text-green-600":"text-red-600"} bg-red-50 p-3 rounded-lg`,children:i}),o.jsx("button",{type:"submit",disabled:n,className:"w-full bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed font-medium",children:n?"Please wait...":c?"Sign Up":"Sign In"})]}),o.jsx("div",{className:"mt-6 text-center",children:o.jsx("button",{onClick:()=>u(!c),className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:c?"Already have an account? Sign in":"Don't have an account? Sign up"})})]})})}function Rw({onOrganisationSelected:e}){const{organisations:t,setCurrentOrganisation:r,loading:s,refreshOrganisations:n}=ya(),[a,i]=T.useState(!1),[l,c]=T.useState(""),[u,d]=T.useState(""),f=p=>{r(p),e()},h=async()=>{if(!l.trim()){d("Please enter an organisation name");return}d(""),i(!0);try{const{data:{user:p}}=await ie.auth.getUser();if(!p){d("Not authenticated"),i(!1);return}const{data:m,error:x}=await ie.from("organisations").insert({name:l.trim()}).select().single();if(x)throw x;await ie.from("organisation_members").insert({organisation_id:m.id,user_id:p.id,role:"admin"}),await n(),c(""),d(""),r(m),e()}catch(p){d(p.message||"Failed to create organisation")}finally{i(!1)}};return s?o.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:o.jsxs("div",{className:"text-center",children:[o.jsx(qs,{className:"mx-auto mb-4 text-blue-600 animate-spin",size:48}),o.jsx("p",{className:"text-gray-600",children:"Loading organisations..."})]})}):o.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:o.jsxs("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-8",children:[o.jsxs("div",{className:"text-center mb-6",children:[o.jsx(yo,{className:"mx-auto mb-4 text-blue-600",size:48}),o.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Select Organisation"}),o.jsx("p",{className:"text-gray-600",children:"Choose which organisation to work with"})]}),t.length>0?o.jsx("div",{className:"space-y-3",children:t.map(p=>o.jsx("button",{onClick:()=>f(p),className:"w-full p-4 border border-gray-200 rounded-lg hover:border-blue-500 hover:bg-blue-50 transition-colors text-left",children:o.jsx("div",{className:"font-semibold text-gray-900",children:p.name})},p.id))}):o.jsxs("div",{className:"text-center py-8",children:[o.jsx(it,{className:"mx-auto mb-4 text-gray-400",size:48}),o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Organisations Found"}),o.jsx("p",{className:"text-gray-600 mb-6",children:"You are not a member of any organisation yet. Create one to get started."}),o.jsxs("div",{className:"space-y-3",children:[o.jsx("input",{type:"text",value:l,onChange:p=>c(p.target.value),onKeyPress:p=>p.key==="Enter"&&h(),placeholder:"Organisation name",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:a}),u&&o.jsx("div",{className:"text-red-600 text-sm",children:u}),o.jsx("button",{onClick:h,disabled:a,className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:a?o.jsxs(o.Fragment,{children:[o.jsx(qs,{size:20,className:"animate-spin"}),"Creating..."]}):o.jsxs(o.Fragment,{children:[o.jsx(Ga,{size:20}),"Create Organisation"]})})]})]})]})})}function qV(){const{currentOrganisation:e}=ya();return o.jsxs("div",{children:[o.jsx(Rn,{title:"Organisation Settings",description:"Manage your organisation preferences"}),o.jsxs("div",{className:"mt-6 p-6 bg-white rounded-lg border border-gray-200",children:[o.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Current Organisation"}),o.jsx("p",{className:"text-gray-600",children:e==null?void 0:e.name})]})]})}function Iw(){return o.jsxs("div",{className:"p-8",children:[o.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Admin Dashboard"}),o.jsx("p",{className:"text-gray-600",children:"Platform administration"})]})}function GV(){const[e,t]=T.useState([]),[r,s]=T.useState([]),[n,a]=T.useState(!0),[i,l]=T.useState(""),[c,u]=T.useState("all");T.useEffect(()=>{d()},[]),T.useEffect(()=>{f()},[i,c,e]);const d=async()=>{try{const{data:m,error:x}=await ie.from("organisations").select("*").order("created_at",{ascending:!1});if(x)throw x;const g=await Promise.all((m||[]).map(async y=>{const{data:w}=await ie.from("organisation_members").select("user_id, role, status").eq("organisation_id",y.id),v=w==null?void 0:w.find(C=>C.role==="owner"),b=(w==null?void 0:w.filter(C=>C.status==="active"&&["owner","admin","member"].includes(C.role)).length)||0;let _="";if(v){const{data:C}=await ie.from("profiles").select("email, full_name").eq("id",v.user_id).maybeSingle();_=(C==null?void 0:C.email)||""}const{data:k}=await ie.from("subscriptions").select("plan_name").eq("organisation_id",y.id).maybeSingle(),{count:S}=await ie.from("projects").select("*",{count:"exact",head:!0}).eq("organisation_id",y.id),{data:E}=await ie.from("projects").select("updated_at").eq("organisation_id",y.id).order("updated_at",{ascending:!1}).limit(1).maybeSingle();return{...y,owner_email:_,plan_name:(k==null?void 0:k.plan_name)||"Trial",seats_used:b,project_count:S||0,last_active:(E==null?void 0:E.updated_at)||y.created_at}}));t(g)}catch(m){console.error("Error loading organisations:",m)}finally{a(!1)}},f=()=>{let m=e;if(c!=="all"&&(m=m.filter(x=>x.status===c)),i.trim()){const x=i.toLowerCase();m=m.filter(g=>g.name.toLowerCase().includes(x)||g.owner_email&&g.owner_email.toLowerCase().includes(x))}s(m)},h=m=>new Date(m).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"}),p=m=>{switch(m){case"trial":return"bg-amber-50 text-amber-700";case"suspended":return"bg-rose-50 text-rose-700";default:return"bg-emerald-50 text-emerald-700"}};return o.jsxs("div",{className:"px-6 py-6 max-w-7xl mx-auto",children:[o.jsxs("div",{className:"flex items-start justify-between mb-6",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-xl font-semibold text-slate-900",children:"Organisations"}),o.jsx("p",{className:"mt-1 text-sm text-slate-500",children:"Manage client organisations, seat limits, and subscription status."})]}),o.jsx("button",{onClick:()=>window.location.href="/admin/organisations/new",className:"inline-flex items-center rounded-lg bg-[#0A66C2] px-4 py-2 text-sm font-semibold text-white shadow hover:bg-[#0952A0] transition",children:"Create organisation"})]}),o.jsxs("div",{className:"mb-4 flex items-center gap-4",children:[o.jsxs("div",{className:"relative flex-1",children:[o.jsx(Nd,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:16}),o.jsx("input",{type:"text",placeholder:"Search by organisation name or owner email",value:i,onChange:m=>l(m.target.value),className:"w-full rounded-lg border border-slate-300 bg-slate-50 pl-9 pr-3 py-2 text-sm text-slate-800 placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-[#0A66C2] focus:border-[#0A66C2]"})]}),o.jsxs("select",{value:c,onChange:m=>u(m.target.value),className:"rounded-lg border border-slate-300 bg-slate-50 px-3 py-2 text-sm text-slate-800 focus:outline-none focus:ring-2 focus:ring-[#0A66C2] focus:border-[#0A66C2]",children:[o.jsx("option",{value:"all",children:"All"}),o.jsx("option",{value:"active",children:"Active"}),o.jsx("option",{value:"trial",children:"Trial"}),o.jsx("option",{value:"suspended",children:"Suspended"})]})]}),o.jsx("div",{className:"rounded-xl border border-slate-200 bg-white shadow-[0_4px_14px_rgba(15,23,42,0.06)] overflow-hidden",children:n?o.jsx("div",{className:"text-center py-12 text-slate-500",children:"Loading organisations..."}):r.length===0?o.jsx("div",{className:"text-center py-12 text-slate-500",children:i||c!=="all"?"No organisations found":"No organisations yet"}):o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full table-auto text-left text-sm",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"border-b border-slate-100",children:[o.jsx("th",{className:"px-4 py-3 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Organisation"}),o.jsx("th",{className:"px-4 py-3 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Owner"}),o.jsx("th",{className:"px-4 py-3 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Plan"}),o.jsx("th",{className:"px-4 py-3 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Seats"}),o.jsx("th",{className:"px-4 py-3 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Projects"}),o.jsx("th",{className:"px-4 py-3 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Status"}),o.jsx("th",{className:"px-4 py-3 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Last active"}),o.jsx("th",{className:"px-4 py-3 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Actions"})]})}),o.jsx("tbody",{children:r.map(m=>o.jsxs("tr",{className:"border-b border-slate-100 hover:bg-slate-50 cursor-pointer",onClick:()=>window.location.href=`/admin/organisations/${m.id}`,children:[o.jsx("td",{className:"px-4 py-3 align-middle",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"font-medium text-slate-900",children:m.name}),m.status!=="active"&&o.jsx("span",{className:`inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium ${p(m.status)}`,children:m.status.charAt(0).toUpperCase()+m.status.slice(1)})]})}),o.jsx("td",{className:"px-4 py-3 align-middle text-sm text-slate-600",children:m.owner_email||""}),o.jsx("td",{className:"px-4 py-3 align-middle text-sm text-slate-800",children:m.plan_name}),o.jsx("td",{className:"px-4 py-3 align-middle text-sm text-slate-800",children:o.jsxs("span",{className:m.seats_used>m.seat_limit?"text-rose-600 font-medium":"",children:[m.seats_used," / ",m.seat_limit]})}),o.jsx("td",{className:"px-4 py-3 align-middle text-sm text-slate-800",children:m.project_count}),o.jsx("td",{className:"px-4 py-3 align-middle",children:o.jsx("span",{className:`inline-flex items-center rounded-full px-2 py-1 text-xs font-medium ${p(m.status)}`,children:m.status.charAt(0).toUpperCase()+m.status.slice(1)})}),o.jsx("td",{className:"px-4 py-3 align-middle text-sm text-slate-600",children:h(m.last_active)}),o.jsx("td",{className:"px-4 py-3 align-middle",children:o.jsx("button",{onClick:x=>{x.stopPropagation(),window.location.href=`/admin/organisations/${m.id}`},className:"text-xs font-medium text-[#0A66C2] hover:underline",children:"Open"})})]},m.id))})]})})})]})}function KV({organisationId:e}){const[t,r]=T.useState(null),[s,n]=T.useState(null),[a,i]=T.useState([]),[l,c]=T.useState([]),[u,d]=T.useState(!0),[f,h]=T.useState(!1),[p,m]=T.useState(!1),[x,g]=T.useState(""),[y,w]=T.useState(10),[v,b]=T.useState(null),[_,k]=T.useState(""),[S,E]=T.useState("");T.useEffect(()=>{C()},[e]);const C=async()=>{try{const{data:L,error:X}=await ie.from("organisations").select("*").eq("id",e).single();if(X)throw X;r(L),w(L.seat_limit),E(new Date(L.created_at).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"}));const{data:K}=await ie.from("subscriptions").select("*").eq("organisation_id",e).maybeSingle();n(K),g((K==null?void 0:K.plan_name)||"Trial");const{data:V}=await ie.from("organisation_members").select("*").eq("organisation_id",e).order("activated_at",{ascending:!1,nullsFirst:!1}),fe=await Promise.all((V||[]).map(async M=>{const{data:D}=await ie.from("profiles").select("email, full_name").eq("id",M.user_id).maybeSingle();return M.role==="owner"&&k((D==null?void 0:D.email)||"Unknown"),{...M,email:(D==null?void 0:D.email)||"Unknown",full_name:D==null?void 0:D.full_name}}));i(fe);const{data:ve}=await ie.from("projects").select("*").eq("organisation_id",e).order("updated_at",{ascending:!1}),P=await Promise.all((ve||[]).map(async M=>{const{count:D}=await ie.from("quotes").select("*",{count:"exact",head:!0}).eq("project_id",M.id),{data:B}=await ie.from("profiles").select("email").eq("id",M.user_id).maybeSingle();return{...M,quote_count:D||0,owner_email:B==null?void 0:B.email}}));c(P)}catch(L){console.error("Error loading organisation:",L)}finally{d(!1)}},U=async()=>{if(t){h(!0);try{const{error:L}=await ie.from("organisations").update({seat_limit:y}).eq("id",e);if(L)throw L;if(s){const{error:X}=await ie.from("subscriptions").update({plan_name:x,seat_limit:y}).eq("organisation_id",e);if(X)throw X}b({type:"success",message:"Changes saved successfully"}),m(!1),await C()}catch(L){b({type:"error",message:L.message||"Failed to save changes"})}finally{h(!1)}}},H=async()=>{if(confirm("Suspend this organisation? Members will lose access immediately."))try{const{error:L}=await ie.from("organisations").update({status:"suspended"}).eq("id",e);if(L)throw L;b({type:"success",message:"Organisation suspended"}),await C()}catch(L){b({type:"error",message:L.message||"Failed to suspend organisation"})}},W=async()=>{try{const{error:L}=await ie.from("organisations").update({status:"active"}).eq("id",e);if(L)throw L;b({type:"success",message:"Organisation activated"}),await C()}catch(L){b({type:"error",message:L.message||"Failed to activate organisation"})}},q=L=>new Date(L).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"}),z=L=>{switch(L){case"trial":return"bg-amber-50 text-amber-700 border-amber-200";case"suspended":return"bg-rose-50 text-rose-700 border-rose-200";default:return"bg-emerald-50 text-emerald-700 border-emerald-200"}},Q=a.filter(L=>L.status==="active"&&["owner","admin","member"].includes(L.role)).length;return u?o.jsx("div",{className:"px-6 py-6 max-w-7xl mx-auto",children:o.jsx("div",{className:"text-center py-12 text-slate-500",children:"Loading organisation..."})}):t?o.jsxs("div",{className:"px-6 py-6 max-w-7xl mx-auto",children:[v&&o.jsxs("div",{className:`fixed top-4 right-4 z-50 rounded-lg px-4 py-3 shadow-lg flex items-center gap-3 ${v.type==="success"?"bg-emerald-50 text-emerald-800 border border-emerald-200":"bg-rose-50 text-rose-800 border border-rose-200"}`,children:[v.type==="error"&&o.jsx(it,{size:18}),o.jsx("span",{className:"text-sm font-medium",children:v.message}),o.jsx("button",{onClick:()=>b(null),className:"ml-2",children:o.jsx(Qr,{size:16})})]}),o.jsxs("button",{onClick:()=>window.location.href="/admin/organisations",className:"inline-flex items-center gap-2 text-sm text-slate-600 hover:text-slate-900 mb-4",children:[o.jsx(d0,{size:16}),"Back to organisations"]}),o.jsxs("div",{className:"flex items-start justify-between mb-6",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-xl font-semibold text-slate-900",children:t.name}),o.jsxs("p",{className:"mt-1 text-sm text-slate-500",children:["Created ",S,"  Owner: ",_]})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("span",{className:`inline-flex items-center rounded-full border px-3 py-1 text-xs font-medium ${z(t.status)}`,children:t.status.charAt(0).toUpperCase()+t.status.slice(1)}),t.status==="suspended"?o.jsx("button",{onClick:W,className:"inline-flex items-center rounded-lg bg-emerald-600 px-4 py-2 text-sm font-semibold text-white shadow hover:bg-emerald-700 transition",children:"Activate"}):o.jsx("button",{onClick:H,className:"inline-flex items-center rounded-lg bg-rose-600 px-4 py-2 text-sm font-semibold text-white shadow hover:bg-rose-700 transition",children:"Suspend"})]})]}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[o.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[o.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white shadow-[0_4px_14px_rgba(15,23,42,0.06)] p-4",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsx("h2",{className:"text-sm font-semibold text-slate-900",children:"Plan & seats"}),p?null:o.jsx("button",{onClick:()=>m(!0),className:"text-xs font-medium text-[#0A66C2] hover:underline",children:"Edit"})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Plan"}),o.jsxs("select",{value:x,onChange:L=>g(L.target.value),disabled:!p,className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-[#0A66C2] focus:border-[#0A66C2] disabled:bg-slate-50 disabled:text-slate-500",children:[o.jsx("option",{value:"Trial",children:"Trial (14 days)"}),o.jsx("option",{value:"Starter",children:"Starter"}),o.jsx("option",{value:"Pro",children:"Pro"}),o.jsx("option",{value:"Enterprise",children:"Enterprise"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Seat limit"}),o.jsx("input",{type:"number",value:y,onChange:L=>w(parseInt(L.target.value)||0),disabled:!p,className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-[#0A66C2] focus:border-[#0A66C2] disabled:bg-slate-50 disabled:text-slate-500"}),o.jsxs("p",{className:"mt-1 text-xs text-slate-500",children:["Currently using ",Q," seats. Owners, admins, and members use a seat. Viewers are free."]}),y<Q&&o.jsxs("p",{className:"mt-1 text-xs text-rose-600",children:["Warning: This organisation uses ",Q," seats. Reducing to ",y," will place them over their limit."]})]}),p&&o.jsxs("div",{className:"flex items-center gap-3 pt-2",children:[o.jsx("button",{onClick:U,disabled:f,className:"px-4 py-2 rounded-lg bg-[#0A66C2] text-sm font-semibold text-white hover:bg-[#0952A0] disabled:opacity-50 transition",children:f?"Saving...":"Save changes"}),o.jsx("button",{onClick:()=>{m(!1),w(t.seat_limit),g((s==null?void 0:s.plan_name)||"Trial")},className:"px-4 py-2 text-sm font-medium text-slate-700 hover:text-slate-900",children:"Cancel"})]})]})]}),o.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white shadow-[0_4px_14px_rgba(15,23,42,0.06)] p-4",children:[o.jsx("h2",{className:"text-sm font-semibold text-slate-900 mb-3",children:"Members"}),o.jsx("p",{className:"text-xs text-slate-500 mb-4",children:"Overview of all members in this organisation. Seat-consuming roles are highlighted."}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full table-auto text-left text-sm",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"border-b border-slate-100",children:[o.jsx("th",{className:"px-2 py-2 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Member"}),o.jsx("th",{className:"px-2 py-2 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Email"}),o.jsx("th",{className:"px-2 py-2 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Role"}),o.jsx("th",{className:"px-2 py-2 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Status"}),o.jsx("th",{className:"px-2 py-2 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Last active"})]})}),o.jsx("tbody",{children:a.map(L=>o.jsxs("tr",{className:"border-b border-slate-50",children:[o.jsx("td",{className:"px-2 py-2 text-sm text-slate-900",children:L.full_name||L.email.split("@")[0]}),o.jsx("td",{className:"px-2 py-2 text-sm text-slate-600",children:L.email}),o.jsx("td",{className:"px-2 py-2",children:o.jsx("span",{className:`inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium ${["owner","admin","member"].includes(L.role)?"bg-blue-50 text-blue-700":"bg-slate-50 text-slate-700"}`,children:L.role.charAt(0).toUpperCase()+L.role.slice(1)})}),o.jsx("td",{className:"px-2 py-2",children:o.jsx("span",{className:`inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium ${L.status==="active"?"bg-emerald-50 text-emerald-700":L.status==="invited"?"bg-slate-50 text-slate-700":"bg-rose-50 text-rose-700"}`,children:L.status.charAt(0).toUpperCase()+L.status.slice(1)})}),o.jsx("td",{className:"px-2 py-2 text-sm text-slate-600",children:L.activated_at?q(L.activated_at):"Never"})]},L.id))})]})})]}),o.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white shadow-[0_4px_14px_rgba(15,23,42,0.06)] p-4",children:[o.jsx("h2",{className:"text-sm font-semibold text-slate-900 mb-4",children:"Projects"}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full table-auto text-left text-sm",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"border-b border-slate-100",children:[o.jsx("th",{className:"px-2 py-2 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Project"}),o.jsx("th",{className:"px-2 py-2 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Status"}),o.jsx("th",{className:"px-2 py-2 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Last updated"}),o.jsx("th",{className:"px-2 py-2 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Quotes"}),o.jsx("th",{className:"px-2 py-2 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Owner"})]})}),o.jsx("tbody",{children:l.length===0?o.jsx("tr",{children:o.jsx("td",{colSpan:5,className:"px-2 py-4 text-center text-sm text-slate-500",children:"No projects yet"})}):l.map(L=>o.jsxs("tr",{className:"border-b border-slate-50",children:[o.jsx("td",{className:"px-2 py-2 font-medium text-sm text-slate-900",children:L.name}),o.jsx("td",{className:"px-2 py-2",children:o.jsx("span",{className:`inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium ${L.status==="active"?"bg-emerald-50 text-emerald-700":"bg-slate-50 text-slate-700"}`,children:L.status.charAt(0).toUpperCase()+L.status.slice(1)})}),o.jsx("td",{className:"px-2 py-2 text-sm text-slate-600",children:q(L.updated_at)}),o.jsx("td",{className:"px-2 py-2 text-sm text-slate-800",children:L.quote_count}),o.jsx("td",{className:"px-2 py-2 text-sm text-slate-600",children:L.owner_email||""})]},L.id))})]})})]})]}),o.jsx("div",{children:o.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white shadow-[0_4px_14px_rgba(15,23,42,0.06)] p-4",children:[o.jsx("h2",{className:"text-sm font-semibold text-slate-900 mb-3",children:"Quick actions"}),o.jsx("div",{className:"space-y-2",children:o.jsx("button",{onClick:()=>navigator.clipboard.writeText(e),className:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-slate-50 rounded-lg transition",children:"Copy organisation ID"})})]})})]})]}):o.jsx("div",{className:"px-6 py-6 max-w-7xl mx-auto",children:o.jsx("div",{className:"text-center py-12 text-slate-500",children:"Organisation not found"})})}function XV(){const[e,t]=T.useState(""),[r,s]=T.useState("Trial"),[n,a]=T.useState(5),[i,l]=T.useState(""),[c,u]=T.useState(""),[d,f]=T.useState(!1),[h,p]=T.useState(null),m=async()=>{if(!e||!i){p({type:"error",message:"Please fill in all required fields"});return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(i)){p({type:"error",message:"Please enter a valid email address"});return}f(!0);try{const{data:{user:x}}=await ie.auth.getUser(),{data:g,error:y}=await ie.from("organisations").insert({name:e,status:r==="Trial"?"trial":"active",seat_limit:n,created_by_user_id:x==null?void 0:x.id}).select().single();if(y)throw y;const{error:w}=await ie.from("subscriptions").insert({organisation_id:g.id,plan_name:r,seat_limit:n,billing_status:"active"});if(w)throw w;let v="";const{data:b}=await ie.from("profiles").select("id").eq("email",i).maybeSingle();if(b)v=b.id;else{const k=Math.random().toString(36).slice(-12),{data:S,error:E}=await ie.auth.admin.createUser({email:i,password:k,email_confirm:!1});if(E)throw E;v=S.user.id}const{error:_}=await ie.from("organisation_members").insert({organisation_id:g.id,user_id:v,role:"owner",status:"invited",invited_by_user_id:x==null?void 0:x.id});if(_)throw _;window.location.href=`/admin/organisations/${g.id}`}catch(x){console.error("Error creating organisation:",x),p({type:"error",message:x.message||"Failed to create organisation"}),f(!1)}};return o.jsxs("div",{className:"px-6 py-6 max-w-3xl mx-auto",children:[h&&o.jsxs("div",{className:`fixed top-4 right-4 z-50 rounded-lg px-4 py-3 shadow-lg flex items-center gap-3 ${h.type==="success"?"bg-emerald-50 text-emerald-800 border border-emerald-200":"bg-rose-50 text-rose-800 border border-rose-200"}`,children:[h.type==="error"&&o.jsx(it,{size:18}),o.jsx("span",{className:"text-sm font-medium",children:h.message}),o.jsx("button",{onClick:()=>p(null),className:"ml-2",children:o.jsx(Qr,{size:16})})]}),o.jsxs("button",{onClick:()=>window.location.href="/admin/organisations",className:"inline-flex items-center gap-2 text-sm text-slate-600 hover:text-slate-900 mb-6",children:[o.jsx(d0,{size:16}),"Back to organisations"]}),o.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white shadow-[0_4px_14px_rgba(15,23,42,0.06)] p-6",children:[o.jsx("h1",{className:"text-xl font-semibold text-slate-900 mb-2",children:"Create organisation"}),o.jsx("p",{className:"text-sm text-slate-500 mb-6",children:"Set up a new organisation with a primary owner who will receive an invite email."}),o.jsxs("div",{className:"space-y-5",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Organisation name ",o.jsx("span",{className:"text-rose-600",children:"*"})]}),o.jsx("input",{type:"text",placeholder:"Optimal Fire",value:e,onChange:x=>t(x.target.value),className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-[#0A66C2] focus:border-[#0A66C2]"})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Plan ",o.jsx("span",{className:"text-rose-600",children:"*"})]}),o.jsxs("select",{value:r,onChange:x=>s(x.target.value),className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-[#0A66C2] focus:border-[#0A66C2]",children:[o.jsx("option",{value:"Trial",children:"Trial (14 days)"}),o.jsx("option",{value:"Starter",children:"Starter"}),o.jsx("option",{value:"Pro",children:"Pro"}),o.jsx("option",{value:"Enterprise",children:"Enterprise"})]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Seat limit ",o.jsx("span",{className:"text-rose-600",children:"*"})]}),o.jsx("input",{type:"number",value:n,onChange:x=>a(parseInt(x.target.value)||0),min:"1",className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-[#0A66C2] focus:border-[#0A66C2]"}),o.jsx("p",{className:"mt-1 text-xs text-slate-500",children:"Owners, admins, and members use a seat. Viewers are free."})]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Primary owner email ",o.jsx("span",{className:"text-rose-600",children:"*"})]}),o.jsx("input",{type:"email",placeholder:"owner@company.com",value:i,onChange:x=>l(x.target.value),className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-[#0A66C2] focus:border-[#0A66C2]"}),o.jsx("p",{className:"mt-1 text-xs text-slate-500",children:"We'll send an invite to this email. They'll become the Organisation Owner."})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Internal notes"}),o.jsx("textarea",{placeholder:"Optional admin-only notes about this organisation...",value:c,onChange:x=>u(x.target.value),rows:3,className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-[#0A66C2] focus:border-[#0A66C2] resize-none"})]})]}),o.jsxs("div",{className:"mt-6 flex items-center justify-end gap-3 pt-4 border-t border-slate-200",children:[o.jsx("button",{onClick:()=>window.location.href="/admin/organisations",className:"px-4 py-2 text-sm font-medium text-slate-700 hover:text-slate-900",disabled:d,children:"Cancel"}),o.jsx("button",{onClick:m,disabled:d||!e||!i,className:"px-4 py-2 rounded-lg bg-[#0A66C2] text-sm font-semibold text-white hover:bg-[#0952A0] disabled:opacity-50 disabled:cursor-not-allowed transition",children:d?"Creating...":"Create organisation"})]})]})]})}function YV({organisationId:e,organisationName:t,currentLicenses:r,subscriptionStatus:s,onClose:n,onUpdate:a}){const[i,l]=T.useState(r),[c,u]=T.useState(!1),[d,f]=T.useState(null),h=async w=>{u(!0),f(null);try{const v=await yR(e,w);l(v.licensedTrades),f({type:"success",text:v.message}),setTimeout(()=>a(),1e3)}catch(v){console.error("Failed to add license:",v),f({type:"error",text:"Failed to add trade license"})}finally{u(!1)}},p=async w=>{if(i.length===1){f({type:"error",text:"Cannot remove last trade license"});return}u(!0),f(null);try{const v=await wR(e,w);l(v.licensedTrades),f({type:"success",text:v.message}),setTimeout(()=>a(),1e3)}catch(v){console.error("Failed to remove license:",v),f({type:"error",text:"Failed to remove trade license"})}finally{u(!1)}},x=(()=>{const w=i.reduce((v,b)=>{const _=Hs.find(k=>k.value===b);return v+((_==null?void 0:_.price)||0)},0);return i.length===2?w*.85:i.length===3?w*.75:i.length>=4?w*.65:w})(),g=i.reduce((w,v)=>{const b=Hs.find(_=>_.value===v);return w+((b==null?void 0:b.price)||0)},0),y=g-x;return o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-3xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[o.jsxs("div",{className:"p-6 border-b border-gray-200 flex items-center justify-between sticky top-0 bg-white",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Manage Trade Licenses"}),o.jsx("p",{className:"text-gray-600 mt-1",children:t})]}),o.jsx("button",{onClick:n,className:"p-2 text-gray-400 hover:text-gray-600 transition-colors",children:o.jsx(Qr,{size:24})})]}),d&&o.jsx("div",{className:`mx-6 mt-4 p-4 rounded-md ${d.type==="success"?"bg-green-50 text-green-800":"bg-red-50 text-red-800"}`,children:d.text}),o.jsxs("div",{className:"p-6 space-y-6",children:[s==="trial"&&o.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[o.jsx("div",{className:"font-semibold text-blue-900 mb-1",children:"Trial Mode"}),o.jsx("div",{className:"text-sm text-blue-800",children:"This client is on trial and can access all trades. Licenses will be enforced when they convert to paid."})]}),o.jsxs("div",{children:[o.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Current Licensed Trades"}),o.jsx("div",{className:"space-y-2",children:i.length===0?o.jsx("div",{className:"text-gray-500 text-sm",children:"No trade licenses active"}):i.map(w=>{const v=Hs.find(b=>b.value===w);return v?o.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:`w-3 h-3 rounded-full bg-${v.color}-500`}),o.jsxs("div",{children:[o.jsx("div",{className:"font-medium text-gray-900",children:v.label}),o.jsxs("div",{className:"text-sm text-gray-600",children:["$",v.price,"/month"]})]})]}),o.jsx("button",{onClick:()=>p(w),disabled:c||i.length===1,className:"p-2 text-red-600 hover:bg-red-50 rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:i.length===1?"Cannot remove last license":"Remove license",children:o.jsx(bo,{size:16})})]},w):null})})]}),o.jsxs("div",{children:[o.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Available Trades to Add"}),o.jsx("div",{className:"grid grid-cols-2 gap-3",children:Hs.filter(w=>!i.includes(w.value)).map(w=>o.jsxs("button",{onClick:()=>h(w.value),disabled:c,className:"flex items-center gap-3 p-4 border-2 border-gray-200 rounded-lg hover:border-blue-500 hover:bg-blue-50 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:[o.jsx("div",{className:`w-4 h-4 rounded-full bg-${w.color}-500`}),o.jsxs("div",{className:"text-left flex-1",children:[o.jsx("div",{className:"font-medium text-gray-900",children:w.label}),o.jsxs("div",{className:"text-sm text-gray-600",children:["$",w.price,"/month"]})]}),o.jsx(Ga,{size:20,className:"text-gray-400"})]},w.value))}),Hs.filter(w=>!i.includes(w.value)).length===0&&o.jsxs("div",{className:"text-center p-8 bg-green-50 rounded-lg",children:[o.jsx(dx,{size:48,className:"mx-auto mb-2 text-green-600"}),o.jsx("div",{className:"font-semibold text-green-900",children:"All Trades Licensed!"}),o.jsx("div",{className:"text-sm text-green-700 mt-1",children:"This client has access to every trade"})]})]}),o.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-blue-100 border border-blue-200 rounded-lg p-6",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[o.jsx(Ki,{className:"text-blue-600",size:24}),o.jsx("h3",{className:"font-bold text-blue-900",children:"Revenue Calculation"})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex justify-between text-sm",children:[o.jsxs("span",{className:"text-blue-800",children:["Base Price (",i.length," trades):"]}),o.jsxs("span",{className:"font-medium text-blue-900",children:["$",g,"/month"]})]}),i.length>=2&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex justify-between text-sm",children:[o.jsxs("span",{className:"text-blue-800",children:["Bundle Discount (",i.length===2&&"15%",i.length===3&&"25%",i.length>=4&&"35%","):"]}),o.jsxs("span",{className:"font-medium text-green-600",children:["-$",y.toFixed(0)]})]}),o.jsx("div",{className:"h-px bg-blue-300 my-2"})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"font-bold text-blue-900",children:"Monthly Revenue:"}),o.jsxs("span",{className:"text-2xl font-bold text-blue-900",children:["$",x.toFixed(0)]})]}),o.jsxs("div",{className:"text-xs text-blue-700 mt-2",children:[i.length===1&&"Add another trade for 15% bundle discount",i.length===2&&"Add one more trade for 25% bundle discount (10% more savings)",i.length===3&&"Add all trades for 35% bundle discount",i.length>=4&&"Maximum bundle discount applied!"]})]})]}),o.jsx("div",{className:"flex gap-3",children:o.jsx("button",{onClick:n,className:"flex-1 px-6 py-3 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 font-medium",children:"Close"})})]})]})})}function Ow(){const[e,t]=T.useState([]),[r,s]=T.useState(!0),[n,a]=T.useState("all"),[i,l]=T.useState(""),[c,u]=T.useState(null),[d,f]=T.useState(null);T.useEffect(()=>{h()},[]);const h=async()=>{s(!0);try{const b=await dR();t(b)}catch(b){console.error("Failed to load organisations:",b),u({type:"error",text:"Failed to load organisations"})}finally{s(!1)}},p=async(b,_)=>{try{await hR(b,_),u({type:"success",text:`Trial extended by ${_} days`}),await h()}catch(k){console.error("Failed to extend trial:",k),u({type:"error",text:"Failed to extend trial"})}},m=async(b,_)=>{try{await mR(b,_),u({type:"success",text:`Status updated to ${_}`}),await h()}catch(k){console.error("Failed to update status:",k),u({type:"error",text:"Failed to update status"})}},x=async b=>{try{await pR(b.id)}catch(_){console.error("Failed to impersonate:",_),u({type:"error",text:"Failed to enter client mode"})}},g=b=>{if(!b)return null;const _=new Date(b),k=new Date,S=_.getTime()-k.getTime();return Math.ceil(S/(1e3*60*60*24))},y=b=>{switch(b){case"trial":return"bg-blue-100 text-blue-800";case"active":return"bg-green-100 text-green-800";case"expired":return"bg-red-100 text-red-800";case"suspended":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},w=e.filter(b=>!(n!=="all"&&b.subscription_status!==n||i&&!b.name.toLowerCase().includes(i.toLowerCase()))),v={total:e.length,trial:e.filter(b=>b.subscription_status==="trial").length,active:e.filter(b=>b.subscription_status==="active").length,expired:e.filter(b=>b.subscription_status==="expired").length,totalQuotes:e.reduce((b,_)=>b+_.quote_count,0)};return r?o.jsx("div",{className:"flex items-center justify-center h-64",children:o.jsx("div",{className:"text-gray-500",children:"Loading clients..."})}):o.jsxs("div",{className:"space-y-6",children:[o.jsx(Rn,{title:"Super Admin Dashboard",subtitle:"God-mode control over all clients and trades"}),c&&o.jsx("div",{className:`p-4 rounded-md ${c.type==="success"?"bg-green-50 text-green-800":"bg-red-50 text-red-800"}`,children:c.text}),o.jsxs("div",{className:"grid grid-cols-5 gap-4",children:[o.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(IS,{className:"text-gray-600",size:24}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm text-gray-600",children:"Total Clients"}),o.jsx("div",{className:"text-2xl font-bold text-gray-900",children:v.total})]})]})}),o.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-blue-200 p-4",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(Ac,{className:"text-blue-600",size:24}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm text-blue-600",children:"On Trial"}),o.jsx("div",{className:"text-2xl font-bold text-blue-600",children:v.trial})]})]})}),o.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-green-200 p-4",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(kr,{className:"text-green-600",size:24}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm text-green-600",children:"Active Paid"}),o.jsx("div",{className:"text-2xl font-bold text-green-600",children:v.active})]})]})}),o.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-red-200 p-4",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(h0,{className:"text-red-600",size:24}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm text-red-600",children:"Expired"}),o.jsx("div",{className:"text-2xl font-bold text-red-600",children:v.expired})]})]})}),o.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx($t,{className:"text-gray-600",size:24}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm text-gray-600",children:"Total Quotes"}),o.jsx("div",{className:"text-2xl font-bold text-gray-900",children:v.totalQuotes})]})]})})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[o.jsx("div",{className:"p-4 border-b border-gray-200",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex gap-2",children:[o.jsxs("button",{onClick:()=>a("all"),className:`px-4 py-2 rounded-md font-medium transition-colors ${n==="all"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["All (",v.total,")"]}),o.jsxs("button",{onClick:()=>a("trial"),className:`px-4 py-2 rounded-md font-medium transition-colors ${n==="trial"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["Trial (",v.trial,")"]}),o.jsxs("button",{onClick:()=>a("active"),className:`px-4 py-2 rounded-md font-medium transition-colors ${n==="active"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["Active (",v.active,")"]}),o.jsxs("button",{onClick:()=>a("expired"),className:`px-4 py-2 rounded-md font-medium transition-colors ${n==="expired"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["Expired (",v.expired,")"]})]}),o.jsxs("div",{className:"flex gap-3",children:[o.jsx("input",{type:"text",placeholder:"Search clients...",value:i,onChange:b=>l(b.target.value),className:"px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),o.jsxs("button",{onClick:()=>window.location.href="/admin/clients/new",className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 font-medium",children:[o.jsx(Ga,{size:18}),"New Client"]})]})]})}),o.jsxs("div",{className:"overflow-x-auto",children:[o.jsxs("table",{className:"w-full",children:[o.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase",children:"Client"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase",children:"Licensed Trades"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase",children:"Status"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase",children:"Trial End"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase",children:"Quotes"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase",children:"Last Active"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase",children:"Actions"})]})}),o.jsx("tbody",{className:"divide-y divide-gray-200",children:w.map(b=>{const _=g(b.trial_end_date);return o.jsxs("tr",{className:"hover:bg-gray-50",children:[o.jsx("td",{className:"px-4 py-3",children:o.jsxs("div",{children:[o.jsx("div",{className:"font-medium text-gray-900",children:b.name}),o.jsx("div",{className:"text-sm text-gray-500",children:b.owner_email||"No owner"})]})}),o.jsxs("td",{className:"px-4 py-3",children:[o.jsx("div",{className:"flex flex-wrap gap-1",children:b.licensed_trades&&b.licensed_trades.length>0?b.licensed_trades.map(k=>{var S;return o.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-medium rounded bg-blue-100 text-blue-800",children:((S=kx[k])==null?void 0:S.replace(" Verify+",""))||k},k)}):o.jsx("span",{className:"text-xs text-gray-400",children:"No trades"})}),o.jsx("button",{onClick:()=>f(b),className:"text-xs text-blue-600 hover:text-blue-800 mt-1",children:"Manage Licenses"})]}),o.jsx("td",{className:"px-4 py-3",children:o.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded ${y(b.subscription_status)}`,children:b.subscription_status})}),o.jsx("td",{className:"px-4 py-3",children:b.trial_end_date?o.jsxs("div",{children:[o.jsx("div",{className:"text-sm text-gray-900",children:new Date(b.trial_end_date).toLocaleDateString()}),_!==null&&o.jsx("div",{className:`text-xs ${_<0?"text-red-600":_<3?"text-orange-600":"text-gray-500"}`,children:_<0?`${Math.abs(_)} days ago`:`${_} days left`})]}):o.jsx("span",{className:"text-sm text-gray-400",children:"N/A"})}),o.jsx("td",{className:"px-4 py-3",children:o.jsx("span",{className:"text-sm font-medium text-gray-900",children:b.quote_count})}),o.jsx("td",{className:"px-4 py-3",children:b.last_active_at?o.jsx("span",{className:"text-sm text-gray-600",children:new Date(b.last_active_at).toLocaleDateString()}):o.jsx("span",{className:"text-sm text-gray-400",children:"Never"})}),o.jsx("td",{className:"px-4 py-3",children:o.jsxs("div",{className:"flex gap-2",children:[o.jsx("button",{onClick:()=>x(b),className:"p-1.5 text-blue-600 hover:bg-blue-50 rounded transition-colors",title:"Enter as Client",children:o.jsx(kF,{size:16})}),o.jsx("button",{onClick:()=>p(b.id,30),className:"p-1.5 text-green-600 hover:bg-green-50 rounded transition-colors",title:"Extend Trial +30 days",children:o.jsx(TS,{size:16})}),b.subscription_status==="trial"&&o.jsx("button",{onClick:()=>m(b.id,"active"),className:"p-1.5 text-green-600 hover:bg-green-50 rounded transition-colors",title:"Upgrade to Active",children:o.jsx(Po,{size:16})})]})})]},b.id)})})]}),w.length===0&&o.jsx("div",{className:"p-12 text-center text-gray-500",children:"No clients found matching your filters"})]})]}),d&&o.jsx(YV,{organisationId:d.id,organisationName:d.name,currentLicenses:d.licensed_trades||[],subscriptionStatus:d.subscription_status,onClose:()=>f(null),onUpdate:()=>{h(),u({type:"success",text:"Trade licenses updated"})}})]})}function JV(){const[e,t]=T.useState({name:"",selectedTrades:["passive_fire"],trialDays:14,ownerEmail:""}),[r,s]=T.useState(!1),[n,a]=T.useState(null),[i,l]=T.useState(null),c=m=>{const x=m.reduce((g,y)=>{const w=Hs.find(v=>v.value===y);return g+((w==null?void 0:w.price)||0)},0);return m.length===2?x*.85:m.length===3?x*.75:m.length>=4?x*.65:x},u=m=>{if(e.selectedTrades.includes(m)){if(e.selectedTrades.length===1)return;t({...e,selectedTrades:e.selectedTrades.filter(x=>x!==m)})}else t({...e,selectedTrades:[...e.selectedTrades,m]})},d=async m=>{m.preventDefault(),s(!0),l(null);try{const{data:{session:x}}=await ie.auth.getSession();if(!(x!=null&&x.user.email))throw new Error("Not authenticated");const{data:g,error:y}=await ie.rpc("admin_create_client_organisation",{p_admin_email:x.user.email,p_org_name:e.name,p_trade_type:e.selectedTrades[0],p_trial_days:e.trialDays,p_owner_email:e.ownerEmail});if(y)throw y;const w=g.organisation_id,{error:v}=await ie.from("organisations").update({licensed_trades:e.selectedTrades}).eq("id",w);if(v)throw v;a({organisationId:w,message:g.message})}catch(x){console.error("Failed to create organisation:",x),l(x instanceof Error?x.message:"Failed to create client")}finally{s(!1)}},f=c(e.selectedTrades),h=e.selectedTrades.reduce((m,x)=>{const g=Hs.find(y=>y.value===x);return m+((g==null?void 0:g.price)||0)},0),p=h-f;return n?o.jsxs("div",{className:"space-y-6",children:[o.jsx(Rn,{title:"Client Created Successfully",subtitle:"The new client organisation is ready"}),o.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-8 max-w-2xl mx-auto",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"mx-auto w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mb-4",children:o.jsx(kr,{size:32,className:"text-green-600"})}),o.jsxs("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:[e.name," Created!"]}),o.jsx("p",{className:"text-gray-600 mb-6",children:n.message}),o.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 text-left space-y-2 mb-6",children:[o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-gray-600",children:"Organisation ID:"}),o.jsx("span",{className:"font-mono text-sm text-gray-900",children:n.organisationId})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-gray-600",children:"Owner Email:"}),o.jsx("span",{className:"font-medium text-gray-900",children:e.ownerEmail})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-gray-600",children:"Licensed Trades:"}),o.jsx("div",{className:"flex flex-wrap gap-1 justify-end",children:e.selectedTrades.map(m=>{var x;return o.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs font-medium rounded",children:(x=kx[m])==null?void 0:x.replace(" Verify+","")},m)})})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-gray-600",children:"Monthly Revenue:"}),o.jsxs("span",{className:"text-lg font-bold text-green-600",children:["$",f.toFixed(0)]})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-gray-600",children:"Trial Length:"}),o.jsxs("span",{className:"font-medium text-gray-900",children:[e.trialDays," days"]})]})]}),o.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 text-left mb-6",children:[o.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"Next Steps:"}),o.jsxs("ol",{className:"list-decimal list-inside space-y-1 text-sm text-blue-800",children:[o.jsxs("li",{children:["Owner must sign up at the app using: ",o.jsx("strong",{children:e.ownerEmail})]}),o.jsx("li",{children:"They'll be automatically added to this organisation"}),o.jsxs("li",{children:["During trial: All ",e.selectedTrades.length," trades are accessible"]}),o.jsxs("li",{children:["After trial: Pay $",f.toFixed(0),"/month to keep licenses active"]})]})]}),o.jsxs("div",{className:"flex gap-3",children:[o.jsx("button",{onClick:()=>window.location.href="/admin/dashboard",className:"flex-1 px-6 py-3 bg-blue-600 text-white rounded-md hover:bg-blue-700 font-medium",children:"Back to Dashboard"}),o.jsx("button",{onClick:()=>{a(null),t({name:"",selectedTrades:["passive_fire"],trialDays:14,ownerEmail:""})},className:"flex-1 px-6 py-3 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 font-medium",children:"Create Another Client"})]})]})})]}):o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsx("button",{onClick:()=>window.location.href="/admin/dashboard",className:"p-2 text-gray-600 hover:bg-gray-100 rounded transition-colors",children:o.jsx(d0,{size:20})}),o.jsx(Rn,{title:"Create New Client",subtitle:"Set up a new organisation with multi-trade licensing in under 15 seconds"})]}),i&&o.jsx("div",{className:"bg-red-50 border border-red-200 text-red-800 rounded-lg p-4",children:i}),o.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 max-w-3xl",children:o.jsxs("form",{onSubmit:d,className:"space-y-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Company Name *"}),o.jsx("input",{type:"text",required:!0,value:e.name,onChange:m=>t({...e,name:m.target.value}),placeholder:"e.g., Acme Fire Protection Ltd",className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:["Licensed Trades * ",o.jsx("span",{className:"text-gray-500 font-normal",children:"(select all that apply)"})]}),o.jsx("div",{className:"grid grid-cols-2 gap-3",children:Hs.map(m=>{const x=e.selectedTrades.includes(m.value);return o.jsxs("button",{type:"button",onClick:()=>u(m.value),disabled:x&&e.selectedTrades.length===1,className:`p-4 border-2 rounded-lg text-left transition-all ${x?"border-blue-500 bg-blue-50 ring-2 ring-blue-200":"border-gray-200 hover:border-blue-300"} ${x&&e.selectedTrades.length===1?"opacity-50 cursor-not-allowed":""}`,children:[o.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[o.jsx("div",{className:`w-4 h-4 rounded-full ${m.color==="orange"?"bg-orange-500":m.color==="yellow"?"bg-yellow-500":m.color==="blue"?"bg-blue-500":"bg-green-500"}`}),o.jsx("div",{className:"font-medium text-gray-900",children:m.label}),x&&o.jsx(kr,{size:16,className:"ml-auto text-blue-600"})]}),o.jsxs("div",{className:"text-sm text-gray-600",children:["$",m.price,"/month"]})]},m.value)})}),o.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"Client can access all selected trades during trial. After trial, they pay for what they keep."})]}),o.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-green-100 border border-green-200 rounded-lg p-5",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[o.jsx(Ki,{className:"text-green-600",size:24}),o.jsx("h3",{className:"font-bold text-green-900",children:"Revenue Calculator"})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex justify-between text-sm",children:[o.jsxs("span",{className:"text-green-800",children:["Base Price (",e.selectedTrades.length," trades):"]}),o.jsxs("span",{className:"font-medium text-green-900",children:["$",h,"/month"]})]}),e.selectedTrades.length>=2&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex justify-between text-sm",children:[o.jsxs("span",{className:"text-green-800",children:["Bundle Discount (",e.selectedTrades.length===2&&"15%",e.selectedTrades.length===3&&"25%",e.selectedTrades.length>=4&&"35%","):"]}),o.jsxs("span",{className:"font-medium text-green-600",children:["-$",p.toFixed(0)]})]}),o.jsx("div",{className:"h-px bg-green-300 my-2"})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"font-bold text-green-900",children:"Monthly Revenue:"}),o.jsxs("span",{className:"text-2xl font-bold text-green-900",children:["$",f.toFixed(0)]})]}),o.jsxs("div",{className:"text-xs text-green-700 mt-2",children:[e.selectedTrades.length===1&&"Select another trade for 15% bundle discount",e.selectedTrades.length===2&&"Select one more trade for 25% bundle discount (10% more savings)",e.selectedTrades.length===3&&"Select all trades for 35% bundle discount",e.selectedTrades.length>=4&&"Maximum bundle discount applied!"]})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Trial Length *"}),o.jsx("div",{className:"grid grid-cols-4 gap-2",children:[7,14,30,60].map(m=>o.jsxs("button",{type:"button",onClick:()=>t({...e,trialDays:m}),className:`px-4 py-2 rounded-md font-medium transition-colors ${e.trialDays===m?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[m," days"]},m))})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Owner Email *"}),o.jsx("input",{type:"email",required:!0,value:e.ownerEmail,onChange:m=>t({...e,ownerEmail:m.target.value}),placeholder:"owner@company.com",className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),o.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"They'll need to sign up with this email to access the organisation"})]}),o.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[o.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"What happens next:"}),o.jsxs("ul",{className:"list-disc list-inside space-y-1 text-sm text-blue-800",children:[o.jsxs("li",{children:["Organisation created with ",e.selectedTrades.length," licensed trade",e.selectedTrades.length>1?"s":""]}),o.jsx("li",{children:"Default project set up for primary trade"}),o.jsxs("li",{children:["Owner can sign up and access all ",e.selectedTrades.length," trades during trial"]}),o.jsxs("li",{children:["After trial: $",f.toFixed(0),"/month to keep licenses active"]})]})]}),o.jsxs("div",{className:"flex gap-3 pt-4",children:[o.jsx("button",{type:"button",onClick:()=>window.location.href="/admin/dashboard",className:"flex-1 px-6 py-3 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 font-medium",children:"Cancel"}),o.jsx("button",{type:"submit",disabled:r,className:"flex-1 px-6 py-3 bg-green-600 text-white rounded-md hover:bg-green-700 font-medium disabled:bg-gray-400 disabled:cursor-not-allowed",children:r?"Creating...":`Create Client ($${f.toFixed(0)}/mo)`})]})]})})]})}function QV(){const[e,t]=T.useState([]),[r,s]=T.useState(!0),[n,a]=T.useState(""),[i,l]=T.useState("all"),[c,u]=T.useState("all"),[d,f]=T.useState([]);T.useEffect(()=>{h()},[]);const h=async()=>{s(!0);try{const[g,y]=await Promise.all([fR(),ie.from("organisations").select("id, name").order("name")]);t(g),f(y.data||[])}catch(g){console.error("Failed to load data:",g)}finally{s(!1)}},p=async g=>{try{const y=g.supplier_name?`${g.organisation_id}/${g.supplier_name.replace(/\s+/g,"_")}_${g.quote_id}.pdf`:`${g.organisation_id}/quote_${g.quote_id}.pdf`,{data:w,error:v}=await ie.storage.from("quotes").createSignedUrl(y,3600);if(v)throw v;w!=null&&w.signedUrl&&window.open(w.signedUrl,"_blank")}catch(y){console.error("Failed to download:",y),alert("Failed to download PDF. It may have been deleted or moved.")}},m=e.filter(g=>!(n&&!g.supplier_name.toLowerCase().includes(n.toLowerCase())&&!g.organisation_name.toLowerCase().includes(n.toLowerCase())||i!=="all"&&g.trade_type!==i||c!=="all"&&g.organisation_id!==c)),x={total:e.length,totalSize:e.reduce((g,y)=>g+(y.items_count||0),0),avgConfidence:e.length>0?(e.reduce((g,y)=>g+(y.avg_confidence||0),0)/e.length*100).toFixed(1):"0"};return r?o.jsx("div",{className:"flex items-center justify-center h-64",children:o.jsx("div",{className:"text-gray-500",children:"Loading PDF vault..."})}):o.jsxs("div",{className:"space-y-6",children:[o.jsx(Rn,{title:"Global PDF Vault",subtitle:"Every PDF ever uploaded by any client, searchable and downloadable"}),o.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[o.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx($t,{className:"text-gray-600",size:24}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm text-gray-600",children:"Total PDFs"}),o.jsx("div",{className:"text-2xl font-bold text-gray-900",children:x.total})]})]})}),o.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx($t,{className:"text-gray-600",size:24}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm text-gray-600",children:"Total Line Items"}),o.jsx("div",{className:"text-2xl font-bold text-gray-900",children:x.totalSize.toLocaleString()})]})]})}),o.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx($t,{className:"text-gray-600",size:24}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm text-gray-600",children:"Avg Confidence"}),o.jsxs("div",{className:"text-2xl font-bold text-gray-900",children:[x.avgConfidence,"%"]})]})]})})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[o.jsx("div",{className:"p-4 border-b border-gray-200",children:o.jsxs("div",{className:"flex gap-3",children:[o.jsxs("div",{className:"flex-1 relative",children:[o.jsx(Nd,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:18}),o.jsx("input",{type:"text",placeholder:"Search by supplier or organisation...",value:n,onChange:g=>a(g.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),o.jsxs("select",{value:i,onChange:g=>l(g.target.value),className:"px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"all",children:"All Trades"}),o.jsx("option",{value:"passive_fire",children:"PassiveFire"}),o.jsx("option",{value:"electrical",children:"Electrical"}),o.jsx("option",{value:"plumbing",children:"Plumbing"}),o.jsx("option",{value:"mechanical",children:"Mechanical"})]}),o.jsxs("select",{value:c,onChange:g=>u(g.target.value),className:"px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"all",children:"All Organisations"}),d.map(g=>o.jsx("option",{value:g.id,children:g.name},g.id))]})]})}),o.jsxs("div",{className:"overflow-x-auto",children:[o.jsxs("table",{className:"w-full",children:[o.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase",children:"Supplier"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase",children:"Organisation"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase",children:"Project"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase",children:"Items"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase",children:"Total"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase",children:"Confidence"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase",children:"Uploaded"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase",children:"Actions"})]})}),o.jsx("tbody",{className:"divide-y divide-gray-200",children:m.map(g=>o.jsxs("tr",{className:"hover:bg-gray-50",children:[o.jsx("td",{className:"px-4 py-3",children:o.jsxs("div",{children:[o.jsx("div",{className:"font-medium text-gray-900",children:g.supplier_name}),g.quote_reference&&o.jsx("div",{className:"text-sm text-gray-500",children:g.quote_reference})]})}),o.jsxs("td",{className:"px-4 py-3",children:[o.jsx("div",{className:"text-sm text-gray-900",children:g.organisation_name}),o.jsxs("div",{className:"text-xs text-gray-500",children:[g.trade_type==="passive_fire"&&"PassiveFire",g.trade_type==="electrical"&&"Electrical",g.trade_type==="plumbing"&&"Plumbing"]})]}),o.jsx("td",{className:"px-4 py-3",children:o.jsx("div",{className:"text-sm text-gray-700",children:g.project_name})}),o.jsx("td",{className:"px-4 py-3",children:o.jsx("span",{className:"text-sm font-medium text-gray-900",children:g.items_count})}),o.jsx("td",{className:"px-4 py-3",children:o.jsxs("span",{className:"text-sm font-medium text-gray-900",children:["$",g.total_amount.toLocaleString()]})}),o.jsx("td",{className:"px-4 py-3",children:g.avg_confidence?o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-2 w-16",children:o.jsx("div",{className:`h-2 rounded-full ${g.avg_confidence<.5?"bg-red-600":g.avg_confidence<.75?"bg-yellow-600":"bg-green-600"}`,style:{width:`${g.avg_confidence*100}%`}})}),o.jsxs("span",{className:"text-xs text-gray-600",children:[(g.avg_confidence*100).toFixed(0),"%"]})]}):o.jsx("span",{className:"text-sm text-gray-400",children:"N/A"})}),o.jsx("td",{className:"px-4 py-3",children:o.jsxs("div",{children:[o.jsx("div",{className:"text-sm text-gray-900",children:new Date(g.created_at).toLocaleDateString()}),o.jsx("div",{className:"text-xs text-gray-500",children:g.uploaded_by_email||"Unknown"})]})}),o.jsx("td",{className:"px-4 py-3",children:o.jsx("div",{className:"flex gap-2",children:o.jsx("button",{onClick:()=>p(g),className:"p-1.5 text-blue-600 hover:bg-blue-50 rounded transition-colors",title:"Download PDF",children:o.jsx(si,{size:16})})})})]},g.quote_id))})]}),m.length===0&&o.jsx("div",{className:"p-12 text-center text-gray-500",children:"No PDFs found matching your filters"})]})]})]})}function Dw(){const[e,t]=T.useState("dashboard"),[r,s]=T.useState(null),[n,a]=T.useState(""),[i,l]=T.useState(!1);T.useEffect(()=>{c()},[]);const c=async()=>{const{data:{session:f}}=await ie.auth.getSession();f!=null&&f.user.email&&(a(f.user.email),l(Bk(f.user.email)))};T.useEffect(()=>{const f=window.location.pathname;if(f==="/admin"||f==="/admin/")t(i?"super-dashboard":"dashboard");else if(f==="/admin/dashboard")t("super-dashboard");else if(f==="/admin/clients/new")t("create-client");else if(f==="/admin/pdfs")t("pdf-vault");else if(f==="/admin/organisations")t("organisations");else if(f==="/admin/organisations/new")t("create-organisation");else if(f.startsWith("/admin/organisations/")){const h=f.split("/").pop();h&&(s(h),t("organisation-detail"))}},[i]);const u=async()=>{await ie.auth.signOut(),window.location.href="/"},d=()=>{switch(e){case"super-dashboard":return o.jsx(Ow,{});case"create-client":return o.jsx(JV,{});case"pdf-vault":return o.jsx(QV,{});case"dashboard":return o.jsx(Iw,{});case"organisations":return o.jsx(GV,{});case"organisation-detail":return r?o.jsx(KV,{organisationId:r}):null;case"create-organisation":return o.jsx(XV,{});default:return i?o.jsx(Ow,{}):o.jsx(Iw,{})}};return o.jsxs("div",{className:"min-h-screen bg-slate-50 flex",children:[o.jsxs("div",{className:"w-64 bg-white border-r border-slate-200 flex flex-col",children:[o.jsx("div",{className:"p-6 border-b border-slate-200",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-blue-500 to-blue-600 flex items-center justify-center",children:o.jsx(yo,{className:"text-white",size:20})}),o.jsxs("div",{children:[o.jsx("div",{className:"font-semibold text-slate-900",children:"Admin Console"}),o.jsx("div",{className:"text-xs text-slate-500",children:"Master Admin"})]})]})}),o.jsxs("nav",{className:"flex-1 p-4 space-y-1",children:[i&&o.jsxs(o.Fragment,{children:[o.jsxs("button",{onClick:()=>window.location.href="/admin/dashboard",className:`w-full flex items-center gap-3 px-4 py-2 rounded-lg text-sm font-medium transition ${e==="super-dashboard"?"bg-blue-50 text-blue-700":"text-slate-700 hover:bg-slate-50"}`,children:[o.jsx(IS,{size:18}),"Clients & Trials"]}),o.jsxs("button",{onClick:()=>window.location.href="/admin/pdfs",className:`w-full flex items-center gap-3 px-4 py-2 rounded-lg text-sm font-medium transition ${e==="pdf-vault"?"bg-blue-50 text-blue-700":"text-slate-700 hover:bg-slate-50"}`,children:[o.jsx($t,{size:18}),"PDF Vault"]}),o.jsx("div",{className:"h-px bg-slate-200 my-2"})]}),o.jsxs("button",{onClick:()=>window.location.href="/admin",className:`w-full flex items-center gap-3 px-4 py-2 rounded-lg text-sm font-medium transition ${e==="dashboard"?"bg-blue-50 text-blue-700":"text-slate-700 hover:bg-slate-50"}`,children:[o.jsx(om,{size:18}),"Dashboard"]}),o.jsxs("button",{onClick:()=>window.location.href="/admin/organisations",className:`w-full flex items-center gap-3 px-4 py-2 rounded-lg text-sm font-medium transition ${e==="organisations"||e==="organisation-detail"||e==="create-organisation"?"bg-blue-50 text-blue-700":"text-slate-700 hover:bg-slate-50"}`,children:[o.jsx(yo,{size:18}),"Organisations"]})]}),o.jsxs("div",{className:"p-4 border-t border-slate-200 space-y-2",children:[o.jsxs("button",{onClick:()=>window.location.href="/",className:"w-full flex items-center gap-3 px-4 py-2 rounded-lg text-sm font-medium text-slate-700 hover:bg-slate-50 transition",children:[o.jsx(om,{size:18}),"Main App"]}),o.jsxs("button",{onClick:u,className:"w-full flex items-center gap-3 px-4 py-2 rounded-lg text-sm font-medium text-rose-600 hover:bg-rose-50 transition",children:[o.jsx(AS,{size:18}),"Logout"]})]})]}),o.jsx("div",{className:"flex-1 overflow-auto",children:d()})]})}const eE=T.createContext(null);function ZV({children:e}){const[t,r]=T.useState(!1),[s,n]=T.useState(!0);T.useEffect(()=>{a()},[]);const a=async()=>{try{const{data:{user:i}}=await ie.auth.getUser();if(!i){r(!1),n(!1);return}const{data:l}=await ie.from("platform_admins").select("is_active").eq("user_id",i.id).eq("is_active",!0).maybeSingle();r(!!l)}catch(i){console.error("Error checking admin status:",i),r(!1)}finally{n(!1)}};return o.jsx(eE.Provider,{value:{isMasterAdmin:t,loading:s},children:e})}function eW(){const e=T.useContext(eE);if(!e)throw new Error("useAdmin must be used within AdminProvider");return e}function tW(){const[e,t]=T.useState(null),[r,s]=T.useState(!0),[n,a]=T.useState("dashboard"),[i,l]=T.useState("hub"),[c,u]=T.useState(null),[d,f]=T.useState(null),[h,p]=T.useState([]),[m,x]=T.useState(!0),[g,y]=T.useState(null),[w,v]=T.useState(!1),[b,_]=T.useState(null),{currentOrganisation:k,organisations:S,loading:E,setCurrentOrganisation:C}=ya(),{isMasterAdmin:U,loading:H}=eW();T.useEffect(()=>{const M=setTimeout(()=>{r&&(console.warn("Auth loading timeout - forcing completion"),s(!1))},5e3);ie.auth.getSession().then(({data:{session:B}})=>{t(B),s(!1),clearTimeout(M)}).catch(B=>{console.error("Error loading session:",B),s(!1),clearTimeout(M)});const{data:{subscription:D}}=ie.auth.onAuthStateChange((B,Y)=>{(async()=>t(Y))()});return()=>{D.unsubscribe(),clearTimeout(M)}},[]),T.useEffect(()=>{!r&&e&&q()},[r,e]),T.useEffect(()=>{k&&(q(),W())},[k]);const W=async()=>{if(k)try{const{data:M,error:D}=await ie.from("organisations").select("licensed_trades, subscription_status").eq("id",k.id).single();!D&&M&&_({licensed_trades:M.licensed_trades||[],subscription_status:M.subscription_status||"trial"})}catch(M){console.error("Failed to load org licensing:",M)}};T.useEffect(()=>{c&&L(c)},[c]),T.useEffect(()=>{h.length===0&&k&&X()},[k]);const q=async()=>{x(!0),await X();const M=localStorage.getItem("passivefire_current_project_id");if(M&&k){const{data:D}=await ie.from("projects").select("id, name, client, reference").eq("id",M).eq("organisation_id",k.id).maybeSingle();D?(u(D.id),f(D)):(localStorage.removeItem("passivefire_current_project_id"),u(null),f(null))}x(!1)},z=async M=>{u(M),localStorage.setItem("passivefire_current_project_id",M),await ie.from("projects").update({last_accessed_at:new Date().toISOString()}).eq("id",M),await L(M)},Q=async(M,D,B)=>{if(!k||!(e!=null&&e.user))return y({message:"Must be logged in to create a project",type:"error"}),null;try{const{data:Y,error:he}=await ie.from("projects").insert({organisation_id:k.id,name:M,client:D||null,reference:B||null,status:"active",created_by_user_id:e.user.id,user_id:e.user.id}).select().single();if(he)throw he;return await X(),y({message:`Project "${M}" created successfully`,type:"success"}),await z(Y.id),Y.id}catch(Y){return console.error("Error creating project:",Y),y({message:"Failed to create project",type:"error"}),null}},L=async M=>{const{data:D}=await ie.from("projects").select("id, name, client, reference").eq("id",M).maybeSingle();D&&f(D)},X=async()=>{if(!k)return;const{data:M,error:D}=await ie.from("projects").select("id, name, client, reference, updated_at, approved_quote_id").eq("organisation_id",k.id).order("updated_at",{ascending:!1});if(D){console.error("Error loading projects:",D);return}if(M){const B=await Promise.all(M.map(async Y=>{var ne,be,N,G,ce,te,ue;const{data:he}=await ie.from("award_reports").select("id, generated_at, status, result_json").eq("project_id",Y.id).eq("status","ready").order("generated_at",{ascending:!1}).limit(1).maybeSingle(),xe=((N=(be=(ne=he==null?void 0:he.result_json)==null?void 0:ne.awardSummary)==null?void 0:be.suppliers)==null?void 0:N.length)||0,se=((ue=(te=(ce=(G=he==null?void 0:he.result_json)==null?void 0:G.awardSummary)==null?void 0:ce.suppliers)==null?void 0:te[0])==null?void 0:ue.coveragePercent)||0;return{id:Y.id,name:Y.name,client_reference:Y.client||Y.reference||"No client",updated_at:Y.updated_at,has_report:!!he,report_id:he==null?void 0:he.id,report_generated_at:he==null?void 0:he.generated_at,report_quotes_count:xe,report_coverage_percent:Math.round(se)}}));p(B)}},K=M=>c?!0:(y({message:"Select or create a project first.",type:"error"}),!1),V=(M,D)=>{const B=D||c;switch(B&&u(B),M){case"dashboard":a("dashboard");break;case"quotes":a("quotes");break;case"review":a("review");break;case"quoteintel":a("quoteintel");break;case"scope":a("scope");break;case"reports":case"award":a("reports");break;case"contract":case"basetracker":a("contract");break;case"insights":a("insights");break;case"library":a("library");break;case"settings":a("settings");break;default:a("dashboard")}},fe=()=>{switch(n){case"dashboard":return o.jsx(xn,{projectId:c,projectName:d==null?void 0:d.name,allProjects:h,onProjectSelect:z,onCreateProject:Q,onNavigateToQuotes:()=>{K()&&a("quotes")},onNavigateToMatrix:()=>{K()&&a("scope")},onNavigateToReports:()=>{K()&&a("reports")},onNavigateToLibrary:()=>a("library")});case"quotes":return c?o.jsx(OR,{projectId:c,onQuotesImported:()=>{},onNavigateToDashboard:()=>a("dashboard"),onNavigateToNext:()=>a("review")}):o.jsx(xn,{projectId:null,projectName:void 0,allProjects:h,onProjectSelect:z,onCreateProject:Q,onNavigateToQuotes:()=>{K()&&a("quotes")},onNavigateToMatrix:()=>{K()&&a("scope")},onNavigateToReports:()=>{K()&&a("reports")},onNavigateToLibrary:()=>a("library")});case"review":return c?o.jsx(YR,{projectId:c,onNavigateBack:()=>a("quotes"),onNavigateNext:()=>a("quoteintel")}):o.jsx(xn,{projectId:null,projectName:void 0,allProjects:h,onProjectSelect:z,onCreateProject:Q,onNavigateToQuotes:()=>{K()&&a("quotes")},onNavigateToMatrix:()=>{K()&&a("scope")},onNavigateToReports:()=>{K()&&a("reports")},onNavigateToLibrary:()=>a("library")});case"reviewqueue":return o.jsx(JR,{});case"quoteintel":return c?o.jsx(uV,{projectId:c,onNavigateBack:()=>a("review"),onNavigateNext:()=>a("scope")}):o.jsx(xn,{projectId:null,projectName:void 0,allProjects:h,onProjectSelect:z,onCreateProject:Q,onNavigateToQuotes:()=>{K()&&a("quotes")},onNavigateToMatrix:()=>{K()&&a("scope")},onNavigateToReports:()=>{K()&&a("reports")},onNavigateToLibrary:()=>a("library")});case"scope":return c?o.jsx(gV,{projectId:c,onNavigateBack:()=>a("quoteintel"),onNavigateNext:()=>a("reports")}):o.jsx(xn,{projectId:null,projectName:void 0,allProjects:h,onProjectSelect:z,onCreateProject:Q,onNavigateToQuotes:()=>{K()&&a("quotes")},onNavigateToMatrix:()=>{K()&&a("scope")},onNavigateToReports:()=>{K()&&a("reports")},onNavigateToLibrary:()=>a("library")});case"contract":return c?o.jsx(wV,{projectId:c}):o.jsx(xn,{projectId:null,projectName:void 0,allProjects:h,onProjectSelect:z,onCreateProject:Q,onNavigateToQuotes:()=>{K()&&a("quotes")},onNavigateToMatrix:()=>{K()&&a("scope")},onNavigateToReports:()=>{K()&&a("reports")},onNavigateToLibrary:()=>a("library")});case"reports":return c?o.jsx(SV,{projectId:c,projects:h,onNavigateBackToScope:()=>a("scope"),onNavigateBackToDashboard:()=>a("dashboard")}):o.jsx(xn,{projectId:null,projectName:void 0,allProjects:h,onProjectSelect:z,onCreateProject:Q,onNavigateToQuotes:()=>{K()&&a("quotes")},onNavigateToMatrix:()=>{K()&&a("scope")},onNavigateToReports:()=>{K()&&a("reports")},onNavigateToLibrary:()=>a("library")});case"insights":return c?o.jsx(kV,{projectId:c}):o.jsx(xn,{projectId:null,projectName:void 0,allProjects:h,onProjectSelect:z,onCreateProject:Q,onNavigateToQuotes:()=>{K()&&a("quotes")},onNavigateToMatrix:()=>{K()&&a("scope")},onNavigateToReports:()=>{K()&&a("reports")},onNavigateToLibrary:()=>a("library")});case"library":return i==="templates"?o.jsx(EV,{onBack:()=>l("hub"),onNavigateToNewProject:()=>u(null)}):o.jsx(NV,{onNavigateToTemplates:()=>l("templates")});case"systemcheck":return o.jsx(Qj,{});case"copilotaudit":return o.jsx(Zj,{});case"settings":return c?o.jsx(BV,{projectId:c,onProjectDeleted:()=>u(null)}):o.jsxs("div",{className:"p-8",children:[o.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Settings"}),o.jsx("p",{className:"text-gray-600 mb-4",children:"Select a project to configure project-specific settings, or manage organisation settings below."}),o.jsx(qV,{})]});default:return o.jsx(xn,{projectId:c,projectName:d==null?void 0:d.name,allProjects:h,onProjectSelect:z,onCreateProject:Q,onNavigateToQuotes:()=>{K()&&a("quotes")},onNavigateToMatrix:()=>{K()&&a("scope")},onNavigateToReports:()=>{K()&&a("reports")},onNavigateToLibrary:()=>a("library")})}};if(r||E||H)return o.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),o.jsx("p",{className:"text-gray-600",children:"Loading..."})]})});if(!e)return o.jsx(HV,{});if(window.location.pathname.startsWith("/admin"))return U?o.jsx(Dw,{}):(Om.show({type:"warning",title:"Access denied",body:"The Admin Console is only accessible to platform administrators.",duration:5e3}),setTimeout(()=>{window.location.href="/"},1e3),null);if(!k&&S.length>0)return o.jsx(Rw,{onOrganisationSelected:()=>{}});if(!k)return U?o.jsx(Dw,{}):o.jsx(Rw,{onOrganisationSelected:()=>{}});if(m)return o.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),o.jsx("p",{className:"text-gray-600",children:"Loading..."})]})});const ve=vR(),P=ve?k:null;return o.jsxs("div",{className:"min-h-screen bg-gray-50 flex overflow-x-hidden",children:[o.jsx(kR,{activeTab:n,onTabChange:a}),o.jsxs("div",{className:"flex-1 flex flex-col max-w-full overflow-x-hidden",children:[ve&&P&&o.jsxs("div",{className:"bg-red-600 text-white px-6 py-3 flex items-center justify-between shadow-lg",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(qa,{size:20}),o.jsxs("div",{children:[o.jsx("div",{className:"font-bold",children:"ADMIN MODE - Impersonating Client"}),o.jsxs("div",{className:"text-sm text-red-100",children:["Viewing as: ",P.name]})]})]}),o.jsxs("button",{onClick:()=>xR(),className:"flex items-center gap-2 px-4 py-2 bg-red-700 hover:bg-red-800 rounded-md font-medium transition-colors",children:[o.jsx(Qr,{size:16}),"Exit Admin Mode"]})]}),!ve&&b&&b.licensed_trades&&o.jsx(bR,{currentTrades:b.licensed_trades,subscriptionStatus:b.subscription_status}),o.jsx(NR,{currentProjectId:c||void 0,currentProjectName:d==null?void 0:d.name,onProjectChange:z,onBackToDashboard:()=>{u(null),f(null),a("dashboard")},notificationCount:0,onNavigateToAccount:()=>a("settings"),onNavigateToBilling:()=>a("settings"),onSwitchOrganisation:()=>{C(null),u(null),f(null),p([]),a("dashboard")}}),o.jsx("main",{className:"flex-1 overflow-auto",children:fe()}),o.jsx(VV,{})]}),o.jsx(tx,{children:g&&o.jsx(UV,{message:g.message,type:g.type,onClose:()=>y(null)})}),o.jsx(zV,{}),o.jsx("button",{onClick:()=>v(!0),className:"fixed bottom-6 right-6 w-14 h-14 bg-gradient-to-r from-purple-600 to-blue-600 text-white rounded-full shadow-lg hover:shadow-xl transition-all duration-200 flex items-center justify-center z-40 hover:scale-110",title:"Ask AI Copilot",children:o.jsx(Fc,{size:24})}),o.jsx(WV,{isOpen:w,onClose:()=>v(!1),currentProjectId:c||void 0,allProjects:h.map(M=>({id:M.id,name:M.name})),onNavigate:V})]})}function rW(){return o.jsx(ZV,{children:o.jsx(_R,{children:o.jsx(tW,{})})})}class sW extends T.Component{constructor(t){super(t),this.state={hasError:!1,error:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,r){console.error("Error caught by boundary:",t,r)}render(){var t,r;return this.state.hasError?o.jsxs("div",{style:{padding:"40px",fontFamily:"system-ui, -apple-system, sans-serif",maxWidth:"800px",margin:"0 auto"},children:[o.jsx("h1",{style:{color:"#dc2626",marginBottom:"16px"},children:"Application Error"}),o.jsx("div",{style:{background:"#fee2e2",border:"1px solid #fecaca",borderRadius:"8px",padding:"16px",marginBottom:"16px"},children:o.jsx("p",{style:{margin:0,fontFamily:"monospace",fontSize:"14px"},children:((t=this.state.error)==null?void 0:t.message)||"Unknown error"})}),o.jsxs("details",{style:{marginTop:"16px"},children:[o.jsx("summary",{style:{cursor:"pointer",marginBottom:"8px"},children:"Stack Trace"}),o.jsx("pre",{style:{background:"#f3f4f6",padding:"12px",borderRadius:"4px",overflow:"auto",fontSize:"12px"},children:(r=this.state.error)==null?void 0:r.stack})]}),o.jsx("button",{onClick:()=>window.location.reload(),style:{marginTop:"24px",padding:"8px 16px",background:"#3b82f6",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"14px"},children:"Reload Page"})]}):this.props.children}}qf.createRoot(document.getElementById("root")).render(o.jsx(bE.StrictMode,{children:o.jsx(sW,{children:o.jsx(rW,{})})}));
